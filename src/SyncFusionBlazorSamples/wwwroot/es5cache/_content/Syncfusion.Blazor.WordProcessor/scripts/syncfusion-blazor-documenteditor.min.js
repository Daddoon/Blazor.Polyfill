//SHA256: 1498b760f75b5b50a7cb143aac18225247e7e917c8a53fae593198b2c37c188e
function _instanceof(n,t){return t!=null&&typeof Symbol!="undefined"&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](n):n instanceof t}function _typeof2(n){"@babel/helpers - typeof";return _typeof2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof2(n)}!function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};t.m=n;t.c=i;t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})};t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})};t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==_typeof2(n)&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r};t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i};t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)};t.p="";t(t.s="./single-documenteditor-bundle.js")}({"../node_modules/@babel/runtime/regenerator/index.js":function(n,t,i){n.exports=i("../node_modules/regenerator-runtime/runtime.js")},"../node_modules/regenerator-runtime/runtime.js":function(n){var t=function(n){"use strict";function t(n,t,i){return Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),n[t]}function g(n,t,r,u){var e=t&&_instanceof(t.prototype,p)?t:p,f=Object.create(e.prototype),o=new b(u||[]);return f._invoke=function(n,t,r){var u="suspendedStart";return function(f,e){var h,s,o;if("executing"===u)throw new Error("Generator is already running");if("completed"===u){if("throw"===f)throw e;return it()}for(r.method=f,r.arg=e;;){if(h=r.delegate,h&&(s=tt(h,r),s)){if(s===i)continue;return s}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===u)throw u="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);if(u="executing",o=y(n,t,r),"normal"===o.type){if(u=r.done?"completed":"suspendedYield",o.arg===i)continue;return{value:o.arg,done:r.done}}"throw"===o.type&&(u="completed",r.method="throw",r.arg=o.arg)}}}(n,r,o),f}function y(n,t,i){try{return{type:"normal",arg:n.call(t,i)}}catch(n){return{type:"throw",arg:n}}}function p(){}function s(){}function u(){}function nt(n){["next","throw","return"].forEach(function(i){t(n,i,function(n){return this._invoke(i,n)})})}function l(n,t){var i;this._invoke=function(u,f){function e(){return new t(function(i,e){!function i(u,f,e,o){var c=y(n[u],n,f),h,s;if("throw"!==c.type)return h=c.arg,s=h.value,s&&"object"==_typeof2(s)&&r.call(s,"__await")?t.resolve(s.__await).then(function(n){i("next",n,e,o)},function(n){i("throw",n,e,o)}):t.resolve(s).then(function(n){h.value=n;e(h)},function(n){return i("throw",n,e,o)});o(c.arg)}(u,f,i,e)})}return i=i?i.then(e,e):e()}}function tt(n,t){var f=n.iterator[t.method],u,r;if(void 0===f){if(t.delegate=null,"throw"===t.method){if(n.iterator.return&&(t.method="return",t.arg=void 0,tt(n,t),"throw"===t.method))return i;t.method="throw";t.arg=new TypeError("The iterator does not provide a 'throw' method")}return i}return(u=y(f,n.iterator,t.arg),"throw"===u.type)?(t.method="throw",t.arg=u.arg,t.delegate=null,i):(r=u.arg,r?r.done?(t[n.resultName]=r.value,t.next=n.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,i):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,i))}function ut(n){var t={tryLoc:n[0]};1 in n&&(t.catchLoc=n[1]);2 in n&&(t.finallyLoc=n[2],t.afterLoc=n[3]);this.tryEntries.push(t)}function w(n){var t=n.completion||{};t.type="normal";delete t.arg;n.completion=t}function b(n){this.tryEntries=[{tryLoc:"root"}];n.forEach(ut,this);this.reset(!0)}function k(n){var t,i,u;if(n){if(t=n[o],t)return t.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length))return i=-1,u=function t(){for(;++i<n.length;)if(r.call(n,i))return t.value=n[i],t.done=!1,t;return t.value=void 0,t.done=!0,t},u.next=u}return{next:it}}function it(){return{value:void 0,done:!0}}var d=Object.prototype,r=d.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",rt=a.asyncIterator||"@@asyncIterator",v=a.toStringTag||"@@toStringTag",i,h,c,e,f;try{t({},"")}catch(n){t=function(n,t,i){return n[t]=i}}return n.wrap=g,i={},h={},t(h,o,function(){return this}),c=Object.getPrototypeOf,e=c&&c(c(k([]))),e&&e!==d&&r.call(e,o)&&(h=e),f=u.prototype=p.prototype=Object.create(h),s.prototype=u,t(f,"constructor",u),t(u,"constructor",s),s.displayName=t(u,v,"GeneratorFunction"),n.isGeneratorFunction=function(n){var t="function"==typeof n&&n.constructor;return!!t&&(t===s||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,u):(n.__proto__=u,t(n,v,"GeneratorFunction")),n.prototype=Object.create(f),n},n.awrap=function(n){return{__await:n}},nt(l.prototype),t(l.prototype,rt,function(){return this}),n.AsyncIterator=l,n.async=function(t,i,r,u,f){void 0===f&&(f=Promise);var e=new l(g(t,i,r,u),f);return n.isGeneratorFunction(i)?e:e.next().then(function(n){return n.done?n.value:e.next()})},nt(f),t(f,v,"Generator"),t(f,o,function(){return this}),t(f,"toString",function(){return"[object Generator]"}),n.keys=function(n){var i=[];for(var t in n)i.push(t);return i.reverse(),function t(){for(;i.length;){var r=i.pop();if(r in n)return t.value=r,t.done=!1,t}return t.done=!0,t}},n.values=k,b.prototype={constructor:b,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!n)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(n){function i(t,i){return e.type="throw",e.arg=n,u.next=t,i&&(u.method="next",u.arg=void 0),!!i}var u,f,t,e,o,s;if(this.done)throw n;for(u=this,f=this.tryEntries.length-1;f>=0;--f){if(t=this.tryEntries[f],e=t.completion,"root"===t.tryLoc)return i("end");if(t.tryLoc<=this.prev)if(o=r.call(t,"catchLoc"),s=r.call(t,"finallyLoc"),o&&s){if(this.prev<t.catchLoc)return i(t.catchLoc,!0);if(this.prev<t.finallyLoc)return i(t.finallyLoc)}else if(o){if(this.prev<t.catchLoc)return i(t.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<t.finallyLoc)return i(t.finallyLoc)}}},abrupt:function(n,t){for(var f,u,o,e=this.tryEntries.length-1;e>=0;--e)if(f=this.tryEntries[e],f.tryLoc<=this.prev&&r.call(f,"finallyLoc")&&this.prev<f.finallyLoc){u=f;break}return u&&("break"===n||"continue"===n)&&u.tryLoc<=t&&t<=u.finallyLoc&&(u=null),o=u?u.completion:{},o.type=n,o.arg=t,u?(this.method="next",this.next=u.finallyLoc,i):this.complete(o)},complete:function(n,t){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&t&&(this.next=t),i},finish:function(n){for(var t,r=this.tryEntries.length-1;r>=0;--r)if(t=this.tryEntries[r],t.finallyLoc===n)return this.complete(t.completion,t.afterLoc),w(t),i},"catch":function(n){for(var i,r,u,t=this.tryEntries.length-1;t>=0;--t)if(i=this.tryEntries[t],i.tryLoc===n)return r=i.completion,"throw"===r.type&&(u=r.arg,w(i)),u;throw new Error("illegal catch attempt");},delegateYield:function(n,t,r){return this.delegate={iterator:k(n),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),i}},n}(n.exports);try{regeneratorRuntime=t}catch(n){"object"==(typeof globalThis=="undefined"?"undefined":_typeof2(globalThis))?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},"./modules/accumulationchart.js":function(){function n(t){return(n="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(n){return _typeof2(n)}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":_typeof2(n)})(t)}window.sf=window.sf||{};sf.charts=sf.base.extend({},sf.charts,function(t){"use strict";function ni(n){return-1!==n.indexOf("<br>")}function l(n){if(!n)return null;var t="string"==typeof n?h(n):n;t&&sf.base.remove(t)}function ht(n,t){return Math.log(n)/Math.log(t)}function ct(n,t,i,r,u,f,e,o){var s=document.getElementById(u),h=sf.svgbase.measureText(n,{fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"Regular"}),c=h.width+5;(t=t+c>r?t-(c+15):t,i=o?i-h.height/2:i+15,s)?(s.innerHTML=n,s.style.top=i.toString()+"px",s.style.left=(t+15).toString()+"px"):(s=sf.base.createElement("div",{innerHTML:n,id:u,styles:"top:"+i.toString()+"px;left:"+(t+15).toString()+'px;background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(112, 112, 112); padding-left : 3px; padding-right : 2px;padding-bottom : 2px; padding-top : 2px; font-size:12px; font-family: "Segoe UI"'}),f.appendChild(s),parseInt(s.style.left.replace("px",""),10)<0&&(s.style.left="0px"));e&&setTimeout(function(){l(u)},1500)}function ti(n,t){return n<=t.max&&n>=t.min}function ft(n,t){return n.x+=t.left,n.y+=t.top,n.width-=t.left+t.right,n.height-=t.top+t.bottom,n}function a(n,t,i){var r=n*Math.PI/180;return new s(Math.cos(r)*t+i.x,Math.sin(r)*t+i.y)}function et(n,t){var i=t.visibleRange,r=(n-i.min)/i.delta;return t.isInversed?1-r:r}function ot(n,t){void 0===t&&(t=!1);var i=["NaN","NaN"];return n.indexOf("_Point_")>-1?i=n.split("_Series_")[1].split("_Point_"):n.indexOf("_shape_")>-1&&(!t||t&&-1===n.indexOf("_legend_"))?(i=n.split("_shape_"))[0]="0":n.indexOf("_text_")>-1&&(!t||t&&-1===n.indexOf("_legend_"))&&((i=n.split("_text_"))[0]="0"),new er(parseInt(i[0],10),parseInt(i[1],10))}function tt(n,t,i,r,u){return void 0===r&&(r=0),void 0===u&&(u=0),n>=i.x-r&&n<=i.x+i.width+r&&t>=i.y-u&&t<=i.y+i.height+u}function lt(n){return n.substr(0,1).toLowerCase()+n.substr(1)}function pf(n,t){for(var u,e,s,i,f,h,r=Number.MAX_VALUE,o=0;o<t.length;o++)if(i=t[o],u=[],i.visible&&(n.name===i.xAxisName||"primaryXAxis"===n.name&&null===i.xAxisName||n.name===i.chart.primaryXAxis.name&&!i.xAxisName))if((u=i.points.map(function(n){return n.xValue})).sort(function(n,t){return n-t}),1===u.length)s="DateTime"===n.valueType&&i.xMin===i.xMax?i.xMin-2592e6:i.xMin,0!=(e=u[0]-(sf.base.isNullOrUndefined(s)?n.visibleRange.min:s))&&(r=Math.min(r,e));else for(f=0;f<u.length;f++)h=u[f],f>0&&h&&0!=(e=h-u[f-1])&&(r=Math.min(r,e));return r===Number.MAX_VALUE&&(r=1),r}function v(n,t,i,r){return-i*Math.cos(n/r*(Math.PI/2))+i+t}function hr(n,t,i,r,u){var f={cancel:!1,name:"axisLabelRender",axis:u,text:i,value:t,labelStyle:r},e,o;(n.trigger("axisLabelRender",f),f.cancel)||(e=-1!==f.text.indexOf("<br>"),o=u.enableTrim?e?function(n,t,i){for(var e,r,u=[],o=t.split("<br>"),f=0;f<o.length;f++)if(t=o[f],e=sf.svgbase.measureText(t,i).width,e>n){for(r=t.length-1;r>=0;--r)if(t=t.substring(0,r)+"...",(e=sf.svgbase.measureText(t,i).width)<=n){u.push(t);break}}else u.push(t);return u}(u.maximumLabelWidth,f.text,u.labelStyle):it(u.maximumLabelWidth,f.text,u.labelStyle):f.text,u.visibleLabels.push(new yf(o,f.value,f.labelStyle,f.text)))}function cr(n){return null!=n.minimum&&null!=n.maximum}function lr(n,t,i,r,u){new sf.base.Animation({}).animate(n,{duration:i,delay:t,name:r,progress:function(n){n.element.style.visibility="visible"},end:function(n){u?sf.base.remove(n.element):n.element.style.visibility="visible"}})}function g(n,t,i,r,u,f,e,o,h,c){var v=e||new sf.svgbase.SvgRenderer(""),l=function(n,t,i,r,u,f,e){var l,b,k,d="Path",g=f,p=g&&"Circle"===i?t.width-2:t.width,h=g&&"Circle"===i?t.height-2:t.height,y=g?e.targetWidth:0,c=n.x,o=n.y,nt=n.y+-h/2,v=n.x+-p/2,w;switch(i){case"Bubble":case"Circle":d="Ellipse";sf.base.merge(r,{rx:p/2,ry:h/2,cx:c,cy:o});break;case"Cross":l="M "+v+" "+o+" L "+(c+p/2)+" "+o+" M "+c+" "+(o+h/2)+" L "+c+" "+(o+-h/2);sf.base.merge(r,{d:l,stroke:r.fill});break;case"Multiply":l="M "+(c-y)+" "+(o-y)+" L "+(c+y)+" "+(o+y)+" M "+(c-y)+" "+(o+y)+" L "+(c+y)+" "+(o-y);sf.base.merge(r,{d:l,stroke:r.fill});break;case"HorizontalLine":l="M "+v+" "+o+" L "+(c+p/2)+" "+o;sf.base.merge(r,{d:l});break;case"VerticalLine":l="M "+c+" "+(o+h/2)+" L "+c+" "+(o+-h/2);sf.base.merge(r,{d:l});break;case"Diamond":l="M "+v+" "+o+" L "+c+" "+(o+-h/2)+" L "+(c+p/2)+" "+o+" L "+c+" "+(o+h/2)+" L "+v+" "+o+" z";sf.base.merge(r,{d:l});break;case"ActualRect":l="M "+v+" "+(o+-h/8)+" L "+(c+y)+" "+(o+-h/8)+" L "+(c+y)+" "+(o+h/8)+" L "+v+" "+(o+h/8)+" L "+v+" "+(o+-h/8)+" z";sf.base.merge(r,{d:l});break;case"TargetRect":l="M "+(v+y)+" "+(o+-h/2)+" L "+(c+y/2)+" "+(o+-h/2)+" L "+(c+y/2)+" "+(o+h/2)+" L "+(v+y)+" "+(o+h/2)+" L "+(v+y)+" "+(o+-h/2)+" z";sf.base.merge(r,{d:l});break;case"Rectangle":case"Hilo":case"HiloOpenClose":case"Candle":case"Waterfall":case"BoxAndWhisker":case"StepArea":case"StackingStepArea":case"Square":case"Flag":l="M "+v+" "+(o+-h/2)+" L "+(c+p/2)+" "+(o+-h/2)+" L "+(c+p/2)+" "+(o+h/2)+" L "+v+" "+(o+h/2)+" L "+v+" "+(o+-h/2)+" z";sf.base.merge(r,{d:l});break;case"Pyramid":case"Triangle":l="M "+v+" "+(o+h/2)+" L "+c+" "+(o+-h/2)+" L "+(c+p/2)+" "+(o+h/2)+" L "+v+" "+(o+h/2)+" z";sf.base.merge(r,{d:l});break;case"Funnel":case"InvertedTriangle":l="M "+(c+p/2)+" "+(o-h/2)+" L "+c+" "+(o+h/2)+" L "+(c-p/2)+" "+(o-h/2)+" L "+(c+p/2)+" "+(o-h/2)+" z";sf.base.merge(r,{d:l});break;case"Pentagon":for(w=0;w<=5;w++)b=p/2*Math.cos(Math.PI/180*72*w),k=h/2*Math.sin(Math.PI/180*72*w),l=0===w?"M "+(c+b)+" "+(o+k)+" ":l.concat("L "+(c+b)+" "+(o+k)+" ");l=l.concat("Z");sf.base.merge(r,{d:l});break;case"Image":d="Image";sf.base.merge(r,{href:u,height:h,width:p,x:v,y:nt})}return{renderOption:r=function(n,t,i,r){var h="",o=t.height,e=t.width,u=n.x,f=n.y,c;switch(i){case"MultiColoredLine":case"Line":case"StackingLine":case"StackingLine100":h="M "+(u+-e/2)+" "+f+" L "+(u+e/2)+" "+f;sf.base.merge(r,{d:h});break;case"StepLine":r.fill="transparent";h="M "+(u+-e/2-2.5)+" "+(f+o/2)+" L "+(u+-e/2+e/10)+" "+(f+o/2)+" L "+(u+-e/2+e/10)+" "+f+" L "+(u+-e/10)+" "+f+" L "+(u+-e/10)+" "+(f+o/2)+" L "+(u+e/5)+" "+(f+o/2)+" L "+(u+e/5)+" "+(f+-o/2)+" L "+(u+e/2)+" "+(f+-o/2)+"L "+(u+e/2)+" "+(f+o/2)+" L"+(u+e/2+2.5)+" "+(f+o/2);sf.base.merge(r,{d:h});break;case"UpArrow":r.fill=r.stroke;r.stroke="transparent";h="M "+(u+-e/2)+" "+(f+o/2)+" L "+u+" "+(f-o/2)+" L "+(u+e/2)+" "+(f+o/2)+"L "+(u+e/2-2)+" "+(f+o/2)+" L "+u+" "+(f-o/2+4)+"L"+(u-e/2+2)+" "+(f+o/2)+" Z";sf.base.merge(r,{d:h});break;case"DownArrow":h="M "+(u-e/2)+" "+(f-o/2)+" L "+u+" "+(f+o/2)+" L "+(u+e/2)+" "+(f-o/2)+"L "+(u+e/2-2)+" "+(f-o/2)+" L "+u+" "+(f+o/2-4)+"L"+(u-e/2+2)+" "+(f-o/2)+" Z";sf.base.merge(r,{d:h});break;case"RightArrow":h="M "+(u+-e/2)+" "+(f-o/2)+" L "+(u+e/2)+" "+f+" L "+(u+-e/2)+" "+(f+o/2)+" L "+(u+-e/2)+" "+(f+o/2-2)+" L "+(u+e/2-4)+" "+f+" L"+(u+-e/2)+" "+(f-o/2+2)+" Z";sf.base.merge(r,{d:h});break;case"LeftArrow":r.fill=r.stroke;r.stroke="transparent";h="M "+(u+e/2)+" "+(f-o/2)+" L "+(u+-e/2)+" "+f+" L "+(u+e/2)+" "+(f+o/2)+" L "+(u+e/2)+" "+(f+o/2-2)+" L "+(u+-e/2+4)+" "+f+" L"+(u+e/2)+" "+(f-o/2+2)+" Z";sf.base.merge(r,{d:h});break;case"Column":case"Pareto":case"StackingColumn":case"StackingColumn100":case"RangeColumn":case"Histogram":h="M "+(u-e/5*3)+" "+(f-o/5)+" L "+(u+-e/10*3)+" "+(f-o/5)+" L "+(u+-e/10*3)+" "+(f+o/2)+" L "+(u-e/5*3)+" "+(f+o/2)+" Z M "+(u+-e/10-e/20)+" "+(f-o/4-5)+" L "+(u+e/10+e/20)+" "+(f-o/4-5)+" L "+(u+e/10+e/20)+" "+(f+o/2)+" L "+(u+-e/10-e/20)+" "+(f+o/2)+" Z M "+(u+e/10*3)+" "+f+" L "+(u+e/5*3)+" "+f+" L "+(u+e/5*3)+" "+(f+o/2)+" L "+(u+e/10*3)+" "+(f+o/2)+" Z";sf.base.merge(r,{d:h});break;case"Bar":case"StackingBar":case"StackingBar100":h="M "+(u+-e/2+-2.5)+" "+(f-o/5*3)+" L "+(u+e/10*3)+" "+(f-o/5*3)+" L "+(u+e/10*3)+" "+(f-o/10*3)+" L "+(u-e/2-2.5)+" "+(f-o/10*3)+" Z M "+(u+-e/2+-2.5)+" "+(f-o/5+.5)+" L "+(u+e/2+2.5)+" "+(f-o/5+.5)+" L "+(u+e/2+2.5)+" "+(f+o/10+.5)+" L "+(u-e/2-2.5)+" "+(f+o/10+.5)+" Z M "+(u-e/2-2.5)+" "+(f+o/5+1)+" L "+(u+-e/4)+" "+(f+o/5+1)+" L "+(u+-e/4)+" "+(f+o/2+1)+" L "+(u-e/2-2.5)+" "+(f+o/2+1)+" Z";sf.base.merge(r,{d:h});break;case"Spline":r.fill="transparent";h="M "+(u-e/2)+" "+(f+o/5)+" Q "+u+" "+(f-o)+" "+u+" "+(f+o/5)+" M "+u+" "+(f+o/5)+" Q "+(u+e/2)+" "+(f+o/2)+" "+(u+e/2)+" "+(f-o/2);sf.base.merge(r,{d:h});break;case"Area":case"MultiColoredArea":case"RangeArea":case"StackingArea":case"StackingArea100":h="M "+(u-e/2-2.5)+" "+(f+o/2)+" L "+(u+-e/4+-1.25)+" "+(f-o/2)+" L "+u+" "+(f+o/4)+" L "+(u+e/4+1.25)+" "+(f+-o/2+o/4)+" L "+(u+o/2+2.5)+" "+(f+o/2)+" Z";sf.base.merge(r,{d:h});break;case"SplineArea":case"SplineRangeArea":h="M "+(u-e/2)+" "+(f+o/5)+" Q "+u+" "+(f-o)+" "+u+" "+(f+o/5)+" Z M "+u+" "+(f+o/5)+" Q "+(u+e/2)+" "+(f+o/2)+" "+(u+e/2)+" "+(f-o/2)+"  Z";sf.base.merge(r,{d:h});break;case"Pie":case"Doughnut":r.stroke="transparent";c=Math.min(o,e)/2;h=function(n,t,i,r,u){var f=a(270,i,new s(n,t)),e=a(270,i,new s(n+u/10,t));return"M "+n+" "+t+" L "+(n+i)+" "+t+" A "+i+" "+i+" 0 1 1 "+f.x+" "+f.y+" Z M "+(n+u/10)+" "+(t-r/10)+" L"+(n+i)+" "+(t-r/10)+" A "+i+" "+i+" 0 0 0 "+e.x+" "+e.y+" Z"}(u,f,c,o,e);sf.base.merge(r,{d:h})}return{renderOption:r}}(n,new sf.svgbase.Size(p,h),i,r).renderOption,functionName:d}}(n,i,t,u,r,h,c);return v["draw"+l.functionName](l.renderOption,o?new Int32Array([o.x,o.y]):null)}function h(n){return document.getElementById(n)}function wf(n,t,i,r,u,f,e,o,s,h){var c=n.getBoundingClientRect();t.accumulationDataLabelModule.calculateLabelSize(i,n,f,r,u,e,o,s,h,c,!0)}function bf(n,t,i,r,u,f){var e=document.getElementById(t.element.id+"_Series_"+(void 0===r.index?r.category:r.index)+"_DataLabelCollections");e&&(0===i.index&&(t.dataLabelCollections=[]),t.dataLabelModule.calculateTemplateLabelSize(e,n,i,r,r.marker.dataLabel,u,r.clipRect,f,!0))}function ar(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){var k,d=function(n){var t=null;try{document.querySelectorAll(n).length&&(t=sf.base.compile(document.querySelector(n).innerHTML.trim()))}catch(i){t=sf.base.compile(n)}return t}(i),g,b,nt,w,p;try{if(g=window.Blazor?e?u:{point:u}:{chart:r,series:f,point:u},b=d?d(g,r,e?e+"_template":"template",e||n.id.replace(/[^a-zA-Z0-9]/g,"")):[],b.length)for(nt=(k=Array.prototype.slice.call(b)).length,w=0;w<nt;w++)n.appendChild(k[w]);p=void 0;"accumulationchart"===r.getModuleName()?(p=wf.bind(this,n,r,h,c,s,c[t],l,a,v,y),r.isReact&&r.renderReactTemplates(p)):"chart"===r.getModuleName()&&(p=u&&f?bf.bind(this,n,r,u,f,o,y):p,r.isReact&&r.renderReactTemplates(p))}catch(t){return n}return n}function vr(n,t,i){void 0===t&&(t=!1);i||document.body.appendChild(n);var r=n.getBoundingClientRect();return t?sf.base.remove(n):i||l(n.id),r}function yr(n,t,i,r,u,f){if(void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===u&&(u="x"),void 0===f&&(f="y"),!(n&&n.hasChildNodes()&&t))return null;y(!1,t,n,i,r,u,f)}function y(n,t,i,r,u,f,e,o,c,l,a,y,p){var g;if(void 0===u&&(u=!1),void 0===f&&(f="x"),void 0===e&&(e="y"),void 0===l&&(l=!1),void 0===a&&(a=!1),void 0===y&&(y=null),n)return null;var d=t.querySelector("#"+i.id),w=d||h(i.id),b=i,k=p||300;r&&u&&w?(o=o||("DIV"===w.tagName?new s(+w.style[f].split("px")[0],+w.style[e].split("px")[0]):new s(+w.getAttribute(f),+w.getAttribute(e))),c&&"undefined"!==c)?!function(n,t,i,r,u){var h;if(!i||!r&&!n)return null;h=300;u&&(h=u);var s,e,c,l=r||n.getAttribute("d"),y=l.split(/(?=[LMCZAQ])/),a=t.split(/(?=[LMCZAQ])/),f=[],o=[];n.setAttribute("d",l);new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:h,progress:function(t){s="";y.map(function(n,i){if(f=n.split(" "),o=a[i]?a[i].split(" "):f,s+="Z"===f[0]?"Z ":f[0]+" "+v(t.timeStamp,+f[1],+o[1]-+f[1],t.duration)+" "+v(t.timeStamp,+f[2],+o[2]-+f[2],t.duration)+" ","C"===f[0]||"Q"===f[0])for(e=3,c="Q"===f[0]?4:6;e<c;)s+=v(t.timeStamp,+f[e],+o[e]-+f[e],t.duration)+" "+v(t.timeStamp,+f[++e],+o[e]-+f[e],t.duration)+" ",++e;"A"===f[0]&&(s+="0 0 1 "+v(t.timeStamp,+f[6],+o[6]-+f[6],t.duration)+" "+v(t.timeStamp,+f[7],+o[7]-+f[7],t.duration)+" ")});n.setAttribute("d",s)},end:function(){n.setAttribute("d",t)}})}(i,i.getAttribute("d"),r,c,k):a&&y?!function(n,t,i,r,u){var f=function(t){n.setAttribute("x",t.x+"");n.setAttribute("y",t.y+"");n.setAttribute("width",t.width+"");n.setAttribute("height",t.height+"")};new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:i,delay:t,progress:function(n){f(new sf.svgbase.Rect(v(n.timeStamp,u.x,r.x-u.x,n.duration),v(n.timeStamp,u.y,r.y-u.y,n.duration),v(n.timeStamp,u.width,r.width-u.width,n.duration),v(n.timeStamp,u.height,r.height-u.height,n.duration)))},end:function(){f(r)}})}(b,0,k,new sf.svgbase.Rect(+w.getAttribute("x"),+w.getAttribute("y"),+w.getAttribute("width"),+w.getAttribute("height")),y):(g="DIV"===b.tagName?new s(+b.style[f].split("px")[0],+b.style[e].split("px")[0]):new s(+b.getAttribute(f),+b.getAttribute(e)),!function(n,t,i,r,u,f){void 0===u&&(u="x");void 0===f&&(f="y");var o="DIV"===n.tagName,e=function(t,i){o?(n.style[u]=t+"px",n.style[f]=i+"px"):(n.setAttribute(u,t+""),n.setAttribute(f,i+""))};e(i.x,i.y);new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:t,progress:function(n){e(v(n.timeStamp,i.x,r.x-i.x,n.duration),v(n.timeStamp,i.y,r.y-i.y,n.duration))},end:function(){e(r.x,r.y)}})}(b,k,o,g,f,e)):r&&u&&!w&&l&&lr(b,0,600,"FadeIn");d?t.replaceChild(b,w):t.appendChild(b)}function p(n,t){return n.x<t.x+t.width&&n.x+n.width>t.x&&n.y<t.y+t.height&&n.height+n.y>t.y}function ii(n){var t=n.toString(16);return 1===t.length?"0"+t:t}function kf(n){var t,r,i;return n="transparent"===n?"white":n,document.body.appendChild(sf.base.createElement("text",{id:"chartmeasuretext"})),t=document.getElementById("chartmeasuretext"),t.style.color=n,n=window.getComputedStyle(t).color,sf.base.remove(t),i=/^(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/.exec(n),"#"+ii((r=new si(parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10))).r)+ii(r.g)+ii(r.b)}function it(n,t,i){var r=t,f=sf.svgbase.measureText(t,i).width,u;if(f>n)for(u=t.length-1;u>=0;--u)if(r=t.substring(0,u)+"...",(f=sf.svgbase.measureText(r,i).width)<=n)return r;return r}function o(n,t){return null!=n?-1!==n.indexOf("%")?t/100*parseInt(n,10):parseInt(n,10):null}function pr(n,t,i,r){if(!n)return null;var u=h(t);return u&&i&&r.setElementAttributes(i,"clipPath"===u.tagName?u.childNodes[0]:u),u}function rt(n,t,i,r,u,f,e,o,s,h,c,l,a,v){var b,k,d,g,nt,w,tt;void 0===f&&(f=!1);void 0===s&&(s=!1);b={id:t.id,x:t.x,y:t.y,fill:r||"black","font-size":i.size,"font-style":i.fontStyle,"font-family":i.fontFamily,"font-weight":i.fontWeight,"text-anchor":t.anchor,labelRotation:t.labelRotation,transform:t.transform,opacity:i.opacity,"dominant-baseline":t.baseLine};var it="string"==typeof t.text?t.text:f?t.text[t.text.length-1]:t.text[0],rt=c?c.x:0,ut=c?c.y:0,p=n.createText(b,it,rt,ut);if(p.style.fontFamily=i.fontFamily,p.style.fontStyle=i.fontStyle,p.style.fontSize=i.size,p.style.fontWeight=i.fontWeight,p.style.color=i.color,p.style.textAnchor=t.anchor,"string"!=typeof t.text&&t.text.length>1)for(w=1,tt=t.text.length;w<tt;w++)d=sf.svgbase.measureText(t.text[w],i).height,g=t.y+(f?-w*d:w*d),nt=f?t.text[t.text.length-(w+1)]:t.text[w],v?k=n.createText(b,nt,null,null,g,!0):(k=n.createTSpan({x:t.x,id:t.id,y:g},nt),p.appendChild(k));return a||y(_instanceof(n,sf.svgbase.CanvasRenderer),u,p,e,o,"x","y",null,null,s,!1,null,h),p}function ri(n){var r=n.element.clientWidth||n.element.offsetWidth,u=n.element.clientHeight,f,i,s;if(n.stockChart&&(r=n.stockChart.availableSize.width,u=n.stockChart.availableSize.height),i=450,"rangeNavigator"===n.getModuleName()){var t=n,h=t.tooltip.enable?35:0,e=t.periodSelectorSettings.periods.length?t.periodSelectorSettings.height:0;f=t.margin.top+t.margin.bottom+h;s=sf.svgbase.measureText("tempString",t.labelStyle).height;i=(n.series.length?sf.base.Browser.isDevice?80:120:(t.enableGrouping?55+s:40)+f)+e;t.disableRangeSelector&&(i=e)}n.availableSize=new sf.svgbase.Size(o(n.width,r)||r||600,o(n.height,u||i)||u||i)}function at(n,t,i){var r=[];switch(t.textOverflow){case"Wrap":r=fi(n,i,t);break;case"Trim":r.push(it(i,n,t));break;default:r.push(n)}return r}function ui(n,t){return"Near"===t.textAlignment?n.x:"Center"===t.textAlignment?n.x+n.width/2:n.x+n.width}function fi(n,t,i){for(var u,o=n.split(" "),r="",f=[],e=0,s=o.length;e<s;e++)u=o[e],sf.svgbase.measureText(r.concat(u),i).width<t?r=r.concat((""===r?"":" ")+u):""!==r?(f.push(it(t,r,i)),r=u):(f.push(it(t,u,i)),u=""),r&&e===s-1&&f.push(it(t,r,i));return f}function wr(n){for(var t=0;t<n.annotations.length;t++)sf.base.resetBlazorTemplate((n.element.id+"_Annotation_"+t).replace(/[^a-zA-Z0-9]/g,""),"ContentTemplate");sf.base.resetBlazorTemplate(n.element.id+"_tooltipparent_template_blazorTemplate","Template");sf.base.resetBlazorTemplate(n.element.id+"_DataLabel")}function tu(n,t){for(var u,i=0,r=t;i<r.length;i++)if(u=r[i],n===u.index)return u;return t[0]}function yt(n,t){for(var u,i=0,r=t;i<r.length;i++)if(u=r[i],u.index===n)return u;return null}var b;!function(n){n.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.axisTitleFont={size:"14px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.chartTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.chartSubTitleFont={size:"11px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.crosshairLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.tooltipLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.legendLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.legendTitleFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.stripLineLabelFont={size:"12px",fontWeight:"Regular",color:"#353535",fontStyle:"Normal",fontFamily:"Segoe UI"};n.stockEventFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"}}(b||(b={}));var wt,bt,kt,dt,w=(wt=function(n,t){return(wt=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}wt(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},vu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return w(t,n),r([sf.base.Property("Line")],t.prototype,"type",void 0),r([sf.base.Property(null)],t.prototype,"color",void 0),r([sf.base.Property(1)],t.prototype,"width",void 0),r([sf.base.Property(null)],t.prototype,"length",void 0),r([sf.base.Property("")],t.prototype,"dashArray",void 0),t}(sf.base.ChildProperty),k=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return w(t,n),r([sf.base.Property("Normal")],t.prototype,"fontStyle",void 0),r([sf.base.Property("16px")],t.prototype,"size",void 0),r([sf.base.Property("Normal")],t.prototype,"fontWeight",void 0),r([sf.base.Property("")],t.prototype,"color",void 0),r([sf.base.Property("Center")],t.prototype,"textAlignment",void 0),r([sf.base.Property("Segoe UI")],t.prototype,"fontFamily",void 0),r([sf.base.Property(1)],t.prototype,"opacity",void 0),r([sf.base.Property("Trim")],t.prototype,"textOverflow",void 0),t}(sf.base.ChildProperty),d=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return w(t,n),r([sf.base.Property("")],t.prototype,"color",void 0),r([sf.base.Property(1)],t.prototype,"width",void 0),t}(sf.base.ChildProperty),fr=(function(n){function t(){return null!==n&&n.apply(this,arguments)||this}w(t,n);r([sf.base.Property(0)],t.prototype,"x",void 0);r([sf.base.Property(0)],t.prototype,"y",void 0)}(sf.base.ChildProperty),function(n){function t(){return null!==n&&n.apply(this,arguments)||this}w(t,n);r([sf.base.Complex({},d)],t.prototype,"border",void 0);r([sf.base.Property("transparent")],t.prototype,"background",void 0);r([sf.base.Property(1)],t.prototype,"opacity",void 0);r([sf.base.Property(null)],t.prototype,"backgroundImage",void 0)}(sf.base.ChildProperty),function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return w(t,n),r([sf.base.Property(10)],t.prototype,"left",void 0),r([sf.base.Property(10)],t.prototype,"right",void 0),r([sf.base.Property(10)],t.prototype,"top",void 0),r([sf.base.Property(10)],t.prototype,"bottom",void 0),t}(sf.base.ChildProperty)),yu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return w(t,n),r([sf.base.Property(0)],t.prototype,"left",void 0),r([sf.base.Property(0)],t.prototype,"right",void 0),r([sf.base.Property(0)],t.prototype,"top",void 0),r([sf.base.Property(0)],t.prototype,"bottom",void 0),t}(sf.base.ChildProperty),pu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return w(t,n),r([sf.base.Property(!0)],t.prototype,"enable",void 0),r([sf.base.Property(1e3)],t.prototype,"duration",void 0),r([sf.base.Property(0)],t.prototype,"delay",void 0),t}(sf.base.ChildProperty),wu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return w(t,n),r([sf.base.Property(0)],t.prototype,"series",void 0),r([sf.base.Property(0)],t.prototype,"point",void 0),t}(sf.base.ChildProperty),er=(function(n){function t(){return null!==n&&n.apply(this,arguments)||this}w(t,n);r([sf.base.Property(0)],t.prototype,"topLeft",void 0);r([sf.base.Property(0)],t.prototype,"topRight",void 0);r([sf.base.Property(0)],t.prototype,"bottomLeft",void 0);r([sf.base.Property(0)],t.prototype,"bottomRight",void 0)}(sf.base.ChildProperty),function(n,t){this.series=n;this.point=t}),bu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return w(t,n),r([sf.base.Property(null)],t.prototype,"fill",void 0),r([sf.base.Complex({color:"transparent",width:0},d)],t.prototype,"border",void 0),r([sf.base.Property("Gap")],t.prototype,"mode",void 0),t}(sf.base.ChildProperty),ku=(function(n){function t(){return null!==n&&n.apply(this,arguments)||this}w(t,n);r([sf.base.Property(!1)],t.prototype,"enable",void 0);r([sf.base.Property(null)],t.prototype,"minY",void 0);r([sf.base.Property(null)],t.prototype,"maxY",void 0);r([sf.base.Property(null)],t.prototype,"fill",void 0)}(sf.base.ChildProperty),function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return w(t,n),r([sf.base.Property(!1)],t.prototype,"enable",void 0),r([sf.base.Property(!0)],t.prototype,"enableMarker",void 0),r([sf.base.Property(!1)],t.prototype,"shared",void 0),r([sf.base.Property(null)],t.prototype,"fill",void 0),r([sf.base.Property(null)],t.prototype,"header",void 0),r([sf.base.Property(.75)],t.prototype,"opacity",void 0),r([sf.base.Complex(b.tooltipLabelFont,k)],t.prototype,"textStyle",void 0),r([sf.base.Property(null)],t.prototype,"format",void 0),r([sf.base.Property(null)],t.prototype,"template",void 0),r([sf.base.Property(!0)],t.prototype,"enableAnimation",void 0),r([sf.base.Property(300)],t.prototype,"duration",void 0),r([sf.base.Property(1e3)],t.prototype,"fadeOutDuration",void 0),r([sf.base.Property("Move")],t.prototype,"fadeOutMode",void 0),r([sf.base.Property(!1)],t.prototype,"enableTextWrap",void 0),r([sf.base.Complex({color:"#cccccc",width:.5},d)],t.prototype,"border",void 0),t}(sf.base.ChildProperty)),du=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return w(t,n),r([sf.base.Property("Years")],t.prototype,"intervalType",void 0),r([sf.base.Property(1)],t.prototype,"interval",void 0),r([sf.base.Property(null)],t.prototype,"text",void 0),r([sf.base.Property(!1)],t.prototype,"selected",void 0),t}(sf.base.ChildProperty),gt=(function(n){function t(){return null!==n&&n.apply(this,arguments)||this}w(t,n);r([sf.base.Property(43)],t.prototype,"height",void 0);r([sf.base.Property("Bottom")],t.prototype,"position",void 0);r([sf.base.Collection([],du)],t.prototype,"periods",void 0)}(sf.base.ChildProperty),function(){function n(n,t){n<t?(this.mStart=n,this.mEnd=t):(this.mStart=t,this.mEnd=n)}return Object.defineProperty(n.prototype,"start",{get:function(){return this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"end",{get:function(){return this.mEnd},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"delta",{get:function(){return this.mEnd-this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"median",{get:function(){return this.mStart+(this.mEnd-this.mStart)/2},enumerable:!0,configurable:!0}),n}()),gu=function(){function n(n){this.isColumn=0;this.chart=n}return n.prototype.calculateNumericNiceInterval=function(n,t,i){var e=function(n,t){var r="Horizontal"===t.orientation?n.width:n.height,i;return sf.base.isNullOrUndefined(t.desiredIntervals)?(i=("Horizontal"===t.orientation?.533:1)*t.maximumLabels,Math.max(r*(i/100),1)):t.desiredIntervals}(i,n),r=t/e,f;if(!sf.base.isNullOrUndefined(n.desiredIntervals))return r;for(var s=Math.pow(10,Math.floor(ht(r,10))),u=0,o=n.intervalDivs;u<o.length;u++){if(f=s*o[u],e<t/f)break;r=f}return r},n.prototype.getActualRange=function(n,t){this.initializeDoubleRange(n);!n.startFromZero&&this.isColumn>0?(n.actualRange.interval=n.interval||this.calculateNumericNiceInterval(n,n.doubleRange.delta,t),n.actualRange.max=n.doubleRange.end+n.actualRange.interval,n.actualRange.min=n.doubleRange.start-n.actualRange.interval<0&&n.doubleRange.start>0?0:n.doubleRange.start-n.actualRange.interval):(n.actualRange.interval=n.interval||this.calculateNumericNiceInterval(n,n.doubleRange.delta,t),n.actualRange.min=n.doubleRange.start,n.actualRange.max=n.doubleRange.end)},n.prototype.initializeDoubleRange=function(n){null!==n.minimum?this.min=n.minimum:null!==this.min&&this.min!==Number.POSITIVE_INFINITY||(this.min=0);null!==n.maximum?this.max=n.maximum:null!==this.max&&this.max!==Number.NEGATIVE_INFINITY||(this.max=5);this.min===this.max&&(this.max=n.valueType.indexOf("Category")>-1?this.max:this.min+1);n.doubleRange=new gt(this.min,this.max);n.actualRange={}},n.prototype.calculateRangeAndInterval=function(n,t){this.calculateRange(t);this.getActualRange(t,n);this.applyRangePadding(t,n);this.calculateVisibleLabels(t,this.chart)},n.prototype.calculateRange=function(n){var i,r,t;if(this.min=null,this.max=null,!cr(n))for(i=0,r=n.series;i<r.length;i++)t=r[i],t.visible&&(this.paddingInterval=0,n.maxPointLength=t.points.length,((t.type.indexOf("Column")>-1||t.type.indexOf("Histogram")>-1)&&"Horizontal"===n.orientation||t.type.indexOf("Bar")>-1&&"Vertical"===n.orientation)&&("Double"!==t.xAxis.valueType&&"DateTime"!==t.xAxis.valueType||"Auto"!==t.xAxis.rangePadding||(this.paddingInterval=.5*pf(t.xAxis,n.series))),"Horizontal"===n.orientation&&(this.chart.requireInvertedAxis?this.yAxisRange(n,t):this.findMinMax(t.xMin-this.paddingInterval,t.xMax+this.paddingInterval)),"Vertical"===n.orientation&&(this.isColumn+="Column"===t.type||"Bar"===t.type||"Column"===t.drawType?1:0,this.chart.requireInvertedAxis?this.findMinMax(t.xMin-this.paddingInterval,t.xMax+this.paddingInterval):this.yAxisRange(n,t)))},n.prototype.yAxisRange=function(n,t){t.dragSettings.enable&&this.chart.dragY&&(this.chart.dragY>=n.visibleRange.max&&(t.yMax=this.chart.dragY+n.visibleRange.interval),this.chart.dragY<=n.visibleRange.min&&(t.yMin=this.chart.dragY-n.visibleRange.interval));this.findMinMax(t.yMin,t.yMax)},n.prototype.findMinMax=function(n,t){(null===this.min||this.min>n)&&(this.min=n);(null===this.max||this.max<t)&&(this.max=t);this.max===this.min&&this.max<0&&this.min<0&&(this.max=0)},n.prototype.applyRangePadding=function(n,t){var u=n.actualRange.min,f=n.actualRange.max,i,r;cr(n)||(i=n.actualRange.interval,r=n.getRangePadding(this.chart),"Additional"===r||"Round"===r?this.findAdditional(n,u,f,i):"Normal"===r?this.findNormal(n,u,f,i,t):this.updateActualRange(n,u,f,i));n.actualRange.delta=n.actualRange.max-n.actualRange.min;this.calculateVisibleRange(t,n)},n.prototype.updateActualRange=function(n,t,i,r){n.actualRange={min:null!=n.minimum?n.minimum:t,max:null!=n.maximum?n.maximum:i,interval:null!=n.interval?n.interval:r,delta:n.actualRange.delta}},n.prototype.findAdditional=function(n,t,i,r){var u,f;u=Math.floor(t/r)*r;f=Math.ceil(i/r)*r;"Additional"===n.rangePadding&&(u-=r,f+=r);this.updateActualRange(n,u,f,r)},n.prototype.findNormal=function(n,t,i,r,u){var f,e,o=t;t<0?(o=0,.365*r>=r+(f=t+.05*t)%r&&(f-=r),f%r<0&&(f=f-r-f%r)):(f=t<5/6*i?0:t-.5*(i-t))%r>0&&(f-=f%r);.365*r>=r-(e=i>0?i+.05*(i-o):i-.05*(i-o))%r&&(e+=r);e%r>0&&(e=e+r-e%r);n.doubleRange=new gt(f,e);0===f&&(r=this.calculateNumericNiceInterval(n,n.doubleRange.delta,u),e=Math.ceil(e/r)*r);this.updateActualRange(n,f,e,r)},n.prototype.calculateVisibleRange=function(n,t){if(t.visibleRange={max:t.actualRange.max,min:t.actualRange.min,delta:t.actualRange.delta,interval:t.actualRange.interval},"Cartesian"===this.chart.chartAreaType){var i=!sf.base.isNullOrUndefined(t.zoomingScrollBar)&&t.zoomingScrollBar.isLazyLoad;(t.zoomFactor<1||t.zoomPosition>0)&&!i&&(t.calculateVisibleRangeOnZooming(n),t.calculateAxisRange(n,this.chart),t.visibleRange.interval=t.enableAutoIntervalOnZooming&&"Category"!==t.valueType?this.calculateNumericNiceInterval(t,t.doubleRange.delta,n):t.visibleRange.interval)}t.triggerRangeRender(this.chart,t.visibleRange.min,t.visibleRange.max,t.visibleRange.interval)},n.prototype.calculateVisibleLabels=function(n,t){
/*! Generate axis labels */
var u,i;n.visibleLabels=[];i=n.visibleRange.min;"chart"===t.getModuleName()&&"PolarRadar"===t.chartAreaType||!(n.zoomFactor<1||n.zoomPosition>0||this.paddingInterval)||(i=n.visibleRange.min-n.visibleRange.min%n.visibleRange.interval);var s,r=this.getFormat(n),f=null!==r.match("{value}"),e=0,o=0;for(n.labelFormat&&n.labelFormat.indexOf("n")>-1&&(o=parseInt(n.labelFormat.substring(1,n.labelFormat.length),10)),n.format=t.intl.getNumberFormat({format:f?"":r,useGrouping:t.useGroupingSeparator}),n.startLabel=n.format(n.visibleRange.min),n.endLabel=n.format(n.visibleRange.max),n.visibleRange.interval&&(n.visibleRange.interval+"").indexOf(".")>=0&&(e=(n.visibleRange.interval+"").split(".")[1].length);i<=n.visibleRange.max&&s!==i;i+=n.visibleRange.interval)s=i,u=sf.base.extend({},sf.base.getValue("properties",n.labelStyle),null,!0),ti(i,n.visibleRange)&&hr(t,i,this.formatValue(n,f,r,i),u,n);i&&(i+"").indexOf(".")>=0&&(i+"").split(".")[1].length>10&&(i=(i+"").split(".")[1].length>(o||e)?+i.toFixed(o||e):i)<=n.visibleRange.max&&hr(t,i,this.formatValue(n,f,r,i),u,n);n.getMaxLabelWidth&&n.getMaxLabelWidth(this.chart)},n.prototype.getFormat=function(n){return n.labelFormat?0===n.labelFormat.indexOf("p")&&-1===n.labelFormat.indexOf("{value}")&&n.isStack100?"{value}%":n.labelFormat:n.isStack100?"{value}%":""},n.prototype.formatValue=function(n,t,i,r){return t?i.replace("{value}",n.format(r)):n.format(r)},n}(),ut=(bt=function(n,t){return(bt=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}bt(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),f=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},or=(function(n){function t(){return null!==n&&n.apply(this,arguments)||this}ut(t,n);f([sf.base.Property("0")],t.prototype,"x",void 0);f([sf.base.Property("0")],t.prototype,"y",void 0);f([sf.base.Property(null)],t.prototype,"content",void 0);f([sf.base.Property("Center")],t.prototype,"horizontalAlignment",void 0);f([sf.base.Property("Pixel")],t.prototype,"coordinateUnits",void 0);f([sf.base.Property("Chart")],t.prototype,"region",void 0);f([sf.base.Property("Middle")],t.prototype,"verticalAlignment",void 0);f([sf.base.Property(null)],t.prototype,"xAxisName",void 0);f([sf.base.Property(null)],t.prototype,"yAxisName",void 0);f([sf.base.Property(null)],t.prototype,"description",void 0)}(sf.base.ChildProperty),function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ut(t,n),f([sf.base.Property("")],t.prototype,"color",void 0),f([sf.base.Property(1)],t.prototype,"width",void 0),f([sf.base.Property("Rectangle")],t.prototype,"type",void 0),t}(sf.base.ChildProperty)),nf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ut(t,n),f([sf.base.Property(null)],t.prototype,"start",void 0),f([sf.base.Property(null)],t.prototype,"end",void 0),f([sf.base.Property("")],t.prototype,"text",void 0),f([sf.base.Property(null)],t.prototype,"maximumTextWidth",void 0),f([sf.base.Property(null)],t.prototype,"customAttributes",void 0),f([sf.base.Property("")],t.prototype,"type",void 0),t}(sf.base.ChildProperty),tf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ut(t,n),f([sf.base.Property(!0)],t.prototype,"visible",void 0),f([sf.base.Property(!1)],t.prototype,"startFromAxis",void 0),f([sf.base.Property(null)],t.prototype,"start",void 0),f([sf.base.Property(null)],t.prototype,"end",void 0),f([sf.base.Property(null)],t.prototype,"size",void 0),f([sf.base.Property("#808080")],t.prototype,"color",void 0),f([sf.base.Property(null)],t.prototype,"dashArray",void 0),f([sf.base.Property("Auto")],t.prototype,"sizeType",void 0),f([sf.base.Property(!1)],t.prototype,"isRepeat",void 0),f([sf.base.Property(null)],t.prototype,"repeatEvery",void 0),f([sf.base.Property(null)],t.prototype,"repeatUntil",void 0),f([sf.base.Property(!1)],t.prototype,"isSegmented",void 0),f([sf.base.Property(null)],t.prototype,"segmentStart",void 0),f([sf.base.Property(null)],t.prototype,"segmentEnd",void 0),f([sf.base.Property(null)],t.prototype,"segmentAxisName",void 0),f([sf.base.Complex({color:"transparent",width:1},d)],t.prototype,"border",void 0),f([sf.base.Property("")],t.prototype,"text",void 0),f([sf.base.Property(null)],t.prototype,"rotation",void 0),f([sf.base.Property("Middle")],t.prototype,"horizontalAlignment",void 0),f([sf.base.Property("Middle")],t.prototype,"verticalAlignment",void 0),f([sf.base.Complex(b.stripLineLabelFont,k)],t.prototype,"textStyle",void 0),f([sf.base.Property("Behind")],t.prototype,"zIndex",void 0),f([sf.base.Property(1)],t.prototype,"opacity",void 0),t}(sf.base.ChildProperty),rf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ut(t,n),f([sf.base.Property("Center")],t.prototype,"alignment",void 0),f([sf.base.Property("Wrap")],t.prototype,"overflow",void 0),f([sf.base.Complex(b.axisLabelFont,k)],t.prototype,"textStyle",void 0),f([sf.base.Complex({color:null,width:1,type:"Rectangle"},or)],t.prototype,"border",void 0),f([sf.base.Collection([],nf)],t.prototype,"categories",void 0),t}(sf.base.ChildProperty),uf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ut(t,n),f([sf.base.Property(null)],t.prototype,"minimum",void 0),f([sf.base.Property(null)],t.prototype,"maximum",void 0),t}(sf.base.ChildProperty),ff=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ut(t,n),f([sf.base.Property(!1)],t.prototype,"enable",void 0),f([sf.base.Property(null)],t.prototype,"pointsLength",void 0),f([sf.base.Complex({},uf)],t.prototype,"range",void 0),t}(sf.base.ChildProperty),nt=(kt=function(n,t){return(kt=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}kt(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),i=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},ef=(function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.axes=[],t.nearSizes=[],t.farSizes=[],t}nt(t,n);t.prototype.computeSize=function(n,t){var i=0;n.visible&&n.internalVisibility&&(i+=n.findTickSize(n.crossInAxis)+t+n.findLabelSize(n.crossInAxis,5)+.5*n.lineStyle.width);n.opposedPosition?this.farSizes.push(i):this.nearSizes.push(i)};i([sf.base.Property("100%")],t.prototype,"height",void 0);i([sf.base.Complex({},d)],t.prototype,"border",void 0)}(sf.base.ChildProperty),function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.axes=[],t.nearSizes=[],t.farSizes=[],t.padding=0,t}nt(t,n);t.prototype.computeSize=function(n,t){var i=0;n.visible&&n.internalVisibility&&(i+=n.findTickSize(n.crossInAxis)+t+n.findLabelSize(n.crossInAxis,5)+.5*n.lineStyle.width);n.opposedPosition?this.farSizes.push(i):this.nearSizes.push(i)};i([sf.base.Property("100%")],t.prototype,"width",void 0);i([sf.base.Complex({},d)],t.prototype,"border",void 0)}(sf.base.ChildProperty),function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return nt(t,n),i([sf.base.Property(1)],t.prototype,"width",void 0),i([sf.base.Property("")],t.prototype,"dashArray",void 0),i([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty)),hf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return nt(t,n),i([sf.base.Property(.7)],t.prototype,"width",void 0),i([sf.base.Property("")],t.prototype,"dashArray",void 0),i([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),cf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return nt(t,n),i([sf.base.Property(1)],t.prototype,"width",void 0),i([sf.base.Property("")],t.prototype,"dashArray",void 0),i([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),lf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return nt(t,n),i([sf.base.Property(1)],t.prototype,"width",void 0),i([sf.base.Property(5)],t.prototype,"height",void 0),i([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),af=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return nt(t,n),i([sf.base.Property(.7)],t.prototype,"width",void 0),i([sf.base.Property(5)],t.prototype,"height",void 0),i([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),vf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return nt(t,n),i([sf.base.Property(!1)],t.prototype,"enable",void 0),i([sf.base.Property(null)],t.prototype,"fill",void 0),i([sf.base.Complex(b.crosshairLabelFont,k)],t.prototype,"textStyle",void 0),t}(sf.base.ChildProperty),yf=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return f.visibleLabels=[],f.series=[],f.rect=new sf.svgbase.Rect(void 0,void 0,0,0),f.axisBottomLine=null,f.intervalDivs=[10,5,2,1],f.isStack100=!1,f.crossAt=null,f.updatedRect=null,f.multiLevelLabelHeight=0,f.isChart=!0,f.isIntervalInDecimal=!0,f.titleCollection=[],f.titleSize=new sf.svgbase.Size(0,0),f.internalVisibility=!0,f.angle=f.labelRotation,f}nt(t,n);t.prototype.findTickSize=function(n){return"Inside"===this.tickPosition?0:!n||n.visibleRange&&!this.isInside(n.visibleRange)?this.majorTickLines.height:0};t.prototype.isInside=function(n){return function(n,t){return n<t.max&&n>t.min}(this.crossAt,n)||!this.opposedPosition&&this.crossAt>=n.max||this.opposedPosition&&this.crossAt<=n.min};t.prototype.findLabelSize=function(n,t){var u,o,f=0,h="Horizontal"===this.orientation,s,i,r,e;if(this.title&&(this.titleSize=sf.svgbase.measureText(this.title,this.titleStyle),f=this.titleSize.height+t,this.rect.width||this.rect.height)&&(s=h?this.rect.width:this.rect.height,this.titleCollection=at(this.title,this.titleStyle,s),f*=this.titleCollection.length),"Inside"===this.labelPosition)return f+t;if(i=f+t+this.titlePadding+this.labelPadding+("Vertical"===this.orientation?this.maxLabelSize.width:this.maxLabelSize.height)+this.multiLevelLabelHeight,n&&this.placeNextToAxisLine){if(r=n.visibleRange,e="Horizontal"===n.orientation?n.rect.width:n.rect.height,!r||!e)return 0;this.isInside(r)&&(i=(u=(o=this.findDifference(n))*((e-((u=o*(e/r.delta))<i?i-u:0))/r.delta))<i?i-u:0)}return i};t.prototype.updateCrossValue=function(){var n=this.crossAt,t;if(null===n||!this.isInside(this.crossInAxis.visibleRange))return this.updatedRect=this.rect,null;t=this.crossInAxis.visibleRange;this.opposedPosition?this.crossAt<t.min&&(n=t.min):this.crossAt>t.max&&(n=t.max);this.updatedRect=sf.base.extend({},this.rect,null,!0);"Horizontal"===this.orientation?(n=this.crossInAxis.rect.height-et(n,this.crossInAxis)*this.crossInAxis.rect.height,this.updatedRect.y=this.crossInAxis.rect.y+n):(n=et(n,this.crossInAxis)*this.crossInAxis.rect.width,this.updatedRect.x=this.crossInAxis.rect.x+n)};t.prototype.findDifference=function(n){var t=0;return t=this.opposedPosition?n.isInversed?n.visibleRange.min:n.visibleRange.max:n.isInversed?n.visibleRange.max:n.visibleRange.min,Math.abs(this.crossAt-t)};t.prototype.calculateVisibleRangeOnZooming=function(){var r;if((r=this).zoomFactor<1&&r.zoomPosition>=0){var t=this.actualRange,n=void 0,i=void 0;i=this.isInversed?(n=this.actualRange.max-this.zoomPosition*this.actualRange.delta)-this.zoomFactor*this.actualRange.delta:(n=this.actualRange.min+this.zoomPosition*this.actualRange.delta)+this.zoomFactor*this.actualRange.delta;n<t.min&&(i+=t.min-n,n=t.min);i>t.max&&(n-=i-t.max,i=t.max);this.doubleRange=new gt(n,i);this.visibleRange={min:this.doubleRange.start,max:this.doubleRange.end,delta:this.doubleRange.delta,interval:this.visibleRange.interval}}};t.prototype.calculateAxisRange=function(n,t){var i,f,h,u,e,a,r;if(t.enableAutoIntervalOnBothAxis){if("Horizontal"===this.orientation&&"X"===t.zoomSettings.mode)for(i=0;i<this.series.length;i++){for(var o=[],s=0,v=this.series[i].visiblePoints;s<v.length;s++)(u=v[s]).xValue>this.visibleRange.min&&u.xValue<this.visibleRange.max&&o.push(u.yValue);for(f=0,h=t.axisCollections;f<h.length;f++)"Vertical"!==(r=h[f]).orientation||sf.base.isNullOrUndefined(r.series[i])||(r.series[i].yMin=Math.min.apply(Math,o),r.series[i].yMax=Math.max.apply(Math,o),r.baseModule.calculateRangeAndInterval(n,r))}if("Vertical"===this.orientation&&"Y"===t.zoomSettings.mode)for(i=0;i<this.series.length;i++){for(var c=[],l=0,y=this.series[i].visiblePoints;l<y.length;l++)(u=y[l]).yValue>this.visibleRange.min&&u.yValue<this.visibleRange.max&&c.push(u.xValue);for(e=0,a=t.axisCollections;e<a.length;e++)"Horizontal"!==(r=a[e]).orientation||sf.base.isNullOrUndefined(r.series[i])||(r.series[i].xMin=Math.min.apply(Math,c),r.series[i].xMax=Math.max.apply(Math,c),r.baseModule.calculateRangeAndInterval(n,r))}}};t.prototype.triggerRangeRender=function(n,t,i,r){var u={cancel:!1,name:"axisRangeCalculated",axis:this,minimum:t,maximum:i,interval:r};n.trigger("axisRangeCalculated",u);u.cancel||(this.visibleRange={min:u.minimum,max:u.maximum,interval:u.interval,delta:u.maximum-u.minimum})};t.prototype.getRangePadding=function(n){var t=this.rangePadding;if("Auto"!==t)return t;switch(this.orientation){case"Horizontal":t=n.requireInvertedAxis?this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal":"None";break;case"Vertical":t=n.requireInvertedAxis?"None":this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal"}return t};t.prototype.getMaxLabelWidth=function(n){var i,u,h=0,p=!1,c,l,e,s,y,b;this.angle=this.labelRotation;this.maxLabelSize=new sf.svgbase.Size(0,0);for(var t,f=this.labelIntersectAction,r=0,k=this.visibleLabels.length;r<k;r++)if((u=ni((t=this.visibleLabels[r]).originalText))?(t.size=sf.svgbase.measureText(t.originalText.replace(/<br>/g," "),this.labelStyle),t.breakLabelSize=sf.svgbase.measureText(this.enableTrim?t.text.join("<br>"):t.originalText,this.labelStyle)):t.size=sf.svgbase.measureText(t.text,this.labelStyle),c=u?t.breakLabelSize.width:t.size.width,c>this.maxLabelSize.width&&(this.maxLabelSize.width=c,this.rotatedLabel=t.text),l=u?t.breakLabelSize.height:t.size.height,l>this.maxLabelSize.height&&(this.maxLabelSize.height=l),u&&(t.text=this.enableTrim?t.text:t.originalText.split("<br>")),"None"!==f&&"Hide"!==f&&"Trim"!==f&&("None"!==f||this.angle%360==0)&&"Horizontal"===this.orientation&&this.rect.width>0&&!p){e=u?t.breakLabelSize.width:t.size.width;switch(i=et(t.value,this)*this.rect.width+this.rect.x,i-=e/2,"Shift"===this.edgeLabelPlacement&&(0===r&&i<this.rect.x&&(i=this.rect.x),r===this.visibleLabels.length-1&&i+e>this.rect.x+this.rect.width&&(i=this.rect.x+this.rect.width-e)),f){case"MultipleRows":r>0&&this.findMultiRows(r,i,t,u);break;case"Rotate45":case"Rotate90":r>0&&(this.isInversed?i+e>=h:i<=h)&&(this.angle="Rotate45"===f?45:90,p=!0);break;default:if(u){for(var o=void 0,a=[],w=void 0,v=0;v<t.text.length;v++)if((o=fi(t.text[v],this.rect.width/this.visibleLabels.length,this.labelStyle)).length>1)for(s=0;s<o.length;s++)w=o[s],a.push(w);else a.push(o[0]);t.text=a}else t.text=fi(t.text,this.rect.width/this.visibleLabels.length,this.labelStyle);y=t.size.height*t.text.length;y>this.maxLabelSize.height&&(this.maxLabelSize.height=y)}h=this.isInversed?i:i+e}0!==this.angle&&"Horizontal"===this.orientation&&(this.rotatedLabel=sf.base.isNullOrUndefined(this.rotatedLabel)?"":this.rotatedLabel,b=-360===this.angle||0===this.angle||-180===this.angle||180===this.angle||360===this.angle,this.maxLabelSize="Outside"===this.labelPosition&&!b&&ni(this.rotatedLabel)?new sf.svgbase.Size(this.maxLabelSize.height,this.maxLabelSize.width):function(n,t,i,r){var h,c,l,a,v,y=new sf.svgbase.SvgRenderer(r.element.id),u=[],s={id:"rotate_text",x:r.initialClipRect.x,y:r.initialClipRect.y,"font-size":n.size,"font-style":n.fontStyle,"font-family":n.fontFamily,"font-weight":n.fontWeight,transform:"rotate("+i+", 0, 0)","text-anchor":"middle"},e,f,p,o;if(ni(t)?(u=t.split("<br>"),h=u[0]):h=t,e=y.createText(s,h),r.delayRedraw||r.redraw||r.element.appendChild(r.svgObject),"string"!=typeof u&&u.length>1)for(f=1,p=u.length;f<p;f++)c=sf.svgbase.measureText(u[f],n).height,l=s.y+f*c,a=u[f],v=y.createTSpan({x:s.x,id:s.id,y:l},a),e.appendChild(v);return r.svgObject.appendChild(e),o=e.getBoundingClientRect(),sf.base.remove(e),r.delayRedraw||r.redraw||sf.base.remove(r.svgObject),new sf.svgbase.Size(o.right-o.left,o.bottom-o.top)}(this.labelStyle,this.rotatedLabel,this.angle,n));n.multiLevelLabelModule&&this.multiLevelLabels.length>0&&n.multiLevelLabelModule.getMultilevelLabelsHeight(this)};t.prototype.findMultiRows=function(n,t,i,r){for(var u,e,o,h,s=[],f=n-1;f>=0;f--)u=this.visibleLabels[f],o=r?u.breakLabelSize.width:u.size.width,e=et(u.value,this)*this.rect.width+this.rect.x,(this.isInversed?t+i.size.width>e-.5*o:t<e+.5*o)?(s.push(u.index),i.index=i.index>u.index?i.index:u.index+1):i.index=s.indexOf(u.index)>-1?i.index:u.index;h=(r?i.breakLabelSize.height:i.size.height)*i.index+5*(i.index-1);h>this.maxLabelSize.height&&(this.maxLabelSize.height=h)};t.prototype.getModule=function(n){this.baseModule="Double"===this.valueType?new gu(n):n[lt(this.valueType)+"Module"]};i([sf.base.Complex(b.axisLabelFont,k)],t.prototype,"labelStyle",void 0);i([sf.base.Complex({},vf)],t.prototype,"crosshairTooltip",void 0);i([sf.base.Property("")],t.prototype,"title",void 0);i([sf.base.Complex(b.axisTitleFont,k)],t.prototype,"titleStyle",void 0);i([sf.base.Property("")],t.prototype,"labelFormat",void 0);i([sf.base.Property("")],t.prototype,"skeleton",void 0);i([sf.base.Property("DateTime")],t.prototype,"skeletonType",void 0);i([sf.base.Property("Center")],t.prototype,"lineBreakAlignment",void 0);i([sf.base.Property(0)],t.prototype,"plotOffset",void 0);i([sf.base.Property(null)],t.prototype,"plotOffsetLeft",void 0);i([sf.base.Property(null)],t.prototype,"plotOffsetTop",void 0);i([sf.base.Property(null)],t.prototype,"plotOffsetRight",void 0);i([sf.base.Property(null)],t.prototype,"plotOffsetBottom",void 0);i([sf.base.Property(!1)],t.prototype,"isIndexed",void 0);i([sf.base.Property(10)],t.prototype,"logBase",void 0);i([sf.base.Property(0)],t.prototype,"columnIndex",void 0);i([sf.base.Property(0)],t.prototype,"rowIndex",void 0);i([sf.base.Property(1)],t.prototype,"span",void 0);i([sf.base.Property(null)],t.prototype,"desiredIntervals",void 0);i([sf.base.Property(3)],t.prototype,"maximumLabels",void 0);i([sf.base.Property(1)],t.prototype,"zoomFactor",void 0);i([sf.base.Property(0)],t.prototype,"zoomPosition",void 0);i([sf.base.Property(!0)],t.prototype,"enableScrollbarOnZooming",void 0);i([sf.base.Property(!1)],t.prototype,"opposedPosition",void 0);i([sf.base.Property(!0)],t.prototype,"enableAutoIntervalOnZooming",void 0);i([sf.base.Property("Auto")],t.prototype,"rangePadding",void 0);i([sf.base.Property("Double")],t.prototype,"valueType",void 0);i([sf.base.Property("None")],t.prototype,"edgeLabelPlacement",void 0);i([sf.base.Property("Auto")],t.prototype,"intervalType",void 0);i([sf.base.Property("BetweenTicks")],t.prototype,"labelPlacement",void 0);i([sf.base.Property("Outside")],t.prototype,"tickPosition",void 0);i([sf.base.Property("Outside")],t.prototype,"labelPosition",void 0);i([sf.base.Property("")],t.prototype,"name",void 0);i([sf.base.Property(!0)],t.prototype,"visible",void 0);i([sf.base.Property(0)],t.prototype,"minorTicksPerInterval",void 0);i([sf.base.Property(0)],t.prototype,"labelRotation",void 0);i([sf.base.Property(null)],t.prototype,"crossesAt",void 0);i([sf.base.Property(!0)],t.prototype,"placeNextToAxisLine",void 0);i([sf.base.Property(null)],t.prototype,"crossesInAxis",void 0);i([sf.base.Property(null)],t.prototype,"minimum",void 0);i([sf.base.Property(null)],t.prototype,"maximum",void 0);i([sf.base.Property(null)],t.prototype,"interval",void 0);i([sf.base.Property(34)],t.prototype,"maximumLabelWidth",void 0);i([sf.base.Property(!1)],t.prototype,"enableTrim",void 0);i([sf.base.Property(5)],t.prototype,"labelPadding",void 0);i([sf.base.Property(5)],t.prototype,"titlePadding",void 0);i([sf.base.Complex({},lf)],t.prototype,"majorTickLines",void 0);i([sf.base.Complex({},af)],t.prototype,"minorTickLines",void 0);i([sf.base.Complex({},ef)],t.prototype,"majorGridLines",void 0);i([sf.base.Complex({},hf)],t.prototype,"minorGridLines",void 0);i([sf.base.Complex({},cf)],t.prototype,"lineStyle",void 0);i([sf.base.Property("Trim")],t.prototype,"labelIntersectAction",void 0);i([sf.base.Property(!1)],t.prototype,"isInversed",void 0);i([sf.base.Property(100)],t.prototype,"coefficient",void 0);i([sf.base.Property(0)],t.prototype,"startAngle",void 0);i([sf.base.Property(!0)],t.prototype,"startFromZero",void 0);i([sf.base.Property(null)],t.prototype,"description",void 0);i([sf.base.Property(2)],t.prototype,"tabIndex",void 0);i([sf.base.Collection([],tf)],t.prototype,"stripLines",void 0);i([sf.base.Collection([],rf)],t.prototype,"multiLevelLabels",void 0);i([sf.base.Complex({color:null,width:0,type:"Rectangle"},or)],t.prototype,"border",void 0);i([sf.base.Complex({},ff)],t.prototype,"scrollbarSettings",void 0)}(sf.base.ChildProperty),function(n,t,i,r,u,f,e){void 0===u&&(u=new sf.svgbase.Size(0,0));void 0===f&&(f=new sf.svgbase.Size(0,0));void 0===e&&(e=1);this.text=n;this.originalText=r;this.value=t;this.labelStyle=i;this.size=u;this.breakLabelSize=f;this.index=e}),sr=(dt=function(n,t){return(dt=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}dt(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});var ei,oi=function(n){function t(t,i,r,u,f,e,o,s,h){var c=n.call(this,t,i,r.width,r.color,u,h)||this;return c.y=f.y,c.x=f.x,c.height=f.height,c.width=f.width,c.rx=e||0,c.ry=o||0,c.transform=s||"",c.stroke=0!==r.width&&""!==c.stroke?r.color:"transparent",c}return sr(t,n),t}(sf.svgbase.PathOption),df=function(n,t,i,r,u,f,e,o){this.height=n;this.width=t;this.href=i;this.x=r;this.y=u;this.id=f;this.visibility=e;this.preserveAspectRatio=o},s=(function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,t,i,r.width,r.color,u)||this;return s.cy=e,s.cx=f,s.r=o,s}sr(t,n)}(sf.svgbase.PathOption),function(n,t){this.x=n;this.y=t}),st=function(n,t,i,r){this.left=n;this.right=t;this.top=i;this.bottom=r},si=function(n,t,i){this.r=n;this.g=t;this.b=i},hi=function(n,t,i){void 0===i&&(i=0);this.point=n;this.series=t;this.lierIndex=i},br=function(n,t,i){void 0===i&&(i=0);this.point=n;this.series=t;this.index=i},vt=(ei=function(n,t){return(ei=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ei(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},kr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return vt(t,n),u([sf.base.Property(null)],t.prototype,"content",void 0),u([sf.base.Property("0")],t.prototype,"x",void 0),u([sf.base.Property("0")],t.prototype,"y",void 0),u([sf.base.Property("Pixel")],t.prototype,"coordinateUnits",void 0),u([sf.base.Property("Chart")],t.prototype,"region",void 0),u([sf.base.Property("Middle")],t.prototype,"verticalAlignment",void 0),u([sf.base.Property("Center")],t.prototype,"horizontalAlignment",void 0),u([sf.base.Property(null)],t.prototype,"description",void 0),t}(sf.base.ChildProperty),dr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return vt(t,n),u([sf.base.Property(!1)],t.prototype,"visible",void 0),u([sf.base.Property(!0)],t.prototype,"showZero",void 0),u([sf.base.Property(null)],t.prototype,"name",void 0),u([sf.base.Property("transparent")],t.prototype,"fill",void 0),u([sf.base.Property("Inside")],t.prototype,"position",void 0),u([sf.base.Property(5)],t.prototype,"rx",void 0),u([sf.base.Property(5)],t.prototype,"ry",void 0),u([sf.base.Property(0)],t.prototype,"angle",void 0),u([sf.base.Property(!1)],t.prototype,"enableRotation",void 0),u([sf.base.Complex({width:null,color:null},d)],t.prototype,"border",void 0),u([sf.base.Complex({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},k)],t.prototype,"font",void 0),u([sf.base.Complex({},vu)],t.prototype,"connectorStyle",void 0),u([sf.base.Property(null)],t.prototype,"template",void 0),t}(sf.base.ChildProperty),gr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return vt(t,n),u([sf.base.Property("50%")],t.prototype,"x",void 0),u([sf.base.Property("50%")],t.prototype,"y",void 0),t}(sf.base.ChildProperty),ci=function(){this.visible=!0;this.symbolLocation=null;this.region=null;this.labelRegion=null;this.labelVisible=!0;this.regions=null;this.isExplode=!1;this.isClubbed=!1;this.isSliced=!1;this.argsData=null;this.isLabelUpdated=null;this.initialLabelRegion=null},nu=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.points=[],t.clubbedPoints=[],t.sumOfPoints=0,t.isRectSeries=!0,t.clipRect=new sf.svgbase.Rect(0,0,0,0),t.category="Series",t.rightSidePoints=[],t.leftSidePoints=[],t}return vt(t,n),t.prototype.refreshDataManager=function(n,t){var r=this,i=this.dataSource||n.dataSource;_instanceof(i,sf.data.DataManager)||!sf.base.isNullOrUndefined(this.query)?this.dataModule.getData(this.dataModule.generateQuery().requiresCount()).then(function(t){return r.dataManagerSuccess(t,n)}):this.dataManagerSuccess({result:i,count:i.length},n,t)},t.prototype.dataManagerSuccess=function(n,t,i){void 0===i&&(i=!0);var r={name:"seriesRender",series:this,data:n.result};t.allowServerDataBinding=!1;t.trigger("seriesRender",r);this.resultData=""!==n.result?n.result:[];t.isBlazor||i||this.getPoints(this.resultData,t);(++t.seriesCounts===t.visibleSeries.length&&i||window.Blazor&&!i&&1===t.seriesCounts)&&(this.getPoints(this.resultData,t),t.refreshChart())},t.prototype.getPoints=function(n,t){var i,e=Object.keys(n).length,f,s;if(this.sumOfPoints=0,0===e)return null;this.findSumOfPoints(n);this.points=[];this.clubbedPoints=[];this.sumOfClub=0;for(var u=this.palettes.length?this.palettes:function(n){var t;switch(n){case"Fabric":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"Bootstrap4":case"Bootstrap":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"HighContrastLight":case"Highcontrast":case"HighContrast":t=["#79ECE4","#E98272","#DFE6B6","#C6E773","#BA98FF","#FA83C3","#00C27A","#43ACEF","#D681EF","#D8BC6E"];break;case"MaterialDark":t=["#9ECB08","#56AEFF","#C57AFF","#61EAA9","#EBBB3E","#F45C5C","#8A77FF","#63C7FF","#FF84B0","#F7C928"];break;case"FabricDark":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"BootstrapDark":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"Tailwind":t=["#5A61F6","#65A30D","#334155","#14B8A6","#8B5CF6","#0369A1","#F97316","#9333EA","#F59E0B","#15803D"];break;case"TailwindDark":t=["#8B5CF6","#22D3EE","#F87171","#4ADE80","#E879F9","#FCD34D","#F97316","#2DD4BF","#F472B6","#10B981"];break;case"Bootstrap5":t=["#262E0B","#668E1F","#AF6E10","#862C0B","#1F2D50","#64680B","#311508","#4C4C81","#0C7DA0","#862C0B"];break;case"Bootstrap5Dark":t=["#5ECB9B","#A860F1","#EBA844","#557EF7","#E9599B","#BFC529","#3BC6CF","#7A68EC","#74B706","#EA6266"];break;default:t=["#00bdae","#404041","#357cd2","#e56590","#f8b883","#70ad47","#dd8abd","#7f84e8","#7bb4eb","#ea7a57"]}return t}(t.theme),h=o(this.groupTo,this.sumOfPoints),r=0;r<e;r++)(i=this.setPoints(n,r,u,t)).y,this.isClub(i,h,r)?(i.index=this.clubbedPoints.length,i.isExplode=!0,this.clubbedPoints.push(i),i.isSliced=!0):(sf.base.isNullOrUndefined(i.y)&&(i.visible=!1),this.pushPoints(i,u));(this.lastGroupTo=this.groupTo,this.sumOfClub>0)&&(f=this.generateClubPoint(),this.pushPoints(f,u),s=this.points.length-1,this.clubbedPoints.map(function(n){n.index+=s;n.color=f.color}));this.clubbedPoints.length&&this.explode&&"Pie"===this.type&&(this.explodeAll||this.points[this.points.length-1].index===this.explodeIndex)&&(this.points.splice(this.points.length-1,1),this.points=this.points.concat(this.clubbedPoints))},t.prototype.generateClubPoint=function(){var n=new ci;return n.isClubbed=!0,n.x="Others",n.y=this.sumOfClub,n.text=n.originalText=n.x+": "+this.sumOfClub,n.sliceRadius="80%",n},t.prototype.pushPoints=function(n,t){n.index=this.points.length;n.isExplode=this.explodeAll||n.index===this.explodeIndex;n.color=n.color||t[n.index%t.length];this.points.push(n)},t.prototype.isClub=function(n,t,i){return!sf.base.isNullOrUndefined(t)&&("Value"===this.groupMode&&Math.abs(n.y)<=t||"Point"===this.groupMode&&i>=t)?(this.sumOfClub+=Math.abs(n.y),!0):!1},t.prototype.findSumOfPoints=function(n){for(var i=Object.keys(n).length,t=0;t<i;t++)sf.base.isNullOrUndefined(n[t])||sf.base.isNullOrUndefined(n[t][this.yName])||isNaN(n[t][this.yName])||(this.sumOfPoints+=Math.abs(n[t][this.yName]))},t.prototype.setPoints=function(n,t,i,r){var u=new ci;return u.x=sf.base.getValue(this.xName,n[t]),u.y=sf.base.getValue(this.yName,n[t]),u.percentage=+(u.y/this.sumOfPoints*100).toFixed(2),u.legendImageUrl=sf.base.getValue(this.legendImageUrl,n[t]),u.color=sf.base.getValue(this.pointColorMapping,n[t]),u.text=u.originalText=sf.base.getValue(this.dataLabel.name||"",n[t]),u.tooltip=sf.base.getValue(this.tooltipMappingName||"",n[t]),u.sliceRadius=sf.base.getValue(this.radius,n[t]),u.sliceRadius=sf.base.isNullOrUndefined(u.sliceRadius)?"80%":u.sliceRadius,u.separatorY=r.intl.formatNumber(u.y,{useGrouping:r.useGroupingSeparator}),this.setAccEmptyPoint(u,t,n,i),u},t.prototype.renderSeries=function(n,t){var i,r=t?h(n.element.id+"_Series_"+this.index):n.renderer.createGroup({id:n.element.id+"_Series_"+this.index});this.renderPoints(n,r,t);n.accumulationDataLabelModule&&this.dataLabel.visible&&((i=n.renderer.createGroup({id:n.element.id+"_datalabel_Series_"+this.index})).style.visibility=this.animation.enable&&n.animateSeries&&"Pie"===this.type?"hidden":"visible",this.renderDataLabel(n,i,t));"Pie"===this.type&&(this.findMaxBounds(this.labelBound,this.accumulationBound),n.pieSeriesModule.animateSeries(n,this.animation,this,r));n.accumulationLegendModule&&(this.labelBound.x-=n.explodeDistance,this.labelBound.y-=n.explodeDistance,this.labelBound.height+=n.explodeDistance-this.labelBound.y,this.labelBound.width+=n.explodeDistance-this.labelBound.x)},t.prototype.renderPoints=function(n,t,i){for(var r,u,e,s=n.element.id+"_Series_"+this.index+"_Point_",f=0,o=this.points;f<o.length;f++)r=o[f],u={cancel:!1,name:"pointRender",series:this,point:r,fill:r.color,border:this.isEmpty(r)?{width:this.emptyPointSettings.border.width,color:this.emptyPointSettings.border.color}:{width:this.border.width,color:this.border.color}},n.trigger("pointRender",u),r.color=u.fill,e=new sf.svgbase.PathOption(s+r.index,r.color,u.border.width||1,u.border.color||r.color,this.opacity,"",""),n[lt(this.type)+"SeriesModule"].renderPoint(r,this,n,e,t,i);y(!1,n.getSeriesElement(),t,i)},t.prototype.renderDataLabel=function(n,t,i){var u,r,c;n.accumulationDataLabelModule.findAreaRect();u=sf.base.createElement("div",{id:n.element.id+"_Series_0_DataLabelCollections"});this.leftSidePoints=[];this.rightSidePoints=[];for(var f=[],e=[],o=0,s=this.points;o<s.length;o++)r=s[o],r.visible&&(this.dataLabel.showZero||!this.dataLabel.showZero&&(0!==r.y||0===r.y&&"Zero"===this.emptyPointSettings.mode))&&n.accumulationDataLabelModule.renderDataLabel(r,this.dataLabel,t,this.points,this.index,u,i),r.midAngle>=90&&r.midAngle<=270?this.leftSidePoints.push(r):r.midAngle>=0&&r.midAngle<=90?e.push(r):f.push(r);(f.sort(function(n,t){return n.midAngle-t.midAngle}),e.sort(function(n,t){return n.midAngle-t.midAngle}),this.leftSidePoints.sort(function(n,t){return n.midAngle-t.midAngle}),this.rightSidePoints=f.concat(e),n.accumulationDataLabelModule.drawDataLabels(this,this.dataLabel,t,u,i),null!==this.dataLabel.template&&u.childElementCount)&&(c=n.accumulationDataLabelModule.drawDataLabels.bind(n.accumulationDataLabelModule,this,this.dataLabel,t,u,i),n.isReact&&n.renderReactTemplates(c),y(!1,h(n.element.id+"_Secondary_Element"),u,i));y(!1,n.getSeriesElement(),t,i)},t.prototype.findMaxBounds=function(n,t){n.x=t.x<n.x?t.x:n.x;n.y=t.y<n.y?t.y:n.y;n.height=t.y+t.height>n.height?t.y+t.height:n.height;n.width=t.x+t.width>n.width?t.x+t.width:n.width},t.prototype.setAccEmptyPoint=function(n,t,i){if(!sf.base.isNullOrUndefined(n.y)&&!isNaN(n.y))return null;switch(n.color=this.emptyPointSettings.fill||n.color,this.emptyPointSettings.mode){case"Zero":n.y=0;n.visible=!0;break;case"Average":var r=i[t-1]&&i[t-1][this.yName]||0,u=i[t+1]&&i[t+1][this.yName]||0;n.y=(Math.abs(r)+Math.abs(u))/2;this.sumOfPoints+=n.y;n.visible=!0;break;default:n.visible=!1}},t.prototype.isEmpty=function(n){return n.color===this.emptyPointSettings.fill},u([sf.base.Property("")],t.prototype,"dataSource",void 0),u([sf.base.Property()],t.prototype,"query",void 0),u([sf.base.Property("")],t.prototype,"xName",void 0),u([sf.base.Property("")],t.prototype,"name",void 0),u([sf.base.Property("")],t.prototype,"tooltipMappingName",void 0),u([sf.base.Property("")],t.prototype,"yName",void 0),u([sf.base.Property(!0)],t.prototype,"visible",void 0),u([sf.base.Complex({color:null,width:0},d)],t.prototype,"border",void 0),u([sf.base.Complex(null,pu)],t.prototype,"animation",void 0),u([sf.base.Property("SeriesType")],t.prototype,"legendShape",void 0),u([sf.base.Property("")],t.prototype,"legendImageUrl",void 0),u([sf.base.Property("")],t.prototype,"pointColorMapping",void 0),u([sf.base.Property(null)],t.prototype,"selectionStyle",void 0),u([sf.base.Property(null)],t.prototype,"groupTo",void 0),u([sf.base.Property("Value")],t.prototype,"groupMode",void 0),u([sf.base.Complex({},dr)],t.prototype,"dataLabel",void 0),u([sf.base.Property([])],t.prototype,"palettes",void 0),u([sf.base.Property(0)],t.prototype,"startAngle",void 0),u([sf.base.Property(null)],t.prototype,"endAngle",void 0),u([sf.base.Property("80%")],t.prototype,"radius",void 0),u([sf.base.Property("0")],t.prototype,"innerRadius",void 0),u([sf.base.Property("Pie")],t.prototype,"type",void 0),u([sf.base.Property(!0)],t.prototype,"enableTooltip",void 0),u([sf.base.Property(!1)],t.prototype,"explode",void 0),u([sf.base.Property("30%")],t.prototype,"explodeOffset",void 0),u([sf.base.Property(!1)],t.prototype,"explodeAll",void 0),u([sf.base.Property(null)],t.prototype,"explodeIndex",void 0),u([sf.base.Complex({mode:"Drop"},bu)],t.prototype,"emptyPointSettings",void 0),u([sf.base.Property(0)],t.prototype,"gapRatio",void 0),u([sf.base.Property("80%")],t.prototype,"width",void 0),u([sf.base.Property("80%")],t.prototype,"height",void 0),u([sf.base.Property("20%")],t.prototype,"neckWidth",void 0),u([sf.base.Property("20%")],t.prototype,"neckHeight",void 0),u([sf.base.Property("Linear")],t.prototype,"pyramidMode",void 0),u([sf.base.Property(1)],t.prototype,"opacity",void 0),t}(sf.base.ChildProperty);var li,ai,vi,yi,pi,wi,bi,ki,di,gi,nr,tr,ir,iu=(li=function(n,t){return(li=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}li(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),c=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},gf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return iu(t,n),c([sf.base.Property(0)],t.prototype,"x",void 0),c([sf.base.Property(0)],t.prototype,"y",void 0),t}(sf.base.ChildProperty),ne=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return iu(t,n),c([sf.base.Property(!0)],t.prototype,"visible",void 0),c([sf.base.Property(null)],t.prototype,"height",void 0),c([sf.base.Property(null)],t.prototype,"width",void 0),c([sf.base.Complex({x:0,y:0},gf)],t.prototype,"location",void 0),c([sf.base.Property("Auto")],t.prototype,"position",void 0),c([sf.base.Property("Series")],t.prototype,"mode",void 0),c([sf.base.Property(8)],t.prototype,"padding",void 0),c([sf.base.Property("Center")],t.prototype,"alignment",void 0),c([sf.base.Complex(b.legendLabelFont,k)],t.prototype,"textStyle",void 0),c([sf.base.Property(10)],t.prototype,"shapeHeight",void 0),c([sf.base.Property(10)],t.prototype,"shapeWidth",void 0),c([sf.base.Complex({},d)],t.prototype,"border",void 0),c([sf.base.Complex({left:0,right:0,top:0,bottom:0},fr)],t.prototype,"margin",void 0),c([sf.base.Complex({left:0,right:0,top:0,bottom:0},yu)],t.prototype,"containerPadding",void 0),c([sf.base.Property(5)],t.prototype,"shapePadding",void 0),c([sf.base.Property("transparent")],t.prototype,"background",void 0),c([sf.base.Property(1)],t.prototype,"opacity",void 0),c([sf.base.Property(!0)],t.prototype,"toggleVisibility",void 0),c([sf.base.Property(null)],t.prototype,"description",void 0),c([sf.base.Property(3)],t.prototype,"tabIndex",void 0),c([sf.base.Property(null)],t.prototype,"title",void 0),c([sf.base.Complex(b.legendTitleFont,k)],t.prototype,"titleStyle",void 0),c([sf.base.Property("Top")],t.prototype,"titlePosition",void 0),c([sf.base.Property(100)],t.prototype,"maximumTitleWidth",void 0),c([sf.base.Property(!0)],t.prototype,"enablePages",void 0),c([sf.base.Property(!1)],t.prototype,"isInversed",void 0),t}(sf.base.ChildProperty),te=function(){function n(n){this.pageXCollections=[];this.legendTitleCollections=[];this.legendRegions=[];this.pagingRegions=[];this.chart=n;this.legend=n.legendSettings;this.legendID=n.element.id+"_chart_legend";this.isChartControl="chart"===n.getModuleName();this.isBulletChartControl="bulletChart"===n.getModuleName();this.isStockChartControl="stockChart"===n.getModuleName();this.bulletChart=this.chart;this.fivePixel=5;this.rowCount=0;this.pageButtonSize=8;this.maxColumns=0;this.maxWidth=0;this.currentPage=1;this.backwardArrowOpacity=0;this.forwardArrowOpacity=1;this.arrowWidth=2*(this.fivePixel+this.pageButtonSize+this.fivePixel);this.arrowHeight=this.arrowWidth;this.isTop=!1;this.isTitle=!1;this.currentPageNumber=1}return n.prototype.calculateLegendBounds=function(n,t,i){var r=this.legend,u=this.isBulletChartControl?"40%":"20%";this.getPosition(r.position,t);this.legendBounds=new sf.svgbase.Rect(n.x,n.y,0,0);this.isVertical="Left"===this.position||"Right"===this.position;this.isVertical?(this.legendBounds.height=o(r.height,t.height-(n.y-this.chart.margin.top))||n.height,this.legendBounds.width=o(r.width||u,t.width)):(this.legendBounds.width=o(r.width,t.width)||n.width,this.legendBounds.height=o(r.height||u,t.height));this.library.getLegendBounds(t,this.legendBounds,r);this.isBulletChartControl||(this.legendBounds.width+=this.legend.containerPadding.left+this.legend.containerPadding.right,this.legendBounds.height+=this.legend.containerPadding.top+this.legend.containerPadding.bottom);this.getLocation(this.position,r.alignment,this.legendBounds,n,t,i)},n.prototype.getPosition=function(n,t){var i=this.chart,r=this.chart;this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.position="Auto"!==n?n:"Bottom":("Auto"===n&&((i||r).visibleSeries&&"Funnel"===(i||r).visibleSeries[0].type||"Pyramid"===(i||r).visibleSeries[0].type)&&(n="Top"),this.position="Auto"!==n?n:t.width>t.height?"Right":"Bottom")},n.prototype.setBounds=function(n,t,i,r){var u=i.title&&"Top"===i.titlePosition?this.legendTitleSize.height+this.fivePixel:0;this.isVertical&&this.isPaging&&!i.enablePages&&!this.isBulletChartControl&&(u=i.title&&"Top"===i.titlePosition?this.legendTitleSize.height+this.fivePixel:0,u+=this.pageButtonSize+this.fivePixel);n=Math.min(n,r.width);t=Math.min(t,r.height);"Gradient"===i.mode?(r.width=i.width?r.width:this.isVertical?n:.75*r.width,r.height=i.height?r.height:this.isVertical?.75*r.height:t):(r.width=i.width?r.width:n,r.height=i.height?r.height:t);this.isBulletChartControl||this.isTop&&"None"!==i.titleStyle.textOverflow&&(this.calculateLegendTitle(i,r),r.height+="Wrap"===i.titleStyle.textOverflow&&this.legendTitleCollections.length>1?this.legendTitleSize.height-this.legendTitleSize.height/this.legendTitleCollections.length:0);this.rowCount=Math.max(1,Math.ceil((r.height-i.padding-u)/(this.maxItemHeight+i.padding)))},n.prototype.getLocation=function(n,t,i,r,u,f){var o=this.legend.border.width,s=this.isBulletChartControl,e=this.bulletChart,c="Inside"===e.labelPosition,l="Inside"===e.tickPosition,h="Vertical"===e.orientation,p=s&&""!==e.categoryField?f.width+this.chart.border.width+3*o:0,v=this.chart.margin.bottom,y=i.height+o+this.legend.margin.top+this.legend.margin.bottom,a=i.width+o+this.legend.margin.left+this.legend.margin.right;"Bottom"===n?(i.x=this.alignLegend(i.x,u.width,i.width,t),i.y=r.y+(r.height-y)+o+this.legend.margin.top,i.y+=!s||e.opposedPosition||c||l||h?h&&""!==e.categoryField?f.height+2*o:0:e.majorTickLines.height+v+this.legend.border.width+2*o,ft(r,new st(0,0,0,y))):"Top"===n?(i.x=this.alignLegend(i.x,u.width,i.width,t),i.y=r.y+o+this.legend.margin.top,i.y-=!s||!e.opposedPosition||c||l||h?0:e.majorTickLines.height+this.chart.margin.top,ft(r,new st(0,0,y-=s?2*-o:0,0))):"Right"===n?(i.x=r.x+(r.width-i.width)-this.legend.margin.right,i.y=r.y+this.alignLegend(0,u.height-(r.y+v),i.height,t),a+=s&&e.opposedPosition&&!c&&!l&&h?this.chart.margin.left+this.chart.margin.right+e.majorTickLines.height:0,ft(r,new st(0,a,0,0))):"Left"===n?(i.x=i.x+this.legend.margin.left,i.y=r.y+this.alignLegend(0,u.height-(r.y+v),i.height,t),a+=!s||e.opposedPosition||c||l||!h?"Vertical"!==e.orientation&&""!==e.categoryField?p:0:i.x-this.chart.margin.left+o+e.majorTickLines.height,ft(r,new st(a,0,0,0))):(i.x=this.legend.location.x,i.y=this.legend.location.y,ft(r,new st(0,0,0,0)))},n.prototype.alignLegend=function(n,t,i,r){switch(r){case"Far":n=t-i-n;break;case"Center":n=(t-i)/2}return n},n.prototype.renderLegend=function(n,t,i,r){var b,h=0,k=(new sf.svgbase.Rect(0,0,0,0),new sf.svgbase.Rect(0,0,0,0)),a=this.findFirstLegendPosition(this.legendCollections),c=t.padding,et=t.enablePages,v=t.titlePosition,tt=this.isPaging&&!t.enablePages&&this.isVertical?this.pageButtonSize:0,d=n.renderer.createGroup({id:this.legendID+"_g"}),g=this.createLegendElements(n,i,d,t,this.legendID,r),p,l,w,nt,u;for(this.legendRegions=[],p=0,l=0;l<this.legendCollections.length;l++)if(""!==this.legendCollections[l].text){p=Math.max(this.legendCollections[l].textSize.height,p);break}if(this.maxItemHeight=Math.max(p,t.shapeHeight),et||!this.isPaging||this.isVertical?this.isPaging||this.isVertical||(h=this.isTitle&&"Left"===v?this.fivePixel+this.legendTitleSize.width:0):(h=this.isTitle&&"Left"===v?this.legendTitleSize.width:0,h+=this.pageButtonSize+2*this.fivePixel),b=this.isTitle&&(this.isTop||this.isVertical)?this.legendTitleSize.height:0,"Gradient"===n.legendSettings.mode&&this.legendCollections.length>1)this.getLinearLegend(i,n,t,g),this.totalPages=1;else if(a!==this.legendCollections.length){var f=void 0,e=0,it=this.legendCollections[a],o=new s(this.isBulletChartControl?i.x+h+c+t.shapeWidth/2:i.x+h+c+t.shapeWidth/2+t.containerPadding.left,this.isBulletChartControl?i.y+b+tt+c+this.maxItemHeight/2:i.y+b+tt+c+this.maxItemHeight/2+t.containerPadding.top),ot=n.isRtlEnabled?"end":"start",rt=new sf.svgbase.TextOption("",o.x,o.y,ot),st=t.shapePadding+c+t.shapeWidth;if(this.totalPages=this.totalPages=this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.totalPages:0,this.pageXCollections=[],this.legendCollections[a].location=o,!t.enablePages&&this.isPaging){var ht=o.x-this.fivePixel,ut=o.y-this.fivePixel,ct=this.isTitle&&!this.isVertical&&"Left"===v?this.legendTitleSize.width+this.fivePixel:0,lt=this.isVertical?this.pageButtonSize+Math.abs(ut-i.y):0,ft=this.isTitle&&!this.isVertical&&"Right"===v?this.legendTitleSize.width+this.fivePixel:0;ft+=this.isVertical?0:this.fivePixel+this.pageButtonSize+this.fivePixel;k=new sf.svgbase.Rect(ht,ut,i.width-ft-ct,i.height-lt)}else k=i;for(w=0,nt=this.legendCollections;w<nt.length;w++)u=nt[w],"accumulationchart"===this.chart.getModuleName()&&(u.fill=(this.chart||this.chart||this.chart).visibleSeries[0].points[u.pointIndex].color),"stockChart"===this.chart.getModuleName()&&(u.type=this.chart.visibleSeries[e].type),this.accessbilityText=this.isBulletChartControl?"Legend of bullet chart"+u.text:"Click to show or hide the "+u.text+" series",u.render&&""!==u.text&&((f=n.renderer.createGroup({id:this.legendID+this.generateId(u,"_g_",e)}))&&(f.setAttribute("tabindex",t.tabIndex.toString()),f.setAttribute("aria-label",t.description||this.accessbilityText)),this.library.getRenderPoint(u,o,st,it,k,e,a),this.renderSymbol(u,f,e),this.renderText(n,u,f,rt,e),f&&f.setAttribute("style","outline: none; cursor: "+(!t.toggleVisibility&&("None"===n.selectionMode||"None"===n.highlightMode||"None"===n.selectionMode)||this.isBulletChartControl?"auto":"pointer")),g&&g.appendChild(f),it=u),e++;this.isPaging?this.renderPagingElements(n,i,rt,d):this.totalPages=1}y(n.enableCanvas,n.svgObject,d,r)},n.prototype.getLinearLegend=function(n,t,i,r){var wt="http://www.w3.org/2000/svg",c=this.legendCollections[0],ei=this.legendCollections[1],bt=this.chart.renderer.createDefs(),e=document.createElementNS(wt,"linearGradient"),l=[],f=[],k,ut,u,d,g,o,kt,nt,ft,et,dt,gt,ni,a,ot,v,ri,ui,b,yt,pt,fi;for(i.title&&(this.isVertical?(n.y+=this.legendTitleSize.height,n.height-=this.legendTitleSize.height):"Left"===i.titlePosition?(n.x+=this.legendTitleSize.width,n.width-=this.legendTitleSize.width):"Right"===i.titlePosition?n.width-=this.legendTitleSize.width:"Top"===i.titlePosition&&(n.y+=this.legendTitleSize.height,n.height-=this.legendTitleSize.height)),k=0,ut=this.chart.rangeColorSettings;k<ut.length;k++){if(u=ut[k],f.indexOf(u.start)<0&&f.push(u.start),u.colors.length>2)if(d=u.end-u.start,g=u.colors.length-1,d>0)for(d/=g,o=1;o<g;o++)kt=u.start+d*o,f.push(kt);else for(o=1;o<g;o++)f.push(u.start);for(f.indexOf(u.end)<0&&f.push(u.end),nt=0,ft=u.colors;nt<ft.length;nt++)et=ft[nt],l.indexOf(et)<0&&l.push(et);u.colors.length>0&&u.colors.length<2&&l.push(u.colors[0])}for(dt=this.isVertical?"0":"100",gt=this.isVertical?"100":"0",e.setAttribute("id",this.generateId(c,"linearGradient",0)),e.setAttribute("x1","0%"),e.setAttribute("y1","0%"),e.setAttribute("x2",dt+"%"),e.setAttribute("y2",gt+"%"),ni=f[f.length-1]-f[0],a=0;a<l.length;a++)ot=f[a]-f[0],ot/=ni,v=document.createElementNS(wt,"stop"),v.setAttribute("offset",ot.toString()),v.setAttribute("stop-color",l[a]),v.setAttribute("stop-opacity",1..toString()),e.appendChild(v);var st,ht,ct,lt,ti=c.text.toString(),ii=ei.text.toString(),y=sf.svgbase.measureText(ti,i.textStyle),tt=sf.svgbase.measureText(ii,i.textStyle),p=y.width>tt.width?y.width:tt.width,w=y.height>tt.height?y.height:tt.height,at=2*p+4*i.padding,s=n.width,h=n.height,vt=n.x+p+2*i.padding,it=n.y+i.padding;this.isVertical?(at=2*w+4*i.padding,s=n.width-2*i.padding,h=n.height-at,vt=n.x+i.padding,it=n.y+w+2*i.padding,st=n.y+i.padding+w,ht=it+h+w,lt=ct=n.x+.5*n.width-.5*p,s>30)&&(ri=s-30,s=30,vt+=ri/2):(s=n.width-at,h=n.height-2*i.padding,ct=n.x+i.padding+(p-y.width),lt=n.x+s+3*i.padding+p,ht=st=n.y+.5*n.height+.25*w,h>30)&&(ui=h-30,h=30,it+=ui/2);b=new sf.svgbase.TextOption("",ct,st,"",ti);b.id=this.legendID+this.generateId(c,"_text_",1);yt=c.visible?i.textStyle.color||t.themeStyle.legendLabel:"#D3D3D3";pt=!this.isStockChartControl&&this.chart.enableCanvas;rt(t.renderer,b,i.textStyle,yt,r,!1,!1,!1,!1,null,this.currentPageNumber&&pt?new sf.svgbase.Rect(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null);(b=new sf.svgbase.TextOption("",lt,ht,"",ii)).id=this.legendID+this.generateId(c,"_text_",2);rt(t.renderer,b,i.textStyle,yt,r,!1,!1,!1,!1,null,this.currentPageNumber&&pt?new sf.svgbase.Rect(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null);fi=t.renderer.drawRectangle({width:s,height:h,x:vt,y:it,fill:"url(#"+this.generateId(c,"linearGradient",0)+")"});bt.appendChild(e);r.appendChild(bt);r.appendChild(fi)},n.prototype.findFirstLegendPosition=function(n){for(var i,r=0,t=0,u=n;t<u.length;t++){if(i=u[t],i.render&&""!==i.text)break;r++}return r},n.prototype.calculateLegendTitle=function(n,t){var i,r;n.title?(this.isTop="Top"===n.titlePosition,i="Trim"===n.titleStyle.textOverflow?2*n.padding:0,this.isTop||this.isVertical?this.legendTitleCollections=at(n.title,n.titleStyle,t.width-i):this.legendTitleCollections[0]=it(n.maximumTitleWidth,n.title,n.titleStyle),r=this.isTop?n.title:this.legendTitleCollections[0],this.legendTitleSize=sf.svgbase.measureText(r,n.titleStyle),this.legendTitleSize.height*=this.legendTitleCollections.length):this.legendTitleSize=new sf.svgbase.Size(0,0)},n.prototype.renderLegendTitle=function(n,t,i,r){var o=t.padding,f=t.titleStyle.textAlignment,e,u;this.isTop="Top"===t.titlePosition;e="Near"===f?"start":"Far"===f?"end":"middle";u=ui(i,t.titleStyle);e=this.isTop||this.isVertical?e:"";u="Near"===f?u+o:"Far"===f?u-o:u;u=this.isTop||this.isVertical?u:i.x+("Left"===t.titlePosition?5:i.width-this.legendTitleSize.width-5);var s=i.height/2+this.legendTitleSize.height/4,h=i.y+(this.isTop||this.isVertical?this.legendTitleSize.height/this.legendTitleCollections.length:s),c=new sf.svgbase.TextOption(this.legendID+"_title",u,h,e,this.legendTitleCollections);rt(n.renderer,c,t.titleStyle,t.titleStyle.color,r)},n.prototype.createLegendElements=function(n,t,i,r,u,f){var c=r.padding,e=new oi(u+"_element",r.background,r.border,r.opacity,t),s=n.renderer.createGroup({id:u+"_collections"}),o=!this.isStockChartControl&&n.enableCanvas,h=n.renderer.createClipPath({id:u+"_clipPath"});return i?i.appendChild(n.renderer.drawRectangle(e)):n.renderer.drawRectangle(e),r.title&&this.renderLegendTitle(n,r,t,i),o||i.appendChild(s),this.legendTranslateGroup=n.renderer.createGroup({id:u+"_translate_g"}),o||s.appendChild(this.legendTranslateGroup),e.y+=c+(this.isTop?this.legendTitleSize.height:0),e.id+="_clipPath_rect",e.width=this.isChartControl||"bulletChart"===n.getModuleName()||this.isStockChartControl||!this.isVertical?t.width:this.maxWidth-c+r.containerPadding.left+r.containerPadding.right,o?this.pagingClipRect=e:(this.clipRect=n.renderer.drawRectangle(e),h.appendChild(this.clipRect)),y(o,n.svgObject,h,f),o||s.setAttribute("style","clip-path:url(#"+h.id+")"),this.legendTranslateGroup},n.prototype.renderSymbol=function(n,t,i){var l,h,e=this.isBulletChartControl?this.chart:null,c=n.visible?n.fill:"#D3D3D3",p=("chart"===this.chart.getModuleName()||"stockChart"===this.chart.getModuleName())&&"SeriesType"===n.shape&&n.type.toLowerCase().indexOf("line")>-1&&-1===n.type.toLowerCase().indexOf("area"),a=!("chart"!==this.chart.getModuleName()&&"stockChart"!==this.chart.getModuleName()||"Scatter"!==n.type&&"Bubble"!==n.type),v=!this.isStockChartControl&&this.chart.enableCanvas,r="SeriesType"===n.shape?n.type:n.shape,y=p?"Series"===this.legend.mode?this.chart.visibleSeries[i].width:this.chart.visibleSeries[0].width:this.isBulletChartControl&&"Multiply"===n.shape?4:1,f;(r="Scatter"===r?n.markerShape:r,a&&i<this.chart.visibleSeries.length)&&(f=this.chart.visibleSeries[i].border,l=f.color?f.color:c,y=f.width?f.width:1);var u=new sf.svgbase.PathOption(this.legendID+this.generateId(n,"_shape_",i),c,y,a?l:c,1,"",""),w=sf.svgbase.measureText(n.text,this.legend.textStyle),o=this.legend.isInversed?n.location.x+w.width+this.legend.shapePadding:n.location.x,s=n.location.y;v?(h=-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),g({x:o,y:s},r,new sf.svgbase.Size(this.legend.shapeWidth,this.legend.shapeHeight),"",u,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new sf.svgbase.Rect(0,h,0,0):null,this.isBulletChartControl,e),this.legendRegions.push({rect:new sf.svgbase.Rect(n.location.x,n.location.y,this.legend.shapeWidth,this.legend.shapeHeight+h),index:i})):t.appendChild(g({x:o,y:s},r,new sf.svgbase.Size(this.legend.shapeWidth,this.legend.shapeHeight),n.url,u,this.accessbilityText,this.chart.renderer,null,this.isBulletChartControl,e));("Line"===r&&n.markerVisibility&&"Image"!==n.markerShape||"Doughnut"===n.type&&"Doughnut"===r)&&(u.id=this.legendID+this.generateId(n,"_shape_marker_",i),r="Doughnut"===n.type?"Circle":n.markerShape,u.fill="Doughnut"===n.type?"#FFFFFF":u.fill,v?g({x:o,y:s},r,new sf.svgbase.Size(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",u,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new sf.svgbase.Rect(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,this.isBulletChartControl,e):t.appendChild(g({x:o,y:s},r,new sf.svgbase.Size(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",u,this.accessbilityText,null,null,this.isBulletChartControl,e)))},n.prototype.renderText=function(n,t,i,r,u){var f=n.legendSettings,h=t.visible?f.textStyle.color||n.themeStyle.legendLabel:"#D3D3D3",s=!this.isStockChartControl&&this.chart.enableCanvas,o,e;r.id=this.legendID+this.generateId(t,"_text_",u);r.text=t.text;r.x=f.isInversed?t.location.x-f.shapeWidth/2:t.location.x+f.shapeWidth/2+f.shapePadding;r.y=t.location.y+this.maxItemHeight/4;o=rt(n.renderer,r,f.textStyle,h,i,!1,!1,!1,!1,null,this.currentPageNumber&&s?new sf.svgbase.Rect(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null);(o&&o.setAttribute("aria-label",f.description||this.accessbilityText),s)&&(e=sf.svgbase.measureText(r.text,f.textStyle),this.legendRegions[u].rect.y=r.y<this.legendRegions[u].rect.y?r.y:this.legendRegions[u].rect.y,this.legendRegions[u].rect.width+=e.width,this.legendRegions[u].rect.height=e.height,this.legendRegions[u].rect.y-=.5*e.height)},n.prototype.renderPagingElements=function(n,t,i,r){var v,h=n.renderer.createGroup({id:this.legendID+"_navigation"}),l=!this.isStockChartControl&&n.enableCanvas,a=this.isBulletChartControl?0:this.legendTitleSize.height,p=this.chart.theme.indexOf("Dark")>-1?"#FFFFFF":"#545454",f=n.legendSettings,s=new sf.svgbase.PathOption(this.legendID+"_pageup","transparent",5,p,1,"",""),u=this.pageButtonSize,w=f.enablePages||!this.isPaging||this.isVertical||this.isBulletChartControl?this.rowCount-1:1,b=this.isTitle&&"Left"===f.titlePosition?this.legendTitleSize.width:0,e,o,c,y;this.pagingRegions=[];this.backwardArrowOpacity=1!==this.currentPage?1:0;this.forwardArrowOpacity=this.currentPage===this.totalPages?0:1;l||r.appendChild(h);this.totalPages=this.isChartControl||this.isBulletChartControl||this.isStockChartControl||!this.isVertical?Math.ceil(this.totalPages/Math.max(1,this.rowCount-1)):Math.ceil(this.totalPages/this.maxColumns);h&&h.setAttribute("style","cursor: pointer");this.clipPathHeight=w*(this.maxItemHeight+f.padding);l?(this.pagingClipRect.height=this.legendBounds.height-this.clipPathHeight-(this.pagingClipRect.y-this.legendBounds.y)-f.border.width,this.pagingClipRect.y=this.pagingClipRect.y+this.clipPathHeight,this.pagingClipRect.x+=f.border.width,this.pagingClipRect.width-=f.border.width+f.border.width/2,this.chart.renderer.clearRect(new sf.svgbase.Rect(this.pagingClipRect.x,this.pagingClipRect.y,this.pagingClipRect.width,this.pagingClipRect.height))):this.clipRect.setAttribute("height",this.clipPathHeight.toString());e=t.x+u/2;o=t.y+this.clipPathHeight+(a+t.height-this.clipPathHeight)/2;!this.isPaging||f.enablePages||this.isVertical||this.isBulletChartControl||(e=t.x+this.fivePixel+this.pageButtonSize+b,o=f.title&&this.isTop?t.y+8+a+u/1+.5:t.y+8+u+.5);c=sf.svgbase.measureText(this.totalPages+"/"+this.totalPages,f.textStyle);l?g({x:e,y:o},"LeftArrow",new sf.svgbase.Size(u,u),"",s,0,this.chart.renderer,new sf.svgbase.Rect(t.width-(2*(u+8)+8+c.width),0,0,0)):!this.isVertical||f.enablePages||this.isBulletChartControl?(s.opacity=this.isBulletChartControl?s.opacity:f.enablePages?1:this.backwardArrowOpacity,h.appendChild(g({x:e,y:o},"LeftArrow",new sf.svgbase.Size(u,u),"",s))):(e=t.x+t.width/2,o=t.y+u/2+8+a,s.opacity=this.backwardArrowOpacity,h.appendChild(g({x:e,y:o},"UpArrow",new sf.svgbase.Size(u,u),"",s)));this.pagingRegions.push(new sf.svgbase.Rect(e+t.width-(2*(u+8)+8+c.width)-.5*u,o-.5*u,u,u));i.x=e+u/2+8;i.y=o+c.height/4;i.id=this.legendID+"_pagenumber";i.text="1/"+this.totalPages;y=this.chart.theme.indexOf("Dark")>-1?"#FFFFFF":f.textStyle.color;l&&this.totalNoOfPages&&(i.text=this.currentPageNumber+"/"+this.totalNoOfPages);(f.enablePages||this.isBulletChartControl)&&(v=rt(n.renderer,i,f.textStyle,y,h,!1,!1,!1,!1,null,new sf.svgbase.Rect(t.width-(2*(u+8)+8+c.width),0,0,0)));e=i.x+8+u/2+c.width;!this.isPaging||f.enablePages||this.isVertical||(e=t.x+t.width-this.fivePixel-this.pageButtonSize-(f.title&&"Right"===f.titlePosition?this.legendTitleSize.width+this.fivePixel:0));s.id=this.legendID+"_pagedown";s.opacity=f.enablePages?1:this.forwardArrowOpacity;l?g({x:e,y:o},"RightArrow",new sf.svgbase.Size(u,u),"",s,0,this.chart.renderer,new sf.svgbase.Rect(t.width-(2*(u+8)+8+c.width),0,0,0)):!this.isVertical||f.enablePages||this.isBulletChartControl?h.appendChild(g({x:e,y:o},"RightArrow",new sf.svgbase.Size(u,u),"",s)):(e=t.x+t.width/2,o=t.y+t.height-u/2-8,h.appendChild(g({x:e,y:o},"DownArrow",new sf.svgbase.Size(u,u),"",s)));this.pagingRegions.push(new sf.svgbase.Rect(e+(t.width-(2*(u+8)+8+c.width)-.5*u),o-.5*u,u,u));l||!f.enablePages&&!this.isBulletChartControl?(1===this.currentPageNumber&&this.calTotalPage&&(f.enablePages||this.isBulletChartControl)&&(this.totalNoOfPages=this.totalPages,this.calTotalPage=!1),f.enablePages||this.isBulletChartControl||this.translatePage(null,this.currentPage-1,this.currentPage,f)):h.setAttribute("transform","translate("+(t.width-(2*(u+8)+8+c.width))+", 0)");(f.enablePages||this.isBulletChartControl)&&this.translatePage(v,this.currentPage-1,this.currentPage,f)},n.prototype.translatePage=function(n,t,i,r){var u=this.clipPathHeight*t,f="translate(0,-"+u+")";return this.isChartControl||this.isBulletChartControl||this.isStockChartControl||!this.isVertical||(f="translate(-"+(u=(u=this.pageXCollections[t*this.maxColumns]-this.legendBounds.x)<0?0:u)+",0)"),this.chart.enableCanvas||this.legendTranslateGroup.setAttribute("transform",f),this.chart.enableCanvas||!r.enablePages&&!this.isBulletChartControl||(n.textContent=i+"/"+this.totalPages),this.currentPage=i,u},n.prototype.changePage=function(n,t){var r=this.chart.legendSettings,f=document.getElementById(this.legendID+"_pageup"),e=document.getElementById(this.legendID+"_pagedown"),u=r.enablePages||this.isBulletChartControl?document.getElementById(this.legendID+"_pagenumber"):null,i=r.enablePages||this.isBulletChartControl?parseInt(u.textContent.split("/")[0],10):this.currentPage;t&&i>1?this.translatePage(u,i-2,i-1,r):!t&&i<this.totalPages&&this.translatePage(u,i,i+1,r);!this.isPaging||r.enablePages||this.isBulletChartControl||(this.currentPage===this.totalPages?this.hideArrow(e):this.showArrow(e),1===this.currentPage?this.hideArrow(f):this.showArrow(f))},n.prototype.hideArrow=function(n){n.setAttribute("opacity","0")},n.prototype.showArrow=function(n){n.setAttribute("opacity","1")},n.prototype.generateId=function(n,t,i){return this.isChartControl||this.isStockChartControl?t+i:t+n.pointIndex},n.prototype.move=function(n){var e=this,u=this.chart.mouseX,f=this.chart.mouseY,r,i,t;n.target.textContent.indexOf("...")>-1?(r=n.target.id.split(this.legendID+"_text_"),2===r.length&&(i=parseInt(r[1],10),t=this.chart.element,isNaN(i)||(this.chart.isTouch&&l(this.chart.element.id+"_EJ2_Legend_Tooltip"),this.isChartControl?ct(this.chart.series[i].name,u,f,t.offsetWidth,t.id+"_EJ2_Legend_Tooltip",h(this.chart.element.id+"_Secondary_Element")):ct(this.chart.visibleSeries[0].points[i].x.toString(),u+10,f+10,t.offsetWidth,t.id+"_EJ2_Legend_Tooltip",h(this.chart.element.id+"_Secondary_Element"))))):l(this.chart.element.id+"_EJ2_Legend_Tooltip");this.chart.isTouch&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout(function(){l(e.chart.element.id+"_EJ2_Legend_Tooltip")},1e3))},n}(),ie=function(n,t,i,r,u,f,e,o,s,h){this.location={x:0,y:0};this.text=n;this.fill=t;this.shape=i;this.url=f;this.visible=r;this.type=u;this.markerVisibility=o;this.markerShape=e;this.pointIndex=s;this.seriesIndex=h},re=function(){function n(n,t){this.initDataManager(n,t)}return n.prototype.initDataManager=function(n,t){this.dataManager=_instanceof(n,sf.data.DataManager)?n:new sf.data.DataManager(n);this.query=_instanceof(t,sf.data.Query)?t:new sf.data.Query},n.prototype.generateQuery=function(){return this.query.clone()},n.prototype.getData=function(n){var i=this,t;return this.dataManager.ready?(t=new sf.data.Deferred,this.dataManager.ready.then(function(){i.dataManager.executeQuery(n).then(function(n){t.resolve(n)})}).catch(function(n){t.reject(n)}),t.promise):this.dataManager.executeQuery(n)},n}(),pt=function(){function n(n){this.accumulation=n}return Object.defineProperty(n.prototype,"center",{get:function(){return this.pieCenter||("Pie"===this.accumulation.visibleSeries[0].type?this.accumulation.pieSeriesModule.pieBaseCenter:null)},set:function(n){this.pieCenter=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"radius",{get:function(){return void 0!==this.pieRadius?this.pieRadius:this.accumulation.pieSeriesModule.pieBaseRadius},set:function(n){this.pieRadius=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"labelRadius",{get:function(){return void 0!==this.pieLabelRadius?this.pieLabelRadius:this.accumulation.pieSeriesModule.pieBaseLabelRadius},set:function(n){this.pieLabelRadius=n},enumerable:!0,configurable:!0}),n.prototype.isCircular=function(){return"Pie"===this.accumulation.type},n.prototype.isVariousRadius=function(){return this.accumulation.pieSeriesModule.isRadiusMapped},n.prototype.processExplode=function(n){if(n.target.id.indexOf("_Series_")>-1||n.target.id.indexOf("_datalabel_")>-1){var t=ot(n.target.id).point;if(isNaN(t)||n.target.id.indexOf("_datalabel_")>-1&&"Outside"===this.accumulation.visibleSeries[0].points[t].labelPosition)return null;this.explodePoints(t,this.accumulation);this.deExplodeAll(t,this.accumulation.enableAnimation?300:0)}},n.prototype.invokeExplode=function(){for(var n,t,r,u,o=this.accumulation.visibleSeries[0],f=this.accumulation.enableAnimation?300:0,i=0,e=o.points;i<e.length;i++)n=e[i],n.isExplode&&this.pointExplode(n.index,n,f);if(this.accumulation.accumulationSelectionModule&&"None"!==this.accumulation.selectionMode&&this.accumulation.accumulationSelectionModule.selectedDataIndexes.length)for(t=0,r=this.accumulation.accumulationSelectionModule.selectedDataIndexes;t<r.length;t++)u=r[t],this.explodePoints(u.point,this.accumulation,!0),this.deExplodeAll(u.point,f)},n.prototype.deExplodeAll=function(n,t){for(var i,f=this.accumulation.element.id+"_Series_0_Point_",r=0,u=this.accumulation.visibleSeries[0].points;r<u.length;r++)i=u[r],(n!==i.index&&!i.isSliced||i.isClubbed)&&(i.isExplode=!1,this.deExplodeSlice(i.index,f,t))},n.prototype.explodePoints=function(n,t,i){var e;void 0===i&&(i=!1);var r=t.visibleSeries[0],f=r.points,u=yt(n,f),o=!0,s=this.accumulation.enableAnimation?300:0;if(sf.base.isNullOrUndefined(u))return null;e=!i&&(u.isSliced||r.clubbedPoints.length&&f[f.length-1].index===r.clubbedPoints[r.clubbedPoints.length-1].index);"Pie"===r.type&&(e||u.isClubbed)&&(o=this.clubPointExplode(n,u,r,f,t,s,e));o&&this.pointExplode(n,u,s,i)},n.prototype.getSum=function(n){var t=0;return n.map(function(n){t+=n.visible?n.y:0}),t},n.prototype.clubPointExplode=function(n,t,i,r,u,f,e){if(void 0===e&&(e=!1),t.isClubbed)return u.animateSeries=!1,r.splice(r.length-1,1),i.clubbedPoints.map(function(n){n.visible=!0;n.isExplode=!0}),u.visibleSeries[0].points=r.concat(i.clubbedPoints),this.deExplodeAll(n,f),i.sumOfPoints=this.getSum(u.visibleSeries[0].points),u.refreshChart(),!1;if(e||t.isSliced){u.animateSeries=!1;r.splice(r.length-i.clubbedPoints.length,i.clubbedPoints.length);var o=i.generateClubPoint();if(o.index=r.length,o.color=i.clubbedPoints[0].color,r.push(o),i.sumOfPoints=this.getSum(r),this.deExplodeAll(n,f),o.isExplode=!1,u.visibleSeries[0].points=r,u.refreshChart(),this.pointExplode(o.index,r[o.index],0,!0),o.isExplode=!1,this.deExplodeSlice(o.index,u.element.id+"_Series_0_Point_",f),t.isSliced)return!1}return!0},n.prototype.pointExplode=function(n,t,i,r){var e,u=this.accumulation.element.id+"_Series_0_Point_",f=this.accumulation;e=this.isCircular()?a(t.midAngle,f.explodeDistance,this.center):{x:t.labelRegion&&t.labelRegion.x<t.region.x?-f.explodeDistance:f.explodeDistance,y:0};this.isExplode(u+n)||r?(t.isExplode=!0,this.explodeSlice(n,e,u,this.center||{x:0,y:0},i)):(t.isExplode=!1,this.deExplodeSlice(n,u,i))},n.prototype.isExplode=function(n){var t=h(n),i=t?t.getAttribute("transform"):null;return t&&("translate(0, 0)"===i||null===i||"translate(0)"===i)},n.prototype.deExplodeSlice=function(n,t,i){var r=h(t+n),u,f;r&&r.parentNode.lastChild.hasAttribute("transform")&&r.parentNode.lastChild.removeAttribute("transform");u=r?r.getAttribute("transform"):null;this.accumulation.enableAnimation&&r&&u&&"translate(0, 0)"!==u&&"translate(0)"!==u?(f=/translate\((-?\d+\.?\d*),?\s*(-?\d+[.]?\d*)?\)/.exec(u),this.performAnimation(n,t,0,0,+f[1],+f[2]||0,i,!0)):this.performAnimation(n,t,0,0,0,0,i,!0)},n.prototype.setTranslate=function(n,t,i,r){this.setElementTransform(t+n,i);this.accumulation.visibleSeries[0].dataLabel.visible&&(t=this.accumulation.element.id+"_datalabel_Series_0_",this.setElementTransform(t+"shape_"+n,i),this.setElementTransform(t+"text_"+n,i+r),this.setElementTransform(t+"connector_"+n,i))},n.prototype.setElementTransform=function(n,t){var i=h(n);i&&i.setAttribute("transform",t)},n.prototype.explodeSlice=function(n,t,i,r,u){this.performAnimation(n,i,0,0,t.x-r.x,t.y-r.y,u)},n.prototype.performAnimation=function(n,t,i,r,u,f,e,o){var s,h,l=this,a=this.accumulation,y=t.split("_"),p=parseInt(t.split("_")[y.length-3],10),c=a.visibleSeries[p].points[n];if(e<=0)return this.setTranslate(n,t,"translate("+u+", "+f+")",c.transform),null;new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:e,progress:function(e){s=v(e.timeStamp,i,u,e.duration);h=v(e.timeStamp,r,f,e.duration);l.setTranslate(n,t,"translate("+(o?u-s:s)+", "+(o?f-h:h)+")",c.transform)},end:function(){l.setTranslate(n,t,"translate("+(o?i:u)+", "+(o?i:f)+")",c.transform)}})},n}(),ue=(ai=function(n,t){return(ai=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ai(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),fe=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ue(t,n),t.prototype.initProperties=function(n,t){var u,r,i,f,e;if(this.accumulation=n,this.size=Math.min(n.initialClipRect.width,n.initialClipRect.height),this.initAngles(t),u=parseInt(t.radius,10),-1===t.radius.indexOf("%")&&"number"!=typeof u||isNaN(u)){for(r=[],this.isRadiusMapped=!0,i=0;i<Object.keys(t.points).length;i++)r[i]=-1!==t.points[i].sliceRadius.indexOf("%")?o(t.points[i].sliceRadius,this.size/2):parseInt(t.points[i].sliceRadius,10);f=Math.min.apply(null,r);e=Math.max.apply(null,r);this.pieBaseRadius=this.seriesRadius=e;this.innerRadius=o(t.innerRadius,this.seriesRadius);this.innerRadius=this.innerRadius>f?this.innerRadius/2:this.innerRadius}else this.isRadiusMapped=!1,this.pieBaseRadius=o(t.radius,this.size/2),this.innerRadius=o(t.innerRadius,this.pieBaseRadius),this.pieBaseLabelRadius="Inside"===t.dataLabel.position?(this.pieBaseRadius-this.innerRadius)/2+this.innerRadius:this.pieBaseRadius+o(t.dataLabel.connectorStyle.length||"4%",this.size/2);this.radius=this.pieBaseRadius;this.labelRadius=this.pieBaseLabelRadius;n.explodeDistance=t.explode?o(t.explodeOffset,this.pieBaseRadius):0;this.findCenter(n,t);this.center=this.pieBaseCenter;this.defaultLabelBound(t,t.dataLabel.visible,t.dataLabel.position);this.totalAngle-=.001},t.prototype.getLabelRadius=function(n,t){return"Inside"===n.dataLabel.position?(o(t.sliceRadius,this.pieBaseRadius)-this.innerRadius)/2+this.innerRadius:o(t.sliceRadius,this.seriesRadius)+o(n.dataLabel.connectorStyle.length||"4%",this.size/2)},t.prototype.findCenter=function(n,t){this.accumulation=n;this.pieBaseCenter={x:o(n.center.x,n.initialClipRect.width)+n.initialClipRect.x,y:o(n.center.y,n.initialClipRect.height)+n.initialClipRect.y};var i=this.getSeriesBound(t),r=new s(i.x+i.width/2,i.y+i.height/2);this.pieBaseCenter.x+=this.pieBaseCenter.x-r.x;this.pieBaseCenter.y+=this.pieBaseCenter.y-r.y;this.accumulation.origin=this.pieBaseCenter},t.prototype.initAngles=function(n){var t=sf.base.isNullOrUndefined(n.endAngle)?n.startAngle:n.endAngle;this.totalAngle=(t-n.startAngle)%360;this.startAngle=n.startAngle-90;this.totalAngle=this.totalAngle<=0?360+this.totalAngle:this.totalAngle;this.startAngle=(this.startAngle<0?this.startAngle+360:this.startAngle)%360},t.prototype.defaultLabelBound=function(n,t,i){var r=this.getSeriesBound(n);n.accumulationBound=r;n.labelBound=new sf.svgbase.Rect(r.x,r.y,r.width+r.x,r.height+r.y);t&&"Outside"===i&&(n.labelBound=new sf.svgbase.Rect(1/0,1/0,-1/0,-1/0))},t.prototype.getSeriesBound=function(n){var t=new sf.svgbase.Rect(1/0,1/0,-1/0,-1/0),u,i,s,o;this.initAngles(n);var f=this.startAngle,e=this.totalAngle,r=(this.startAngle+e)%360;for(r=0===r?360:r,n.findMaxBounds(t,this.getRectFromAngle(f)),n.findMaxBounds(t,this.getRectFromAngle(r)),n.findMaxBounds(t,new sf.svgbase.Rect(this.pieBaseCenter.x,this.pieBaseCenter.y,0,0)),u=(90*Math.floor(f/90)+90)%360,i=90*Math.floor(r/90)%360,i=0===i?360:i,(e>=90||i===u)&&(n.findMaxBounds(t,this.getRectFromAngle(u)),n.findMaxBounds(t,this.getRectFromAngle(i))),(0===f||f+e>=360)&&n.findMaxBounds(t,this.getRectFromAngle(0)),s=u===i?0:Math.floor(e/90),o=1;o<s;o++)((u+=90)<i||r<f||360===e)&&n.findMaxBounds(t,this.getRectFromAngle(u));return t.width-=t.x,t.height-=t.y,t},t.prototype.getRectFromAngle=function(n){var t=a(n,this.pieBaseRadius,this.pieBaseCenter);return new sf.svgbase.Rect(t.x,t.y,0,0)},t.prototype.getPathArc=function(n,t,i,r,u){var f=i-t,e=(f=f<0?f+360:f)<180?0:1;return u||0!==u?this.getDoughnutPath(n,a(t,r,n),a(i,r,n),r,a(t,u,n),a(i,u,n),u,e):this.getPiePath(n,a(t,r,n),a(i,r,n),r,e)},t.prototype.getPiePath=function(n,t,i,r,u){return"M "+n.x+" "+n.y+" L "+t.x+" "+t.y+" A "+r+" "+r+" 0 "+u+" 1 "+i.x+" "+i.y+" Z"},t.prototype.getDoughnutPath=function(n,t,i,r,u,f,e,o){return"M "+t.x+" "+t.y+" A "+r+" "+r+" 0 "+o+" 1 "+i.x+" "+i.y+" L "+f.x+" "+f.y+" A "+e+" "+e+" 0 "+o+",0 "+u.x+" "+u.y+" Z"},t.prototype.doAnimation=function(n,t){var u,i=this,f=t.startAngle-90,o=this.accumulation.duration?this.accumulation.duration:t.animation.duration,r,e;this.pieBaseCenter.x+=1;r=.75*Math.max(this.accumulation.availableSize.height,this.accumulation.availableSize.width);r+=.414*r;e=function(n){var t;switch(n){case"Linear":t=v}return t}("Linear");new sf.base.Animation({}).animate(n,{duration:o,delay:t.animation.delay,progress:function(t){u=e(t.timeStamp,f,i.totalAngle,t.duration);n.setAttribute("d",i.getPathArc(i.pieBaseCenter,f,u,r,0))},end:function(){i.pieBaseCenter.x-=1;n.setAttribute("d",i.getPathArc(i.pieBaseCenter,0,359.99999,r,0));i.accumulation.trigger("animationComplete",i.accumulation.isBlazor?{}:{series:t,accumulation:i.accumulation,chart:i.accumulation});h(i.accumulation.element.id+"_datalabel_Series_"+t.index).style.visibility=i.accumulation.isDestroyed?"hidden":"visible"}})},t}(pt),ee=(vi=function(n,t){return(vi=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}vi(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),rr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ee(t,n),t.prototype.renderPoint=function(n,t,i,r,u,f){var s=t.sumOfPoints;n.startAngle=this.startAngle;var c=n.visible?n.y:0,e=s?Math.abs(c)/s*this.totalAngle:null,h=Math.PI/180*(this.startAngle-360);this.radius=this.isRadiusMapped?o(n.sliceRadius,this.seriesRadius):this.radius;r.d=this.getPathOption(n,e,this.startAngle%360);n.midAngle=(this.startAngle-e/2)%360;n.endAngle=this.startAngle%360;n.symbolLocation=a(n.midAngle,(this.radius+this.innerRadius)/2,this.center);f?(u.appendChild(i.renderer.drawPath(r)),this.refresh(n,e,h,i,r)):(u.appendChild(i.renderer.drawPath(r)),n.degree=e,n.start=h)},t.prototype.findSeries=function(n){var t=0===this.innerRadius?this.radius+3:this.innerRadius-3,i=0===this.innerRadius?t+2:t-2;this.toggleInnerPoint(n,t,i)},t.prototype.toggleInnerPoint=function(n,t,i){var f,c=ot(n.target.id,!0),e=n.target.id.substring(0,n.target.id.indexOf("Series")-1),r=document.getElementById(this.accumulation.element.id+"PointHover_Border"),o=c.series,s=c.point,l=h(e+"_Series_"+o+"_Point_"+s),v,y,p;if(!isNaN(c.series)&&l){if(!(sf.base.isNullOrUndefined(o)||isNaN(o)||sf.base.isNullOrUndefined(s)||isNaN(s))){var u=this.accumulation.visibleSeries[0].points[s],w=l.getAttribute("class")===e+"_ej2_deselected"?this.accumulation.tooltip.enable?.5:.3:this.accumulation.tooltip.enable?.5:1,a=this.getPathArc(this.accumulation.pieSeriesModule.center,u.startAngle%360,(u.startAngle+u.degree)%360,t,i);r&&e===this.accumulation.element.id&&(r.getAttribute("d")!==a||u.isExplode)&&(r.parentNode.removeChild(r),r=null);v=h(e+"_Series_"+o);r||u.isExplode&&(!u.isExplode||"click"===n.type)||(y=new sf.svgbase.PathOption(e+"PointHover_Border",u.color,1,u.color,w,"",a),((f=this.accumulation.renderer.drawPath(y)).removeAttribute("transform"),"None"!==this.accumulation.selectionMode&&n.target.hasAttribute("class")&&this.accumulation.accumulationSelectionModule.addSvgClass(f,n.target.getAttribute("class")),v.appendChild(f),u.isExplode&&f)&&(p=l.getAttribute("transform"),f.setAttribute("transform",p)))}}else r&&(this.removeBorder(r,1e3),r=null)},t.prototype.removeBorder=function(n,t){n&&setTimeout(function(){n.parentNode&&n.parentNode.removeChild(n)},t)},t.prototype.refresh=function(n,t,i,r,u){var e=this,f=h(u.id),o=r.duration?r.duration:300;new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:o,delay:0,progress:function(u){var s=v(u.timeStamp,n.degree,t-n.degree,u.duration),o=v(u.timeStamp,n.start,i-n.start,u.duration);o=(o/(Math.PI/180)+360)%360;f.setAttribute("d",e.getPathOption(n,s,o));n.isExplode&&r.accBaseModule.explodePoints(n.index,r,!0);f.style.visibility="visible"},end:function(){f.style.visibility=n.visible?"visible":"hidden";f.setAttribute("d",u.d);n.degree=t;n.start=i}})},t.prototype.getPathOption=function(n,t,i){if(!t)return"";var r=this.getPathArc(this.center,i%360,(i+t)%360,this.isRadiusMapped?o(n.sliceRadius,this.seriesRadius):this.radius,this.innerRadius);return this.startAngle+=t,r},t.prototype.animateSeries=function(n,t,i,r){var f=n.element.id+"SeriesGroup"+i.index;if(i.animation.enable&&n.animateSeries){var u=n.renderer.createClipPath({id:f+"_clipPath"}),o=new sf.svgbase.PathOption(f+"_slice","transparent",1,"transparent",1,"",""),e=n.renderer.drawPath(o);u.appendChild(e);n.svgObject.appendChild(u);r.setAttribute("style","clip-path:url(#"+u.id+"); -webkit-clip-path:url(#"+u.id+");");this.doAnimation(e,i)}},t.prototype.getModuleName=function(){return"PieSeries"},t.prototype.destroy=function(){},t}(fe),ur=function(){function n(n){this.control=n}return n.prototype.print=function(n){this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no");this.printWindow.moveTo(0,0);this.printWindow.resizeTo(screen.availWidth,screen.availHeight);var t={cancel:!1,htmlContent:this.getHTMLContent(n),name:"beforePrint"};this.control.trigger("beforePrint",t);t.cancel||sf.base.print(t.htmlContent,this.printWindow)},n.prototype.getHTMLContent=function(n){var t=sf.base.createElement("div"),i,r;if(n)if(_instanceof(n,Array))for(i=0;i<n.length;i++)r=n[i],t.appendChild(h(r).cloneNode(!0));else _instanceof(n,Element)?t.appendChild(n.cloneNode(!0)):t.appendChild(h(n).cloneNode(!0));else t.appendChild(this.control.element.cloneNode(!0));return t},n.prototype.export=function(n,t,i,r,u,f,e,o,s){var b=this,c=this.getControlsValue(r,e),k,h,v,a,d,y,g,p,w,nt;u=u||c.width;f=f||c.height;h=this.control.svgObject;v=this.control.enableCanvas;v||(h=sf.base.createElement("canvas",{id:"ej2-canvas",attrs:{width:u.toString(),height:f.toString()}}));a=!(sf.base.Browser.userAgent.toString().indexOf("HeadlessChrome")>-1);i=sf.base.isNullOrUndefined(i)?sf.pdfexport.PdfPageOrientation.Landscape:i;d='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+c.svg.outerHTML+"<\/svg>";y=window.URL.createObjectURL(new Blob("SVG"===n?[d]:[(new XMLSerializer).serializeToString(c.svg)],{type:"image/svg+xml"}));"SVG"===n?"msie"===sf.base.Browser.info.name?(g=new Blob([(new XMLSerializer).serializeToString(c.svg)],{type:"application/octet-stream"}),window.navigator.msSaveOrOpenBlob(g,t+"."+n.toLocaleLowerCase())):this.triggerDownload(t,n,y,a):"msie"===sf.base.Browser.info.name?(p=h,v||(p=this.createCanvas()),k=p.toDataURL(),"PDF"===n?this.exportPdf(p,i,u,f,a,t,o,s):this.doexport(n,k,t)):(w=new Image,nt=h.getContext("2d"),w.onload=function(){nt.drawImage(w,0,0);window.URL.revokeObjectURL(y);"PDF"===n?b.exportPdf(h,i,u,f,a,t,o,s):window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(h.toBlob(null),t+"."+n.toLocaleLowerCase()):b.triggerDownload(t,n,h.toDataURL("image/"+n.toLowerCase()),a)},w.src=y);v||l(document.getElementById(this.control.element.id+"_canvas"))},n.prototype.getDataUrl=function(n){var f=this.getControlsValue([n]),t=this.control.svgObject,e=this.control.enableCanvas,i,r,o,u,s;return(e||(t=sf.base.createElement("canvas",{id:"ej2-canvas",attrs:{width:f.width.toString(),height:f.height.toString()}})),i=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(f.svg)],{type:"image/svg+xml"})),"msie"===sf.base.Browser.info.name)?(r=t,e||(r=this.createCanvas()),o={name:"afterExport",cancel:!1,dataUrl:t.toDataURL("image/png")},n.trigger("afterExport",o),{element:r,dataUrl:r.toDataURL()}):(u=new Image,s=t.getContext("2d"),u.onload=function(){s.drawImage(u,0,0);window.URL.revokeObjectURL(i);var r={name:"afterExport",cancel:!1,dataUrl:t.toDataURL("image/png")};return n.trigger("afterExport",r),r.dataUrl},u.src=i,{element:t,blobUrl:i})},n.prototype.triggerDownload=function(n,t,i,r){sf.base.createElement("a",{attrs:{download:n+"."+t.toLocaleLowerCase(),href:i}}).dispatchEvent(new MouseEvent(r?"click":"move",{view:window,bubbles:!1,cancelable:!0}))},n.prototype.getControlsValue=function(n,t){var i=0,r=0,f=this.control.enableCanvas,u=new sf.svgbase.SvgRenderer("").createSvg({id:"Svg_Export_Element",width:200,height:200});return n.map(function(n){var e=n.svgObject.cloneNode(!0),o=n.renderer.createGroup({style:sf.base.isNullOrUndefined(t)||t?"transform: translateY("+r+"px)":"transform: translateX("+i+"px)"}),s=e.childNodes[0].getAttribute("fill");"Tailwind"!==n.theme&&"TailwindDark"!==n.theme||"rgba(255,255,255, 0.0)"!==s&&"transparent"!==s||e.childNodes[0].setAttribute("fill","rgba(255,255,255, 1)");f||o.appendChild(e);i=sf.base.isNullOrUndefined(t)||t?Math.max(n.availableSize.width,i):i+n.availableSize.width;r=sf.base.isNullOrUndefined(t)||t?r+n.availableSize.height:Math.max(n.availableSize.height,r);f||u.appendChild(o)}),f||(u.setAttribute("width",i+""),u.setAttribute("height",r+"")),{width:i,height:r,svg:u}},n.prototype.createCanvas=function(){var n=this.control,t;return this.canvasRender(!0,n),t=n.svgObject,this.canvasRender(!1,n),t},n.prototype.canvasRender=function(n,t){t.enableCanvas=n;t.preRender();t.render()},n.prototype.exportPdf=function(n,t,i,r,u,f,e,o){var s=new sf.pdfexport.PdfDocument,h=s.pageSettings.margins,p=s.pageSettings.width,w=s.pageSettings.height,c=n.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream"),l,b,a,v,y;s.pageSettings.orientation=t;l=p<i?i+h.left+h.right:p;b=w<r?r+h.top+h.bottom:w;void 0!==e&&(a=new sf.pdfexport.PdfStandardFont(1,e.fontSize||15),v=new sf.pdfexport.PdfPageTemplateElement(l,40),v.graphics.drawString(e.content+"",a,null,new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(0,0,0)),e.x,e.y,null),s.template.top=v);void 0!==o&&(a=new sf.pdfexport.PdfStandardFont(1,o.fontSize||15),y=new sf.pdfexport.PdfPageTemplateElement(l,40),y.graphics.drawString(o.content+"",a,null,new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(0,0,0)),o.x,o.y,null),s.template.bottom=y);s.pageSettings.size=new sf.pdfexport.SizeF(l,b);c=c.slice(c.indexOf(",")+1);s.pages.add().graphics.drawImage(new sf.pdfexport.PdfBitmap(c),0,0,i,r);u&&(s.save(f+".pdf"),s.destroy())},n.prototype.doexport=function(n,t,i){var r,u=n||"JPG";r=[t];this.exportImage(r,i,u,t)},n.prototype.exportImage=function(n,t,i){for(var u,h,f=[],c=_instanceof(n,HTMLElement)?0:n.length,e=0;e<c;e++){for(var l=n[e].replace(/^data:[a-z]*;,/,"").split(","),o=atob(l[1]),s=new ArrayBuffer(o.length),a=new Uint8Array(s),r=0;r<o.length;r++)a[r]=o.charCodeAt(r);f.push(s)}for(u=0;u<f.length;u++)h=new Blob([f[u]],{type:"application/octet-stream"}),"msie"===sf.base.Browser.info.name&&window.navigator.msSaveOrOpenBlob(h,t+"."+i.toLocaleLowerCase())},n}(),oe=(yi=function(n,t){return(yi=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}yi(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),e=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},ru=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.animateselected=!1,r.explodeDistance=0,r.chartid=57724,r}return oe(t,n),t.prototype.animate=function(n){var r;this.duration=n||700;this.animateselected=!0;this.animateSeries=!1;var f=0,e=[],u=[],o=[],i=this.visibleSeries[0],s=[];if(s=i.dataSource,i.sumOfPoints=0,i.points.length<Object.keys(i.dataSource).length)this.refresh();else if(i.points.length>Object.keys(i.dataSource).length){r=this.visibleSeries[0];r.points=r.points.filter(function(n){return n.visible=!1,u.push(n.index),e.push(n.color),s.some(function(t){var i=t;return n.x===i.x&&(n.visible=!0,o.push(n.index),n.index=f,f++),n.x===i.x})});for(var h=u.filter(function(n){return o.indexOf(n)<0}),c=u.length-h.length,t=u.length-1;t>=c;t--)l("container_Series_0_Point_"+u[t]);for(t=0;t<r.points.length;t++)r.points[t].y=r.dataSource[t].y,r.points[t].color=e[t],r.sumOfPoints+=r.dataSource[t].y;this.redraw=this.enableAnimation;this.animateSeries=!1;this.calculateBounds();this.renderElements()}else{for(t=0;t<i.points.length;t++)i.points[t].y=i.dataSource[t][i.yName],i.points[t].color=null!=i.dataSource[t][i.pointColorMapping]?i.dataSource[t][i.pointColorMapping]:i.points[t].color,i.sumOfPoints+=i.dataSource[t][i.yName];this.redraw=this.enableAnimation;this.animateSeries=!1;this.removeSvg();this.refreshPoints(i.points);this.renderElements()}},Object.defineProperty(t.prototype,"type",{get:function(){return this.series&&this.series.length?this.series[0].type:"Pie"},enumerable:!0,configurable:!0}),t.prototype.preRender=function(){if(this.isBlazor=window.Blazor,this.allowServerDataBinding=!1,this.unWireEvents(),this.setCulture(),this.animateSeries=!0,""===this.element.id){var n=document.getElementsByClassName("e-accumulationchart").length;this.element.id="acc_chart_"+this.chartid+"_"+n}ri(this);this.wireEvents()},t.prototype.setTheme=function(){
/*! Set theme for accumulation chart */
this.themeStyle=function(n){var t,i="MaterialDark"===n?"#383838":"FabricDark"===n?"#242424":"#1b1b1b";switch(n){case"HighContrastLight":case"Highcontrast":case"HighContrast":t={axisLabel:"#ffffff",axisTitle:"#ffffff",axisLine:"#ffffff",majorGridLine:"#BFBFBF",minorGridLine:"#969696",majorTickLine:"#BFBFBF",minorTickLine:"#969696",chartTitle:"#ffffff",legendLabel:"#ffffff",background:"#000000",areaBorder:"#ffffff",errorBar:"#ffffff",crosshairLine:"#ffffff",crosshairFill:"#ffffff",crosshairLabel:"#000000",tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696",markerShadow:"#BFBFBF",selectionRectFill:"rgba(255, 217, 57, 0.3)",selectionRectStroke:"#ffffff",selectionCircleStroke:"#FFD939"};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":t={axisLabel:"#DADADA",axisTitle:"#ffffff",axisLine:" #6F6C6C",majorGridLine:"#414040",minorGridLine:"#514F4F",majorTickLine:"#414040",minorTickLine:" #4A4848",chartTitle:"#ffffff",legendLabel:"#DADADA",background:i,areaBorder:" #9A9A9A",errorBar:"#ffffff",crosshairLine:"#F4F4F4",crosshairFill:"#F4F4F4",crosshairLabel:"#282727",tooltipFill:"#F4F4F4",tooltipBoldLabel:"#282727",tooltipLightLabel:"#333232",tooltipHeaderLine:"#9A9A9A",markerShadow:null,selectionRectFill:"rgba(56,169,255, 0.1)",selectionRectStroke:"#38A9FF",selectionCircleStroke:"#282727"};break;case"Bootstrap4":t={axisLabel:"#212529",axisTitle:"#212529",axisLine:"#CED4DA",majorGridLine:"#CED4DA",minorGridLine:"#DEE2E6",majorTickLine:"#ADB5BD",minorTickLine:"#CED4DA",chartTitle:"#212529",legendLabel:"#212529",background:"#FFFFFF",areaBorder:"#DEE2E6",errorBar:"#000000",crosshairLine:"#6C757D",crosshairFill:"#495057",crosshairLabel:"#FFFFFF",tooltipFill:"rgba(0, 0, 0, 0.9)",tooltipBoldLabel:"rgba(255,255,255)",tooltipLightLabel:"rgba(255,255,255, 0.9)",tooltipHeaderLine:"rgba(255,255,255, 0.2)",markerShadow:null,selectionRectFill:"rgba(255,255,255, 0.1)",selectionRectStroke:"rgba(0, 123, 255)",selectionCircleStroke:"#495057"};break;case"Tailwind":t={axisLabel:"#6B728",axisTitle:"#374151",axisLine:" #D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#374151",legendLabel:"#374151",background:"rgba(255,255,255, 0.0)",areaBorder:" #E5E7EB",errorBar:"#374151",crosshairLine:"#1F2937",crosshairFill:"#111827",crosshairLabel:"#F9FAFB",tooltipFill:"#111827",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;case"TailwindDark":t={axisLabel:"#9CA3AF",axisTitle:"#9CA3AF",axisLine:" #4B5563",majorGridLine:"#374151",minorGridLine:"#374151",majorTickLine:"#4B5563",minorTickLine:" #4B5563",chartTitle:"#D1D5DB",legendLabel:"#D1D5DB",background:"#1f2937",areaBorder:" #374151",errorBar:"#ffffff",crosshairLine:"#9CA3AF",crosshairFill:"#F9FAFB",crosshairLabel:"#1F2937",tooltipFill:"#F9FAFB",tooltipBoldLabel:"#6B7280",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF",markerShadow:null,selectionRectFill:"rgba(34,211,238, 0.1)",selectionRectStroke:"#22D3EE",selectionCircleStroke:"#282727"};break;case"Bootstrap5":t={axisLabel:"#495057",axisTitle:"#343A40",axisLine:"#D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#343A40",legendLabel:"#343A40",background:"#FFFFFF",areaBorder:" #DEE2E6",errorBar:"#1F2937",crosshairLine:"#1F2937",crosshairFill:"#212529",crosshairLabel:"#F9FAFB",tooltipFill:"#212529",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;case"Bootstrap5Dark":t={axisLabel:"#CED4DA",axisTitle:"#E9ECEF",axisLine:"#495057",majorGridLine:"#343A40",minorGridLine:"#343A40",majorTickLine:"#495057",minorTickLine:" #495057",chartTitle:"#E9ECEF",legendLabel:"#E9ECEF",background:"#212529",areaBorder:" #444C54",errorBar:"#ADB5BD",crosshairLine:"#ADB5BD",crosshairFill:"#E9ECEF",crosshairLabel:"#212529",tooltipFill:"#E9ECEF",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;default:t={axisLabel:"#686868",axisTitle:"#424242",axisLine:"#b5b5b5",majorGridLine:"#dbdbdb",minorGridLine:"#eaeaea",majorTickLine:"#b5b5b5",minorTickLine:"#d6d6d6",chartTitle:"#424242",legendLabel:"#353535",background:"#FFFFFF",areaBorder:"Gray",errorBar:"#000000",crosshairLine:"#4f4f4f",crosshairFill:"#4f4f4f",crosshairLabel:"#e5e5e5",tooltipFill:"rgba(0, 8, 22, 0.75)",tooltipBoldLabel:"#ffffff",tooltipLightLabel:"#dbdbdb",tooltipHeaderLine:"#ffffff",markerShadow:null,selectionRectFill:"rgba(41, 171, 226, 0.1)",selectionRectStroke:"#29abe2",selectionCircleStroke:"#29abe2"}}return t}(this.theme)},t.prototype.render=function(){var n=this,t;-1===this.element.className.indexOf("e-accumulationchart")&&this.element.classList.add("e-accumulationchart");t={chart:this.isBlazor?{}:this,accumulation:this.isBlazor?{}:this,theme:this.theme,name:"load",cancel:!1};this.trigger("load",t,function(){n.theme=n.isBlazor?t.theme:n.theme;n.setTheme();n.accBaseModule=new pt(n);n.pieSeriesModule=new rr(n);n.calculateVisibleSeries();n.processData();n.renderComplete();n.allowServerDataBinding=!0})},t.prototype.unWireEvents=function(){
/*! Find the Events type */
var n=sf.base.Browser.isPointer,t=sf.base.Browser.touchStartEvent,i=sf.base.Browser.touchMoveEvent,r=sf.base.Browser.touchEndEvent,u=n?"pointerleave":"mouseleave";
/*! UnBind the Event handler */
sf.base.EventHandler.remove(this.element,i,this.accumulationMouseMove);sf.base.EventHandler.remove(this.element,r,this.accumulationMouseEnd);sf.base.EventHandler.remove(this.element,t,this.accumulationMouseStart);sf.base.EventHandler.remove(this.element,"click",this.accumulationOnMouseClick);sf.base.EventHandler.remove(this.element,"contextmenu",this.accumulationRightClick);sf.base.EventHandler.remove(this.element,u,this.accumulationMouseLeave);window.removeEventListener(sf.base.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.accumulationResizeBound)},t.prototype.wireEvents=function(){if(this.element){
/*! Find the Events type */
var n=sf.base.Browser.isPointer,t=sf.base.Browser.touchStartEvent,i=sf.base.Browser.touchEndEvent,r=sf.base.Browser.touchMoveEvent,u=n?"pointerleave":"mouseleave";
/*! Bind the Event handler */
sf.base.EventHandler.add(this.element,r,this.accumulationMouseMove,this);sf.base.EventHandler.add(this.element,i,this.accumulationMouseEnd,this);sf.base.EventHandler.add(this.element,t,this.accumulationMouseStart,this);sf.base.EventHandler.add(this.element,"click",this.accumulationOnMouseClick,this);sf.base.EventHandler.add(this.element,"contextmenu",this.accumulationRightClick,this);sf.base.EventHandler.add(this.element,u,this.accumulationMouseLeave,this);this.accumulationResizeBound=this.accumulationResize.bind(this);window.addEventListener(sf.base.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.accumulationResizeBound);new sf.base.Touch(this.element);this.setStyle(this.element)}},t.prototype.setMouseXY=function(n){var i,r,e=h(this.element.id+"_svg"),u,t,f;e&&this.element&&(u=e.getBoundingClientRect(),t=this.element.getBoundingClientRect(),n.type.indexOf("touch")>-1?(this.isTouch=!0,f=n,r=f.changedTouches[0].clientY,i=f.changedTouches[0].clientX):(this.isTouch="touch"===n.pointerType||"2"===n.pointerType,i=n.clientX,r=n.clientY),this.mouseY=r-t.top-Math.max(u.top-t.top,0),this.mouseX=i-t.left-Math.max(u.left-t.left,0))},t.prototype.accumulationMouseEnd=function(n){return this.setMouseXY(n),this.trigger("chartMouseUp",{target:n.target.id,x:this.mouseX,y:this.mouseY}),this.isTouch&&(this.titleTooltip(n,this.mouseX,this.mouseY,this.isTouch),this.accumulationDataLabelModule&&this.visibleSeries[0].dataLabel.visible&&this.accumulationDataLabelModule.move(n,this.mouseX,this.mouseY,this.isTouch),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.move(n)),this.notify(sf.base.Browser.touchEndEvent,n),!1},t.prototype.accumulationMouseStart=function(n){return this.setMouseXY(n),this.trigger("chartMouseDown",{target:n.target.id,x:this.mouseX,y:this.mouseY}),!1},t.prototype.accumulationResize=function(){var n=this,t,i;return this.animateSeries=!1,t={accumulation:this.isBlazor?{}:this,previousSize:new sf.svgbase.Size(this.availableSize.width,this.availableSize.height),name:"resized",currentSize:new sf.svgbase.Size(0,0),chart:this.isBlazor?{}:this},i={name:"beforeResize",cancelResizedEvent:!1},this.resizeTo&&clearTimeout(this.resizeTo),this.trigger("beforeResize",i),i.cancelResizedEvent||(this.resizeTo=+setTimeout(function(){n.isDestroyed?clearTimeout(n.resizeTo):(ri(n),t.currentSize=n.availableSize,n.trigger("resized",t),n.refreshSeries(),n.refreshChart())},500)),!1},t.prototype.print=function(n){var t=document.getElementById(this.element.id+"_Series_0").style.clipPath;document.getElementById(this.element.id+"_Series_0").style.clipPath="";new ur(this).print(n);document.getElementById(this.element.id+"_Series_0").style.clipPath=t},t.prototype.export=function(n,t){this.exportModule&&(this.exportModule.export(n,t),this.afterExport&&this.exportModule.getDataUrl(this))},t.prototype.setStyle=function(n){n.style.touchAction="element";n.style.msTouchAction="element";n.style.msContentZooming="none";n.style.msUserSelect="none";n.style.webkitUserSelect="none";n.style.position="relative";n.style.display="block"},t.prototype.setAnnotationValue=function(n,t){var i,r=this.annotations[n],u=h(this.element.id+"_Annotation_Collections");t&&(r.content=t,u?(i=this.createElement("div"),l(this.element.id+"_Annotation_"+n),this.annotationModule.processAnnotation(r,n,i),u.appendChild(i.children[0])):this.annotationModule.renderAnnotations(h(this.element.id+"_Secondary_Element")))},t.prototype.accumulationMouseMove=function(n){return!!h(this.element.id+"_svg")&&(this.setMouseXY(n),this.trigger("chartMouseMove",{target:n.target.id,x:this.mouseX,y:this.mouseY}),this.pointMove&&this.triggerPointEvent("pointMove",n.target,n),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.move(n),this.accumulationDataLabelModule&&this.visibleSeries[0]&&this.visibleSeries[0].dataLabel.visible&&this.accumulationDataLabelModule.move(n,this.mouseX,this.mouseY),this.isTouch||this.titleTooltip(n,this.mouseX,this.mouseY),this.enableBorderOnMouseMove&&"Pie"===this.type&&this.pieSeriesModule&&tt(this.mouseX,this.mouseY,this.initialClipRect)&&this.pieSeriesModule.findSeries(n),this.notify(sf.base.Browser.touchMoveEvent,n),!1)},t.prototype.titleTooltip=function(n,t,i,r){var u=n.target.id,f=u===this.element.id+"_title"||u===this.element.id+"_subTitle"||u===this.element.id+"_chart_legend_title";n.target.textContent.indexOf("...")>-1&&f?ct(u===this.element.id+"_title"?this.title:u===this.element.id+"_subTitle"?this.subTitle:this.legendSettings.title,t,i,this.element.offsetWidth,this.element.id+"_EJ2_Title_Tooltip",h(this.element.id+"_Secondary_Element"),r):l(this.element.id+"_EJ2_Title_Tooltip")},t.prototype.accumulationOnMouseClick=function(n){return this.setMouseXY(n),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.click(n),"None"!==this.selectionMode&&this.accumulationSelectionModule&&this.accumulationSelectionModule.calculateSelectedElements(this,n),this.visibleSeries[0].explode&&this.accBaseModule.processExplode(n),this.enableBorderOnMouseMove&&this.pieSeriesModule&&"Pie"===this.type&&this.pieSeriesModule.findSeries(n),this.trigger("chartMouseClick",{target:n.target.id,x:this.mouseX,y:this.mouseY}),this.pointClick&&this.triggerPointEvent("pointClick",n.target,n),!1},t.prototype.triggerPointEvent=function(n,t,i){var u=i,r=ot(t.id,!0);r.series>=0&&r.point>=0&&this.trigger(n,{series:this.isBlazor?{}:this.series[r.series],point:this.series[r.series].points[r.point],seriesIndex:r.series,pointIndex:r.point,x:this.mouseX,y:this.mouseY,pageX:u.pageX,pageY:u.pageY})},t.prototype.accumulationRightClick=function(n){return 2!==n.buttons&&"touch"!==n.pointerType||(n.preventDefault(),n.stopPropagation(),!1)},t.prototype.accumulationMouseLeave=function(n){this.setMouseXY(n);this.trigger("chartMouseLeave",{target:n.target.id,x:this.mouseX,y:this.mouseY});this.notify(sf.base.Browser.isPointer?"pointerleave":"mouseleave",n);var t=document.getElementById(this.element.id+"PointHover_Border");return t&&(this.pieSeriesModule.removeBorder(t,1e3),t=null),!1},t.prototype.setCulture=function(){this.intl=new sf.base.Internationalization},t.prototype.createPieSvg=function(){var n;this.removeSvg();(n=this).canvasRender=new sf.svgbase.CanvasRenderer(n.element.id);n.renderer=n.enableCanvas?n.canvasRender:new sf.svgbase.SvgRenderer(n.element.id);ri(n);n.svgObject=n.stockChart&&"chart"===n.getModuleName()?n.stockChart.chartObject:n.stockChart&&"rangeNavigator"===n.getModuleName()?n.stockChart.selectorObject:n.enableCanvas?n.renderer.createCanvas({id:n.element.id+"_canvas",width:n.availableSize.width,height:n.availableSize.height}):n.renderer.createSvg({id:n.element.id+"_svg",width:n.availableSize.width,height:n.availableSize.height})},t.prototype.removeSvg=function(){if(this.redraw)return null;if(wr(this),l(this.element.id+"_Secondary_Element"),this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&sf.base.remove(this.svgObject)}l("EJ2_legend_tooltip");l("EJ2_datalabel_tooltip");l(this.element.id+"PointHover_Border")},t.prototype.createSecondaryElement=function(){var n=pr(this.redraw,this.element.id+"_Secondary_Element")||this.createElement("div",{id:this.element.id+"_Secondary_Element",styles:"position: relative"});y(!1,this.element,n,this.redraw)},t.prototype.calculateVisibleSeries=function(){this.visibleSeries=[];for(var n=0,t=this.series.length;n<t;n++)if(this.series[n].index=n,this.series[n].type===this.type&&0===this.visibleSeries.length){this.visibleSeries.push(this.series[n]);break}},t.prototype.processData=function(n){var i,r,t;for(void 0===n&&(n=!0),this.seriesCounts=0,i=0,r=this.visibleSeries;i<r.length;i++)t=r[i],t.dataModule=new re(t.dataSource||this.dataSource,t.query),t.refreshDataManager(this,n)},t.prototype.refreshChart=function(){this.doGrouppingProcess();this.createPieSvg();this.calculateBounds();this.renderElements();l("chartmeasuretext")},t.prototype.doGrouppingProcess=function(){var n=this.visibleSeries[0];sf.base.isNullOrUndefined(n.resultData)||sf.base.isNullOrUndefined(n.lastGroupTo)||n.lastGroupTo===n.groupTo||n.getPoints(n.resultData,this)},t.prototype.calculateBounds=function(){var r,f,s;this.initialClipRect=new sf.svgbase.Rect(this.margin.left,this.margin.top,this.availableSize.width,this.availableSize.height);this.titleCollection=[];this.subTitleCollection=[];var t,n,u=0,e=0,i=0,o=0;if(this.titleCollection=at(this.title,this.titleStyle,this.initialClipRect.width),u=this.title?sf.svgbase.measureText(this.title,this.titleStyle).height*this.titleCollection.length:u,this.subTitle){for(r=0,f=this.titleCollection;r<f.length;r++)s=f[r],i=(o=sf.svgbase.measureText(s,this.titleStyle).width)>i?o:i;this.subTitleCollection=at(this.subTitle,this.subTitleStyle,i);e=sf.svgbase.measureText(this.subTitle,this.subTitleStyle).height*this.subTitleCollection.length}t=this.initialClipRect;n=new sf.svgbase.Rect(0,e+u,this.margin.right+this.margin.left,this.margin.bottom+this.margin.top);t.x+=n.x;t.y+=n.y;t.width-=n.x+n.width;t.height-=n.y+n.height;this.calculateLegendBounds()},t.prototype.calculateLegendBounds=function(){if(!this.accumulationLegendModule||!this.legendSettings.visible)return null;this.accumulationLegendModule.getLegendOptions(this,this.visibleSeries);this.accumulationLegendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,null)},t.prototype.renderElements=function(){this.renderBorder();this.createSecondaryElement();this.renderSeries();this.renderTitle();this.renderLegend();y(!1,this.element,this.svgObject,this.redraw);this.processSelection();this.processExplode();this.renderAnnotation();this.setSecondaryElementPosition();sf.base.updateBlazorTemplate(this.element.id+"_DataLabel","Template",this.series[0].dataLabel);this.trigger("loaded",{accumulation:this.isBlazor?{}:this,chart:this.isBlazor?{}:this});this.animateSeries=!1},t.prototype.setSecondaryElementPosition=function(){var n=h(this.element.id+"_Secondary_Element"),t,i;n&&(t=this.element.getBoundingClientRect(),i=h(this.element.id+"_svg").getBoundingClientRect(),n.style.left=Math.max(i.left-t.left,0)+"px",n.style.top=Math.max(i.top-t.top,0)+"px")},t.prototype.renderAnnotation=function(){this.annotationModule&&this.annotationModule.renderAnnotations(h(this.element.id+"_Secondary_Element"))},t.prototype.processExplode=function(){return this.redraw?null:this.visibleSeries[0].explode?void this.accBaseModule.invokeExplode():null},t.prototype.renderSeries=function(){var t,i,n;for(this.redraw||this.svgObject.appendChild(this.renderer.createGroup({id:this.element.id+"_SeriesCollection"})),t=0,i=this.visibleSeries;t<i.length;t++)n=i[t],n.visible&&this[lt(n.type)+"SeriesModule"]&&(this[lt(n.type)+"SeriesModule"].initProperties(this,n),n.renderSeries(this,this.redraw))},t.prototype.renderBorder=function(){var n=this.border.width,t,i;y(!1,this.svgObject,this.renderer.drawRectangle(new oi(this.element.id+"_border",this.background||this.themeStyle.background,this.border,1,new sf.svgbase.Rect(n/2,n/2,this.availableSize.width-n,this.availableSize.height-n))),this.redraw);t=this.backgroundImage;t&&(i=new df(this.availableSize.height-n,this.availableSize.width-n,t,0,0,this.element.id+"_background","visible","none"),y(!1,this.svgObject,this.renderer.drawImage(i),this.redraw))},t.prototype.renderLegend=function(){if(!this.accumulationLegendModule||!this.legendSettings.visible)return null;this.accumulationLegendModule.legendCollections.length&&("Pie"===this.visibleSeries[0].type&&this.accumulationLegendModule.getSmartLegendLocation(this.visibleSeries[0].labelBound,this.accumulationLegendModule.legendBounds,this.margin),this.accumulationLegendModule.renderLegend(this,this.legendSettings,this.accumulationLegendModule.legendBounds,this.redraw))},t.prototype.processSelection=function(){if(!this.accumulationSelectionModule||"None"===this.selectionMode)return null;var n=sf.base.extend([],this.accumulationSelectionModule.selectedDataIndexes,null,!0);this.accumulationSelectionModule.invokeSelection(this);n.length>0&&(this.accumulationSelectionModule.selectedDataIndexes=n,this.accumulationSelectionModule.redrawSelection(this))},t.prototype.renderTitle=function(){var n=this.margin;if(!this.title)return null;var t=this.titleStyle.textAlignment,u="Near"===t?"start":"Far"===t?"end":"middle",f=sf.svgbase.measureText(this.title,this.titleStyle),e=new sf.svgbase.Rect(n.left,0,this.availableSize.width-n.left-n.right,0),i=new sf.svgbase.TextOption(this.element.id+"_title",ui(e,this.titleStyle),this.margin.top+3*f.height/4,u,this.titleCollection,"","auto"),r=rt(this.renderer,i,this.titleStyle,this.titleStyle.color||this.themeStyle.chartTitle,this.svgObject,!1,this.redraw);r&&r.setAttribute("aria-label",this.title);this.subTitle&&this.renderSubTitle(i)},t.prototype.renderSubTitle=function(n){for(var e,o,s,t=0,r=0,u=this.titleStyle.textAlignment,h=sf.svgbase.measureText(this.subTitle,this.subTitleStyle),i=0,f=this.titleCollection;i<f.length;i++)e=f[i],t=(r=sf.svgbase.measureText(e,this.titleStyle).width)>t?r:t;o=new sf.svgbase.Rect("Center"===u?n.x-t/2:"Far"===u?n.x-t:n.x,0,t,0);s=new sf.svgbase.TextOption(this.element.id+"_subTitle",ui(o,this.subTitleStyle),n.y*n.text.length+3*h.height/4+10,function(n){return"Near"===n?"start":"Far"===n?"end":"middle"}(this.subTitleStyle.textAlignment),this.subTitleCollection,"","auto");rt(this.renderer,s,this.subTitleStyle,this.subTitleStyle.color||this.themeStyle.chartTitle,this.svgObject,!1,this.redraw)},t.prototype.getSeriesElement=function(){return this.svgObject.getElementsByTagName("g")[0]},t.prototype.refreshSeries=function(){for(var i,n=0,t=this.visibleSeries;n<t.length;n++)i=t[n],this.refreshPoints(i.points)},t.prototype.refreshPoints=function(n){for(var i,t=0,r=n;t<r.length;t++)i=r[t],i.labelPosition=null,i.labelRegion=null,i.labelVisible=!0},t.prototype.getModuleName=function(){return"accumulationchart"},t.prototype.destroy=function(){this.element&&(this.unWireEvents(),n.prototype.destroy.call(this),this.element.classList.remove("e-accumulationchart"),this.removeSvg(),this.svgObject=null)},t.prototype.requiredModules=function(){var n=[];return n.push({member:this.type+"Series",args:[this]}),this.legendSettings.visible&&n.push({member:"AccumulationLegend",args:[this]}),this.findDatalabelVisibility()&&n.push({member:"AccumulationDataLabel",args:[this]}),this.tooltip.enable&&n.push({member:"AccumulationTooltip",args:[this]}),"None"!==this.selectionMode&&n.push({member:"AccumulationSelection",args:[this]}),(this.enableExport||this.allowExport)&&n.push({member:"Export",args:[this]}),this.annotations.some(function(n){return null!==n.content})&&n.push({member:"Annotation",args:[this]}),n},t.prototype.findDatalabelVisibility=function(){for(var n=0,t=this.series;n<t.length;n++)if(t[n].dataLabel.visible)return!0;return!1},t.prototype.changeVisibleSeries=function(n,t){for(var u,i=0,r=n;i<r.length;i++)if(u=r[i],t===u.index)return u;return null},t.prototype.getPersistData=function(){return""},t.prototype.onPropertyChanged=function(t,i){for(var u={refreshElements:!1,refreshBounds:!1},e=0,o=Object.keys(t);e<o.length;e++)switch(o[e]){case"theme":this.animateSeries=!0;break;case"title":case"subTitle":case"height":case"width":case"margin":u.refreshBounds=!0;break;case"titleStyle":t.titleStyle&&(t.titleStyle.size||t.titleStyle.textOverflow)?u.refreshBounds=!0:u.refreshElements=!0;break;case"subTitleStyle":t.subTitleStyle&&(t.subTitleStyle.size||t.subTitleStyle.textOverflow)?u.refreshBounds=!0:u.refreshElements=!0;break;case"legendSettings":u.refreshBounds=!0;u.refreshElements=!0;break;case"dataSource":this.processData(!1);u.refreshBounds=!0;break;case"series":if(!this.animateselected){for(var c=this.series.length,s=!1,f=void 0,h=void 0,r=0;r<c;r++)f=t.series[r],this.isBlazor&&(f.startAngle||f.endAngle||f.explodeOffset||f.neckHeight||f.neckWidth||f.radius||f.innerRadius||f.groupMode||f.emptyPointSettings)&&(h=!0),t.series[r]&&(t.series[r].dataSource||t.series[r].yName||t.series[r].xName||t.series[r].dataLabel||h)&&(sf.base.extend(this.changeVisibleSeries(this.visibleSeries,r),f,null,!0),s=!0),t.series[r]&&!sf.base.isNullOrUndefined(t.series[r].explodeIndex)&&t.series[r].explodeIndex>=0&&t.series[r].explodeIndex!==i.series[r].explodeIndex&&(this.accBaseModule.explodePoints(t.series[r].explodeIndex,this),this.accBaseModule.deExplodeAll(t.series[r].explodeIndex,this.enableAnimation?300:0));s&&(this.processData(!1),u.refreshBounds=!0)}this.animateselected=!1;this.redraw=!1;break;case"locale":case"currencyCode":n.prototype.refresh.call(this);break;case"background":case"border":case"annotations":case"enableSmartLabels":u.refreshElements=!0;break;case"isMultiSelect":case"selectedDataIndexes":case"selectionMode":this.accumulationSelectionModule&&(sf.base.isNullOrUndefined(this.accumulationSelectionModule.selectedDataIndexes)?this.accumulationSelectionModule.invokeSelection(this):this.accumulationSelectionModule.redrawSelection(this))}!u.refreshBounds&&u.refreshElements?(this.createPieSvg(),this.renderElements()):u.refreshBounds&&(this.refreshSeries(),this.createPieSvg(),this.calculateBounds(),this.renderElements())},e([sf.base.Property(null)],t.prototype,"width",void 0),e([sf.base.Property(null)],t.prototype,"height",void 0),e([sf.base.Property(null)],t.prototype,"title",void 0),e([sf.base.Property(null)],t.prototype,"backgroundImage",void 0),e([sf.base.Complex({},gr)],t.prototype,"center",void 0),e([sf.base.Property("")],t.prototype,"dataSource",void 0),e([sf.base.Complex(b.chartTitleFont,k)],t.prototype,"titleStyle",void 0),e([sf.base.Property(null)],t.prototype,"subTitle",void 0),e([sf.base.Complex(b.chartSubTitleFont,k)],t.prototype,"subTitleStyle",void 0),e([sf.base.Complex({},ne)],t.prototype,"legendSettings",void 0),e([sf.base.Complex({},ku)],t.prototype,"tooltip",void 0),e([sf.base.Property("None")],t.prototype,"selectionMode",void 0),e([sf.base.Property("None")],t.prototype,"highLightMode",void 0),e([sf.base.Property("None")],t.prototype,"selectionPattern",void 0),e([sf.base.Property("None")],t.prototype,"highlightPattern",void 0),e([sf.base.Property(!0)],t.prototype,"enableBorderOnMouseMove",void 0),e([sf.base.Property(!1)],t.prototype,"isMultiSelect",void 0),e([sf.base.Property(!0)],t.prototype,"enableAnimation",void 0),e([sf.base.Collection([],wu)],t.prototype,"selectedDataIndexes",void 0),e([sf.base.Complex({},fr)],t.prototype,"margin",void 0),e([sf.base.Property(!0)],t.prototype,"enableSmartLabels",void 0),e([sf.base.Complex({color:"#DDDDDD",width:0},d)],t.prototype,"border",void 0),e([sf.base.Property(null)],t.prototype,"background",void 0),e([sf.base.Collection([{}],nu)],t.prototype,"series",void 0),e([sf.base.Collection([{}],kr)],t.prototype,"annotations",void 0),e([sf.base.Property("Material")],t.prototype,"theme",void 0),e([sf.base.Property(!1)],t.prototype,"useGroupingSeparator",void 0),e([sf.base.Property(!0)],t.prototype,"enableExport",void 0),e([sf.base.Property(!1)],t.prototype,"allowExport",void 0),e([sf.base.Event()],t.prototype,"loaded",void 0),e([sf.base.Event()],t.prototype,"load",void 0),e([sf.base.Event()],t.prototype,"seriesRender",void 0),e([sf.base.Event()],t.prototype,"legendRender",void 0),e([sf.base.Event()],t.prototype,"textRender",void 0),e([sf.base.Event()],t.prototype,"tooltipRender",void 0),e([sf.base.Event()],t.prototype,"pointRender",void 0),e([sf.base.Event()],t.prototype,"annotationRender",void 0),e([sf.base.Event()],t.prototype,"beforePrint",void 0),e([sf.base.Event()],t.prototype,"chartMouseMove",void 0),e([sf.base.Event()],t.prototype,"chartMouseClick",void 0),e([sf.base.Event()],t.prototype,"pointClick",void 0),e([sf.base.Event()],t.prototype,"pointMove",void 0),e([sf.base.Event()],t.prototype,"animationComplete",void 0),e([sf.base.Event()],t.prototype,"chartMouseDown",void 0),e([sf.base.Event()],t.prototype,"chartMouseLeave",void 0),e([sf.base.Event()],t.prototype,"chartMouseUp",void 0),e([sf.base.Event()],t.prototype,"beforeResize",void 0),e([sf.base.Event()],t.prototype,"resized",void 0),e([sf.base.Event()],t.prototype,"afterExport",void 0),e([sf.base.Property("USD")],t.prototype,"currencyCode",void 0),t=e([sf.base.NotifyPropertyChanges],t)}(sf.base.Component),se=(pi=function(n,t){return(pi=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}pi(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),uu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return se(t,n),t.prototype.initProperties=function(n,t){var i=n.initialClipRect,r;t.triangleSize=new sf.svgbase.Size(o(t.width,i.width),o(t.height,i.height));t.neckSize=new sf.svgbase.Size(o(t.neckWidth,i.width),o(t.neckHeight,i.height));this.defaultLabelBound(t,t.dataLabel.visible,t.dataLabel.position,n);"30%"===t.explodeOffset&&(t.explodeOffset="25px");n.explodeDistance=o(t.explodeOffset,i.width);r=t.points;this.initializeSizeRatio(r,t)},t.prototype.initializeSizeRatio=function(n,t,i){var r,e;void 0===i&&(i=!1);for(var s=t.sumOfPoints,f=Math.min(Math.max(t.gapRatio,0),1),h=1/(s*(1+f/(1-f))),c=f/(n.length-1),o=0,u=n.length-1;u>=0;u--)r=i?n.length-1-u:u,n[r].visible&&(e=h*n[r].y,n[r].yRatio=o,n[r].heightRatio=e,o+=e+c)},t.prototype.setLabelLocation=function(n,t,i){var u=i.length-1,r="Funnel"===n.type?i.length-2:i.length-1,f=(i[0].x+i[r].x)/2,e=(i[1].x+i[r-1].x)/2;t.region=new sf.svgbase.Rect(f,i[0].y,e-f,i[r].y-i[0].y);t.symbolLocation={x:t.region.x+t.region.width/2,y:t.region.y+t.region.height/2};t.labelOffset={x:t.symbolLocation.x-(i[0].x+i[u].x)/2,y:t.symbolLocation.y-(i[0].y+i[u].y)/2}},t.prototype.findPath=function(n){for(var i="M",t=0;t<n.length;t++)i+=n[t].x+" "+n[t].y,t!==n.length-1&&(i+=" L");return i},t.prototype.defaultLabelBound=function(n,t,i,r){var f=(r.initialClipRect.width-n.triangleSize.width)/2,e=(r.initialClipRect.height-n.triangleSize.height)/2,u=new sf.svgbase.Rect(f,e,n.triangleSize.width,n.triangleSize.height);n.labelBound=new sf.svgbase.Rect(u.x,u.y,u.width+u.x,u.height+u.y);n.accumulationBound=u;t&&"Outside"===i&&(n.labelBound=new sf.svgbase.Rect(1/0,1/0,-1/0,-1/0))},t}(pt),he=(wi=function(n,t){return(wi=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}wi(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),fu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return he(t,n),t.prototype.getSegmentData=function(n,t,i){var f,a,s,v,h,y,p,l,r=t.triangleSize,e=(i.initialClipRect.width-t.triangleSize.width)/2+i.initialClipRect.x,w=i.initialClipRect.y+(i.initialClipRect.height-r.height)/2,c=n.yRatio*r.height,o=c+n.heightRatio*r.height,u=t.neckSize,b,k,d;return f=u.width+(r.width-u.width)*((r.height-u.height-c)/(r.height-u.height)),v=(a=r.width/2-f/2)+f,f=o>r.height-u.height||r.height===u.height?u.width:u.width+(r.width-u.width)*((r.height-u.height-o)/(r.height-u.height)),h=(s=r.width/2-f/2)+f,c>=r.height-u.height?(a=s=y=r.width/2-u.width/2,v=h=p=r.width/2+u.width/2):o>r.height-u.height&&(p=h=(y=s=r.width/2-f/2)+f,l=r.height-u.height),b={x:e+0+h,y:o+=w},k={x:e+0+s,y:o},(l+=w)&&(b={x:e+0+p,y:l},k={x:e+0+y,y:l}),d=[{x:e+0+a,y:c+=w},{x:e+0+v,y:c},b,{x:e+0+h,y:o},{x:e+0+s,y:o},k],this.setLabelLocation(t,n,d),this.findPath(d)},t.prototype.renderPoint=function(n,t,i,r,u,f){if(!n.visible)return l(r.id),null;var e=this.getSegmentData(n,t,i);n.midAngle=0;r.d=e;y(!1,u,i.renderer.drawPath(r),f);n.isExplode&&i.accBaseModule.explodePoints(n.index,i,!0)},t.prototype.getModuleName=function(){return"FunnelSeries"},t.prototype.destroy=function(){},t}(uu),ce=(bi=function(n,t){return(bi=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}bi(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),eu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ce(t,n),t.prototype.getSegmentData=function(n,t,i){var r=t.triangleSize,s=i.initialClipRect.y+(i.initialClipRect.height-r.height)/2,u=(i.initialClipRect.width-t.triangleSize.width)/2+i.initialClipRect.x,e=n.yRatio,f=n.yRatio+n.heightRatio,h=.5*(1-n.yRatio),c=.5*(1-f),o;return e+=s/r.height,f+=s/r.height,o=[{x:u+0+h*r.width,y:e*r.height},{x:u+0+(1-h)*r.width,y:e*r.height},{x:u+0+(1-c)*r.width,y:f*r.height},{x:u+0+c*r.width,y:f*r.height}],this.setLabelLocation(t,n,o),this.findPath(o)},t.prototype.initializeSizeRatio=function(t,i){"Linear"===i.pyramidMode?n.prototype.initializeSizeRatio.call(this,t,i,!0):this.calculateSurfaceSegments(i)},t.prototype.calculateSurfaceSegments=function(n){for(var f,r=n.points.length,h=n.sumOfPoints,e=[],u=[],o=Math.min(0,Math.max(n.gapRatio,1))/(r-1),s=this.getSurfaceHeight(0,h),i=0,t=0;t<r;t++)n.points[t].visible&&(e[t]=i,u[t]=this.getSurfaceHeight(i,Math.abs(n.points[t].y)),i+=u[t]+o*s);for(f=1/(i-o*s),t=0;t<r;t++)n.points[t].visible&&(n.points[t].yRatio=f*e[t],n.points[t].heightRatio=f*u[t])},t.prototype.getSurfaceHeight=function(n,t){return this.solveQuadraticEquation(1,2*n,-t)},t.prototype.solveQuadraticEquation=function(n,t,i){var u,f,e=t*t-4*n*i,r;return e>=0?(r=Math.sqrt(e),u=(-t-r)/(2*n),f=(-t+r)/(2*n),Math.max(u,f)):0},t.prototype.renderPoint=function(n,t,i,r,u,f){if(!n.visible)return sf.svgbase.removeElement(r.id),null;r.d=this.getSegmentData(n,t,i);n.midAngle=0;y(!1,u,i.renderer.drawPath(r),f);n.isExplode&&i.accBaseModule.explodePoints(n.index,i,!0)},t.prototype.getModuleName=function(){return"PyramidSeries"},t.prototype.destroy=function(){},t}(uu),le=(ki=function(n,t){return(ki=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ki(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ou=function(n){function t(t){var i=n.call(this,t)||this;return i.library=i,i.titleRect=new sf.svgbase.Rect(0,t.margin.top,0,0),i}return le(t,n),t.prototype.getLegendOptions=function(n,t){var i,u,f,e,r;for(this.legendCollections=[],i=0;i<1;i++)for(u=t[i].type,"Pie"!==u&&"Doughnut"!==u||(u="0"!==t[i].innerRadius&&"0%"!==t[i].innerRadius?"Doughnut":"Pie"),f=0,e=t[i].points;f<e.length;f++)r=e[f],sf.base.isNullOrUndefined(r.x)||sf.base.isNullOrUndefined(r.y)||this.legendCollections.push(new ie(r.x.toString(),r.color,t[i].legendShape,r.visible,u,r.legendImageUrl,null,null,r.index,t[i].index))},t.prototype.getLegendBounds=function(n,t,i){var u,nt;this.calculateLegendTitle(i,t);this.isTitle=!!i.title;var b=0,k=0,r=i.padding,y=i.titlePosition,a=0,tt=this.arrowWidth,v=i.enablePages?0:this.arrowHeight;this.isVertical?b=i.width?0:n.width/20:k=i.height?0:n.height/20;t.width+=b;t.height+=k;var p,h,it=i.shapePadding,e=0,rt=i.shapeWidth,o=0,s=0,l=[],f=0,c=0;this.maxItemHeight=Math.max(sf.svgbase.measureText("MeasureText",i.textStyle).height,i.shapeHeight);for(var d=!1,w=0,g=this.legendCollections;w<g.length;w++)u=g[w],h={fill:u.fill,text:u.text,shape:u.shape,name:"legendRender",cancel:!1},this.chart.trigger("legendRender",h),u.render=!h.cancel,u.text=h.text.indexOf("&")>-1?this.convertHtmlEntities(h.text):h.text,u.fill=h.fill,u.shape=h.shape,u.textSize=sf.svgbase.measureText(u.text,i.textStyle),u.render&&""!==u.text&&(d=!0,c=rt+it+u.textSize.width+r,this.isVertical?(f=++s*(this.maxItemHeight+r)+r+this.legendTitleSize.height+v,s*(this.maxItemHeight+r)+r+v>t.height&&(f=Math.max(f,s*(this.maxItemHeight+r)+r+v),o+=e,l.push(e),this.totalPages=Math.max(s,this.totalPages||1),e=0,s=1),e=Math.max(c,e)):(i.enablePages||(a=this.isTitle&&"Top"!==y?this.legendTitleSize.width+this.fivePixel:0,a+=tt),o+=c,t.width<r+o+a&&(e=Math.max(e,o+r+a-c),0===s&&c!==o&&(s=1),o=c,f=++s*(this.maxItemHeight+r)+r+this.legendTitleSize.height)));p="Top"===y?this.legendTitleSize.height:0;this.isVertical?(o+=e,this.isPaging=t.width<o+r,f=Math.max(f,(this.totalPages||1)*(this.maxItemHeight+r)+r+v),this.isPaging=this.isPaging&&this.totalPages>1,l[l.length-1]!==e&&l.push(e)):(this.isPaging=t.height<f,f=!i.enablePages&&this.isPaging?this.maxItemHeight+r+r+p:f,this.totalPages=this.totalRowCount=s,f=Math.max(f,this.maxItemHeight+r+r+p),this.isPaging||(o+=this.isTitle&&"Top"!==y?this.fivePixel+this.legendTitleSize.width+this.fivePixel:0));this.maxColumns=0;nt=this.isVertical?this.getMaxColumn(l,t.width,r,o+r):Math.max(o+r,e);d?this.setBounds(nt,f,i,t):this.setBounds(0,0,i,t)},t.prototype.convertHtmlEntities=function(n){var t=n.replace("&amp;","&").replace("&lt;","<").replace("&gt;",">").replace("&quot;",'"').replace("&nbsp;"," ").replace("&cent;","").replace("&pound;","").replace("&yen;","").replace("&euro;","").replace("&copy;","").replace("&reg;","");return t.replace("&#38;","&").replace("&#60;","<").replace("&#62;",">").replace("&#34;",'"').replace("&#160;"," ").replace("&#162;","").replace("&#163;","").replace("&#165;","").replace("&#8364;","").replace("&#169;","").replace("&#174;","")},t.prototype.getMaxColumn=function(n,t,i,r){var u=i,f,e;for(this.maxColumnWidth=Math.max.apply(null,n),f=0,e=n;f<e.length;f++)if(e[f],u+=this.maxColumnWidth,this.maxColumns++,u+i>t){u-=this.maxColumnWidth;this.maxColumns--;break}return this.isPaging=u<r&&this.totalPages>1,u===i&&(u=t),this.maxColumns=Math.max(1,this.maxColumns),this.maxWidth=u,u},t.prototype.getAvailWidth=function(n,t){return this.isVertical&&(t=this.maxWidth),t-(2*this.legend.padding+this.legend.shapeWidth+this.legend.shapePadding)},t.prototype.getRenderPoint=function(n,t,i,r,u,f,e){var o=this.legend.padding,s,h;this.isVertical?f===e||r.location.y+1.5*this.maxItemHeight+2*o>u.y+u.height?(n.location.x=r.location.x+(f===e?0:this.maxColumnWidth),n.location.y=t.y,this.pageXCollections.push(n.location.x-this.legend.shapeWidth/2-o),this.totalPages++):(n.location.x=r.location.x,n.location.y=r.location.y+this.maxItemHeight+o):(s=r.location.x+i+r.textSize.width,s+(n.textSize.width+i)>u.x+u.width+this.legend.shapeWidth/2?(n.location.y=f===e?r.location.y:r.location.y+this.maxItemHeight+o,n.location.x=t.x):(n.location.y=r.location.y,n.location.x=f===e?r.location.x:s),this.totalPages=this.totalRowCount);h=this.getAvailWidth(n.location.x,this.legendBounds.width);n.text=it(+h.toFixed(4),n.text,this.legend.textStyle)},t.prototype.getSmartLegendLocation=function(n,t,i){var r;switch(this.position){case"Left":r=(n.x-t.width-i.left)/2;t.x=n.x-t.width<i.left?t.x:n.x-t.width-r;break;case"Right":r=(this.chart.availableSize.width-i.right-(n.x+n.width+t.width))/2;t.x=n.x+n.width+t.width>this.chart.availableSize.width-i.right?t.x:n.x+n.width+r;break;case"Top":this.getTitleRect(this.chart);r=(n.y-t.height-(this.titleRect.y+this.titleRect.height))/2;t.y=n.y-t.height<i.top?t.y:n.y-t.height-r;break;case"Bottom":r=(this.chart.availableSize.height-i.bottom-(n.y+n.height+t.height))/2;t.y=n.y+n.height+t.height>this.chart.availableSize.height-i.bottom?t.y:n.y+n.height+r}},t.prototype.getTitleRect=function(n){if(!n.title)return null;var t=sf.svgbase.measureText(n.title,n.titleStyle);this.titleRect=new sf.svgbase.Rect(n.availableSize.width/2-t.width/2,n.margin.top,t.width,t.height)},t.prototype.legendByIndex=function(n,t){for(var u,i=0,r=t;i<r.length;i++)if(u=r[i],u.pointIndex===n)return u;return null},t.prototype.click=function(n){var u=n.target.id,r=this.chart,h=[this.legendID+"_text_",this.legendID+"_shape_",this.legendID+"_shape_marker_"],f,e,o,t;for(this.chart.accumulationSelectionModule&&sf.base.extend([],this.chart.accumulationSelectionModule.selectedDataIndexes,null,!0),this.chart.animateSeries=!1,f=0,e=h;f<e.length;f++)if(o=e[f],u.indexOf(o)>-1)if(t=parseInt(u.split(o)[1],10),this.chart.legendSettings.toggleVisibility&&!isNaN(t)){var s=this.chart.visibleSeries[0],i=yt(t,s.points),c=this.legendByIndex(t,this.legendCollections);i.visible=!i.visible;c.visible=i.visible;s.sumOfPoints+=i.visible?i.y:-i.y;r.redraw=r.enableAnimation;this.sliceVisibility(t,i.visible);r.removeSvg();wr(r);this.chart.refreshPoints(s.points);this.chart.renderElements()}else this.chart.accumulationSelectionModule&&!isNaN(t)&&this.chart.accumulationSelectionModule.legendSelection(this.chart,0,t);u.indexOf(this.legendID+"_pageup")>-1?this.changePage(n,!0):u.indexOf(this.legendID+"_pagedown")>-1&&this.changePage(n,!1);r.redraw=!1},t.prototype.sliceVisibility=function(n,t){var i=this.chart.element.id+"_Series_0_Point_";this.chart.visibleSeries[0].dataLabel.visible&&(i=this.chart.element.id+"_datalabel_Series_0_",this.sliceAnimate(h(i+"g_"+n),t))},t.prototype.sliceAnimate=function(n,t){if(!n)return null;new sf.base.Animation({}).animate(n,{duration:300,delay:0,name:t?"FadeIn":"FadeOut",end:function(n){n.element.style.visibility=t?"visible":"hidden"}})},t.prototype.getModuleName=function(){return"AccumulationLegend"},t.prototype.destroy=function(){},t}(te),ae=(di=function(n,t){return(di=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}di(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),su=function(n){function t(t){var i=n.call(this,t)||this,r;return(i.rightSideRenderingPoints=[],i.leftSideRenderingPoints=[],i.id=t.element.id+"_datalabel_Series_",t.title)&&(r=sf.svgbase.measureText(t.title,t.titleStyle),i.titleRect=new sf.svgbase.Rect(t.availableSize.width/2-r.width/2,t.margin.top,r.width,r.height)),i}return ae(t,n),t.prototype.getDataLabelPosition=function(n,t,i,r){var u=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],n):this.accumulation.pieSeriesModule.labelRadius:this.getLabelDistance(n,t);this.getLabelRegion(n,t.position,i,u,this.marginValue);n.labelAngle=n.midAngle;n.labelPosition=t.position;this.accumulation.enableSmartLabels&&this.getSmartLabel(n,t,i,r)},t.prototype.getLabelRegion=function(n,t,i,r,u,f){void 0===f&&(f=0);var o=f||n.midAngle,e=a(o,r,this.isCircular()?this.center:this.getLabelLocation(n,t));e.y="Inside"===t?e.y-i.height/2:e.y;e.x="Inside"===t?e.x-i.width/2:e.x;n.labelRegion=new sf.svgbase.Rect(e.x,e.y,i.width+2*u,i.height+2*u);"Outside"===t&&(n.labelRegion.y-=n.labelRegion.height/2,o>=90&&o<=270?n.labelRegion.x-=n.labelRegion.width+10:n.labelRegion.x+=10)},t.prototype.getSmartLabel=function(n,t,i,r){var h=this.isCircular(),s=h?this.radius:this.getLabelDistance(n,t),f,e,u;if(s+=o(h?t.connectorStyle.length||"4%":"0px",s),u=this.findPreviousPoint(r,n.index,n.labelPosition),"Inside"===t.position?(n.labelRegion.height-=4,n.labelRegion.width-=4,(u&&u.labelRegion&&(p(n.labelRegion,u.labelRegion)||this.isOverlapping(n,r))||!h&&(f=n.region,e=n.labelRegion,!(f.x<=e.x&&f.x+f.width>=e.x+e.width&&f.y<=e.y&&f.height+f.y>=e.y+e.height)))&&(n.labelPosition="Outside",h||(s=this.getLabelDistance(n,t)),this.getLabelRegion(n,n.labelPosition,i,s,this.marginValue),(u=this.findPreviousPoint(r,n.index,n.labelPosition))&&(p(n.labelRegion,u.labelRegion)||this.isConnectorLineOverlapping(n,u))&&this.setOuterSmartLabel(u,n,t.border.width,s,i,this.marginValue))):u&&u.labelRegion&&(p(n.labelRegion,u.labelRegion)||this.isOverlapping(n,r)||this.isConnectorLineOverlapping(n,u))&&this.setOuterSmartLabel(u,n,t.border.width,s,i,this.marginValue),this.isOverlapping(n,r)&&("Pyramid"===this.accumulation.type||"Funnel"===this.accumulation.type)){var v=n.midAngle||0,c=h?this.radius:this.getLabelDistance(n,t),l=a(v,-c,this.isCircular()?this.center:this.getLabelLocation(n,"OutsideLeft"));n.labelRegion=new sf.svgbase.Rect(l.x,l.y,i.width+2*this.marginValue,i.height+2*this.marginValue);n.labelRegion.y-=n.labelRegion.height/2;n.labelRegion.x=n.labelRegion.x-10-n.labelRegion.width;u&&u.labelRegion&&(p(n.labelRegion,u.labelRegion)||this.isOverlapping(n,r)||this.isConnectorLineOverlapping(n,u))&&this.setOuterSmartLabel(u,n,t.border.width,c,i,this.marginValue)}},t.prototype.move=function(n,t,i,r){var s=this,u,f,e,o;n.target.textContent.indexOf("...")>-1?(u=n.target.id.split(this.id),2===u.length&&(f=parseInt(u[1].split("_text_")[0],10),e=parseInt(u[1].split("_text_")[1],10),isNaN(f)||isNaN(e)||(r&&l(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip"),o=tu(f,this.accumulation.visibleSeries).points[e],ct(o.text||o.y.toString(),t,i,this.areaRect.width,this.accumulation.element.id+"_EJ2_Datalabel_Tooltip",h(this.accumulation.element.id+"_Secondary_Element"))))):l(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip");r&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout(function(){l(s.accumulation.element.id+"_EJ2_Datalabel_Tooltip")},1e3))},t.prototype.findPreviousPoint=function(n,t,i){for(var r=n[0],u=t-1;u>=0;u--)if((r=n[u]).visible&&r.labelVisible&&r.labelRegion&&r.labelPosition===i)return r;return null},t.prototype.isOverlapping=function(n,t){for(var i=n.index-1;i>=0;i--)if(t[i].visible&&t[i].labelVisible&&t[i].labelRegion&&n.labelRegion&&n.labelVisible&&p(n.labelRegion,t[i].labelRegion))return!0;return!1},t.prototype.textTrimming=function(n,t,i,r){if(p(n.labelRegion,t)){var u=n.labelRegion.width;"Right"===r?u=t.x-n.labelRegion.x:"Left"===r?(u=n.labelRegion.x-(t.x+t.width))<0&&(u+=n.labelRegion.width,n.labelRegion.x=t.x+t.width):"InsideRight"===r?u=t.x+t.width-n.labelRegion.x:"InsideLeft"===r?(u=n.labelRegion.x+n.labelRegion.width-t.x)<n.labelRegion.width&&(n.labelRegion.x=t.x):this.setPointVisibileFalse(n);n.labelVisible&&n.labelRegion&&(u<n.labelRegion.width&&(n.label=it(u-2*this.marginValue,n.label,i),n.labelRegion.width=u),3===n.label.length&&n.label.indexOf("...")>-1&&this.setPointVisibileFalse(n))}},t.prototype.setPointVisibileFalse=function(n){n.labelVisible=!1;n.labelRegion=null},t.prototype.setPointVisibleTrue=function(n){n.labelVisible=!0},t.prototype.setOuterSmartLabel=function(n,t,i,r,u,f){if(this.isCircular()){var e=this.getOverlappedAngle(n.labelRegion,t.labelRegion,t.midAngle,2*i);for(this.getLabelRegion(t,"Outside",u,r,f,e),e>t.endAngle&&(e=t.midAngle),t.labelAngle=e;t.labelVisible&&(p(n.labelRegion,t.labelRegion)||e<=n.labelAngle||this.isConnectorLineOverlapping(t,n))&&!(e>t.endAngle);)t.labelAngle=e,this.getLabelRegion(t,"Outside",u,r,f,e),e+=.1}else this.setSmartLabelForSegments(t,n)},t.prototype.setSmartLabelForSegments=function(n,t){var r=n.labelRegion,i="Funnel"===this.accumulation.type?t.labelRegion.y-(r.y+r.height):n.labelRegion.y-(t.labelRegion.y+t.labelRegion.height);i<0&&(n.labelRegion.y+="Funnel"===this.accumulation.type?i:-i)},t.prototype.isConnectorLineOverlapping=function(n,t){var f,r,i,e,u;return!this.isCircular()&&n.labelRegion.x<n.region.x&&(f="outsideLeft"),r=this.getLabelLocation(n,f),i=new s(0,0),this.getEdgeOfLabel(n.labelRegion,n.labelAngle,i,0,n),e=this.getLabelLocation(t),u=new s(0,0),this.getEdgeOfLabel(t.labelRegion,t.labelAngle,u,0,n),this.isLineRectangleIntersect(r,i,n.labelRegion)||this.isLineRectangleIntersect(r,i,t.labelRegion)||this.isLineRectangleIntersect(e,u,n.labelRegion)},t.prototype.isLineRectangleIntersect=function(n,t,i){var u=[new s(Math.round(i.x),Math.round(i.y)),new s(Math.round(i.x+i.width),Math.round(i.y)),new s(Math.round(i.x+i.width),Math.round(i.y+i.height)),new s(Math.round(i.x),Math.round(i.y+i.height))],r;for(n.x=Math.round(n.x),n.y=Math.round(n.y),t.x=Math.round(t.x),t.y=Math.round(t.y),r=0;r<u.length;r++)if(this.isLinesIntersect(n,t,u[r],u[(r+1)%u.length]))return!0;return!1},t.prototype.isLinesIntersect=function(n,t,i,r){var e=t.y-n.y,o=n.x-t.x,a=e*n.x+o*n.y,s=r.y-i.y,h=i.x-r.x,v=s*i.x+h*i.y,c=e*h-s*o;if(0!==c){var u=(h*a-o*v)/c,f=(e*v-s*a)/c,l=Math.min(n.x,t.x)<=u&&u<=Math.max(n.x,t.x);return(l=(l=l&&Math.min(n.y,t.y)<=f&&f<=Math.max(n.y,t.y))&&Math.min(i.x,r.x)<=u&&u<=Math.max(i.x,r.x))&&Math.min(i.y,r.y)<=f&&f<=Math.max(i.y,r.y)}return!1},t.prototype.getOverlappedAngle=function(n,t,i,r){var u=n.x;return i>=90&&i<=270?(t.y=n.y-(r+t.height/2),u=n.x+n.width):t.y=n.y+n.height+r,function(n,t){var i=Math.atan2(t.y-n.y,t.x-n.x);return(i=i<0?6.283+i:i)*(180/Math.PI)}(this.center,new s(u,t.y))},t.prototype.getConnectorPath=function(n,t,i,r){var v;void 0===r&&(r=0);var h=i.connectorStyle,c=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],t):this.labelRadius:this.getLabelDistance(t,i),f=this.getConnectorStartPoint(t,h),l=this.accumulation.enableSmartLabels?t.midAngle:r||t.midAngle,u=new s(0,0),e=this.getEdgeOfLabel(n,l,u,h.width,t);return"Curve"===h.type?this.isCircular()?(v=c-(this.isVariousRadius()?o(t.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius),t.isLabelUpdated?u=this.getPerpendicularDistance(f,t):(u=a(l,c-v/2,this.center),"Outside"===t.labelPosition&&"Inside"===i.position&&(u=a(l,c-1.25*v,this.center))),"M "+f.x+" "+f.y+" Q "+u.x+" "+u.y+" "+e.x+" "+e.y):this.getPolyLinePath(f,e):"M "+f.x+" "+f.y+" L "+u.x+" "+u.y+" L "+e.x+" "+e.y},t.prototype.getPolyLinePath=function(n,t){var e=[n,t],r,i,f,u;if(n.y===t.y)return"M "+n.x+" "+n.y+" L "+t.x+" "+t.y;for(r="M",i=0;i<=16;i++)f=i/16,u=this.getBezierPoint(f,e,0,2),r+=u.x+","+u.y,16!==i&&(r+=" L");return r},t.prototype.getBezierPoint=function(n,t,i,r){if(1===r)return t[i];var u=this.getBezierPoint(n,t,i,r-1),f=this.getBezierPoint(n,t,i+1,r-1),e=(u.x,u.x),o=(u.y,u.y),s=(1-n)*e+n*(f.x,f.x),h=(1-n)*o+n*(f.y,f.y);return u.x,{x:s,y:h}},t.prototype.getEdgeOfLabel=function(n,t,i,r,u){void 0===r&&(r=1);var f=new s(n.x,n.y);return t>=90&&t<=270?(f.x+=n.width+r/2,f.y+=n.height/2,i.x=f.x+10,i.y=f.y):u&&u.region&&u.region.x>u.labelRegion.x?(f.x+=2*r+n.width,f.y+=n.height/2,i.x=f.x+10,i.y=f.y):(f.x-=r/2,f.y+=n.height/2,i.x=f.x-10,i.y=f.y),f},t.prototype.getLabelDistance=function(n,t){var i;if((n.labelPosition&&t.position!==n.labelPosition||t.connectorStyle.length)&&(i=o(t.connectorStyle.length||"70px",this.accumulation.initialClipRect.width),i<this.accumulation.initialClipRect.width))return i;var r,u=n.labelPosition||t.position,f=this.accumulation.visibleSeries[0],e=(this.accumulation.initialClipRect.width-f.triangleSize.width)/2;switch(u){case"Inside":return 0;case"Outside":return r=n.symbolLocation.x+n.labelOffset.x,this.accumulation.initialClipRect.width-r-e}},t.prototype.getLabelLocation=function(n,t){if(void 0===t&&(t="Outside"),"Pie"!==this.accumulation.type){t="OutsideLeft"===t?"OutsideLeft":n.labelPosition||t;var i={x:n.symbolLocation.x,y:n.symbolLocation.y-n.labelOffset.y};switch(t){case"Inside":i.y=n.region.y+n.region.height/2;break;case"Outside":i.x+=n.labelOffset.x;break;case"OutsideLeft":i.x-=n.labelOffset.x}return i}return a(n.midAngle,this.isVariousRadius()?o(n.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius,this.center)},t.prototype.getConnectorStartPoint=function(n,t){var i;return!this.isCircular()&&n.region.x>n.labelRegion.x&&(i="OutsideLeft"),this.isCircular()?a(n.midAngle,(this.isVariousRadius()?o(n.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius)-t.width,this.center):this.getLabelLocation(n,i)},t.prototype.findAreaRect=function(){this.areaRect=new sf.svgbase.Rect(0,0,this.accumulation.availableSize.width,this.accumulation.availableSize.height);var n=this.accumulation.margin;ft(this.areaRect,new st(n.left,n.right,n.top,n.bottom))},t.prototype.renderDataLabel=function(n,t,i,r,u,f,e){var h=this.accumulation.element.id+"_datalabel_Series_"+u+"_",a=this.accumulation.renderer.createGroup({id:h+"g_"+n.index}),c,s,l;n.label=n.originalText||n.y.toString();var v={width:t.border.width,color:t.border.color},y=sf.base.extend({},sf.base.getValue("properties",t.font),null,!0),o={cancel:!1,name:"textRender",series:this.accumulation.visibleSeries[0],point:n,text:n.label,border:v,color:t.fill,template:t.template,font:y};this.accumulation.trigger("textRender",o);n.argsData=o;c=null!==o.template;n.labelVisible=!o.cancel;n.text=n.label=o.text;Number(n.label)&&(n.label=this.accumulation.intl.formatNumber(+n.label,{useGrouping:this.accumulation.useGroupingSeparator}));this.marginValue=o.border.width?5+o.border.width:1;l=sf.base.createElement("div",{id:this.accumulation.element.id+"_Series_0_DataLabel_"+n.index,styles:"position: absolute;background-color:"+o.color+";"+(s=t.font,"font-size:"+s.size+"; font-style:"+s.fontStyle+"; font-weight:"+s.fontWeight+"; font-family:"+s.fontFamily+";opacity:"+s.opacity+"; color:"+s.color+";;border:")+o.border.width+"px solid "+o.border.color+";"});this.calculateLabelSize(c,l,n,r,o,a,h,t,e)},t.prototype.calculateLabelSize=function(n,t,i,r,u,f,e,o,s,h,c){var l=n?c?{width:h.width,height:h.height}:this.getTemplateSize(t,i,u,s,n,r,f,e,o):sf.svgbase.measureText(i.label,o.font);l.height+=4;l.width+=4;i.textSize=l;i.templateElement=t;this.getDataLabelPosition(i,o,l,r);i.labelRegion&&this.correctLabelRegion(i.labelRegion,i.textSize)},t.prototype.drawDataLabels=function(n,t,i,r,u){var e,l,w=n.leftSidePoints.concat(n.rightSidePoints),a,b,f,g,d,tt;for(w.sort(function(n,t){return n.index-t.index}),"Pie"===n.type&&this.accumulation.enableSmartLabels&&this.extendedLabelsCalculation(),a=0,b=w;a<b.length;a++)if(f=b[a],!sf.base.isNullOrUndefined(f.argsData)&&!sf.base.isNullOrUndefined(f.y)){this.finalizeDatalabels(f,w,t);var c=this.accumulation.element.id+"_datalabel_Series_0_",v=this.accumulation.renderer.createGroup({id:c+"g_"+f.index}),o=void 0,p=void 0;if(f.visible&&f.labelVisible){if(e=l=t.angle,f.argsData.template)this.setTemplateStyle(f.templateElement,f,r,t.font.color,f.color,u);else{o=new s(f.labelRegion.x+this.marginValue,f.labelRegion.y+3*f.textSize.height/4+this.marginValue);g=(p=h(c+"shape_"+f.index))?new s(+p.getAttribute("x"),+p.getAttribute("y")):null;y(!1,v,this.accumulation.renderer.drawRectangle(new oi(c+"shape_"+f.index,f.argsData.color,f.argsData.border,1,f.labelRegion,t.rx,t.ry)),u,!0,"x","y",g,null,!1,!1,null,this.accumulation.duration);var nt=f.textSize.width,it=f.textSize.height,k=void 0;k=0!==e&&t.enableRotation?"rotate("+(l="Outside"===f.labelPosition?0:f.midAngle>=90&&f.midAngle<=270?f.midAngle+180:f.midAngle)+","+(o.x+nt/2)+","+(o.y-it/4)+")":"rotate("+(l=e?e>360?e-360:e<-360?e+360:e:0)+","+(o.x+nt/2)+","+o.y+")";f.transform=k;rt(this.accumulation.renderer,new sf.svgbase.TextOption(c+"text_"+f.index,o.x,o.y,"start",f.label,k,"auto",l),f.argsData.font,f.argsData.font.color||this.getSaturatedColor(f,f.argsData.color),v,!1,u,!0,!1,this.accumulation.duration);p=null}(this.accumulation.accumulationLegendModule&&("Outside"===t.position||this.accumulation.enableSmartLabels)&&this.accumulation.visibleSeries[0].findMaxBounds(this.accumulation.visibleSeries[0].labelBound,f.labelRegion),"Outside"===f.labelPosition)&&(d=h(c+"connector_"+f.index),tt=d?d.getAttribute("d"):"",y(!1,v,this.accumulation.renderer.drawPath(new sf.svgbase.PathOption(c+"connector_"+f.index,"transparent",t.connectorStyle.width,t.connectorStyle.color||f.color,1,t.connectorStyle.dashArray,this.getConnectorPath(sf.base.extend({},f.labelRegion,null,!0),f,t,f.labelAngle))),u,!0,null,null,null,tt,!1,!1,null,this.accumulation.duration));y(!1,i,v,u)}}},t.prototype.finalizeDatalabels=function(n,t,i){var r,u,f;((this.isOverlapping(n,t)||this.titleRect&&n.labelRegion&&p(n.labelRegion,this.titleRect))&&this.isCircular()&&"Outside"===n.labelPosition&&this.setPointVisibileFalse(n),this.accumulation.accumulationLegendModule&&n.labelVisible&&n.labelRegion)&&(r=this.accumulation.accumulationLegendModule.legendBounds,u=this.accumulation.legendSettings.border.width/2,this.textTrimming(n,new sf.svgbase.Rect(r.x-u,r.y-u,r.width+2*u,r.height+2*u),i.font,this.accumulation.accumulationLegendModule.position));n.labelVisible&&n.labelRegion&&(f=this.isCircular()?n.labelRegion.x>=this.center.x?"InsideRight":"InsideLeft":n.labelRegion.x>=n.region.x?"InsideRight":"InsideLeft",this.textTrimming(n,this.areaRect,i.font,f));n.labelVisible&&n.labelRegion&&(n.labelRegion.y+n.labelRegion.height>this.areaRect.y+this.areaRect.height||n.labelRegion.y<this.areaRect.y||n.labelRegion.x<this.areaRect.x||n.labelRegion.x+n.labelRegion.width>this.areaRect.x+this.areaRect.width)&&this.setPointVisibileFalse(n)},t.prototype.getTemplateSize=function(n,t,i,r,u,f,e,o,s){var h=vr(n=ar(n,t.index,i.template,this.accumulation,t,this.accumulation.visibleSeries[0],this.accumulation.element.id+"_DataLabel",0,i,u,f,e,o,s,r),r);return{width:h.width,height:h.height}},t.prototype.setTemplateStyle=function(n,t,i,r,u,f){if(n.style.left=t.labelRegion.x+"px",n.style.top=t.labelRegion.y+"px",n.style.color=r||this.getSaturatedColor(t,u),this.accumulation.isBlazor){var e=this.isCircular()?t.labelRegion.x>=this.center.x?"InsideRight":"InsideLeft":t.labelRegion.x>=t.region.x?"InsideRight":"InsideLeft";n.style.transform="InsideRight"===e?"translate(0%, -50%)":"translate(-100%, -50%)"}n.childElementCount&&(y(!1,i,n,f,!0,"left","top"),this.doTemplateAnimation(this.accumulation,n))},t.prototype.getSaturatedColor=function(n,t){var i,f,r,u;return i="transparent"===(i=this.marginValue>=1?"transparent"===t?this.getLabelBackground(n):t:this.getLabelBackground(n))?window.getComputedStyle(document.body,null).backgroundColor:i,u=(f=kf(i),(r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(f))?new si(parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)):new si(255,255,255)),Math.round((299*u.r+587*u.g+114*u.b)/1e3)>=128?"black":"white"},t.prototype.doTemplateAnimation=function(n,t){var i=n.visibleSeries[0],r=i.animation.delay+i.animation.duration;i.animation.enable&&n.animateSeries&&(t.style.visibility="hidden",lr(t,r,200,"ZoomIn"))},t.prototype.getLabelBackground=function(n){return"Outside"===n.labelPosition?this.accumulation.background||this.accumulation.themeStyle.background:n.color},t.prototype.correctLabelRegion=function(n,t,i){void 0===i&&(i=4);n.height-=i;n.width-=i;n.x+=i/2;n.y+=i/2;t.height-=i;t.width-=i},t.prototype.getModuleName=function(){return"AccumulationDataLabel"},t.prototype.destroy=function(){},t.prototype.extendedLabelsCalculation=function(){var t=this,n=this.accumulation.series[0];n.rightSidePoints.forEach(function(n,i,r){n.initialLabelRegion=n.labelRegion;n.isLabelUpdated=0;t.skipPoints(n,r,i)});n.leftSidePoints.forEach(function(n,i,r){n.initialLabelRegion=n.labelRegion;n.isLabelUpdated=0;t.skipPoints(n,r,i)});this.arrangeLeftSidePoints(n);this.isIncreaseAngle=!1;this.arrangeRightSidePoints(n)},t.prototype.arrangeRightSidePoints=function(n){var s,h,o,f,t=n.rightSidePoints.filter(function(n){return n.labelVisible&&"Outside"===n.labelPosition}),e,u,r,i;for(this.rightSideRenderingPoints=t,u=t[t.length-1],u&&u.labelAngle>90&&u.labelAngle<270&&(this.isIncreaseAngle=!0,this.changeLabelAngle(u,89)),r=t.length-1;r>=0;r--)if(f=t[r],e=t[r+1],(!this.isOverlapWithNext(f,t,r)||!f.labelVisible)&&(f.labelAngle<=90||f.labelAngle>=270))h&&e&&!e.isLabelUpdated&&(s=!0);else if(o=u.labelAngle+10,h=!0,s?this.isIncreaseAngle=!1:o>90&&o<270&&e.isLabelUpdated&&(this.isIncreaseAngle=!0),this.isIncreaseAngle)for(i=r+1;i>0;i--)this.decreaseAngle(t[i],t[i-1],n,!0);else for(i=r+1;i<t.length;i++)this.increaseAngle(t[i-1],t[i],n,!0)},t.prototype.arrangeLeftSidePoints=function(n){var f,u,e,o,s=this,t=n.leftSidePoints.filter(function(n){return n.labelVisible&&"Outside"===n.labelPosition}),r,i;for(this.leftSideRenderingPoints=t,r=0;r<t.length;r++)if(u=t[r],f=t[r-1],(!this.isOverlapWithPrevious(u,t,r)||!u.labelVisible)&&u.labelAngle<270)e&&f&&f.isLabelUpdated&&(o=!0);else if(e=!0,o&&(this.isIncreaseAngle=!1),this.isIncreaseAngle)for(i=r;i<t.length;i++)this.increaseAngle(t[i-1],t[i],n,!1);else for(i=r;i>0;i--)this.decreaseAngle(t[i],t[i-1],n,!1),t.filter(function(n,i){n.isLabelUpdated&&t[i].labelAngle-10<100&&(s.isIncreaseAngle=!0)})},t.prototype.decreaseAngle=function(n,t,i,r){var f,u;if(sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(t))return null;if(f=1,r)for(;p(n.labelRegion,t.labelRegion)||!this.isVariousRadius()&&!(t.labelRegion.height+t.labelRegion.y<n.labelRegion.y);){if((u=t.midAngle-f)<0&&(u=360+u),u<=270&&u>=90){u=270;this.isIncreaseAngle=!0;break}this.changeLabelAngle(t,u);f++}else for(n.labelAngle>270&&(this.changeLabelAngle(n,270),t.labelAngle=270);p(n.labelRegion,t.labelRegion)||!this.isVariousRadius()&&n.labelRegion.y+n.labelRegion.height>t.labelRegion.y;){if(!((u=t.midAngle-f)<=270&&u>=90)){u=90;this.isIncreaseAngle=!0;break}if(this.changeLabelAngle(t,u),p(n.labelRegion,t.labelRegion)&&!i.leftSidePoints.indexOf(t)&&u-1<90&&u-1>270){this.changeLabelAngle(n,n.labelAngle+1);this.arrangeLeftSidePoints(i);break}f++}},t.prototype.increaseAngle=function(n,t,i,r){var f,u;if(sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(t))return null;if(f=1,r)for(;p(n.labelRegion,t.labelRegion)||!this.isVariousRadius()&&!(n.labelRegion.y+n.labelRegion.height<t.labelRegion.y);){if((u=t.midAngle+f)<270&&u>90){u=90;this.isIncreaseAngle=!0;break}if(this.changeLabelAngle(t,u),p(n.labelRegion,t.labelRegion)&&u+1>90&&u+1<270&&this.rightSideRenderingPoints.indexOf(t)===this.rightSideRenderingPoints.length-1){this.changeLabelAngle(n,n.labelAngle-1);t.labelRegion=t.initialLabelRegion;this.arrangeRightSidePoints(i);break}f++}else for(;p(n.labelRegion,t.labelRegion)||!this.isVariousRadius()&&n.labelRegion.y<t.labelRegion.y+t.labelRegion.height;){if(!((u=t.midAngle+f)<270&&u>90)){u=270;this.isIncreaseAngle=!1;break}this.changeLabelAngle(t,u);f++}},t.prototype.changeLabelAngle=function(n,t){var i,r=this.accumulation.series[0].dataLabel,u,f;this.isVariousRadius()&&(i=this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],n));u="Outside"===n.labelPosition&&this.accumulation.enableSmartLabels&&"Inside"===r.position?this.radius+o(r.connectorStyle.length||"4%",this.accumulation.pieSeriesModule.size/2):this.isVariousRadius()?i:this.accumulation.pieSeriesModule.labelRadius+10;f=this.isVariousRadius()?i:u;this.getLabelRegion(n,"Outside",n.textSize,f,this.marginValue,t);n.isLabelUpdated=1;n.labelAngle=t},t.prototype.isOverlapWithPrevious=function(n,t,i){for(var r=0;r<i;r++)if(r!==t.indexOf(n)&&t[r].visible&&t[r].labelVisible&&t[r].labelRegion&&n.labelRegion&&n.labelVisible&&p(n.labelRegion,t[r].labelRegion))return!0;return!1},t.prototype.isOverlapWithNext=function(n,t,i){for(var r=i;r<t.length;r++)if(r!==t.indexOf(n)&&t[r].visible&&t[r].labelVisible&&t[r].labelRegion&&n.labelRegion&&n.labelVisible&&p(n.labelRegion,t[r].labelRegion))return!0;return!1},t.prototype.skipPoints=function(n,t,i){var u,r;if(i>0&&(n.midAngle<285&&n.midAngle>255||n.midAngle<105&&n.midAngle>75))u=t[i-1],r=n.endAngle%360-n.startAngle%360,(o=u.endAngle%360-u.startAngle%360)<=r&&r<5&&u.labelVisible&&this.setPointVisibleTrue(n);else if(i>1&&(n.midAngle<300&&n.midAngle>240||n.midAngle<120&&n.midAngle>60)){var f=t[i-1],e=t[i-2],o=(r=n.endAngle%360-n.startAngle%360,f.endAngle%360-f.startAngle%360),s=e.endAngle%360-e.startAngle%360;r<3&&o<3&&s<3&&f.labelVisible&&n.labelVisible&&this.setPointVisibleTrue(n)}},t.prototype.getPerpendicularDistance=function(n,t){var i=10+10*Math.sin(t.midAngle*Math.PI/360);return t.midAngle>270&&t.midAngle<360?new s(n.x+i*Math.cos((360-t.midAngle)*Math.PI/180),n.y-i*Math.sin((360-t.midAngle)*Math.PI/180)):t.midAngle>0&&t.midAngle<90?new s(n.x+i*Math.cos(t.midAngle*Math.PI/180),n.y+i*Math.sin(t.midAngle*Math.PI/180)):t.midAngle>0&&t.midAngle<90?new s(n.x-i*Math.cos((t.midAngle-90)*Math.PI/180),n.y+i*Math.sin((t.midAngle-90)*Math.PI/180)):new s(n.x-i*Math.cos((t.midAngle-180)*Math.PI/180),n.y-i*Math.sin((t.midAngle-180)*Math.PI/180))},t}(pt),ve=function(){function n(n){this.currentPoints=[];this.previousPoints=[];this.insideRegion=!1;this.chart=n;this.lierIndex=0}return n.prototype.getData=function(){for(var e,o,s,h,t,i,r=this.chart,u=null,n=null,f=r.visibleSeries.length-1;f>=0;f--)if((s="Scatter"===(n=r.visibleSeries[f]).type||"Scatter"===n.drawType||n.marker.visible?(n.marker.height+5)/2:0,h="Scatter"===n.type||"Scatter"===n.drawType||n.marker.visible?(n.marker.width+5)/2:0,t=r.mouseX,i=r.mouseY,n.dragSettings.enable&&n.isRectSeries)&&("Bar"===n.type&&r.isTransposed||!r.isTransposed&&"Bar"!==n.type?(e=n.marker.height/2,i=n.yAxis.isInversed?i-e:i+e):(o=n.marker.width/2,t=n.yAxis.isInversed?t+o:t-o)),n.visible&&tt(t,i,n.clipRect,s,h)&&(u=this.getRectPoint(n,n.clipRect,t,i)),u)return new hi(u,n);return new hi(u,n)},n.prototype.isSelected=function(n){return(n.selectionMode.indexOf("Drag")>-1||n.selectionMode.indexOf("Lasso")>-1)&&n.selectionModule&&null!==n.selectionModule.rectPoints},n.prototype.getRectPoint=function(n,t,i,r){var l,a,f,e,o,s,h=0,c,v,u;if(this.chart.isScrolling)return null;for(c=0,v=n.points;c<v.length;c++)if(u=v[c],u.regionData||u.regions&&u.regions.length){if(u.regionData&&"PolarRadar"===this.chart.chartAreaType&&n.drawType.indexOf("Column")>-1&&(l=i-(n.clipRect.width/2+n.clipRect.x),a=r-(n.clipRect.height/2+n.clipRect.y),h=2*Math.PI*(u.regionData.currentXPosition<0?1+u.regionData.currentXPosition:u.regionData.currentXPosition),f=(f=(Math.atan2(a,l)+.5*Math.PI-h)%(2*Math.PI))<0?2*Math.PI+f:f,f+=2*Math.PI*n.chart.primaryXAxis.startAngle,e=u.regionData.startAngle,e=(e-=h)<0?2*Math.PI+e:e,o=u.regionData.endAngle,o=(o-=h)<0?2*Math.PI+o:o,s=Math.sqrt(Math.pow(Math.abs(l),2)+Math.pow(Math.abs(a),2)),f>=e&&f<=o&&(s>=u.regionData.innerRadius&&s<=u.regionData.radius||s<=u.regionData.innerRadius&&s>=u.regionData.radius)&&s<=n.chart.radius))return u;if((n.dragSettings.enable&&n.isRectSeries||n.isRectSeries&&n.marker.visible)&&this.isPointInThresholdRegion(i,r,u,t,n))return this.insideRegion=!0,u;if(!this.insideRegion&&this.checkRegionContainsPoint(u.regions,t,i,r)||this.insideRegion&&this.checkRegionContainsPoint(u.regions,t,i,r))return u}return null},n.prototype.checkRegionContainsPoint=function(n,t,i,r){var u=this;return n.some(function(n,f){return u.lierIndex=f,tt(i,r,new sf.svgbase.Rect(("Cartesian"===u.chart.chartAreaType?t.x:0)+n.x,("Cartesian"===u.chart.chartAreaType?t.y:0)+n.y,n.width,n.height))})},n.prototype.isPointInThresholdRegion=function(n,t,i,r,u){var f,c=this,h="Bar"===u.type,l=u.yAxis.isInversed,a=u.chart.isTransposed,e=0,o=0,s=f=20;return l&&a?h?(e=i.regions[0].height-10,f=i.regions[0].width):(o=-10,s=i.regions[0].height):l||i.yValue<0?h?(o=-10,s=i.regions[0].height):(e=i.regions[0].height-10,f=i.regions[0].width):a?h?(e=-10,f=i.regions[0].width):(o=i.regions[0].width-10,s=i.regions[0].height):h?(o=i.regions[0].width-10,s=i.regions[0].height):(e=-10,f=i.regions[0].width),i.regions.some(function(i){return tt(n,t,new sf.svgbase.Rect(("Cartesian"===c.chart.chartAreaType?r.x:0)+i.x+o,("Cartesian"===c.chart.chartAreaType?r.y:0)+i.y+e,f,s))})},n.prototype.getClosest=function(n,t,i){var r,f,e=i||n.xData,u;if(t>=n.xMin-.5&&t<=n.xMax+.5)for(u=0;u<e.length;u++)f=e[u],(null==r||Math.abs(f-t)<Math.abs(r-t))&&(r=f);return-1!==n.xData.indexOf(r)?r:null},n.prototype.getClosestX=function(n,t,i){var e,r=t.clipRect,u;e=n.requireInvertedAxis?function(n,t,i){return(i.isInversed?n/t:1-n/t)*i.visibleRange.delta+i.visibleRange.min}(n.mouseY-r.y,r.height,t.xAxis):function(n,t,i){return(i.isInversed?1-n/t:n/t)*i.visibleRange.delta+i.visibleRange.min}(n.mouseX-r.x,r.width,t.xAxis);for(var s=this.getClosest(t,e,i),f=0,o=t.points;f<o.length;f++)if(u=o[f],s===u.xValue&&u.visible)return new hi(u,t);return null},n.prototype.mergeXvalues=function(n){for(var t=[],i=0;i<n.length;i++)t=t.concat(n[i].xData);return t.filter(function(n,i){return i===t.indexOf(n)})},n}(),ye=(gi=function(n,t){return(gi=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}gi(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),pe=function(n){function t(t){var i=n.call(this,t)||this;return i.element=i.chart.element,i.textStyle=t.tooltip.textStyle,i.control=t,i}return ye(t,n),t.prototype.getElement=function(n){return document.getElementById(n)},t.prototype.getTooltipElement=function(n){this.inverted=this.chart.requireInvertedAxis;this.header=null===this.control.tooltip.header?this.control.tooltip.shared?"<b>${point.x}<\/b>":"<b>${series.name}<\/b>":this.control.tooltip.header;this.formattedText=[];var t=document.getElementById(this.chart.element.id+"_tooltip"),i=this.chart.element.id.indexOf("stockChart")>-1;return!n&&!t||i?this.createElement():null},t.prototype.createElement=function(){var n=document.createElement("div");return n.id=this.element.id+"_tooltip",n.className="ejSVGTooltip",n.setAttribute("style","pointer-events:none; position:absolute;z-index: 1"),n},t.prototype.pushData=function(n,t,i){return!!n.series.enableTooltip&&(this.currentPoints.push(n),this.stopAnimation(),i&&!document.getElementById(i.id)&&(this.chart.stockChart?document.getElementById(this.chart.stockChart.element.id+"_Secondary_Element").appendChild(i):document.getElementById(this.element.id+"_Secondary_Element").appendChild(i)),!0)},t.prototype.removeHighlight=function(){for(var n,t=0,i=this.previousPoints.length;t<i;t++)(n=this.previousPoints[t]).series.isRectSeries?n.series.visible&&this.highlightPoint(n.series,n.point.index,!1):n.series.marker.visible||"Scatter"===n.series.type||"Bubble"===n.series.type||(this.previousPoints.shift(),i-=1)},t.prototype.highlightPoint=function(n,t,i){var r=this.getElement(this.element.id+"_Series_"+n.index+"_Point_"+t),u=this.control.accumulationSelectionModule,f=!!(u&&u.selectedDataIndexes.length>0);r&&(!f||f&&r.getAttribute("class")&&-1===r.getAttribute("class").indexOf("_ej2_chart_selection_series_")?r.setAttribute("opacity",(i?n.opacity/2:n.opacity).toString()):r.setAttribute("opacity",n.opacity.toString()))},t.prototype.highlightPoints=function(){for(var n,t=0,i=this.currentPoints;t<i.length;t++)n=i[t],n.series.isRectSeries&&"Series"===n.series.category&&this.highlightPoint(n.series,n.point.index,!0)},t.prototype.createTooltip=function(n,t,i,r,u,f,e,o,h,c,l){var b,y,a,nt,tt;if(void 0===h&&(h=null),void 0===c&&(c=null),b=this.currentPoints[0].series,y=n.tooltipModule||n.accumulationTooltipModule,y){var k=b.isRectSeries&&"Waterfall"!==b.type&&u&&u.y<0,d=this.chart.requireInvertedAxis&&b.isRectSeries,v=null;if(this.text.length<=1){var p=void 0,w=void 0,g=l||n.tooltip.template;g&&"chart"===n.getModuleName()&&"#"!==g[0]&&"string"==typeof g?(a=document.createElement("div"),a.id="testing_template",a.className="ejSVGTooltip",a.setAttribute("style","pointer-events:none; position:absolute;z-index: 1"),document.getElementById(this.chart.element.id+"_Secondary_Element").appendChild(a),nt=g.replaceAll("${x}",u.x).replaceAll("${y}",u.y),a.innerHTML=nt,p=new sf.svgbase.Size(a.firstElementChild.offsetWidth,a.firstElementChild.offsetHeight),w=new sf.svgbase.Size(0,0),a.remove()):(p=sf.svgbase.measureText(this.text[0],n.tooltip.textStyle),w=""!==this.header&&"<b><\/b>"!==this.header?sf.svgbase.measureText(this.header,this.textStyle):new sf.svgbase.Size(0,0));p.width=Math.max(p.width,w.width)+(f.length>0?47:0);tt=32+(w.height>0?20:0);p.height=p.height+w.height+tt;v=this.getCurrentPosition(k,d);k="Left"===(v=this.getPositionBySize(p,new sf.svgbase.Rect(0,0,o.width,o.height),i,v))||"Bottom"===v;d="Left"===v||"Right"===v}t?this.svgTooltip=new sf.svgbase.Tooltip({opacity:n.tooltip.opacity,header:this.headerText,content:this.text,fill:n.tooltip.fill,border:n.tooltip.border,enableAnimation:n.tooltip.enableAnimation,location:i,shared:n.tooltip.shared,shapes:f,clipBounds:"PolarRadar"===this.chart.chartAreaType?new s(0,0):r,areaBounds:o,palette:this.findPalette(),template:l||n.tooltip.template,data:c,theme:n.theme,offset:e,textStyle:n.tooltip.textStyle,isNegative:k,inverted:d,arrowPadding:this.text.length>1||this.chart.stockChart?0:12,availableSize:n.availableSize,duration:this.chart.tooltip.duration,isCanvas:this.chart.enableCanvas,isTextWrap:n.tooltip.enableTextWrap&&"chart"===n.getModuleName(),blazorTemplate:{name:"Template",parent:this.chart.tooltip},controlInstance:this.chart,tooltipPlacement:v,tooltipRender:function(){y.removeHighlight();y.highlightPoints();y.updatePreviousPoint(h)},animationComplete:function(n){n.tooltip.fadeOuted&&y.fadeOut(y.previousPoints)}},"#"+this.element.id+"_tooltip"):this.svgTooltip&&(this.svgTooltip.location=i,this.svgTooltip.content=this.text,this.svgTooltip.header=this.headerText,this.svgTooltip.offset=e,this.svgTooltip.palette=this.findPalette(),this.svgTooltip.shapes=f,this.svgTooltip.data=c,this.svgTooltip.template=n.tooltip.template,this.svgTooltip.textStyle=n.tooltip.textStyle,this.svgTooltip.isNegative=k,this.svgTooltip.inverted=d,this.svgTooltip.clipBounds="PolarRadar"===this.chart.chartAreaType?new s(0,0):r,this.svgTooltip.arrowPadding=this.text.length>1||this.chart.stockChart?0:12,this.svgTooltip.tooltipPlacement=v,this.svgTooltip.dataBind());this.chart.isReact&&this.chart.renderReactTemplates()}},t.prototype.getPositionBySize=function(n,t,i,r){var u=this.isTooltipFitPosition("Top",new sf.svgbase.Rect(0,0,t.width,t.height),i,n),o=this.isTooltipFitPosition("Bottom",new sf.svgbase.Rect(0,0,t.width,t.height),i,n),f=this.isTooltipFitPosition("Right",new sf.svgbase.Rect(0,0,t.width,t.height),i,n),s=this.isTooltipFitPosition("Left",new sf.svgbase.Rect(0,0,t.width,t.height),i,n),h,e;return(u||o||f||s)?"Top"===r?u?"Top":o?"Bottom":f?"Right":"Left":"Bottom"===r?o?"Bottom":u?"Top":f?"Right":"Left":"Right"===r?f?"Right":s?"Left":u?"Top":"Bottom":s?"Left":f?"Right":u?"Top":"Bottom":(h=[i.x-t.x,t.x+t.width-i.x,i.y-t.y,t.y+t.height-i.y],e=h.indexOf(Math.max.apply(this,h)),0===e?"Left":1===e?"Right":2===e?"Top":"Bottom")},t.prototype.isTooltipFitPosition=function(n,t,i,r){var u=new s(0,0),f=new s(0,0);switch(n){case"Top":u.x=i.x-r.width/2;u.y=i.y-r.height;f.x=i.x+r.width/2;f.y=i.y;break;case"Bottom":u.x=i.x-r.width/2;u.y=i.y;f.x=i.x+r.width/2;f.y=i.y+r.height;break;case"Right":u.x=i.x;u.y=i.y-r.height/2;f.x=i.x+r.width;f.y=i.y+r.height/2;break;case"Left":u.x=i.x-r.width;u.y=i.y-r.height/2;f.x=i.x;f.y=i.y+r.height/2}return tt(u.x,u.y,t)&&tt(f.x,f.y,t)},t.prototype.getCurrentPosition=function(n,t){return t?n?"Left":"Right":n?"Bottom":"Top"},t.prototype.findPalette=function(){for(var t,i=[],n=0,r=this.currentPoints;n<r.length;n++)t=r[n],i.push(this.findColor(t,t.series));return i},t.prototype.findColor=function(n,t){return!t.isRectSeries||"Candle"!==t.type&&"Hilo"!==t.type&&"HiloOpenClose"!==t.type?(n.point.color&&"#ffffff"!==n.point.color?n.point.color:n.point.interior)||t.marker.fill||t.interior:n.point.color},t.prototype.updatePreviousPoint=function(n){n&&(this.currentPoints=this.currentPoints.concat(n));this.previousPoints=sf.base.extend([],this.currentPoints,null,!0)},t.prototype.fadeOut=function(n){var t=this.chart.enableCanvas?this.getElement(this.element.id+"_tooltip_group"):this.getElement(this.element.id+"_tooltip_svg");t&&parseInt(t.getAttribute("opacity"),10)>0||(this.valueX=null,this.valueY=null,this.currentPoints=[],this.removeHighlight(),this.removeHighlightedMarker(n),this.svgTooltip=null,this.control.trigger("animationComplete",{}))},t.prototype.removeHighlightedMarker=function(n){var t,i,r;if(this.chart.markerRender){for(t=0,i=n;t<i.length;t++)r=i[t],l(this.element.id+"_Series_"+r.series.index+"_Point_"+r.point.index+"_Trackball");this.chart.markerRender.removeHighlightedMarker()}this.previousPoints=[]},t.prototype.removeText=function(){this.textElements=[];var n=this.getElement(this.element.id+"_tooltip_group");if(n&&n.childNodes.length>0)for(;n.lastChild&&1!==n.childNodes.length;)n.removeChild(n.lastChild)},t.prototype.stopAnimation=function(){var n;n=this.toolTipInterval;window.clearInterval(n)},t.prototype.removeTooltip=function(n){var r=this,t=this.getElement(this.element.id+"_tooltip"),i=t?this.getElement(t.id+"parent_template"):null,u=i&&"<div><\/div>"!==i.innerHTML;this.stopAnimation();this.chart.isReact&&u&&this.chart.clearTemplate([i.id],[0]);t&&this.previousPoints.length>0&&(this.toolTipInterval=+setTimeout(function(){r.svgTooltip&&r.svgTooltip.fadeOut()},n))},t}(ve),we=(nr=function(n,t){return(nr=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}nr(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),hu=function(n){function t(t){var i=n.call(this,t)||this;return i.accumulation=t,i.addEventListener(),i}return we(t,n),t.prototype.addEventListener=function(){this.accumulation.isDestroyed||(this.accumulation.on(sf.base.Browser.isPointer?"pointerleave":"mouseleave",this.mouseLeaveHandler,this),this.accumulation.on(sf.base.Browser.touchMoveEvent,this.mouseMoveHandler,this),this.accumulation.on(sf.base.Browser.touchEndEvent,this.mouseUpHandler,this))},t.prototype.mouseLeaveHandler=function(){this.removeTooltip(this.accumulation.tooltip.fadeOutDuration)},t.prototype.mouseUpHandler=function(n){var t=this.accumulation;t.tooltip.enable&&t.isTouch&&tt(t.mouseX,t.mouseY,t.initialClipRect)&&(this.tooltip(n),this.removeTooltip(2e3))},t.prototype.mouseMoveHandler=function(n){var t=this.accumulation;t.tooltip.enable&&tt(t.mouseX,t.mouseY,t.initialClipRect)&&this.tooltip(n)},t.prototype.tooltip=function(n){var t=this.getElement(this.element.id+"_tooltip_svg"),i=t&&parseInt(t.getAttribute("opacity"),10)>0,r=this.getTooltipElement(i);this.renderSeriesTooltip(n,this.accumulation,!i,r)},t.prototype.renderSeriesTooltip=function(n,t,i,r){var u=this.getPieData(n,t,t.mouseX,t.mouseY);if(t.initialClipRect,this.currentPoints=[],!u.point||this.previousPoints[0]&&this.previousPoints[0].point===u.point)!u.point&&this.isRemove&&(this.removeTooltip(this.accumulation.tooltip.fadeOutDuration),this.isRemove=!1);else{if(this.previousPoints[0]&&u.point.index===this.previousPoints[0].point.index&&u.series.index===this.previousPoints[0].series.index)return null;this.pushData(u,i,r,!1)&&this.triggerTooltipRender(u,i,this.getTooltipText(u,t.tooltip),this.findHeader(u))}},t.prototype.triggerTooltipRender=function(n,t,i,r,u){var f=this,o,e;void 0===u&&(u=!0);o={cancel:!1,name:"tooltipRender",text:i,point:n.point,textStyle:this.textStyle,series:this.accumulation.isBlazor?{}:n.series,headerText:r,data:{pointX:n.point.x,pointY:n.point.y,seriesIndex:n.series.index,pointIndex:n.point.index,pointText:n.point.text,seriesName:n.series.name}};e=function(i){i.cancel?(f.removeHighlight(),sf.base.remove(f.getElement(f.element.id+"_tooltip"))):(f.formattedText=f.formattedText.concat(i.text),f.text=f.formattedText,f.headerText=i.headerText,f.createTooltip(f.chart,t,n.point.symbolLocation,n.series.clipRect,n.point,["Circle"],0,f.chart.initialClipRect,null,n.point,f.accumulation.tooltip.template?i.template:""));f.isRemove=!0};e.bind(this,n);this.chart.trigger("tooltipRender",o,e)},t.prototype.getPieData=function(n,t){var f=ot(n.target.id,!0),i,r,u;return!isNaN(f.series)&&(i=f.series,r=f.point,!(sf.base.isNullOrUndefined(i)||isNaN(i)||sf.base.isNullOrUndefined(r)||isNaN(r))&&(u=this.getSeriesFromIndex(i,t.visibleSeries),u.enableTooltip))?new br(u.points[r],u):new br(null,null)},t.prototype.getSeriesFromIndex=function(n,t){return t[0]},t.prototype.getTooltipText=function(n,t){var r=n.series,i=this.accumulation.useGroupingSeparator?"${point.x} : <b>${point.separatorY}<\/b>":"${point.x} : <b>${point.y}<\/b>";return i=t.format?t.format:i,this.parseTemplate(n.point,r,i)},t.prototype.findHeader=function(n){return""===this.header?"":(this.header=this.parseTemplate(n.point,n.series,this.header),""!==this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()?this.header:"")},t.prototype.parseTemplate=function(n,t,i){for(var u,h,r,e,s,f=0,o=Object.keys(n);f<o.length;f++)r=o[f],u=new RegExp("${point."+r+"}","gm"),i=i.replace(u.source,n[r]);for(e=0,s=Object.keys(Object.getPrototypeOf(t));e<s.length;e++)r=s[e],u=new RegExp("${series."+r+"}","gm"),h=t[r],i=i.replace(u.source,h);return i},t.prototype.getModuleName=function(){return"AccumulationTooltip"},t.prototype.destroy=function(){},t}(pe),be=function(){function n(n){this.control=n}return n.prototype.seriesStyles=function(){var l,u,r=document.getElementById(this.styleId),i="{}",f=this.control.selectionPattern,e=this.control.highlightPattern,o,h,t,n,c,s;if(sf.base.isNullOrUndefined(r)||"None"!==f||"None"!==e){for((r=document.createElement("style")).setAttribute("id",this.styleId),o=0,h=this.control.visibleSeries;o<h.length;o++){if(t=h[o],n=this.control.visibleSeries[t.index]||this.control.visibleSeries[t.index],!(sf.base.isNullOrUndefined(f)&&sf.base.isNullOrUndefined(e)||"None"===f&&"None"===e))if(c=this.styleId.indexOf("highlight")>0?e:f,"Pie"===n.type||"Funnel"===n.type||"Pyramid"===n.type)for(s=0;s<n.points.length;s++)u=n.opacity,i="{ fill:"+this.pattern(this.control,n.points[s].color,t.index,c,u)+"}";else n.type&&(u=n.opacity,i="{ fill:"+this.pattern(this.control,n.interior,t.index,c,u)+"}");l=t.selectionStyle||this.styleId+"_series_"+t.index+",."+this.styleId+"_series_"+t.index+"> *";i=i.indexOf("None")>-1?"{}":i;r.innerHTML+=t.selectionStyle?"":"."+l+i}r.innerHTML+="."+this.unselected+" { opacity:0.3;} ";document.body.appendChild(r)}},n.prototype.pattern=function(n,t,i,r,u){var h=n.svgObject,f=[],e={id:n.element.id+"_"+r+"_Selection_"+i,patternUnits:"userSpaceOnUse"},o,s;switch(r){case"Dots":e.height=e.width=6;e.width=6;f[0]={x:0,y:0,width:7,height:7,transform:"translate(0,0)",fill:"#ffffff",opacity:u,name:"rect"};f[1]={cx:3,cy:3,r:2,"stroke-width":1,fill:t,name:"circle"};break;case"Pacman":e.height="18.384";e.width="17.917";f[0]={name:"rect",x:0,y:0,width:17.917,height:18.384,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M9.081,9.194l5.806-3.08c-0.812-1.496-2.403-3.052-4.291-3.052H8.835C6.138,3.063,3,6.151,3,8.723v1.679   c0,2.572,3.138,5.661,5.835,5.661h1.761c2.085,0,3.835-1.76,4.535-3.514L9.081,9.194z","stroke-width":1,stroke:t,fill:t};break;case"Chessboard":e.height=e.width=10;f[0]={x:0,y:0,width:10,height:10,fill:"#ffffff",opacity:u,name:"rect"};f[1]={x:0,y:0,width:5,height:5,fill:t,opacity:u,name:"rect"};f[2]={x:5,y:5,width:5,height:5,fill:t,opacity:u,name:"rect"};break;case"Crosshatch":e.height=e.width="8";f[0]={x:0,y:0,width:8,height:8,transform:"translate(0,0)",fill:"#ffffff",opacity:u,name:"rect"};f[1]={d:"M0 0L8 8ZM8 0L0 8Z","stroke-width":1,stroke:t,name:"path"};break;case"DiagonalForward":e.height=e.width=6;f[0]={x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:"#ffffff",opacity:u,name:"rect"};f[1]={d:"M 3 -3 L 9 3 M 6 6 L 0 0 M 3 9 L -3 3","stroke-width":2,stroke:t,name:"path"};break;case"DiagonalBackward":e.height=e.width=6;f[0]={x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:"#ffffff",opacity:u,name:"rect"};f[1]={d:"M 3 -3 L -3 3 M 0 6 L 6 0 M 9 3 L 3 9","stroke-width":2,stroke:t,name:"path"};break;case"Grid":e.height=e.width=6;f[0]={name:"rect",x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M1 3.5L11 3.5 M0 3.5L11 3.5 M0 7.5L11 7.5 M0 11.5L11 11.5 M5.5 0L5.5 12 M11.5 0L11.5 12Z","stroke-width":1,stroke:t};break;case"Turquoise":e.height=e.width=17;f[0]={name:"rect",x:0,y:0,width:17,height:17,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M0.5739999999999998,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};f[2]={name:"path",d:"M11.805,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};f[3]={name:"path",d:"M6.19,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};f[4]={name:"path",d:"M11.805,8.217a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};f[5]={name:"path",d:"M6.19,8.217a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};f[6]={name:"path",d:"M11.805,13.899a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};f[7]={name:"path",d:"M6.19,13.899a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};break;case"Star":e.height=e.width=21;f[0]={name:"rect",x:0,y:0,width:21,height:21,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M15.913,18.59L10.762 12.842 5.613 18.75 8.291 11.422 0.325 9.91 8.154 8.33 5.337 0.91 10.488 6.658 15.637 0.75 12.959 8.078 20.925 9.59 13.096 11.17 z","stroke-width":1,stroke:t,fill:t};break;case"Triangle":e.height=e.width=10;f[0]={name:"rect",x:0,y:0,width:10,height:10,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M4.987,0L7.48 4.847 9.974 9.694 4.987 9.694 0 9.694 2.493 4.847 z","stroke-width":1,stroke:t,fill:t};break;case"Circle":e.height=e.width=9;f[0]={name:"rect",x:0,y:0,width:9,height:9,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"circle",cx:5.125,cy:3.875,r:3.625,"stroke-width":1,fill:t};break;case"Tile":e.height=e.width=18;f[0]={name:"rect",x:0,y:0,width:18,height:18,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M0,9L0 0 9 0 z","stroke-width":1,stroke:t,fill:t};f[2]={name:"path",d:"M9,9L9 0 18 0 z","stroke-width":1,stroke:t,fill:t};f[3]={name:"path",d:"M0,18L0 9 9 9 z","stroke-width":1,stroke:t,fill:t};f[4]={name:"path",d:"M9,18L9 9 18 9 z","stroke-width":1,stroke:t,fill:t};break;case"HorizontalDash":e.height=e.width=12;f[0]={name:"rect",x:0,y:0,width:12,height:12,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M0,1.5 L10 1.5 M0,5.5 L10 5.5 M0,9.5 L10 9.5 z","stroke-width":1,stroke:t,fill:t};break;case"VerticalDash":e.height=e.width=12;f[0]={name:"rect",x:0,y:0,width:12,height:12,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M1.5,0 L1.5 10 M5.5,0 L5.5 10 M9.5,0 L9.5 10 z","stroke-width":1,stroke:t,fill:t};break;case"Rectangle":e.height=e.width=12;f[0]={name:"rect",width:12,height:12,fill:"#ffffff",opacity:u};f[1]={name:"rect",x:1,y:2,width:4,height:9,fill:t,opacity:u};f[2]={name:"rect",x:7,y:2,width:4,height:9,fill:t,opacity:u};break;case"Box":e.height=e.width=10;f[0]={name:"rect",width:13,height:13,fill:"#ffffff",opacity:u};f[1]={name:"rect",x:1.5,y:1.5,width:10,height:9,fill:t,opacity:u};break;case"HorizontalStripe":e.height=12;e.width=10;f[0]={name:"rect",x:0,y:0,width:10,height:12,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M0,0.5 L10 0.5 M0,4.5 L10 4.5 M0,8.5 L10 8.5 z","stroke-width":1,stroke:t,fill:t};break;case"VerticalStripe":e.height=10;e.width=12;f[0]={name:"rect",x:0,y:0,width:12,height:10,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M0.5,0 L0.5 10 M4.5,0 L4.5 10 M8.5,0 L8.5 10 z","stroke-width":1,stroke:t,fill:t};break;case"Bubble":e.height=e.width=20;f[0]={name:"rect",x:0,y:0,width:20,height:20,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"circle",cx:5.217,cy:11.325,r:3.429,"stroke-width":1,fill:"#D0A6D1"};f[2]={name:"circle",cx:13.328,cy:6.24,r:4.884,"stroke-width":1,fill:t};f[3]={name:"circle",cx:13.277,cy:14.66,r:3.018,"stroke-width":1,fill:"#D0A6D1"}}return o=n.svgRenderer||n.renderer,s=o.createPattern(e,"pattern"),this.loadPattern(n,f,s,o),h.appendChild(s),"url(#"+n.element.id+"_"+r+"_Selection_"+i+")"},n.prototype.loadPattern=function(n,t,i,r){for(var f,u=0;u<t.length;u++)f=r.createPattern(t[u],t[u].name),i.appendChild(f)},n.prototype.concatIndexes=function(n,t){return n.concat(t)},n.prototype.checkVisibility=function(n){var t,i,f;if(!n)return!1;for(var e=!1,r=[],u=0,o=n;u<o.length;u++)t=o[u],-1===r.indexOf(t.series)&&r.push(t.series);for(i=0,f=r;i<f.length;i++)if(t=f[i],this.control.series[t].visible){e=!0;break}return e},n.prototype.addSvgClass=function(n,t){var i=n.getAttribute("class")||"";-1===(i+=""!==i?" ":"").indexOf(t)&&n.setAttribute("class",i+t)},n.prototype.removeSvgClass=function(n,t){var i=n.getAttribute("class")||"";i.indexOf(t)>-1&&n.setAttribute("class",i.replace(t,""))},n.prototype.getChildren=function(n){for(var i=[],t=0;t<n.childNodes.length;t++)"defs"!==n.childNodes[t].tagName&&i.push(n.childNodes[t]);return i},n}(),ke=(tr=function(n,t){return(tr=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}tr(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),cu=function(n){function t(t){var i=n.call(this,t)||this;return i.renderer=t.renderer,i}return ke(t,n),t.prototype.initPrivateVariables=function(n){this.styleId=n.element.id+"_ej2_chart_selection";this.unselected=n.element.id+"_ej2_deselected";this.selectedDataIndexes=[];this.rectPoints=null},t.prototype.invokeSelection=function(n){this.initPrivateVariables(n);this.series=sf.base.extend({},n.visibleSeries,null,!0);this.seriesStyles();this.selectDataIndex(this.concatIndexes(n.selectedDataIndexes,this.selectedDataIndexes),n)},t.prototype.generateStyle=function(n){return n.selectionStyle||this.styleId+"_series_"+n.index},t.prototype.findElements=function(n,t,i){return[this.getElementByIndex(i)]},t.prototype.getElementByIndex=function(n){var t=this.control.element.id+"_Series_"+n.series+"_Point_"+n.point;return document.getElementById(t)},t.prototype.calculateSelectedElements=function(n,t){-1!==t.target.id.indexOf(n.element.id+"_")&&(t.target.id.indexOf("_Series_")>-1||t.target.id.indexOf("_datalabel_")>-1)&&this.performSelection(ot(t.target.id),n,t.target)},t.prototype.performSelection=function(n,t,i){switch(i=i.id.indexOf("datalabel")>-1?t.getSeriesElement().childNodes[n.series].childNodes[n.point]:i,t.selectionMode){case"Point":isNaN(n.point)||(this.selection(t,n,[i]),this.blurEffect(t.element.id,t.visibleSeries))}},t.prototype.selection=function(n,t,i){var u,r;n.isMultiSelect||this.removeMultiSelectEelments(n,this.selectedDataIndexes,t,n.series);u=i[0]&&(i[0].getAttribute("class")||"");i[0]&&u.indexOf(this.getSelectionClass(i[0].id))>-1?(this.removeStyles(i,t),this.addOrRemoveIndex(this.selectedDataIndexes,t),n.enableBorderOnMouseMove)&&(r=document.getElementById(i[0].id.split("_")[0]+"PointHover_Border"),sf.base.isNullOrUndefined(r)||this.removeSvgClass(r,r.getAttribute("class"))):((this.applyStyles(i,t),n.enableBorderOnMouseMove)&&(r=document.getElementById(i[0].id.split("_")[0]+"PointHover_Border"),sf.base.isNullOrUndefined(r)||this.addSvgClass(r,i[0].getAttribute("class"))),this.addOrRemoveIndex(this.selectedDataIndexes,t,!0))},t.prototype.redrawSelection=function(n){var t=sf.base.extend([],this.selectedDataIndexes,null,!0);this.removeSelectedElements(n,this.selectedDataIndexes);this.blurEffect(n.element.id,n.visibleSeries);this.selectDataIndex(t,n)},t.prototype.removeSelectedElements=function(n,t){for(var u,i=0,r=t;i<r.length;i++)u=r[i],this.removeStyles([this.getElementByIndex(u)],u)},t.prototype.legendSelection=function(n,t,i){var r=n.getSeriesElement().childNodes[t].childNodes[i];this.selection(n,new er(t,i),[r]);this.blurEffect(n.element.id,n.visibleSeries)},t.prototype.selectDataIndex=function(n,t){for(var f,u,i=0,r=n;i<r.length;i++)u=r[i],(f=this.getElementByIndex(u))&&this.performSelection(u,t,f)},t.prototype.removeMultiSelectEelments=function(n,t,i,r){for(var f,u=0;u<t.length;u++)f=r[t[u].series],this.checkEquals(t[u],i)||(this.removeStyles(this.findElements(n,f,t[u]),t[u]),t.splice(u,1),u--)},t.prototype.blurEffect=function(n,t){for(var r,f=this.checkPointVisibility(this.selectedDataIndexes),i=0,u=t;i<u.length;i++)r=u[i],r.visible&&this.checkSelectionElements(document.getElementById(n+"_SeriesCollection"),this.generateStyle(r),f)},t.prototype.checkSelectionElements=function(n,t,i){for(var f,e,o,u=n.childNodes[0].childNodes,r=0;r<u.length;r++)e=u[r].getAttribute("class")||"",o=u[r].parentNode.getAttribute("class")||"",-1===e.indexOf(t)&&-1===o.indexOf(t)&&i?this.addSvgClass(u[r],this.unselected):this.removeSvgClass(u[r],this.unselected),this.control.accumulationLegendModule&&this.control.legendSettings.visible&&(f=document.getElementById(this.control.element.id+"_chart_legend_shape_"+r))&&(-1===e.indexOf(t)&&-1===o.indexOf(t)&&i?this.addSvgClass(f,this.unselected):this.removeSvgClass(f,this.unselected))},t.prototype.applyStyles=function(n,t){for(var i,r,o,u=this.control.accumulationTooltipModule,f=0,e=n;f<e.length;f++)i=e[f],r=void 0,i&&(this.control.accumulationLegendModule&&this.control.legendSettings.visible&&(r=document.getElementById(this.control.element.id+"_chart_legend_shape_"+t.point),this.removeSvgClass(r,this.unselected),this.addSvgClass(r,this.getSelectionClass(r.id))),this.removeSvgClass(i.parentNode,this.unselected),this.removeSvgClass(i,this.unselected),o=u&&u.previousPoints.length>0&&u.previousPoints[0].point.index!==t.point?u.svgTooltip.opacity:this.series[t.series].opacity,i.setAttribute("opacity",o.toString()),this.addSvgClass(i,this.getSelectionClass(i.id)))},t.prototype.getSelectionClass=function(n){return this.generateStyle(this.control.series[ot(n).series])},t.prototype.removeStyles=function(n,t){for(var i,o,u,r=this.control.accumulationTooltipModule,f=0,e=n;f<e.length;f++)i=e[f],i&&(this.control.accumulationLegendModule&&this.control.legendSettings.visible&&(u=document.getElementById(this.control.element.id+"_chart_legend_shape_"+t.point),this.removeSvgClass(u,this.getSelectionClass(u.id))),o=r&&r.previousPoints.length>0&&r.previousPoints[0].point.index===t.point?r.svgTooltip.opacity:this.series[t.series].opacity,i.setAttribute("opacity",o.toString()),this.removeSvgClass(i,this.getSelectionClass(i.id)))},t.prototype.addOrRemoveIndex=function(n,t,i){for(var r=0;r<n.length;r++)this.checkEquals(n[r],t)&&(n.splice(r,1),r--);i&&n.push(t)},t.prototype.checkEquals=function(n,t){return n.point===t.point&&n.series===t.series},t.prototype.checkPointVisibility=function(n){for(var i=!1,t=0,r=n;t<r.length;t++)if(yt(r[t].point,this.control.visibleSeries[0].points).visible){i=!0;break}return i},t.prototype.getModuleName=function(){return"AccumulationSelection"},t.prototype.destroy=function(){},t}(be),de=function(){function t(n){this.control=n}return t.prototype.render=function(n,t){return this.isChart="chart"===this.control.getModuleName(),this.annotation=n,ar(sf.base.createElement("div",{id:this.control.element.id+"_Annotation_"+t,styles:"position: absolute; z-index: 1"}),t,n.content,this.control)},t.prototype.setAnnotationPixelValue=function(n){var t="Chart"===this.annotation.region?new sf.svgbase.Rect(0,0,this.control.availableSize.width,this.control.availableSize.height):this.isChart?this.control.chartAxisLayoutPanel.seriesClipRect:this.control.series[0].accumulationBound;return n.x=("string"!=typeof this.annotation.x?"number"==typeof this.annotation.x?this.annotation.x:0:o(this.annotation.x,t.width))+t.x,n.y=("number"==typeof this.annotation.y?this.annotation.y:o(this.annotation.y,t.height))+t.y,!0},t.prototype.setAnnotationPointValue=function(t){var c=new s(0,0),f,v,y;if(this.isChart){for(var o=this.control,r=this.annotation,p=r.xAxisName,w=r.yAxisName,l=o.requireInvertedAxis,h=this.control.stockChart,i=void 0,u=void 0,e=void 0,a=0,b=o.axisCollections;a<b.length;a++)if(f=b[a],p===f.name||null==p&&"primaryXAxis"===f.name)if((i=f).valueType.indexOf("Category")>-1){if(v="DateTimeCategory"===i.valueType?r.x.getTime().toString():r.x,i.labels.indexOf(v)<0)return!1;e=i.labels.indexOf(v)}else"DateTime"===i.valueType?(y={skeleton:"full",type:"dateTime"},e="object"===n(this.annotation.x)||"object"===n(new Date(this.annotation.x))?Date.parse(o.intl.getDateParser(y)(o.intl.getDateFormat(y)(new Date(sf.data.DataUtil.parse.parseJson({val:r.x}).val)))):0):e=+r.x;else(w===f.name||null==w&&"primaryYAxis"===f.name)&&(u=f);return!!(i&&u&&ti("Logarithmic"===i.valueType?ht(e,i.logBase):e,i.visibleRange)&&ti("Logarithmic"===u.valueType?ht(+r.y,u.logBase):+r.y,u.visibleRange))&&(c=function(n,t,i,r,u){n="Logarithmic"===i.valueType?ht(n>0?n:Math.pow(i.logBase,i.visibleRange.min),i.logBase):n;t="Logarithmic"===r.valueType?ht(t>0?t:Math.pow(r.logBase,r.visibleRange.min),r.logBase):t;n=et(n,i);t=et(t,r);var f=u?i.rect.height:i.rect.width,e=u?r.rect.width:r.rect.height;return new s(u?t*e:n*f,u?(1-n)*f:(1-t)*e)}(e,+r.y,i,u,l),t.x=c.x+(l?u.rect.x:i.rect.x),t.y=c.y+(l?i.rect.y:u.rect.y)+(h&&h.enablePeriodSelector?h.toolbarHeight+h.titleSize.height:0),!0)}return this.setAccumulationPointValue(t)},t.prototype.processAnnotation=function(n,t,i){var f=this.control,r=new s(0,0),u=this.render(n,t),e=function(){u.style.transform="translate(-50%, -50%)"};e.bind(r,this);this["setAnnotation"+n.coordinateUnits+"Value"](r)?this.setElementStyle(r,u,i):this.control.redraw&&l(u.id);sf.base.updateBlazorTemplate((this.control.element.id+"Annotation"+t).replace(/[^a-zA-Z0-9]/g,""),"ContentTemplate",f.stockChart?f.stockChart.annotations[t]:this.control.annotations[t],void 0,e)},t.prototype.setAccumulationPointValue=function(t){for(var r,i,u=0,f=this.control.visibleSeries[0].points;u<f.length;u++)if(i=f[u],"object"===n(i.x)){if(Date.parse(i.x)===Date.parse(this.annotation.x)&&i.y===this.annotation.y){r=i;break}}else if(i.x==this.annotation.x&&i.y==this.annotation.y){r=i;break}return!(!r||!r.visible)&&(t.x=r.symbolLocation.x,t.y=r.symbolLocation.y,!0)},t.prototype.setElementStyle=function(n,t,i){var u=vr(t,this.control.redraw),r={cancel:!1,name:"annotationRender",content:t,location:n};this.control.trigger("annotationRender",r);r.cancel||(r.content.style.left=this.setAlignmentValue(this.annotation.horizontalAlignment,u.width,r.location.x)+"px",r.content.style.top=this.setAlignmentValue(this.annotation.verticalAlignment,u.height,r.location.y)+"px",r.content.setAttribute("aria-label",this.annotation.description||"Annotation"),yr(r.content,i,this.control.redraw,!0,"left","top"))},t.prototype.setAlignmentValue=function(n,t,i){switch(n){case"Top":case"Near":i-=t;break;case"Bottom":case"Far":i+=0;break;case"Middle":case"Center":i-=t/2}return i},t}(),ge=(ir=function(n,t){return(ir=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ir(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),lu=function(n){function t(t){var i=n.call(this,t)||this;return i.pie=t,i}return ge(t,n),t.prototype.renderAnnotations=function(n){var i=this,t;this.annotations=this.pie.annotations;t=this.pie.redraw;this.parentElement=pr(t,this.pie.element.id+"_Annotation_Collections")||sf.base.createElement("div",{id:this.pie.element.id+"_Annotation_Collections"});this.annotations.map(function(n,t){i.processAnnotation(n,t,i.parentElement)});yr(this.parentElement,n,t)},t.prototype.getModuleName=function(){return"Annotation"},t.prototype.destroy=function(){},t}(de),au=function(){function n(n){this.chart=n}return n.prototype.export=function(n,t,i,r,u,f,e,o,s){var c=new ur(this.chart),h;r=r||[this.chart];h={cancel:!1,name:"beforeExport",width:u,height:f};this.chart.trigger("beforeExport",h);h.cancel||c.export(n,t,i,r,u=h.width,f=h.height,e,o,s)},n.prototype.getDataUrl=function(n){return new ur(n).getDataUrl(n)},n.prototype.getModuleName=function(){return"Export"},n.prototype.destroy=function(){},n}();return ru.Inject(rr,fu,eu,hu,ou,cu,su,lu,au),t.AccumulationChart=ru,t.AccumulationAnnotationSettings=kr,t.AccumulationDataLabelSettings=dr,t.PieCenter=gr,t.AccPoints=ci,t.AccumulationSeries=nu,t.getSeriesFromIndex=tu,t.pointByIndex=yt,t.PieSeries=rr,t.FunnelSeries=fu,t.PyramidSeries=eu,t.AccumulationLegend=ou,t.AccumulationDataLabel=su,t.AccumulationTooltip=hu,t.AccumulationSelection=cu,t.AccumulationAnnotation=lu,t.Export=au,t}({}))},"./modules/base.js":function(){function n(t){return(n="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(n){return _typeof2(n)}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":_typeof2(n)})(t)}window.sf=window.sf||{};window.sf.base=function(t){"use strict";function lt(n,t){var i=t;return i.unshift(void 0),new(Function.prototype.bind.apply(n,i))}function ur(n){var r,u=new Uint16Array(5),t,i;return(window.msCrypto||window.crypto).getRandomValues(u),t="ej2"+function(n){for(var i="",t=0;t<5;t++)i+=(t?",":"")+n[t];return i}(u),i=function(i){i.source===window&&"string"==typeof i.data&&i.data.length<=32&&i.data===t&&(n(),r())},window.addEventListener("message",i,!1),window.postMessage(t,"*"),r=function(){window.removeEventListener("message",i);n=i=t=void 0}}function i(n,t){for(var i=t,u=n.replace(/\[/g,".").replace(/\]/g,"").split("."),r=0;r<u.length&&!f(i);r++)i=i[u[r]];return i}function y(n,t,i){for(var f,o=n.replace(/\[/g,".").replace(/\]/g,"").split("."),s=i||{},e=s,h=o.length,u=0;u<h;u++)f=o[u],u+1===h?e[f]=void 0===t?{}:t:r(e[f])&&(e[f]={}),e=e[f];return s}function fr(n,t){delete n[t]}function p(n){return!r(n)&&n.constructor==={}.constructor}function nt(n,t){var i;if(!r(t))for(var u=n,f=t,e=0,o=Object.keys(t);e<o.length;e++)i=o[e],r(u.deepMerge)||-1===u.deepMerge.indexOf(i)||!p(f[i])&&!Array.isArray(f[i])?u[i]=f[i]:s(u[i],u[i],f[i],!0)}function s(t,i,r,f){var e=t&&"object"===n(t)?t:{},h=arguments.length;f&&(h-=1);for(var l=function(n){if(!c[n])return"continue";var t=c[n];Object.keys(t).forEach(function(n){var r,o=e[n],i=t[n],h=Array.isArray(i)&&Array.isArray(o)&&i.length!==o.length,c=!u()||!(_instanceof(o,Event)||h);f&&c&&(p(i)||Array.isArray(i))?p(i)?(r=o||{},Array.isArray(r)&&r.hasOwnProperty("isComplexArray")?s(r,{},i,f):e[n]=s(r,{},i,f)):(r=u()?o&&Object.keys(i).length:o||[],e[n]=s([],r,i,f)):e[n]=i})},c=arguments,o=1;o<h;o++)l(o);return e}function r(n){return null==n}function f(n){return void 0===n}function er(n,t){var i;return function(){var r=this,u=arguments,f=function(){return i=null,n.apply(r,u)};clearTimeout(i);i=setTimeout(f,t)}}function bt(n,t){return n===t||!(n===document||!n)&&bt(n.parentNode,t)}function rt(n){try{throw new Error(n);}catch(n){throw n.message+"\n"+n.stack;}}function u(){return ii}function or(){if("undefined"!=typeof window){var n=new Uint16Array(5);return(window.msCrypto||window.crypto).getRandomValues(n)}}function g(n,t){var i=ie.test(n)?document.createElementNS("http://www.w3.org/2000/svg",n):document.createElement(n);return void 0===t||(i.innerHTML=t.innerHTML?t.innerHTML:"",void 0!==t.className&&(i.className=t.className),void 0!==t.id&&(i.id=t.id),void 0!==t.styles&&i.setAttribute("style",t.styles),void 0!==t.attrs&&dr(i,t.attrs)),i}function yt(n,t){for(var f,e,l=br(t),o=0,h=n;o<h.length;o++)for(var u=h[o],s=0,c=l;s<c.length;s++)f=c[s],p(u)?(e=i("attributes.className",u),r(e)?y("attributes.className",f,u):new RegExp("\\b"+f+"\\b","i").test(e)||y("attributes.className",e+" "+f,u)):u.classList.contains(f)||u.classList.add(f);return n}function pt(n,t){for(var r,o,u,s,h,f,c,a=br(t),e=0,l=n;e<l.length;e++)if(r=l[e],o=p(r),o?i("attributes.className",r):""!==r.className)for(u=0,s=a;u<s.length;u++)h=s[u],o?(f=i("attributes.className",r).split(" "),c=f.indexOf(h),-1!==c&&f.splice(c,1),y("attributes.className",f.join(" "),r)):r.classList.remove(h);return n}function br(n){var t=[];return"string"==typeof n?t.push(n):t=n,t}function ei(n){var t=n;return""===t.style.visibility&&t.offsetWidth>0}function kr(n){n.querySelectorAll("script").forEach(function(n){var t=document.createElement("script");t.text=n.innerHTML;document.head.appendChild(t);oi(t)})}function oi(n){var t=n.parentNode;if(t)return t.removeChild(n)}function dr(n,t){for(var i,f,r=n,u=0,e=Object.keys(t);u<e.length;u++)i=e[u],p(r)?(f=i,"tabindex"===i&&(f="tabIndex"),r.attributes[f]=t[i]):r.setAttribute(i,t[i]);return r}function kt(n,t){return void 0===t&&(t=document),n=gr(n),t.querySelector(n)}function si(n,t){return void 0===t&&(t=document),n=gr(n),t.querySelectorAll(n)}function gr(n){var r,u,t,i,f;if(n.match(/#[0-9]/g)){for(r=n.split(","),u=0;u<r.length;u++){for(t=r[u].split(" "),i=0;i<t.length;i++)t[i].indexOf("#")>-1&&(t[i].match(/\[.*\]/)||t[i].split("#")[1].match(/^\d/)&&(f=t[i].split("."),f[0]=f[0].replace(/#/,"[id='")+"']",t[i]=f.join(".")));r[u]=t.join(" ")}return r.join(",")}return n}function tt(n,t){var i=n;if("function"==typeof i.closest)return i.closest(t);for(;i&&1===i.nodeType;){if(ci(i,t))return i;i=i.parentNode}return null}function hi(n,t){void 0!==t&&Object.keys(t).forEach(function(i){n.style[i]=t[i]})}function ci(n,t){var i=n.matches||n.msMatchesSelector||n.webkitMatchesSelector;return i?i.call(n,t):-1!==[].indexOf.call(document.querySelectorAll(t),n)}function tu(n,t){for(var i,u="string"==typeof n?document.getElementById(n):n,r=0;r<u.ej2_instances.length;r++)if(i=u.ej2_instances[r],"string"==typeof t){if(t===i.getModuleName())return i}else if(_instanceof(i,t))return i}function dt(n,t,i,r){return n.properties.hasOwnProperty(t)&&_instanceof(n.properties[t],r)||(n.properties[t]=lt(r,[n,t,i])),n.properties[t]}function wt(n,t,i,r,u,f){for(var o,h,s=[],c=i?i.length:0,e=0;e<c;e++)o=r,(f&&(o=r(i[e],n)),u)?(h=lt(o,[n,t,{},!0]),h.setProperties(i[e],!0),s.push(h)):s.push(lt(o,[n,t,i[e],!1]));return s}function iu(n,t){return function(){return this.properties.hasOwnProperty(t)||(this.properties[t]=n),this.properties[t]}}function re(n,t){return function(i){if(this.properties[t]!==i){var r=this.properties.hasOwnProperty(t)?this.properties[t]:n;this.saveChanges(t,i,r);this.properties[t]=i}}}function ue(n,t,i){return function(){return dt(this,t,n,i)}}function fe(n,t,i){return function(r){dt(this,t,n,i).setProperties(r)}}function ee(n,t,i){return function(){var r=i({});return this.properties.hasOwnProperty(t)?this.properties[t]:dt(this,t,n,r)}}function oe(n,t,i){return function(r){var u=i(r,this);dt(this,t,n,u).setProperties(r)}}function se(n,t,i){return function(){var r=this,u,f;return this.properties.hasOwnProperty(t)||(u=wt(this,t,n,i,!1),this.properties[t]=u),f=void 0!==this.controlParent&&this.controlParent.ignoreCollectionWatch||this.ignoreCollectionWatch,this.properties[t].hasOwnProperty("push")||f||["push","pop"].forEach(function(n){var u={value:ae(n,t,i,r.properties[t]).bind(r),configurable:!0};Object.defineProperty(r.properties[t],n,u)}),this.properties[t].hasOwnProperty("isComplexArray")||Object.defineProperty(this.properties[t],"isComplexArray",{value:!0}),this.properties[t]}}function he(n,t,i){return function(r){this.isComplexArraySetter=!0;var f=wt(this,t,n,i,!1),u=wt(this,t,r,i,!0);this.isComplexArraySetter=!1;this.saveChanges(t,u,f);this.properties[t]=u}}function ce(n,t,i){return function(r){var f=this.properties.hasOwnProperty(t)?this.properties[t]:n,u=wt(this,t,r,i,!0,!0);this.saveChanges(t,u,f);this.properties[t]=u}}function le(n,t,i){return function(){var u=i({}),r;return this.properties.hasOwnProperty(t)||(r=wt(this,t,n,u,!1),this.properties[t]=r),this.properties[t]}}function ae(n,t,i,r){return function(){for(var e,u,o,s,i=[],f=0;f<arguments.length;f++)i[f]=arguments[f];e=this.propName?this.getParentKey()+"."+t+"-":t+"-";switch(n){case"push":for(u=0;u<i.length;u++)Array.prototype[n].apply(r,[i[u]]),o=ru(e+(r.length-1),i[u],!this.controlParent,n),this.serverDataBind(o,i[u],!1,n);break;case"pop":Array.prototype[n].apply(r);s=ru(e+r.length,null,!this.controlParent,n);this.serverDataBind(s,{ejsAction:"pop"},!1,n)}return r}}function ru(t,i,r,u){var f=t;return r&&((f={})[t]=i,i&&"object"===n(i))&&(f[t].ejsAction=u),f}function h(n){return function(t,i){var r={set:re(n,i),get:iu(n,i),enumerable:!0,configurable:!0};Object.defineProperty(t,i,r);et(t,i,"prop",n)}}function li(n,t){return function(i,r){var u={set:fe(n,r,t),get:ue(n,r,t),enumerable:!0,configurable:!0};Object.defineProperty(i,r,u);et(i,r,"complexProp",n,t)}}function a(){return function(n,t){var r={set:function(n){var u=this.properties[t],r;u!==n&&(r=function n(t,r){if(!1===t.hasOwnProperty("parentObj"))return{context:t,prefix:r};var u=i("propName",t);return u&&(r=u+"-"+r),n(i("parentObj",t),r)}(this,t),!1===f(u)&&r.context.removeEventListener(r.prefix,u),r.context.addEventListener(r.prefix,n),this.properties[t]=n)},get:iu(void 0,t),enumerable:!0,configurable:!0};Object.defineProperty(n,t,r);et(n,t,"event")}}function it(){}function et(n,t,i,r,u){f(n.propList)&&(n.propList={props:[],complexProps:[],colProps:[],events:[],propNames:[],complexPropNames:[],colPropNames:[],eventNames:[]});n.propList[i+"s"].push({propertyName:t,defaultValue:r,type:u});n.propList[i+"Names"].push(t)}function uu(n){var u=n.target,c=this.rippleOptions.selector,t=c?tt(u,c):u,r;if(!(!t||this.rippleOptions&&tt(u,this.rippleOptions.ignore))){var i=t.getBoundingClientRect(),f=n.pageX-document.body.scrollLeft,o=n.pageY-(!document.body.scrollTop&&document.documentElement?document.documentElement.scrollTop:document.body.scrollTop),l=Math.max(Math.abs(f-i.left),Math.abs(f-i.right)),a=Math.max(Math.abs(o-i.top),Math.abs(o-i.bottom)),s=Math.sqrt(l*l+a*a),h=2*s+"px",v=f-i.left-s,y=o-i.top-s;this.rippleOptions&&this.rippleOptions.isCenterRipple&&(v=0,y=0,h="100%");t.classList.add("e-ripple");r=g("div",{className:"e-ripple-element",styles:"width: "+h+";height: "+h+";left: "+v+"px;top: "+y+"px;transition-duration: "+this.rippleOptions.duration.toString()+"ms;"});t.appendChild(r);window.getComputedStyle(r).getPropertyValue("opacity");r.style.transform="scale(1)";t!==this.parent&&e.add(t,"mouseleave",ot,{parent:this.parent,rippleOptions:this.rippleOptions})}}function fu(n){eu(n,this)}function ot(n){eu(n,this)}function eu(n,t){var s=t.rippleOptions.duration,f=n.target,o=t.rippleOptions.selector,i=o?tt(f,o):f,u,r;i&&(!i||-1!==i.className.indexOf("e-ripple"))&&(u=si(".e-ripple-element",i),r=u[u.length-1],r&&(r.style.opacity="0.5"),t.parent!==i&&e.remove(i,"mouseleave",ot),setTimeout(function(){r&&r.parentNode&&r.parentNode.removeChild(r);i.getElementsByClassName("e-ripple-element").length||i.classList.remove("e-ripple");t.done&&t.done(n)},s))}function go(n,t,i){var r=function(n,t,i,r){var f=0,u=[],e=n.match(/class="([^"]+|)\s{2}/g),o="";return e&&e.forEach(function(t){o=t.replace(/\s\s+/g," ");n=n.replace(t,o)}),n.replace(fo,"").replace(ao,"'$1'").replace(yo,function(n,e){var o=e.match(co),c,h,l,s,a;return o?(c=o[1],so.test(e)?e='";} '+e.replace(o[1],c.replace(lo,function(n){return ht(n=n.trim(),!eo.test(n)&&-1===u.indexOf(n),t,u,r)}))+'{ \n str = str + "':oo.test(e)?e='"; '+e.replace(o[1],c.replace(vo,function(n){return bu(n,t,u,r)}))+'{ \n str = str + "':ho.test(e)?(h=o[1].split(" of "),e='"; '+e.replace(o[1],function(){return u.push(h[0]),u.push(h[0]+"Index"),"var i"+(f+=1)+"=0; i"+f+" < "+ht(h[1],!0,t,u,r)+".length; i"+f+"++"})+"{ \n "+h[0]+"= "+ht(h[1],!0,t,u,r)+"[i"+f+"]; \n var "+h[0]+"Index=i"+f+'; \n str = str + "'):(l=e.split("("),s=i&&i.hasOwnProperty(l[0])?"this.":"global",s=/\./.test(l[0])?"":s,a=o[1].split(","),0===o[1].length||/data/.test(a[0])||/window./.test(a[0])||(o[1]="global"===s?t+"."+o[1]:o[1]),ko.test(e)&&/\]\./gm.test(e)||/@|\$|#/gm.test(e)?/@|\$|#|\]\./gm.test(e)&&(e='"+ '+("global"===s?"":s)+e.replace(o[1],c.replace(bo,function(n){return bu(n,t,u,r)}))+'+ "'):e='" + '+("global"===s?"":s)+e.replace(c,ht(o[1].replace(/,( |)data.|,/gi,","+t+".").replace(/,( |)data.window/gi,",window"),"global"!==s,t,u,r))+'+"')):yu.test(e)?e='"; '+e.replace(yu,'} else { \n str = str + "'):e.match(pu)?e=e.replace(pu,'"; \n } \n str = str + "'):/@|#|\$/gm.test(e)?(e.match(tr)&&(e=wu(e)),e='"+'+ir(e,-1===u.indexOf(e),t,u)+'"]+"'):e=e.match(tr)?'"+'+ir(e=wu(e),-1===u.indexOf(e),t,u)+'"]+"':'"+'+ht(e.replace(/,/gi,"+"+t+"."),-1===u.indexOf(e),t,u,r)+'+"',e})}(n,"data",t,i);return new Function("data",'var str="'+r+"\";var valueRegEx = (/value=\\'([A-Za-z0-9 _]*)((.)([\\w)(!-;?-\\s]+)['])/g);\n    var hrefRegex = (/(?:href)([\\s='\"./]+)([\\w-./?=&\\\\#\"]+)((.)([\\w)(!-;/?-\\s]+)['])/g);\n    if(str.match(valueRegEx)){\n        var check = str.match(valueRegEx);\n        var str1 = str;\n        for (var i=0; i < check.length; i++) {\n            var check1 = str.match(valueRegEx)[i].split('value=')[1];\n            var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '\"') : check1;\n            change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'\"') : change;\n            str1 = str1.replace(check1, change);\n        }\n        str = str.replace(str, str1);\n    }\n    else if(str.match(hrefRegex)) {\n        var check = str.match(hrefRegex);\n        var str1 = str;\n        for (var i=0; i < check.length; i++) {\n            var check1 = str.match(hrefRegex)[i].split('href=')[1];\n            var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '\"') : check1;\n            change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'\"') : change;\n            str1 = str1.replace(check1, change);\n        }\n        str = str.replace(str, str1);\n    }\n     return str;").bind(t)}function ht(n,t,i,r,u){return!t||nr.test(n)||-1!==r.indexOf(n.split(".")[0])||u?n:i+"."+n}function ir(n,t,i,r){return t&&!nr.test(n)&&-1===r.indexOf(n.split(".")[0])?i+'["'+n:n}function wu(n){return n.match(wo)?n:n.replace(tr,"\\\\")}function bu(n,t,i,r){if(n=n.trim(),/\window\./gm.test(n))return n;var u=/'|"/gm;return/@|\$|#/gm.test(n)&&(n=ir(n,-1===i.indexOf(n),t,i)+'"]'),po.test(n)?function(n,t,i,r){return!t||nr.test(n)||-1!==r.indexOf(n.split(".")[0])||/^\..*/gm.test(n)?n:i+"."+n}(n,!u.test(n)&&-1===i.indexOf(n),t,i):ht(n,!u.test(n)&&-1===i.indexOf(n),t,i,r)}function ku(){return"-"+Math.random().toString(36).substr(2,5)}var ct="ej2_instances",gu=0,ii=!1,ri,at,nf={latn:{_digits:"0123456789",_type:"numeric"}},sr={decimal:".",group:",",percentSign:"%",plusSign:"+",minusSign:"-",infinity:"",nan:"NaN",exponential:"E"},hr=[0,1,2,3,4,5,6,7,8,9],l=function(){function n(){}return n.getMainObject=function(n,t){return i(u()?t:"main."+t,n)},n.getNumberingSystem=function(n){return i("supplemental.numberingSystems",n)||this.numberingSystems},n.reverseObject=function(n,t){for(var i,r={},u=0,f=t||Object.keys(n);u<f.length;u++)i=f[u],r.hasOwnProperty(n[i])||(r[n[i]]=i);return r},n.getSymbolRegex=function(n){var t=n.map(function(n){return n.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}).join("|");return new RegExp(t,"g")},n.getSymbolMatch=function(n){for(var i,r={},t=0,u=Object.keys(sr);t<u.length;t++)i=u[t],r[n[i]]=sr[i];return r},n.constructRegex=function(n){for(var i=n.length,r="",t=0;t<i;t++)r+=t!==i-1?n[t]+"|":n[t];return r},n.convertValueParts=function(n,t,i){return n.replace(t,function(n){return i[n]})},n.getDefaultNumberingSystem=function(n){var t={};return t.obj=i("numbers",n),t.nSystem=i("defaultNumberingSystem",t.obj),t},n.getCurrentNumericOptions=function(n,t,r,u){var e={},s=this.getDefaultNumberingSystem(n),o;return(!f(s.nSystem)||u)&&(o=u?i("obj.mapperDigits",s):i(s.nSystem+"._digits",t),f(o)||(e.numericPair=this.reverseObject(o,hr),e.numberParseRegex=new RegExp(this.constructRegex(o),"g"),e.numericRegex="["+o[0]+"-"+o[9]+"]",r&&(e.numericRegex=o[0]+"-"+o[9],e.symbolNumberSystem=i(u?"numberSymbols":"symbols-numberSystem-"+s.nSystem,s.obj),e.symbolMatch=this.getSymbolMatch(e.symbolNumberSystem),e.numberSystem=s.nSystem))),e},n.getNumberMapper=function(n,t){var r={mapper:{}},u=this.getDefaultNumberingSystem(n),o,e,s,h;if(!f(u.nSystem)&&(r.numberSystem=u.nSystem,r.numberSymbols=i("symbols-numberSystem-"+u.nSystem,u.obj),r.timeSeparator=i("timeSeparator",r.numberSymbols),o=i(u.nSystem+"._digits",t),!f(o)))for(e=0,s=hr;e<s.length;e++)h=s[e],r.mapper[h]=o[h];return r},n.nPair="numericPair",n.nRegex="numericRegex",n.numberingSystems=nf,n}(),tf={DJF:"Fdj",ERN:"Nfk",ETB:"Br",NAD:"$",ZAR:"R",XAF:"FCFA",GHS:"GH",XDR:"XDR",AED:"..",BHD:"..",DZD:"..",EGP:"..",ILS:"",IQD:"..",JOD:"..",KMF:"CF",KWD:"..",LBP:"..",LYD:"..",MAD:"..",MRU:"..",OMR:"..",QAR:"..",SAR:"..",SDG:"..",SOS:"S",SSP:"",SYP:"..",TND:"..",YER:"..",CLP:"$",INR:"",TZS:"TSh",EUR:"",AZN:"",RUB:"",BYN:"Br",ZMW:"K",BGN:".",NGN:"",XOF:"CFA",BDT:"",CNY:"",BAM:"",UGX:"USh",USD:"$",CZK:"K",GBP:"",DKK:"kr.",KES:"Ksh",CHF:"CHF",MVR:".",BTN:"Nu.",XCD:"EC$",AUD:"$",BBD:"$",BIF:"FBu",BMD:"$",BSD:"$",BWP:"P",BZD:"$",CAD:"$",NZD:"$",FJD:"$",FKP:"",GIP:"",GMD:"D",GYD:"$",HKD:"$",IDR:"Rp",JMD:"$",KYD:"$",LRD:"$",MGA:"Ar",MOP:"MOP$",MUR:"Rs",MWK:"MK",MYR:"RM",PGK:"K",PHP:"",PKR:"Rs",RWF:"RF",SBD:"$",SCR:"SR",SEK:"kr",SGD:"$",SHP:"",SLL:"Le",ANG:"NAf.",SZL:"E",TOP:"T$",TTD:"$",VUV:"VT",WST:"WS$",ARS:"$",BOB:"Bs",BRL:"R$",COP:"$",CRC:"",CUP:"$",DOP:"$",GTQ:"Q",HNL:"L",MXN:"$",NIO:"C$",PAB:"B/.",PEN:"S/",PYG:"",UYU:"$",VES:"Bs.S",IRR:"",GNF:"FG",CDF:"FC",HTG:"G",XPF:"FCFP",HRK:"kn",HUF:"Ft",AMD:"",ISK:"kr",JPY:"",GEL:"",CVE:"",KZT:"",KHR:"",KPW:"",KRW:"",KGS:"",AOA:"Kz",LAK:"",MZN:"MTn",MKD:"",MNT:"",BND:"$",MMK:"K",NOK:"kr",NPR:"",AWG:"Afl.",SRD:"$",PLN:"z",AFN:"",STN:"Db",MDL:"L",RON:"lei",UAH:"",LKR:".",ALL:"Lek",RSD:".",TJS:"",THB:"",TMT:"m.",TRY:"",UZS:"",VND:"",TWD:"NT$"},v,nu,w,hu;ri=t.HijriParser||(t.HijriParser={});at=[28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990];ri.getHijriDate=function(n){var y=n.getDate(),u=n.getMonth(),p=n.getFullYear(),s=u+1,h=p,a,d,r,g,i;s<3&&(h-=1,s+=12);var f=Math.floor(h/100),w=f-Math.floor(f/4)-2,e=Math.floor(365.25*(h+4716))+Math.floor(30.6001*(s+1))+y-w-1524,o=e+(w=(f=Math.floor((e-1867216.25)/36524.25))-Math.floor(f/4)+1)+1524,c=Math.floor((o-122.1)/365.25),l=Math.floor(365.25*c),ut=Math.floor((o-l)/30.6001);y=o-l-Math.floor(30.6001*ut);(u=Math.floor((o-l)/20.6001))>13&&(c+=1,u-=12);u-=1;p=c-4716;var b=e-24e5,t=e-1948084,k=Math.floor(t/10631);for(t-=10631*k,a=Math.floor((t-.1335)/(10631/30)),d=30*k+a,t-=Math.floor(a*(10631/30)+.1335),r=Math.floor((t+28.5001)/29.5),13===r&&(r=12),g=t-Math.floor(29.5001*r-29),i=0;i<at.length&&!(at[i]>b);i++);var nt=i+16260,tt=Math.floor((nt-1)/12),it=tt+1,rt=nt-12*tt,v=b-at[i-1]+1;return(v+"").length>2&&(v=g,rt=r,it=d),{year:it,month:rt,date:v}};ri.toGregorian=function(n,t,i){var l=i+at[12*(n-1)+1+(t-1)-16261]- -2399999,o=Math.floor(l+.5),r=Math.floor((o-1867216.25)/36524.25),u=1524+(r=o+1+r-Math.floor(r/4)),s=Math.floor((u-122.1)/365.25),h=Math.floor(365.25*s),f=Math.floor((u-h)/30.6001),a=u-h-Math.floor(30.6001*f),e=f-(f>13.5?13:1),c=s-(e>2.5?4716:4715);return c<=0&&e--,new Date(c+"/"+e+"/"+a)};var rf=/\/MMMMM|MMMM|MMM|a|LLLL|LLL|EEEEE|EEEE|E|K|cccc|ccc|WW|W|G+|z+/gi,uf=["sun","mon","tue","wed","thu","fri","sat"],cr={m:"getMinutes",h:"getHours",H:"getHours",s:"getSeconds",d:"getDate",f:"getMilliseconds"},ff={M:"month",d:"day",E:"weekday",c:"weekday",y:"year",m:"minute",h:"hour",H:"hour",s:"second",L:"month",a:"designator",z:"timeZone",Z:"timeZone",G:"era",f:"milliseconds"},lr=function(){function n(){}return n.dateFormat=function(n,r,e){var d=this,o=t.IntlBase.getDependables(e,n,r.calendar),g=i("parserObject.numbers",o),a=o.dateObject,h={isIslamic:t.IntlBase.islamicRegex.test(r.calendar)},c,y,p,k;if(u()&&r.isServerRendered&&(r=t.IntlBase.compareBlazorDateFormats(r,n)),c=r.format||t.IntlBase.getResultantPattern(r.skeleton,o.dateObject,r.type,!1,u()?n:""),h.dateSeperator=u()?i("dateSeperator",a):t.IntlBase.getDateSeparator(o.dateObject),f(c))rt("Format options or type given must be invalid");else for(c=t.IntlBase.ConvertDateToWeekFormat(c),u()&&(c=c.replace(/tt/,"a")),h.pattern=c,h.numMapper=u()?s({},g):l.getNumberMapper(o.parserObject,l.getNumberingSystem(e)),y=0,p=c.match(rf)||[];y<p.length;y++){var b=p[y],v=b.length,w=b[0];switch("K"===w&&(w="h"),w){case"E":case"c":h.weekday=u()?i("days."+t.IntlBase.monthIndex[v],a):o.dateObject[t.IntlBase.days]["stand-alone"][t.IntlBase.monthIndex[v]];break;case"M":case"L":h.month=u()?i("months."+t.IntlBase.monthIndex[v],a):o.dateObject[t.IntlBase.month]["stand-alone"][t.IntlBase.monthIndex[v]];break;case"a":h.designator=u()?i("dayPeriods",a):i("dayPeriods.format.wide",a);break;case"G":k=v<=3?"eraAbbr":4===v?"eraNames":"eraNarrow";h.era=u()?i("eras",a):i("eras."+k,o.dateObject);break;case"z":h.timeZone=i("dates.timeZoneNames",o.parserObject)}}return function(n){return isNaN(n.getDate())?null:d.intDateFormatter(n,h)}},n.intDateFormatter=function(n,i){for(var k,d,it,g,y,nt,p,u="",rt=i.pattern.match(t.IntlBase.dateParseRegex),w=this.getCurrentDateValue(n,i.isIslamic),b=0,tt=rt;b<tt.length;b++){var h=tt[b],e=h.length,o=h[0];"K"===o&&(o="h");var s=void 0,c="",a=void 0,v=void 0,f="";switch(o){case"M":case"L":s=w.month;e>2?u+=i.month[s]:a=!0;break;case"E":case"c":u+=i.weekday[uf[n.getDay()]];break;case"H":case"h":case"m":case"s":case"d":case"f":if(a=!0,"d"===o)s=w.date;else if("f"===o){if(a=!1,v=!0,k=(c=(c=n[cr[o]]().toString()).substring(0,e)).length,e!==k){if(e>3)continue;for(d=0;d<e-k;d++)c="0"+c.toString()}f+=c}else s=n[cr[o]]();"h"===o&&(s=s%12||12);break;case"y":v=!0;f+=w.year;2===e&&(f=f.substr(f.length-2));break;case"a":it=n.getHours()<12?"am":"pm";u+=i.designator[it];break;case"G":g=n.getFullYear()<0?0:1;y=i.era[g];r(y)&&(y=i.era[g?0:1]);u+=y||"";break;case"'":u+="''"===h?"'":h.replace(/'/g,"");break;case"z":nt=n.getTimezoneOffset();p=e<4?"+H;-H":i.timeZone.hourFormat;p=p.replace(/:/g,i.numMapper.timeSeparator);0===nt?u+=i.timeZone.gmtZeroFormat:(v=!0,f=this.getTimeZoneValue(nt,p));f=i.timeZone.gmtFormat.replace(/\{0\}/,f);break;case":":u+=i.numMapper.numberSymbols.timeSeparator;break;case"/":u+=i.dateSeperator;break;case"W":a=!0;s=t.IntlBase.getWeekOfYear(n);break;default:u+=h}a&&(v=!0,f=this.checkTwodigitNumber(s,e));v&&(u+=l.convertValueParts(f,t.IntlBase.latnParseRegex,i.numMapper.mapper))}return u},n.getCurrentDateValue=function(n,i){return i?t.HijriParser.getHijriDate(n):{year:n.getFullYear(),month:n.getMonth()+1,date:n.getDate()}},n.checkTwodigitNumber=function(n,t){var i=n+"";return 2===t&&2!==i.length?"0"+i:i},n.getTimeZoneValue=function(n,t){var r=this,u=t.split(";")[n>0?1:0],i=Math.abs(n);return u.replace(/HH?|mm/g,function(n){var t=n.length,u=-1!==n.indexOf("H");return r.checkTwodigitNumber(Math.floor(u?i/60:i%60),t)})},n}(),ar={ms:"minimumSignificantDigits",ls:"maximumSignificantDigits",mf:"minimumFractionDigits",lf:"maximumFractionDigits"},ut=["infinity","nan","group","decimal","exponential"],vr=function(){function n(){}return n.numberFormatter=function(n,r,e){var p,g=this,o=s({},r),c={},h={},v=t.IntlBase.getDependables(e,n,"",!0),a=v.numericObject,w,y,k,b,d;return h.numberMapper=u()?s({},a):l.getNumberMapper(v.parserObject,l.getNumberingSystem(e),!0),h.currencySymbol=u()?i("currencySymbol",a):t.IntlBase.getCurrencySymbol(v.numericObject,o.currency||t.defaultCurrencyCode,r.altSymbol),h.percentSymbol=u()?i("numberSymbols.percentSign",a):h.numberMapper.numberSymbols.percentSign,h.minusSymbol=u()?i("numberSymbols.minusSign",a):h.numberMapper.numberSymbols.minusSign,w=h.numberMapper.numberSymbols,r.format&&!t.IntlBase.formatRegex.test(r.format)?c=t.IntlBase.customFormat(r.format,h,v.numericObject):((s(o,t.IntlBase.getProperNumericSkeleton(r.format||"N")),o.isCurrency="currency"===o.type,o.isPercent="percent"===o.type,u()||(p=t.IntlBase.getSymbolPattern(o.type,h.numberMapper.numberSystem,v.numericObject,o.isAccount)),o.groupOne=this.checkValueRange(o.maximumSignificantDigits,o.minimumSignificantDigits,!0),this.checkValueRange(o.maximumFractionDigits,o.minimumFractionDigits,!1,!0),f(o.fractionDigits)||(o.minimumFractionDigits=o.maximumFractionDigits=o.fractionDigits),f(o.useGrouping)&&(o.useGrouping=!0),o.isCurrency&&!u()&&(p=p.replace(/\u00A4/g,t.IntlBase.defaultCurrency)),u())?(c.nData=s({},{},i(o.type+"nData",a)),c.pData=s({},{},i(o.type+"pData",a)),"currency"===o.type&&r.currency&&t.IntlBase.replaceBlazorCurrency([c.pData,c.nData],h.currencySymbol,r.currency)):(y=p.split(";"),c.nData=t.IntlBase.getFormatData(y[1]||"-"+y[0],!0,h.currencySymbol),c.pData=t.IntlBase.getFormatData(y[0],!1,h.currencySymbol),o.useGrouping&&(o.groupSeparator=w[ut[2]],o.groupData=this.getGroupingDetails(y[0]))),(f(o.minimumFractionDigits)&&(o.minimumFractionDigits=c.nData.minimumFraction),f(o.maximumFractionDigits))&&(k=c.nData.maximumFraction,o.maximumFractionDigits=f(k)&&o.isPercent?0:k),b=o.minimumFractionDigits,d=o.maximumFractionDigits,f(b)||f(d)||b>d&&(o.maximumFractionDigits=b)),s(c.nData,o),s(c.pData,o),function(n){return isNaN(n)?w[ut[1]]:isFinite(n)?g.intNumberFormatter(n,c,h):w[ut[0]]}},n.getGroupingDetails=function(n){var u={},f=n.match(t.IntlBase.negativeDataRegex),r,i,o,e;return f&&f[4]&&(r=f[4],i=r.lastIndexOf(","),-1!==i&&(o=r.split(".")[0],u.primary=o.length-i-1,e=r.lastIndexOf(",",i-1),-1!==e&&(u.secondary=i-1-e))),u},n.checkValueRange=function(n,t,i,r){var o=r?"f":"s",u=0,s=ar["l"+o],e=ar["m"+o];if(f(n)||(this.checkRange(n,s,r),u++),f(t)||(this.checkRange(t,e,r),u++),2===u){if(!(n<t))return!0;rt(e+"specified must be less than the"+s)}else i&&1===u&&rt("Both"+e+"and"+e+"must be present");return!1},n.checkRange=function(n,t,i){var r=i?[0,20]:[1,21];(n<r[0]||n>r[1])&&rt(t+"value must be within the range"+r[0]+"to"+r[1])},n.intNumberFormatter=function(n,i,r){var u,e;if(!f(i.nData.type))return n<0?(n*=-1,u=i.nData):u=0===n&&i.zeroData||i.pData,e="",u.isPercent&&(n*=100),u.groupOne?e=this.processSignificantDigits(n,u.minimumSignificantDigits,u.maximumSignificantDigits):(e=this.processFraction(n,u.minimumFractionDigits,u.maximumFractionDigits),u.minimumIntegerDigits&&(e=this.processMinimumIntegers(e,u.minimumIntegerDigits))),"scientific"===u.type&&(e=(e=n.toExponential(u.maximumFractionDigits)).replace("e",r.numberMapper.numberSymbols[ut[4]])),e=e.replace(".",r.numberMapper.numberSymbols[ut[3]]),u.useGrouping&&(e=this.groupNumbers(e,u.groupData.primary,u.groupSeparator||",",r.numberMapper.numberSymbols[ut[3]]||".",u.groupData.secondary)),e=l.convertValueParts(e,t.IntlBase.latnParseRegex,r.numberMapper.mapper),"N/A"===u.nlead?u.nlead:u.nlead+e+u.nend},n.processSignificantDigits=function(n,t,i){var r=n+"";return r.length<t?n.toPrecision(t):+(r=n.toPrecision(i))+""},n.groupNumbers=function(n,t,i,u,f){for(var c=!r(f)&&0!==f,s=n.split(u),h=s[0],e=h.length,o="";e>t;)o=h.slice(e-t,e)+(o.length?i+o:""),e-=t,c&&(t=f,c=!1);return s[0]=h.slice(0,e)+(o.length?i:"")+o,s.join(u)},n.processFraction=function(n,t,i){var o=(n+"").split(".")[1],f=o?o.length:0,u,e;if(t&&f<t){if(u="",0!==f){for(u+=n,e=0;e<t-f;e++)u+="0";return u}return u=n.toFixed(t),n.toFixed(t)}return!r(i)&&(f>i||0===i)?n.toFixed(i):n+""},n.processMinimumIntegers=function(n,t){var r=n.split("."),i=r[0],f=i.length,u;if(f<t){for(u=0;u<t-f;u++)i="0"+i;r[0]=i}return r.join(".")},n}(),ef=/^[0-9]*$/,yr={minute:"setMinutes",hour:"setHours",second:"setSeconds",day:"setDate",month:"setMonth",milliseconds:"setMilliseconds"},sf=function(){function n(){}return n.dateParser=function(n,e,o){var ot=this,c=t.IntlBase.getDependables(o,n,e.calendar),st=l.getCurrentNumericOptions(c.parserObject,l.getNumberingSystem(o),!1,u()),s={},tt,p,h,ut,vt,ft,yt,pt,et,nt;if(u()&&e.isServerRendered&&(e=t.IntlBase.compareBlazorDateFormats(e,n)),p=e.format||t.IntlBase.getResultantPattern(e.skeleton,c.dateObject,e.type,!1,u()?n:""),h="",f(p))rt("Format options or type given must be invalid");else{p=t.IntlBase.ConvertDateToWeekFormat(p);s={isIslamic:t.IntlBase.islamicRegex.test(e.calendar),pattern:p,evalposition:{},culture:n};for(var ht=p.match(t.IntlBase.dateParseRegex)||[],ct=ht.length,lt=0,at=0,it=!1,v=st.numericRegex,wt=u()?c.parserObject.numbers:l.getNumberMapper(c.parserObject,l.getNumberingSystem(o)),k=0;k<ct;k++){var d=ht[k],a=d.length,w="K"===d[0]?"h":d[0],g=void 0,b=void 0,y=ff[w],bt=2===a?"":"?";switch(it&&(lt=at,it=!1),w){case"E":case"c":ut=void 0;ut=u()?i("days."+t.IntlBase.monthIndex[a],c.dateObject):c.dateObject[t.IntlBase.days]["stand-alone"][t.IntlBase.monthIndex[a]];vt=l.reverseObject(ut);h+="("+Object.keys(vt).join("|")+")";break;case"M":case"L":case"d":case"m":case"s":case"h":case"H":case"f":if(b=!0,("M"===w||"L"===w)&&a>2)ft=void 0,ft=u()?i("months."+t.IntlBase.monthIndex[a],c.dateObject):c.dateObject.months["stand-alone"][t.IntlBase.monthIndex[a]],s[y]=l.reverseObject(ft),h+="("+Object.keys(s[y]).join("|")+")";else if("f"===w){if(a>3)continue;g=!0;h+="("+v+v+"?"+v+"?)"}else g=!0,h+="("+v+v+bt+")";"h"===w&&(s.hour12=!0);break;case"W":h+="("+v+(1===a?"?":"")+v+")";break;case"y":b=g=!0;h+=2===a?"("+v+v+")":"("+v+"{"+a+",})";break;case"a":b=!0;yt=u()?i("dayPeriods",c.dateObject):i("dayPeriods.format.wide",c.dateObject);s[y]=l.reverseObject(yt);h+="("+Object.keys(s[y]).join("|")+")";break;case"G":b=!0;pt=a<=3?"eraAbbr":4===a?"eraNames":"eraNarrow";s[y]=l.reverseObject(u()?i("eras",c.dateObject):i("eras."+pt,c.dateObject));h+="("+Object.keys(s[y]).join("|")+"?)";break;case"z":b=0!==(new Date).getTimezoneOffset();s[y]=i("dates.timeZoneNames",c.parserObject);et=s[y];nt=(tt=a<4)?"+H;-H":et.hourFormat;nt=nt.replace(/:/g,wt.timeSeparator);h+="("+this.parseTimeZoneRegx(nt,et,v)+")?";it=!0;at=tt?6:12;break;case"'":h+="("+d.replace(/'/g,"")+")?";break;default:h+="([\\D])"}b&&(s.evalposition[y]={isNumber:g,pos:k+1+lt,hourOnly:tt});k!==ct-1||r(h)||(s.parserRegex=new RegExp("^"+h+"$","i"))}}return function(n){var i=ot.internalDateParse(n,s,st),e;if(r(i)||!Object.keys(i).length)return null;if(s.isIslamic){var u={},f=i.year,o=i.day,h=i.month,c=f?f+"":"",l=2===c.length;f&&h&&o&&!l||(u=t.HijriParser.getHijriDate(new Date));l&&(f=parseInt((u.year+"").slice(0,2)+c,10));e=t.HijriParser.toGregorian(f||u.year,h||u.month,o||u.date);i.year=e.getFullYear();i.month=e.getMonth()+1;i.day=e.getDate()}return ot.getDateObject(i)}},n.getDateObject=function(n,t){var i=t||new Date,o,h,u,r,c,l,p,s,a;i.setMilliseconds(0);var e=n.year,v=n.designator,y=n.timeZone;for(f(e)||((e+"").length<=2&&(e+=100*Math.floor(i.getFullYear()/100)),i.setFullYear(e)),o=0,h=["hour","minute","second","milliseconds","month","day"];o<h.length;o++)if(u=h[o],r=n[u],f(r)&&"day"===u&&i.setDate(1),!f(r))if("month"===u){if((r-=1)<0||r>11)return new Date("invalid");c=i.getDate();i.setDate(1);i[yr[u]](r);l=new Date(i.getFullYear(),r+1,0).getDate();i.setDate(c<l?c:l)}else{if("day"===u&&(p=new Date(i.getFullYear(),i.getMonth()+1,0).getDate(),r<1||r>p))return null;i[yr[u]](r)}return f(v)||(s=i.getHours(),"pm"===v?i.setHours(s+(12===s?0:12)):12===s&&i.setHours(0)),f(y)||(a=y-i.getTimezoneOffset(),0!==a&&i.setMinutes(i.getMinutes()+a)),i},n.internalDateParse=function(n,t,i){var u=n.match(t.parserRegex),s={hour:0,minute:0,second:0},l,v;if(r(u))return null;for(l=0,v=Object.keys(t.evalposition);l<v.length;l++){var e=v[l],a=t.evalposition[e],o=u[a.pos];if(a.isNumber)s[e]=this.internalNumberParser(o,i);else if("timeZone"!==e||f(o))o="month"!==e||t.isIslamic||"en"!==t.culture&&"en-GB"!==t.culture&&"en-US"!==t.culture?o:o[0].toUpperCase()+o.substring(1).toLowerCase(),s[e]=t[e][o];else{var h=a.pos,c=void 0,y=u[h+1],p=!f(y);a.hourOnly?c=60*this.getZoneValue(p,y,u[h+4],i):(c=60*this.getZoneValue(p,y,u[h+7],i),c+=this.getZoneValue(p,u[h+4],u[h+10],i));r(c)||(s[e]=c)}}return t.hour12&&(s.hour12=!0),s},n.internalNumberParser=function(n,t){return n=l.convertValueParts(n,t.numberParseRegex,t.numericPair),ef.test(n)?+n:null},n.parseTimeZoneRegx=function(n,t,i){var r,u,e=t.gmtFormat,f="("+i+")("+i+")";return r=n.replace("+","\\+"),u=(r=-1!==n.indexOf("HH")?r.replace(/HH|mm/g,"("+f+")"):r.replace(/H|m/g,"("+f+"?)")).split(";").map(function(n){return e.replace("{0}",n)}),r=u.join("|")+"|"+t.gmtZeroFormat},n.getZoneValue=function(n,t,i,r){var f=n?t:i,u;return f?(u=this.internalNumberParser(f,r),n?-u:u):0},n}(),hf=/^([^0-9]*)(([0-9,]*[0-9]+)(\.[0-9]+)?)([Ee][+-]?[0-9]+)?([^0-9]*)$/,cf=/,/g,lf=["minusSign","infinity"],af=function(){function n(){}return n.numberParser=function(n,r,f){var o,y=this,a=t.IntlBase.getDependables(f,n,"",!0),e={custom:!0},v,h,c;return t.IntlBase.formatRegex.test(r.format)||!r.format?(s(e,t.IntlBase.getProperNumericSkeleton(r.format||"N")),e.custom=!1,e.fractionDigits||r.maximumFractionDigits&&(e.maximumFractionDigits=r.maximumFractionDigits)):s(e,t.IntlBase.customFormat(r.format,null,null)),h=i("numbers",a.parserObject),(o=l.getCurrentNumericOptions(a.parserObject,l.getNumberingSystem(f),!0,u()),e.symbolRegex=l.getSymbolRegex(Object.keys(o.symbolMatch)),e.infinity=o.symbolNumberSystem[lf[1]],u())?(e.nData=s({},{},i(e.type+"nData",h)),e.pData=s({},{},i(e.type+"pData",h)),"currency"===e.type&&r.currency&&t.IntlBase.replaceBlazorCurrency([e.pData,e.nData],i("currencySymbol",h),r.currency)):(v=t.IntlBase.getSymbolPattern(e.type,o.numberSystem,a.numericObject,e.isAccount))&&(c=(v=v.replace(/\u00A4/g,t.IntlBase.defaultCurrency)).split(";"),e.nData=t.IntlBase.getFormatData(c[1]||"-"+c[0],!0,""),e.pData=t.IntlBase.getFormatData(c[0],!0,"")),function(n){return y.getParsedNumber(n,e,o)}},n.getParsedNumber=function(n,t,i){var o,a,f,s,h,u,e,c;return-1!==n.indexOf(t.infinity)?1/0:(n=l.convertValueParts(n,t.symbolRegex,i.symbolMatch),0===(n=-1!==(n=l.convertValueParts(n,i.numberParseRegex,i.numericPair)).indexOf("-")?n.replace("-.","-0."):n).indexOf(".")&&(n="0"+n),e=n.match(hf),r(e))?NaN:(s=e[1],f=e[2],c=e[5],h=e[6],a=(o=t.custom?s===t.nData.nlead&&h===t.nData.nend:-1!==s.indexOf(t.nData.nlead)&&-1!==h.indexOf(t.nData.nend))?t.nData.isPercent:t.pData.isPercent,f=f.replace(cf,""),c&&(f+=c),u=+f,("percent"===t.type||a)&&(u/=100),(t.custom||t.fractionDigits)&&(u=parseFloat(u.toFixed(t.custom?o?t.nData.maximumFractionDigits:t.pData.maximumFractionDigits:t.fractionDigits))),t.maximumFractionDigits&&(u=this.convertMaxFracDigits(f,t,u,o)),o&&(u*=-1),u)},n.convertMaxFracDigits=function(n,t,i,r){var u=n.split(".");return u[1]&&u[1].length>t.maximumFractionDigits&&(i=+i.toFixed(t.custom?r?t.nData.maximumFractionDigits:t.pData.maximumFractionDigits:t.maximumFractionDigits)),i},n}(),vt=function(){function n(n){this.ranArray=[];this.boundedEvents={};r(n)||(this.context=n)}return n.prototype.on=function(n,t,i,u){if(!r(t)){var f=i||this.context;this.notExist(n)?this.boundedEvents[n]=[{handler:t,context:f}]:r(u)?this.isHandlerPresent(this.boundedEvents[n],t)||this.boundedEvents[n].push({handler:t,context:f}):-1===this.ranArray.indexOf(u)&&(this.ranArray.push(u),this.boundedEvents[n].push({handler:t,context:f,id:u}))}},n.prototype.off=function(n,t,r){var f,u,e;if(!this.notExist(n))if(f=i(n,this.boundedEvents),t){for(u=0;u<f.length;u++)if(r){if(f[u].id===r){f.splice(u,1);e=this.ranArray.indexOf(r);-1!==e&&this.ranArray.splice(e,1);break}}else if(t===f[u].handler){f.splice(u,1);break}}else delete this.boundedEvents[n]},n.prototype.notify=function(n,t,r,u){var e,f,o,s;if(this.notExist(n))r&&r.call(this,t);else{if(t&&(t.name=n),e=i(n,this.boundedEvents).slice(0),window.Blazor)return this.blazorCallback(e,t,r,u,0);for(f=0,o=e;f<o.length;f++)s=o[f],s.handler.call(s.context,t);r&&r.call(this,t)}},n.prototype.blazorCallback=function(n,t,i,r,u){var e=this,h=u===n.length-1,f,o;if(u<n.length)if(f=n[u],o=f.handler.call(f.context,t),o&&"function"==typeof o.then){if(!i)return o;o.then(function(o){if(o="string"==typeof o&&e.isJson(o)?JSON.parse(o,e.dateReviver):o,s(t,t,o,!0),!i||!h)return e.blazorCallback(n,t,i,r,u+1);i.call(f.context,t)}).catch(function(n){r&&r.call(f.context,"string"==typeof n&&e.isJson(n)?JSON.parse(n,e.dateReviver):n)})}else{if(!i||!h)return this.blazorCallback(n,t,i,r,u+1);i.call(f.context,t)}},n.prototype.dateReviver=function(n,t){return u&&"string"==typeof t&&null!==t.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)?new Date(t):t},n.prototype.isJson=function(n){try{JSON.parse(n)}catch(n){return!1}return!0},n.prototype.destroy=function(){this.boundedEvents=this.context=void 0},n.prototype.notExist=function(n){return!1===this.boundedEvents.hasOwnProperty(n)||this.boundedEvents[n].length<=0},n.prototype.isHandlerPresent=function(n,t){for(var i=0,r=n;i<r.length;i++)if(r[i].handler===t)return!0;return!1},n}(),ft=new vt;t.rightToLeft=!1;v={};t.defaultCulture="en-US";t.defaultCurrencyCode="USD";var ui=["numericObject","dateObject"],vf=function(){function n(n){n&&(this.culture=n)}return n.prototype.getDateFormat=function(n){return lr.dateFormat(this.getCulture(),n||{type:"date",skeleton:"short"},v)},n.prototype.getNumberFormat=function(n){return n&&!n.currency&&(n.currency=t.defaultCurrencyCode),u()&&n&&!n.format&&(n.minimumFractionDigits=0),vr.numberFormatter(this.getCulture(),n||{},v)},n.prototype.getDateParser=function(n){return sf.dateParser(this.getCulture(),n||{skeleton:"short",type:"date"},v)},n.prototype.getNumberParser=function(n){return u()&&n&&!n.format&&(n.minimumFractionDigits=0),af.numberParser(this.getCulture(),n||{format:"N"},v)},n.prototype.formatNumber=function(n,t){return this.getNumberFormat(t)(n)},n.prototype.formatDate=function(n,t){return this.getDateFormat(t)(n)},n.prototype.parseDate=function(n,t){return this.getDateParser(t)(n)},n.prototype.parseNumber=function(n,t){return this.getNumberParser(t)(n)},n.prototype.getDatePattern=function(n,i){return t.IntlBase.getActualDateTimeFormat(this.getCulture(),n,v,i)},n.prototype.getNumberPattern=function(n,i){return t.IntlBase.getActualNumberFormat(this.getCulture(),n,v,i)},n.prototype.getFirstDayOfWeek=function(){return t.IntlBase.getWeekData(this.getCulture(),v)},n.prototype.getCulture=function(){return this.culture||t.defaultCulture},n}(),fi={"en-US":{d:"M/d/y",D:"EEEE, MMMM d, y",f:"EEEE, MMMM d, y h:mm a",F:"EEEE, MMMM d, y h:mm:s a",g:"M/d/y h:mm a",G:"M/d/yyyy h:mm:ss tt",m:"MMMM d",M:"MMMM d",r:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",R:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",s:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",t:"h:mm tt",T:"h:m:s tt",u:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",U:"dddd, MMMM d, yyyy h:mm:ss tt",y:"MMMM yyyy",Y:"MMMM yyyy"}};!function(n){function k(t,r,u,o,s){var h,c=u||"date",l,a;return s?h=e({skeleton:t},s).format||e({skeleton:"d"},"en-US").format:(-1!==n.basicPatterns.indexOf(t)?(h=i(c+"Formats."+t,r),"dateTime"===c)&&(l=i("dateFormats."+t,r),a=i("timeFormats."+t,r),h=h.replace("{1}",l).replace("{0}",a)):h=i("dateTimeFormats.availableFormats."+t,r),f(h)&&"yMd"===t&&(h="M/d/y")),h}function a(t,r,f,e){var o={},h=f||"gregorian",s;return(o.parserObject=l.getMainObject(t,r)||(u()?n.blazorDefaultObject:n.defaultObject),e)?o.numericObject=i("numbers",o.parserObject):(s=u()?"dates":"dates.calendars."+h,o.dateObject=i(s,o.parserObject)),o}function v(n,t,r,u){return i(n+"Formats-numberSystem-"+t+(u?".accounting":".standard"),r)||(u?i(n+"Formats-numberSystem-"+t+".standard",r):"")}function d(t){var i=t.match(n.dateConverterMapper),r;return i&&u()?(r=3===i[0].length?"EEE":"EEEE",t.replace(n.dateConverterMapper,r)):t}function e(n,t){var u=n.format||n.skeleton,r=i((t||"en-US")+"."+u,fi);return r||(r=i("en-US."+u,fi)),r&&(r=d(r),n.format=r.replace(/tt/,"a")),n}function y(t){var r=t.match(n.formatRegex),i={},u=r[1].toUpperCase();return i.isAccount="A"===u,i.type=n.patternMatcher[u],t.length>1&&(i.fractionDigits=parseInt(r[2],10)),i}function o(t,i,u,f){var e=f?{}:{nlead:"",nend:""},o=t.match(n.customRegex),s,h;return o&&(f||(e.nlead=p(o[1],u),e.nend=p(o[10],u),e.groupPattern=o[4]),s=o[7],s&&i&&(h=s.match(w),e.minimumFraction=r(h)?0:h.length,e.maximumFraction=s.length-1)),e}function p(t,i){return t?t.replace(n.defaultCurrency,i):""}function g(n,t,r){return i("currencies."+t+(r?"."+r:".symbol"),n)||i("currencies."+t+".symbol-alt-narrow",n)||"$"}function nt(t,i,u){var f={type:"decimal",minimumFractionDigits:0,maximumFractionDigits:0},o=t.match(n.customRegex),e,c,l;return r(o)||""===o[5]&&"N/A"!==t?(f.type=void 0,f):(f.nlead=o[1],f.nend=o[10],e=o[6],f.useGrouping=-1!==e.indexOf(","),e=e.replace(/,/g,""),c=o[7],(-1!==e.indexOf("0")&&(f.minimumIntegerDigits=e.length-e.indexOf("0")),r(c)||(f.minimumFractionDigits=c.lastIndexOf("0"),f.maximumFractionDigits=c.lastIndexOf("#"),-1===f.minimumFractionDigits&&(f.minimumFractionDigits=0),(-1===f.maximumFractionDigits||f.maximumFractionDigits<f.minimumFractionDigits)&&(f.maximumFractionDigits=f.minimumFractionDigits)),r(i)?s(f,h([f.nlead,f.nend],"%","%")):(s(f,h([f.nlead,f.nend],"$",i.currencySymbol)),f.isCurrency||s(f,h([f.nlead,f.nend],"%",i.percentSymbol))),r(u))||(l=v(f.type,i.numberMapper.numberSystem,u,!1),f.useGrouping&&(f.groupSeparator=i.numberMapper.numberSymbols[ut[2]],f.groupData=vr.getGroupingDetails(l.split(";")[0])),f.nlead=f.nlead.replace(/'/g,""),f.nend=f.nend.replace(/'/g,"")),f)}function h(n,t,i){for(var u,f,r={nlead:n[0],nend:n[1]},e=0;e<2;e++)if(u=n[e],f=u.indexOf(t),-1!==f&&(f<u.indexOf("'")||f>u.lastIndexOf("'"))){r[c[e]]=u.substr(0,f)+i+u.substr(f+1);r[c[t]]=!0;r.type=r.isCurrency?"currency":"percent";break}return r}function tt(n,t,i){var r,f,u;for(n+=".",r=0;r<t;r++)n+="0";if(t<i)for(f=i-t,u=0;u<f;u++)n+="#";return n}function it(n,t){for(var r=n.split("."),i="",u=0;u<t;u++)i+="0";return r[1]?i+"."+r[1]:i}function rt(n){var r=n.split("."),t=r[0],u=3-t.length%3,i;for(n="",i=(t=(u&&1===u?"#":2===u?"##":"")+t).length-1;i>0;i-=3)n=","+t[i-2]+t[i-1]+t[i]+n;return n=n.slice(1),r[1]?n+"."+r[1]:n}var w,b,c;n.negativeDataRegex=/^(('[^']+'|''|[^*#@0,.E])*)(\*.)?((([#,]*[0,]*0+)(\.0*[0-9]*#*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/;n.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/;n.latnParseRegex=/0|1|2|3|4|5|6|7|8|9/g;w=/[0-9]/g;n.defaultCurrency="$";var ut=["infinity","nan","group","decimal"],ft=/G|M|L|H|c|'| a|yy|y|EEEE|E/g,et={G:"",M:"m",L:"m",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};n.dateConverterMapper=/dddd|ddd/gi;n.islamicRegex=/^islamic/;b={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};n.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i;n.currencyFormatRegex=/(^[ca]{1})([0-1]?[0-9]|20)?$/i;n.curWithoutNumberRegex=/(c|a)$/gi;c={$:"isCurrency","%":"isPercent","-":"isNegative",0:"nlead",1:"nend"};n.dateParseRegex=/([a-z])\1*|'([^']|'')+'|''|./gi;n.basicPatterns=["short","medium","long","full"];n.defaultObject={dates:{calendars:{gregorian:{months:{"stand-alone":{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},narrow:{1:"J",2:"F",3:"M",4:"A",5:"M",6:"J",7:"J",8:"A",9:"S",10:"O",11:"N",12:"D"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"Before Christ","0-alt-variant":"Before Common Era",1:"Anno Domini","1-alt-variant":"Common Era"},eraAbbr:{0:"BC","0-alt-variant":"BCE",1:"AD","1-alt-variant":"CE"},eraNarrow:{0:"B","0-alt-variant":"BCE",1:"A","1-alt-variant":"CE"}},dateFormats:{full:"EEEE, MMMM d, y",long:"MMMM d, y",medium:"MMM d, y",short:"M/d/yy"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",hmsv:"h:mm:ss a v",Hmsv:"HH:mm:ss v",hmv:"h:mm a v",Hmv:"HH:mm v",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y",yM:"M/y",yMd:"M/d/y",yMEd:"E, M/d/y",yMMM:"MMM y",yMMMd:"MMM d, y",yMMMEd:"E, MMM d, y",yMMMM:"MMMM y"}}},islamic:{months:{"stand-alone":{abbreviated:{1:"Muh.",2:"Saf.",3:"Rab. I",4:"Rab. II",5:"Jum. I",6:"Jum. II",7:"Raj.",8:"Sha.",9:"Ram.",10:"Shaw.",11:"Dhul-Q.",12:"Dhul-H."},narrow:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12"},wide:{1:"Muharram",2:"Safar",3:"Rabi I",4:"Rabi II",5:"Jumada I",6:"Jumada II",7:"Rajab",8:"Shaban",9:"Ramadan",10:"Shawwal",11:"Dhul-Qidah",12:"Dhul-Hijjah"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"AH"},eraAbbr:{0:"AH"},eraNarrow:{0:"AH"}},dateFormats:{full:"EEEE, MMMM d, y G",long:"MMMM d, y G",medium:"MMM d, y G",short:"M/d/y GGGGG"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y G",yyyy:"y G",yyyyM:"M/y GGGGG",yyyyMd:"M/d/y GGGGG",yyyyMEd:"E, M/d/y GGGGG",yyyyMMM:"MMM y G",yyyyMMMd:"MMM d, y G",yyyyMMMEd:"E, MMM d, y G",yyyyMMMM:"MMMM y G",yyyyQQQ:"QQQ y G",yyyyQQQQ:"QQQQ y G"}}}},timeZoneNames:{hourFormat:"+HH:mm;-HH:mm",gmtFormat:"GMT{0}",gmtZeroFormat:"GMT"}},numbers:{currencies:{USD:{displayName:"US Dollar",symbol:"$","symbol-alt-narrow":"$"},EUR:{displayName:"Euro",symbol:"","symbol-alt-narrow":""},GBP:{displayName:"British Pound","symbol-alt-narrow":""}},defaultNumberingSystem:"latn",minimumGroupingDigits:"1","symbols-numberSystem-latn":{decimal:".",group:",",list:";",percentSign:"%",plusSign:"+",minusSign:"-",exponential:"E",superscriptingExponent:"",perMille:"",infinity:"",nan:"NaN",timeSeparator:":"},"decimalFormats-numberSystem-latn":{standard:"#,##0.###"},"percentFormats-numberSystem-latn":{standard:"#,##0%"},"currencyFormats-numberSystem-latn":{standard:"#,##0.00",accounting:"#,##0.00;(#,##0.00)"},"scientificFormats-numberSystem-latn":{standard:"#E0"}}};n.blazorDefaultObject={numbers:{mapper:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},mapperDigits:"0123456789",numberSymbols:{decimal:".",group:",",plusSign:"+",minusSign:"-",percentSign:"%",nan:"NaN",timeSeparator:":",infinity:""},timeSeparator:":",currencySymbol:"$",currencypData:{nlead:"$",nend:"",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentpData:{nlead:"",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentnData:{nlead:"-",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},currencynData:{nlead:"($",nend:")",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalnData:{nlead:"-",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalpData:{nlead:"",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2}},dates:{dayPeriods:{am:"AM",pm:"PM"},dateSeperator:"/",days:{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}},months:{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}},eras:{1:"AD"}}};n.monthIndex={3:"abbreviated",4:"wide",5:"narrow",1:"abbreviated"};n.month="months";n.days="days";n.patternMatcher={C:"currency",P:"percent",N:"decimal",A:"currency",E:"scientific"};n.getResultantPattern=k;n.getDependables=a;n.getSymbolPattern=v;n.ConvertDateToWeekFormat=d;n.compareBlazorDateFormats=e;n.getProperNumericSkeleton=y;n.getFormatData=o;n.changeCurrencySymbol=p;n.getCurrencySymbol=g;n.customFormat=function(n,t,i){for(var u={},e=n.split(";"),o=["pData","nData","zeroData"],f=0;f<e.length;f++)u[o[f]]=nt(e[f],t,i);return r(u.nData)&&(u.nData=s({},u.pData),u.nData.nlead=r(t)?"-"+u.nData.nlead:t.minusSymbol+u.nData.nlead),u};n.customNumberFormat=nt;n.isCurrencyPercent=h;n.getDateSeparator=function(n){var t=(i("dateFormats.short",n)||"").match(/[dM]([^dM])[dM]/i);return t?t[1]:"/"};n.getActualDateTimeFormat=function(n,t,r,f){var v=a(r,n,t.calendar),o,y,c;if(u()&&(t=e(t,n)),o=t.format||k(t.skeleton,v.dateObject,t.type),f){if(-1!==(o=o.replace(ft,function(n){return et[n]})).indexOf("z")){var p=o.match(/z/g).length,h=void 0,s={timeZone:{}};s.numMapper=l.getNumberMapper(v.parserObject,l.getNumberingSystem(r));s.timeZone=i("dates.timeZoneNames",v.parserObject);y=(new Date).getTimezoneOffset();c=p<4?"+H;-H":s.timeZone.hourFormat;c=c.replace(/:/g,s.numMapper.timeSeparator);0===y?h=s.timeZone.gmtZeroFormat:(h=lr.getTimeZoneValue(y,c),h=s.timeZone.gmtFormat.replace(/\{0\}/,h));o=o.replace(/[z]+/,'"'+h+'"')}o=o.replace(/ $/,"")}return o};n.getActualNumberFormat=function(r,f,e,h){var ut,c,b=a(e,r,"",!0),p={custom:!0},k=b.numericObject,w={},st=(f.format||"").match(n.currencyFormatRegex),ht=n.formatRegex.test(f.format)?y(f.format||"N"):{},d={},ot;if(st){d.numberMapper=u()?s({},b.numericObject):l.getNumberMapper(b.parserObject,l.getNumberingSystem(e),!0);var ft=u()?i("currencySymbol",b.numericObject):g(b.numericObject,f.currency||t.defaultCurrencyCode,f.altSymbol),et=v("currency",d.numberMapper.numberSystem,b.numericObject,/a/i.test(f.format)),nt=(et=et.replace(/\u00A4/g,ft)).split(";");w.hasNegativePattern=!!u()||nt.length>1;w.nData=u()?i(ht.type+"nData",k):o(nt[1]||"-"+nt[0],!0,ft);w.pData=u()?i(ht.type+"pData",k):o(nt[0],!1,ft);st[2]||f.minimumFractionDigits||f.maximumFractionDigits||(ut=o(et.split(";")[0],!0,"",!0).minimumFraction)}return n.formatRegex.test(f.format)||!f.format?((s(p,y(f.format||"N")),p.custom=!1,c="###0",p.fractionDigits||f.minimumFractionDigits||f.maximumFractionDigits||ut)&&(p.fractionDigits&&(f.minimumFractionDigits=f.maximumFractionDigits=p.fractionDigits),c=tt(c,ut||p.fractionDigits||f.minimumFractionDigits||0,f.maximumFractionDigits||0)),(f.minimumIntegerDigits&&(c=it(c,f.minimumIntegerDigits)),f.useGrouping&&(c=rt(c)),"currency"===p.type||p.type&&u())&&(u()&&"currency"!==p.type&&(w.pData=i(p.type+"pData",k),w.nData=i(p.type+"nData",k)),ot=c,c=w.pData.nlead+ot+w.pData.nend,(w.hasNegativePattern||u())&&(c+=";"+w.nData.nlead+ot+w.nData.nend)),"percent"!==p.type||u()||(c+=" %")):c=f.format.replace(/'/g,'"'),Object.keys(d).length>0&&(c=h?c:function(n,t){if(-1!==n.indexOf(",")){var r=n.split(",");n=r[0]+i("numberMapper.numberSymbols.group",t)+r[1].replace(".",i("numberMapper.numberSymbols.decimal",t))}else n=n.replace(".",i("numberMapper.numberSymbols.decimal",t));return n}(c,d)),c};n.fractionDigitsPattern=tt;n.minimumIntegerPattern=it;n.groupingPattern=rt;n.getWeekData=function(n,t){var u="sun",f=i("supplemental.weekData.firstDay",t),r=n;return/en-/.test(r)&&(r=r.slice(3)),r=r.slice(0,2).toUpperCase()+r.substr(2),f&&(u=f[r]||"sun"),b[u]};n.replaceBlazorCurrency=function(n,t,r){var e=i(r||"",tf),f,o,u;if(t!==e)for(f=0,o=n;f<o.length;f++)u=o[f],u.nend=u.nend.replace(t,e),u.nlead=u.nlead.replace(t,e)};n.getWeekOfYear=function(n){var r,u=new Date(n.getFullYear(),0,1),t=u.getDay(),f,i;return t=t>=0?t:t+7,f=Math.floor((n.getTime()-u.getTime()-6e4*(n.getTimezoneOffset()-u.getTimezoneOffset()))/864e5)+1,t<4?(r=Math.floor((f+t-1)/7)+1)>52&&(i=new Date(this.getFullYear()+1,0,1).getDay(),r=(i=i>=0?i:i+7)<4?1:53):r=Math.floor((f+t-1)/7),r}}(t.IntlBase||(t.IntlBase={}));var pr=/^(.*?):[ \t]*([^\r\n]*)$/gm,yf=function(){function t(t,i,u,f){this.mode=!0;this.emitError=!0;this.options={};"string"==typeof t?(this.url=t,this.type=i?i.toUpperCase():"GET",this.mode=!!r(u)||u):"object"===n(t)&&(this.options=t,nt(this,this.options));this.type=this.type?this.type.toUpperCase():"GET";this.contentType=void 0!==this.contentType?this.contentType:f}return t.prototype.send=function(n){var t=this,i;return this.data=r(n)?this.data:n,i={cancel:!1,httpRequest:null},new Promise(function(n,u){t.httpRequest=new XMLHttpRequest;t.httpRequest.onreadystatechange=function(){t.stateChange(n,u)};r(t.onLoad)||(t.httpRequest.onload=t.onLoad);r(t.onProgress)||(t.httpRequest.onprogress=t.onProgress);r(t.onAbort)||(t.httpRequest.onabort=t.onAbort);r(t.onError)||(t.httpRequest.onerror=t.onError);r(t.onUploadProgress)||(t.httpRequest.upload.onprogress=t.onUploadProgress);t.httpRequest.open(t.type,t.url,t.mode);r(t.data)||null===t.contentType||t.httpRequest.setRequestHeader("Content-Type",t.contentType||"application/json; charset=utf-8");t.beforeSend&&(i.httpRequest=t.httpRequest,t.beforeSend(i));i.cancel||t.httpRequest.send(r(t.data)?null:t.data)})},t.prototype.successHandler=function(n){return this.onSuccess&&this.onSuccess(n,this),n},t.prototype.failureHandler=function(n){return this.onFailure&&this.onFailure(this.httpRequest),n},t.prototype.stateChange=function(n,t){var i=this.httpRequest.responseText;if(this.dataType&&"json"===this.dataType.toLowerCase())if(""===i)i=void 0;else try{i=JSON.parse(i)}catch(n){}4===this.httpRequest.readyState&&(this.httpRequest.status>=200&&this.httpRequest.status<=299||304===this.httpRequest.status?n(this.successHandler(i)):this.emitError?t(new Error(this.failureHandler(this.httpRequest.statusText))):n())},t.prototype.getResponseHeader=function(n){for(var u,i={},t=pr.exec(this.httpRequest.getAllResponseHeaders());t;)i[t[1].toLowerCase()]=t[2],t=pr.exec(this.httpRequest.getAllResponseHeaders());return r(u=i[n.toLowerCase()])?null:u},t}(),pf=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile/i,wf=/msie|trident/i,bf=/Trident\/7\./,kf=/(ipad|iphone|ipod touch)/i,df=/(ipad|iphone|ipod touch);.*os 7_\d|(ipad|iphone|ipod touch);.*os 8_\d/i,gf=/android/i,ne=/trident|windows phone|edge/i,te=/(version)[ /]([\w.]+)/i,wr={OPERA:/(opera|opr)(?:.*version|)[ /]([\w.]+)/i,EDGE:/(edge)(?:.*version|)[ /]([\w.]+)/i,CHROME:/(chrome|crios)[ /]([\w.]+)/i,PANTHOMEJS:/(phantomjs)[ /]([\w.]+)/i,SAFARI:/(safari)[ /]([\w.]+)/i,WEBKIT:/(webkit)[ /]([\w.]+)/i,MSIE:/(msie|trident) ([\w.]+)/i,MOZILLA:/(mozilla)(?:.*? rv:([\w.]+)|)/i};"undefined"!=typeof window&&(window.browserDetails=window.browserDetails||{});var o=function(){function n(){}return n.extractBrowserDetail=function(){for(var e,u,t={culture:{}},i=[],r=0,f=Object.keys(wr);r<f.length;r++)if(e=f[r],i=n.userAgent.match(wr[e])){if(t.name="opr"===i[1].toLowerCase()?"opera":i[1].toLowerCase(),t.name="crios"===i[1].toLowerCase()?"chrome":t.name,t.version=i[2],t.culture.name=t.culture.language=navigator.language,n.userAgent.match(bf)){t.name="msie";break}u=n.userAgent.match(te);"safari"===t.name&&u&&(t.version=u[2]);break}return t},n.getEvent=function(t){var i={start:{isPointer:"pointerdown",isTouch:"touchstart",isDevice:"mousedown"},move:{isPointer:"pointermove",isTouch:"touchmove",isDevice:"mousemove"},end:{isPointer:"pointerup",isTouch:"touchend",isDevice:"mouseup"},cancel:{isPointer:"pointercancel",isTouch:"touchcancel",isDevice:"mouseleave"}};return n.isPointer?i[t].isPointer:n.isTouch?i[t].isTouch+(n.isDevice?"":" "+i[t].isDevice):i[t].isDevice},n.getTouchStartEvent=function(){return n.getEvent("start")},n.getTouchEndEvent=function(){return n.getEvent("end")},n.getTouchMoveEvent=function(){return n.getEvent("move")},n.getTouchCancelEvent=function(){return n.getEvent("cancel")},n.getValue=function(t,i){var r=window.browserDetails;return void 0===r[t]?r[t]=i.test(n.userAgent):r[t]},Object.defineProperty(n,"userAgent",{get:function(){return n.uA},set:function(t){n.uA=t;window.browserDetails={}},enumerable:!0,configurable:!0}),Object.defineProperty(n,"info",{get:function(){return f(window.browserDetails.info)?window.browserDetails.info=n.extractBrowserDetail():window.browserDetails.info},enumerable:!0,configurable:!0}),Object.defineProperty(n,"isIE",{get:function(){return n.getValue("isIE",wf)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"isTouch",{get:function(){return f(window.browserDetails.isTouch)?window.browserDetails.isTouch="ontouchstart"in window.navigator||window&&window.navigator&&window.navigator.maxTouchPoints>0||"ontouchstart"in window:window.browserDetails.isTouch},enumerable:!0,configurable:!0}),Object.defineProperty(n,"isPointer",{get:function(){return f(window.browserDetails.isPointer)?window.browserDetails.isPointer="pointerEnabled"in window.navigator:window.browserDetails.isPointer},enumerable:!0,configurable:!0}),Object.defineProperty(n,"isMSPointer",{get:function(){return f(window.browserDetails.isMSPointer)?window.browserDetails.isMSPointer="msPointerEnabled"in window.navigator:window.browserDetails.isMSPointer},enumerable:!0,configurable:!0}),Object.defineProperty(n,"isDevice",{get:function(){return n.getValue("isDevice",pf)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"isIos",{get:function(){return n.getValue("isIos",kf)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"isIos7",{get:function(){return n.getValue("isIos7",df)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"isAndroid",{get:function(){return n.getValue("isAndroid",gf)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"isWebView",{get:function(){return f(window.browserDetails.isWebView)?(window.browserDetails.isWebView=!(f(window.cordova)&&f(window.PhoneGap)&&f(window.phonegap)&&"object"!==window.forge),window.browserDetails.isWebView):window.browserDetails.isWebView},enumerable:!0,configurable:!0}),Object.defineProperty(n,"isWindows",{get:function(){return n.getValue("isWindows",ne)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"touchStartEvent",{get:function(){return f(window.browserDetails.touchStartEvent)?window.browserDetails.touchStartEvent=n.getTouchStartEvent():window.browserDetails.touchStartEvent},enumerable:!0,configurable:!0}),Object.defineProperty(n,"touchMoveEvent",{get:function(){return f(window.browserDetails.touchMoveEvent)?window.browserDetails.touchMoveEvent=n.getTouchMoveEvent():window.browserDetails.touchMoveEvent},enumerable:!0,configurable:!0}),Object.defineProperty(n,"touchEndEvent",{get:function(){return f(window.browserDetails.touchEndEvent)?window.browserDetails.touchEndEvent=n.getTouchEndEvent():window.browserDetails.touchEndEvent},enumerable:!0,configurable:!0}),Object.defineProperty(n,"touchCancelEvent",{get:function(){return f(window.browserDetails.touchCancelEvent)?window.browserDetails.touchCancelEvent=n.getTouchCancelEvent():window.browserDetails.touchCancelEvent},enumerable:!0,configurable:!0}),n.uA="undefined"!=typeof navigator?navigator.userAgent:"",n}(),e=function(){function n(){}return n.addOrGetEventData=function(n){return"__eventList"in n?n.__eventList.events:(n.__eventList={},n.__eventList.events=[])},n.add=function(t,i,r,u,f){var e,c=n.addOrGetEventData(t),h,s;for(e=f?er(r,f):r,u&&(e=e.bind(u)),h=i.split(" "),s=0;s<h.length;s++)c.push({name:h[s],listener:r,debounce:e}),o.isIE?t.addEventListener(h[s],e):t.addEventListener(h[s],e,{passive:!1});return e},n.remove=function(t,i,r){for(var u=n.addOrGetEventData(t),f=i.split(" "),o=function(n){var i,e=-1;u&&0!==u.length&&u.some(function(t,u){return t.name===f[n]&&t.listener===r&&(e=u,i=t.debounce,!0)});-1!==e&&u.splice(e,1);i&&t.removeEventListener(f[n],i)},e=0;e<f.length;e++)o(e)},n.clearEvents=function(t){for(var u,i=s([],i,u=n.addOrGetEventData(t)),r=0;r<i.length;r++)t.removeEventListener(i[r].name,i[r].debounce),u.shift()},n.trigger=function(t,i,r){for(var e,u=0,f=n.addOrGetEventData(t);u<f.length;u++)e=f[u],e.name===i&&e.debounce.call(this,r)},n}(),ie=/^svg|^path|^g/;nu=new RegExp("]");w=function(){function n(n,t){this.isRendered=!1;this.isComplexArraySetter=!1;this.isServerRendered=!1;this.allowServerDataBinding=!0;this.isProtectedOnChange=!0;this.properties={};this.changedProperties={};this.oldProperties={};this.bulkChanges={};this.refreshing=!1;this.ignoreCollectionWatch=!1;this.finalUpdate=function(){};this.childChangedProperties={};this.modelObserver=new vt(this);f(t)||(this.element="string"==typeof t?document.querySelector(t):t,r(this.element)||(this.isProtectedOnChange=!1,this.addInstance()));f(n)||this.setProperties(n,!0);this.isDestroyed=!1}return n.prototype.setProperties=function(n,t){var i=this.isProtectedOnChange;this.isProtectedOnChange=!!t;nt(this,n);!0!==t?(nt(this.changedProperties,n),this.dataBind()):u()&&this.isRendered&&this.serverDataBind(n);this.finalUpdate();this.changedProperties={};this.oldProperties={};this.isProtectedOnChange=i},n.callChildDataBind=function(n,t){for(var r,u,e,o,i=0,f=Object.keys(n);i<f.length;i++)if(r=f[i],_instanceof(t[r],Array))for(u=0,e=t[r];u<e.length;u++)o=e[u],void 0!==o.dataBind&&o.dataBind();else t[r].dataBind()},n.prototype.clearChanges=function(){this.finalUpdate();this.changedProperties={};this.oldProperties={};this.childChangedProperties={}},n.prototype.dataBind=function(){if(n.callChildDataBind(this.childChangedProperties,this),Object.getOwnPropertyNames(this.changedProperties).length){var t=this.isProtectedOnChange,i=this.changedProperties,r=this.oldProperties;this.clearChanges();this.isProtectedOnChange=!0;this.onPropertyChanged(i,r);this.isProtectedOnChange=t}},n.prototype.serverDataBind=function(n){u()&&(n=n||{},s(this.bulkChanges,{},n,!0),this.allowServerDataBinding&&window.sfBlazor.updateModel&&(window.sfBlazor.updateModel(this),this.bulkChanges={}))},n.prototype.saveChanges=function(n,t,i){if(u()){var r={};r[n]=t;this.serverDataBind(r)}this.isProtectedOnChange||(this.oldProperties[n]=i,this.changedProperties[n]=t,this.finalUpdate(),this.finalUpdate=ur(this.dataBind.bind(this)))},n.prototype.addEventListener=function(n,t){this.modelObserver.on(n,t)},n.prototype.removeEventListener=function(n,t){this.modelObserver.off(n,t)},n.prototype.trigger=function(n,t,r,u){var e=this,h,s,o,f;if(!0!==this.isDestroyed)return h=this.isProtectedOnChange,this.isProtectedOnChange=!1,s=this.modelObserver.notify(n,t,r,u),nu.test(n)&&(o=i(n,this),o?window.Blazor?(f=o.call(this,t),f&&"function"==typeof f.then?r?f.then(function(n){r&&(n="string"==typeof n&&e.modelObserver.isJson(n)?JSON.parse(n):n,r.call(e,n))}).catch(function(n){u&&(n="string"==typeof n&&e.modelObserver.isJson(n)?JSON.parse(n):n,u.call(e,n))}):s=f:r&&r.call(this,t)):(o.call(this,t),r&&r.call(this,t)):r&&r.call(this,t)),this.isProtectedOnChange=h,s},n.prototype.addInstance=function(){var n="e-"+this.getModuleName().toLowerCase();yt([this.element],["e-lib",n]);r(this.element.ej2_instances)?y("ej2_instances",[this],this.element):this.element.ej2_instances.push(this)},n.prototype.destroy=function(){var n=this;this.element.ej2_instances=this.element.ej2_instances.filter(function(t){return t!==n});pt([this.element],["e-"+this.getModuleName()]);0===this.element.ej2_instances.length&&pt([this.element],["e-lib"]);this.clearChanges();this.modelObserver.destroy();this.isDestroyed=!0},n}();var ai,ve=(ai=function(n,t){return(ai=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ai(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),b=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},ye=function(n){function t(t){var i=n.call(this,t,void 0)||this;return i.easing={ease:"cubic-bezier(0.250, 0.100, 0.250, 1.000)",linear:"cubic-bezier(0.250, 0.250, 0.750, 0.750)",easeIn:"cubic-bezier(0.420, 0.000, 1.000, 1.000)",easeOut:"cubic-bezier(0.000, 0.000, 0.580, 1.000)",easeInOut:"cubic-bezier(0.420, 0.000, 0.580, 1.000)",elasticInOut:"cubic-bezier(0.5,-0.58,0.38,1.81)",elasticIn:"cubic-bezier(0.17,0.67,0.59,1.81)",elasticOut:"cubic-bezier(0.7,-0.75,0.99,1.01)"},i}var i;return ve(t,n),i=t,t.prototype.animate=function(n,t){var r,u,f,e;if(t=t||{},r=this.getModel(t),"string"==typeof n)for(u=0,f=Array.prototype.slice.call(si(n,document));u<f.length;u++)e=f[u],r.element=e,i.delayAnimation(r);else r.element=n,i.delayAnimation(r)},t.stop=function(n,t){var i,r;n.style.animation="";n.removeAttribute("e-animate");i=n.getAttribute("e-animation-id");i&&(r=parseInt(i,10),cancelAnimationFrame(r),n.removeAttribute("e-animation-id"));t&&t.end&&t.end.call(this,t)},t.delayAnimation=function(n){n.delay?setTimeout(function(){i.applyAnimation(n)},n.delay):i.applyAnimation(n)},t.applyAnimation=function(n){var i=this;n.timeStamp=0;var r=0,u=0,t=0,f=n.duration;n.element.setAttribute("e-animate","true");!function e(o){try{if(o){t=0===t?o:t;n.timeStamp=o+n.timeStamp-t;t=o;!r&&n.begin&&n.begin.call(i,n);r+=1;var s=n.timeStamp/r;n.timeStamp<f&&n.timeStamp+s<f&&n.element.getAttribute("e-animate")?(n.element.style.animation=n.name+" "+n.duration+"ms "+n.timingFunction,n.progress&&n.progress.call(i,n),requestAnimationFrame(e)):(cancelAnimationFrame(u),n.element.removeAttribute("e-animation-id"),n.element.removeAttribute("e-animate"),n.element.style.animation="",n.end&&n.end.call(i,n))}else u=requestAnimationFrame(e),n.element.setAttribute("e-animation-id",u.toString())}catch(r){cancelAnimationFrame(u);n.element.removeAttribute("e-animation-id");n.fail&&n.fail.call(i,r)}}()},t.prototype.getModel=function(n){return{name:n.name||this.name,delay:n.delay||this.delay,duration:void 0!==n.duration?n.duration:this.duration,begin:n.begin||this.begin,end:n.end||this.end,fail:n.fail||this.fail,progress:n.progress||this.progress,timingFunction:this.easing[n.timingFunction]?this.easing[n.timingFunction]:n.timingFunction||this.easing[this.timingFunction]}},t.prototype.onPropertyChanged=function(){},t.prototype.getModuleName=function(){return"animation"},t.prototype.destroy=function(){},b([h("FadeIn")],t.prototype,"name",void 0),b([h(400)],t.prototype,"duration",void 0),b([h("ease")],t.prototype,"timingFunction",void 0),b([h(0)],t.prototype,"delay",void 0),b([a()],t.prototype,"progress",void 0),b([a()],t.prototype,"begin",void 0),b([a()],t.prototype,"end",void 0),b([a()],t.prototype,"fail",void 0),t=i=b([it],t)}(w);t.isRippleEnabled=!1;var vi,yi,ou=function(){function n(n){this.loadedModules=[];this.parent=n}return n.prototype.inject=function(n,t){var h=n.length,r,u,o,l,f,s;if(0!==h)for(this.loadedModules.length&&this.clearUnusedModule(n),r=0;r<h;r++)for(var i=n[r],e=0,c=t;e<c.length;e++)u=c[e],o=i.member,u.prototype.getModuleName()!==i.member||this.isModuleLoaded(o)||(l=lt(u,i.args),f=this.getMemberName(o),i.isProperty?y(f,u,this.parent):y(f,l,this.parent),s=i,s.member=f,this.loadedModules.push(s));else this.clean()},n.prototype.clean=function(){for(var r,n=0,t=this.loadedModules;n<t.length;n++)r=t[n],r.isProperty||i(r.member,this.parent).destroy();this.loadedModules=[]},n.prototype.clearUnusedModule=function(n){for(var t,f=this,e=n.map(function(n){return f.getMemberName(n.member)}),r=0,u=this.loadedModules.filter(function(n){return-1===e.indexOf(n.member)});r<u.length;r++)t=u[r],t.isProperty||i(t.member,this.parent).destroy(),this.loadedModules.splice(this.loadedModules.indexOf(t),1),fr(this.parent,t.member)},n.prototype.getMemberName=function(n){return n[0].toLowerCase()+n.substring(1)+"Module"},n.prototype.isModuleLoaded=function(n){for(var t=0,i=this.loadedModules;t<i.length;t++)if(i[t].member===this.getMemberName(n))return!0;return!1},n}(),gt=function(){function n(n,t,r,u){this.isComplexArraySetter=!1;this.properties={};this.changedProperties={};this.childChangedProperties={};this.oldProperties={};this.finalUpdate=function(){};this.callChildDataBind=i("callChildDataBind",w);this.parentObj=n;this.controlParent=this.parentObj.controlParent||this.parentObj;this.propName=t;this.isParentArray=u;this.setProperties(r,!0)}return n.prototype.updateChange=function(n,t){!0===n?this.parentObj.childChangedProperties[t]=n:delete this.parentObj.childChangedProperties[t];this.parentObj.updateChange&&this.parentObj.updateChange(n,this.parentObj.propName)},n.prototype.updateTimeOut=function(){if(this.parentObj.updateTimeOut)this.parentObj.finalUpdate(),this.parentObj.updateTimeOut();else{var n=setTimeout(this.parentObj.dataBind.bind(this.parentObj));this.finalUpdate=function(){clearTimeout(n)}}},n.prototype.clearChanges=function(){this.finalUpdate();this.updateChange(!1,this.propName);this.oldProperties={};this.changedProperties={}},n.prototype.setProperties=function(n,t){!0===t?(nt(this,n),this.updateChange(!1,this.propName),this.clearChanges()):nt(this,n)},n.prototype.dataBind=function(){if(this.callChildDataBind(this.childChangedProperties,this),this.isParentArray){var n=this.parentObj[this.propName].indexOf(this);Object.keys(this.changedProperties).length&&(y(this.propName+"."+n,this.changedProperties,this.parentObj.changedProperties),y(this.propName+"."+n,this.oldProperties,this.parentObj.oldProperties))}else this.parentObj.changedProperties[this.propName]=this.changedProperties,this.parentObj.oldProperties[this.propName]=this.oldProperties;this.clearChanges()},n.prototype.saveChanges=function(n,t,i,r){this.controlParent.isProtectedOnChange||(r||this.serverDataBind(n,t,!0),this.oldProperties[n]=i,this.changedProperties[n]=t,this.updateChange(!0,this.propName),this.finalUpdate(),this.updateTimeOut())},n.prototype.serverDataBind=function(n,t,i,r){var f,e,o,h,s,c;if(u()&&!this.parentObj.isComplexArraySetter){if(e={},o=i?this.getParentKey(!0)+"."+n:n,-1!==o.indexOf("."))for(h=o.split("."),f=e,s=0;s<h.length;s++)c=s===h.length-1,f[h[s]]=c?t:{},f=c?f:f[h[s]];else e[o]={},f=e[o],e[o][n]=t;this.isParentArray&&(f.ejsAction=r||"none");this.controlParent.serverDataBind(e)}},n.prototype.getParentKey=function(n){var i="",r=this.propName,t;return this.isParentArray&&(i=this.parentObj[this.propName].indexOf(this),t=this.parentObj[this.propName].length,t=n?t:t>0?t-1:0,r+=i=-1!==i?"-"+i:"-"+t),this.controlParent!==this.parentObj&&(r=this.parentObj.getParentKey()+"."+this.propName+i),r},n}(),pe=(vi=function(n,t){return(vi=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}vi(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ni=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},pi=0,su=0;t.versionBasedStatePersistence=!1;hu=function(e){function o(n,i){var u=e.call(this,n,i)||this;return u.randomId=or(),u.isStringTemplate=!1,u.needsID=!1,u.isReactHybrid=!1,r(u.enableRtl)&&u.setProperties({enableRtl:t.rightToLeft},!0),r(u.locale)&&u.setProperties({locale:t.defaultCulture},!0),u.moduleLoader=new ou(u),u.localObserver=new vt(u),ft.on("notifyExternalChange",u.detectFunction,u,u.randomId),f(i)||u.appendTo(),u}return pe(o,e),o.prototype.requiredModules=function(){return[]},o.prototype.destroy=function(){this.isDestroyed||(this.enablePersistence&&this.setPersistData(),this.localObserver.destroy(),this.refreshing||(pt([this.element],["e-control"]),this.trigger("destroyed",{cancel:!1}),e.prototype.destroy.call(this),this.moduleLoader.clean(),ft.off("notifyExternalChange",this.detectFunction,this.randomId)))},o.prototype.refresh=function(){this.refreshing=!0;this.moduleLoader.clean();this.destroy();this.clearChanges();this.localObserver=new vt(this);this.preRender();this.injectModules();this.render();this.refreshing=!1},o.prototype.accessMount=function(){this.mount&&!this.isReactHybrid&&this.mount()},o.prototype.getRootElement=function(){return this.isReactHybrid?this.actualElement:this.element},o.prototype.getLocalData=function(){var n=this.getModuleName()+this.element.id;return t.versionBasedStatePersistence?window.localStorage.getItem(n+this.ej2StatePersistenceVersion):window.localStorage.getItem(n)},o.prototype.appendTo=function(n){var u,t;(r(n)||"string"!=typeof n?r(n)||(this.element=n):this.element=kt(n,document),r(this.element))||(u="e-"+this.getModuleName().toLowerCase(),yt([this.element],["e-control",u]),this.isProtectedOnChange=!1,this.needsID&&!this.element.id&&(this.element.id=this.getUniqueID(this.getModuleName())),this.enablePersistence&&(this.mergePersistData(),window.addEventListener("unload",this.setPersistData.bind(this))),t=i("ej2_instances",this.element),t&&-1!==t.indexOf(this)||e.prototype.addInstance.call(this),this.preRender(),this.injectModules(),this.render(),this.mount?this.accessMount():this.trigger("created"))},o.prototype.renderComplete=function(n){u()&&window.sfBlazor.renderComplete(this.element,n);this.isRendered=!0},o.prototype.dataBind=function(){this.injectModules();e.prototype.dataBind.call(this)},o.prototype.on=function(n,t,i){var r,f,u;if("string"==typeof n)this.localObserver.on(n,t,i);else for(r=0,f=n;r<f.length;r++){u=f[r];this.localObserver.on(u.event,u.handler,u.context)}},o.prototype.off=function(n,t){var i,r,u;if("string"==typeof n)this.localObserver.off(n,t);else for(i=0,r=n;i<r.length;i++)u=r[i],this.localObserver.off(u.event,u.handler)},o.prototype.notify=function(n,t){!0!==this.isDestroyed&&this.localObserver.notify(n,t)},o.prototype.getInjectedModules=function(){return this.injectedModules},o.Inject=function(){for(var i,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];for(this.prototype.injectedModules||(this.prototype.injectedModules=[]),i=0;i<n.length;i++)-1===this.prototype.injectedModules.indexOf(n[i])&&this.prototype.injectedModules.push(n[i])},o.prototype.createElement=function(n,t){return g(n,t)},o.prototype.triggerStateChange=function(n,t){this.isReactHybrid&&(this.setState(),this.currentContext={calls:n,args:t})},o.prototype.injectModules=function(){this.injectedModules&&this.injectedModules.length&&this.moduleLoader.inject(this.requiredModules(),this.injectedModules)},o.prototype.detectFunction=function(n){var t=Object.keys(n);t.length&&(this[t[0]]=n[t[0]])},o.prototype.mergePersistData=function(){var n;r(n=t.versionBasedStatePersistence?window.localStorage.getItem(this.getModuleName()+this.element.id+this.ej2StatePersistenceVersion):window.localStorage.getItem(this.getModuleName()+this.element.id))||""===n||this.setProperties(JSON.parse(n),!0)},o.prototype.setPersistData=function(){this.isDestroyed||(t.versionBasedStatePersistence?window.localStorage.setItem(this.getModuleName()+this.element.id+this.ej2StatePersistenceVersion,this.getPersistData()):window.localStorage.setItem(this.getModuleName()+this.element.id,this.getPersistData()))},o.prototype.renderReactTemplates=function(){},o.prototype.clearTemplate=function(){},o.prototype.getUniqueID=function(n){return this.isHistoryChanged()&&(pi=0),yi=this.pageID(location.href),su=history.length,n+"_"+yi+"_"+pi++},o.prototype.pageID=function(n){var t=0,i;if(0===n.length)return t;for(i=0;i<n.length;i++)t=(t<<5)-t+n.charCodeAt(i),t&=t;return Math.abs(t)},o.prototype.isHistoryChanged=function(){return yi!==this.pageID(location.href)||su!==history.length},o.prototype.addOnPersist=function(n){for(var o,r,s=this,u={},t=0,e=n;t<e.length;t++)r=e[t],f(o=i(r,this))||y(r,this.getActualProperties(o),u);return JSON.stringify(u,function(n,t){return s.getActualProperties(t)})},o.prototype.getActualProperties=function(n){return _instanceof(n,gt)?i("properties",n):n},o.prototype.ignoreOnPersist=function(n){return JSON.stringify(this.iterateJsonProperties(this.properties,n))},o.prototype.iterateJsonProperties=function(t,i){for(var r={},o=function(u){var e,o;-1===i.indexOf(u)&&(e=t[u],"object"!==n(e)||_instanceof(e,Array)?r[u]=e:(o=i.filter(function(n){return new RegExp(u+".").test(n)}).map(function(n){return n.replace(u+".","")}),r[u]=f.iterateJsonProperties(f.getActualProperties(e),o)))},f=this,u=0,e=Object.keys(t);u<e.length;u++)o(e[u]);return r},ni([h(!1)],o.prototype,"enablePersistence",void 0),ni([h()],o.prototype,"enableRtl",void 0),ni([h()],o.prototype,"locale",void 0),o=ni([it],o)}(w);"undefined"!=typeof window&&window.addEventListener("popstate",function(){pi=0});var wi,bi,ki,di,cu=(wi=function(n,t){return(wi=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}wi(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),c=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},we={left:0,top:0,bottom:0,right:0},gi={isDragged:!1},lu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return cu(t,n),c([h(0)],t.prototype,"left",void 0),c([h(0)],t.prototype,"top",void 0),t}(gt),be=function(t){function i(n,i){var r=t.call(this,i,n)||this;return r.dragLimit=l.getDefaultPosition(),r.borderWidth=l.getDefaultPosition(),r.padding=l.getDefaultPosition(),r.diffX=0,r.prevLeft=0,r.prevTop=0,r.dragProcessStarted=!1,r.tapHoldTimer=0,r.externalInitialize=!1,r.diffY=0,r.parentScrollX=0,r.parentScrollY=0,r.droppables={},r.bind(),r}var l;return cu(i,t),l=i,i.prototype.bind=function(){this.toggleEvents();o.isIE&&yt([this.element],"e-block-touch");this.droppables[this.scope]={}},i.getDefaultPosition=function(){return s({},we)},i.prototype.toggleEvents=function(n){var t,i;f(this.handle)||(t=kt(this.handle,this.element));i=this.enableTapHold&&o.isDevice&&o.isTouch?this.mobileInitialize:this.initialize;n?e.remove(t||this.element,o.touchStartEvent,i):e.add(t||this.element,o.touchStartEvent,i,this)},i.prototype.mobileInitialize=function(n){var t=this,i=n.currentTarget;this.tapHoldTimer=setTimeout(function(){t.externalInitialize=!0;t.removeTapholdTimer();t.initialize(n,i)},this.tapHoldThreshold);e.add(document,o.touchMoveEvent,this.removeTapholdTimer,this);e.add(document,o.touchEndEvent,this.removeTapholdTimer,this)},i.prototype.removeTapholdTimer=function(){clearTimeout(this.tapHoldTimer);e.remove(document,o.touchMoveEvent,this.removeTapholdTimer);e.remove(document,o.touchEndEvent,this.removeTapholdTimer)},i.prototype.getScrollableParent=function(n,t){return r(n)?null:n[{vertical:"scrollHeight",horizontal:"scrollWidth"}[t]]>n[{vertical:"clientHeight",horizontal:"clientWidth"}[t]]&&("vertical"===t?n.scrollTop>0:n.scrollLeft>0)?("vertical"===t?(this.parentScrollY=this.parentScrollY+(0===this.parentScrollY?n.scrollTop:n.scrollTop-this.parentScrollY),this.tempScrollHeight=n.scrollHeight):(this.parentScrollX=this.parentScrollX+(0===this.parentScrollX?n.scrollLeft:n.scrollLeft-this.parentScrollX),this.tempScrollWidth=n.scrollWidth),r(n)?n:this.getScrollableParent(n.parentNode,t)):this.getScrollableParent(n.parentNode,t)},i.prototype.getScrollableValues=function(){this.parentScrollX=0;this.parentScrollY=0;this.element.classList.contains("e-dialog")&&this.element.classList.contains("e-dlg-modal");this.getScrollableParent(this.element.parentNode,"vertical");this.getScrollableParent(this.element.parentNode,"horizontal")},i.prototype.initialize=function(n,t){var i,s,u,h;if(this.currentStateTarget=n.target,!this.isDragStarted()){if(this.isDragStarted(!0),this.externalInitialize=!1,this.target=n.currentTarget||t,this.dragProcessStarted=!1,this.abort)for(i=this.abort,"string"==typeof i&&(i=[i]),s=0;s<i.length;s++)if(!r(tt(n.target,i[s])))return void(this.isDragStarted()&&this.isDragStarted(!0));this.preventDefault&&!f(n.changedTouches)&&"touchstart"!==n.type&&n.preventDefault();this.element.setAttribute("aria-grabbed","true");u=this.getCoordinates(n);(this.initialPosition={x:u.pageX,y:u.pageY},this.clone)||(h=this.element.getBoundingClientRect(),this.getScrollableValues(),n.clientX===n.pageX&&(this.parentScrollX=0),n.clientY===n.pageY&&(this.parentScrollY=0),this.relativeXPosition=u.pageX-(h.left+this.parentScrollX),this.relativeYPosition=u.pageY-(h.top+this.parentScrollY));this.externalInitialize?this.intDragStart(n):(e.add(document,o.touchMoveEvent,this.intDragStart,this),e.add(document,o.touchEndEvent,this.intDestroy,this));this.toggleEvents(!0);"touchstart"!==n.type&&this.isPreventSelect&&document.body.classList.add("e-prevent-select");this.externalInitialize=!1;e.trigger(document.documentElement,o.touchStartEvent,n)}},i.prototype.intDragStart=function(n){var l,t,a,s,i,v,y,p,c,h,k,d,w,b;if(this.removeTapholdTimer(),l=!f(n.changedTouches),(!l||1===n.changedTouches.length)&&(l&&n.preventDefault(),a=this.getCoordinates(n),s=getComputedStyle(this.element),this.margin={left:parseInt(s.marginLeft,10),top:parseInt(s.marginTop,10),right:parseInt(s.marginRight,10),bottom:parseInt(s.marginBottom,10)},i=this.element,this.clone&&this.dragTarget&&(v=tt(n.target,this.dragTarget),r(v)||(i=v)),this.isReplaceDragEle&&(i=this.currentStateCheck(n.target,i)),this.offset=this.calculateParentPosition(i),this.position=this.getMousePosition(n,this.isDragScroll),y=this.initialPosition.x-a.pageX,p=this.initialPosition.y-a.pageY,Math.sqrt(y*y+p*p)>=this.distance||this.externalInitialize)){if(c=this.getHelperElement(n),!c||r(c))return;h=this.helperElement=c;(this.parentClientRect=this.calculateParentPosition(h.offsetParent),this.dragStart)&&(k={event:n,element:i,target:this.getProperTargetElement(n),bindEvents:u()?this.bindDragEvents.bind(this):null,dragElement:h},this.trigger("dragStart",k));this.dragArea?this.setDragArea():(this.dragLimit={left:0,right:0,bottom:0,top:0},this.borderWidth={top:0,left:0});t={left:this.position.left-this.parentClientRect.left,top:this.position.top-this.parentClientRect.top};this.clone&&!this.enableTailMode&&(this.diffX=this.position.left-this.offset.left,this.diffY=this.position.top-this.offset.top);this.getScrollableValues();d=getComputedStyle(i);w=parseFloat(d.marginTop);this.clone&&0!==w&&(t.top+=w);this.enableScrollHandler&&!this.clone&&(t.top-=this.parentScrollY,t.left-=this.parentScrollX);b=this.getProcessedPositionValue({top:t.top-this.diffY+"px",left:t.left-this.diffX+"px"});this.dragElePosition={top:t.top,left:t.left};hi(h,this.getDragPosition({position:"absolute",left:b.left,top:b.top}));e.remove(document,o.touchMoveEvent,this.intDragStart);e.remove(document,o.touchEndEvent,this.intDestroy);u()||this.bindDragEvents(h)}},i.prototype.bindDragEvents=function(n){ei(n)?(e.add(document,o.touchMoveEvent,this.intDrag,this),e.add(document,o.touchEndEvent,this.intDragStop,this),this.setGlobalDroppables(!1,this.element,n)):(this.toggleEvents(),document.body.classList.remove("e-prevent-select"))},i.prototype.elementInViewport=function(n){for(this.top=n.offsetTop,this.left=n.offsetLeft,this.width=n.offsetWidth,this.height=n.offsetHeight;n.offsetParent;)n=n.offsetParent,this.top+=n.offsetTop,this.left+=n.offsetLeft;return this.top>=window.pageYOffset&&this.left>=window.pageXOffset&&this.top+this.height<=window.pageYOffset+window.innerHeight&&this.left+this.width<=window.pageXOffset+window.innerWidth},i.prototype.getProcessedPositionValue=function(n){return this.queryPositionInfo?this.queryPositionInfo(n):n},i.prototype.calculateParentPosition=function(n){if(r(n))return{left:0,top:0};var t=n.getBoundingClientRect(),i=getComputedStyle(n);return{left:t.left+window.pageXOffset-parseInt(i.marginLeft,10),top:t.top+window.pageYOffset-parseInt(i.marginTop,10)}},i.prototype.intDrag=function(n){var s,u,p,w,nt,e,b,c,k,d,i,v,o,y,g,ut;if(f(n.changedTouches)||1===n.changedTouches.length){this.position=this.getMousePosition(n,this.isDragScroll);p=this.getDocumentWidthHeight("Height");p<this.position.top&&(this.position.top=p);w=this.getDocumentWidthHeight("Width");(w<this.position.left&&(this.position.left=w),this.drag)&&(nt=this.getProperTargetElement(n),this.trigger("drag",{event:n,element:this.element,target:nt}));e=this.checkTargetElement(n);e.target&&e.instance?(b=!0,this.hoverObject&&(this.hoverObject.instance!==e.instance?this.triggerOutFunction(n,e):b=!1),b&&(e.instance.dragData[this.scope]=this.droppables[this.scope],e.instance.intOver(n,e.target),this.hoverObject=e)):this.hoverObject&&this.triggerOutFunction(n,e);c=this.droppables[this.scope].helper;this.parentClientRect=this.calculateParentPosition(this.helperElement.offsetParent);var ft=this.parentClientRect.left,et=this.parentClientRect.top,tt=this.getCoordinates(n),it=tt.pageX,rt=tt.pageY,h=this.position.left-this.diffX,t=this.position.top-this.diffY,l=getComputedStyle(c),a=parseFloat(l.marginTop);this.dragArea?((this.pageX!==it||this.skipDistanceCheck)&&(k=c.offsetWidth+(parseFloat(l.marginLeft)+parseFloat(l.marginRight)),s=this.dragLimit.left>h&&h>0?this.dragLimit.left:this.dragLimit.right+window.pageXOffset<h+k&&h>0?h-(h-this.dragLimit.right)+window.pageXOffset-k:h<0?this.dragLimit.left:h),(this.pageY!==rt||this.skipDistanceCheck)&&(d=c.offsetHeight+(parseFloat(l.marginTop)+parseFloat(l.marginBottom)),u=this.dragLimit.top>t&&t>0?this.dragLimit.top:this.dragLimit.bottom+window.pageYOffset<t+d&&t>0?t-(t-this.dragLimit.bottom)+window.pageYOffset-d:t<0?this.dragLimit.top:t)):(s=h,u=t);o=et+this.borderWidth.top;y=ft+this.borderWidth.left;(this.dragProcessStarted&&(r(u)&&(u=this.prevTop),r(s)&&(s=this.prevLeft)),this.dragArea)?(this.dragLimit.top=this.clone?this.dragLimit.top:0,i=u-o<0?this.dragLimit.top:u-o,v=s-y<0?this.dragElePosition.left:s-y,a>0&&(this.clone&&(i+=this.element.offsetTop,t<0&&(this.element.offsetTop+t>=0?i=this.element.offsetTop+t:i-=this.element.offsetTop),i=this.dragLimit.bottom<i?this.dragLimit.bottom:i),u-o<0))&&(t+a+(c.offsetHeight-o)>=0?(g=this.dragLimit.top+t-o,g+a+o<0?i-=a+o:i=g):i-=a+o):(i=u-o,v=s-y);this.enableScrollHandler&&!this.clone&&(i-=this.parentScrollY,v-=this.parentScrollX);ut=this.getProcessedPositionValue({top:i+"px",left:v+"px"});hi(c,this.getDragPosition(ut));!this.elementInViewport(c)&&this.enableAutoScroll&&this.helperElement.scrollIntoView();this.dragProcessStarted=!0;this.prevLeft=s;this.prevTop=u;this.position.left=s;this.position.top=u;this.pageX=it;this.pageY=rt}},i.prototype.triggerOutFunction=function(n,t){this.hoverObject.instance.intOut(n,t.target);this.hoverObject.instance.dragData[this.scope]=null;this.hoverObject=null},i.prototype.getDragPosition=function(n){var t=s({},n);return this.axis&&("x"===this.axis?delete t.top:"y"===this.axis&&delete t.left),t},i.prototype.getDocumentWidthHeight=function(n){var i=document.body,t=document.documentElement;return Math.max(i["scroll"+n],t["scroll"+n],i["offset"+n],t["offset"+n],t["client"+n])},i.prototype.intDragStop=function(n){var i,t;(this.dragProcessStarted=!1,f(n.changedTouches)||1===n.changedTouches.length)&&(-1!==["touchend","pointerup","mouseup"].indexOf(n.type)?(this.dragStop&&(i=this.getProperTargetElement(n),this.trigger("dragStop",{event:n,element:this.element,target:i,helper:this.helperElement})),this.intDestroy(n)):this.element.setAttribute("aria-grabbed","false"),t=this.checkTargetElement(n),t.target&&t.instance&&(t.instance.dragStopCalled=!0,t.instance.dragData[this.scope]=this.droppables[this.scope],t.instance.intDrop(n,t.target)),this.setGlobalDroppables(!0),document.body.classList.remove("e-prevent-select"))},i.prototype.intDestroy=function(){this.dragProcessStarted=!1;this.toggleEvents();document.body.classList.remove("e-prevent-select");this.element.setAttribute("aria-grabbed","false");e.remove(document,o.touchMoveEvent,this.intDragStart);e.remove(document,o.touchEndEvent,this.intDragStop);e.remove(document,o.touchEndEvent,this.intDestroy);e.remove(document,o.touchMoveEvent,this.intDrag);this.isDragStarted()&&this.isDragStarted(!0)},i.prototype.onPropertyChanged=function(){},i.prototype.getModuleName=function(){return"draggable"},i.prototype.isDragStarted=function(n){return n&&(gi.isDragged=!gi.isDragged),gi.isDragged},i.prototype.setDragArea=function(){var e,o,t,s=0,r=0,i;if(t="string"===n(this.dragArea)?kt(this.dragArea):this.dragArea){i=t.getBoundingClientRect();e=t.scrollWidth?t.scrollWidth:i.right-i.left;o=t.scrollHeight?t.scrollHeight:i.bottom-i.top;for(var h=["Top","Left","Bottom","Right"],c=getComputedStyle(t),u=0;u<h.length;u++){var f=h[u],l=c["border"+f+"Width"],a=c["padding"+f],v=f.toLowerCase();this.borderWidth[v]=isNaN(parseFloat(l))?0:parseFloat(l);this.padding[v]=isNaN(parseFloat(a))?0:parseFloat(a)}s=i.top;r=i.left;this.dragLimit.left=r+this.borderWidth.left+this.padding.left;this.dragLimit.top=t.offsetTop+this.borderWidth.top+this.padding.top;this.dragLimit.right=r+e-(this.borderWidth.right+this.padding.right);this.dragLimit.bottom=s+o-(this.borderWidth.bottom+this.padding.bottom)}},i.prototype.getProperTargetElement=function(n){var t,i=this.getCoordinates(n),r=this.helperElement.style.pointerEvents||"";return bt(n.target,this.helperElement)||-1!==n.type.indexOf("touch")?(this.helperElement.style.pointerEvents="none",t=document.elementFromPoint(i.clientX,i.clientY),this.helperElement.style.pointerEvents=r):t=n.target,t},i.prototype.currentStateCheck=function(n,t){return r(this.currentStateTarget)||this.currentStateTarget===n?r(t)?n:t:this.currentStateTarget},i.prototype.getMousePosition=function(n,t){var u,f,e=void 0!==n.srcElement?n.srcElement:n.target,i=this.getCoordinates(n),o=r(e.offsetParent);return t?(u=this.clone?i.pageX:i.pageX+(o?0:e.offsetParent.scrollLeft)-this.relativeXPosition,f=this.clone?i.pageY:i.pageY+(o?0:e.offsetParent.scrollTop)-this.relativeYPosition):(u=this.clone?i.pageX:i.pageX+window.pageXOffset-this.relativeXPosition,f=this.clone?i.pageY:i.pageY+window.pageYOffset-this.relativeYPosition),this.clone||!this.dragArea||t||(this.getScrollableValues(),f-=this.tempScrollHeight?this.parentScrollY:0,u-=this.tempScrollWidth?this.parentScrollX:0),{left:u-(this.margin.left+this.cursorAt.left),top:f-(this.margin.top+this.cursorAt.top)}},i.prototype.getCoordinates=function(n){return n.type.indexOf("touch")>-1?n.changedTouches[0]:n},i.prototype.getHelperElement=function(n){var t;return this.clone?this.helper?t=this.helper({sender:n,element:this.target}):(t=g("div",{className:"e-drag-helper e-block-touch",innerHTML:"Draggable"}),document.body.appendChild(t)):t=this.element,t},i.prototype.setGlobalDroppables=function(n,t,i){this.droppables[this.scope]=n?null:{draggable:t,helper:i,draggedElement:this.element}},i.prototype.checkTargetElement=function(n){var t=this.getProperTargetElement(n),i=this.getDropInstance(t),u;return i||!t||r(t.parentNode)||(u=tt(t.parentNode,".e-droppable")||t.parentElement,u&&(i=this.getDropInstance(u))),{target:t,instance:i}},i.prototype.getDropInstance=function(n){var u,f=n&&n.ej2_instances,t,i,r;if(f)for(t=0,i=f;t<i.length;t++)if(r=i[t],"droppable"===r.getModuleName()){u=r;break}return u},i.prototype.destroy=function(){this.toggleEvents(!0);t.prototype.destroy.call(this)},c([li({},lu)],i.prototype,"cursorAt",void 0),c([h(!0)],i.prototype,"clone",void 0),c([h()],i.prototype,"dragArea",void 0),c([h()],i.prototype,"isDragScroll",void 0),c([h()],i.prototype,"isReplaceDragEle",void 0),c([h(!0)],i.prototype,"isPreventSelect",void 0),c([a()],i.prototype,"drag",void 0),c([a()],i.prototype,"dragStart",void 0),c([a()],i.prototype,"dragStop",void 0),c([h(1)],i.prototype,"distance",void 0),c([h()],i.prototype,"handle",void 0),c([h()],i.prototype,"abort",void 0),c([h()],i.prototype,"helper",void 0),c([h("default")],i.prototype,"scope",void 0),c([h("")],i.prototype,"dragTarget",void 0),c([h()],i.prototype,"axis",void 0),c([h()],i.prototype,"queryPositionInfo",void 0),c([h(!1)],i.prototype,"enableTailMode",void 0),c([h(!1)],i.prototype,"skipDistanceCheck",void 0),c([h(!0)],i.prototype,"preventDefault",void 0),c([h(!1)],i.prototype,"enableAutoScroll",void 0),c([h(!1)],i.prototype,"enableTapHold",void 0),c([h(750)],i.prototype,"tapHoldThreshold",void 0),c([h(!1)],i.prototype,"enableScrollHandler",void 0),i=l=c([it],i)}(w),ke=(bi=function(n,t){return(bi=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}bi(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),st=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},de=function(n){function t(t,i){var r=n.call(this,i,t)||this;return r.mouseOver=!1,r.dragData={},r.dragStopCalled=!1,r.bind(),r}return ke(t,n),t.prototype.bind=function(){this.wireEvents()},t.prototype.wireEvents=function(){e.add(this.element,o.touchEndEvent,this.intDrop,this)},t.prototype.onPropertyChanged=function(){},t.prototype.getModuleName=function(){return"droppable"},t.prototype.intOver=function(n,t){if(!this.mouseOver){var i=this.dragData[this.scope];this.trigger("over",{event:n,target:t,dragData:i});this.mouseOver=!0}},t.prototype.intOut=function(n,t){this.mouseOver&&(this.trigger("out",{evt:n,target:t}),this.mouseOver=!1)},t.prototype.intDrop=function(n,t){if(this.dragStopCalled){this.dragStopCalled=!1;var r,u=!0,i=this.dragData[this.scope],f=!!i&&i.helper&&ei(i.helper);f&&(r=this.isDropArea(n,i.helper,t),this.accept&&(u=ci(i.helper,this.accept)));f&&this.drop&&r.canDrop&&u&&this.trigger("drop",{event:n,target:r.target,droppedElement:i.helper,dragData:i});this.mouseOver=!1}},t.prototype.isDropArea=function(n,t,i){var r={canDrop:!0,target:i||n.target},e="touchend"===n.type,u,f;return(e||r.target===t)&&(t.style.display="none",u=e?n.changedTouches[0]:n,f=document.elementFromPoint(u.clientX,u.clientY),r.canDrop=!1,r.canDrop=bt(f,this.element),r.canDrop&&(r.target=f),t.style.display=""),r},t.prototype.destroy=function(){e.remove(this.element,o.touchEndEvent,this.intDrop);n.prototype.destroy.call(this)},st([h()],t.prototype,"accept",void 0),st([h("default")],t.prototype,"scope",void 0),st([a()],t.prototype,"drop",void 0),st([a()],t.prototype,"over",void 0),st([a()],t.prototype,"out",void 0),t=st([it],t)}(w),ge=(ki=function(n,t){return(ki=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ki(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ti=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},no={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,"delete":46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222},to=function(n){function t(t,r){var u=n.call(this,r,t)||this;return u.keyPressHandler=function(n){for(var h,t,c=n.altKey,l=n.ctrlKey,a=n.shiftKey,v=n.which,r=0,e=Object.keys(u.keyConfigs);r<e.length;r++)for(var o=e[r],f=0,s=u.keyConfigs[o].split(",");f<s.length;f++)h=s[f],t=i.getKeyConfigData(h.trim()),c===t.altKey&&l===t.ctrlKey&&a===t.shiftKey&&v===t.keyCode&&(n.action=o,u.keyAction&&u.keyAction(n))},u.bind(),u}var i;return ge(t,n),i=t,t.prototype.destroy=function(){this.unwireEvents();n.prototype.destroy.call(this)},t.prototype.onPropertyChanged=function(){},t.prototype.bind=function(){this.wireEvents()},t.prototype.getModuleName=function(){return"keyboard"},t.prototype.wireEvents=function(){this.element.addEventListener(this.eventName,this.keyPressHandler)},t.prototype.unwireEvents=function(){this.element.removeEventListener(this.eventName,this.keyPressHandler)},t.getKeyConfigData=function(n){if(n in this.configCache)return this.configCache[n];var t=n.toLowerCase().split("+"),r={altKey:-1!==t.indexOf("alt"),ctrlKey:-1!==t.indexOf("ctrl"),shiftKey:-1!==t.indexOf("shift"),keyCode:null};return r.keyCode=t[t.length-1].length>1&&Number(t[t.length-1])?Number(t[t.length-1]):i.getKeyCode(t[t.length-1]),i.configCache[n]=r,r},t.getKeyCode=function(n){return no[n]||n.toUpperCase().charCodeAt(0)},t.configCache={},ti([h({})],t.prototype,"keyConfigs",void 0),ti([h("keyup")],t.prototype,"eventName",void 0),ti([a()],t.prototype,"keyAction",void 0),t=i=ti([it],t)}(w),io=function(){function n(n,i,r){this.controlName=n;this.localeStrings=i;this.setLocale(r||t.defaultCulture)}return n.prototype.setLocale=function(t){var i=this.intGetControlConstant(n.locale,t);this.currentLocale=i||this.localeStrings},n.load=function(n){this.locale=s(this.locale,n,{},!0)},n.prototype.getConstant=function(n){return r(this.currentLocale[n])?this.localeStrings[n]||"":this.currentLocale[n]},n.prototype.intGetControlConstant=function(n,t){return n[t]?n[t][this.controlName]:null},n.locale={},n}(),au=(di=function(n,t){return(di=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}di(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),k=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},vu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return au(t,n),k([h(50)],t.prototype,"swipeThresholdDistance",void 0),t}(gt),ro=/(Up|Down)/,uo=function(n){function t(t,i){var r=n.call(this,i,t)||this;return r.touchAction=!0,r.tapCount=0,r.startEvent=function(n){if(!0===r.touchAction){var t=r.updateChangeTouches(n);void 0!==n.changedTouches&&(r.touchAction=!1);r.isTouchMoved=!1;r.movedDirection="";r.startPoint=r.lastMovedPoint={clientX:t.clientX,clientY:t.clientY};r.startEventData=t;r.hScrollLocked=r.vScrollLocked=!1;r.tStampStart=Date.now();r.timeOutTapHold=setTimeout(function(){r.tapHoldEvent(n)},r.tapHoldThreshold);e.add(r.element,o.touchMoveEvent,r.moveEvent,r);e.add(r.element,o.touchEndEvent,r.endEvent,r);e.add(r.element,o.touchCancelEvent,r.cancelEvent,r)}},r.moveEvent=function(n){var t=r.updateChangeTouches(n),i;r.movedPoint=t;r.isTouchMoved=!(t.clientX===r.startPoint.clientX&&t.clientY===r.startPoint.clientY);i={};r.isTouchMoved&&(clearTimeout(r.timeOutTapHold),r.calcScrollPoints(n),i=s(i,{},{startEvents:r.startEventData,originalEvent:n,startX:r.startPoint.clientX,startY:r.startPoint.clientY,distanceX:r.distanceX,distanceY:r.distanceY,scrollDirection:r.scrollDirection,velocity:r.getVelocity(t)}),r.trigger("scroll",i),r.lastMovedPoint={clientX:t.clientX,clientY:t.clientY})},r.cancelEvent=function(n){clearTimeout(r.timeOutTapHold);clearTimeout(r.timeOutTap);r.tapCount=0;r.swipeFn(n);e.remove(r.element,o.touchCancelEvent,r.cancelEvent)},r.endEvent=function(n){r.swipeFn(n);r.isTouchMoved||"function"==typeof r.tap&&(r.trigger("tap",{originalEvent:n,tapCount:++r.tapCount}),r.timeOutTap=setTimeout(function(){r.tapCount=0},r.tapThreshold));r.modeclear()},r.swipeFn=function(n){var h,f,e;clearTimeout(r.timeOutTapHold);clearTimeout(r.timeOutTap);var i=r.updateChangeTouches(n),t=i.clientX-r.startPoint.clientX,u=i.clientY-r.startPoint.clientY;if(t=Math.floor(t<0?-1*t:t),u=Math.floor(u<0?-1*u:t),r.isTouchMoved=t>1||u>1,r.endPoint=i,r.calcPoints(n),h={originalEvent:n,startEvents:r.startEventData,startX:r.startPoint.clientX,startY:r.startPoint.clientY,distanceX:r.distanceX,distanceY:r.distanceY,swipeDirection:r.movedDirection,velocity:r.getVelocity(i)},r.isTouchMoved){f=void 0;e=r.swipeSettings.swipeThresholdDistance;f=s(f,r.defaultArgs,h);var c=!1,l=r.element,a=r.isScrollable(l),o=ro.test(r.movedDirection);(e<r.distanceX&&!o||e<r.distanceY&&o)&&(c=!a||r.checkSwipe(l,o));c&&r.trigger("swipe",f)}r.modeclear()},r.modeclear=function(){r.modeClear=setTimeout(function(){r.touchAction=!0},"function"!=typeof r.tap?0:20);r.lastTapTime=(new Date).getTime();e.remove(r.element,o.touchMoveEvent,r.moveEvent);e.remove(r.element,o.touchEndEvent,r.endEvent);e.remove(r.element,o.touchCancelEvent,r.cancelEvent)},r.bind(),r}return au(t,n),t.prototype.onPropertyChanged=function(){},t.prototype.bind=function(){this.wireEvents();o.isIE&&this.element.classList.add("e-block-touch")},t.prototype.destroy=function(){this.unwireEvents();n.prototype.destroy.call(this)},t.prototype.wireEvents=function(){e.add(this.element,o.touchStartEvent,this.startEvent,this)},t.prototype.unwireEvents=function(){e.remove(this.element,o.touchStartEvent,this.startEvent)},t.prototype.getModuleName=function(){return"touch"},t.prototype.isScrollable=function(n){var t=getComputedStyle(n),i=t.overflow+t.overflowX+t.overflowY;return!!/(auto|scroll)/.test(i)},t.prototype.tapHoldEvent=function(n){var t;this.tapCount=0;this.touchAction=!0;e.remove(this.element,o.touchMoveEvent,this.moveEvent);e.remove(this.element,o.touchEndEvent,this.endEvent);t={originalEvent:n};this.trigger("tapHold",t);e.remove(this.element,o.touchCancelEvent,this.cancelEvent)},t.prototype.calcPoints=function(n){var t=this.updateChangeTouches(n);this.defaultArgs={originalEvent:n};this.distanceX=Math.abs(Math.abs(t.clientX)-Math.abs(this.startPoint.clientX));this.distanceY=Math.abs(Math.abs(t.clientY)-Math.abs(this.startPoint.clientY));this.movedDirection=this.distanceX>this.distanceY?t.clientX>this.startPoint.clientX?"Right":"Left":t.clientY<this.startPoint.clientY?"Up":"Down"},t.prototype.calcScrollPoints=function(n){var t=this.updateChangeTouches(n);this.defaultArgs={originalEvent:n};this.distanceX=Math.abs(Math.abs(t.clientX)-Math.abs(this.lastMovedPoint.clientX));this.distanceY=Math.abs(Math.abs(t.clientY)-Math.abs(this.lastMovedPoint.clientY));(this.distanceX>this.distanceY||!0===this.hScrollLocked)&&!1===this.vScrollLocked?(this.scrollDirection=t.clientX>this.lastMovedPoint.clientX?"Right":"Left",this.hScrollLocked=!0):(this.scrollDirection=t.clientY<this.lastMovedPoint.clientY?"Up":"Down",this.vScrollLocked=!0)},t.prototype.getVelocity=function(n){var r=n.clientX,u=n.clientY,f=Date.now(),t=r-this.startPoint.clientX,i=u-this.startPoint.clientX,e=f-this.tStampStart;return Math.sqrt(t*t+i*i)/e},t.prototype.checkSwipe=function(n,t){var i=["scroll","offset"],r=t?["Height","Top"]:["Width","Left"];return n[i[0]+r[0]]<=n[i[1]+r[0]]||0===n[i[0]+r[1]]||n[i[1]+r[0]]+n[i[0]+r[1]]>=n[i[0]+r[0]]},t.prototype.updateChangeTouches=function(n){return n.changedTouches&&0!==n.changedTouches.length?n.changedTouches[0]:n},k([a()],t.prototype,"tap",void 0),k([a()],t.prototype,"tapHold",void 0),k([a()],t.prototype,"swipe",void 0),k([a()],t.prototype,"scroll",void 0),k([h(350)],t.prototype,"tapThreshold",void 0),k([h(750)],t.prototype,"tapHoldThreshold",void 0),k([li({},vu)],t.prototype,"swipeSettings",void 0),t=k([it],t)}(w),fo=new RegExp("\\n|\\r|\\s\\s+","g"),eo=new RegExp(/'|"/g),oo=new RegExp("if ?\\("),so=new RegExp("else if ?\\("),yu=new RegExp("else"),ho=new RegExp("for ?\\("),pu=new RegExp("(/if|/for)"),co=new RegExp("\\((.*)\\)",""),nr=new RegExp("^[0-9]+$","g"),lo=new RegExp("[\\w\"'.\\s+]+","g"),ao=new RegExp('"(.*?)"',"g"),vo=new RegExp("[\\w\"'@#$.\\s-+]+","g"),yo=new RegExp("\\${([^}]*)}","g"),po=/^\..*/gm,tr=/\\/gi,wo=/\\\\/gi,bo=new RegExp("[\\w\"'@#$.\\s+]+","g"),ko=/\window\./gm;var ns=/^[\n\r.]+<tr|^<tr/,ts=/^[\n\r.]+<svg|^<path|^<g/,d={};var rr={compile:(new(function(){function n(){}return n.prototype.compile=function(n,t){return void 0===t&&(t={}),go(n,t)},n}())).compile},is=["script","style","iframe[src]",'link[href*="javascript:"]','object[type="text/x-scriptlet"]','object[data^="data:text/html;base64"]','img[src^="data:text/html;base64"]','[src^="javascript:"]','[dynsrc^="javascript:"]','[lowsrc^="javascript:"]','[type^="application/x-shockwave-flash"]'],rs=[{attribute:"href",selector:'[href*="javascript:"]'},{attribute:"background",selector:'[background^="javascript:"]'},{attribute:"style",selector:'[style*="javascript:"]'},{attribute:"style",selector:'[style*="expression("]'},{attribute:"href",selector:'a[href^="data:text/html;base64"]'}],du=["onchange","onclick","onmouseover","onmouseout","onkeydown","onload","onerror","onblur","onfocus","onbeforeload","onbeforeunload","onkeyup","onsubmit","onafterprint","onbeforeonload","onbeforeprint","onblur","oncanplay","oncanplaythrough","onchange","onclick","oncontextmenu","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onerror","onfocus","onformchange","onforminput","onhaschange","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onoffline","onoine","ononline","onpagehide","onpageshow","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreadystatechange","onredo","onresize","onscroll","onseeked","onseeking","onselect","onstalled","onstorage","onsubmit","onsuspend","ontimeupdate","onundo","onunload","onvolumechange","onwaiting","onmouseenter","onmouseleave","onmousewheel","onstart","onpropertychange"],us=function(){function n(){}return n.beforeSanitize=function(){return{selectors:{tags:is,attributes:rs}}},n.sanitize=function(n){var t=this.beforeSanitize();return this.serializeValue(t,n)},n.serializeValue=function(n,t){this.removeAttrs=n.selectors.attributes;this.removeTags=n.selectors.tags;this.wrapElement=document.createElement("div");this.wrapElement.innerHTML=t;this.removeXssTags();this.removeJsEvents();this.removeXssAttrs();var i=this.wrapElement.innerHTML;return this.removeElement(),i},n.removeElement=function(){for(var r,t,i=this.wrapElement.children,n=0;n<i.length;n++)for(r=i[n].attributes,t=0;t<r.length;t++)this.wrapElement.children[n].removeAttribute(r[t].localName)},n.removeXssTags=function(){var n=this.wrapElement.querySelectorAll(this.removeTags.join(","));n.length>0&&n.forEach(function(n){oi(n)})},n.removeJsEvents=function(){var n=this.wrapElement.querySelectorAll("["+du.join("],[")+"]");n.length>0&&n.forEach(function(n){du.forEach(function(t){n.hasAttribute(t)&&n.removeAttribute(t)})})},n.removeXssAttrs=function(){var n=this;this.removeAttrs.forEach(function(t){var i=n.wrapElement.querySelectorAll(t.selector);i.length>0&&i.forEach(function(n){n.removeAttribute(t.attribute)})})},n}();return t.blazorCultureFormats=fi,t.Ajax=yf,t.Animation=ye,t.rippleEffect=function(n,i,r){var u=function(n){return{selector:n&&n.selector?n.selector:null,ignore:n&&n.ignore?n.ignore:null,rippleFlag:n&&n.rippleFlag,isCenterRipple:n&&n.isCenterRipple,duration:n&&n.duration?n.duration:350}}(i);return!1===u.rippleFlag||void 0===u.rippleFlag&&!t.isRippleEnabled?Function:(n.setAttribute("data-ripple","true"),e.add(n,"mousedown",uu,{parent:n,rippleOptions:u}),e.add(n,"mouseup",fu,{parent:n,rippleOptions:u,done:r}),e.add(n,"mouseleave",ot,{parent:n,rippleOptions:u}),o.isPointer&&e.add(n,"transitionend",ot,{parent:n,rippleOptions:u}),function(){n.removeAttribute("data-ripple");e.remove(n,"mousedown",uu);e.remove(n,"mouseup",fu);e.remove(n,"mouseleave",ot);e.remove(n,"transitionend",ot)})},t.enableRipple=function(n){return t.isRippleEnabled=n,t.isRippleEnabled},t.Base=w,t.getComponent=tu,t.removeChildInstance=function(n){for(var u,r,i=[].slice.call(n.getElementsByClassName("e-control")),t=0;t<i.length;t++)u=i[t].classList[1].split("e-")[1],r=tu(i[t],u),f(r)||r.destroy()},t.Browser=o,t.enableVersionBasedPersistence=function(n){t.versionBasedStatePersistence=n},t.Component=hu,t.ChildProperty=gt,t.Position=lu,t.Draggable=be,t.Droppable=de,t.EventHandler=e,t.onIntlChange=ft,t.cldrData=v,t.Internationalization=vf,t.setCulture=function(n){t.defaultCulture=n;ft.notify("notifyExternalChange",{locale:t.defaultCulture})},t.setCurrencyCode=function(n){t.defaultCurrencyCode=n;ft.notify("notifyExternalChange",{currencyCode:t.defaultCurrencyCode})},t.loadCldr=function(){for(var t,r,u,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];for(t=0,r=i;t<r.length;t++)u=r[t],s(v,u,{},!0)},t.enableRtl=function(n){void 0===n&&(n=!0);t.rightToLeft=n;ft.notify("notifyExternalChange",{enableRtl:t.rightToLeft})},t.getNumericObject=function(n,r){var f=t.IntlBase.getDependables(v,n,"",!0)[ui[0]],o=t.IntlBase.getDependables(v,n,"")[ui[1]],e=i("defaultNumberingSystem",f),h=u()?i("numberSymbols",f):i("symbols-numberSystem-"+e,f),c=t.IntlBase.getSymbolPattern(r||"decimal",e,f,!1);return s(h,t.IntlBase.getFormatData(c,!0,"",!0),{dateSeparator:t.IntlBase.getDateSeparator(o)})},t.getNumberDependable=function(n,i){var r=t.IntlBase.getDependables(v,n,"",!0);return t.IntlBase.getCurrencySymbol(r.numericObject,i)},t.getDefaultDateObject=function(n){return t.IntlBase.getDependables(v,"",n,!1)[ui[1]]},t.KeyboardEvents=to,t.L10n=io,t.ModuleLoader=ou,t.Property=h,t.Complex=li,t.ComplexFactory=function(n){return function(t,i){var r={set:oe({},i,n),get:ee({},i,n),enumerable:!0,configurable:!0};Object.defineProperty(t,i,r);et(t,i,"complexProp",{},n)}},t.Collection=function(n,t){return function(i,r){var u={set:he(n,r,t),get:se(n,r,t),enumerable:!0,configurable:!0};Object.defineProperty(i,r,u);et(i,r,"colProp",n,t)}},t.CollectionFactory=function(n){return function(t,i){var r={set:ce([],i,n),get:le([],i,n),enumerable:!0,configurable:!0};Object.defineProperty(t,i,r);et(t,i,"colProp",{},n)}},t.Event=a,t.NotifyPropertyChanges=it,t.CreateBuilder=function(n){var t=function(n){return this.element=n,this};return function(i){return t.prototype.hasOwnProperty("create")||((t.prototype=function n(t){if(f(t.prototype.builderObject)){t.prototype.builderObject={properties:{},propCollections:[],add:function(){this.isPropertyArray=!0;this.propCollections.push(s({},this.properties,{}))}};for(var h=/complex/,i=0,u=Object.keys(t.prototype.propList);i<u.length;i++)for(var e=u[i],c=function(i){t.prototype.builderObject[i.propertyName]=h.test(e)?function(t){var u,r={};return nt(r,n(i.type)),t(r),u=r.isPropertyArray?r.propCollections:s({},r.properties,{}),this.properties[i.propertyName]=u,r.properties={},r.propCollections=[],r.isPropertyArray=!1,this}:function(n){return this.properties[i.propertyName]=n,this}},r=0,o=t.prototype.propList[e];r<o.length;r++)c(o[r])}return t.prototype.builderObject}(n)).create=function(){var t=s({},{},this.properties);return this.properties={},new n(t,this.element)}),new t(i)}},t.SwipeSettings=vu,t.Touch=uo,t.blazorTemplates=d,t.getRandomId=ku,t.compile=function(n,t,i){var f=rr.compile(n,t,i);return function(n,t,i,e,o,s,h){var l=f(n,t,i,h),a,v,y,c;if(u()&&!o){if(a=e+ku(),d[e]||(d[e]=[]),r(s))n.BlazorTemplateId=a,d[e].push(n);else for(v=0,y=Object.keys(d[e][s]);v<y.length;v++)c=y[v],"BlazorTemplateId"!==c&&n[c]&&(d[e][s][c]=n[c]),"BlazorTemplateId"===c&&(a=d[e][s][c]);return"rowTemplate"===i?[g("tr",{id:a,className:"e-blazor-template"})]:[g("div",{id:a,className:"e-blazor-template"})]}return"string"==typeof l?ts.test(l)?g("svg",{innerHTML:l}).childNodes:g(ns.test(l)?"table":"div",{innerHTML:l}).childNodes:l}},t.updateBlazorTemplate=function(n,t,i,r,f){u()&&(window.sfBlazor.updateTemplate(t,d[n],n,i,f),!1!==r&&(d[n]=[]))},t.resetBlazorTemplate=function(n,t,i){var h=document.getElementById(n),u,f,o,e,c,s;if(h)for(u=h.getElementsByClassName("blazor-inner-template"),f=0;f<u.length;f++)if(o=" ",o=r(i)?u[f].getAttribute("data-templateId"):u[i].getAttribute("data-templateId"),e=document.getElementById(o),e)for(c=e.childNodes.length,s=0;s<c;s++)r(i)?u[f].appendChild(e.childNodes[0]):(u[i].appendChild(e.childNodes[0]),f=u.length)},t.setTemplateEngine=function(n){rr.compile=n.compile},t.getTemplateEngine=function(){return rr.compile},t.disableBlazorMode=function(){ii=!1},t.createInstance=lt,t.setImmediate=ur,t.getValue=i,t.setValue=y,t.deleteObject=fr,t.isObject=p,t.getEnumValue=function(n,t){return n[t]},t.merge=nt,t.extend=s,t.isNullOrUndefined=r,t.isUndefined=f,t.getUniqueID=function(n){return n+"_"+gu++},t.debounce=er,t.queryParams=function(n){for(var i,r=[],t=0,u=Object.keys(n);t<u.length;t++)i=u[t],r.push(encodeURIComponent(i)+"="+encodeURIComponent(""+n[i]));return r.join("&")},t.isObjectArray=function(n){var t=Object.prototype.toString;return"[object Array]"===t.call(n)&&"[object Object]"===t.call(n[0])},t.compareElementParent=bt,t.throwError=rt,t.print=function(n,t){var u=document.createElement("div"),f=[].slice.call(document.getElementsByTagName("head")[0].querySelectorAll("base, link, style")),e="",i,o,s;for(r(t)&&(t=window.open("","print","height=452,width=1024,tabbar=no")),u.appendChild(n.cloneNode(!0)),i=0,o=f.length;i<o;i++)e+=f[i].outerHTML;return t.document.write("<!DOCTYPE html> <html><head>"+e+"<\/head><body>"+u.innerHTML+"<script> (function() { window.ready = true; })(); <\/script><\/body><\/html>"),t.document.close(),t.focus(),s=setInterval(function(){t.ready&&(t.print(),t.close(),clearInterval(s))},500),t},t.formatUnit=function(n){var t=n+"";return"auto"===t||-1!==t.indexOf("%")||-1!==t.indexOf("px")?t:t+"px"},t.enableBlazorMode=function(){ii=!0},t.isBlazor=u,t.getElement=function(n){return _instanceof(n,Node)||!u()||r(n.xPath)?n:document.evaluate(n.xPath,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue},t.getInstance=function(n,t){var f="string"==typeof n?document.querySelector(n):n,i,r,u;if(f[ct])for(i=0,r=f[ct];i<r.length;i++)if(u=r[i],_instanceof(u,t))return u;return null},t.addInstance=function(n,t){var i="string"==typeof n?document.querySelector(n):n;i[ct]?i[ct].push(t):i[ct]=[t]},t.uniqueID=or,t.createElement=g,t.addClass=yt,t.removeClass=pt,t.isVisible=ei,t.prepend=function(n,t,i){for(var e,u=document.createDocumentFragment(),r=0,f=n;r<f.length;r++)e=f[r],u.appendChild(e);return t.insertBefore(u,t.firstElementChild),i&&kr(t),n},t.append=function(n,t,i){for(var e,u=document.createDocumentFragment(),r=0,f=n;r<f.length;r++)e=f[r],u.appendChild(e);return t.appendChild(u),i&&kr(t),n},t.detach=oi,t.remove=function(n){var t=n.parentNode;e.clearEvents(n);t.removeChild(n)},t.attributes=dr,t.select=kt,t.selectAll=si,t.closest=tt,t.siblings=function(n){for(var t,r=[],i=0,u=Array.prototype.slice.call(n.parentNode.childNodes);i<u.length;i++)t=u[i],t.nodeType===Node.ELEMENT_NODE&&n!==t&&r.push(t);return r},t.getAttributeOrDefault=function(n,t,u){var f,e=p(n);return r(f=e?i("attributes."+t,n):n.getAttribute(t))&&u&&(e?n.attributes[t]=u:n.setAttribute(t,u.toString()),f=u),f},t.setStyleAttribute=hi,t.classList=function(n,t,i){yt([n],t);pt([n],i)},t.matches=ci,t.includeInnerHTML=function(n,t){n.innerHTML=t},t.containsClass=function(n,t){return p(n)?new RegExp("\\b"+t+"\\b","i").test(n.attributes.className):n.classList.contains(t)},t.cloneNode=function(n,t){return p(n)?t?s({},{},n,!0):void 0:n.cloneNode(t)},t.Observer=vt,t.SanitizeHtmlHelper=us,t}({})},"./modules/chart.js":function(){function n(t){return(n="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(n){return _typeof2(n)}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":_typeof2(n)})(t)}window.sf=window.sf||{};sf.charts=sf.base.extend({},sf.charts,function(t){"use strict";function uc(n,t,i){var r=sf.base.extend([],n,null);return r.sort(function(n,r){for(var u=0,f=0,e=0;e<t.length;e++)u+=n[t[e]],f+=r[t[e]];return!i&&u<f||i&&u>f?-1:u===f?0:1}),r}function li(n){return-1!==n.indexOf("<br>")}function fi(n){for(var t,r=sf.base.extend([],n.points,null,!0),u=[],f=0,i=0;i<r.length;i++)t=r[i],sf.base.isNullOrUndefined(t.x)||""===t.x||(t.index=f++,u.push(t));return u}function fc(n,t,i,r){var h,c,l,a,v,y=new sf.svgbase.SvgRenderer(r.element.id),u=[],s={id:"rotate_text",x:r.initialClipRect.x,y:r.initialClipRect.y,"font-size":n.size,"font-style":n.fontStyle,"font-family":n.fontFamily,"font-weight":n.fontWeight,transform:"rotate("+i+", 0, 0)","text-anchor":"middle"},e,f,p,o;if(h=li(t)?(u=t.split("<br>"))[0]:t,e=y.createText(s,h),r.delayRedraw||r.redraw||r.element.appendChild(r.svgObject),"string"!=typeof u&&u.length>1)for(f=1,p=u.length;f<p;f++)c=sf.svgbase.measureText(u[f],n).height,l=s.y+f*c,a=u[f],v=y.createTSpan({x:s.x,id:s.id,y:l},a),e.appendChild(v);return r.svgObject.appendChild(e),o=e.getBoundingClientRect(),sf.base.remove(e),r.delayRedraw||r.redraw||sf.base.remove(r.svgObject),new sf.svgbase.Size(o.right-o.left,o.bottom-o.top)}function w(n){if(!n)return null;var t="string"==typeof n?r(n):n;t&&sf.base.remove(t)}function nt(n,t){return Math.log(n)/Math.log(t)}function rr(n,t,i,r,u,f,e,o){var s=document.getElementById(u),h=sf.svgbase.measureText(n,{fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"Regular"}),c=h.width+5;(t=t+c>r?t-(c+15):t,i=o?i-h.height/2:i+15,s)?(s.innerHTML=n,s.style.top=i.toString()+"px",s.style.left=(t+15).toString()+"px"):(s=sf.base.createElement("div",{innerHTML:n,id:u,styles:"top:"+i.toString()+"px;left:"+(t+15).toString()+'px;background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(112, 112, 112); padding-left : 3px; padding-right : 2px;padding-bottom : 2px; padding-top : 2px; font-size:12px; font-family: "Segoe UI"'}),f.appendChild(s),parseInt(s.style.left.replace("px",""),10)<0&&(s.style.left="0px"));e&&setTimeout(function(){w(u)},1500)}function ai(n,t){return n<t.max&&n>t.min}function ut(n,t){return n<=t.max&&n>=t.min}function bi(n,t){return"Logarithmic"===t.valueType?nt(n,t.logBase):n}function b(n,t,i,r){var f=bi(t.xValue,r.xAxis),e=n?bi(n.xValue,r.xAxis):f,o=i?bi(i.xValue,r.xAxis):f,u=Math.floor(r.xAxis.visibleRange.min),s=Math.ceil(r.xAxis.visibleRange.max);return e>=u&&e<=s||f>=u&&f<=s||o>=u&&o<=s||u>=e&&u<=o}function g(n){for(var i=0,t=0,r=n;t<r.length;t++)i+=r[t];return i}function wr(n,t,i,r,u){var e=0,f;if(null!==r)for(f=t+1;f<i;f++)-1===r.indexOf(f)&&(e+=n[f][u.yName]);else for(f=t+1;f<i;f++)sf.base.isNullOrUndefined(n[f][u.yName])||(e+=n[f][u.yName]);return e}function kt(n,t){return n.x+=t.left,n.y+=t.top,n.width-=t.left+t.right,n.height-=t.top+t.bottom,n}function vu(n,t,i){var r=n*Math.PI/180;return new s(Math.cos(r)*t+i.x,Math.sin(r)*t+i.y)}function ur(n){return n*(Math.PI/180)}function yu(n,t,i,r){for(var e=[],f=0;f<4;f++){var u=n[f],o=u.x-t,h=u.y-i,c=o*Math.cos(ur(r))-h*Math.sin(ur(r)),l=o*Math.sin(ur(r))+h*Math.cos(ur(r));u.x=c+t;u.y=l+i;e.push(new s(u.x,u.y))}return e}function pu(n,t){for(var u,f,i,e,r,o,h,v=[n,t],c,l=0;l<v.length;l++)for(c=v[l],e=0;e<c.length;e++){var w=(e+1)%c.length,y=c[e],p=c[w],a=new s(p.y-y.y,y.x-p.x);for(u=f=void 0,r=0;r<n.length;r++)i=a.x*n[r].x+a.y*n[r].y,(sf.base.isNullOrUndefined(u)||i<u)&&(u=i),(sf.base.isNullOrUndefined(f)||i>f)&&(f=i);for(o=h=void 0,r=0;r<t.length;r++)i=a.x*t[r].x+a.y*t[r].y,(sf.base.isNullOrUndefined(o)||i<o)&&(o=i),(sf.base.isNullOrUndefined(h)||i>h)&&(h=i);if(f<o||h<u)return!1}return!0}function fr(n,t){for(var r=[],i=0;i<=t-1;i++)r.push(n[i]);return r}function a(n,t){var i=t.visibleRange,r=(n-i.min)/i.delta;return t.isInversed?1-r:r}function ei(n,t,i,r,u,f){n="Logarithmic"===i.valueType?nt(n>1?n:1,i.logBase):n;t="Logarithmic"===r.valueType?nt(t>1?t:1,r.logBase):t;n+="Category"===i.valueType&&"BetweenTicks"===i.labelPlacement&&"Radar"!==f.type?.5:0;var e=f.chart.radius*a(t,r),o=st(ft(n,i),f.chart.primaryXAxis.startAngle);return{x:f.clipRect.width/2+f.clipRect.x+e*o.x,y:f.clipRect.height/2+f.clipRect.y+e*o.y}}function st(n,t){t=t<0?t+360:t;var i=Math.PI*(1.5-2*n);return i+=t*Math.PI/180,{x:Math.cos(i),y:Math.sin(i)}}function ft(n,t){var i,u,r=t.visibleRange;return"Category"!==t.valueType?(i=r.max-("DateTime"===t.valueType?t.dateTimeInterval:r.interval)-r.min,u=t.visibleLabels.length-1,i=0===i?1:i):(i=1===t.visibleLabels.length?1:t.visibleLabels[t.visibleLabels.length-1].value-t.visibleLabels[0].value,u=t.visibleLabels.length),t.isInversed?(n-r.min)/i*(1-1/u):1-(n-r.min)/i*(1-1/u)}function ec(n,t,i,u,f){var e=r(n),o="top:"+i.toString()+"px;left:"+u.toString()+"px;color:black !important; background:#FFFFFF !important; position:absolute;border:1px solid #707070;font-size:"+f+";border-radius:2px; z-index:1";e?(e.setAttribute("innerHTML","&nbsp;"+t+"&nbsp;"),e.setAttribute("styles",o)):(e=sf.base.createElement("div",{id:n,innerHTML:"&nbsp;"+t+"&nbsp;",styles:o}),document.body.appendChild(e))}function oc(n,t,i,r,u,f){for(var e,h,l,c,y,v=t.opposedPosition,p=u?"start":"auto",w=n.availableSize.width,a=t.scrollbarSettings.enable||t.zoomingScrollBar&&t.zoomingScrollBar.svgObject?t.scrollBarHeight:0,o=0;o<2;o++)e=sf.svgbase.measureText(o?t.endLabel:t.startLabel,t.labelStyle),u?(c=o?new s(f.x-a,f.y+3):new s(t.rect.x-a,f.y+f.height-3),h=f.x+(v?f.width+5+a:-(e.width+5+5+a)),l=f.y+(o?0:f.height-e.height-5),h+=h<0||w<h+e.width+5?v?-e.width/2:e.width/2:0,y=sf.svgbase.findDirection(3,3,new sf.svgbase.Rect(h,l,e.width+5,e.height+5),c,5,!1,!1,!v,c.x,c.y+(o?-3:3))):(c=new s(o?f.x+f.width-3:f.x+3,f.y+f.height+a),h=f.x+(o?f.width-e.width-5:0),l=v?f.y-e.height-10-a:f.y+f.height+5+a,y=sf.svgbase.findDirection(3,3,new sf.svgbase.Rect(h,l,e.width+5,e.height+5),c,5,v,!v,!1,c.x+(o?3:-3),c.y)),h+=2.5,l=l+e.height/4*3+2.5,i.appendChild(n.renderer.drawPath(new sf.svgbase.PathOption(n.element.id+"_Zoom_"+r+"_AxisLabel_Shape_"+o,n.themeStyle.crosshairFill,2,n.themeStyle.crosshairFill,1,null,y))),k(n.renderer,new sf.svgbase.TextOption(n.element.id+"_Zoom_"+r+"_AxisLabel_"+o,h,l,p,o?t.endLabel:t.startLabel),{color:n.themeStyle.crosshairLabel,fontFamily:"Segoe UI",fontWeight:"Regular",size:"11px"},n.themeStyle.crosshairLabel,i);return i}function v(n,t,i,r,u){return void 0===r&&(r=0),void 0===u&&(u=0),n>=i.x-r&&n<=i.x+i.width+r&&t>=i.y-u&&t<=i.y+i.height+u}function ku(n,t,i){return(i.isInversed?1-n/t:n/t)*i.visibleRange.delta+i.visibleRange.min}function du(n,t,i){return(i.isInversed?n/t:1-n/t)*i.visibleRange.delta+i.visibleRange.min}function br(n){var t=n.clipRect;n.chart.requireInvertedAxis?(t.x=n.yAxis.rect.x,t.y=n.xAxis.rect.y,t.width=n.yAxis.rect.width,t.height=n.xAxis.rect.height):(t.x=n.xAxis.rect.x,t.y=n.yAxis.rect.y,t.width=n.xAxis.rect.width,t.height=n.yAxis.rect.height)}function tt(n){return n.substr(0,1).toLowerCase()+n.substr(1)}function sc(n,t,i){var r,u,f,e;return i?(r=t.rect.x,u=n.rect.y,f=t.rect.width,e=n.rect.height):(r=n.rect.x,u=t.rect.y,f=n.rect.width,e=t.rect.height),new sf.svgbase.Rect(r,u,f,e)}function gu(n,t){for(var u,e,s,i,f,h,r=Number.MAX_VALUE,o=0;o<t.length;o++)if(i=t[o],u=[],i.visible&&(n.name===i.xAxisName||"primaryXAxis"===n.name&&null===i.xAxisName||n.name===i.chart.primaryXAxis.name&&!i.xAxisName))if((u=i.points.map(function(n){return n.xValue})).sort(function(n,t){return n-t}),1===u.length)s="DateTime"===n.valueType&&i.xMin===i.xMax?i.xMin-2592e6:i.xMin,0!=(e=u[0]-(sf.base.isNullOrUndefined(s)?n.visibleRange.min:s))&&(r=Math.min(r,e));else for(f=0;f<u.length;f++)h=u[f],f>0&&h&&0!=(e=h-u[f-1])&&(r=Math.min(r,e));return r===Number.MAX_VALUE&&(r=1),r}function nf(n){var t;switch(n){case"Linear":t=et}return t}function et(n,t,i,r){return-i*Math.cos(n/r*(Math.PI/2))+i+t}function oi(n,t,i,r,u,f,e){var o=f.x,s=f.y,h=0;n.style.visibility="hidden";new sf.base.Animation({}).animate(n,{duration:i,delay:t,progress:function(t){t.timeStamp>t.delay&&(t.element.style.visibility="visible",h=(t.timeStamp-t.delay)/t.duration,n.setAttribute("transform","translate("+o+" "+s+") scale("+h+") translate("+-o+" "+-s+")"))},end:function(){n.style.visibility="";"Scatter"!==r.type&&"Bubble"!==r.type||e||u!==r.points.length-1||r.chart.trigger("animationComplete",{series:r.chart.isBlazor?{}:r})}})}function hc(n,t,i,r,u){var f=function(t){n.setAttribute("x",t.x+"");n.setAttribute("y",t.y+"");n.setAttribute("width",t.width+"");n.setAttribute("height",t.height+"")};new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:i,delay:t,progress:function(n){f(new sf.svgbase.Rect(et(n.timeStamp,u.x,r.x-u.x,n.duration),et(n.timeStamp,u.y,r.y-u.y,n.duration),et(n.timeStamp,u.width,r.width-u.width,n.duration),et(n.timeStamp,u.height,r.height-u.height,n.duration)))},end:function(){f(r)}})}function ii(n,t,i,r,u){var h;if(!i||!r&&!n)return null;h=300;u&&(h=u);var s,e,c,l=r||n.getAttribute("d"),v=l.split(/(?=[LMCZAQ])/),a=t.split(/(?=[LMCZAQ])/),f=[],o=[];n.setAttribute("d",l);new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:h,progress:function(t){s="";v.map(function(n,i){if(f=n.split(" "),o=a[i]?a[i].split(" "):f,s+="Z"===f[0]?"Z ":f[0]+" "+et(t.timeStamp,+f[1],+o[1]-+f[1],t.duration)+" "+et(t.timeStamp,+f[2],+o[2]-+f[2],t.duration)+" ","C"===f[0]||"Q"===f[0])for(e=3,c="Q"===f[0]?4:6;e<c;)s+=et(t.timeStamp,+f[e],+o[e]-+f[e],t.duration)+" "+et(t.timeStamp,+f[++e],+o[e]-+f[e],t.duration)+" ",++e;"A"===f[0]&&(s+="0 0 1 "+et(t.timeStamp,+f[6],+o[6]-+f[6],t.duration)+" "+et(t.timeStamp,+f[7],+o[7]-+f[7],t.duration)+" ")});n.setAttribute("d",s)},end:function(){n.setAttribute("d",t)}})}function vt(n,t,i,r){var u,f;return(void 0===r&&(r="drawClipPath"),u=yt(n,t.id,t,i),u)?(f=i.createDefs(),f.appendChild(u),f):i[r](t)}function vi(n,t,i,r,u){var f={cancel:!1,name:"axisLabelRender",axis:u,text:i,value:t,labelStyle:r},e,o;(n.trigger("axisLabelRender",f),f.cancel)||(e=-1!==f.text.indexOf("<br>"),o=u.enableTrim?e?dc(u.maximumLabelWidth,f.text,u.labelStyle):at(u.maximumLabelWidth,f.text,u.labelStyle):f.text,u.visibleLabels.push(new ic(o,f.value,f.labelStyle,f.text)))}function ki(n){return null!=n.minimum&&null!=n.maximum}function yi(n){return n.zoomFactor<1&&n.zoomPosition>=0}function kr(n,t){var r="Horizontal"===t.orientation?n.width:n.height,i;return sf.base.isNullOrUndefined(t.desiredIntervals)?(i=("Horizontal"===t.orientation?.533:1)*t.maximumLabels,Math.max(r*(i/100),1)):t.desiredIntervals}function er(n,t,i,r,u){new sf.base.Animation({}).animate(n,{duration:i,delay:t,name:r,progress:function(n){n.element.style.visibility="visible"},end:function(n){u?sf.base.remove(n.element):n.element.style.visibility="visible"}})}function rt(n,t,i,r,u,f,e,o,s,h){var l=e||new sf.svgbase.SvgRenderer(""),c=cc(n,i,t,u,r,s,h);return l["draw"+c.functionName](c.renderOption,o?new Int32Array([o.x,o.y]):null)}function cc(n,t,i,r,u,f,e){var c,p,w,b="Path",k=f,v=k&&"Circle"===i?t.width-2:t.width,s=k&&"Circle"===i?t.height-2:t.height,a=k?e.targetWidth:0,h=n.x,o=n.y,d=n.y+-s/2,l=n.x+-v/2,y;switch(i){case"Bubble":case"Circle":b="Ellipse";sf.base.merge(r,{rx:v/2,ry:s/2,cx:h,cy:o});break;case"Cross":c="M "+l+" "+o+" L "+(h+v/2)+" "+o+" M "+h+" "+(o+s/2)+" L "+h+" "+(o+-s/2);sf.base.merge(r,{d:c,stroke:r.fill});break;case"Multiply":c="M "+(h-a)+" "+(o-a)+" L "+(h+a)+" "+(o+a)+" M "+(h-a)+" "+(o+a)+" L "+(h+a)+" "+(o-a);sf.base.merge(r,{d:c,stroke:r.fill});break;case"HorizontalLine":c="M "+l+" "+o+" L "+(h+v/2)+" "+o;sf.base.merge(r,{d:c});break;case"VerticalLine":c="M "+h+" "+(o+s/2)+" L "+h+" "+(o+-s/2);sf.base.merge(r,{d:c});break;case"Diamond":c="M "+l+" "+o+" L "+h+" "+(o+-s/2)+" L "+(h+v/2)+" "+o+" L "+h+" "+(o+s/2)+" L "+l+" "+o+" z";sf.base.merge(r,{d:c});break;case"ActualRect":c="M "+l+" "+(o+-s/8)+" L "+(h+a)+" "+(o+-s/8)+" L "+(h+a)+" "+(o+s/8)+" L "+l+" "+(o+s/8)+" L "+l+" "+(o+-s/8)+" z";sf.base.merge(r,{d:c});break;case"TargetRect":c="M "+(l+a)+" "+(o+-s/2)+" L "+(h+a/2)+" "+(o+-s/2)+" L "+(h+a/2)+" "+(o+s/2)+" L "+(l+a)+" "+(o+s/2)+" L "+(l+a)+" "+(o+-s/2)+" z";sf.base.merge(r,{d:c});break;case"Rectangle":case"Hilo":case"HiloOpenClose":case"Candle":case"Waterfall":case"BoxAndWhisker":case"StepArea":case"StackingStepArea":case"Square":case"Flag":c="M "+l+" "+(o+-s/2)+" L "+(h+v/2)+" "+(o+-s/2)+" L "+(h+v/2)+" "+(o+s/2)+" L "+l+" "+(o+s/2)+" L "+l+" "+(o+-s/2)+" z";sf.base.merge(r,{d:c});break;case"Pyramid":case"Triangle":c="M "+l+" "+(o+s/2)+" L "+h+" "+(o+-s/2)+" L "+(h+v/2)+" "+(o+s/2)+" L "+l+" "+(o+s/2)+" z";sf.base.merge(r,{d:c});break;case"Funnel":case"InvertedTriangle":c="M "+(h+v/2)+" "+(o-s/2)+" L "+h+" "+(o+s/2)+" L "+(h-v/2)+" "+(o-s/2)+" L "+(h+v/2)+" "+(o-s/2)+" z";sf.base.merge(r,{d:c});break;case"Pentagon":for(y=0;y<=5;y++)p=v/2*Math.cos(Math.PI/180*72*y),w=s/2*Math.sin(Math.PI/180*72*y),c=0===y?"M "+(h+p)+" "+(o+w)+" ":c.concat("L "+(h+p)+" "+(o+w)+" ");c=c.concat("Z");sf.base.merge(r,{d:c});break;case"Image":b="Image";sf.base.merge(r,{href:u,height:s,width:v,x:l,y:d})}return{renderOption:r=kc(n,new sf.svgbase.Size(v,s),i,r).renderOption,functionName:b}}function lc(n,t,i){var r=t.x<i.x?i.x:t.x>i.x+i.width?i.x+i.width:t.x,u=t.y<i.y?i.y:t.y>i.y+i.height?i.y+i.height:t.y;return new sf.svgbase.Rect(r>n.x?n.x:r,u>n.y?n.y:u,Math.abs(r-n.x),Math.abs(u-n.y))}function dt(n,t,i){return n>i?i:n<t?t:n}function r(n){return document.getElementById(n)}function ac(n){var t=null;try{document.querySelectorAll(n).length&&(t=sf.base.compile(document.querySelector(n).innerHTML.trim()))}catch(i){t=sf.base.compile(n)}return t}function vc(n,t,i,r,u,f,e,o,s,h){var c=n.getBoundingClientRect();t.accumulationDataLabelModule.calculateLabelSize(i,n,f,r,u,e,o,s,h,c,!0)}function yc(n,t,i,r,u,f){var e=document.getElementById(t.element.id+"_Series_"+(void 0===r.index?r.category:r.index)+"_DataLabelCollections");e&&(0===i.index&&(t.dataLabelCollections=[]),t.dataLabelModule.calculateTemplateLabelSize(e,n,i,r,r.marker.dataLabel,u,r.clipRect,f,!0))}function tf(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){var k,d=ac(i),g,b,nt,w,p;try{if(g=window.Blazor?e?u:{point:u}:{chart:r,series:f,point:u},b=d?d(g,r,e?e+"_template":"template",e||n.id.replace(/[^a-zA-Z0-9]/g,"")):[],b.length)for(nt=(k=Array.prototype.slice.call(b)).length,w=0;w<nt;w++)n.appendChild(k[w]);p=void 0;"accumulationchart"===r.getModuleName()?(p=vc.bind(this,n,r,h,c,s,c[t],l,a,v,y),r.isReact&&r.renderReactTemplates(p)):"chart"===r.getModuleName()&&(p=u&&f?yc.bind(this,n,r,u,f,o,y):p,r.isReact&&r.renderReactTemplates(p))}catch(t){return n}return n}function pc(n){return"font-size:"+n.size+"; font-style:"+n.fontStyle+"; font-weight:"+n.fontWeight+"; font-family:"+n.fontFamily+";opacity:"+n.opacity+"; color:"+n.color+";"}function rf(n,t,i){void 0===t&&(t=!1);i||document.body.appendChild(n);var r=n.getBoundingClientRect();return t?sf.base.remove(n):i||w(n.id),r}function wc(n,t){for(var r,i=0,u=n.length;i<u;i++)n[i].id.indexOf(t)>-1&&(r=n[i]);return r}function e(n,t,i,r,u){n="Logarithmic"===i.valueType?nt(n>0?n:Math.pow(i.logBase,i.visibleRange.min),i.logBase):n;t="Logarithmic"===r.valueType?nt(t>0?t:Math.pow(r.logBase,r.visibleRange.min),r.logBase):t;n=a(n,i);t=a(t,r);var f=u?i.rect.height:i.rect.width,e=u?r.rect.width:r.rect.height;return new s(u?t*e:n*f,u?(1-n)*f:(1-t)*e)}function uf(n,t,i,r,u,f){if(void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===u&&(u="x"),void 0===f&&(f="y"),!(n&&n.hasChildNodes()&&t))return null;h(!1,t,n,i,r,u,f)}function h(n,t,i,u,f,e,o,h,c,l,a,v,y){var d;if(void 0===f&&(f=!1),void 0===e&&(e="x"),void 0===o&&(o="y"),void 0===l&&(l=!1),void 0===a&&(a=!1),void 0===v&&(v=null),n)return null;var k=t.querySelector("#"+i.id),p=k||r(i.id),w=i,b=y||300;u&&f&&p?(h=h||("DIV"===p.tagName?new s(+p.style[e].split("px")[0],+p.style[o].split("px")[0]):new s(+p.getAttribute(e),+p.getAttribute(o))),c&&"undefined"!==c)?ii(i,i.getAttribute("d"),u,c,b):a&&v?hc(w,0,b,new sf.svgbase.Rect(+p.getAttribute("x"),+p.getAttribute("y"),+p.getAttribute("width"),+p.getAttribute("height")),v):(d="DIV"===w.tagName?new s(+w.style[e].split("px")[0],+w.style[o].split("px")[0]):new s(+w.getAttribute(e),+w.getAttribute(o)),cf(w,b,h,d,e,o)):u&&f&&!p&&l&&er(w,0,600,"FadeIn");k?t.replaceChild(w,p):t.appendChild(w)}function dr(n,t,i,r,u){var f=Math.abs(n-i),e=Math.abs(t-r),o=Math.max(ff(Math.min(n,i),f,u.x,u.width),u.x),s=Math.max(ff(Math.min(t,r),e,u.y,u.height),u.y);return new sf.svgbase.Rect(o,s,Math.min(f,u.width),Math.min(e,u.height))}function ff(n,t,i,r){return n<i?n=i:n+t>r+i&&(n=r+i-t),n}function bc(n,t,i){var f=t.yAxis.labelFormat,r=[],s=null!==f.match("{value}"),e,o,h,u;switch(t.seriesType){case"XY":"PolarRadar"===t.chart.chartAreaType?-1!==t.drawType.indexOf("Stacking")?("Logarithmic"===t.yAxis.valueType&&bi(t.stackedValues.endValues[n.index],t.yAxis)||ut(t.stackedValues.endValues[n.index],t.yAxis.visibleRange))&&r.push(n.text||n.yValue.toString()):("Logarithmic"===t.yAxis.valueType&&bi(n.yValue,t.yAxis)||ut(n.yValue,t.yAxis.visibleRange))&&r.push(n.text||n.yValue.toString()):r.push(n.text||n.yValue.toString());break;case"HighLow":r.push(n.text||Math.max(n.high,n.low).toString());r.push(n.text||Math.min(n.high,n.low).toString());break;case"HighLowOpenClose":r.push(n.text||Math.max(n.high,n.low).toString());r.push(n.text||Math.min(n.high,n.low).toString());r.push(n.text||Math.max(n.open,n.close).toString());r.push(n.text||Math.min(n.open,n.close).toString());break;case"BoxPlot":for(r.push(n.text||n.median.toString()),r.push(n.text||n.maximum.toString()),r.push(n.text||n.minimum.toString()),r.push(n.text||n.upperQuartile.toString()),r.push(n.text||n.lowerQuartile.toString()),e=0,o=n.outliers;e<o.length;e++)h=o[e],r.push(n.text||h.toString())}if(f&&!n.text)for(t.yAxis.format=i.intl.getNumberFormat({format:s?"":f,useGrouping:i.useGroupingSeparator}),u=0;u<r.length;u++)r[u]=s?f.replace("{value}",t.yAxis.format(parseFloat(r[u]))):t.yAxis.format(parseFloat(r[u]));return r}function or(n){window.clearInterval(n)}function di(n,t,i){var r=new sf.svgbase.Rect(n.x+i.x,n.y+i.y,n.width,n.height);return t.some(function(n){return r.x<n.x+n.width&&r.x+r.width>n.x&&r.y<n.y+n.height&&r.height+r.y>n.y})}function gi(n,t){return n.x<t.x+t.width&&n.x+n.width>t.x&&n.y<t.y+t.height&&n.height+n.y>t.y}function sr(n,t,i){return new sf.svgbase.Rect(n.x-t.width/2-i.left,n.y-t.height/2-i.top,t.width+i.left+i.right,t.height+i.top+i.bottom)}function ef(n){return"#"+gr(n.r)+gr(n.g)+gr(n.b)}function gr(n){var t=n.toString(16);return 1===t.length?"0"+t:t}function nu(n){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return t?new cr(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)):new cr(255,255,255)}function ht(n){var t,i;return n="transparent"===n?"white":n,document.body.appendChild(sf.base.createElement("text",{id:"chartmeasuretext"})),t=document.getElementById("chartmeasuretext"),t.style.color=n,n=window.getComputedStyle(t).color,sf.base.remove(t),i=/^(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/.exec(n),ef(new cr(parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10)))}function hf(n,t){(n=(n=ht(n)).replace(/[^0-9a-f]/gi,"")).length<6&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]);t=t||0;for(var i,u="#",r=0;r<3;r++)i=parseInt(n.substr(2*r,2),16),u+=("00"+(i=Math.round(Math.min(Math.max(0,i+i*t),255))).toString(16)).substr(i.toString(16).length);return u}function tu(n){var t=Math.floor(n.length/2);return n.length%2?n[t]:(n[t-1]+n[t])/2}function kc(n,t,i,r){var h="",o=t.height,e=t.width,u=n.x,f=n.y;switch(i){case"MultiColoredLine":case"Line":case"StackingLine":case"StackingLine100":h="M "+(u+-e/2)+" "+f+" L "+(u+e/2)+" "+f;sf.base.merge(r,{d:h});break;case"StepLine":r.fill="transparent";h="M "+(u+-e/2-2.5)+" "+(f+o/2)+" L "+(u+-e/2+e/10)+" "+(f+o/2)+" L "+(u+-e/2+e/10)+" "+f+" L "+(u+-e/10)+" "+f+" L "+(u+-e/10)+" "+(f+o/2)+" L "+(u+e/5)+" "+(f+o/2)+" L "+(u+e/5)+" "+(f+-o/2)+" L "+(u+e/2)+" "+(f+-o/2)+"L "+(u+e/2)+" "+(f+o/2)+" L"+(u+e/2+2.5)+" "+(f+o/2);sf.base.merge(r,{d:h});break;case"UpArrow":r.fill=r.stroke;r.stroke="transparent";h="M "+(u+-e/2)+" "+(f+o/2)+" L "+u+" "+(f-o/2)+" L "+(u+e/2)+" "+(f+o/2)+"L "+(u+e/2-2)+" "+(f+o/2)+" L "+u+" "+(f-o/2+4)+"L"+(u-e/2+2)+" "+(f+o/2)+" Z";sf.base.merge(r,{d:h});break;case"DownArrow":h="M "+(u-e/2)+" "+(f-o/2)+" L "+u+" "+(f+o/2)+" L "+(u+e/2)+" "+(f-o/2)+"L "+(u+e/2-2)+" "+(f-o/2)+" L "+u+" "+(f+o/2-4)+"L"+(u-e/2+2)+" "+(f-o/2)+" Z";sf.base.merge(r,{d:h});break;case"RightArrow":h="M "+(u+-e/2)+" "+(f-o/2)+" L "+(u+e/2)+" "+f+" L "+(u+-e/2)+" "+(f+o/2)+" L "+(u+-e/2)+" "+(f+o/2-2)+" L "+(u+e/2-4)+" "+f+" L"+(u+-e/2)+" "+(f-o/2+2)+" Z";sf.base.merge(r,{d:h});break;case"LeftArrow":r.fill=r.stroke;r.stroke="transparent";h="M "+(u+e/2)+" "+(f-o/2)+" L "+(u+-e/2)+" "+f+" L "+(u+e/2)+" "+(f+o/2)+" L "+(u+e/2)+" "+(f+o/2-2)+" L "+(u+-e/2+4)+" "+f+" L"+(u+e/2)+" "+(f-o/2+2)+" Z";sf.base.merge(r,{d:h});break;case"Column":case"Pareto":case"StackingColumn":case"StackingColumn100":case"RangeColumn":case"Histogram":h="M "+(u-e/5*3)+" "+(f-o/5)+" L "+(u+-e/10*3)+" "+(f-o/5)+" L "+(u+-e/10*3)+" "+(f+o/2)+" L "+(u-e/5*3)+" "+(f+o/2)+" Z M "+(u+-e/10-e/20)+" "+(f-o/4-5)+" L "+(u+e/10+e/20)+" "+(f-o/4-5)+" L "+(u+e/10+e/20)+" "+(f+o/2)+" L "+(u+-e/10-e/20)+" "+(f+o/2)+" Z M "+(u+e/10*3)+" "+f+" L "+(u+e/5*3)+" "+f+" L "+(u+e/5*3)+" "+(f+o/2)+" L "+(u+e/10*3)+" "+(f+o/2)+" Z";sf.base.merge(r,{d:h});break;case"Bar":case"StackingBar":case"StackingBar100":h="M "+(u+-e/2+-2.5)+" "+(f-o/5*3)+" L "+(u+e/10*3)+" "+(f-o/5*3)+" L "+(u+e/10*3)+" "+(f-o/10*3)+" L "+(u-e/2-2.5)+" "+(f-o/10*3)+" Z M "+(u+-e/2+-2.5)+" "+(f-o/5+.5)+" L "+(u+e/2+2.5)+" "+(f-o/5+.5)+" L "+(u+e/2+2.5)+" "+(f+o/10+.5)+" L "+(u-e/2-2.5)+" "+(f+o/10+.5)+" Z M "+(u-e/2-2.5)+" "+(f+o/5+1)+" L "+(u+-e/4)+" "+(f+o/5+1)+" L "+(u+-e/4)+" "+(f+o/2+1)+" L "+(u-e/2-2.5)+" "+(f+o/2+1)+" Z";sf.base.merge(r,{d:h});break;case"Spline":r.fill="transparent";h="M "+(u-e/2)+" "+(f+o/5)+" Q "+u+" "+(f-o)+" "+u+" "+(f+o/5)+" M "+u+" "+(f+o/5)+" Q "+(u+e/2)+" "+(f+o/2)+" "+(u+e/2)+" "+(f-o/2);sf.base.merge(r,{d:h});break;case"Area":case"MultiColoredArea":case"RangeArea":case"StackingArea":case"StackingArea100":h="M "+(u-e/2-2.5)+" "+(f+o/2)+" L "+(u+-e/4+-1.25)+" "+(f-o/2)+" L "+u+" "+(f+o/4)+" L "+(u+e/4+1.25)+" "+(f+-o/2+o/4)+" L "+(u+o/2+2.5)+" "+(f+o/2)+" Z";sf.base.merge(r,{d:h});break;case"SplineArea":case"SplineRangeArea":h="M "+(u-e/2)+" "+(f+o/5)+" Q "+u+" "+(f-o)+" "+u+" "+(f+o/5)+" Z M "+u+" "+(f+o/5)+" Q "+(u+e/2)+" "+(f+o/2)+" "+(u+e/2)+" "+(f-o/2)+"  Z";sf.base.merge(r,{d:h});break;case"Pie":case"Doughnut":r.stroke="transparent";h=function(n,t,i,r,u){var f=vu(270,i,new s(n,t)),e=vu(270,i,new s(n+u/10,t));return"M "+n+" "+t+" L "+(n+i)+" "+t+" A "+i+" "+i+" 0 1 1 "+f.x+" "+f.y+" Z M "+(n+u/10)+" "+(t-r/10)+" L"+(n+i)+" "+(t-r/10)+" A "+i+" "+i+" 0 0 0 "+e.x+" "+e.y+" Z"}(u,f,Math.min(o,e)/2,o,e);sf.base.merge(r,{d:h})}return{renderOption:r}}function at(n,t,i){var r=t,f=sf.svgbase.measureText(t,i).width,u;if(f>n)for(u=t.length-1;u>=0;--u)if(r=t.substring(0,u)+"...",(f=sf.svgbase.measureText(r,i).width)<=n)return r;return r}function dc(n,t,i){for(var e,r,u=[],o=t.split("<br>"),f=0;f<o.length;f++)if(t=o[f],e=sf.svgbase.measureText(t,i).width,e>n){for(r=t.length-1;r>=0;--r)if(t=t.substring(0,r)+"...",(e=sf.svgbase.measureText(t,i).width)<=n){u.push(t);break}}else u.push(t);return u}function ri(n,t){return null!=n?-1!==n.indexOf("%")?t/100*parseInt(n,10):parseInt(n,10):null}function yt(n,t,i,u){if(!n)return null;var f=r(t);return f&&i&&u.setElementAttributes(i,"clipPath"===f.tagName?f.childNodes[0]:f),f}function cf(n,t,i,r,u,f){void 0===u&&(u="x");void 0===f&&(f="y");var o="DIV"===n.tagName,e=function(t,i){o?(n.style[u]=t+"px",n.style[f]=i+"px"):(n.setAttribute(u,t+""),n.setAttribute(f,i+""))};e(i.x,i.y);new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:t,progress:function(n){e(et(n.timeStamp,i.x,r.x-i.x,n.duration),et(n.timeStamp,i.y,r.y-i.y,n.duration))},end:function(){e(r.x,r.y)}})}function k(n,t,i,r,u,f,e,o,s,c,l,a,v,y){var b,k,d,g,nt,w,tt;void 0===f&&(f=!1);void 0===s&&(s=!1);b={id:t.id,x:t.x,y:t.y,fill:r||"black","font-size":i.size,"font-style":i.fontStyle,"font-family":i.fontFamily,"font-weight":i.fontWeight,"text-anchor":t.anchor,labelRotation:t.labelRotation,transform:t.transform,opacity:i.opacity,"dominant-baseline":t.baseLine};var it="string"==typeof t.text?t.text:f?t.text[t.text.length-1]:t.text[0],rt=l?l.x:0,ut=l?l.y:0,p=n.createText(b,it,rt,ut);if(p.style.fontFamily=i.fontFamily,p.style.fontStyle=i.fontStyle,p.style.fontSize=i.size,p.style.fontWeight=i.fontWeight,p.style.color=i.color,p.style.textAnchor=t.anchor,"string"!=typeof t.text&&t.text.length>1)for(w=1,tt=t.text.length;w<tt;w++)d=sf.svgbase.measureText(t.text[w],i).height,g=t.y+(f?-w*d:w*d),nt=f?t.text[t.text.length-(w+1)]:t.text[w],y?k=n.createText(b,nt,null,null,g,!0):(k=n.createTSpan({x:t.x,id:t.id,y:g},nt),p.appendChild(k));return v||h(_instanceof(n,sf.svgbase.CanvasRenderer),u,p,e,o,"x","y",null,null,s,!1,null,c),p}function gc(n){var r=n.element.clientWidth||n.element.offsetWidth,u=n.element.clientHeight,f,i,o;if(n.stockChart&&(r=n.stockChart.availableSize.width,u=n.stockChart.availableSize.height),i=450,"rangeNavigator"===n.getModuleName()){var t=n,s=t.tooltip.enable?35:0,e=t.periodSelectorSettings.periods.length?t.periodSelectorSettings.height:0;f=t.margin.top+t.margin.bottom+s;o=sf.svgbase.measureText("tempString",t.labelStyle).height;i=(n.series.length?sf.base.Browser.isDevice?80:120:(t.enableGrouping?55+o:40)+f)+e;t.disableRangeSelector&&(i=e)}n.availableSize=new sf.svgbase.Size(ri(n.width,r)||r||600,ri(n.height,u||i)||u||i)}function nl(n){n.canvasRender=new sf.svgbase.CanvasRenderer(n.element.id);n.renderer=n.enableCanvas?n.canvasRender:new sf.svgbase.SvgRenderer(n.element.id);gc(n);n.svgObject=n.stockChart&&"chart"===n.getModuleName()?n.stockChart.chartObject:n.stockChart&&"rangeNavigator"===n.getModuleName()?n.stockChart.selectorObject:n.enableCanvas?n.renderer.createCanvas({id:n.element.id+"_canvas",width:n.availableSize.width,height:n.availableSize.height}):n.renderer.createSvg({id:n.element.id+"_svg",width:n.availableSize.width,height:n.availableSize.height})}function hr(n,t,i){var r=[];switch(t.textOverflow){case"Wrap":r=nr(n,i,t);break;case"Trim":r.push(at(i,n,t));break;default:r.push(n)}return r}function iu(n,t){return"Near"===t.textAlignment?n.x:"Center"===t.textAlignment?n.x+n.width/2:n.x+n.width}function nr(n,t,i){for(var u,o=n.split(" "),r="",f=[],e=0,s=o.length;e<s;e++)u=o[e],sf.svgbase.measureText(r.concat(u),i).width<t?r=r.concat((""===r?"":" ")+u):""!==r?(f.push(at(t,r,i)),r=u):(f.push(at(t,u,i)),u=""),r&&e===s-1&&f.push(at(t,r,i));return f}function lf(n,t){for(var i,f=n.replace(t," "),s=n.match(t),r=" ",e=" ",o=0,h={0:"",1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:""},c={0:"",1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:""},u=0;u<=f.length-1;u++)if(" "===f[u]){for(r=t===pr?s[o].replace(/~/g,""):s[o].replace(/\^/g,""),i=0;i<r.length;i++)e+=t===pr?h[r[i]]:c[r[i]];o++}else e+=f[u];return e.trim()}function af(n){for(var t=0;t<n.annotations.length;t++)sf.base.resetBlazorTemplate((n.element.id+"_Annotation_"+t).replace(/[^a-zA-Z0-9]/g,""),"ContentTemplate");sf.base.resetBlazorTemplate(n.element.id+"_tooltipparent_template_blazorTemplate","Template");sf.base.resetBlazorTemplate(n.element.id+"_DataLabel")}function rl(n,t){return Number(t)===n.start?n.colors[0]:Number(t)===n.end?n.colors[n.colors.length-1]:ef(ul(Number(t),n))}function ul(n,t){var f,e,s=t.start,c=t.end,o=0,l=c-s,i;if(o=(n-s)/l,t.colors.length<=2)f="#"===t.colors[0].charAt(0)?t.colors[0]:ht(t.colors[0]),e="#"===t.colors[t.colors.length-1].charAt(0)?t.colors[t.colors.length-1]:ht(t.colors[t.colors.length-1]);else{f="#"===t.colors[0].charAt(0)?t.colors[0]:ht(t.colors[0]);e="#"===t.colors[t.colors.length-1].charAt(0)?t.colors[t.colors.length-1]:ht(t.colors[t.colors.length-1]);for(var u=l/(t.colors.length-1),v=t.colors.length-1,r=[],a={},h=1;h<v;h++)a={b:s+h*u,color:t.colors[h]},r.push(a);for(i=0;i<r.length;i++)s<=n&&n<=r[i].b&&0===i?(e="#"===r[i].color.charAt(0)?r[i].color:ht(r[i].color),o=n<=r[i].b?1-Math.abs((n-r[i].b)/u):(n-r[i].b)/u):r[i].b<=n&&n<=c&&i===r.length-1&&(f="#"===r[i].color.charAt(0)?r[i].color:ht(r[i].color),o=n<r[i].b?1-Math.abs((n-r[i].b)/u):(n-r[i].b)/u),i!==r.length-1&&i<r.length&&r[i].b<=n&&n<=r[i+1].b&&(f="#"===r[i].color.charAt(0)?r[i].color:ht(r[i].color),e="#"===r[i+1].color.charAt(0)?r[i+1].color:ht(r[i+1].color),o=Math.abs(n-r[i+1].b)/u)}return fl(o,f,e)}function fl(n,t,i){var r=i.split("#")[1],u=t.split("#")[1],f=uu(n,parseInt(u.substr(0,2),16),parseInt(r.substr(0,2),16)),e=uu(n,parseInt(u.substr(2,2),16),parseInt(r.substr(2,2),16)),o=uu(n,parseInt(u.substr(4,2),16),parseInt(r.substr(4,2),16));return new cr(f,e,o)}function uu(n,t,i){var r=i-t;return Math.round(t+r*n)}var ct,wu,bu;!function(n){n.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.axisTitleFont={size:"14px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.chartTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.chartSubTitleFont={size:"11px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.crosshairLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.tooltipLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.legendLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.legendTitleFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.stripLineLabelFont={size:"12px",fontWeight:"Regular",color:"#353535",fontStyle:"Normal",fontFamily:"Segoe UI"};n.stockEventFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"}}(ct||(ct={}));var ou,su,hu,cu,it=(ou=function(n){function t(){return n.apply(this,arguments)}return t.toString=function(){return n.toString()},t}(function(n,t){return(ou=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)}),function(n,t){function i(){this.constructor=n}ou(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},pi=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Property("Line")],t.prototype,"type",void 0),o([sf.base.Property(null)],t.prototype,"color",void 0),o([sf.base.Property(1)],t.prototype,"width",void 0),o([sf.base.Property(null)],t.prototype,"length",void 0),o([sf.base.Property("")],t.prototype,"dashArray",void 0),t}(sf.base.ChildProperty),lt=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Property("Normal")],t.prototype,"fontStyle",void 0),o([sf.base.Property("16px")],t.prototype,"size",void 0),o([sf.base.Property("Normal")],t.prototype,"fontWeight",void 0),o([sf.base.Property("")],t.prototype,"color",void 0),o([sf.base.Property("Center")],t.prototype,"textAlignment",void 0),o([sf.base.Property("Segoe UI")],t.prototype,"fontFamily",void 0),o([sf.base.Property(1)],t.prototype,"opacity",void 0),o([sf.base.Property("Trim")],t.prototype,"textOverflow",void 0),t}(sf.base.ChildProperty),ot=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Property("")],t.prototype,"color",void 0),o([sf.base.Property(1)],t.prototype,"width",void 0),t}(sf.base.ChildProperty),gs=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Property(0)],t.prototype,"x",void 0),o([sf.base.Property(0)],t.prototype,"y",void 0),t}(sf.base.ChildProperty),nh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Complex({},ot)],t.prototype,"border",void 0),o([sf.base.Property("transparent")],t.prototype,"background",void 0),o([sf.base.Property(1)],t.prototype,"opacity",void 0),o([sf.base.Property(null)],t.prototype,"backgroundImage",void 0),t}(sf.base.ChildProperty),vr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Property(10)],t.prototype,"left",void 0),o([sf.base.Property(10)],t.prototype,"right",void 0),o([sf.base.Property(10)],t.prototype,"top",void 0),o([sf.base.Property(10)],t.prototype,"bottom",void 0),t}(sf.base.ChildProperty),th=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Property(0)],t.prototype,"left",void 0),o([sf.base.Property(0)],t.prototype,"right",void 0),o([sf.base.Property(0)],t.prototype,"top",void 0),o([sf.base.Property(0)],t.prototype,"bottom",void 0),t}(sf.base.ChildProperty),lu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Property(!0)],t.prototype,"enable",void 0),o([sf.base.Property(1e3)],t.prototype,"duration",void 0),o([sf.base.Property(0)],t.prototype,"delay",void 0),t}(sf.base.ChildProperty),ih=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Property(0)],t.prototype,"series",void 0),o([sf.base.Property(0)],t.prototype,"point",void 0),t}(sf.base.ChildProperty),rh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Property(0)],t.prototype,"topLeft",void 0),o([sf.base.Property(0)],t.prototype,"topRight",void 0),o([sf.base.Property(0)],t.prototype,"bottomLeft",void 0),o([sf.base.Property(0)],t.prototype,"bottomRight",void 0),t}(sf.base.ChildProperty),ui=function(n,t){this.series=n;this.point=t},uh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Property(null)],t.prototype,"fill",void 0),o([sf.base.Complex({color:"transparent",width:0},ot)],t.prototype,"border",void 0),o([sf.base.Property("Gap")],t.prototype,"mode",void 0),t}(sf.base.ChildProperty),fh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Property(!1)],t.prototype,"enable",void 0),o([sf.base.Property(null)],t.prototype,"minY",void 0),o([sf.base.Property(null)],t.prototype,"maxY",void 0),o([sf.base.Property(null)],t.prototype,"fill",void 0),t}(sf.base.ChildProperty),eh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Property(!1)],t.prototype,"enable",void 0),o([sf.base.Property(!0)],t.prototype,"enableMarker",void 0),o([sf.base.Property(!1)],t.prototype,"shared",void 0),o([sf.base.Property(null)],t.prototype,"fill",void 0),o([sf.base.Property(null)],t.prototype,"header",void 0),o([sf.base.Property(.75)],t.prototype,"opacity",void 0),o([sf.base.Complex(ct.tooltipLabelFont,lt)],t.prototype,"textStyle",void 0),o([sf.base.Property(null)],t.prototype,"format",void 0),o([sf.base.Property(null)],t.prototype,"template",void 0),o([sf.base.Property(!0)],t.prototype,"enableAnimation",void 0),o([sf.base.Property(300)],t.prototype,"duration",void 0),o([sf.base.Property(1e3)],t.prototype,"fadeOutDuration",void 0),o([sf.base.Property("Move")],t.prototype,"fadeOutMode",void 0),o([sf.base.Property(!1)],t.prototype,"enableTextWrap",void 0),o([sf.base.Complex({color:"#cccccc",width:.5},ot)],t.prototype,"border",void 0),t}(sf.base.ChildProperty),oh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Property("Years")],t.prototype,"intervalType",void 0),o([sf.base.Property(1)],t.prototype,"interval",void 0),o([sf.base.Property(null)],t.prototype,"text",void 0),o([sf.base.Property(!1)],t.prototype,"selected",void 0),t}(sf.base.ChildProperty),oy=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return it(t,n),o([sf.base.Property(43)],t.prototype,"height",void 0),o([sf.base.Property("Bottom")],t.prototype,"position",void 0),o([sf.base.Collection([],oh)],t.prototype,"periods",void 0),t}(sf.base.ChildProperty),bt=function(){function n(n,t){n<t?(this.mStart=n,this.mEnd=t):(this.mStart=t,this.mEnd=n)}return Object.defineProperty(n.prototype,"start",{get:function(){return this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"end",{get:function(){return this.mEnd},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"delta",{get:function(){return this.mEnd-this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"median",{get:function(){return this.mStart+(this.mEnd-this.mStart)/2},enumerable:!0,configurable:!0}),n}(),yr=function(){function n(n){this.isColumn=0;this.chart=n}return n.prototype.calculateNumericNiceInterval=function(n,t,i){var e=kr(i,n),r=t/e,f;if(!sf.base.isNullOrUndefined(n.desiredIntervals))return r;for(var s=Math.pow(10,Math.floor(nt(r,10))),u=0,o=n.intervalDivs;u<o.length;u++){if(f=s*o[u],e<t/f)break;r=f}return r},n.prototype.getActualRange=function(n,t){this.initializeDoubleRange(n);!n.startFromZero&&this.isColumn>0?(n.actualRange.interval=n.interval||this.calculateNumericNiceInterval(n,n.doubleRange.delta,t),n.actualRange.max=n.doubleRange.end+n.actualRange.interval,n.actualRange.min=n.doubleRange.start-n.actualRange.interval<0&&n.doubleRange.start>0?0:n.doubleRange.start-n.actualRange.interval):(n.actualRange.interval=n.interval||this.calculateNumericNiceInterval(n,n.doubleRange.delta,t),n.actualRange.min=n.doubleRange.start,n.actualRange.max=n.doubleRange.end)},n.prototype.initializeDoubleRange=function(n){null!==n.minimum?this.min=n.minimum:null!==this.min&&this.min!==Number.POSITIVE_INFINITY||(this.min=0);null!==n.maximum?this.max=n.maximum:null!==this.max&&this.max!==Number.NEGATIVE_INFINITY||(this.max=5);this.min===this.max&&(this.max=n.valueType.indexOf("Category")>-1?this.max:this.min+1);n.doubleRange=new bt(this.min,this.max);n.actualRange={}},n.prototype.calculateRangeAndInterval=function(n,t){this.calculateRange(t);this.getActualRange(t,n);this.applyRangePadding(t,n);this.calculateVisibleLabels(t,this.chart)},n.prototype.calculateRange=function(n){var i,r,t;if(this.min=null,this.max=null,!ki(n))for(i=0,r=n.series;i<r.length;i++)t=r[i],t.visible&&(this.paddingInterval=0,n.maxPointLength=t.points.length,((t.type.indexOf("Column")>-1||t.type.indexOf("Histogram")>-1)&&"Horizontal"===n.orientation||t.type.indexOf("Bar")>-1&&"Vertical"===n.orientation)&&("Double"!==t.xAxis.valueType&&"DateTime"!==t.xAxis.valueType||"Auto"!==t.xAxis.rangePadding||(this.paddingInterval=.5*gu(t.xAxis,n.series))),"Horizontal"===n.orientation&&(this.chart.requireInvertedAxis?this.yAxisRange(n,t):this.findMinMax(t.xMin-this.paddingInterval,t.xMax+this.paddingInterval)),"Vertical"===n.orientation&&(this.isColumn+="Column"===t.type||"Bar"===t.type||"Column"===t.drawType?1:0,this.chart.requireInvertedAxis?this.findMinMax(t.xMin-this.paddingInterval,t.xMax+this.paddingInterval):this.yAxisRange(n,t)))},n.prototype.yAxisRange=function(n,t){t.dragSettings.enable&&this.chart.dragY&&(this.chart.dragY>=n.visibleRange.max&&(t.yMax=this.chart.dragY+n.visibleRange.interval),this.chart.dragY<=n.visibleRange.min&&(t.yMin=this.chart.dragY-n.visibleRange.interval));this.findMinMax(t.yMin,t.yMax)},n.prototype.findMinMax=function(n,t){(null===this.min||this.min>n)&&(this.min=n);(null===this.max||this.max<t)&&(this.max=t);this.max===this.min&&this.max<0&&this.min<0&&(this.max=0)},n.prototype.applyRangePadding=function(n,t){var u=n.actualRange.min,f=n.actualRange.max,i,r;ki(n)||(i=n.actualRange.interval,r=n.getRangePadding(this.chart),"Additional"===r||"Round"===r?this.findAdditional(n,u,f,i):"Normal"===r?this.findNormal(n,u,f,i,t):this.updateActualRange(n,u,f,i));n.actualRange.delta=n.actualRange.max-n.actualRange.min;this.calculateVisibleRange(t,n)},n.prototype.updateActualRange=function(n,t,i,r){n.actualRange={min:null!=n.minimum?n.minimum:t,max:null!=n.maximum?n.maximum:i,interval:null!=n.interval?n.interval:r,delta:n.actualRange.delta}},n.prototype.findAdditional=function(n,t,i,r){var u,f;u=Math.floor(t/r)*r;f=Math.ceil(i/r)*r;"Additional"===n.rangePadding&&(u-=r,f+=r);this.updateActualRange(n,u,f,r)},n.prototype.findNormal=function(n,t,i,r,u){var f,e,o=t;t<0?(o=0,.365*r>=r+(f=t+.05*t)%r&&(f-=r),f%r<0&&(f=f-r-f%r)):(f=t<5/6*i?0:t-.5*(i-t))%r>0&&(f-=f%r);.365*r>=r-(e=i>0?i+.05*(i-o):i-.05*(i-o))%r&&(e+=r);e%r>0&&(e=e+r-e%r);n.doubleRange=new bt(f,e);0===f&&(r=this.calculateNumericNiceInterval(n,n.doubleRange.delta,u),e=Math.ceil(e/r)*r);this.updateActualRange(n,f,e,r)},n.prototype.calculateVisibleRange=function(n,t){if(t.visibleRange={max:t.actualRange.max,min:t.actualRange.min,delta:t.actualRange.delta,interval:t.actualRange.interval},"Cartesian"===this.chart.chartAreaType){var i=!sf.base.isNullOrUndefined(t.zoomingScrollBar)&&t.zoomingScrollBar.isLazyLoad;(t.zoomFactor<1||t.zoomPosition>0)&&!i&&(t.calculateVisibleRangeOnZooming(n),t.calculateAxisRange(n,this.chart),t.visibleRange.interval=t.enableAutoIntervalOnZooming&&"Category"!==t.valueType?this.calculateNumericNiceInterval(t,t.doubleRange.delta,n):t.visibleRange.interval)}t.triggerRangeRender(this.chart,t.visibleRange.min,t.visibleRange.max,t.visibleRange.interval)},n.prototype.calculateVisibleLabels=function(n,t){
/*! Generate axis labels */
var u,i;n.visibleLabels=[];i=n.visibleRange.min;"chart"===t.getModuleName()&&"PolarRadar"===t.chartAreaType||!(n.zoomFactor<1||n.zoomPosition>0||this.paddingInterval)||(i=n.visibleRange.min-n.visibleRange.min%n.visibleRange.interval);var s,r=this.getFormat(n),f=null!==r.match("{value}"),e=0,o=0;for(n.labelFormat&&n.labelFormat.indexOf("n")>-1&&(o=parseInt(n.labelFormat.substring(1,n.labelFormat.length),10)),n.format=t.intl.getNumberFormat({format:f?"":r,useGrouping:t.useGroupingSeparator}),n.startLabel=n.format(n.visibleRange.min),n.endLabel=n.format(n.visibleRange.max),n.visibleRange.interval&&(n.visibleRange.interval+"").indexOf(".")>=0&&(e=(n.visibleRange.interval+"").split(".")[1].length);i<=n.visibleRange.max&&s!==i;i+=n.visibleRange.interval)s=i,u=sf.base.extend({},sf.base.getValue("properties",n.labelStyle),null,!0),ut(i,n.visibleRange)&&vi(t,i,this.formatValue(n,f,r,i),u,n);i&&(i+"").indexOf(".")>=0&&(i+"").split(".")[1].length>10&&(i=(i+"").split(".")[1].length>(o||e)?+i.toFixed(o||e):i)<=n.visibleRange.max&&vi(t,i,this.formatValue(n,f,r,i),u,n);n.getMaxLabelWidth&&n.getMaxLabelWidth(this.chart)},n.prototype.getFormat=function(n){return n.labelFormat?0===n.labelFormat.indexOf("p")&&-1===n.labelFormat.indexOf("{value}")&&n.isStack100?"{value}%":n.labelFormat:n.isStack100?"{value}%":""},n.prototype.formatValue=function(n,t,i,r){return t?i.replace("{value}",n.format(r)):n.format(r)},n}(),pr=/~\d+~/g,sh=/\^\d+\^/g,ci=(su=function(n,t){return(su=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}su(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),c=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},hh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ci(t,n),c([sf.base.Property("0")],t.prototype,"x",void 0),c([sf.base.Property("0")],t.prototype,"y",void 0),c([sf.base.Property(null)],t.prototype,"content",void 0),c([sf.base.Property("Center")],t.prototype,"horizontalAlignment",void 0),c([sf.base.Property("Pixel")],t.prototype,"coordinateUnits",void 0),c([sf.base.Property("Chart")],t.prototype,"region",void 0),c([sf.base.Property("Middle")],t.prototype,"verticalAlignment",void 0),c([sf.base.Property(null)],t.prototype,"xAxisName",void 0),c([sf.base.Property(null)],t.prototype,"yAxisName",void 0),c([sf.base.Property(null)],t.prototype,"description",void 0),t}(sf.base.ChildProperty),au=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ci(t,n),c([sf.base.Property("")],t.prototype,"color",void 0),c([sf.base.Property(1)],t.prototype,"width",void 0),c([sf.base.Property("Rectangle")],t.prototype,"type",void 0),t}(sf.base.ChildProperty),ch=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ci(t,n),c([sf.base.Property(null)],t.prototype,"start",void 0),c([sf.base.Property(null)],t.prototype,"end",void 0),c([sf.base.Property("")],t.prototype,"text",void 0),c([sf.base.Property(null)],t.prototype,"maximumTextWidth",void 0),c([sf.base.Property(null)],t.prototype,"customAttributes",void 0),c([sf.base.Property("")],t.prototype,"type",void 0),t}(sf.base.ChildProperty),lh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ci(t,n),c([sf.base.Property(!0)],t.prototype,"visible",void 0),c([sf.base.Property(!1)],t.prototype,"startFromAxis",void 0),c([sf.base.Property(null)],t.prototype,"start",void 0),c([sf.base.Property(null)],t.prototype,"end",void 0),c([sf.base.Property(null)],t.prototype,"size",void 0),c([sf.base.Property("#808080")],t.prototype,"color",void 0),c([sf.base.Property(null)],t.prototype,"dashArray",void 0),c([sf.base.Property("Auto")],t.prototype,"sizeType",void 0),c([sf.base.Property(!1)],t.prototype,"isRepeat",void 0),c([sf.base.Property(null)],t.prototype,"repeatEvery",void 0),c([sf.base.Property(null)],t.prototype,"repeatUntil",void 0),c([sf.base.Property(!1)],t.prototype,"isSegmented",void 0),c([sf.base.Property(null)],t.prototype,"segmentStart",void 0),c([sf.base.Property(null)],t.prototype,"segmentEnd",void 0),c([sf.base.Property(null)],t.prototype,"segmentAxisName",void 0),c([sf.base.Complex({color:"transparent",width:1},ot)],t.prototype,"border",void 0),c([sf.base.Property("")],t.prototype,"text",void 0),c([sf.base.Property(null)],t.prototype,"rotation",void 0),c([sf.base.Property("Middle")],t.prototype,"horizontalAlignment",void 0),c([sf.base.Property("Middle")],t.prototype,"verticalAlignment",void 0),c([sf.base.Complex(ct.stripLineLabelFont,lt)],t.prototype,"textStyle",void 0),c([sf.base.Property("Behind")],t.prototype,"zIndex",void 0),c([sf.base.Property(1)],t.prototype,"opacity",void 0),t}(sf.base.ChildProperty),ah=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ci(t,n),c([sf.base.Property("Center")],t.prototype,"alignment",void 0),c([sf.base.Property("Wrap")],t.prototype,"overflow",void 0),c([sf.base.Complex(ct.axisLabelFont,lt)],t.prototype,"textStyle",void 0),c([sf.base.Complex({color:null,width:1,type:"Rectangle"},au)],t.prototype,"border",void 0),c([sf.base.Collection([],ch)],t.prototype,"categories",void 0),t}(sf.base.ChildProperty),vh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ci(t,n),c([sf.base.Property(null)],t.prototype,"minimum",void 0),c([sf.base.Property(null)],t.prototype,"maximum",void 0),t}(sf.base.ChildProperty),yh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ci(t,n),c([sf.base.Property(!1)],t.prototype,"enable",void 0),c([sf.base.Property(null)],t.prototype,"pointsLength",void 0),c([sf.base.Complex({},vh)],t.prototype,"range",void 0),t}(sf.base.ChildProperty),ti=(hu=function(n,t){return(hu=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}hu(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),f=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},ph=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.axes=[],t.nearSizes=[],t.farSizes=[],t}return ti(t,n),t.prototype.computeSize=function(n,t){var i=0;n.visible&&n.internalVisibility&&(i+=n.findTickSize(n.crossInAxis)+t+n.findLabelSize(n.crossInAxis,5)+.5*n.lineStyle.width);n.opposedPosition?this.farSizes.push(i):this.nearSizes.push(i)},f([sf.base.Property("100%")],t.prototype,"height",void 0),f([sf.base.Complex({},ot)],t.prototype,"border",void 0),t}(sf.base.ChildProperty),wh=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.axes=[],t.nearSizes=[],t.farSizes=[],t.padding=0,t}return ti(t,n),t.prototype.computeSize=function(n,t){var i=0;n.visible&&n.internalVisibility&&(i+=n.findTickSize(n.crossInAxis)+t+n.findLabelSize(n.crossInAxis,5)+.5*n.lineStyle.width);n.opposedPosition?this.farSizes.push(i):this.nearSizes.push(i)},f([sf.base.Property("100%")],t.prototype,"width",void 0),f([sf.base.Complex({},ot)],t.prototype,"border",void 0),t}(sf.base.ChildProperty),bh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),f([sf.base.Property(1)],t.prototype,"width",void 0),f([sf.base.Property("")],t.prototype,"dashArray",void 0),f([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),kh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),f([sf.base.Property(.7)],t.prototype,"width",void 0),f([sf.base.Property("")],t.prototype,"dashArray",void 0),f([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),dh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),f([sf.base.Property(1)],t.prototype,"width",void 0),f([sf.base.Property("")],t.prototype,"dashArray",void 0),f([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),gh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),f([sf.base.Property(1)],t.prototype,"width",void 0),f([sf.base.Property(5)],t.prototype,"height",void 0),f([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),nc=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),f([sf.base.Property(.7)],t.prototype,"width",void 0),f([sf.base.Property(5)],t.prototype,"height",void 0),f([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),tc=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),f([sf.base.Property(!1)],t.prototype,"enable",void 0),f([sf.base.Property(null)],t.prototype,"fill",void 0),f([sf.base.Complex(ct.crosshairLabelFont,lt)],t.prototype,"textStyle",void 0),t}(sf.base.ChildProperty),wi=function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return f.visibleLabels=[],f.series=[],f.rect=new sf.svgbase.Rect(void 0,void 0,0,0),f.axisBottomLine=null,f.intervalDivs=[10,5,2,1],f.isStack100=!1,f.crossAt=null,f.updatedRect=null,f.multiLevelLabelHeight=0,f.isChart=!0,f.isIntervalInDecimal=!0,f.titleCollection=[],f.titleSize=new sf.svgbase.Size(0,0),f.internalVisibility=!0,f.angle=f.labelRotation,f}return ti(t,n),t.prototype.findTickSize=function(n){return"Inside"===this.tickPosition?0:!n||n.visibleRange&&!this.isInside(n.visibleRange)?this.majorTickLines.height:0},t.prototype.isInside=function(n){return ai(this.crossAt,n)||!this.opposedPosition&&this.crossAt>=n.max||this.opposedPosition&&this.crossAt<=n.min},t.prototype.findLabelSize=function(n,t){var u,o,f=0,h="Horizontal"===this.orientation,s,i,r,e;if(this.title&&(this.titleSize=sf.svgbase.measureText(this.title,this.titleStyle),f=this.titleSize.height+t,this.rect.width||this.rect.height)&&(s=h?this.rect.width:this.rect.height,this.titleCollection=hr(this.title,this.titleStyle,s),f*=this.titleCollection.length),"Inside"===this.labelPosition)return f+t;if(i=f+t+this.titlePadding+this.labelPadding+("Vertical"===this.orientation?this.maxLabelSize.width:this.maxLabelSize.height)+this.multiLevelLabelHeight,n&&this.placeNextToAxisLine){if(r=n.visibleRange,e="Horizontal"===n.orientation?n.rect.width:n.rect.height,!r||!e)return 0;this.isInside(r)&&(i=(u=(o=this.findDifference(n))*((e-((u=o*(e/r.delta))<i?i-u:0))/r.delta))<i?i-u:0)}return i},t.prototype.updateCrossValue=function(){var n=this.crossAt,t;if(null===n||!this.isInside(this.crossInAxis.visibleRange))return this.updatedRect=this.rect,null;t=this.crossInAxis.visibleRange;this.opposedPosition?this.crossAt<t.min&&(n=t.min):this.crossAt>t.max&&(n=t.max);this.updatedRect=sf.base.extend({},this.rect,null,!0);"Horizontal"===this.orientation?(n=this.crossInAxis.rect.height-a(n,this.crossInAxis)*this.crossInAxis.rect.height,this.updatedRect.y=this.crossInAxis.rect.y+n):(n=a(n,this.crossInAxis)*this.crossInAxis.rect.width,this.updatedRect.x=this.crossInAxis.rect.x+n)},t.prototype.findDifference=function(n){var t=0;return t=this.opposedPosition?n.isInversed?n.visibleRange.min:n.visibleRange.max:n.isInversed?n.visibleRange.max:n.visibleRange.min,Math.abs(this.crossAt-t)},t.prototype.calculateVisibleRangeOnZooming=function(){if(yi(this)){var t=this.actualRange,n=void 0,i=void 0;i=this.isInversed?(n=this.actualRange.max-this.zoomPosition*this.actualRange.delta)-this.zoomFactor*this.actualRange.delta:(n=this.actualRange.min+this.zoomPosition*this.actualRange.delta)+this.zoomFactor*this.actualRange.delta;n<t.min&&(i+=t.min-n,n=t.min);i>t.max&&(n-=i-t.max,i=t.max);this.doubleRange=new bt(n,i);this.visibleRange={min:this.doubleRange.start,max:this.doubleRange.end,delta:this.doubleRange.delta,interval:this.visibleRange.interval}}},t.prototype.calculateAxisRange=function(n,t){var i,f,h,u,e,a,r;if(t.enableAutoIntervalOnBothAxis){if("Horizontal"===this.orientation&&"X"===t.zoomSettings.mode)for(i=0;i<this.series.length;i++){for(var o=[],s=0,v=this.series[i].visiblePoints;s<v.length;s++)(u=v[s]).xValue>this.visibleRange.min&&u.xValue<this.visibleRange.max&&o.push(u.yValue);for(f=0,h=t.axisCollections;f<h.length;f++)"Vertical"!==(r=h[f]).orientation||sf.base.isNullOrUndefined(r.series[i])||(r.series[i].yMin=Math.min.apply(Math,o),r.series[i].yMax=Math.max.apply(Math,o),r.baseModule.calculateRangeAndInterval(n,r))}if("Vertical"===this.orientation&&"Y"===t.zoomSettings.mode)for(i=0;i<this.series.length;i++){for(var c=[],l=0,y=this.series[i].visiblePoints;l<y.length;l++)(u=y[l]).yValue>this.visibleRange.min&&u.yValue<this.visibleRange.max&&c.push(u.xValue);for(e=0,a=t.axisCollections;e<a.length;e++)"Horizontal"!==(r=a[e]).orientation||sf.base.isNullOrUndefined(r.series[i])||(r.series[i].xMin=Math.min.apply(Math,c),r.series[i].xMax=Math.max.apply(Math,c),r.baseModule.calculateRangeAndInterval(n,r))}}},t.prototype.triggerRangeRender=function(n,t,i,r){var u={cancel:!1,name:"axisRangeCalculated",axis:this,minimum:t,maximum:i,interval:r};n.trigger("axisRangeCalculated",u);u.cancel||(this.visibleRange={min:u.minimum,max:u.maximum,interval:u.interval,delta:u.maximum-u.minimum})},t.prototype.getRangePadding=function(n){var t=this.rangePadding;if("Auto"!==t)return t;switch(this.orientation){case"Horizontal":t=n.requireInvertedAxis?this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal":"None";break;case"Vertical":t=n.requireInvertedAxis?"None":this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal"}return t},t.prototype.getMaxLabelWidth=function(n){var i,u,h=0,w=!1,c,l,e,s,p,k;this.angle=this.labelRotation;this.maxLabelSize=new sf.svgbase.Size(0,0);for(var t,f=this.labelIntersectAction,r=0,d=this.visibleLabels.length;r<d;r++)if((u=li((t=this.visibleLabels[r]).originalText))?(t.size=sf.svgbase.measureText(t.originalText.replace(/<br>/g," "),this.labelStyle),t.breakLabelSize=sf.svgbase.measureText(this.enableTrim?t.text.join("<br>"):t.originalText,this.labelStyle)):t.size=sf.svgbase.measureText(t.text,this.labelStyle),c=u?t.breakLabelSize.width:t.size.width,c>this.maxLabelSize.width&&(this.maxLabelSize.width=c,this.rotatedLabel=t.text),l=u?t.breakLabelSize.height:t.size.height,l>this.maxLabelSize.height&&(this.maxLabelSize.height=l),u&&(t.text=this.enableTrim?t.text:t.originalText.split("<br>")),"None"!==f&&"Hide"!==f&&"Trim"!==f&&("None"!==f||this.angle%360==0)&&"Horizontal"===this.orientation&&this.rect.width>0&&!w){e=u?t.breakLabelSize.width:t.size.width;switch(i=a(t.value,this)*this.rect.width+this.rect.x,i-=e/2,"Shift"===this.edgeLabelPlacement&&(0===r&&i<this.rect.x&&(i=this.rect.x),r===this.visibleLabels.length-1&&i+e>this.rect.x+this.rect.width&&(i=this.rect.x+this.rect.width-e)),f){case"MultipleRows":r>0&&this.findMultiRows(r,i,t,u);break;case"Rotate45":case"Rotate90":r>0&&(this.isInversed?i+e>=h:i<=h)&&(this.angle="Rotate45"===f?45:90,w=!0);break;default:if(u){for(var o=void 0,v=[],b=void 0,y=0;y<t.text.length;y++)if((o=nr(t.text[y],this.rect.width/this.visibleLabels.length,this.labelStyle)).length>1)for(s=0;s<o.length;s++)b=o[s],v.push(b);else v.push(o[0]);t.text=v}else t.text=nr(t.text,this.rect.width/this.visibleLabels.length,this.labelStyle);p=t.size.height*t.text.length;p>this.maxLabelSize.height&&(this.maxLabelSize.height=p)}h=this.isInversed?i:i+e}0!==this.angle&&"Horizontal"===this.orientation&&(this.rotatedLabel=sf.base.isNullOrUndefined(this.rotatedLabel)?"":this.rotatedLabel,k=-360===this.angle||0===this.angle||-180===this.angle||180===this.angle||360===this.angle,this.maxLabelSize="Outside"===this.labelPosition&&!k&&li(this.rotatedLabel)?new sf.svgbase.Size(this.maxLabelSize.height,this.maxLabelSize.width):fc(this.labelStyle,this.rotatedLabel,this.angle,n));n.multiLevelLabelModule&&this.multiLevelLabels.length>0&&n.multiLevelLabelModule.getMultilevelLabelsHeight(this)},t.prototype.findMultiRows=function(n,t,i,r){for(var u,e,o,h,s=[],f=n-1;f>=0;f--)u=this.visibleLabels[f],o=r?u.breakLabelSize.width:u.size.width,e=a(u.value,this)*this.rect.width+this.rect.x,(this.isInversed?t+i.size.width>e-.5*o:t<e+.5*o)?(s.push(u.index),i.index=i.index>u.index?i.index:u.index+1):i.index=s.indexOf(u.index)>-1?i.index:u.index;h=(r?i.breakLabelSize.height:i.size.height)*i.index+5*(i.index-1);h>this.maxLabelSize.height&&(this.maxLabelSize.height=h)},t.prototype.getModule=function(n){this.baseModule="Double"===this.valueType?new yr(n):n[tt(this.valueType)+"Module"]},f([sf.base.Complex(ct.axisLabelFont,lt)],t.prototype,"labelStyle",void 0),f([sf.base.Complex({},tc)],t.prototype,"crosshairTooltip",void 0),f([sf.base.Property("")],t.prototype,"title",void 0),f([sf.base.Complex(ct.axisTitleFont,lt)],t.prototype,"titleStyle",void 0),f([sf.base.Property("")],t.prototype,"labelFormat",void 0),f([sf.base.Property("")],t.prototype,"skeleton",void 0),f([sf.base.Property("DateTime")],t.prototype,"skeletonType",void 0),f([sf.base.Property("Center")],t.prototype,"lineBreakAlignment",void 0),f([sf.base.Property(0)],t.prototype,"plotOffset",void 0),f([sf.base.Property(null)],t.prototype,"plotOffsetLeft",void 0),f([sf.base.Property(null)],t.prototype,"plotOffsetTop",void 0),f([sf.base.Property(null)],t.prototype,"plotOffsetRight",void 0),f([sf.base.Property(null)],t.prototype,"plotOffsetBottom",void 0),f([sf.base.Property(!1)],t.prototype,"isIndexed",void 0),f([sf.base.Property(10)],t.prototype,"logBase",void 0),f([sf.base.Property(0)],t.prototype,"columnIndex",void 0),f([sf.base.Property(0)],t.prototype,"rowIndex",void 0),f([sf.base.Property(1)],t.prototype,"span",void 0),f([sf.base.Property(null)],t.prototype,"desiredIntervals",void 0),f([sf.base.Property(3)],t.prototype,"maximumLabels",void 0),f([sf.base.Property(1)],t.prototype,"zoomFactor",void 0),f([sf.base.Property(0)],t.prototype,"zoomPosition",void 0),f([sf.base.Property(!0)],t.prototype,"enableScrollbarOnZooming",void 0),f([sf.base.Property(!1)],t.prototype,"opposedPosition",void 0),f([sf.base.Property(!0)],t.prototype,"enableAutoIntervalOnZooming",void 0),f([sf.base.Property("Auto")],t.prototype,"rangePadding",void 0),f([sf.base.Property("Double")],t.prototype,"valueType",void 0),f([sf.base.Property("None")],t.prototype,"edgeLabelPlacement",void 0),f([sf.base.Property("Auto")],t.prototype,"intervalType",void 0),f([sf.base.Property("BetweenTicks")],t.prototype,"labelPlacement",void 0),f([sf.base.Property("Outside")],t.prototype,"tickPosition",void 0),f([sf.base.Property("Outside")],t.prototype,"labelPosition",void 0),f([sf.base.Property("")],t.prototype,"name",void 0),f([sf.base.Property(!0)],t.prototype,"visible",void 0),f([sf.base.Property(0)],t.prototype,"minorTicksPerInterval",void 0),f([sf.base.Property(0)],t.prototype,"labelRotation",void 0),f([sf.base.Property(null)],t.prototype,"crossesAt",void 0),f([sf.base.Property(!0)],t.prototype,"placeNextToAxisLine",void 0),f([sf.base.Property(null)],t.prototype,"crossesInAxis",void 0),f([sf.base.Property(null)],t.prototype,"minimum",void 0),f([sf.base.Property(null)],t.prototype,"maximum",void 0),f([sf.base.Property(null)],t.prototype,"interval",void 0),f([sf.base.Property(34)],t.prototype,"maximumLabelWidth",void 0),f([sf.base.Property(!1)],t.prototype,"enableTrim",void 0),f([sf.base.Property(5)],t.prototype,"labelPadding",void 0),f([sf.base.Property(5)],t.prototype,"titlePadding",void 0),f([sf.base.Complex({},gh)],t.prototype,"majorTickLines",void 0),f([sf.base.Complex({},nc)],t.prototype,"minorTickLines",void 0),f([sf.base.Complex({},bh)],t.prototype,"majorGridLines",void 0),f([sf.base.Complex({},kh)],t.prototype,"minorGridLines",void 0),f([sf.base.Complex({},dh)],t.prototype,"lineStyle",void 0),f([sf.base.Property("Trim")],t.prototype,"labelIntersectAction",void 0),f([sf.base.Property(!1)],t.prototype,"isInversed",void 0),f([sf.base.Property(100)],t.prototype,"coefficient",void 0),f([sf.base.Property(0)],t.prototype,"startAngle",void 0),f([sf.base.Property(!0)],t.prototype,"startFromZero",void 0),f([sf.base.Property(null)],t.prototype,"description",void 0),f([sf.base.Property(2)],t.prototype,"tabIndex",void 0),f([sf.base.Collection([],lh)],t.prototype,"stripLines",void 0),f([sf.base.Collection([],ah)],t.prototype,"multiLevelLabels",void 0),f([sf.base.Complex({color:null,width:0,type:"Rectangle"},au)],t.prototype,"border",void 0),f([sf.base.Complex({},yh)],t.prototype,"scrollbarSettings",void 0),t}(sf.base.ChildProperty),ic=function(n,t,i,r,u,f,e){void 0===u&&(u=new sf.svgbase.Size(0,0));void 0===f&&(f=new sf.svgbase.Size(0,0));void 0===e&&(e=1);this.text=n;this.originalText=r;this.value=t;this.labelStyle=i;this.size=u;this.breakLabelSize=f;this.index=e},rc=(cu=function(n,t){return(cu=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}cu(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});wu=function(n,t,i,r,u,f){this.verticalStandardMean=n;this.horizontalStandardMean=i;this.verticalSquareRoot=t;this.horizontalSquareRoot=r;this.verticalMean=u;this.horizontalMean=f};bu=function(n,t,i,r,u){this.startAngle=n;this.endAngle=t;this.innerRadius=i;this.radius=r;this.currentXPosition=u};var sy=function(n){this.id=n},tl=function(n,t){this.startValues=n;this.endValues=t},y=function(n){function t(t,i,r,u,f,e,o,s,h){var c=n.call(this,t,i,r.width,r.color,u,h)||this;return c.y=f.y,c.x=f.x,c.height=f.height,c.width=f.width,c.rx=e||0,c.ry=o||0,c.transform=s||"",c.stroke=0!==r.width&&""!==c.stroke?r.color:"transparent",c}return rc(t,n),t}(sf.svgbase.PathOption),vf=function(n,t,i,r,u,f,e,o){this.height=n;this.width=t;this.href=i;this.x=r;this.y=u;this.id=f;this.visibility=e;this.preserveAspectRatio=o},si=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,t,i,r.width,r.color,u)||this;return s.cy=e,s.cx=f,s.r=o,s}return rc(t,n),t}(sf.svgbase.PathOption),il=function(n,t,i){this.id=n;this.points=t;this.fill=i},s=function(n,t){this.x=n;this.y=t},hy=function(n,t){this.x=0;this.y=0;this.x=n;this.y=t},gt=function(n,t,i,r){this.left=n;this.right=t;this.top=i;this.bottom=r},cr=function(n,t,i){this.r=n;this.g=t;this.b=i},tr=function(n,t,i){void 0===i&&(i=0);this.point=n;this.series=t;this.lierIndex=i},cy=function(n,t,i){void 0===i&&(i=0);this.point=n;this.series=t;this.index=i},ru=function(n,t){this.controlPoint1=n;this.controlPoint2=t};var yf,pf,wf,bf,kf,df,gf,ne,te,ie,re,ue,fe,ee,oe,se,he,ce,le,ae,ve,ye,pe,we,be,ke,de,ge,no,to,io,ro,uo,fo,eo,oo,so,ho,co,lo,ao,vo,yo,po,wo,bo,ko,go,ns,ts,is,rs,us,fs,es,os,ss,ly=function(){function n(n){this.chart=n;this.padding=5}return n.prototype.measureAxis=function(n){var t=this.chart;this.crossAt(t);this.seriesClipRect=new sf.svgbase.Rect(n.x,n.y,n.width,n.height);this.initialClipRect=n;this.leftSize=0;this.rightSize=0;this.topSize=0;this.bottomSize=0;this.measureRowAxis(t,this.initialClipRect);this.initialClipRect=kt(this.initialClipRect,new gt(this.leftSize,this.rightSize,0,0));this.measureColumnAxis(t,this.initialClipRect);this.initialClipRect=kt(this.initialClipRect,new gt(0,0,this.topSize,this.bottomSize));this.chart.delayRedraw||this.calculateAxisSize(this.initialClipRect);this.leftSize=0;this.rightSize=0;this.topSize=0;this.bottomSize=0;this.measureRowAxis(t,this.initialClipRect);this.seriesClipRect=kt(this.seriesClipRect,new gt(this.leftSize,this.rightSize,0,0));this.measureColumnAxis(t,this.initialClipRect);this.seriesClipRect=kt(this.seriesClipRect,new gt(0,0,this.topSize,this.bottomSize));this.chart.delayRedraw||(t.refreshAxis(),this.calculateAxisSize(this.seriesClipRect))},n.prototype.measureRowAxis=function(n,t){var i,r,u;for(this.calculateRowSize(t),r=0,u=n.rows;r<u.length;r++)(i=u[r]).nearSizes=[],i.farSizes=[],this.arrangeAxis(i),this.measureDefinition(i,n,new sf.svgbase.Size(n.availableSize.width,i.computedHeight)),this.leftSize<g(i.nearSizes)&&(this.leftSize=g(i.nearSizes)),this.rightSize<g(i.farSizes)&&(this.rightSize=g(i.farSizes))},n.prototype.measureColumnAxis=function(n,t){var i,r,u;for(this.calculateColumnSize(t),r=0,u=n.columns;r<u.length;r++)(i=u[r]).farSizes=[],i.nearSizes=[],this.arrangeAxis(i),this.measureDefinition(i,n,new sf.svgbase.Size(i.computedWidth,n.availableSize.height)),this.bottomSize<g(i.nearSizes)&&(this.bottomSize=g(i.nearSizes)),this.topSize<g(i.farSizes)&&(this.topSize=g(i.farSizes))},n.prototype.measureDefinition=function(n,t,i){for(var r,u=0,f=n.axes;u<f.length;u++)r=f[u],r.scrollBarHeight=t.scrollBarModule&&t.zoomModule&&t.zoomSettings.enableScrollbar&&r.enableScrollbarOnZooming&&t.zoomModule.isZoomed&&(r.zoomFactor<1||r.zoomPosition>0)?16:0,r.scrollBarHeight=t.scrollBarModule&&(t.zoomModule&&t.zoomSettings.enableScrollbar&&r.enableScrollbarOnZooming&&t.zoomModule.isZoomed&&(r.zoomFactor<1||r.zoomPosition>0)||r.scrollbarSettings.enable)?16:0,r.getModule(t),r.baseModule.calculateRangeAndInterval(i,r),n.computeSize(r,r.scrollBarHeight);n.farSizes.length>0&&(n.farSizes[n.farSizes.length-1]-=10);n.nearSizes.length>0&&(n.nearSizes[n.nearSizes.length-1]-=10)},n.prototype.calculateAxisSize=function(n){var f,l,p,t,e,o,a,s=this.chart,h=0,c=0,v=0,i,y,r,w,u,b,k,d;for(this.calculateRowSize(n),i=0,y=s.rows.length;i<y;i++)for(h=0,c=0,r=0,w=(f=s.rows[i]).axes.length;r<w;r++){if(a=(t=f.axes[r]).plotOffset,0===t.rect.height){for(t.rect.height=f.computedHeight,v=0,u=i+1,b=i+t.span;u<b;u++)v+=(p=s.rows[u]).computedHeight;t.rect.y=f.computedTop-v+(t.plotOffsetTop?t.plotOffsetTop:a);t.rect.height=t.rect.height+v-this.getAxisOffsetValue(t.plotOffsetTop,t.plotOffsetBottom,t.plotOffset);t.rect.width=0}t.opposedPosition?(e=n.x+n.width+g(fr(f.farSizes,c)),t.rect.x=t.rect.x>=e?t.rect.x:e,c++):(e=n.x-g(fr(f.nearSizes,h)),t.rect.x=t.rect.x<=e?t.rect.x:e,h++)}for(this.calculateColumnSize(n),i=0,y=s.columns.length;i<y;i++)for(h=0,c=0,r=0,k=(l=s.columns[i]).axes.length;r<k;r++){if(a=(t=l.axes[r]).plotOffset,0===t.rect.width){for(u=i,d=i+t.span;u<d;u++)p=s.columns[u],t.rect.width+=p.computedWidth;t.rect.x=l.computedLeft+(t.plotOffsetLeft?t.plotOffsetLeft:a);t.rect.width-=this.getAxisOffsetValue(t.plotOffsetLeft,t.plotOffsetRight,t.plotOffset);t.rect.height=0}t.opposedPosition?(o=n.y-g(fr(l.farSizes,c)),t.rect.y=t.rect.y<=o?t.rect.y:o,c++):(o=n.y+n.height+g(fr(l.nearSizes,h)),t.rect.y=t.rect.y>=o?t.rect.y:o,h++)}},n.prototype.measure=function(){for(var t,r,u,f,e,i,o,n=this.chart,s=0,h=n.axisCollections;s<h.length;s++)if(t=h[s],"Vertical"===t.orientation){for(n.verticalAxes.push(t),i=this.getActualRow(t),u=n.rows[i],this.pushAxis(u,t),o=i+t.span>n.rows.length?n.rows.length:i+t.span,r=i+1;r<o;r++)(e=n.rows[r]).axes[u.axes.length-1]=t,n.rows[r]=e;n.rows[i]=u}else{for(n.horizontalAxes.push(t),i=this.getActualColumn(t),f=n.columns[i],this.pushAxis(f,t),o=i+t.span>n.columns.length?n.columns.length:i+t.span,r=i+1;r<o;r++)(e=n.columns[r]).axes[f.axes.length-1]=t,n.columns[r]=e;n.columns[i]=f}},n.prototype.getAxisOffsetValue=function(n,t,i){return n?n+(t||i):t?t+i:2*i},n.prototype.crossAt=function(n){for(var t,i,f,r=0,u=n.axisCollections;r<u.length;r++)if(t=u[r],null!==t.crossesAt)if(t.crossesInAxis)for(i=2,f=n.axisCollections.length;i<f;i++)t.crossesInAxis!==n.axisCollections[i].name||(t.crossInAxis=n.axisCollections[i],t.crossAt=this.updateCrossAt(t.crossInAxis,t.crossesAt));else t.crossInAxis=n.requireInvertedAxis?"Horizontal"===t.orientation?n.primaryXAxis:n.primaryYAxis:"Horizontal"===t.orientation?n.primaryYAxis:n.primaryXAxis,t.crossAt=this.updateCrossAt(t.crossInAxis,t.crossesAt)},n.prototype.updateCrossAt=function(n,t){switch(n.valueType){case"DateTime":var i={skeleton:"full",type:"dateTime"},r=this.chart.intl.getDateParser(i),u=this.chart.intl.getDateFormat(i);return Date.parse(r(u(new Date(sf.data.DataUtil.parse.parseJson({val:t}).val))));case"Category":return parseFloat(t)?parseFloat(t):n.labels.indexOf(t);case"Logarithmic":return nt(t,n.logBase);default:return t}},n.prototype.pushAxis=function(n,t){for(var i=0,r=n.axes.length;i<=r;i++)if(!n.axes[i]){n.axes[i]=t;break}},n.prototype.arrangeAxis=function(n){for(var i=[],t=0,r=n.axes.length;t<=r;t++)n.axes[t]&&i.push(n.axes[t]);n.axes=i},n.prototype.getActualColumn=function(n){var i=this.chart.columns.length,t=n.columnIndex;return t>=i?i-1:t<0?0:t},n.prototype.getActualRow=function(n){var i=this.chart.rows.length,t=n.rowIndex;return t>=i?i-1:t<0?0:t},n.prototype.calculateRowSize=function(n){for(var i,f=this.chart,e=n.y+n.height,t=0,r=Math.max(0,n.height),u=0,o=f.rows.length;u<o;u++)t=-1!==(i=f.rows[u]).height.indexOf("%")?Math.min(r,n.height*parseInt(i.height,10)/100):Math.min(r,parseInt(i.height,10)),t=u!==o-1?t:r,i.computedHeight=t,e-=t,i.computedTop=e,r-=t},n.prototype.calculateColumnSize=function(n){for(var i,f=this.chart,e=n.x,t=0,r=Math.max(0,n.width),u=0,o=f.columns.length;u<o;u++)t=-1!==(i=f.columns[u]).width.indexOf("%")?Math.min(r,n.width*parseInt(i.width,10)/100):Math.min(r,parseInt(i.width,10)),t=u!==o-1?t:r,i.computedWidth=t,i.computedLeft=e,e+=t,r-=t},n.prototype.renderAxes=function(){for(var f,s,c,n,r,u,t=this.chart,o=t.renderer.createGroup({id:t.element.id+"AxisInsideCollection"}),l=t.renderer.createGroup({id:t.element.id+"AxisOutsideCollection"}),i=0,e=t.axisCollections.length;i<e;i++)n=t.axisCollections[i],this.element=t.renderer.createGroup({id:t.element.id+"AxisGroup"+i+"Inside"}),r=t.renderer.createGroup({id:t.element.id+"AxisGroup"+i+"Outside"}),u=this.findAxisPosition(n),"Horizontal"===n.orientation?(n.updateCrossValue(),n.visible&&n.internalVisibility&&n.lineStyle.width>0&&this.drawAxisLine(n,i,n.plotOffset,0,u?r:this.element,n.updatedRect),(n.majorGridLines.width>0||n.majorTickLines.width>0)&&this.drawXAxisGridLine(n,i,u||"Inside"===n.tickPosition?r:this.element,n.updatedRect),n.visible&&n.internalVisibility&&(this.drawXAxisLabels(n,i,u||"Inside"===n.labelPosition?r:this.element,n.placeNextToAxisLine?n.updatedRect:n.rect),this.drawXAxisBorder(n,i,u||"Inside"===n.labelPosition?r:this.element,n.placeNextToAxisLine?n.updatedRect:n.rect),this.drawXAxisTitle(n,i,u?r:this.element,n.placeNextToAxisLine?n.updatedRect:n.rect))):(n.updateCrossValue(),n.visible&&n.internalVisibility&&n.lineStyle.width>0&&this.drawAxisLine(n,i,0,n.plotOffset,u?r:this.element,n.updatedRect),(n.majorGridLines.width>0||n.majorTickLines.width>0)&&this.drawYAxisGridLine(n,i,u||"Inside"===n.tickPosition?r:this.element,n.updatedRect),n.visible&&n.internalVisibility&&(this.drawYAxisLabels(n,i,u||"Inside"===n.labelPosition?r:this.element,n.placeNextToAxisLine?n.updatedRect:n.rect),this.drawYAxisBorder(n,i,u||"Inside"===n.labelPosition?r:this.element,n.placeNextToAxisLine?n.updatedRect:n.rect),this.drawYAxisTitle(n,i,u?r:this.element,n.placeNextToAxisLine?n.updatedRect:n.rect))),this.chart.enableCanvas||(o.appendChild(this.element),r&&r.childNodes.length>0&&l.appendChild(r)),t.scrollBarModule&&(t.zoomSettings.enableScrollbar&&n.enableScrollbarOnZooming||n.scrollbarSettings.enable)&&this.renderScrollbar(t,n);for(this.element=t.renderer.createGroup({id:t.element.id+"DefinitionLine"}),f=0,e=t.rows.length;f<e;f++)s=t.rows[f],s.border.color&&this.drawBottomLine(s,f,!0);for(f=0,e=t.columns.length;f<e;f++)c=t.columns[f],c.border.color&&this.drawBottomLine(c,f,!1);return this.chart.enableCanvas||o.appendChild(this.element),h(t.enableCanvas,t.svgObject,o,t.redraw),l},n.prototype.renderScrollbar=function(n,t){(!sf.base.isNullOrUndefined(n.zoomModule)&&n.zoomModule.isZoomed&&(t.zoomFactor<1||t.zoomPosition>0)||t.scrollbarSettings.enable&&(t.zoomFactor<=1||t.zoomPosition>=0))&&(!t.zoomingScrollBar.isScrollUI||n.visibleSeries[0].type.indexOf("Bar")>=0)?(n.scrollElement||(n.scrollElement=yt(n.redraw,n.element.id+"_scrollElement")||sf.base.createElement("div",{id:n.element.id+"_scrollElement"})),h(!1,n.scrollElement,t.zoomingScrollBar.render(!0),!0)):1===t.zoomFactor&&0===t.zoomPosition&&t.zoomingScrollBar.svgObject&&!t.scrollbarSettings.enable&&t.zoomingScrollBar.destroy();t.zoomingScrollBar.isScrollUI&&(t.zoomingScrollBar.isScrollUI=!1)},n.prototype.findAxisPosition=function(n){return null!==n.crossAt&&n.isInside(n.crossInAxis.visibleRange)},n.prototype.drawBottomLine=function(n,t,i){var s,r,u,f,e,o,h=this.chart;i?(f=e=(n=n).computedTop+n.computedHeight,u=(r=this.seriesClipRect.x)+this.seriesClipRect.width,o="Row"):(r=u=(n=n).computedLeft,e=(f=this.seriesClipRect.y)+this.seriesClipRect.height,o="Column");s={id:h.element.id+"_AxisBottom_"+o+t,x1:r,y1:f,x2:u,y2:e,"stroke-width":n.border.width,stroke:n.border.color};this.htmlObject=h.renderer.drawLine(s);this.element.appendChild(this.htmlObject)},n.prototype.drawAxisLine=function(n,t,i,u,f,e){var c,o=this.chart,s=r(o.element.id+"AxisLine_"+t),l=s?s.getAttribute("d"):"";s=null;c={id:o.element.id+"AxisLine_"+t,d:"M "+(e.x-i)+" "+(e.y-u)+" L "+(e.x+e.width+i)+" "+(e.y+e.height+u),"stroke-dasharray":n.lineStyle.dashArray,"stroke-width":n.lineStyle.width,stroke:n.lineStyle.color||o.themeStyle.axisLine};this.htmlObject=o.renderer.drawPath(c);h(o.enableCanvas,f,this.htmlObject,o.redraw,!0,"x","y",null,l)},n.prototype.drawYAxisGridLine=function(n,t,i,r){var o,h,v="Logarithmic"===n.valueType,y=n.valueType.indexOf("Category")>-1,f=0,p="",w="",b=n.opposedPosition?n.majorTickLines.height:-n.majorTickLines.height,c=n.opposedPosition?.5*n.lineStyle.width:.5*-n.lineStyle.width,k="Category"===n.valueType&&"BetweenTicks"===n.labelPlacement?.5:0,d=sf.base.isNullOrUndefined(n.crossesAt)?n.opposedPosition?n.scrollBarHeight:-n.scrollBarHeight:0,g="Inside"===n.tickPosition,tt=g?r.x-b-c:r.x+b+c+d,s=n.visibleLabels.length,e=this.chart.themeStyle;n.valueType.indexOf("Category")>-1&&"BetweenTicks"===n.labelPlacement&&s>0&&(s+=1);for(var l=n.minorGridLines,nt=n.minorTickLines,u=0;u<s;u++)(f=-1*(f=a(o=n.visibleLabels[u]?n.visibleLabels[u].value-k:n.visibleLabels[u-1].value+n.visibleRange.interval-k,n)*r.height)+(r.y+r.height))>=r.y&&r.y+r.height>=f&&((ai(o,n.visibleRange)||this.isBorder(n,u,f))&&(p="M "+this.seriesClipRect.x+" "+f+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+f,this.renderGridLine(n,t,p,n.majorGridLines,"_MajorGridLine_",u,this.element,e.majorGridLine,n.majorGridLines.dashArray)),w="M "+(r.x+c+(g?d:0))+" "+f+" L "+tt+" "+f,this.renderGridLine(n,t,w,n.majorTickLines,"_MajorTickLine_",u,i,e.majorTickLine),(l.width>0||nt.width>0)&&n.minorTicksPerInterval>0&&(0!==u||!yi(n)||v||y||this.renderMinorGridOnZooming(n,o,r,u,t,e,i),h=this.drawAxisMinorLine(n,o,r,u),this.renderGridLine(n,t,h[0],l,"_MinorGridLine_",u,this.element,e.minorGridLine,l.dashArray),this.renderGridLine(n,t,h[1],nt,"_MinorTickLine_",u,i,e.minorTickLine),u===s-1&&yi(n)&&v&&!y&&this.renderMinorGridOnZooming(n,o+n.visibleRange.interval,r,u,t,e,i)))},n.prototype.isBorder=function(n,t,i){var e=this.chart.chartArea.border,r=this.seriesClipRect,u=n.orientation,f="Horizontal"===u?r.x:r.y,o="Horizontal"===u?r.width:r.height,s="Horizontal"===u?0:n.visibleLabels.length-1,h="Horizontal"===u?n.visibleLabels.length-1:0;return n.plotOffset>0||(i===f||i===f+o)&&(e.width<=0||"transparent"===e.color)||i!==f&&t===s||i!==f+o&&t===h},n.prototype.drawYAxisLabels=function(n,t,i,r){var o,s,c,e=this.chart,l=0,u=0,rt=n.labelPadding,w="Inside"===n.labelPosition,b=n.opposedPosition,v=(n.labelPosition===n.tickPosition?n.majorTickLines.height:0)+rt+.5*n.lineStyle.width,p,it;v=n.opposedPosition?v:-v;p=b&&w||!b&&!w?"end":"start";p=e.isRtlEnabled?n.opposedPosition?"end":"start":p;for(var d,g,nt,tt=e.renderer.createGroup({id:e.element.id+"AxisLabels"+t}),ut=sf.base.isNullOrUndefined(n.crossesAt)?n.scrollBarHeight*(b?1:-1):0,f=0,y=n.visibleLabels.length;f<y;f++){if(c=li(n.visibleLabels[f].originalText),l=w?r.x-v:r.x+v+ut,o=c?n.visibleLabels[f].breakLabelSize:n.visibleLabels[f].size,u=a(n.visibleLabels[f].value,n)*r.height+(e.stockChart?7:0),u=Math.floor(-1*u+(r.y+r.height)),d=o.height/8*n.visibleLabels[f].text.length/2,g=o.height/4*3+3,u=c?"Inside"===n.labelPosition?u-o.height/2-d+g:u-d:"Inside"===n.labelPosition?u+g:u+o.height/4,nt=n.majorGridLines.width>n.majorTickLines.width?n.majorGridLines.width:n.majorTickLines.width,"Far"===n.labelStyle.textAlignment?u=u-nt-10:"Near"===n.labelStyle.textAlignment?u=u+nt+10:"Center"===n.labelStyle.textAlignment&&(u=u),l=c?this.getAxisLabelXvalue(l,n,o.width):l,it=c?this.getAnchor(n):p,s=new sf.svgbase.TextOption(e.element.id+t+"_AxisLabel_"+f,l,u,it,n.visibleLabels[f].text),n.edgeLabelPlacement)switch(n.edgeLabelPlacement){case"Hide":((0===f||n.isInversed&&f===y-1)&&s.y>r.y+r.height||(f===y-1||n.isInversed&&0===f)&&s.y-.5*o.height<r.y)&&(s.text="");break;case"Shift":(0===f||n.isInversed&&f===y-1)&&s.y>r.y+r.height?s.y=u=r.y+r.height:(f===y-1||n.isInversed&&0===f)&&s.y-.5*o.height<r.y&&(s.y=u=r.y+.5*o.height)}k(e.renderer,s,n.labelStyle,n.labelStyle.color||e.themeStyle.axisLabel,tt,!1,e.redraw,!0,!0,null,null,0,null,e.enableCanvas)}this.chart.enableCanvas||(e.delayRedraw?n.visible&&n.internalVisibility&&this.createZoomingLabel(this.chart,tt,n,t,r):h(e.enableCanvas,i,tt,e.redraw))},n.prototype.getAxisLabelXvalue=function(n,t,i){var r=t.lineBreakAlignment,u="Inside"===t.labelPosition,f=t.opposedPosition;return f&&u||!f&&!u?"Right"===r?n:"Center"===r?n-i/2:n-i:"Left"===r?n:"Center"===r?n+i/2:n+i},n.prototype.drawYAxisBorder=function(n,t,i,r){if(n.border.width>0){var f=void 0,s=void 0,u="Outside"===n.labelPosition?n.scrollBarHeight:0;u=(n.opposedPosition?1:-1)*u;for(var l=r.height/n.visibleRange.delta*("DateTime"===n.valueType?n.dateTimeInterval:n.visibleRange.interval),e=void 0,v=n.maxLabelSize.width+10+(n.tickPosition===n.labelPosition?n.majorTickLines.height:0),h="",y="Category"===n.valueType&&"BetweenTicks"===n.labelPlacement?-.5:0,o=n.opposedPosition&&"Inside"===n.labelPosition||!n.opposedPosition&&"Outside"===n.labelPosition?r.x-v+u:r.x+v+u,c=0,p=n.visibleLabels.length;c<p;c++)switch(s=a(n.visibleLabels[c].value+y,n),s=(n.isInversed?1-s:s)*r.height,"Category"===n.valueType&&"BetweenTicks"===n.labelPlacement?(f=-1*s+(r.y+r.height),e=-1*s-l+(r.y+r.height)):(f=-1*s+l/2+(r.y+r.height),e=-1*s-l/2+(r.y+r.height)),n.border.type){case"Rectangle":case"WithoutTopBorder":f>r.y+r.height?h+="M "+o+" "+(r.y+r.height)+" L "+o+" "+e+" ":Math.floor(r.y)>e?h+="M "+(r.x+u)+" "+f+" L "+o+" "+f+" L "+o+" "+r.y+" ":(h+="M "+(r.x+u)+" "+f+" L "+o+" "+f+" L "+o+" "+e+" ",c===n.visibleLabels.length-1&&(h+="M "+(r.x+u)+" "+e+" L "+o+" "+e+" "));break;case"WithoutTopandBottomBorder":f>r.y+r.height||e<Math.floor(r.y)||(h+="M "+(r.x+u)+" "+f+" L "+o+" "+f+" M "+o+" "+e+" L "+(r.x+u)+" "+e)}""!=(h+="Rectangle"===n.border.type?"M "+(r.x+u)+" "+r.y+" L "+(r.x+u)+" "+(r.y+r.height)+" ":"")&&this.createAxisBorderElement(n,t,h,i)}n.multiLevelLabels.length>0&&this.chart.multiLevelLabelModule&&this.chart.multiLevelLabelModule.renderYAxisMultiLevelLabels(n,t,i,r)},n.prototype.drawYAxisTitle=function(n,t,i,r){if(n.title){var u=this.chart,e=n.opposedPosition?90:-90,f=("Inside"===n.tickPosition?0:n.majorTickLines.height+n.titlePadding)+("Inside"===n.labelPosition?0:n.maxLabelSize.width+n.multiLevelLabelHeight+this.padding);f=n.opposedPosition?f+n.scrollBarHeight:-f-n.scrollBarHeight;var o=r.x+f,s=r.y+.5*r.height,c=n.titleSize.height*(n.titleCollection.length-1),l=new sf.svgbase.TextOption(u.element.id+"_AxisTitle_"+t,o,s-n.labelPadding-c,"middle",n.titleCollection,"rotate("+e+","+o+","+s+")",null,e),h=k(u.renderer,l,n.titleStyle,n.titleStyle.color||u.themeStyle.axisTitle,i,null,null,null,null,null,null,0,null,u.enableCanvas);h.setAttribute("tabindex",n.tabIndex.toString());h.setAttribute("aria-label",n.description||n.title)}},n.prototype.drawXAxisGridLine=function(n,t,i,r){var o,h,v="Logarithmic"===n.valueType,y=n.valueType.indexOf("Category")>-1,f=0,p="",w="",b=n.opposedPosition?-n.majorTickLines.height:n.majorTickLines.height,c=n.opposedPosition?.5*-n.lineStyle.width:.5*n.lineStyle.width,k=sf.base.isNullOrUndefined(n.crossesAt)?n.opposedPosition?-n.scrollBarHeight:n.scrollBarHeight:0,l=n.valueType.indexOf("Category")>-1&&"BetweenTicks"===n.labelPlacement?.5:0,s=n.visibleLabels.length,d="Inside"===n.tickPosition,g=d?r.y-b-c:r.y+b+c+k,e=this.chart.themeStyle,u;for(n.valueType.indexOf("Category")>-1&&s>0&&"BetweenTicks"===n.labelPlacement&&(s+=1),u=0;u<s;u++)(f=a(o="DateTimeCategory"!==n.valueType?n.visibleLabels[u]?n.visibleLabels[u].value-l:n.visibleLabels[u-1].value+n.visibleRange.interval-l:n.visibleLabels[u]?n.visibleLabels[u].value-l:n.visibleRange.max,n)*r.width+r.x)>=r.x&&r.x+r.width>=f&&((ai(o,n.visibleRange)||this.isBorder(n,u,f))&&(p="M "+f+" "+(this.seriesClipRect.y+this.seriesClipRect.height)+" L "+f+" "+this.seriesClipRect.y,this.renderGridLine(n,t,p,n.majorGridLines,"_MajorGridLine_",u,this.element,e.majorGridLine,n.majorGridLines.dashArray)),w="M "+f+" "+(r.y+c+(d?k:0))+" L "+f+" "+g,this.renderGridLine(n,t,w,n.majorTickLines,"_MajorTickLine_",u,i,e.majorTickLine),n.minorTicksPerInterval>0&&(n.minorGridLines.width>0||n.minorTickLines.width>0)&&(0!==u||!yi(n)||v||y||this.renderMinorGridOnZooming(n,o,r,u,t,e,i),h=this.drawAxisMinorLine(n,o,r,u),this.renderGridLine(n,t,h[0],n.minorGridLines,"_MinorGridLine_",u,this.element,e.minorGridLine,n.minorGridLines.dashArray),this.renderGridLine(n,t,h[1],n.minorTickLines,"_MinorTickLine_",u,i,e.minorTickLine),u===s-1&&yi(n)&&v&&!y&&this.renderMinorGridOnZooming(n,o+n.visibleRange.interval,r,u,t,e,i)))},n.prototype.renderMinorGridOnZooming=function(n,t,i,r,u,f,e){var o=this.drawAxisMinorLine(n,t,i,r,!0);this.renderGridLine(n,u,o[0],n.minorGridLines,"_MinorGridLine_",-1,this.element,f.minorGridLine,n.minorGridLines.dashArray);this.renderGridLine(n,u,o[1],n.minorTickLines,"_MinorTickLine_",-1,e,f.minorTickLine)},n.prototype.drawAxisMinorLine=function(n,t,i,r,u){var w,o=t,f=0,e=0,s=n.visibleRange,b="Inside"===n.tickPosition,y=[],v=n.opposedPosition?-n.minorTickLines.height:n.minorTickLines.height,p=1,c=1,k=b?i.y-v:i.y+v,d=b?i.x+v:i.x-v,l="",a="",h;if("Logarithmic"===n.valueType&&(c=(w=Math.pow(n.logBase,o-s.interval))+(p=(Math.pow(n.logBase,o)-w)/(n.minorTicksPerInterval+1))),"Horizontal"===n.orientation)for(h=0;h<n.minorTicksPerInterval;h++)o=this.findLogNumeric(n,c,o,r,u),c+=p,ai(o,s)&&(e=(o-s.min)/(s.max-s.min),e=Math.ceil((n.isInversed?1-e:e)*i.width),f=Math.floor(e+i.x),l=l.concat("M "+f+" "+this.seriesClipRect.y+"L "+f+" "+(this.seriesClipRect.y+this.seriesClipRect.height)),f=Math.floor(e+i.x),a=a.concat("M "+f+" "+i.y+"L "+f+" "+(k+n.scrollBarHeight)));else for(h=0;h<n.minorTicksPerInterval;h++)ai(o=this.findLogNumeric(n,c,o,r,u),s)&&(e=(o-s.min)/(s.max-s.min),e=-1*Math.ceil((n.isInversed?1-e:e)*i.height),f=Math.floor(e+i.y+i.height),l=l.concat("M "+this.seriesClipRect.x+" "+f+"L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+f+" "),f=Math.floor(e+i.y+i.height),a=a.concat("M "+i.x+" "+f+"L "+(d-n.scrollBarHeight)+" "+f+" ")),c+=p;return y.push(l),y.push(a),y},n.prototype.findLogNumeric=function(n,t,i,r,u){var f,o=n.visibleRange,e;return"Logarithmic"===n.valueType?i=nt(t,n.logBase):"DateTime"===n.valueType?(f=n.dateTimeInterval/(n.minorTicksPerInterval+1),i=u?i-f:i+f):"DateTimeCategory"===n.valueType?(e="BetweenTicks"===n.labelPlacement?.5:0,i+=((n.visibleLabels[r+1]?n.visibleLabels[r+1].value-e:n.visibleRange.max)-(n.visibleLabels[r]?n.visibleLabels[r].value-e:n.visibleRange.min))/(n.minorTicksPerInterval+1)):(f=o.interval/(n.minorTicksPerInterval+1),i=u?i-f:i+f),i},n.prototype.drawXAxisLabels=function(n,t,i,r){var v,it,wt,bt,u,at,y,e,h,p=this.chart,c=0,b=0,kt=n.labelPadding,vt=p.renderer.createGroup({id:p.element.id+"AxisLabels"+t}),rt="Inside"===n.labelPosition,ot=n.opposedPosition,dt=n.labelPosition===n.tickPosition?n.majorTickLines.height:0,l=dt+kt+.5*n.lineStyle.width,f=n.angle%360,ii=0===f||-180===f||180===f,yt=n.isInversed?r.x+r.width:r.x,o=0,gt=n.visibleLabels.length,st=n.scrollbarSettings.enable||!rt&&sf.base.isNullOrUndefined(n.crossesAt)&&(n.zoomFactor<1||n.zoomPosition>0)?n.scrollBarHeight:0,d=[],pt=!1,ft,g,nt,tt,w,ct,lt,et;l+=90===f||270===f||-90===f||-270===f?rt?5:-5:0;for(var ht=!ot&&!rt||ot&&rt,ri=ht?360>=f&&f>=180||-1>=f&&f>=-180:1<=f&&f<=180||-181>=f&&f>=-360,s=0,ut=gt;s<ut;s++){if(h=li((e=n.visibleLabels[s]).originalText),c=a(e.value,n)*r.width+r.x,it=e.size,y=r.width/gt,at=h?e.breakLabelSize.width:it.width,o=("Trim"===n.labelIntersectAction||"Wrap"===n.labelIntersectAction)&&0===f&&at>y?y:at,v=it.height/4,c-=h||0!==f?0:o/2,0!==f&&(c-=h?"Left"===n.lineBreakAlignment?e.breakLabelSize.width/2:"Right"===n.lineBreakAlignment?-e.breakLabelSize.width/2:0:-90===f||270===f?-v:90===f||-270===f?v:0),"Far"===n.labelStyle.textAlignment?c=c+o-10:"Near"===n.labelStyle.textAlignment?c=c-o+10:"Center"===n.labelStyle.textAlignment&&(c=c),h&&"Center"!==n.lineBreakAlignment&&0===f&&(c+="Left"===n.lineBreakAlignment?-o/2:o/2),ft=h?ii?it.height:e.breakLabelSize.width/2:0,l=h?dt+kt+.5*n.lineStyle.width:l,rt&&f?b=h?ot?r.y+l+ft:r.y-l-ft:ot?r.y+l+v:r.y-l-v:(wt=h?ht?l+st+(f?ft:3*v):-(l+st+ft):ht?l+st+(f?1:3)*v:-(l+st+(f?v:e.index>1?2*v:0)),b=r.y+wt*e.index),bt=h?this.getAnchor(n):p.isRtlEnabled||ri?"end":"",u=new sf.svgbase.TextOption(p.element.id+t+"_AxisLabel_"+s,c,b,bt),n.edgeLabelPlacement&&0===f)switch(n.edgeLabelPlacement){case"Hide":if((0===s||n.isInversed&&s===ut-1)&&u.x<r.x||(s===ut-1||n.isInversed&&0===s)&&u.x+o>r.x+r.width)continue;break;case"Shift":(0===s||n.isInversed&&s===ut-1)&&u.x<r.x?(y-=r.x-u.x,u.x=c=r.x):(s===ut-1||n.isInversed&&0===s)&&u.x+o>r.x+r.width&&(it.width>y&&"Trim"===n.labelIntersectAction?y-=u.x+o-(r.x+r.width):y=o,u.x=c=r.x+r.width-y)}if(u.text=this.getLabelText(e,n,y),g=void 0,nt=void 0,h&&0===f?"Right"===n.lineBreakAlignment?(g=u.x-o,nt=u.x):"Center"===n.lineBreakAlignment?(g=u.x-o/2,nt=u.x+o/2):(g=u.x,nt=u.x+o):(g=u.x,nt=u.x+o),0!==f||"Hide"!==n.labelIntersectAction||0===s||!(n.isInversed?nt>=yt:g<=yt)){if(yt=h?"Right"===n.lineBreakAlignment?n.isInversed?u.x-o:u.x:"Center"===n.lineBreakAlignment?n.isInversed?u.x-o/2:u.x+o/2:n.isInversed?u.x:u.x+o:n.isInversed?u.x:u.x+o,0!==f){tt=void 0;w=void 0;h?(ct=0,lt=0,tt=e.breakLabelSize.height,lt=e.breakLabelSize.height-4,"Center"===n.lineBreakAlignment?ct=-e.breakLabelSize.width/2:"Right"===n.lineBreakAlignment&&(ct=-e.breakLabelSize.width),ht&&(lt=e.breakLabelSize.height/(u.text.length+1)),w=new sf.svgbase.Rect(u.x+ct,u.y-lt,e.breakLabelSize.width,tt)):(tt=b-(u.y-(e.size.height/2+10)),w=new sf.svgbase.Rect(u.x,u.y-(e.size.height/2-5),e.size.width,tt));var ui=this.getRectanglePoints(w),ni=h?w.x+w.width/2:c,ti=h?w.y+w.height/2:b-tt/2;for(u.transform=h?"rotate("+f+","+ni+","+ti+")":"rotate("+f+","+c+","+b+")",d.push(yu(ui,ni,ti,f)),pt=!1,et=s;et>0;et--)if(d[s]&&d[et-1]&&pu(d[s],d[et-1])){pt=!0;d[s]=null;break}}k(p.renderer,u,e.labelStyle,e.labelStyle.color||p.themeStyle.axisLabel,vt,n.opposedPosition!==("Inside"===n.labelPosition),p.redraw,!0,null,null,null,e.size,pt,p.enableCanvas)}}this.chart.enableCanvas||(p.delayRedraw?n.visible&&n.internalVisibility&&this.createZoomingLabel(this.chart,vt,n,t,r):i.appendChild(vt))},n.prototype.getAnchor=function(n){return"Center"===n.lineBreakAlignment?"middle":"Left"===n.lineBreakAlignment?"start":"end"},n.prototype.getRectanglePoints=function(n){return[new s(n.x,n.y),new s(n.x+n.width,n.y),new s(n.x+n.width,n.y+n.height),new s(n.x,n.y+n.height)]},n.prototype.getLabelText=function(n,t,i){if(li(n.originalText)){for(var u=[],f=void 0,r=0;r<n.text.length;r++)f=this.findAxisLabel(t,n.text[r],i),u.push(f);return u}return this.findAxisLabel(t,n.text,i)},n.prototype.drawXAxisBorder=function(n,t,i,r){if(n.border.width>0){for(var l="Outside"===n.labelPosition?n.scrollBarHeight:0,f=void 0,o=r.y+(n.opposedPosition?-1:1)*l,s=void 0,v=r.width/n.visibleRange.delta*("DateTime"===n.valueType?n.dateTimeInterval:n.visibleRange.interval),e=void 0,y=n.maxLabelSize.height+(n.tickPosition===n.labelPosition?n.majorTickLines.height:0),h="",p="Category"===n.valueType&&"BetweenTicks"===n.labelPlacement?-.5:0,u=n.opposedPosition&&"Inside"===n.labelPosition||!n.opposedPosition&&"Outside"===n.labelPosition?r.y+y+10+l:r.y-y-10-l,c=0,w=n.visibleLabels.length;c<w;c++)switch(s=a(n.visibleLabels[c].value+p,n),s=(n.isInversed?1-s:s)*r.width,"Category"===n.valueType&&"BetweenTicks"===n.labelPlacement?(f=s+r.x,e=s+v+r.x):(f=s-.5*v+r.x,e=s+.5*v+r.x),n.border.type){case"Rectangle":case"WithoutTopBorder":f<r.x?h+="M "+r.x+" "+u+" L "+e+" "+u+" ":Math.floor(e)>r.width+r.x&&1!==n.visibleLabels.length?h+="M "+f+" "+o+" L "+f+" "+u+" L "+(r.width+r.x)+" "+u+" ":(h+="M "+f+" "+o+" L "+f+" "+u+" L "+e+" "+u+" ",0===c&&(h+="M "+f+" "+o+" L "+f+" "+u+" M "+f+" "+u+" L "+r.x+" "+u),c===n.visibleLabels.length-1&&(h+="M "+e+" "+o+" L "+e+" "+u+" M "+e+" "+u+" L "+(r.width+r.x)+" "+u));break;case"WithoutTopandBottomBorder":f<r.x||Math.floor(e)>r.width+r.x||(h+="M "+f+" "+o+" L "+f+" "+u+" M "+e+" "+o+" L "+e+" "+u)}""!=(h+="Rectangle"===n.border.type?"M  "+r.x+" "+o+"L "+(r.x+r.width)+" "+o:"")&&this.createAxisBorderElement(n,t,h,i)}this.chart.multiLevelLabelModule&&n.multiLevelLabels.length>0&&this.chart.multiLevelLabelModule.renderXAxisMultiLevelLabels(n,t,i,r)},n.prototype.createAxisBorderElement=function(n,t,i,u){var f=r(this.chart.element.id+"_BorderLine_"+t),o=f?f.getAttribute("d"):"",e=this.chart.renderer.drawPath(new sf.svgbase.PathOption(this.chart.element.id+"_BorderLine_"+t,"transparent",n.border.width,n.border.color||this.chart.themeStyle.axisLine,1,"",i));e.setAttribute("style","pointer-events: none");h(this.chart.enableCanvas,u,e,this.chart.redraw,!0,"x","y",null,o,!0)},n.prototype.findAxisLabel=function(n,t,i){return"Trim"===n.labelIntersectAction?n.angle%360!=0||n.enableTrim?t:at(i,t,n.labelStyle):t},n.prototype.drawXAxisTitle=function(n,t,i,r){var h,e;if(n.title){var u=this.chart,o=sf.svgbase.measureText(n.title,n.titleStyle),s=sf.base.isNullOrUndefined(n.crossesAt)?n.scrollBarHeight:0,f=("Inside"===n.tickPosition?0:n.majorTickLines.height+n.titlePadding)+("Inside"===n.labelPosition?0:n.maxLabelSize.height+n.multiLevelLabelHeight+n.labelPadding),c=n.titleSize.height*(n.titleCollection.length-1);f=n.opposedPosition?-(f+o.height/4+s+c):f+3*o.height/4+s;h=new sf.svgbase.TextOption(u.element.id+"_AxisTitle_"+t,r.x+.5*r.width,r.y+f,"middle",n.titleCollection);e=k(u.renderer,h,n.titleStyle,n.titleStyle.color||u.themeStyle.axisTitle,i,null,null,null,null,null,null,0,null,u.enableCanvas);e.setAttribute("aria-label",n.description||n.title);e.setAttribute("tabindex",n.tabIndex.toString())}},n.prototype.renderGridLine=function(n,t,i,u,f,e,o,s,c){void 0===c&&(c=null);var v,a,l=this.chart;u.width>0&&n.visible&&n.internalVisibility&&i&&(v=(a=r(l.element.id+f+t+"_"+e))?a.getAttribute("d"):null,a=null,this.htmlObject=l.renderer.drawPath(new sf.svgbase.PathOption(l.element.id+f+t+"_"+e,"transparent",u.width,u.color||s,null,c,i)),h(l.enableCanvas,o,this.htmlObject,l.redraw,!0,"x","y",null,v,!0))},n.prototype.findParentNode=function(n,t,i){return document.getElementById(n+"AxisGroup"+i+"Inside").contains(document.getElementById(t.id))?document.getElementById(n+"AxisGroup"+i+"Inside"):document.getElementById(n+"AxisGroup"+i+"Outside")},n.prototype.createZoomingLabel=function(n,t,i,u,f){var o=this.findParentNode(n.element.id,t,u),e;t.setAttribute("opacity","0.3");e=n.renderer.createGroup({id:n.element.id+"AxisLabels_Zoom"+u});e=oc(n,i,e,u,"Vertical"===i.orientation,f);o.replaceChild(t,document.getElementById(t.id));r(n.element.id+"AxisLabels_Zoom"+u)?o.replaceChild(e,document.getElementById(e.id)):o.appendChild(e)},n}(),lr=function(){function n(n){this.currentPoints=[];this.previousPoints=[];this.insideRegion=!1;this.chart=n;this.lierIndex=0}return n.prototype.getData=function(){for(var e,o,s,h,t,i,r=this.chart,u=null,n=null,f=r.visibleSeries.length-1;f>=0;f--)if((s="Scatter"===(n=r.visibleSeries[f]).type||"Scatter"===n.drawType||n.marker.visible?(n.marker.height+5)/2:0,h="Scatter"===n.type||"Scatter"===n.drawType||n.marker.visible?(n.marker.width+5)/2:0,t=r.mouseX,i=r.mouseY,n.dragSettings.enable&&n.isRectSeries)&&("Bar"===n.type&&r.isTransposed||!r.isTransposed&&"Bar"!==n.type?(e=n.marker.height/2,i=n.yAxis.isInversed?i-e:i+e):(o=n.marker.width/2,t=n.yAxis.isInversed?t+o:t-o)),n.visible&&v(t,i,n.clipRect,s,h)&&(u=this.getRectPoint(n,n.clipRect,t,i)),u)return new tr(u,n);return new tr(u,n)},n.prototype.isSelected=function(n){return(n.selectionMode.indexOf("Drag")>-1||n.selectionMode.indexOf("Lasso")>-1)&&n.selectionModule&&null!==n.selectionModule.rectPoints},n.prototype.getRectPoint=function(n,t,i,r){var l,a,f,e,o,s,h=0,c,v,u;if(this.chart.isScrolling)return null;for(c=0,v=n.points;c<v.length;c++)if(u=v[c],u.regionData||u.regions&&u.regions.length){if(u.regionData&&"PolarRadar"===this.chart.chartAreaType&&n.drawType.indexOf("Column")>-1&&(l=i-(n.clipRect.width/2+n.clipRect.x),a=r-(n.clipRect.height/2+n.clipRect.y),h=2*Math.PI*(u.regionData.currentXPosition<0?1+u.regionData.currentXPosition:u.regionData.currentXPosition),f=(f=(Math.atan2(a,l)+.5*Math.PI-h)%(2*Math.PI))<0?2*Math.PI+f:f,f+=2*Math.PI*n.chart.primaryXAxis.startAngle,e=u.regionData.startAngle,e=(e-=h)<0?2*Math.PI+e:e,o=u.regionData.endAngle,o=(o-=h)<0?2*Math.PI+o:o,s=Math.sqrt(Math.pow(Math.abs(l),2)+Math.pow(Math.abs(a),2)),f>=e&&f<=o&&(s>=u.regionData.innerRadius&&s<=u.regionData.radius||s<=u.regionData.innerRadius&&s>=u.regionData.radius)&&s<=n.chart.radius))return u;if((n.dragSettings.enable&&n.isRectSeries||n.isRectSeries&&n.marker.visible)&&this.isPointInThresholdRegion(i,r,u,t,n))return this.insideRegion=!0,u;if(!this.insideRegion&&this.checkRegionContainsPoint(u.regions,t,i,r)||this.insideRegion&&this.checkRegionContainsPoint(u.regions,t,i,r))return u}return null},n.prototype.checkRegionContainsPoint=function(n,t,i,r){var u=this;return n.some(function(n,f){return u.lierIndex=f,v(i,r,new sf.svgbase.Rect(("Cartesian"===u.chart.chartAreaType?t.x:0)+n.x,("Cartesian"===u.chart.chartAreaType?t.y:0)+n.y,n.width,n.height))})},n.prototype.isPointInThresholdRegion=function(n,t,i,r,u){var f,c=this,h="Bar"===u.type,l=u.yAxis.isInversed,a=u.chart.isTransposed,e=0,o=0,s=f=20;return l&&a?h?(e=i.regions[0].height-10,f=i.regions[0].width):(o=-10,s=i.regions[0].height):l||i.yValue<0?h?(o=-10,s=i.regions[0].height):(e=i.regions[0].height-10,f=i.regions[0].width):a?h?(e=-10,f=i.regions[0].width):(o=i.regions[0].width-10,s=i.regions[0].height):h?(o=i.regions[0].width-10,s=i.regions[0].height):(e=-10,f=i.regions[0].width),i.regions.some(function(i){return v(n,t,new sf.svgbase.Rect(("Cartesian"===c.chart.chartAreaType?r.x:0)+i.x+o,("Cartesian"===c.chart.chartAreaType?r.y:0)+i.y+e,f,s))})},n.prototype.getClosest=function(n,t,i){var r,f,e=i||n.xData,u;if(t>=n.xMin-.5&&t<=n.xMax+.5)for(u=0;u<e.length;u++)f=e[u],(null==r||Math.abs(f-t)<Math.abs(r-t))&&(r=f);return-1!==n.xData.indexOf(r)?r:null},n.prototype.getClosestX=function(n,t,i){var e,r=t.clipRect,u;e=n.requireInvertedAxis?du(n.mouseY-r.y,r.height,t.xAxis):ku(n.mouseX-r.x,r.width,t.xAxis);for(var s=this.getClosest(t,e,i),f=0,o=t.points;f<o.length;f++)if(u=o[f],s===u.xValue&&u.visible)return new tr(u,t);return null},n.prototype.mergeXvalues=function(n){for(var t=[],i=0;i<n.length;i++)t=t.concat(n[i].xData);return t.filter(function(n,i){return i===t.indexOf(n)})},n}(),hi=(yf=function(n,t){return(yf=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}yf(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),i=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},el=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return hi(t,n),i([sf.base.Property(!1)],t.prototype,"visible",void 0),i([sf.base.Property(!0)],t.prototype,"showZero",void 0),i([sf.base.Property(null)],t.prototype,"name",void 0),i([sf.base.Property("transparent")],t.prototype,"fill",void 0),i([sf.base.Property(1)],t.prototype,"opacity",void 0),i([sf.base.Property(0)],t.prototype,"angle",void 0),i([sf.base.Property(!1)],t.prototype,"enableRotation",void 0),i([sf.base.Property("Auto")],t.prototype,"position",void 0),i([sf.base.Property(5)],t.prototype,"rx",void 0),i([sf.base.Property(5)],t.prototype,"ry",void 0),i([sf.base.Property("Center")],t.prototype,"alignment",void 0),i([sf.base.Complex({width:null,color:null},ot)],t.prototype,"border",void 0),i([sf.base.Complex({left:5,right:5,top:5,bottom:5},vr)],t.prototype,"margin",void 0),i([sf.base.Complex({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},lt)],t.prototype,"font",void 0),i([sf.base.Property(null)],t.prototype,"template",void 0),i([sf.base.Property("Hide")],t.prototype,"labelIntersectAction",void 0),t}(sf.base.ChildProperty),hs=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return hi(t,n),i([sf.base.Property(!1)],t.prototype,"visible",void 0),i([sf.base.Property("Circle")],t.prototype,"shape",void 0),i([sf.base.Property("")],t.prototype,"imageUrl",void 0),i([sf.base.Property(5)],t.prototype,"height",void 0),i([sf.base.Property(5)],t.prototype,"width",void 0),i([sf.base.Complex({width:2,color:null},ot)],t.prototype,"border",void 0),i([sf.base.Complex({x:0,y:0},gs)],t.prototype,"offset",void 0),i([sf.base.Property(null)],t.prototype,"fill",void 0),i([sf.base.Property(1)],t.prototype,"opacity",void 0),i([sf.base.Complex({},el)],t.prototype,"dataLabel",void 0),t}(sf.base.ChildProperty),ir=function(){this.symbolLocations=null;this.regions=null;this.percentage=null;this.regionData=null;this.isSelect=!1;this.marker={visible:!1};this.isPointInRange=!0},ol=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.clipRect=new sf.svgbase.Rect(0,0,0,0),t}return hi(t,n),t.prototype.setDataSource=function(n,t){n&&(this.points=n.points);t.trendLineModule.initDataSource(this);t.visibleSeriesCount++},i([sf.base.Property("")],t.prototype,"name",void 0),i([sf.base.Property("0")],t.prototype,"dashArray",void 0),i([sf.base.Property(!0)],t.prototype,"visible",void 0),i([sf.base.Property("Linear")],t.prototype,"type",void 0),i([sf.base.Property(2)],t.prototype,"period",void 0),i([sf.base.Property(2)],t.prototype,"polynomialOrder",void 0),i([sf.base.Property(0)],t.prototype,"backwardForecast",void 0),i([sf.base.Property(0)],t.prototype,"forwardForecast",void 0),i([sf.base.Complex({},lu)],t.prototype,"animation",void 0),i([sf.base.Complex({},hs)],t.prototype,"marker",void 0),i([sf.base.Property(!0)],t.prototype,"enableTooltip",void 0),i([sf.base.Property(null)],t.prototype,"intercept",void 0),i([sf.base.Property("")],t.prototype,"fill",void 0),i([sf.base.Property(1)],t.prototype,"width",void 0),i([sf.base.Property("SeriesType")],t.prototype,"legendShape",void 0),t}(sf.base.ChildProperty),sl=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return hi(t,n),i([sf.base.Property(1)],t.prototype,"width",void 0),i([sf.base.Property(10)],t.prototype,"length",void 0),i([sf.base.Property(null)],t.prototype,"color",void 0),i([sf.base.Property(1)],t.prototype,"opacity",void 0),t}(sf.base.ChildProperty),hl=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return hi(t,n),i([sf.base.Property(null)],t.prototype,"value",void 0),i([sf.base.Property(null)],t.prototype,"color",void 0),i([sf.base.Property("0")],t.prototype,"dashArray",void 0),t}(sf.base.ChildProperty),cl=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return hi(t,n),i([sf.base.Property(!1)],t.prototype,"visible",void 0),i([sf.base.Property("Fixed")],t.prototype,"type",void 0),i([sf.base.Property("Both")],t.prototype,"direction",void 0),i([sf.base.Property("Vertical")],t.prototype,"mode",void 0),i([sf.base.Property(null)],t.prototype,"color",void 0),i([sf.base.Property(1)],t.prototype,"verticalError",void 0),i([sf.base.Property(1)],t.prototype,"width",void 0),i([sf.base.Property(1)],t.prototype,"horizontalError",void 0),i([sf.base.Property(3)],t.prototype,"verticalPositiveError",void 0),i([sf.base.Property(3)],t.prototype,"verticalNegativeError",void 0),i([sf.base.Property(1)],t.prototype,"horizontalPositiveError",void 0),i([sf.base.Property(1)],t.prototype,"horizontalNegativeError",void 0),i([sf.base.Complex(null,sl)],t.prototype,"errorBarCap",void 0),t}(sf.base.ChildProperty),cs=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.currentViewData=[],t.clipRect=new sf.svgbase.Rect(0,0,0,0),t.seriesType="XY",t.isRectTypeSeries=!1,t}return hi(t,n),t.prototype.processJsonData=function(){var t=0,n=new ir,r=_instanceof(this,l)&&"Histogram"===this.type?"x":this.xName,u=_instanceof(this,l)&&this.marker.dataLabel.name?this.marker.dataLabel.name:"",i,e,o;if(_instanceof(this,l)&&("Waterfall"!==this.type&&"Histogram"!==this.type||(this.currentViewData=this.chart[tt(this.type)+"SeriesModule"].processInternalData(sf.base.extend([],this.currentViewData,null,!0),this)),"Pareto"===this.category&&(this.currentViewData=uc(sf.base.extend([],this.currentViewData,null,!0),[this.yName],!0),"Line"===this.type&&(this.currentViewData=this.chart.paretoSeriesModule.performCumulativeCalculation(this.currentViewData,this))),this.isRectTypeSeries=this.type.indexOf("Column")>-1||this.type.indexOf("Bar")>-1||this.type.indexOf("Histogram")>-1),i=Object.keys(this.currentViewData).length,this.points=[],this.xMin=1/0,this.xMax=-1/0,this.yMin=1/0,this.yMax=-1/0,this.sizeMax=-1/0,this.getSeriesType(),"Category"===this.xAxis.valueType)for(;t<i;)n=this.dataPoint(t,u,r),this.pushCategoryData(n,t,n.x),this.pushData(n,t),this.setEmptyPoint(n,t),t++;else if(this.xAxis.valueType.indexOf("DateTime")>-1)for(var f={skeleton:"full",type:"dateTime"},s=this.chart.intl.getDateParser(f),h=this.chart.intl.getDateFormat(f);t<i;)n=this.dataPoint(t,u,r),sf.base.isNullOrUndefined(n.x)||""===n.x?n.visible=!1:(n.x=new Date(sf.data.DataUtil.parse.parseJson({val:n.x}).val),"DateTime"===this.xAxis.valueType?n.xValue=Date.parse(n.x.toString()):this.chart.isBlazor?this.pushCategoryData(n,t,Date.parse(n.x.toString()).toString()):this.pushCategoryData(n,t,Date.parse(s(h(n.x))).toString()),this.pushData(n,t),this.setEmptyPoint(n,t)),t++;else for(;t<i;)(n=this.dataPoint(t,u,r)).xValue=n.x,this.pushData(n,t),this.setEmptyPoint(n,t),t++;_instanceof(this,l)&&(this.type.indexOf("Spline")>-1||this.drawType.indexOf("Spline")>-1&&"PolarRadar"===this.chart.chartAreaType?(e=this.type.indexOf("Area")>-1||this.drawType.indexOf("Area")>-1,o=this.type.indexOf("Range")>-1,this.chart["spline"+(e?o?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(this)):this.type.indexOf("Histogram")>-1&&(this.xAxis.maximum||this.xAxis.minimum)&&this.chart.histogramSeriesModule.calculateBinValues(this))},t.prototype.pushData=function(n,t){n.index=t;n.yValue=n.y;this.xMin=Math.min(this.xMin,n.xValue);this.xMax=Math.max(this.xMax,n.xValue);this.xData.push(n.xValue)},t.prototype.dataPoint=function(n,t,i){this.points[n]=new ir;var r=this.points[n],u=this.currentViewData,f=this.enableComplexProperty?sf.base.getValue:this.getObjectValue;return r.x=f(i,u[n]),r.high=f(this.high,u[n]),r.low=f(this.low,u[n]),r.open=f(this.open,u[n]),r.close=f(this.close,u[n]),r.volume=f(this.volume,u[n]),r.interior=f(this.pointColorMapping,u[n]),_instanceof(this,l)&&(r.y=f(this.yName,u[n]),r.size=f(this.size,u[n]),r.text=f(t,u[n]),r.tooltip=f(this.tooltipMappingName,u[n]),this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0&&this.isAdvancedColorSupported()&&(r.colorValue=this.colorName&&this.colorName.length>0?f(this.colorName,u[n]):f(this.yName,u[n]),r.interior=this.getPointFillColor(r.interior,r.colorValue))),r},t.prototype.isAdvancedColorSupported=function(){return 1===this.chart.visibleSeries.length&&("Column"===this.chart.series[0].type||"Bar"===this.chart.series[0].type||"Scatter"===this.chart.series[0].type||"Bubble"===this.chart.series[0].type)},t.prototype.getPointFillColor=function(n,t){var f=n,r,u,i;if(t&&this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0)for(r=0,u=this.chart.rangeColorSettings;r<u.length;r++)i=u[r],t>=i.start&&t<=i.end&&(f=i.colors.length>1?rl(i,t):i.colors[0]);return f},t.prototype.getObjectValue=function(n,t){return t[n]},t.prototype.setEmptyPoint=function(n,t){if(!this.findVisibility(n))return n.visible=!0,null;switch(n.isEmpty=!0,_instanceof(this,l)&&n.isPointInRange?this.emptyPointSettings.mode:"Drop"){case"Zero":n.visible=!0;_instanceof(this,l)&&this.seriesType.indexOf("HighLow")>-1?(n.high=n.low=0,this.seriesType.indexOf("HighLowOpenClose")>-1&&(n.open=n.close=0)):n.y=n.yValue=this.yData[t]=0;break;case"Average":_instanceof(this,l)&&(this.seriesType.indexOf("HighLow")>-1?(n.high=sf.base.isNullOrUndefined(n.high)||isNaN(+n.high)?this.getAverage(this.high,t):n.high,n.low=sf.base.isNullOrUndefined(n.low)||isNaN(+n.low)?this.getAverage(this.low,t):n.low,this.seriesType.indexOf("HighLowOpenClose")>-1&&(n.open=sf.base.isNullOrUndefined(n.open)||isNaN(+n.open)?this.getAverage(this.open,t):n.open,n.close=sf.base.isNullOrUndefined(n.close)||isNaN(+n.close)?this.getAverage(this.close,t):n.close)):n.y=n.yValue=this.yData[t]=this.getAverage(this.yName,t));n.visible=!0;break;case"Drop":case"Gap":this.yData[t]=null;n.visible=!1}},t.prototype.findVisibility=function(n){var t,u=_instanceof(this,l)?this.seriesType:"HighLowOpenClose",i=this.yAxis.minimum,r=this.yAxis.maximum;switch(u){case"XY":return"PolarRadar"===this.chart.chartAreaType&&(!sf.base.isNullOrUndefined(i)&&n.yValue<i||!sf.base.isNullOrUndefined(r)&&n.yValue>r)?(n.isPointInRange=!1,!0):(this.setXYMinMax(n.yValue),this.yData.push(n.yValue),_instanceof(this,l)&&"Bubble"===this.type&&(this.sizeMax=Math.max(this.sizeMax,sf.base.isNullOrUndefined(n.size)||isNaN(+n.size)?this.sizeMax:n.size)),sf.base.isNullOrUndefined(n.x)||sf.base.isNullOrUndefined(n.y)||isNaN(+n.y));case"HighLow":return this.setHiloMinMax(n.high,n.low),sf.base.isNullOrUndefined(n.x)||sf.base.isNullOrUndefined(n.low)||isNaN(+n.low)||sf.base.isNullOrUndefined(n.high)||isNaN(+n.high);case"HighLowOpenClose":return this.setHiloMinMax(n.high,n.low),sf.base.isNullOrUndefined(n.x)||sf.base.isNullOrUndefined(n.low)||isNaN(+n.low)||sf.base.isNullOrUndefined(n.open)||isNaN(+n.open)||sf.base.isNullOrUndefined(n.close)||isNaN(+n.close)||sf.base.isNullOrUndefined(n.high)||isNaN(+n.high);case"BoxPlot":return t=(n.y||[null]).filter(function(n){return!sf.base.isNullOrUndefined(n)&&!isNaN(n)}).sort(function(n,t){return n-t}),n.y=t,this.yMin=Math.min(this.yMin,Math.min.apply(Math,t)),this.yMax=Math.max(this.yMax,Math.max.apply(Math,t)),!t.length}},t.prototype.setXYMinMax=function(n){var t,i="Logarithmic"===this.yAxis.valueType||"Logarithmic"===this.xAxis.valueType,r=n<0;t=this.isRectTypeSeries&&!ki(this.yAxis)?i||r?n:0:n;this.yMin=i?Math.min(this.yMin,sf.base.isNullOrUndefined(t)||isNaN(t)||0===t||""===t.toString()?this.yMin:t):Math.min(this.yMin,sf.base.isNullOrUndefined(t)||isNaN(t)?this.yMin:t);this.yMax=Math.max(this.yMax,sf.base.isNullOrUndefined(n)||isNaN(n)?this.yMax:n)},t.prototype.setHiloMinMax=function(n,t){this.yMin=Math.min(this.yMin,Math.min(sf.base.isNullOrUndefined(t)||isNaN(t)?this.yMin:t,sf.base.isNullOrUndefined(n)||isNaN(n)?this.yMin:n));this.yMax=Math.max(this.yMax,Math.max(sf.base.isNullOrUndefined(t)||isNaN(t)?this.yMax:t,sf.base.isNullOrUndefined(n)||isNaN(n)?this.yMax:n))},t.prototype.getSeriesType=function(){var n,t;if(_instanceof(this,l)&&(t="PolarRadar"===this.chart.chartAreaType?this.drawType:this.type,t))switch(t){case"RangeColumn":case"RangeArea":case"SplineRangeArea":case"Hilo":n="HighLow";break;case"HiloOpenClose":case"Candle":n="HighLowOpenClose";break;case"BoxAndWhisker":n="BoxPlot";break;default:n="XY"}this.seriesType=n},t.prototype.pushCategoryData=function(n,t,i){if(!this.chart.tooltip.shared&&!this.visible)return null;this.xAxis.isIndexed?(this.xAxis.labels[t]?this.xAxis.labels[t]+=", "+i:this.xAxis.labels.push(i),n.xValue=t):(this.xAxis.labels.indexOf(i)<0&&this.xAxis.labels.push(i),n.xValue=this.xAxis.labels.indexOf(i))},t.prototype.getAverage=function(n,t,i){return void 0===i&&(i=this.currentViewData),((i[t-1]&&i[t-1][n]||0)+(i[t+1]&&i[t+1][n]||0))/2},t.prototype.refreshDataManager=function(n){var t,i=this;this.chart=n;_instanceof(t=n.isAngular?Object.keys(this.dataSource).length?this.dataSource:n.dataSource:this.dataSource||n.dataSource,sf.data.DataManager)||!sf.base.isNullOrUndefined(this.query)?this.dataModule.getData(this.dataModule.generateQuery().requiresCount()).then(function(n){return i.dataManagerSuccess(n)}):this.dataManagerSuccess({result:t,count:t.length},!1)},t.prototype.dataManagerSuccess=function(n,t){if(void 0===t&&(t=!0),this.currentViewData=n.count?n.result:[],this.chart.allowServerDataBinding=!1,_instanceof(this,l)){this.chart.stockChart&&(this.chart.stockChart.series[this.index].localData=this.currentViewData);var i={name:"seriesRender",series:this,data:this.currentViewData,fill:this.interior};this.chart.trigger("seriesRender",i);this.interior=i.fill;this.currentViewData=i.data}!this.chart.stockChart||_instanceof(this,l)||(this.currentViewData=this.chart.stockChart.findCurrentData(this.chart.stockChart.series[0].localData,this.chart.stockChart.series[0].xName));this.processJsonData();this.recordsCount=n.count;this.refreshChart(t);this.currentViewData=null},t.prototype.refreshChart=function(n){var t=this.chart,i,r;if(_instanceof(this,l)&&(t.visibleSeriesCount+=n?1:0),t.refreshTechnicalIndicator(this),_instanceof(this,l)&&"TrendLine"!==this.category)for(i=0,r=this.trendlines;i<r.length;i++)r[i].setDataSource(this,t);t.visibleSeries.length===t.visibleSeriesCount&&(t.refreshBound(),t.trigger("loaded",{chart:t.isBlazor?{}:t}),this.chart.stockChart&&this.chart.stockChart.initialRender&&(this.chart.stockChart.initialRender=!1,this.chart.stockChart.stockChartDataManagerSuccess()));_instanceof(this,l)&&(t.visibleSeriesCount+=n?0:1)},i([sf.base.Property("")],t.prototype,"xName",void 0),i([sf.base.Property("")],t.prototype,"colorName",void 0),i([sf.base.Property("")],t.prototype,"high",void 0),i([sf.base.Property("")],t.prototype,"low",void 0),i([sf.base.Property("")],t.prototype,"open",void 0),i([sf.base.Property("")],t.prototype,"close",void 0),i([sf.base.Property("")],t.prototype,"volume",void 0),i([sf.base.Property("")],t.prototype,"pointColorMapping",void 0),i([sf.base.Property(!0)],t.prototype,"visible",void 0),i([sf.base.Property(null)],t.prototype,"xAxisName",void 0),i([sf.base.Property(null)],t.prototype,"yAxisName",void 0),i([sf.base.Complex(null,lu)],t.prototype,"animation",void 0),i([sf.base.Property(null)],t.prototype,"fill",void 0),i([sf.base.Property(1)],t.prototype,"width",void 0),i([sf.base.Property("0")],t.prototype,"dashArray",void 0),i([sf.base.Property("")],t.prototype,"dataSource",void 0),i([sf.base.Property()],t.prototype,"query",void 0),i([sf.base.Collection([],hl)],t.prototype,"segments",void 0),i([sf.base.Property("X")],t.prototype,"segmentAxis",void 0),i([sf.base.Property(!1)],t.prototype,"enableComplexProperty",void 0),t}(sf.base.ChildProperty),l=function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return f.visibleSeriesCount=0,f.category="Series",f.isRectSeries=!1,f.drawPoints=[],f.lowDrawPoints=[],f.delayedAnimation=!1,f}return hi(t,n),t.prototype.refreshAxisLabel=function(){var i,u,n,r,f,t;if("Category"!==this.xAxis.valueType)return null;for(this.xAxis.labels=[],i=0,u=this.xAxis.series;i<u.length;i++)if(n=u[i],n.visible&&"TrendLine"!==n.category)for(n.xMin=1/0,n.xMax=-1/0,r=0,f=n.points;r<f.length;r++)t=f[r],n.pushCategoryData(t,t.index,t.x),n.xMin=Math.min(n.xMin,t.xValue),n.xMax=Math.max(n.xMax,t.xValue)},t.prototype.findSeriesCollection=function(n,t,i){for(var u,o,f,h,r,c=[],e=0,l=t.axes;e<l.length;e++)for(u=0,o=l[e].series;u<o.length;u++)for(var v=o[u],s=0,a=n.axes;s<a.length;s++)for(f=0,h=a[s].series;f<h.length;f++)r=h[f],r===v&&r.visible&&this.rectSeriesInChart(r,i)&&c.push(r);return c},t.prototype.rectSeriesInChart=function(n,t){var i=n.type.toLowerCase();return-1!==i.indexOf("column")||-1!==i.indexOf("bar")||-1!==i.indexOf("histogram")||-1!==i.indexOf("hiloopenclose")||-1!==i.indexOf("candle")||-1!==i.indexOf("pareto")||-1!==i.indexOf("hilo")||-1!==n.drawType.indexOf("Column")||-1!==i.indexOf("waterfall")||-1!==i.indexOf("boxandwhisker")||t},t.prototype.calculateStackedValue=function(n,t){for(var e,i=0,r=t.columns;i<r.length;i++)for(var o=r[i],u=0,f=t.rows;u<f.length;u++)e=f[u],this.calculateStackingValues(this.findSeriesCollection(o,e,!0),n)},t.prototype.calculateStackingValues=function(n,t){var h,o,f,c,u,w=[],s=[],l=[],b=[],i,r,g,y,p;t&&(b=this.findFrequencies(n));for(var k=[],a=[],e=[],v=0,d=n;v<d.length;v++)if(i=d[v],-1!==i.type.indexOf("Stacking")||-1!==i.drawType.indexOf("Stacking")&&"PolarRadar"===i.chart.chartAreaType){for(s[f=-1!==i.type.indexOf("StackingArea")?"StackingArea100":-1!==i.type.indexOf("StackingLine")?"StackingLine100":i.stackingGroup]||(s[f]=[],l[f]=[]),w=i.yData,h=[],o=[],k.push(i),r=0,g=(e=fi(i)).length;r<g;r++)c=0,u=+w[r],void 0===s[f][e[r].xValue]&&(s[f][e[r].xValue]=0),void 0===l[f][e[r].xValue]&&(l[f][e[r].xValue]=0),t?(u=u/b[f][e[r].xValue]*100,u=isNaN(u)?0:u,e[r].percentage=+u.toFixed(2)):a[r]=a[r]?a[r]+Math.abs(u):Math.abs(u),u>=0?(c=s[f][e[r].xValue],s[f][e[r].xValue]+=u):(c=l[f][e[r].xValue],l[f][e[r].xValue]+=u),h.push(c),o.push(u+c),t&&o[r]>100&&(o[r]=100);i.stackedValues=new tl(h,o);y="Logarithmic"===i.yAxis.valueType;p=-1!==i.type.indexOf("Column")||-1!==i.type.indexOf("Bar");i.yMin=y&&p&&i.yMin<1?i.yMin:Math.min.apply(0,h);i.yMax=Math.max.apply(0,o);i.yMin>Math.min.apply(0,o)&&(i.yMin=t?-100:y&&p&&i.yMin<1?i.yMin:Math.min.apply(0,o));i.yMax<Math.max.apply(0,h)&&(i.yMax=0)}this.findPercentageOfStacking(k,a,t)},t.prototype.findPercentageOfStacking=function(n,t,i){for(var s,u,o,f,r=0,e=n;r<e.length;r++){if(s=e[r],i)return null;for(u=0,o=fi(s);u<o.length;u++)f=o[u],f.percentage=Math.abs(+(f.y/t[f.index]*100).toFixed(2))}},t.prototype.findFrequencies=function(n){for(var t,i,s,u,r=[],f=[],e=0,o=n;e<o.length;e++)if(t=o[e],t.yAxis.isStack100=-1!==t.type.indexOf("100"),f=fi(t),-1!==t.type.indexOf("Stacking"))for(r[u=-1!==t.type.indexOf("StackingArea")?"StackingArea100":-1!==t.type.indexOf("StackingLine")?"StackingLine100":t.stackingGroup]||(r[u]=[]),i=0,s=f.length;i<s;i++)void 0===r[u][f[i].xValue]&&(r[u][f[i].xValue]=0),t.yData[i]>0?r[u][f[i].xValue]+=t.yData[i]:r[u][f[i].xValue]-=t.yData[i];return r},t.prototype.renderSeries=function(n){var t=tt(this.type);n[(t=t.replace("100",""))+"SeriesModule"]&&("Indicator"!==this.category&&"TrendLine"!==this.category&&this.createSeriesElements(n),this.visiblePoints=fi(this),n[t+"SeriesModule"].render(this,this.xAxis,this.yAxis,n.requireInvertedAxis),"Indicator"!==this.category&&(this.errorBar.visible&&this.chart.errorBarModule.render(this),this.marker.dataLabel.visible&&n.dataLabelModule.render(this,this.chart,this.marker.dataLabel),this.appendSeriesElement(n.seriesElements,n)),this.chart.enableCanvas||this.performAnimation(n,t,this.errorBar,this.marker,this.marker.dataLabel))},t.prototype.createSeriesElements=function(n){var s,h;if("Indicator"!==this.category){var t=n.element.id,o=this.marker.border.width+8+5,e="Scatter"===this.type||"Bubble"===this.type?n.svgRenderer:n.renderer,i=void 0===this.index?this.category:this.index,r=void 0,u=void 0,f=void 0;("Scatter"===this.type?(r=n.primaryYAxis.maximum||n.primaryXAxis.maximum?0:(this.marker.height+o)/2,u=n.primaryYAxis.maximum||n.primaryXAxis.maximum?0:(this.marker.width+o)/2):(r=0,u=0),"PolarRadar"===n.chartAreaType)?(s="Scatter"===this.drawType?Math.max(this.marker.width,this.marker.height):0,f=new si(t+"_ChartSeriesClipRect_"+i,"transparent",{width:1,color:"Gray"},1,this.clipRect.width/2+this.clipRect.x,this.clipRect.height/2+this.clipRect.y,n.radius+s),this.clipRectElement=vt(n.redraw,f,e,"drawCircularClipPath")):(f=new y(t+"_ChartSeriesClipRect_"+i,"transparent",{width:1,color:"Gray"},1,{x:-u,y:-r,width:this.clipRect.width+2*u,height:this.clipRect.height+2*r}),this.clipRectElement=vt(n.redraw,f,e));h="Cartesian"===n.chartAreaType?"translate("+this.clipRect.x+","+this.clipRect.y+")":"";this.symbolElement=null;this.seriesElement=e.createGroup({id:t+"SeriesGroup"+i,transform:h,"clip-path":"url(#"+t+"_ChartSeriesClipRect_"+i+")"});this.chart.enableCanvas&&"Scatter"!==this.type&&"Bubble"!==this.type||this.seriesElement.appendChild(this.clipRectElement)}},t.prototype.appendSeriesElement=function(n,t){var r=this.marker,u=r.dataLabel,i=t.redraw;"TrendLine"!==this.category&&(h(t.enableCanvas,t.seriesElements,this.seriesElement,i),this.errorBar.visible&&("PolarRadar"===t.chartAreaType?h(t.enableCanvas,t.seriesElements,this.seriesElement,i):h(t.enableCanvas,t.seriesElements,this.errorBarElement,i)),"Scatter"!==this.type&&"Bubble"!==this.type||h(!1,t.seriesElements,this.seriesElement,i));r.visible&&("Cartesian"===t.chartAreaType||"Scatter"!==this.drawType&&"PolarRadar"===t.chartAreaType)&&"Scatter"!==this.type&&"Bubble"!==this.type&&"Candle"!==this.type&&"Hilo"!==this.type&&"HiloOpenClose"!==this.type&&this.symbolElement&&h(t.enableCanvas,t.seriesElements,this.symbolElement,i);u.visible&&this.textElement&&(h(t.enableCanvas,t.dataLabelElements,this.shapeElement,i),h(t.enableCanvas,t.dataLabelElements,this.textElement,i));!t.enableCanvas&&t.dataLabelElements.hasChildNodes()&&t.seriesElements.appendChild(t.dataLabelElements)},t.prototype.performAnimation=function(n,t,i,r,u){this.animation.enable&&n.animateSeries&&(n[t+"SeriesModule"].doAnimation(this),i.visible&&n.errorBarModule.doErrorBarAnimation(this),r.visible&&n.markerRender.doMarkerAnimation(this),u.visible&&"edge"!==sf.base.Browser.info.name&&!sf.base.Browser.isIE&&n.dataLabelModule.doDataLabelAnimation(this))},t.prototype.setPointColor=function(n,t){return t=n.interior||t,n.isEmpty&&this.emptyPointSettings.fill||t},t.prototype.setBorderColor=function(n,t){return t.width=n.isEmpty&&this.emptyPointSettings.border.width||t.width,t.color=n.isEmpty&&this.emptyPointSettings.border.color||t.color,t},i([sf.base.Property("")],t.prototype,"name",void 0),i([sf.base.Property("")],t.prototype,"yName",void 0),i([sf.base.Property("Line")],t.prototype,"drawType",void 0),i([sf.base.Property(!0)],t.prototype,"isClosed",void 0),i([sf.base.Property("#2ecd71")],t.prototype,"bearFillColor",void 0),i([sf.base.Property("#e74c3d")],t.prototype,"bullFillColor",void 0),i([sf.base.Property(!1)],t.prototype,"enableSolidCandles",void 0),i([sf.base.Property("")],t.prototype,"size",void 0),i([sf.base.Property(null)],t.prototype,"binInterval",void 0),i([sf.base.Property(!1)],t.prototype,"showNormalDistribution",void 0),i([sf.base.Property("")],t.prototype,"stackingGroup",void 0),i([sf.base.Complex({color:"transparent",width:0},ot)],t.prototype,"border",void 0),i([sf.base.Property(1)],t.prototype,"opacity",void 0),i([sf.base.Property(0)],t.prototype,"zOrder",void 0),i([sf.base.Property("Line")],t.prototype,"type",void 0),i([sf.base.Complex(null,cl)],t.prototype,"errorBar",void 0),i([sf.base.Complex(null,hs)],t.prototype,"marker",void 0),i([sf.base.Complex({},fh)],t.prototype,"dragSettings",void 0),i([sf.base.Collection([],ol)],t.prototype,"trendlines",void 0),i([sf.base.Property(!0)],t.prototype,"enableTooltip",void 0),i([sf.base.Property("")],t.prototype,"tooltipFormat",void 0),i([sf.base.Property("")],t.prototype,"tooltipMappingName",void 0),i([sf.base.Property("SeriesType")],t.prototype,"legendShape",void 0),i([sf.base.Property("")],t.prototype,"legendImageUrl",void 0),i([sf.base.Property(null)],t.prototype,"selectionStyle",void 0),i([sf.base.Property(null)],t.prototype,"unSelectedStyle",void 0),i([sf.base.Property(null)],t.prototype,"nonHighlightStyle",void 0),i([sf.base.Property(1)],t.prototype,"minRadius",void 0),i([sf.base.Property(3)],t.prototype,"maxRadius",void 0),i([sf.base.Property("Natural")],t.prototype,"splineType",void 0),i([sf.base.Property(.5)],t.prototype,"cardinalSplineTension",void 0),i([sf.base.Complex(null,uh)],t.prototype,"emptyPointSettings",void 0),i([sf.base.Property(!0)],t.prototype,"showMean",void 0),i([sf.base.Property("Normal")],t.prototype,"boxPlotMode",void 0),i([sf.base.Property(null)],t.prototype,"columnWidth",void 0),i([sf.base.Property(null)],t.prototype,"columnWidthInPixel",void 0),i([sf.base.Property(0)],t.prototype,"columnSpacing",void 0),i([sf.base.Property("#C64E4A")],t.prototype,"negativeFillColor",void 0),i([sf.base.Property("#4E81BC")],t.prototype,"summaryFillColor",void 0),i([sf.base.Property()],t.prototype,"intermediateSumIndexes",void 0),i([sf.base.Property()],t.prototype,"sumIndexes",void 0),i([sf.base.Complex({color:"black",width:2},pi)],t.prototype,"connector",void 0),i([sf.base.Complex(null,rh)],t.prototype,"cornerRadius",void 0),t}(cs),ay=function(){function n(n,t){this.initDataManager(n,t)}return n.prototype.initDataManager=function(n,t){this.dataManager=_instanceof(n,sf.data.DataManager)?n:new sf.data.DataManager(n);this.query=_instanceof(t,sf.data.Query)?t:new sf.data.Query},n.prototype.generateQuery=function(){return this.query.clone()},n.prototype.getData=function(n){var i=this,t;return this.dataManager.ready?(t=new sf.data.Deferred,this.dataManager.ready.then(function(){i.dataManager.executeQuery(n).then(function(n){t.resolve(n)})}).catch(function(n){t.reject(n)}),t.promise):this.dataManager.executeQuery(n)},n}(),vy=(pf=function(n,t){return(pf=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}pf(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),yy=function(n){function t(t){var i=n.call(this,t)||this;return i.elementId=t.element.id,i}return vy(t,n),t.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(sf.base.Browser.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(sf.base.Browser.touchEndEvent,this.mouseUpHandler,this))},t.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(sf.base.Browser.touchMoveEvent,this.mouseMoveHandler),this.chart.off(sf.base.Browser.touchEndEvent,this.mouseUpHandler))},t.prototype.mouseUpHandler=function(){var n=this.chart;!n.isTouch||n.crosshair.enable||this.isSelected(n)||this.markerMove(!0)},t.prototype.mouseMoveHandler=function(){var n=this.chart;n.crosshair.enable&&!n.tooltip.enable||n.isTouch&&!n.startMove||this.isSelected(n)||this.markerMove(!1)},t.prototype.markerMove=function(n){var r,f,e,i,c=this,t=this.chart,u,s;if(this.currentPoints=[],t.tooltip.shared&&t.tooltip.enable){if(!v(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect))return null;if(t.tooltip.enable)for(var l="PolarRadar"===t.chartAreaType?this.getData():null,w=this.mergeXvalues(this.chart.visibleSeries),o=0,a=t.visibleSeries;o<a.length;o++)u=a[o],u.enableTooltip&&"Indicator"!==u.category&&("Cartesian"===t.chartAreaType&&u.visible?r=this.getClosestX(t,u,w):"PolarRadar"===t.chartAreaType&&u.visible&&null!==l.point&&(r=new tr(u.points[l.point.index],u)),r&&(this.currentPoints.push(r),r=null))}else r=this.getData(),i=r.series,f=this.previousPoints[0],e=i&&("Bubble"===i.type||"Scatter"===i.drawType||"Scatter"===i.type||"Candle"!==i.type&&"Hilo"!==i.type&&"HiloOpenClose"!==i.type&&i.marker.visible&&0!==i.marker.width&&0!==i.marker.height),r.lierIndex=this.lierIndex,r.point&&e&&(!f||f.point!==r.point||f&&f.lierIndex>3&&f.lierIndex!==this.lierIndex)&&this.currentPoints.push(r),r.point&&e&&t.isPointMouseDown&&this.currentPoints.push(r);if(s=this.previousPoints.length,this.currentPoints.length>0&&(0===s||t.isPointMouseDown||s>0&&this.previousPoints[0].point!==this.currentPoints[0].point)){this.previousPoints.length>0&&this.removeHighlightedMarker();for(var b=function(n){(n&&n.point||"Candle"!==i.type&&"Hilo"!==i.type&&"HiloOpenClose"!==i.type)&&(or(y.markerExplode),y.isRemove=!0,n.point.symbolLocations.map(function(t,i){n.series.isRectSeries&&!n.point.marker.visible||c.drawTrackBall(n.series,n.point,t,i)}))},y=this,h=0,p=this.currentPoints;h<p.length;h++)b(p[h]);this.previousPoints=sf.base.extend([],this.currentPoints,null,!0)}!t.tooltip.enable&&(0===this.currentPoints.length&&this.isRemove||n&&this.isRemove||!v(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect))&&(this.isRemove=!1,this.markerExplode=+setTimeout(function(){c.removeHighlightedMarker()},2e3));this.currentPoints=[]},t.prototype.drawTrackBall=function(n,t,i,r){var u=t.marker,s=n.marker,v=u.shape||s.shape,f,h,w,o,b,c;if("None"===v)return null;h=n.symbolElement||n.seriesElement;this.chart.highlightModule&&"None"!==this.chart.highlightMode&&(f=this.chart.highlightModule.generateStyle(n));this.chart.selectionModule&&"None"!==this.chart.selectionMode&&(f=this.chart.selectionModule.generateStyle(n));for(var k=this.elementId+"_Series_"+n.index+"_Point_"+t.index+"_Trackball"+(r||""),d=new sf.svgbase.Size((u.width||s.width)+5,(u.height||s.height)+5),l=u.border||n.border,y="BoxAndWhisker"===n.type||"Bubble"===n.type||"Scatter"===n.type,p=l.color&&"transparent"!==l.color?l.color:u.fill||t.interior||(y?t.color:n.interior),a=nu(ht(p)),g=u.border?u.border.width:s.border.width,nt=n.chart.themeStyle.markerShadow||"rgba("+a.r+","+a.g+","+a.b+",0.2)",e=0;e<2;e++)w=new sf.svgbase.PathOption(k+"_"+e,e?u.fill||t.color||(y?n.interior:"#ffffff"):"transparent",g+(e?0:8),e?p:nt,u.opacity||s.opacity,null,null),o=rt(i,v,d,u.imageUrl,w,0,this.chart.svgRenderer,n.clipRect),o.setAttribute("class","EJ2-Trackball"),b=-1!==h.id.indexOf("Symbol")?"_Symbol":"",c=document.getElementById(this.elementId+"_Series_"+n.index+"_Point_"+t.index+b),""===f||sf.base.isNullOrUndefined(f)||sf.base.isNullOrUndefined(c)||!c.hasAttribute("class")||f!==c.getAttribute("class")||o.classList.add(f),o.setAttribute("clip-path",h.getAttribute("clip-path")),o.setAttribute("transform",h.getAttribute("transform")),this.chart.svgObject.appendChild(o)},t.prototype.removeHighlightedMarker=function(){for(var n=document.getElementsByClassName("EJ2-Trackball"),t=0,i=n.length;t<i;t++)sf.base.remove(n[0]);this.previousPoints=[]},t}(lr),py=(wf=function(n,t){return(wf=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}wf(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),wy=function(n){function t(t){var i=n.call(this,t)||this;return i.addEventListener(),i}return py(t,n),t.prototype.render=function(n){var u=this,i=n.chart.redraw;this.createElement(n,i);for(var f=function(t){t.visible&&t.symbolLocations&&t.symbolLocations.length&&t.symbolLocations.map(function(r,f){"None"!==n.marker.shape&&u.renderMarker(n,t,r,f,i)})},t=0,r=n.points;t<r.length;t++)f(r[t])},t.prototype.renderMarker=function(n,t,i,u,f){var d,g,s,a,ot=void 0===n.index?n.category:n.index,o=n.marker,y={color:o.border.color,width:o.border.width},v=o.border.color,it,e,w,b,l;i.x=i.x+o.offset.x;i.y=i.y-o.offset.y;var c,p="BoxAndWhisker"===n.type,nt=o.fill||(p?t.interior||n.interior:"#ffffff"),tt=p?wc(n.seriesElement.childNodes,"Series_"+n.index+"_Point_"+t.index):n.symbolElement;if(y.color=v||n.setPointColor(t,n.interior),it=this.elementId+"_Series_"+ot+"_Point_"+t.index+"_Symbol"+(u||""),e={cancel:!1,name:"pointRender",series:n,point:t,fill:t.isEmpty&&n.emptyPointSettings.fill||nt,border:{color:"BoxAndWhisker"===n.type?sf.base.isNullOrUndefined(v)||"transparent"===v?hf(nt,-.6):v:y.color,width:y.width},height:o.height,width:o.width,shape:o.shape},e.border=n.setBorderColor(t,{width:e.border.width,color:e.border.color}),n.isRectSeries&&"BoxAndWhisker"!==n.type||(this.chart.trigger("pointRender",e),t.color=e.fill),t.color=e.fill,e.cancel)i=null,t.marker={visible:!1};else{w=void 0;w="RangeArea"===n.type||"RangeColumn"===n.type||"RangeColumn"===n.drawType||"SplineRangeArea"===n.type?u?t.low:t.high:p?t.outliers[u]:t.y;b=e.point.marker.fill||e.fill;l=void 0;l=sf.base.isNullOrUndefined(e.point.marker.border)?{color:e.border.color,width:e.border.width}:{color:e.point.marker.border.color||e.border.color,width:e.point.marker.border.width||e.border.width};var ut=e.point.marker.width||e.width,ft=e.point.marker.height||e.height,st=e.point.marker.opacity||o.opacity,k=e.point.marker.shape||e.shape,et=e.point.marker.imageUrl||o.imageUrl;a=new sf.svgbase.PathOption(it,b,l.width,l.color,st,null);(null!=tt||this.chart.enableCanvas)&&(f&&r(a.id)&&(s="Circle"===k?"c":"",d={x:+(c=r(a.id)).getAttribute(s+"x"),y:+c.getAttribute(s+"y")},g=c.getAttribute("d")),c=rt(i,k,new sf.svgbase.Size(ut,ft),et,a,(t.x.toString(),w.toString()),this.chart.renderer,n.clipRect),h(this.chart.enableCanvas,tt,c,f,!0,s+"x",s+"y",d,g,!1,!1,null,n.chart.duration));t.marker={border:l,fill:b,height:ft,visible:!0,shape:k,width:ut,imageUrl:et}}},t.prototype.createElement=function(n,t){var s,i,r=n.marker,h=r.border.width+8+5,o=n.chart.svgRenderer,u=void 0===n.index?n.category:n.index,c="Cartesian"===n.chart.chartAreaType?"translate("+n.clipRect.x+","+n.clipRect.y+")":"",f,e;r.visible&&(f=(r.height+h)/2,e=(r.width+h)/2,(s="Cartesian"===n.chart.chartAreaType?vt(t,i=new y(this.elementId+"_ChartMarkerClipRect_"+u,"transparent",{width:1,color:"Gray"},1,{x:-e,y:-f,width:n.clipRect.width+2*e,height:n.clipRect.height+2*f}),o):vt(t,i=new si(this.elementId+"_ChartMarkerClipRect_"+u,"transparent",{width:1,color:"Gray"},1,n.clipRect.width/2+n.clipRect.x,n.clipRect.height/2+n.clipRect.y,n.chart.radius+Math.max(f,e)),o,"drawCircularClipPath"),i={id:this.elementId+"SymbolGroup"+u,transform:c,"clip-path":"url(#"+this.elementId+"_ChartMarkerClipRect_"+u+")"},n.symbolElement=o.createGroup(i),n.symbolElement.appendChild(s),this.chart.enableCanvas)&&document.getElementById(this.chart.element.id+"_tooltip_svg").appendChild(n.symbolElement))},t.prototype.getRangeLowPoint=function(n,t){var i=n.x,r=n.y;return t.chart.requireInvertedAxis?(r+=n.height/2,i+=t.yAxis.isInversed?n.width:0):(r+=t.yAxis.isInversed?0:n.height,i+=n.width/2),{x:i,y:r}},t.prototype.doMarkerAnimation=function(n){var o;if("Scatter"!==n.type&&"Bubble"!==n.type&&"Candle"!==n.type&&"Hilo"!==n.type&&"HiloOpenClose"!==n.type&&("PolarRadar"!==n.chart.chartAreaType||"Scatter"!==n.drawType))for(var r=n.symbolElement.childNodes,u=n.animation.delay+n.animation.duration,f=n.chart.animated?n.chart.duration:200,i=1,e="RangeArea"===n.type||"RangeColumn"===n.type||"SplineRangeArea"===n.type?2:1,t=0;t<n.points.length;t++)if(n.points[t].symbolLocations){if(!n.points[t].symbolLocations.length||!r[i])continue;(oi(r[i],u,f,n,t,n.points[t].symbolLocations[0],!1),2===e)&&(o=this.getRangeLowPoint(n.points[t].regions[0],n),oi(r[i+1],u,f,n,t,o,!1));i+=e}},t}(yy),ll=(bf=function(n,t){return(bf=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}bf(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),p=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},by=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ll(t,n),p([sf.base.Property(0)],t.prototype,"x",void 0),p([sf.base.Property(0)],t.prototype,"y",void 0),t}(sf.base.ChildProperty),ky=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ll(t,n),p([sf.base.Property(!0)],t.prototype,"visible",void 0),p([sf.base.Property(null)],t.prototype,"height",void 0),p([sf.base.Property(null)],t.prototype,"width",void 0),p([sf.base.Complex({x:0,y:0},by)],t.prototype,"location",void 0),p([sf.base.Property("Auto")],t.prototype,"position",void 0),p([sf.base.Property("Series")],t.prototype,"mode",void 0),p([sf.base.Property(8)],t.prototype,"padding",void 0),p([sf.base.Property("Center")],t.prototype,"alignment",void 0),p([sf.base.Complex(ct.legendLabelFont,lt)],t.prototype,"textStyle",void 0),p([sf.base.Property(10)],t.prototype,"shapeHeight",void 0),p([sf.base.Property(10)],t.prototype,"shapeWidth",void 0),p([sf.base.Complex({},ot)],t.prototype,"border",void 0),p([sf.base.Complex({left:0,right:0,top:0,bottom:0},vr)],t.prototype,"margin",void 0),p([sf.base.Complex({left:0,right:0,top:0,bottom:0},th)],t.prototype,"containerPadding",void 0),p([sf.base.Property(5)],t.prototype,"shapePadding",void 0),p([sf.base.Property("transparent")],t.prototype,"background",void 0),p([sf.base.Property(1)],t.prototype,"opacity",void 0),p([sf.base.Property(!0)],t.prototype,"toggleVisibility",void 0),p([sf.base.Property(null)],t.prototype,"description",void 0),p([sf.base.Property(3)],t.prototype,"tabIndex",void 0),p([sf.base.Property(null)],t.prototype,"title",void 0),p([sf.base.Complex(ct.legendTitleFont,lt)],t.prototype,"titleStyle",void 0),p([sf.base.Property("Top")],t.prototype,"titlePosition",void 0),p([sf.base.Property(100)],t.prototype,"maximumTitleWidth",void 0),p([sf.base.Property(!0)],t.prototype,"enablePages",void 0),p([sf.base.Property(!1)],t.prototype,"isInversed",void 0),t}(sf.base.ChildProperty),dy=function(){function n(n){this.pageXCollections=[];this.legendTitleCollections=[];this.legendRegions=[];this.pagingRegions=[];this.chart=n;this.legend=n.legendSettings;this.legendID=n.element.id+"_chart_legend";this.isChartControl="chart"===n.getModuleName();this.isBulletChartControl="bulletChart"===n.getModuleName();this.isStockChartControl="stockChart"===n.getModuleName();this.bulletChart=this.chart;this.fivePixel=5;this.rowCount=0;this.pageButtonSize=8;this.maxColumns=0;this.maxWidth=0;this.currentPage=1;this.backwardArrowOpacity=0;this.forwardArrowOpacity=1;this.arrowWidth=2*(this.fivePixel+this.pageButtonSize+this.fivePixel);this.arrowHeight=this.arrowWidth;this.isTop=!1;this.isTitle=!1;this.currentPageNumber=1}return n.prototype.calculateLegendBounds=function(n,t,i){var r=this.legend,u=this.isBulletChartControl?"40%":"20%";this.getPosition(r.position,t);this.legendBounds=new sf.svgbase.Rect(n.x,n.y,0,0);this.isVertical="Left"===this.position||"Right"===this.position;this.isVertical?(this.legendBounds.height=ri(r.height,t.height-(n.y-this.chart.margin.top))||n.height,this.legendBounds.width=ri(r.width||u,t.width)):(this.legendBounds.width=ri(r.width,t.width)||n.width,this.legendBounds.height=ri(r.height||u,t.height));this.library.getLegendBounds(t,this.legendBounds,r);this.isBulletChartControl||(this.legendBounds.width+=this.legend.containerPadding.left+this.legend.containerPadding.right,this.legendBounds.height+=this.legend.containerPadding.top+this.legend.containerPadding.bottom);this.getLocation(this.position,r.alignment,this.legendBounds,n,t,i)},n.prototype.getPosition=function(n,t){var i=this.chart,r=this.chart;this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.position="Auto"!==n?n:"Bottom":("Auto"===n&&((i||r).visibleSeries&&"Funnel"===(i||r).visibleSeries[0].type||"Pyramid"===(i||r).visibleSeries[0].type)&&(n="Top"),this.position="Auto"!==n?n:t.width>t.height?"Right":"Bottom")},n.prototype.setBounds=function(n,t,i,r){var u=i.title&&"Top"===i.titlePosition?this.legendTitleSize.height+this.fivePixel:0;this.isVertical&&this.isPaging&&!i.enablePages&&!this.isBulletChartControl&&(u=i.title&&"Top"===i.titlePosition?this.legendTitleSize.height+this.fivePixel:0,u+=this.pageButtonSize+this.fivePixel);n=Math.min(n,r.width);t=Math.min(t,r.height);"Gradient"===i.mode?(r.width=i.width?r.width:this.isVertical?n:.75*r.width,r.height=i.height?r.height:this.isVertical?.75*r.height:t):(r.width=i.width?r.width:n,r.height=i.height?r.height:t);this.isBulletChartControl||this.isTop&&"None"!==i.titleStyle.textOverflow&&(this.calculateLegendTitle(i,r),r.height+="Wrap"===i.titleStyle.textOverflow&&this.legendTitleCollections.length>1?this.legendTitleSize.height-this.legendTitleSize.height/this.legendTitleCollections.length:0);this.rowCount=Math.max(1,Math.ceil((r.height-i.padding-u)/(this.maxItemHeight+i.padding)))},n.prototype.getLocation=function(n,t,i,r,u,f){var o=this.legend.border.width,s=this.isBulletChartControl,e=this.bulletChart,c="Inside"===e.labelPosition,l="Inside"===e.tickPosition,h="Vertical"===e.orientation,p=s&&""!==e.categoryField?f.width+this.chart.border.width+3*o:0,v=this.chart.margin.bottom,y=i.height+o+this.legend.margin.top+this.legend.margin.bottom,a=i.width+o+this.legend.margin.left+this.legend.margin.right;"Bottom"===n?(i.x=this.alignLegend(i.x,u.width,i.width,t),i.y=r.y+(r.height-y)+o+this.legend.margin.top,i.y+=!s||e.opposedPosition||c||l||h?h&&""!==e.categoryField?f.height+2*o:0:e.majorTickLines.height+v+this.legend.border.width+2*o,kt(r,new gt(0,0,0,y))):"Top"===n?(i.x=this.alignLegend(i.x,u.width,i.width,t),i.y=r.y+o+this.legend.margin.top,i.y-=!s||!e.opposedPosition||c||l||h?0:e.majorTickLines.height+this.chart.margin.top,kt(r,new gt(0,0,y-=s?2*-o:0,0))):"Right"===n?(i.x=r.x+(r.width-i.width)-this.legend.margin.right,i.y=r.y+this.alignLegend(0,u.height-(r.y+v),i.height,t),a+=s&&e.opposedPosition&&!c&&!l&&h?this.chart.margin.left+this.chart.margin.right+e.majorTickLines.height:0,kt(r,new gt(0,a,0,0))):"Left"===n?(i.x=i.x+this.legend.margin.left,i.y=r.y+this.alignLegend(0,u.height-(r.y+v),i.height,t),a+=!s||e.opposedPosition||c||l||!h?"Vertical"!==e.orientation&&""!==e.categoryField?p:0:i.x-this.chart.margin.left+o+e.majorTickLines.height,kt(r,new gt(a,0,0,0))):(i.x=this.legend.location.x,i.y=this.legend.location.y,kt(r,new gt(0,0,0,0)))},n.prototype.alignLegend=function(n,t,i,r){switch(r){case"Far":n=t-i-n;break;case"Center":n=(t-i)/2}return n},n.prototype.renderLegend=function(n,t,i,r){var b,c=0,k=(new sf.svgbase.Rect(0,0,0,0),new sf.svgbase.Rect(0,0,0,0)),v=this.findFirstLegendPosition(this.legendCollections),l=t.padding,et=t.enablePages,y=t.titlePosition,tt=this.isPaging&&!t.enablePages&&this.isVertical?this.pageButtonSize:0,d=n.renderer.createGroup({id:this.legendID+"_g"}),g=this.createLegendElements(n,i,d,t,this.legendID,r),p,a,w,nt,u;for(this.legendRegions=[],p=0,a=0;a<this.legendCollections.length;a++)if(""!==this.legendCollections[a].text){p=Math.max(this.legendCollections[a].textSize.height,p);break}if(this.maxItemHeight=Math.max(p,t.shapeHeight),et||!this.isPaging||this.isVertical?this.isPaging||this.isVertical||(c=this.isTitle&&"Left"===y?this.fivePixel+this.legendTitleSize.width:0):(c=this.isTitle&&"Left"===y?this.legendTitleSize.width:0,c+=this.pageButtonSize+2*this.fivePixel),b=this.isTitle&&(this.isTop||this.isVertical)?this.legendTitleSize.height:0,"Gradient"===n.legendSettings.mode&&this.legendCollections.length>1)this.getLinearLegend(i,n,t,g),this.totalPages=1;else if(v!==this.legendCollections.length){var f=void 0,e=0,it=this.legendCollections[v],o=new s(this.isBulletChartControl?i.x+c+l+t.shapeWidth/2:i.x+c+l+t.shapeWidth/2+t.containerPadding.left,this.isBulletChartControl?i.y+b+tt+l+this.maxItemHeight/2:i.y+b+tt+l+this.maxItemHeight/2+t.containerPadding.top),ot=n.isRtlEnabled?"end":"start",rt=new sf.svgbase.TextOption("",o.x,o.y,ot),st=t.shapePadding+l+t.shapeWidth;if(this.totalPages=this.totalPages=this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.totalPages:0,this.pageXCollections=[],this.legendCollections[v].location=o,!t.enablePages&&this.isPaging){var ht=o.x-this.fivePixel,ut=o.y-this.fivePixel,ct=this.isTitle&&!this.isVertical&&"Left"===y?this.legendTitleSize.width+this.fivePixel:0,lt=this.isVertical?this.pageButtonSize+Math.abs(ut-i.y):0,ft=this.isTitle&&!this.isVertical&&"Right"===y?this.legendTitleSize.width+this.fivePixel:0;ft+=this.isVertical?0:this.fivePixel+this.pageButtonSize+this.fivePixel;k=new sf.svgbase.Rect(ht,ut,i.width-ft-ct,i.height-lt)}else k=i;for(w=0,nt=this.legendCollections;w<nt.length;w++)u=nt[w],"accumulationchart"===this.chart.getModuleName()&&(u.fill=(this.chart||this.chart||this.chart).visibleSeries[0].points[u.pointIndex].color),"stockChart"===this.chart.getModuleName()&&(u.type=this.chart.visibleSeries[e].type),this.accessbilityText=this.isBulletChartControl?"Legend of bullet chart"+u.text:"Click to show or hide the "+u.text+" series",u.render&&""!==u.text&&((f=n.renderer.createGroup({id:this.legendID+this.generateId(u,"_g_",e)}))&&(f.setAttribute("tabindex",t.tabIndex.toString()),f.setAttribute("aria-label",t.description||this.accessbilityText)),this.library.getRenderPoint(u,o,st,it,k,e,v),this.renderSymbol(u,f,e),this.renderText(n,u,f,rt,e),f&&f.setAttribute("style","outline: none; cursor: "+(!t.toggleVisibility&&("None"===n.selectionMode||"None"===n.highlightMode||"None"===n.selectionMode)||this.isBulletChartControl?"auto":"pointer")),g&&g.appendChild(f),it=u),e++;this.isPaging?this.renderPagingElements(n,i,rt,d):this.totalPages=1}h(n.enableCanvas,n.svgObject,d,r)},n.prototype.getLinearLegend=function(n,t,i,r){var wt="http://www.w3.org/2000/svg",c=this.legendCollections[0],ei=this.legendCollections[1],bt=this.chart.renderer.createDefs(),e=document.createElementNS(wt,"linearGradient"),l=[],f=[],d,ut,u,g,nt,o,kt,tt,ft,et,dt,gt,ni,a,ot,v,ri,ui,b,yt,pt,fi;for(i.title&&(this.isVertical?(n.y+=this.legendTitleSize.height,n.height-=this.legendTitleSize.height):"Left"===i.titlePosition?(n.x+=this.legendTitleSize.width,n.width-=this.legendTitleSize.width):"Right"===i.titlePosition?n.width-=this.legendTitleSize.width:"Top"===i.titlePosition&&(n.y+=this.legendTitleSize.height,n.height-=this.legendTitleSize.height)),d=0,ut=this.chart.rangeColorSettings;d<ut.length;d++){if(u=ut[d],f.indexOf(u.start)<0&&f.push(u.start),u.colors.length>2)if(g=u.end-u.start,nt=u.colors.length-1,g>0)for(g/=nt,o=1;o<nt;o++)kt=u.start+g*o,f.push(kt);else for(o=1;o<nt;o++)f.push(u.start);for(f.indexOf(u.end)<0&&f.push(u.end),tt=0,ft=u.colors;tt<ft.length;tt++)et=ft[tt],l.indexOf(et)<0&&l.push(et);u.colors.length>0&&u.colors.length<2&&l.push(u.colors[0])}for(dt=this.isVertical?"0":"100",gt=this.isVertical?"100":"0",e.setAttribute("id",this.generateId(c,"linearGradient",0)),e.setAttribute("x1","0%"),e.setAttribute("y1","0%"),e.setAttribute("x2",dt+"%"),e.setAttribute("y2",gt+"%"),ni=f[f.length-1]-f[0],a=0;a<l.length;a++)ot=f[a]-f[0],ot/=ni,v=document.createElementNS(wt,"stop"),v.setAttribute("offset",ot.toString()),v.setAttribute("stop-color",l[a]),v.setAttribute("stop-opacity",1..toString()),e.appendChild(v);var st,ht,ct,lt,ti=c.text.toString(),ii=ei.text.toString(),y=sf.svgbase.measureText(ti,i.textStyle),it=sf.svgbase.measureText(ii,i.textStyle),p=y.width>it.width?y.width:it.width,w=y.height>it.height?y.height:it.height,at=2*p+4*i.padding,s=n.width,h=n.height,vt=n.x+p+2*i.padding,rt=n.y+i.padding;this.isVertical?(at=2*w+4*i.padding,s=n.width-2*i.padding,h=n.height-at,vt=n.x+i.padding,rt=n.y+w+2*i.padding,st=n.y+i.padding+w,ht=rt+h+w,lt=ct=n.x+.5*n.width-.5*p,s>30)&&(ri=s-30,s=30,vt+=ri/2):(s=n.width-at,h=n.height-2*i.padding,ct=n.x+i.padding+(p-y.width),lt=n.x+s+3*i.padding+p,ht=st=n.y+.5*n.height+.25*w,h>30)&&(ui=h-30,h=30,rt+=ui/2);b=new sf.svgbase.TextOption("",ct,st,"",ti);b.id=this.legendID+this.generateId(c,"_text_",1);yt=c.visible?i.textStyle.color||t.themeStyle.legendLabel:"#D3D3D3";pt=!this.isStockChartControl&&this.chart.enableCanvas;k(t.renderer,b,i.textStyle,yt,r,!1,!1,!1,!1,null,this.currentPageNumber&&pt?new sf.svgbase.Rect(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null);(b=new sf.svgbase.TextOption("",lt,ht,"",ii)).id=this.legendID+this.generateId(c,"_text_",2);k(t.renderer,b,i.textStyle,yt,r,!1,!1,!1,!1,null,this.currentPageNumber&&pt?new sf.svgbase.Rect(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null);fi=t.renderer.drawRectangle({width:s,height:h,x:vt,y:rt,fill:"url(#"+this.generateId(c,"linearGradient",0)+")"});bt.appendChild(e);r.appendChild(bt);r.appendChild(fi)},n.prototype.findFirstLegendPosition=function(n){for(var i,r=0,t=0,u=n;t<u.length;t++){if(i=u[t],i.render&&""!==i.text)break;r++}return r},n.prototype.calculateLegendTitle=function(n,t){var i,r;n.title?(this.isTop="Top"===n.titlePosition,i="Trim"===n.titleStyle.textOverflow?2*n.padding:0,this.isTop||this.isVertical?this.legendTitleCollections=hr(n.title,n.titleStyle,t.width-i):this.legendTitleCollections[0]=at(n.maximumTitleWidth,n.title,n.titleStyle),r=this.isTop?n.title:this.legendTitleCollections[0],this.legendTitleSize=sf.svgbase.measureText(r,n.titleStyle),this.legendTitleSize.height*=this.legendTitleCollections.length):this.legendTitleSize=new sf.svgbase.Size(0,0)},n.prototype.renderLegendTitle=function(n,t,i,r){var o=t.padding,f=t.titleStyle.textAlignment,e,u;this.isTop="Top"===t.titlePosition;e="Near"===f?"start":"Far"===f?"end":"middle";u=iu(i,t.titleStyle);e=this.isTop||this.isVertical?e:"";u="Near"===f?u+o:"Far"===f?u-o:u;u=this.isTop||this.isVertical?u:i.x+("Left"===t.titlePosition?5:i.width-this.legendTitleSize.width-5);var s=i.height/2+this.legendTitleSize.height/4,h=i.y+(this.isTop||this.isVertical?this.legendTitleSize.height/this.legendTitleCollections.length:s),c=new sf.svgbase.TextOption(this.legendID+"_title",u,h,e,this.legendTitleCollections);k(n.renderer,c,t.titleStyle,t.titleStyle.color,r)},n.prototype.createLegendElements=function(n,t,i,r,u,f){var l=r.padding,e=new y(u+"_element",r.background,r.border,r.opacity,t),s=n.renderer.createGroup({id:u+"_collections"}),o=!this.isStockChartControl&&n.enableCanvas,c=n.renderer.createClipPath({id:u+"_clipPath"});return i?i.appendChild(n.renderer.drawRectangle(e)):n.renderer.drawRectangle(e),r.title&&this.renderLegendTitle(n,r,t,i),o||i.appendChild(s),this.legendTranslateGroup=n.renderer.createGroup({id:u+"_translate_g"}),o||s.appendChild(this.legendTranslateGroup),e.y+=l+(this.isTop?this.legendTitleSize.height:0),e.id+="_clipPath_rect",e.width=this.isChartControl||"bulletChart"===n.getModuleName()||this.isStockChartControl||!this.isVertical?t.width:this.maxWidth-l+r.containerPadding.left+r.containerPadding.right,o?this.pagingClipRect=e:(this.clipRect=n.renderer.drawRectangle(e),c.appendChild(this.clipRect)),h(o,n.svgObject,c,f),o||s.setAttribute("style","clip-path:url(#"+c.id+")"),this.legendTranslateGroup},n.prototype.renderSymbol=function(n,t,i){var l,h,e=this.isBulletChartControl?this.chart:null,c=n.visible?n.fill:"#D3D3D3",p=("chart"===this.chart.getModuleName()||"stockChart"===this.chart.getModuleName())&&"SeriesType"===n.shape&&n.type.toLowerCase().indexOf("line")>-1&&-1===n.type.toLowerCase().indexOf("area"),a=!("chart"!==this.chart.getModuleName()&&"stockChart"!==this.chart.getModuleName()||"Scatter"!==n.type&&"Bubble"!==n.type),v=!this.isStockChartControl&&this.chart.enableCanvas,r="SeriesType"===n.shape?n.type:n.shape,y=p?"Series"===this.legend.mode?this.chart.visibleSeries[i].width:this.chart.visibleSeries[0].width:this.isBulletChartControl&&"Multiply"===n.shape?4:1,f;(r="Scatter"===r?n.markerShape:r,a&&i<this.chart.visibleSeries.length)&&(f=this.chart.visibleSeries[i].border,l=f.color?f.color:c,y=f.width?f.width:1);var u=new sf.svgbase.PathOption(this.legendID+this.generateId(n,"_shape_",i),c,y,a?l:c,1,"",""),w=sf.svgbase.measureText(n.text,this.legend.textStyle),o=this.legend.isInversed?n.location.x+w.width+this.legend.shapePadding:n.location.x,s=n.location.y;v?(h=-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),rt({x:o,y:s},r,new sf.svgbase.Size(this.legend.shapeWidth,this.legend.shapeHeight),"",u,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new sf.svgbase.Rect(0,h,0,0):null,this.isBulletChartControl,e),this.legendRegions.push({rect:new sf.svgbase.Rect(n.location.x,n.location.y,this.legend.shapeWidth,this.legend.shapeHeight+h),index:i})):t.appendChild(rt({x:o,y:s},r,new sf.svgbase.Size(this.legend.shapeWidth,this.legend.shapeHeight),n.url,u,this.accessbilityText,this.chart.renderer,null,this.isBulletChartControl,e));("Line"===r&&n.markerVisibility&&"Image"!==n.markerShape||"Doughnut"===n.type&&"Doughnut"===r)&&(u.id=this.legendID+this.generateId(n,"_shape_marker_",i),r="Doughnut"===n.type?"Circle":n.markerShape,u.fill="Doughnut"===n.type?"#FFFFFF":u.fill,v?rt({x:o,y:s},r,new sf.svgbase.Size(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",u,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new sf.svgbase.Rect(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,this.isBulletChartControl,e):t.appendChild(rt({x:o,y:s},r,new sf.svgbase.Size(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",u,this.accessbilityText,null,null,this.isBulletChartControl,e)))},n.prototype.renderText=function(n,t,i,r,u){var f=n.legendSettings,h=t.visible?f.textStyle.color||n.themeStyle.legendLabel:"#D3D3D3",s=!this.isStockChartControl&&this.chart.enableCanvas,o,e;r.id=this.legendID+this.generateId(t,"_text_",u);r.text=t.text;r.x=f.isInversed?t.location.x-f.shapeWidth/2:t.location.x+f.shapeWidth/2+f.shapePadding;r.y=t.location.y+this.maxItemHeight/4;o=k(n.renderer,r,f.textStyle,h,i,!1,!1,!1,!1,null,this.currentPageNumber&&s?new sf.svgbase.Rect(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null);(o&&o.setAttribute("aria-label",f.description||this.accessbilityText),s)&&(e=sf.svgbase.measureText(r.text,f.textStyle),this.legendRegions[u].rect.y=r.y<this.legendRegions[u].rect.y?r.y:this.legendRegions[u].rect.y,this.legendRegions[u].rect.width+=e.width,this.legendRegions[u].rect.height=e.height,this.legendRegions[u].rect.y-=.5*e.height)},n.prototype.renderPagingElements=function(n,t,i,r){var v,h=n.renderer.createGroup({id:this.legendID+"_navigation"}),l=!this.isStockChartControl&&n.enableCanvas,a=this.isBulletChartControl?0:this.legendTitleSize.height,p=this.chart.theme.indexOf("Dark")>-1?"#FFFFFF":"#545454",f=n.legendSettings,s=new sf.svgbase.PathOption(this.legendID+"_pageup","transparent",5,p,1,"",""),u=this.pageButtonSize,w=f.enablePages||!this.isPaging||this.isVertical||this.isBulletChartControl?this.rowCount-1:1,b=this.isTitle&&"Left"===f.titlePosition?this.legendTitleSize.width:0,e,o,c,y;this.pagingRegions=[];this.backwardArrowOpacity=1!==this.currentPage?1:0;this.forwardArrowOpacity=this.currentPage===this.totalPages?0:1;l||r.appendChild(h);this.totalPages=this.isChartControl||this.isBulletChartControl||this.isStockChartControl||!this.isVertical?Math.ceil(this.totalPages/Math.max(1,this.rowCount-1)):Math.ceil(this.totalPages/this.maxColumns);h&&h.setAttribute("style","cursor: pointer");this.clipPathHeight=w*(this.maxItemHeight+f.padding);l?(this.pagingClipRect.height=this.legendBounds.height-this.clipPathHeight-(this.pagingClipRect.y-this.legendBounds.y)-f.border.width,this.pagingClipRect.y=this.pagingClipRect.y+this.clipPathHeight,this.pagingClipRect.x+=f.border.width,this.pagingClipRect.width-=f.border.width+f.border.width/2,this.chart.renderer.clearRect(new sf.svgbase.Rect(this.pagingClipRect.x,this.pagingClipRect.y,this.pagingClipRect.width,this.pagingClipRect.height))):this.clipRect.setAttribute("height",this.clipPathHeight.toString());e=t.x+u/2;o=t.y+this.clipPathHeight+(a+t.height-this.clipPathHeight)/2;!this.isPaging||f.enablePages||this.isVertical||this.isBulletChartControl||(e=t.x+this.fivePixel+this.pageButtonSize+b,o=f.title&&this.isTop?t.y+8+a+u/1+.5:t.y+8+u+.5);c=sf.svgbase.measureText(this.totalPages+"/"+this.totalPages,f.textStyle);l?rt({x:e,y:o},"LeftArrow",new sf.svgbase.Size(u,u),"",s,0,this.chart.renderer,new sf.svgbase.Rect(t.width-(2*(u+8)+8+c.width),0,0,0)):!this.isVertical||f.enablePages||this.isBulletChartControl?(s.opacity=this.isBulletChartControl?s.opacity:f.enablePages?1:this.backwardArrowOpacity,h.appendChild(rt({x:e,y:o},"LeftArrow",new sf.svgbase.Size(u,u),"",s))):(e=t.x+t.width/2,o=t.y+u/2+8+a,s.opacity=this.backwardArrowOpacity,h.appendChild(rt({x:e,y:o},"UpArrow",new sf.svgbase.Size(u,u),"",s)));this.pagingRegions.push(new sf.svgbase.Rect(e+t.width-(2*(u+8)+8+c.width)-.5*u,o-.5*u,u,u));i.x=e+u/2+8;i.y=o+c.height/4;i.id=this.legendID+"_pagenumber";i.text="1/"+this.totalPages;y=this.chart.theme.indexOf("Dark")>-1?"#FFFFFF":f.textStyle.color;l&&this.totalNoOfPages&&(i.text=this.currentPageNumber+"/"+this.totalNoOfPages);(f.enablePages||this.isBulletChartControl)&&(v=k(n.renderer,i,f.textStyle,y,h,!1,!1,!1,!1,null,new sf.svgbase.Rect(t.width-(2*(u+8)+8+c.width),0,0,0)));e=i.x+8+u/2+c.width;!this.isPaging||f.enablePages||this.isVertical||(e=t.x+t.width-this.fivePixel-this.pageButtonSize-(f.title&&"Right"===f.titlePosition?this.legendTitleSize.width+this.fivePixel:0));s.id=this.legendID+"_pagedown";s.opacity=f.enablePages?1:this.forwardArrowOpacity;l?rt({x:e,y:o},"RightArrow",new sf.svgbase.Size(u,u),"",s,0,this.chart.renderer,new sf.svgbase.Rect(t.width-(2*(u+8)+8+c.width),0,0,0)):!this.isVertical||f.enablePages||this.isBulletChartControl?h.appendChild(rt({x:e,y:o},"RightArrow",new sf.svgbase.Size(u,u),"",s)):(e=t.x+t.width/2,o=t.y+t.height-u/2-8,h.appendChild(rt({x:e,y:o},"DownArrow",new sf.svgbase.Size(u,u),"",s)));this.pagingRegions.push(new sf.svgbase.Rect(e+(t.width-(2*(u+8)+8+c.width)-.5*u),o-.5*u,u,u));l||!f.enablePages&&!this.isBulletChartControl?(1===this.currentPageNumber&&this.calTotalPage&&(f.enablePages||this.isBulletChartControl)&&(this.totalNoOfPages=this.totalPages,this.calTotalPage=!1),f.enablePages||this.isBulletChartControl||this.translatePage(null,this.currentPage-1,this.currentPage,f)):h.setAttribute("transform","translate("+(t.width-(2*(u+8)+8+c.width))+", 0)");(f.enablePages||this.isBulletChartControl)&&this.translatePage(v,this.currentPage-1,this.currentPage,f)},n.prototype.translatePage=function(n,t,i,r){var u=this.clipPathHeight*t,f="translate(0,-"+u+")";return this.isChartControl||this.isBulletChartControl||this.isStockChartControl||!this.isVertical||(f="translate(-"+(u=(u=this.pageXCollections[t*this.maxColumns]-this.legendBounds.x)<0?0:u)+",0)"),this.chart.enableCanvas||this.legendTranslateGroup.setAttribute("transform",f),this.chart.enableCanvas||!r.enablePages&&!this.isBulletChartControl||(n.textContent=i+"/"+this.totalPages),this.currentPage=i,u},n.prototype.changePage=function(n,t){var r=this.chart.legendSettings,f=document.getElementById(this.legendID+"_pageup"),e=document.getElementById(this.legendID+"_pagedown"),u=r.enablePages||this.isBulletChartControl?document.getElementById(this.legendID+"_pagenumber"):null,i=r.enablePages||this.isBulletChartControl?parseInt(u.textContent.split("/")[0],10):this.currentPage;t&&i>1?this.translatePage(u,i-2,i-1,r):!t&&i<this.totalPages&&this.translatePage(u,i,i+1,r);!this.isPaging||r.enablePages||this.isBulletChartControl||(this.currentPage===this.totalPages?this.hideArrow(e):this.showArrow(e),1===this.currentPage?this.hideArrow(f):this.showArrow(f))},n.prototype.hideArrow=function(n){n.setAttribute("opacity","0")},n.prototype.showArrow=function(n){n.setAttribute("opacity","1")},n.prototype.generateId=function(n,t,i){return this.isChartControl||this.isStockChartControl?t+i:t+n.pointIndex},n.prototype.move=function(n){var o=this,f=this.chart.mouseX,e=this.chart.mouseY,u,i,t;n.target.textContent.indexOf("...")>-1?(u=n.target.id.split(this.legendID+"_text_"),2===u.length&&(i=parseInt(u[1],10),t=this.chart.element,isNaN(i)||(this.chart.isTouch&&w(this.chart.element.id+"_EJ2_Legend_Tooltip"),this.isChartControl?rr(this.chart.series[i].name,f,e,t.offsetWidth,t.id+"_EJ2_Legend_Tooltip",r(this.chart.element.id+"_Secondary_Element")):rr(this.chart.visibleSeries[0].points[i].x.toString(),f+10,e+10,t.offsetWidth,t.id+"_EJ2_Legend_Tooltip",r(this.chart.element.id+"_Secondary_Element"))))):w(this.chart.element.id+"_EJ2_Legend_Tooltip");this.chart.isTouch&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout(function(){w(o.chart.element.id+"_EJ2_Legend_Tooltip")},1e3))},n}(),ar=function(n,t,i,r,u,f,e,o,s,h){this.location={x:0,y:0};this.text=n;this.fill=t;this.shape=i;this.url=f;this.visible=r;this.type=u;this.markerVisibility=o;this.markerShape=e;this.pointIndex=s;this.seriesIndex=h},gy=(kf=function(n,t){return(kf=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}kf(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),d=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},ls=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.clipRect=new sf.svgbase.Rect(0,0,0,0),t}return gy(t,n),t.prototype.setDataSource=function(n,t){n&&(this.xData=n.xData,this.yData=n.yData,this.points=n.points);t[tt(this.type)+"IndicatorModule"].initDataSource(this,t);t.visibleSeriesCount+=this.targetSeries.length},d([sf.base.Property("Sma")],t.prototype,"type",void 0),d([sf.base.Property(14)],t.prototype,"period",void 0),d([sf.base.Property(14)],t.prototype,"kPeriod",void 0),d([sf.base.Property(3)],t.prototype,"dPeriod",void 0),d([sf.base.Property(80)],t.prototype,"overBought",void 0),d([sf.base.Property(20)],t.prototype,"overSold",void 0),d([sf.base.Property(2)],t.prototype,"standardDeviation",void 0),d([sf.base.Property("Close")],t.prototype,"field",void 0),d([sf.base.Property(12)],t.prototype,"slowPeriod",void 0),d([sf.base.Property(26)],t.prototype,"fastPeriod",void 0),d([sf.base.Property(!0)],t.prototype,"showZones",void 0),d([sf.base.Complex({color:"#ff9933",width:2},pi)],t.prototype,"macdLine",void 0),d([sf.base.Property("Both")],t.prototype,"macdType",void 0),d([sf.base.Property("#2ecd71")],t.prototype,"macdPositiveColor",void 0),d([sf.base.Property("#e74c3d")],t.prototype,"macdNegativeColor",void 0),d([sf.base.Property("rgba(211,211,211,0.25)")],t.prototype,"bandColor",void 0),d([sf.base.Complex({color:"#ffb735",width:1},pi)],t.prototype,"upperLine",void 0),d([sf.base.Complex({color:"#f2ec2f",width:1},pi)],t.prototype,"lowerLine",void 0),d([sf.base.Complex({color:"#f2ec2f",width:1},pi)],t.prototype,"periodLine",void 0),d([sf.base.Property("")],t.prototype,"seriesName",void 0),t}(cs),as=function(){function n(n){this.control=n}return n.prototype.print=function(n){this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no");this.printWindow.moveTo(0,0);this.printWindow.resizeTo(screen.availWidth,screen.availHeight);var t={cancel:!1,htmlContent:this.getHTMLContent(n),name:"beforePrint"};this.control.trigger("beforePrint",t);t.cancel||sf.base.print(t.htmlContent,this.printWindow)},n.prototype.getHTMLContent=function(n){var t=sf.base.createElement("div"),i,u;if(n)if(_instanceof(n,Array))for(i=0;i<n.length;i++)u=n[i],t.appendChild(r(u).cloneNode(!0));else _instanceof(n,Element)?t.appendChild(n.cloneNode(!0)):t.appendChild(r(n).cloneNode(!0));else t.appendChild(this.control.element.cloneNode(!0));return t},n.prototype.export=function(n,t,i,r,u,f,e,o,s){var b=this,c=this.getControlsValue(r,e),k,h,a,l,d,v,g,y,p,nt;u=u||c.width;f=f||c.height;h=this.control.svgObject;a=this.control.enableCanvas;a||(h=sf.base.createElement("canvas",{id:"ej2-canvas",attrs:{width:u.toString(),height:f.toString()}}));l=!(sf.base.Browser.userAgent.toString().indexOf("HeadlessChrome")>-1);i=sf.base.isNullOrUndefined(i)?sf.pdfexport.PdfPageOrientation.Landscape:i;d='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+c.svg.outerHTML+"<\/svg>";v=window.URL.createObjectURL(new Blob("SVG"===n?[d]:[(new XMLSerializer).serializeToString(c.svg)],{type:"image/svg+xml"}));"SVG"===n?"msie"===sf.base.Browser.info.name?(g=new Blob([(new XMLSerializer).serializeToString(c.svg)],{type:"application/octet-stream"}),window.navigator.msSaveOrOpenBlob(g,t+"."+n.toLocaleLowerCase())):this.triggerDownload(t,n,v,l):"msie"===sf.base.Browser.info.name?(y=h,a||(y=this.createCanvas()),k=y.toDataURL(),"PDF"===n?this.exportPdf(y,i,u,f,l,t,o,s):this.doexport(n,k,t)):(p=new Image,nt=h.getContext("2d"),p.onload=function(){nt.drawImage(p,0,0);window.URL.revokeObjectURL(v);"PDF"===n?b.exportPdf(h,i,u,f,l,t,o,s):window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(h.toBlob(null),t+"."+n.toLocaleLowerCase()):b.triggerDownload(t,n,h.toDataURL("image/"+n.toLowerCase()),l)},p.src=v);a||w(document.getElementById(this.control.element.id+"_canvas"))},n.prototype.getDataUrl=function(n){var f=this.getControlsValue([n]),t=this.control.svgObject,e=this.control.enableCanvas,i,r,o,u,s;return(e||(t=sf.base.createElement("canvas",{id:"ej2-canvas",attrs:{width:f.width.toString(),height:f.height.toString()}})),i=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(f.svg)],{type:"image/svg+xml"})),"msie"===sf.base.Browser.info.name)?(r=t,e||(r=this.createCanvas()),o={name:"afterExport",cancel:!1,dataUrl:t.toDataURL("image/png")},n.trigger("afterExport",o),{element:r,dataUrl:r.toDataURL()}):(u=new Image,s=t.getContext("2d"),u.onload=function(){s.drawImage(u,0,0);window.URL.revokeObjectURL(i);var r={name:"afterExport",cancel:!1,dataUrl:t.toDataURL("image/png")};return n.trigger("afterExport",r),r.dataUrl},u.src=i,{element:t,blobUrl:i})},n.prototype.triggerDownload=function(n,t,i,r){sf.base.createElement("a",{attrs:{download:n+"."+t.toLocaleLowerCase(),href:i}}).dispatchEvent(new MouseEvent(r?"click":"move",{view:window,bubbles:!1,cancelable:!0}))},n.prototype.getControlsValue=function(n,t){var i=0,r=0,f=this.control.enableCanvas,u=new sf.svgbase.SvgRenderer("").createSvg({id:"Svg_Export_Element",width:200,height:200});return n.map(function(n){var e=n.svgObject.cloneNode(!0),o=n.renderer.createGroup({style:sf.base.isNullOrUndefined(t)||t?"transform: translateY("+r+"px)":"transform: translateX("+i+"px)"}),s=e.childNodes[0].getAttribute("fill");"Tailwind"!==n.theme&&"TailwindDark"!==n.theme||"rgba(255,255,255, 0.0)"!==s&&"transparent"!==s||e.childNodes[0].setAttribute("fill","rgba(255,255,255, 1)");f||o.appendChild(e);i=sf.base.isNullOrUndefined(t)||t?Math.max(n.availableSize.width,i):i+n.availableSize.width;r=sf.base.isNullOrUndefined(t)||t?r+n.availableSize.height:Math.max(n.availableSize.height,r);f||u.appendChild(o)}),f||(u.setAttribute("width",i+""),u.setAttribute("height",r+"")),{width:i,height:r,svg:u}},n.prototype.createCanvas=function(){var n=this.control,t;return this.canvasRender(!0,n),t=n.svgObject,this.canvasRender(!1,n),t},n.prototype.canvasRender=function(n,t){t.enableCanvas=n;t.preRender();t.render()},n.prototype.exportPdf=function(n,t,i,r,u,f,e,o){var s=new sf.pdfexport.PdfDocument,h=s.pageSettings.margins,p=s.pageSettings.width,w=s.pageSettings.height,c=n.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream"),l,b,a,v,y;s.pageSettings.orientation=t;l=p<i?i+h.left+h.right:p;b=w<r?r+h.top+h.bottom:w;void 0!==e&&(a=new sf.pdfexport.PdfStandardFont(1,e.fontSize||15),v=new sf.pdfexport.PdfPageTemplateElement(l,40),v.graphics.drawString(e.content+"",a,null,new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(0,0,0)),e.x,e.y,null),s.template.top=v);void 0!==o&&(a=new sf.pdfexport.PdfStandardFont(1,o.fontSize||15),y=new sf.pdfexport.PdfPageTemplateElement(l,40),y.graphics.drawString(o.content+"",a,null,new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(0,0,0)),o.x,o.y,null),s.template.bottom=y);s.pageSettings.size=new sf.pdfexport.SizeF(l,b);c=c.slice(c.indexOf(",")+1);s.pages.add().graphics.drawImage(new sf.pdfexport.PdfBitmap(c),0,0,i,r);u&&(s.save(f+".pdf"),s.destroy())},n.prototype.doexport=function(n,t,i){var r,u=n||"JPG";r=[t];this.exportImage(r,i,u,t)},n.prototype.exportImage=function(n,t,i){for(var u,h,f=[],c=_instanceof(n,HTMLElement)?0:n.length,e=0;e<c;e++){for(var l=n[e].replace(/^data:[a-z]*;,/,"").split(","),o=atob(l[1]),s=new ArrayBuffer(o.length),a=new Uint8Array(s),r=0;r<o.length;r++)a[r]=o.charCodeAt(r);f.push(s)}for(u=0;u<f.length;u++)h=new Blob([f[u]],{type:"application/octet-stream"}),"msie"===sf.base.Browser.info.name&&window.navigator.msSaveOrOpenBlob(h,t+"."+i.toLocaleLowerCase())},n}(),fu=(df=function(n,t){return(df=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}df(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},al=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fu(t,n),u([sf.base.Property()],t.prototype,"start",void 0),u([sf.base.Property()],t.prototype,"end",void 0),u([sf.base.Property([])],t.prototype,"colors",void 0),u([sf.base.Property("")],t.prototype,"label",void 0),t}(sf.base.ChildProperty),vl=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fu(t,n),u([sf.base.Property(!1)],t.prototype,"enable",void 0),u([sf.base.Property("")],t.prototype,"dashArray",void 0),u([sf.base.Complex({color:null,width:1},ot)],t.prototype,"line",void 0),u([sf.base.Property("Both")],t.prototype,"lineType",void 0),u([sf.base.Property("")],t.prototype,"verticalLineColor",void 0),u([sf.base.Property("")],t.prototype,"horizontalLineColor",void 0),u([sf.base.Property(1)],t.prototype,"opacity",void 0),t}(sf.base.ChildProperty),yl=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fu(t,n),u([sf.base.Property(!1)],t.prototype,"enableSelectionZooming",void 0),u([sf.base.Property(!1)],t.prototype,"enablePinchZooming",void 0),u([sf.base.Property(!1)],t.prototype,"enableMouseWheelZooming",void 0),u([sf.base.Property(!0)],t.prototype,"enableDeferredZooming",void 0),u([sf.base.Property("XY")],t.prototype,"mode",void 0),u([sf.base.Property(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],t.prototype,"toolbarItems",void 0),u([sf.base.Property(!1)],t.prototype,"enablePan",void 0),u([sf.base.Property(!1)],t.prototype,"enableScrollbar",void 0),t}(sf.base.ChildProperty),pl=function(t){function i(n,i){var r=t.call(this,n,i)||this;return r.rotatedDataLabelCollections=[],r.animated=!1,r.isPointMouseDown=!1,r.isScrolling=!1,r.checkResize=0,r.visible=0,r.clickCount=0,r.singleClickTimer=0,r.chartAreaType="Cartesian",r.isRtlEnabled=!1,r.chartid=57723,sf.base.setValue("mergePersistData",r.mergePersistChartData,r),r}return fu(i,t),i.prototype.mergePersistChartData=function(){var u=window.localStorage.getItem(this.getModuleName()+this.element.id),i,e,r,f,t;if(!sf.base.isNullOrUndefined(u)&&""!==u){for(i=JSON.parse(u),e=Object.keys(i),this.isProtectedOnChange=!0,r=0,f=e;r<f.length;r++)t=f[r],"object"!==n(this[t])||sf.base.isNullOrUndefined(this[t])?this[t]=i[t]:sf.base.extend(this[t],i[t]);this.isProtectedOnChange=!1}},i.prototype.isIdHasSpecialCharacter=function(n){var u=/^[A-Za-z ]+$/,f=/^[0-9 ]+$/,i="",r,t;if(u.test(n))return n;for(r=0,f.test(n[0])&&(i+="\\3"+n[0],r=1),t=r;t<n.length;t++)i+=u.test(n[t])||-1!==n.indexOf("-")||-1!==n.indexOf("_")||-1!==n.indexOf("\\")||f.test(n[t])?n[t]:"\\"+n[t];return i},i.prototype.preRender=function(){this.element.id=this.isIdHasSpecialCharacter(this.element.id);this.isBlazor=window.Blazor;this.allowServerDataBinding=!1;this.unWireEvents();this.initPrivateVariable();this.setCulture();this.wireEvents();this.stockChart&&(null===this.stockChart.tooltip.header&&(this.tooltip.header="<b>${point.x}<\/b>"),null===this.stockChart.tooltip.format&&(this.tooltip.format="High : <b>${point.high}<\/b><br/>Low : <b>${point.low}<\/b><br/>Open : <b>${point.open}<\/b><br/>Close : <b>${point.close}<\/b>",""!==this.stockChart.series[0].volume&&(this.tooltip.format+="<br/>Volume : <b>${point.volume}<\/b>")),this.animateSeries=!1)},i.prototype.initPrivateVariable=function(){if(this.animateSeries=!0,this.delayRedraw=!1,this.horizontalAxes=[],this.verticalAxes=[],this.refreshAxis(),this.refreshDefinition(this.rows),this.refreshDefinition(this.columns),this.tooltipModule&&(this.tooltipModule.previousPoints=[]),""===this.element.id){var n=document.getElementsByClassName("e-chart").length;this.element.id="chart_"+this.chartid+"_"+n}this.svgId=this.stockChart?this.stockChart.element.id+"_stockChart_chart":this.element.id+(this.enableCanvas?"_canvas":"_svg")},i.prototype.render=function(){var t=this,n;this.svgRenderer=new sf.svgbase.SvgRenderer(this.element.id);n={chart:this.isBlazor?{}:this,theme:this.theme,name:"load",cancel:!1};this.stockChart?(this.isRtlEnabled="rtl"===window.getComputedStyle(document.querySelector("body")).direction,this.cartesianChartRendering(n)):this.trigger("load",n,function(){n.cancel||t.cartesianChartRendering(n)})},i.prototype.cartesianChartRendering=function(n){this.theme=this.isBlazor?n.theme:this.theme;this.createChartSvg();this.setTheme();this.markerRender=new wy(this);this.calculateAreaType();this.calculateVisibleSeries();this.initTechnicalIndicators();this.initTrendLines();this.calculateVisibleAxis();this.processData();this.renderComplete();this.allowServerDataBinding=!0},i.prototype.getLocalizedLabel=function(n){return this.localeObject.getConstant(n)},i.prototype.animate=function(n){this.redraw=!0;this.animated=!0;this.duration=n||1e3},i.prototype.refreshBound=function(){if(this.rotatedDataLabelCollections=[],this.legendModule&&this.legendSettings.visible&&this.legendModule.getLegendOptions(this.visibleSeries,this),this.tooltip.enable&&this.tooltipModule&&(this.tooltipModule.previousPoints=[]),this.calculateStackValues(),this.calculateBounds(),this.stockChart&&!this.stockChart.rangeFound&&(this.stockChart.enablePeriodSelector||this.stockChart.enableSelector))return null;this.renderElements();w("chartmeasuretext");this.removeSelection()},i.prototype.calculateStackValues=function(){for(var n,i=!1,t=0,r=this.visibleSeries.length;t<r;t++)(n=this.visibleSeries[t]).position=n.rectCount=void 0,-1===n.type.indexOf("Stacking")&&(-1===n.drawType.indexOf("Stacking")||"PolarRadar"!==this.chartAreaType)||i||(n.calculateStackedValue(n.type.indexOf("100")>-1,this),i=!0)},i.prototype.removeSelection=function(){for(var u,t,f,n=0,i=this.visibleSeries;n<i.length;n++)if(u=i[n],u.visible)for(t=0,f=u.points;t<f.length;t++)f[t].isSelect=!1;r(this.element.id+"_ej2_drag_multi_group")?(this.selectionMode.indexOf("Drag")>-1&&(this.selectionModule.filterArray=[]),w(this.element.id+"_ej2_drag_multi_group"),this.selectionModule.calculateDragSelectedElements(this,new sf.svgbase.Rect(0,0,0,0),!0)):r(this.element.id+"_ej2_drag_group")&&("Lasso"!==this.selectionMode&&(this.selectionModule.filterArray=[]),w(this.element.id+"_ej2_drag_group"),this.selectionModule.calculateDragSelectedElements(this,new sf.svgbase.Rect(0,0,0,0),!0))},i.prototype.renderElements=function(){var n,t,i;for(this.renderBorder(),this.renderTitle(),this.renderAreaBorder(),this.renderSeriesElements(this.renderAxes()),this.renderLegend(),this.applyZoomkit(),this.performSelection(),this.setSecondaryElementPosition(),n=0,t=this.visibleSeries;n<t.length;n++)i=t[n],sf.base.updateBlazorTemplate(this.element.id+"_DataLabel","Template",i.marker.dataLabel);this.renderAnnotation()},i.prototype.renderAxes=function(){var n;return this.yAxisElements=this.renderer.createGroup({id:this.element.id+"yAxisCollection"}),this.rows.length>0&&this.columns.length>0&&(n=this.chartAxisLayoutPanel.renderAxes()),this.stripLineModule&&this.stripLineModule.renderStripLine(this,"Behind",this.axisCollections),n},i.prototype.renderLegend=function(){if(this.legendModule&&this.legendModule.legendCollections.length&&this.legendSettings.visible){this.legendModule.calTotalPage=!0;var i=this.legendSettings.border.width,t=this.legendModule.legendBounds,n=new sf.svgbase.Rect(t.x,t.y,t.width,t.height);this.enableCanvas&&(n=new sf.svgbase.Rect(n.x-i/2,n.y-i/2,n.width+i,n.height+i),this.renderer.canvasClip(n));this.legendModule.renderLegend(this,this.legendSettings,t);this.enableCanvas&&this.renderer.canvasRestore()}this.redraw||(this.stockChart?r(this.stockChart.chartObject.id)||this.stockChart.mainObject.appendChild(this.svgObject):this.element.appendChild(this.svgObject))},i.prototype.setSecondaryElementPosition=function(){var n=r(this.element.id+"_Secondary_Element"),t,i;n&&(t=this.element.getBoundingClientRect(),i=r(this.svgId).getBoundingClientRect(),n.style.left=Math.max(i.left-t.left,0)+"px",n.style.top=Math.max(i.top-t.top,0)+"px")},i.prototype.initializeModuleElements=function(){this.dataLabelCollections=[];var n=this.element.id;this.series.length&&(this.seriesElements="Scatter"===this.series[0].type||"Bubble"===this.series[0].type?this.svgRenderer.createGroup({id:n+"SeriesCollection"}):this.renderer.createGroup({id:n+"SeriesCollection"}));this.indicators.length&&(this.indicatorElements=this.renderer.createGroup({id:n+"IndicatorCollection"}));this.hasTrendlines()&&(this.trendLineElements=this.renderer.createGroup({id:n+"TrendLineCollection"}));this.dataLabelElements=this.renderer.createGroup({id:n+"DataLabelCollection"})},i.prototype.hasTrendlines=function(){for(var t,n=0,i=this.series;n<i.length;n++)if(t=!!i[n].trendlines.length)break;return t},i.prototype.renderSeriesElements=function(n){var t,i,r,u;this.initializeModuleElements();t=this.element.id;"g"!==this.element.tagName&&(i=yt(this.redraw,t+"_Secondary_Element")||this.createElement("div"),i.id=t+"_Secondary_Element",i.setAttribute("style","position: relative"),h(!1,this.element,i,this.redraw));this.enableCanvas&&(r=document.getElementById(t+"_Secondary_Element"),r=r||this.createElement("div",{id:t+"_Secondary_Element",attrs:{style:"position: relative; left:0px; top:0px"}}),u=this.svgRenderer.createSvg({id:t+"_tooltip_svg",width:this.availableSize.width,height:this.availableSize.height}),u.setAttribute("style","position: absolute; pointer-events: none"),r.appendChild(u));this.tooltip.enable&&h(this.enableCanvas,this.svgObject,this.renderer.createGroup({id:t+"_UserInteraction",style:"pointer-events:none;"}),this.redraw);this.rows.length>0&&this.columns.length>0&&(this.initializeIndicator(),this.initializeTrendLine(),this.renderSeries(),this.trendLineElements&&h(this.enableCanvas,this.svgObject,this.trendLineElements,this.redraw),this.appendElementsAfterSeries(n))},i.prototype.renderSeries=function(){var t,i,n,u,r;for(this.enableCanvas&&this.renderer.canvasClip(this.chartAxisLayoutPanel.seriesClipRect),t=0,i=this.visibleSeries;t<i.length;t++)n=i[t],("TrendLine"===n.category?this.series[n.sourceIndex].trendlines[n.index].visible:n.visible)&&(this.visible++,br(n),this.enableCanvas&&this.renderCanvasSeries(n),n.renderSeries(this));this.enableCanvas&&this.renderer.canvasRestore();this.visible=0;u={id:this.element.id+"_ChartAreaClipRect_",x:this.chartAxisLayoutPanel.seriesClipRect.x,y:this.chartAxisLayoutPanel.seriesClipRect.y,width:this.chartAxisLayoutPanel.seriesClipRect.width,height:this.chartAxisLayoutPanel.seriesClipRect.height,fill:"transparent","stroke-width":1,stroke:"Gray"};this.seriesElements&&(this.enableCanvas||this.seriesElements.appendChild(vt(this.redraw,u,this.renderer)),r=document.getElementById(this.element.id+"_series_svg"),r?h(!1,r,this.seriesElements,this.redraw):h(this.enableCanvas,this.svgObject,this.seriesElements,this.redraw))},i.prototype.renderCanvasSeries=function(n){var t,i,r;("Bubble"===n.type||"Scatter"===n.type)&&(t=t||this.svgRenderer.createSvg({id:this.element.id+"_series_svg",width:this.availableSize.width,height:this.availableSize.height}),(i=i||this.createElement("div",{id:this.element.id+"_series"})).setAttribute("style","position: absolute"),r=document.getElementById(this.element.id+"_Secondary_Element"),i.appendChild(t),r.appendChild(i));t=!this.enableCanvas||"Bubble"!==n.type&&"Scatter"!==n.type?this.svgObject:t;this.enableCanvas&&("Bubble"===n.type||"Scatter"===n.type)||this.enableCanvas},i.prototype.initializeIndicator=function(){for(var n,t=0,i=this.indicators;t<i.length;t++)n=i[t],this[tt(n.type)+"IndicatorModule"]&&this[tt(n.type)+"IndicatorModule"].createIndicatorElements(this,n,n.index);this.indicatorElements&&h(this.enableCanvas,this.svgObject,this.indicatorElements,this.redraw)},i.prototype.initializeTrendLine=function(){for(var i,n=0,t=this.visibleSeries;n<t.length;n++)i=t[n],i.trendlines.length&&this.trendLineModule.getTrendLineElements(i,this)},i.prototype.appendElementsAfterSeries=function(n){"PolarRadar"===this.chartAreaType&&h(this.enableCanvas,this.svgObject,this.yAxisElements,this.redraw);h(this.enableCanvas,this.svgObject,n,this.redraw);(this.zoomModule&&this.zoomSettings.enableScrollbar&&this.scrollElement.childElementCount||this.scrollElement&&this.scrollElement.childElementCount)&&h(!1,r(this.element.id+"_Secondary_Element"),this.scrollElement,this.redraw);this.stripLineModule&&this.stripLineModule.renderStripLine(this,"Over",this.axisCollections);this.tooltip.enable||h(this.enableCanvas,this.svgObject,this.renderer.createGroup({id:this.element.id+"_UserInteraction",style:"pointer-events:none;"}),this.redraw);this.stockChart&&this.stockChart.calculateStockEvents()},i.prototype.applyZoomkit=function(){"PolarRadar"!==this.chartAreaType&&(this.redraw||!this.zoomModule||this.zoomSettings.enablePan&&!this.zoomModule.performedUI||this.zoomModule.applyZoomToolkit(this,this.axisCollections))},i.prototype.renderAnnotation=function(){this.annotationModule&&this.annotationModule.renderAnnotations(r((this.stockChart?this.stockChart.element.id:this.element.id)+"_Secondary_Element"))},i.prototype.performSelection=function(){var n=[];this.selectionModule&&(n=sf.base.extend([],this.selectionModule.selectedDataIndexes,null,!0),this.selectionModule.invokeSelection(this));this.highlightModule&&this.highlightModule.invokeHighlight(this);n.length>0&&(this.selectionModule.selectedDataIndexes=n,this.selectionModule.redrawSelection(this,this.selectionMode))},i.prototype.processData=function(n){var t,i,u,f,s;void 0===n&&(n=!0);this.visibleSeriesCount=0;for(var e=!0,r=0,o=this.visibleSeries;r<o.length;r++)t=o[r],t.visible||this.legendSettings.visible?"Indicator"!==t.category&&"TrendLine"!==t.category&&this.initializeDataModule(t):this.visibleSeriesCount++;for(i=0,u=this.indicators;i<u.length;i++)f=u[i],f.dataSource&&(s=f,this.initializeDataModule(s),e=!1);n&&(!this.visibleSeries.length||this.visibleSeriesCount===this.visibleSeries.length&&e)&&(this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}))},i.prototype.initializeDataModule=function(n){var t;n.xData=[];n.yData=[];t=this.isAngular?Object.keys(n.dataSource).length?n.dataSource:this.dataSource:n.dataSource||this.dataSource;n.dataModule=new ay(t,n.query);n.points=[];n.refreshDataManager(this)},i.prototype.calculateBounds=function(){var n=this.margin,f=0,e=0,o=0,r=n.left,s=this.availableSize.width-r-n.right-this.border.width,c,i,l;if(this.titleCollection=[],this.subTitleCollection=[],this.title&&(this.titleCollection=hr(this.title,this.titleStyle,s),f=sf.svgbase.measureText(this.title,this.titleStyle).height*this.titleCollection.length+15,this.subTitle)){for(var t=0,u=0,h=this.titleCollection;u<h.length;u++)c=h[u],t=(o=sf.svgbase.measureText(c,this.titleStyle).width)>t?o:t;this.subTitleCollection=hr(this.subTitle,this.subTitleStyle,t);e=sf.svgbase.measureText(this.subTitle,this.subTitleStyle).height*this.subTitleCollection.length+15}i=n.top+e+f+.5*this.chartArea.border.width;l=this.availableSize.height-i-this.border.width-n.bottom;this.stockChart&&this.stockChart.legendSettings.visible&&this.stockChart.stockLegendModule&&("Top"===this.stockChart.legendSettings.position?i+=this.stockChart.stockLegendModule.legendBounds.height:"Left"===this.stockChart.legendSettings.position&&(r+=this.stockChart.stockLegendModule.legendBounds.width));this.initialClipRect=new sf.svgbase.Rect(r,i,s,l);this.legendModule&&this.legendSettings.visible&&this.legendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,null);this.chartAxisLayoutPanel.measureAxis(this.initialClipRect)},i.prototype.print=function(n){new as(this).print(n)},i.prototype.initTrendLines=function(){var t,r,n;for(this.isProtectedOnChange=!0,t=0,r=this.visibleSeries;t<r.length;t++)for(var i=r[t],f=0,u=0,e=i.trendlines;u<e.length;u++)n=e[u],this.trendLineModule&&(n.index=f,n.sourceIndex=i.index,this.trendLineModule.initSeriesCollection(n,this),n.targetSeries&&(n.targetSeries.xAxisName=i.xAxisName,n.targetSeries.yAxisName=i.yAxisName,this.visibleSeries.push(n.targetSeries))),f++;this.isProtectedOnChange=!1},i.prototype.calculateAreaType=function(){var n=this.series[0];this.chartArea.border.width=this.stockChart?0:this.chartArea.border.width;n&&(this.requireInvertedAxis=-1!==n.type.indexOf("Bar")&&!this.isTransposed||-1===n.type.indexOf("Bar")&&this.isTransposed&&"PolarRadar"!==this.chartAreaType);this.chartAxisLayoutPanel="PolarRadar"===this.chartAreaType?this.polarSeriesModule||this.radarSeriesModule:new ly(this)},i.prototype.calculateVisibleAxis=function(){var t,n=[this.primaryXAxis,this.primaryYAxis],i,o,r,f,s,u,e,h;for(n="Cartesian"===this.chartAreaType?n.concat(this.axes):n,this.paretoSeriesModule&&"Pareto"===this.series[0].type&&(n=n.concat(this.paretoSeriesModule.paretoAxes)),this.axisCollections=[],this.zoomModule&&(this.zoomModule.isPanning=this.zoomModule.isAxisZoomed(n)&&this.zoomSettings.enablePan,this.svgObject.setAttribute("cursor",this.zoomModule.isPanning?"pointer":"auto"),this.scrollBarModule&&(this.scrollBarModule.axes=n)),this.scrollSettingEnabled&&this.scrollBarModule&&(this.scrollBarModule.axes=n),i=0,o=n.length;i<o;i++){for((t=n[i]).series=[],t.labels=[],r=0,f=this.visibleSeries;r<f.length;r++)s=f[r],this.initAxis(s,t,!0);for(u=0,e=this.indicators;u<e.length;u++)h=e[u],this.initAxis(h,t,!1);this.scrollBarModule&&!t.zoomingScrollBar&&this.scrollBarModule.injectTo(t,this);null!=t.orientation&&this.axisCollections.push(t)}this.rows.length>0&&this.columns.length>0&&this.chartAxisLayoutPanel.measure()},i.prototype.initAxis=function(n,t,i){n.xAxisName===t.name||null==n.xAxisName&&"primaryXAxis"===t.name?(t.orientation=this.requireInvertedAxis?"Vertical":"Horizontal",n.xAxis=t,i&&t.series.push(n)):(n.yAxisName===t.name||null==n.yAxisName&&"primaryYAxis"===t.name)&&(t.orientation=this.requireInvertedAxis?"Horizontal":"Vertical",n.yAxis=t,i&&t.series.push(n))},i.prototype.initTechnicalIndicators=function(){for(var t,u,s,f=0,i=0,e=this.indicators;i<e.length;i++){var r=e[i],n=r,o=tt(n.type);if(this[o+"IndicatorModule"])for(n.index=f,this[o+"IndicatorModule"].initSeriesCollection(n,this),t=0,u=n.targetSeries;t<u.length;t++)s=u[t],(r.seriesName||r.dataSource)&&this.visibleSeries.push(s);f++}},i.prototype.refreshTechnicalIndicator=function(n){var t,r,i;if(this.indicators.length)if(_instanceof(n,l)&&"Indicator"!==n.category)for(t=0,r=this.indicators;t<r.length;t++)i=r[t],i.seriesName!==n.name||i.dataSource||i.setDataSource(n,this);else _instanceof(n,ls)&&n.setDataSource(_instanceof(n,l)?n:null,this)},i.prototype.calculateVisibleSeries=function(){var n;this.visibleSeries=[];for(var r=this.palettes.length?this.palettes:function(n){var t;switch(n){case"Fabric":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"Bootstrap4":case"Bootstrap":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"HighContrastLight":case"Highcontrast":case"HighContrast":t=["#79ECE4","#E98272","#DFE6B6","#C6E773","#BA98FF","#FA83C3","#00C27A","#43ACEF","#D681EF","#D8BC6E"];break;case"MaterialDark":t=["#9ECB08","#56AEFF","#C57AFF","#61EAA9","#EBBB3E","#F45C5C","#8A77FF","#63C7FF","#FF84B0","#F7C928"];break;case"FabricDark":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"BootstrapDark":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"Tailwind":t=["#5A61F6","#65A30D","#334155","#14B8A6","#8B5CF6","#0369A1","#F97316","#9333EA","#F59E0B","#15803D"];break;case"TailwindDark":t=["#8B5CF6","#22D3EE","#F87171","#4ADE80","#E879F9","#FCD34D","#F97316","#2DD4BF","#F472B6","#10B981"];break;case"Bootstrap5":t=["#262E0B","#668E1F","#AF6E10","#862C0B","#1F2D50","#64680B","#311508","#4C4C81","#0C7DA0","#862C0B"];break;case"Bootstrap5Dark":t=["#5ECB9B","#A860F1","#EBA844","#557EF7","#E9599B","#BFC529","#3BC6CF","#7A68EC","#74B706","#EA6266"];break;default:t=["#00bdae","#404041","#357cd2","#e56590","#f8b883","#70ad47","#dd8abd","#7f84e8","#7bb4eb","#ea7a57"]}return t}(this.theme),u=r.length,t=this.series.sort(function(n,t){return n.zOrder-t.zOrder}),i=0,f=t.length;i<f;i++){switch((n=t[i]).category="Pareto"===t[0].type?"Pareto":"Series",n.index=i,n.interior=n.fill||r[i%u],n.type){case"Bar":case"StackingBar":case"StackingBar100":if(-1===t[0].type.indexOf("Bar"))continue;break;case"Polar":case"Radar":if("PolarRadar"!==this.chartAreaType)continue;if("PolarRadar"===this.chartAreaType&&(null===n.xAxisName&&null!==n.yAxisName||null!==n.xAxisName&&null===n.yAxisName||null!==n.xAxisName&&null!==n.yAxisName))continue;break;case"Pareto":this.visibleSeries.push(n);this.paretoSeriesModule.initSeries(n,this);continue;default:if("PolarRadar"===this.chartAreaType||t[0].type.indexOf("Bar")>-1)continue}this.visibleSeries.push(n);t[i]=n}},i.prototype.renderTitle=function(){var r,i=this.margin,n,t;if(this.title){var u=this.titleStyle.textAlignment,f="Near"===u?"start":"Far"===u?"end":"middle",e=sf.svgbase.measureText(this.title,this.titleStyle);r=new sf.svgbase.Rect(i.left,0,this.availableSize.width-i.left-i.right,0);n=new sf.svgbase.TextOption(this.element.id+"_ChartTitle",iu(r,this.titleStyle),this.margin.top+3*e.height/4,f,this.titleCollection,"","auto");t=yt(this.redraw,this.element.id+"_ChartTitle",n,this.renderer)||k(this.renderer,n,this.titleStyle,this.titleStyle.color||this.themeStyle.chartTitle,this.svgObject,null,null,null,null,null,null,0,null,this.enableCanvas);t&&(t.setAttribute("aria-label",this.description||this.title),t.setAttribute("tabindex",this.tabIndex.toString()));this.subTitle&&this.renderSubTitle(n)}},i.prototype.renderSubTitle=function(n){for(var o,t=0,u=0,f=this.titleStyle.textAlignment,i=0,e=this.titleCollection;i<e.length;i++)o=e[i],t=(u=sf.svgbase.measureText(o,this.titleStyle).width)>t?u:t;var h=sf.svgbase.measureText(this.subTitle,this.subTitleStyle),c=new sf.svgbase.Rect("Center"===f?n.x-.5*t:"Far"===f?n.x-t:n.x,0,t,0),s=new sf.svgbase.TextOption(this.element.id+"_ChartSubTitle",iu(c,this.subTitleStyle),n.y*n.text.length+3*h.height/4+10,function(n){return"Near"===n?"start":"Far"===n?"end":"middle"}(this.subTitleStyle.textAlignment),this.subTitleCollection,"","auto"),r=yt(this.redraw,this.element.id+"_ChartSubTitle",s,this.renderer)||k(this.renderer,s,this.subTitleStyle,this.subTitleStyle.color||this.themeStyle.chartTitle,this.svgObject,null,null,null,null,null,null,0,null,this.enableCanvas);r&&(r.setAttribute("aria-label",this.description||this.subTitle),r.setAttribute("tabindex",this.tabIndex.toString()))},i.prototype.renderBorder=function(){var i;if(!this.stockChart){var n=this.border.width,t=this.backgroundImage,u=t?"transparent":this.background||this.themeStyle.background,r=new y(this.element.id+"_ChartBorder",u,this.border,1,new sf.svgbase.Rect(.5*n,.5*n,this.availableSize.width-n,this.availableSize.height-n));(this.htmlObject=yt(this.redraw,this.element.id+"_ChartBorder",r,this.renderer)||this.renderer.drawRectangle(r),h(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw),t)&&(i=new vf(this.availableSize.height-n,this.availableSize.width-n,t,0,0,this.element.id+"_ChartBackground","visible","none"),this.htmlObject=yt(this.redraw,this.element.id+"_ChartBackground",i,this.renderer)||this.renderer.drawImage(i),h(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw))}},i.prototype.renderAreaBorder=function(){var t,i,u;if("PolarRadar"===this.chartAreaType)return null;var n=r(this.element.id+"_ChartAreaBorder"),f=n?new sf.svgbase.Rect(+n.getAttribute("x"),+n.getAttribute("y"),+n.getAttribute("width"),+n.getAttribute("height")):null,e=new y(this.element.id+"_ChartAreaBorder",this.chartArea.background,{width:this.chartArea.border.width,color:this.chartArea.border.color||this.themeStyle.areaBorder},this.chartArea.opacity,this.chartAxisLayoutPanel.seriesClipRect);this.htmlObject=this.renderer.drawRectangle(e);h(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw,!0,"x","y",null,null,!0,!0,f);this.htmlObject=null;t=this.chartArea.backgroundImage;t&&(i=this.chartArea.border.width,u=new vf(this.initialClipRect.height-i,this.initialClipRect.width-i,t,this.initialClipRect.x,this.initialClipRect.y,this.element.id+"_ChartAreaBackground","visible","none"),this.htmlObject=this.renderer.drawImage(u),h(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw,!0,"x","y",null,null,!0,!0))},i.prototype.addSeries=function(n){for(var i,t=0,r=n;t<r.length;t++)i=r[t],i=new l(this,"series",i),this.series.push(i);this.refresh()},i.prototype.removeSeries=function(n){this.redraw=!1;this.series.splice(n,1);this.refresh()},i.prototype.clearSeries=function(){this.series=[];this.refresh()},i.prototype.addAxes=function(n){for(var t,i=0,r=n;i<r.length;i++)t=r[i],t=new wi(this,"axes",t),this.isBlazor&&(t.interval=isNaN(t.interval)?null:t.interval,t.desiredIntervals=isNaN(t.desiredIntervals)?null:t.desiredIntervals),this.axes.push(t);this.refresh()},i.prototype.removeAxis=function(n){this.redraw=!1;this.axes.splice(n,1);this.refresh()},i.prototype.destroy=function(){this.scrollBarModule&&this.scrollBarModule.destroy();this.markerRender&&(this.markerRender.removeEventListener(),this.markerRender=null);this.horizontalAxes=[];this.verticalAxes=[];this.visibleSeries=[];this.axisCollections=[];this.rotatedDataLabelCollections=[];this.seriesElements=null;this.chartAxisLayoutPanel=null;this.dataLabelCollections=null;this.dataLabelElements=null;this.yAxisElements=null;this.element&&(this.unWireEvents(),this.isReact&&this.clearTemplate(),t.prototype.destroy.call(this),this.enableCanvas||(this.removeSvg(),this.svgObject=null))},i.prototype.getModuleName=function(){return"chart"},i.prototype.getPersistData=function(){return this.addOnPersist(["loaded","animationComplete","primaryXAxis","primaryYAxis"])},i.prototype.createChartSvg=function(){this.removeSvg();nl(this)},i.prototype.unWireEvents=function(){var n=sf.base.Browser.touchStartEvent,t=sf.base.Browser.touchMoveEvent,i=sf.base.Browser.touchEndEvent,r=sf.base.Browser.isPointer?"pointerleave":"mouseleave";
/*! UnBind the Event handler */
sf.base.EventHandler.remove(this.element,n,this.chartOnMouseDown);sf.base.EventHandler.remove(this.element,t,this.mouseMove);sf.base.EventHandler.remove(this.element,i,this.mouseEnd);sf.base.EventHandler.remove(this.element,"click",this.chartOnMouseClick);sf.base.EventHandler.remove(this.element,"contextmenu",this.chartRightClick);sf.base.EventHandler.remove(this.element,r,this.mouseLeave);window.removeEventListener(sf.base.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound);this.touchObject&&(this.touchObject.destroy(),this.touchObject=null)},i.prototype.wireEvents=function(){if(this.element){
/*! Find the Events type */
var n=sf.base.Browser.isPointer?"pointerleave":"mouseleave";
/*! Bind the Event handler */
sf.base.EventHandler.add(this.element,sf.base.Browser.touchStartEvent,this.chartOnMouseDown,this);sf.base.EventHandler.add(this.element,sf.base.Browser.touchMoveEvent,this.mouseMove,this);sf.base.EventHandler.add(this.element,sf.base.Browser.touchEndEvent,this.mouseEnd,this);sf.base.EventHandler.add(this.element,"click",this.chartOnMouseClick,this);sf.base.EventHandler.add(this.element,"contextmenu",this.chartRightClick,this);sf.base.EventHandler.add(this.element,n,this.mouseLeave,this);this.resizeBound=this.chartResize.bind(this);window.addEventListener(sf.base.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound);this.longPressBound=this.longPress.bind(this);this.touchObject=new sf.base.Touch(this.element,{tapHold:this.longPressBound,tapHoldThreshold:500});this.setStyle(this.element)}},i.prototype.chartRightClick=function(n){return!this.crosshair.enable||!this.crosshairModule||2!==n.buttons&&0!==n.which&&"touch"!==n.pointerType||(n.preventDefault(),n.stopPropagation(),!1)},i.prototype.setStyle=function(n){var t=this.zoomSettings,i=t.enableSelectionZooming||t.enablePinchZooming||"None"!==this.selectionMode||this.crosshair.enable||"None"!==this.highlightMode;n.style.touchAction=i?"none":"element";n.style.msTouchAction=i?"none":"element";n.style.msContentZooming="none";n.style.msUserSelect="none";n.style.webkitUserSelect="none";n.style.position="relative";n.style.display="block";n.style.overflow="hidden"},i.prototype.isOrientation=function(){return"orientation"in window&&"onorientationchange"in window},i.prototype.longPress=function(n){return this.mouseX=n&&n.originalEvent.changedTouches?n.originalEvent.changedTouches[0].clientX:0,this.mouseY=n&&n.originalEvent.changedTouches?n.originalEvent.changedTouches[0].clientY:0,this.startMove=!0,this.setMouseXY(this.mouseX,this.mouseY),this.notify("tapHold",n),!1},i.prototype.setMouseXY=function(n,t){if(r(this.svgId)){var u=r(this.svgId).getBoundingClientRect(),i=this.element.getBoundingClientRect();this.mouseY=t-i.top-Math.max(u.top-i.top,0);this.mouseX=n-i.left-Math.max(u.left-i.left,0)}},i.prototype.export=function(n,t){this.exportModule&&(this.exportModule.export(n,t),this.afterExport&&this.exportModule.getDataUrl(this))},i.prototype.chartResize=function(){var n=this,t,i;return this.animateSeries=!1,t={chart:this.isBlazor?{}:this,name:"resized",currentSize:new sf.svgbase.Size(0,0),previousSize:new sf.svgbase.Size(this.availableSize.width,this.availableSize.height)},i={name:"beforeResize",cancelResizedEvent:!1},this.resizeTo&&clearTimeout(this.resizeTo),this.trigger("beforeResize",i),i.cancelResizedEvent||(this.resizeTo=+setTimeout(function(){n.isDestroyed||n.stockChart?clearTimeout(n.resizeTo):(n.createChartSvg(),t.currentSize=n.availableSize,n.trigger("resized",t),n.refreshAxis(),n.refreshBound(),n.trigger("loaded",{chart:n.isBlazor?{}:n}))},500)),!1},i.prototype.mouseMove=function(n){var t,i,u;return"touchmove"===n.type?(this.isTouch=!0,t=(u=n).changedTouches[0].clientX,i=u.changedTouches[0].clientY):(this.isTouch="touch"===n.pointerType||"2"===n.pointerType||this.isTouch,t=n.clientX,i=n.clientY),r(this.svgId)&&(this.setMouseXY(t,i),this.chartOnMouseMove(n)),!1},i.prototype.mouseLeave=function(n){var t,i,r;return"touchleave"===n.type?(this.isTouch=!0,t=(r=n).changedTouches[0].clientX,i=r.changedTouches[0].clientY):(this.isTouch="touch"===n.pointerType||"2"===n.pointerType,t=n.clientX,i=n.clientY),this.setMouseXY(t,i),this.chartOnMouseLeave(n),!1},i.prototype.chartOnMouseLeave=function(n){var t=n.target,i=sf.base.Browser.isPointer?"pointerleave":"mouseleave";return this.trigger("chartMouseLeave",{target:t.id,x:this.mouseX,y:this.mouseY}),w(this.element.id+"_EJ2_AxisLabel_Tooltip"),this.isChartDrag=this.isPointMouseDown=!1,this.notify(i,n),!1},i.prototype.chartOnMouseClick=function(n){var i=this,r=n.target,t;return this.trigger("chartMouseClick",{target:r.id,x:this.mouseX,y:this.mouseY}),this.clickCount++,t=0,t=this.isAngular?this.pointDoubleClick.observers.length>0?400:0:this.pointDoubleClick?400:0,1===this.clickCount&&this.pointClick?this.singleClickTimer=+setTimeout(function(){i.clickCount=0;i.triggerPointEvent("pointClick",n)},t):2===this.clickCount&&this.pointDoubleClick&&(clearTimeout(this.singleClickTimer),this.clickCount=0,this.triggerPointEvent("pointDoubleClick",n)),this.axisLabelClick&&this.triggerAxisLabelClickEvent("axisLabelClick",n),this.notify("click",n),!1},i.prototype.triggerPointEvent=function(n,t){var r=t,i=new lr(this).getData();i.series&&i.point&&this.trigger(n,{series:this.isBlazor?{}:i.series,point:i.point,seriesIndex:i.series.index,pointIndex:i.point.index,x:this.mouseX,y:this.mouseY,pageX:r.pageX,pageY:r.pageY})},i.prototype.triggerAxisLabelClickEvent=function(n,t){var r=t.target,e=t;if(-1!==r.id.indexOf("_AxisLabel_")){var o=r.id.split("_AxisLabel_"),u=+o[0].slice(-1),f=+o[1],i=this.axisCollections[u];i.visible&&(0===u||1===u)&&this.trigger(n,{chart:this,axis:i,text:i.visibleLabels[f].text,labelID:r.id,index:f,location:new s(e.pageX,e.pageY),value:i.visibleLabels[f].value})}},i.prototype.chartOnMouseMove=function(n){var t=n.target;return this.trigger("chartMouseMove",{target:t.id,x:this.mouseX,y:this.mouseY}),this.pointMove&&this.triggerPointEvent("pointMove",n),this.isTouch||(this.titleTooltip(n,this.mouseX,this.mouseY),this.axisTooltip(n,this.mouseX,this.mouseY)),this.dataEditingModule&&this.dataEditingModule.pointMouseMove(n),this.notify(sf.base.Browser.touchMoveEvent,n),this.isTouch=!1,!1},i.prototype.titleTooltip=function(n,t,i,u){var f=n.target.id,o=f===this.element.id+"_ChartTitle"||f===this.element.id+"_ChartSubTitle"||f.indexOf("_AxisTitle")>-1||f.indexOf("_legend_title")>-1,e=0;(f.indexOf("_AxisTitle")>-1&&(e=parseInt(f.replace(this.element.id,"").replace("AxisLabel_","").split("_")[2],10)),o&&n.target.textContent.indexOf("...")>-1)?rr(f===this.element.id+"_ChartTitle"?this.title:f.indexOf("_AxisTitle")>-1?this.axisCollections[e].title:f.indexOf("_ChartSubTitle")>-1?this.subTitle:this.legendSettings.title,t,i,this.element.offsetWidth,this.element.id+"_EJ2_Title_Tooltip",r(this.element.id+"_Secondary_Element"),u):w(this.element.id+"_EJ2_Title_Tooltip")},i.prototype.axisTooltip=function(n,t,i,u){var f=n.target.id,e;(f.indexOf("AxisLabel")>-1||f.indexOf("Axis_MultiLevelLabel")>-1)&&n.target.textContent.indexOf("...")>-1?(e=this.legendSettings.visible||""===this.primaryXAxis.title,rr(this.findAxisLabel(f),t,i,this.element.offsetWidth,this.element.id+"_EJ2_AxisLabel_Tooltip",r(this.element.id+"_Secondary_Element"),u,e)):w(this.element.id+"_EJ2_AxisLabel_Tooltip")},i.prototype.findAxisLabel=function(n){var t;return n.indexOf("AxisLabel")>-1?(t=n.replace(this.element.id,"").replace("AxisLabel_","").split("_"),this.axisCollections[parseInt(t[0],10)].visibleLabels[parseInt(t[1],10)].originalText):(t=n.replace(this.element.id,"").replace("Axis_MultiLevelLabel_Level_","").replace("Text_","").split("_"),this.axisCollections[parseInt(t[0],10)].multiLevelLabels[parseInt(t[1],10)].categories[parseInt(t[2],10)].text)},i.prototype.chartOnMouseDown=function(n){var u,f,e,o,t=sf.base.Browser.isDevice?20:30,i=this.element.getBoundingClientRect(),h=n.target,s;return this.trigger("chartMouseDown",{target:h.id,x:this.mouseX,y:this.mouseY}),"touchstart"===n.type?(this.isTouch=!0,u=(o=n).changedTouches[0].clientX,f=o.changedTouches[0].clientY,e=o.target):(this.isTouch="touch"===n.pointerType,u=n.clientX,f=n.clientY,e=n.target),s=r(this.svgId).getBoundingClientRect(),this.mouseDownX=this.previousMouseMoveX=u-i.left-Math.max(s.left-i.left,0),this.mouseDownY=this.previousMouseMoveY=f-i.top-Math.max(s.top-i.top,0),this.isTouch&&(this.isDoubleTap=(new Date).getTime()<this.threshold&&-1===e.id.indexOf(this.element.id+"_Zooming_")&&(this.mouseDownX-t>=this.mouseX||this.mouseDownX+t>=this.mouseX)&&(this.mouseDownY-t>=this.mouseY||this.mouseDownY+t>=this.mouseY)&&(this.mouseX-t>=this.mouseDownX||this.mouseX+t>=this.mouseDownX)&&(this.mouseY-t>=this.mouseDownY||this.mouseY+t>=this.mouseDownY)),this.dataEditingModule&&this.dataEditingModule.pointMouseDown(),this.notify(sf.base.Browser.touchStartEvent,n),!1},i.prototype.mouseEnd=function(n){var t,i,r;return"touchend"===n.type?(i=(r=n).changedTouches[0].clientX,this.isTouch=!0,t=r.changedTouches[0].clientY):(t=n.clientY,i=n.clientX,this.isTouch="touch"===n.pointerType||"2"===n.pointerType),this.setMouseXY(i,t),this.chartOnMouseUp(n),!1},i.prototype.chartOnMouseUp=function(n){var t=n.target;return this.trigger("chartMouseUp",{target:t.id,x:this.mouseX,y:this.mouseY}),this.isChartDrag=!1,this.isTouch&&(this.titleTooltip(n,this.mouseX,this.mouseY,this.isTouch),this.axisTooltip(n,this.mouseX,this.mouseY,this.isTouch),this.threshold=(new Date).getTime()+300),this.dataEditingModule&&this.dataEditingModule.pointMouseUp(),!this.enableCanvas&&this.seriesElements&&this.seriesElements.removeAttribute("clip-path"),this.notify(sf.base.Browser.touchEndEvent,n),!1},i.prototype.setCulture=function(){this.intl=new sf.base.Internationalization;this.setLocaleConstants();this.localeObject=new sf.base.L10n(this.getModuleName(),this.defaultLocalConstants,this.locale)},i.prototype.setAnnotationValue=function(n,t){var i,u=r(this.element.id+"_Annotation_Collections"),f=this.annotations[n];null!==t&&(f.content=t,u?(w(this.element.id+"_Annotation_"+n),i=this.createElement("div"),this.annotationModule.processAnnotation(f,n,i),u.appendChild(i.children[0])):this.annotationModule.renderAnnotations(r(this.element.id+"_Secondary_Element")))},i.prototype.setLocaleConstants=function(){this.defaultLocalConstants={ZoomIn:"Zoom in",Zoom:"Zoom",ZoomOut:"Zoom out",Pan:"Pan",Reset:"Reset",ResetZoom:"Reset Zoom"}},i.prototype.setTheme=function(){
/*! Set theme */
this.themeStyle=function(n){var t,i="MaterialDark"===n?"#383838":"FabricDark"===n?"#242424":"#1b1b1b";switch(n){case"HighContrastLight":case"Highcontrast":case"HighContrast":t={axisLabel:"#ffffff",axisTitle:"#ffffff",axisLine:"#ffffff",majorGridLine:"#BFBFBF",minorGridLine:"#969696",majorTickLine:"#BFBFBF",minorTickLine:"#969696",chartTitle:"#ffffff",legendLabel:"#ffffff",background:"#000000",areaBorder:"#ffffff",errorBar:"#ffffff",crosshairLine:"#ffffff",crosshairFill:"#ffffff",crosshairLabel:"#000000",tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696",markerShadow:"#BFBFBF",selectionRectFill:"rgba(255, 217, 57, 0.3)",selectionRectStroke:"#ffffff",selectionCircleStroke:"#FFD939"};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":t={axisLabel:"#DADADA",axisTitle:"#ffffff",axisLine:" #6F6C6C",majorGridLine:"#414040",minorGridLine:"#514F4F",majorTickLine:"#414040",minorTickLine:" #4A4848",chartTitle:"#ffffff",legendLabel:"#DADADA",background:i,areaBorder:" #9A9A9A",errorBar:"#ffffff",crosshairLine:"#F4F4F4",crosshairFill:"#F4F4F4",crosshairLabel:"#282727",tooltipFill:"#F4F4F4",tooltipBoldLabel:"#282727",tooltipLightLabel:"#333232",tooltipHeaderLine:"#9A9A9A",markerShadow:null,selectionRectFill:"rgba(56,169,255, 0.1)",selectionRectStroke:"#38A9FF",selectionCircleStroke:"#282727"};break;case"Bootstrap4":t={axisLabel:"#212529",axisTitle:"#212529",axisLine:"#CED4DA",majorGridLine:"#CED4DA",minorGridLine:"#DEE2E6",majorTickLine:"#ADB5BD",minorTickLine:"#CED4DA",chartTitle:"#212529",legendLabel:"#212529",background:"#FFFFFF",areaBorder:"#DEE2E6",errorBar:"#000000",crosshairLine:"#6C757D",crosshairFill:"#495057",crosshairLabel:"#FFFFFF",tooltipFill:"rgba(0, 0, 0, 0.9)",tooltipBoldLabel:"rgba(255,255,255)",tooltipLightLabel:"rgba(255,255,255, 0.9)",tooltipHeaderLine:"rgba(255,255,255, 0.2)",markerShadow:null,selectionRectFill:"rgba(255,255,255, 0.1)",selectionRectStroke:"rgba(0, 123, 255)",selectionCircleStroke:"#495057"};break;case"Tailwind":t={axisLabel:"#6B728",axisTitle:"#374151",axisLine:" #D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#374151",legendLabel:"#374151",background:"rgba(255,255,255, 0.0)",areaBorder:" #E5E7EB",errorBar:"#374151",crosshairLine:"#1F2937",crosshairFill:"#111827",crosshairLabel:"#F9FAFB",tooltipFill:"#111827",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;case"TailwindDark":t={axisLabel:"#9CA3AF",axisTitle:"#9CA3AF",axisLine:" #4B5563",majorGridLine:"#374151",minorGridLine:"#374151",majorTickLine:"#4B5563",minorTickLine:" #4B5563",chartTitle:"#D1D5DB",legendLabel:"#D1D5DB",background:"#1f2937",areaBorder:" #374151",errorBar:"#ffffff",crosshairLine:"#9CA3AF",crosshairFill:"#F9FAFB",crosshairLabel:"#1F2937",tooltipFill:"#F9FAFB",tooltipBoldLabel:"#6B7280",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF",markerShadow:null,selectionRectFill:"rgba(34,211,238, 0.1)",selectionRectStroke:"#22D3EE",selectionCircleStroke:"#282727"};break;case"Bootstrap5":t={axisLabel:"#495057",axisTitle:"#343A40",axisLine:"#D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#343A40",legendLabel:"#343A40",background:"#FFFFFF",areaBorder:" #DEE2E6",errorBar:"#1F2937",crosshairLine:"#1F2937",crosshairFill:"#212529",crosshairLabel:"#F9FAFB",tooltipFill:"#212529",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;case"Bootstrap5Dark":t={axisLabel:"#CED4DA",axisTitle:"#E9ECEF",axisLine:"#495057",majorGridLine:"#343A40",minorGridLine:"#343A40",majorTickLine:"#495057",minorTickLine:" #495057",chartTitle:"#E9ECEF",legendLabel:"#E9ECEF",background:"#212529",areaBorder:" #444C54",errorBar:"#ADB5BD",crosshairLine:"#ADB5BD",crosshairFill:"#E9ECEF",crosshairLabel:"#212529",tooltipFill:"#E9ECEF",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;default:t={axisLabel:"#686868",axisTitle:"#424242",axisLine:"#b5b5b5",majorGridLine:"#dbdbdb",minorGridLine:"#eaeaea",majorTickLine:"#b5b5b5",minorTickLine:"#d6d6d6",chartTitle:"#424242",legendLabel:"#353535",background:"#FFFFFF",areaBorder:"Gray",errorBar:"#000000",crosshairLine:"#4f4f4f",crosshairFill:"#4f4f4f",crosshairLabel:"#e5e5e5",tooltipFill:"rgba(0, 8, 22, 0.75)",tooltipBoldLabel:"#ffffff",tooltipLightLabel:"#dbdbdb",tooltipHeaderLine:"#ffffff",markerShadow:null,selectionRectFill:"rgba(41, 171, 226, 0.1)",selectionRectStroke:"#29abe2",selectionCircleStroke:"#29abe2"}}return t}(this.theme)},i.prototype.requiredModules=function(){var s,u,i=this,n=[],t=this.series,f=!1,e=!1,o=!1,r=this.zoomSettings;return this.chartAreaType=t.length>0&&("Polar"===t[0].type||"Radar"===t[0].type)?"PolarRadar":"Cartesian",this.tooltip.enable&&n.push({member:"Tooltip",args:[this]}),t.map(function(r){i.isLegend=i.legendSettings.visible&&(""!==r.name||!!i.isLegend);u=-1!==r.type.indexOf("100")?r.type.replace("100","")+"Series":r.type+"Series";f=r.errorBar.visible||f;o=r.marker.dataLabel.visible||o;e=r.dragSettings.enable||e;n.some(function(n){return n.member===u})||n.push({member:u,args:[i,t]});"PolarRadar"===i.chartAreaType&&n.push({member:r.drawType+"Series",args:[i,t]});"Pareto"===r.type&&(n.push({member:"ColumnSeries",args:[i,t]}),n.push({member:"LineSeries",args:[i,t]}))}),this.findIndicatorModules(n),this.findTrendLineModules(n),n=this.findAxisModule(n),s=this.annotations.some(function(n){return null!==n.content}),f&&n.push({member:"ErrorBar",args:[this,t]}),this.isLegend&&n.push({member:"Legend",args:[this]}),(this.enableExport||this.allowExport)&&n.push({member:"Export",args:[this]}),"PolarRadar"!==this.chartAreaType&&!this.scrollSettingEnabled&&(r.enableSelectionZooming||r.enableMouseWheelZooming||r.enablePinchZooming||r.enablePan||r.enableScrollbar)&&(n.push({member:"Zoom",args:[this,this.zoomSettings]}),r.enableScrollbar&&n.push({member:"ScrollBar",args:[this]})),"None"===this.selectionMode||"PolarRadar"===this.chartAreaType&&this.selectionMode.indexOf("Drag")>-1||n.push({member:"Selection",args:[this]}),"None"!==this.highlightMode&&n.push({member:"Highlight",args:[this]}),o&&n.push({member:"DataLabel",args:[this,t]}),e&&n.push({member:"DataEditing",args:[this]}),s&&n.push({member:"Annotation",args:[this]}),"PolarRadar"!==this.chartAreaType&&this.crosshair.enable&&n.push({member:"Crosshair",args:[this]}),n},i.prototype.findAxisModule=function(n){var i=[],t;i.push(this.primaryXAxis);i.push(this.primaryYAxis);for(var r=!1,u=!1,f=!1,e=!1,o=!1,s=!1,h=0,c=i=i.concat(this.axes);h<c.length;h++)t=c[h],r="DateTime"===t.valueType||r,u="Category"===t.valueType||u,f="Logarithmic"===t.valueType||f,o="DateTimeCategory"===t.valueType||o,e=this.findStriplineVisibility(t.stripLines)||e,s=t.multiLevelLabels.length>0||s,this.scrollSettingEnabled=!!t.scrollbarSettings.enable||this.scrollSettingEnabled;return r&&n.push({member:"DateTime",args:[this]}),u&&n.push({member:"Category",args:[this]}),f&&n.push({member:"Logarithmic",args:[this]}),e&&n.push({member:"StripLine",args:[this]}),s&&n.push({member:"MultiLevelLabel",args:[this]}),o&&n.push({member:"DateTimeCategory",args:[this]}),this.scrollSettingEnabled&&n.push({member:"ScrollBar",args:[this]}),n},i.prototype.findIndicatorModules=function(n){var r,t,e=this.indicators,i,u,f;if(this.indicators.length)for(n.push({member:"LineSeries",args:[this]}),e.map(function(n){r=r||"Macd"===n.type;t=t||"BollingerBands"===n.type}),r&&n.push({member:"ColumnSeries",args:[this]}),t&&n.push({member:"RangeAreaSeries",args:[this]}),t&&n.push({member:"SplineRangeAreaSeries",args:[this]}),i=0,u=this.indicators;i<u.length;i++)f=u[i],n.push({member:f.type+"Indicator",args:[this]})},i.prototype.findTrendLineModules=function(n){for(var t,i,f=function(r){var u;r.trendlines.map(function(n){u=u||n.marker.visible;t=!(!t&&"Linear"!==n.type&&"MovingAverage"!==n.type);i=!(!i&&t)});u&&n.push({member:"Marker",args:[e,r]})},e=this,r=0,u=this.series;r<u.length;r++)f(u[r]);(t||i)&&n.push({member:"TrendLine",args:[this]});t&&n.push({member:"LineSeries",args:[this]});i&&n.push({member:"SplineSeries",args:[this]})},i.prototype.findStriplineVisibility=function(n){for(var i=!1,t=0,r=n;t<r.length;t++)if(r[t].visible){i=!0;break}return i},i.prototype.removeSvg=function(){var t,i,n,r;if(this.redraw)return null;if(af(this),this.enableCanvas&&this.svgObject&&"CANVAS"===this.svgObject.tagName)return this.renderer.clearRect(new sf.svgbase.Rect(0,0,this.availableSize.width,this.availableSize.height)),this.svgObject.parentNode&&sf.base.remove(this.svgObject),null;if(w(this.element.id+"_Secondary_Element"),this.isReact&&this.clearTemplate(),t=0,this.zoomModule&&this.zoomModule.pinchTarget&&(this.zoomModule.pinchTarget.id="",this.zoomModule.pinchTarget.setAttribute("opacity","0"),this.svgObject.appendChild(this.zoomModule.pinchTarget),t=1),!sf.base.isNullOrUndefined(this.resizeTo)){if(this.resizeTo!==this.checkResize&&this.isBlazor&&this.element.childElementCount)for(i=document.querySelectorAll(".e-chart"),n=0;n<i.length;n++)for(r=i[n];r.firstChild;)sf.base.remove(r.firstChild);this.checkResize=this.resizeTo}if(this.svgObject){for(;this.svgObject.childNodes.length>t;)this.svgObject.removeChild(this.svgObject.firstChild);this.svgObject.hasChildNodes()||!this.svgObject.parentNode||this.stockChart||sf.base.remove(this.svgObject)}},i.prototype.refreshDefinition=function(n){for(var t=0,i=n;t<i.length;t++)i[t].axes=[]},i.prototype.refreshAxis=function(){var n=this.primaryXAxis,t,r,i,u;for(n.rect=new sf.svgbase.Rect(void 0,void 0,0,0),(n=this.primaryYAxis).isStack100=!1,n.rect=new sf.svgbase.Rect(void 0,void 0,0,0),t=0,r=this.axes;t<r.length;t++)(n=r[t]).rect=new sf.svgbase.Rect(void 0,void 0,0,0),n.isStack100=!1;if(this.paretoSeriesModule&&"Pareto"===this.series[0].type)for(i=0,u=this.paretoSeriesModule.paretoAxes;i<u.length;i++)(n=u[i]).rect=new sf.svgbase.Rect(void 0,void 0,0,0),n.isStack100=!1},i.prototype.axisChange=function(n){return!(!n.name&&!n.valueType)&&(this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(),!0)},i.prototype.getVisibleSeries=function(n,t){for(var u,i=0,r=n;i<r.length;i++)if(u=r[i],t===u.index)return u;return null},i.prototype.refreshLiveData=function(){this.calculateVisibleSeries();this.initTechnicalIndicators();this.initTrendLines();this.refreshDefinition(this.columns);this.refreshDefinition(this.rows);this.calculateVisibleAxis();this.processData(!1);this.isBlazor||(this.enableCanvas?this.createChartSvg():this.removeSvg(),this.refreshAxis(),this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}))},i.prototype.removeStyles=function(){w(this.element.id+"_ej2_chart_selection");w(this.element.id+"_ej2_chart_highlight")},i.prototype.onPropertyChanged=function(n,t){var u=!1,r=!1,e,s,o,h,c;if(this.animateSeries=!1,!this.delayRedraw){for(e=0,s=Object.keys(n);e<s.length;e++)switch(s[e]){case"primaryXAxis":r=this.axisChange(n.primaryXAxis);n.primaryXAxis.edgeLabelPlacement&&(u=!0);n.primaryXAxis.crosshairTooltip||(r=!0);break;case"primaryYAxis":r=this.axisChange(n.primaryYAxis);n.primaryYAxis.edgeLabelPlacement&&(u=!0);n.primaryYAxis.crosshairTooltip||(r=!0);break;case"axes":for(o=0,h=Object.keys(n.axes);o<h.length;o++)c=h[o],r=r||this.axisChange(n.axes[c]),n.axes[c].crosshairTooltip||(r=!0);break;case"height":case"width":this.createChartSvg();r=!0;break;case"subTitle":case"title":r=!0;break;case"titleStyle":n.titleStyle&&(n.titleStyle.size||n.titleStyle.textOverflow)?r=!0:u=!0;break;case"subTitleStyle":n.subTitleStyle&&(n.subTitleStyle.size||n.subTitleStyle.textOverflow)?r=!0:u=!0;break;case"border":u=!0;break;case"dataSource":this.processData(!1);r=!0;break;case"enableCanvas":this.refresh();break;case"series":for(var v=this.series.length,l=!1,i=void 0,a=void 0,f=0;f<v;f++)i=n.series[f],this.isBlazor&&i&&(i.visible!==t.series[f].visible||i.isClosed||i.marker||i.emptyPointSettings||i.type||i.boxPlotMode||i.showMean)&&(a=!0),i&&(i.dataSource||i.query||i.errorBar||i.xName||i.yName||i.size||i.high||i.low||i.open||i.close||i.fill||i.name||i.marker||a)&&(sf.base.extend(this.getVisibleSeries(this.visibleSeries,f),i,null,!0),l=!0);l&&(this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(!1),r=!0);break;case"indicators":r=!0;break;case"zoomSettings":(n.zoomSettings.enableScrollbar||t.zoomSettings.enableScrollbar)&&(r=!0);u=!0;break;case"background":u=!0;break;case"chartArea":n.chartArea.border&&n.chartArea.border.width&&(r=!0);u=!0;break;case"legendSettings":n.legendSettings.background&&n.legendSettings.opacity||(r=!0);u=!0;break;case"palettes":this.calculateVisibleSeries();u=!0;break;case"selectedDataIndexes":this.selectionModule&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.selectedDataIndexes=this.selectedDataIndexes,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,t.selectionMode,!0));break;case"selectionMode":this.selectionModule&&n.selectionMode&&-1===n.selectionMode.indexOf("Drag")&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,t.selectionMode,!0));break;case"isMultiSelect":this.selectionModule&&!n.isMultiSelect&&this.selectionModule.selectedDataIndexes.length>1&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,t.selectionMode));break;case"highlightMode":case"selectionPattern":case"highlightPattern":this.removeStyles();u=!0;break;case"theme":this.animateSeries=!0;break;case"locale":case"currencyCode":this.isBlazor?(this.setCulture(),u=!0):this.refresh();break;case"tooltip":this.tooltipModule&&(this.tooltipModule.previousPoints=[])}!r&&u&&(this.rotatedDataLabelCollections=[],this.removeSvg(),this.renderElements(),this.trigger("loaded",{chart:this.isBlazor?{}:this}));r&&(this.enableCanvas?this.createChartSvg():this.removeSvg(),this.isReact&&this.clearTemplate(),this.refreshAxis(),this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}),this.redraw=!1,this.animated=!1)}},u([sf.base.Property(null)],i.prototype,"width",void 0),u([sf.base.Property(null)],i.prototype,"height",void 0),u([sf.base.Property("")],i.prototype,"title",void 0),u([sf.base.Property("")],i.prototype,"dataSource",void 0),u([sf.base.Complex(ct.chartTitleFont,lt)],i.prototype,"titleStyle",void 0),u([sf.base.Property("")],i.prototype,"subTitle",void 0),u([sf.base.Complex(ct.chartSubTitleFont,lt)],i.prototype,"subTitleStyle",void 0),u([sf.base.Complex({},vr)],i.prototype,"margin",void 0),u([sf.base.Complex({color:"#DDDDDD",width:0},ot)],i.prototype,"border",void 0),u([sf.base.Property(null)],i.prototype,"background",void 0),u([sf.base.Complex({border:{color:null,width:.5},background:"transparent"},nh)],i.prototype,"chartArea",void 0),u([sf.base.Complex({name:"primaryXAxis"},wi)],i.prototype,"primaryXAxis",void 0),u([sf.base.Complex({name:"primaryYAxis"},wi)],i.prototype,"primaryYAxis",void 0),u([sf.base.Collection([{}],ph)],i.prototype,"rows",void 0),u([sf.base.Collection([{}],wh)],i.prototype,"columns",void 0),u([sf.base.Collection([{}],wi)],i.prototype,"axes",void 0),u([sf.base.Collection([{}],l)],i.prototype,"series",void 0),u([sf.base.Collection([{}],hh)],i.prototype,"annotations",void 0),u([sf.base.Property([])],i.prototype,"palettes",void 0),u([sf.base.Property("Material")],i.prototype,"theme",void 0),u([sf.base.Complex({},eh)],i.prototype,"tooltip",void 0),u([sf.base.Complex({},vl)],i.prototype,"crosshair",void 0),u([sf.base.Complex({},ky)],i.prototype,"legendSettings",void 0),u([sf.base.Collection([{}],al)],i.prototype,"rangeColorSettings",void 0),u([sf.base.Complex({},yl)],i.prototype,"zoomSettings",void 0),u([sf.base.Property("None")],i.prototype,"selectionMode",void 0),u([sf.base.Property("None")],i.prototype,"highlightMode",void 0),u([sf.base.Property("None")],i.prototype,"selectionPattern",void 0),u([sf.base.Property("None")],i.prototype,"highlightPattern",void 0),u([sf.base.Property(!1)],i.prototype,"isMultiSelect",void 0),u([sf.base.Property(!1)],i.prototype,"allowMultiSelection",void 0),u([sf.base.Property(!0)],i.prototype,"enableExport",void 0),u([sf.base.Property(!1)],i.prototype,"allowExport",void 0),u([sf.base.Collection([],ih)],i.prototype,"selectedDataIndexes",void 0),u([sf.base.Property(!1)],i.prototype,"useGroupingSeparator",void 0),u([sf.base.Property(!1)],i.prototype,"enableAutoIntervalOnBothAxis",void 0),u([sf.base.Property(!1)],i.prototype,"isTransposed",void 0),u([sf.base.Property(!1)],i.prototype,"enableCanvas",void 0),u([sf.base.Property(null)],i.prototype,"backgroundImage",void 0),u([sf.base.Collection([],ls)],i.prototype,"indicators",void 0),u([sf.base.Property(!0)],i.prototype,"enableAnimation",void 0),u([sf.base.Property(null)],i.prototype,"description",void 0),u([sf.base.Property(1)],i.prototype,"tabIndex",void 0),u([sf.base.Property(!0)],i.prototype,"enableSideBySidePlacement",void 0),u([sf.base.Event()],i.prototype,"resized",void 0),u([sf.base.Event()],i.prototype,"beforeResize",void 0),u([sf.base.Event()],i.prototype,"annotationRender",void 0),u([sf.base.Event()],i.prototype,"beforePrint",void 0),u([sf.base.Event()],i.prototype,"loaded",void 0),u([sf.base.Event()],i.prototype,"beforeExport",void 0),u([sf.base.Event()],i.prototype,"afterExport",void 0),u([sf.base.Event()],i.prototype,"load",void 0),u([sf.base.Event()],i.prototype,"animationComplete",void 0),u([sf.base.Event()],i.prototype,"legendRender",void 0),u([sf.base.Event()],i.prototype,"textRender",void 0),u([sf.base.Event()],i.prototype,"pointRender",void 0),u([sf.base.Event()],i.prototype,"seriesRender",void 0),u([sf.base.Event()],i.prototype,"axisLabelRender",void 0),u([sf.base.Event()],i.prototype,"axisLabelClick",void 0),u([sf.base.Event()],i.prototype,"axisRangeCalculated",void 0),u([sf.base.Event()],i.prototype,"axisMultiLabelRender",void 0),u([sf.base.Event()],i.prototype,"legendClick",void 0),u([sf.base.Event()],i.prototype,"multiLevelLabelClick",void 0),u([sf.base.Event()],i.prototype,"tooltipRender",void 0),u([sf.base.Event()],i.prototype,"sharedTooltipRender",void 0),u([sf.base.Event()],i.prototype,"chartMouseMove",void 0),u([sf.base.Event()],i.prototype,"chartMouseClick",void 0),u([sf.base.Event()],i.prototype,"pointClick",void 0),u([sf.base.Event()],i.prototype,"pointDoubleClick",void 0),u([sf.base.Event()],i.prototype,"pointMove",void 0),u([sf.base.Event()],i.prototype,"chartMouseLeave",void 0),u([sf.base.Event()],i.prototype,"chartMouseDown",void 0),u([sf.base.Event()],i.prototype,"chartMouseUp",void 0),u([sf.base.Event()],i.prototype,"dragComplete",void 0),u([sf.base.Event()],i.prototype,"selectionComplete",void 0),u([sf.base.Event()],i.prototype,"zoomComplete",void 0),u([sf.base.Event()],i.prototype,"onZooming",void 0),u([sf.base.Event()],i.prototype,"scrollStart",void 0),u([sf.base.Event()],i.prototype,"scrollEnd",void 0),u([sf.base.Event()],i.prototype,"scrollChanged",void 0),u([sf.base.Event()],i.prototype,"dragStart",void 0),u([sf.base.Event()],i.prototype,"drag",void 0),u([sf.base.Event()],i.prototype,"dragEnd",void 0),u([sf.base.Property("USD")],i.prototype,"currencyCode",void 0),i=u([sf.base.NotifyPropertyChanges],i)}(sf.base.Component),np=(gf=function(n,t){return(gf=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}gf(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),vs=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return np(t,n),t.prototype.calculateDateTimeNiceInterval=function(n,t,i,r,u){void 0===u&&(u=!0);var f,o=new Date(i),s=new Date(r),e=Math.abs((o.getTime()-s.getTime())/864e5);switch(n.actualIntervalType=n.intervalType,n.intervalType){case"Years":f=this.calculateNumericNiceInterval(n,e/365,t);break;case"Quarter":f=this.calculateNumericNiceInterval(n,e/365*4,t);break;case"Months":f=this.calculateNumericNiceInterval(n,e/30,t);break;case"Weeks":f=this.calculateNumericNiceInterval(n,e/7,t);break;case"Days":f=this.calculateNumericNiceInterval(n,e,t);break;case"Hours":f=this.calculateNumericNiceInterval(n,24*e,t);break;case"Minutes":f=this.calculateNumericNiceInterval(n,1440*e,t);break;case"Seconds":f=this.calculateNumericNiceInterval(n,86400*e,t);break;case"Auto":return(f=this.calculateNumericNiceInterval(n,e/365,t))>=1?(n.actualIntervalType="Years",f):(f=this.calculateNumericNiceInterval(n,e/365*4,t))>=1&&!u?(n.actualIntervalType="Quarter",f):(f=this.calculateNumericNiceInterval(n,e/30,t))>=1?(n.actualIntervalType="Months",f):(f=this.calculateNumericNiceInterval(n,e/7,t))>=1&&!u?(n.actualIntervalType="Weeks",f):(f=this.calculateNumericNiceInterval(n,e,t))>=1?(n.actualIntervalType="Days",f):(f=this.calculateNumericNiceInterval(n,24*e,t))>=1?(n.actualIntervalType="Hours",f):(f=this.calculateNumericNiceInterval(n,1440*e,t))>=1?(n.actualIntervalType="Minutes",f):(f=this.calculateNumericNiceInterval(n,86400*e,t),n.actualIntervalType="Seconds",f)}return f},t.prototype.getSkeleton=function(n,t,i,r){var f,u=n.actualIntervalType;return n.skeleton?n.skeleton:("Years"===u?f=r?n.isChart?(n.valueType,"y"):"y":n.isChart?"DateTime"===n.valueType&&n.isIntervalInDecimal?"y":"yMMM":"y":"Quarter"===u?f=r?"y":"yMMM":"Months"===u?r?(n.isChart,f="m"):f=n.isChart?"MMMd":"MMM":f="Weeks"===u?r?"m":"MEd":"Days"===u?r?"d":n.isChart?this.getDayFormat(n,t,i):"MMMd":"Hours"===u?r?"t":n.isChart?"DateTime"===n.valueType?"Hm":"EHm":"h":"Minutes"===u?r?"T":n.isChart?"Hms":"hm":r?"T":n.isChart?"Hms":"hms",f)},t.prototype.getMonthFormat=function(n,t,i){return new Date(t).getFullYear()===new Date(i).getFullYear()?n.isIntervalInDecimal?"MMM":"MMM d":"y MMM"},t.prototype.getDayFormat=function(n,t,i){return"DateTime"===n.valueType?new Date(t).getMonth()!==new Date(i).getMonth()?"MMMd":n.isIntervalInDecimal?"d":"Ehm":"yMd"},t.prototype.findCustomFormats=function(n,t,i){var r=n.labelFormat?n.labelFormat:"";return!n.isChart||n.skeleton||"Months"!==n.actualIntervalType||r||(r="DateTime"===n.valueType?this.getMonthFormat(n,t,i):"yMMM"),r},t}(yr),tp=(ne=function(n,t){return(ne=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ne(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),wl=function(n){function t(t){return n.call(this,t)||this}return tp(t,n),t.prototype.calculateRangeAndInterval=function(n,t){this.calculateRange(t);this.getActualRange(t,n);this.applyRangePadding(t,n);this.calculateVisibleLabels(t,this.chart)},t.prototype.getActualRange=function(n,t){var u={skeleton:"full",type:"dateTime"},i=this.chart.intl.getDateParser(u),r=this.chart.intl.getDateFormat(u),f;null!==n.minimum?this.min=this.chart.isBlazor?Date.parse(n.minimum.toString()):Date.parse(i(r(new Date(sf.data.DataUtil.parse.parseJson({val:n.minimum}).val)))):null!==this.min&&this.min!==Number.POSITIVE_INFINITY||(this.min=Date.parse(i(r(new Date(1970,1,1)))));null!==n.maximum?this.max=this.chart.isBlazor?Date.parse(n.maximum.toString()):Date.parse(i(r(new Date(sf.data.DataUtil.parse.parseJson({val:n.maximum}).val)))):null!==this.max&&this.max!==Number.NEGATIVE_INFINITY||(this.max=Date.parse(i(r(new Date(1970,5,1)))));this.min===this.max&&(this.max=this.max+2592e6,this.min=this.min-2592e6);n.actualRange={};n.doubleRange=new bt(this.min,this.max);f=this.calculateDateTimeNiceInterval(n,t,n.doubleRange.start,n.doubleRange.end);n.actualRange.interval=n.interval?n.interval:f;n.actualRange.min=n.doubleRange.start;n.actualRange.max=n.doubleRange.end},t.prototype.applyRangePadding=function(n,t){var i,r,u,f,c,e,s,o,h;if(this.min=n.actualRange.min,this.max=n.actualRange.max,u=n.actualRange.interval,!ki(n))if(f=n.getRangePadding(this.chart),i=new Date(this.min),r=new Date(this.max),c=n.actualIntervalType,"None"===f)this.min=i.getTime(),this.max=r.getTime();else if("Additional"===f||"Round"===f)switch(c){case"Years":this.getYear(i,r,f,u);break;case"Months":this.getMonth(i,r,f,u);break;case"Days":this.getDay(i,r,f,u);break;case"Hours":this.getHour(i,r,f,u);break;case"Minutes":e=i.getMinutes()/u*u;s=r.getMinutes()+(i.getMinutes()-e);"Round"===f?(this.min=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),e,0).getTime(),this.max=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),s,59).getTime()):(this.min=new Date(i.getFullYear(),r.getMonth(),i.getDate(),i.getHours(),e+-u,0).getTime(),this.max=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),s+u,0).getTime());break;case"Seconds":o=i.getSeconds()/u*u;h=r.getSeconds()+(i.getSeconds()-o);"Round"===f?(this.min=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),o,0).getTime(),this.max=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),h,0).getTime()):(this.min=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),o+-u,0).getTime(),this.max=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),h+u,0).getTime())}n.actualRange.min=(n.minimum,this.min);n.actualRange.max=(n.maximum,this.max);n.actualRange.delta=n.actualRange.max-n.actualRange.min;n.doubleRange=new bt(n.actualRange.min,n.actualRange.max);this.calculateVisibleRange(t,n)},t.prototype.getYear=function(n,t,i,r){var u=n.getFullYear(),f=t.getFullYear();"Additional"===i?(this.min=new Date(u-r,1,1,0,0,0).getTime(),this.max=new Date(f+r,1,1,0,0,0).getTime()):(this.min=new Date(u,0,0,0,0,0).getTime(),this.max=new Date(f,11,30,23,59,59).getTime())},t.prototype.getMonth=function(n,t,i,r){var f=n.getMonth(),u=t.getMonth();"Round"===i?(this.min=new Date(n.getFullYear(),f,0,0,0,0).getTime(),this.max=new Date(t.getFullYear(),u,new Date(t.getFullYear(),t.getMonth(),0).getDate(),23,59,59).getTime()):(this.min=new Date(n.getFullYear(),f+-r,1,0,0,0).getTime(),this.max=new Date(t.getFullYear(),u+r,2===u?28:30,0,0,0).getTime())},t.prototype.getDay=function(n,t,i,r){var u=n.getDate(),f=t.getDate();"Round"===i?(this.min=new Date(n.getFullYear(),n.getMonth(),u,0,0,0).getTime(),this.max=new Date(t.getFullYear(),t.getMonth(),f,23,59,59).getTime()):(this.min=new Date(n.getFullYear(),n.getMonth(),u+-r,0,0,0).getTime(),this.max=new Date(t.getFullYear(),t.getMonth(),f+r,0,0,0).getTime())},t.prototype.getHour=function(n,t,i,r){var u=n.getHours()/r*r,f=t.getHours()+(n.getHours()-u);"Round"===i?(this.min=new Date(n.getFullYear(),n.getMonth(),n.getDate(),u,0,0).getTime(),this.max=new Date(t.getFullYear(),t.getMonth(),t.getDate(),f,59,59).getTime()):(this.min=new Date(n.getFullYear(),n.getMonth(),n.getDate(),u+-r,0,0).getTime(),this.max=new Date(t.getFullYear(),t.getMonth(),t.getDate(),f+r,0,0).getTime())},t.prototype.calculateVisibleRange=function(n,t){t.visibleRange={min:t.actualRange.min,max:t.actualRange.max,interval:t.actualRange.interval,delta:t.actualRange.delta};var i=!sf.base.isNullOrUndefined(t.zoomingScrollBar)&&t.zoomingScrollBar.isLazyLoad;yi(t)&&!i&&(t.calculateVisibleRangeOnZooming(n),t.calculateAxisRange(n,this.chart),t.visibleRange.interval=t.enableAutoIntervalOnZooming?this.calculateDateTimeNiceInterval(t,n,t.visibleRange.min,t.visibleRange.max):t.visibleRange.interval);t.dateTimeInterval=this.increaseDateTimeInterval(t,t.visibleRange.min,t.visibleRange.interval).getTime()-t.visibleRange.min;t.triggerRangeRender(this.chart,t.visibleRange.min,t.visibleRange.max,t.visibleRange.interval)},t.prototype.calculateVisibleLabels=function(n,t){n.visibleLabels=[];var u,r,i=n.visibleRange.min,e="chart"===t.getModuleName()&&t.isBlazor,f=n.visibleLabels;for(ki(n)||(i=this.alignRangeStart(n,i,n.visibleRange.interval).getTime());i<=n.visibleRange.max;)u=sf.base.extend({},sf.base.getValue("properties",n.labelStyle),null,!0),r=f.length?n.visibleLabels[f.length-1].value:i,n.format=t.intl.getDateFormat({format:this.findCustomFormats(n,i,r)||this.blazorCustomFormat(n),type:tt(n.skeletonType),skeleton:this.getSkeleton(n,i,r,e)}),n.startLabel=n.format(new Date(n.visibleRange.min)),n.endLabel=n.format(new Date(n.visibleRange.max)),ut(i,n.visibleRange)&&vi(t,i,n.format(new Date(i)),u,n),i=this.increaseDateTimeInterval(n,i,n.visibleRange.interval).getTime();("Months"===n.actualIntervalType||"Days"===n.actualIntervalType)&&n.isChart&&(n.format=t.intl.getDateFormat({format:n.labelFormat||("Months"!==n.actualIntervalType||n.skeleton?"":"y MMM"),type:tt(n.skeletonType),skeleton:n.skeleton||("Days"===n.actualIntervalType?"MMMd":"")}));n.getMaxLabelWidth&&n.getMaxLabelWidth(this.chart)},t.prototype.blazorCustomFormat=function(n){return this.chart.isBlazor?"Years"===n.actualIntervalType?n.isIntervalInDecimal?"yyyy":"MMM y":"Days"!==n.actualIntervalType||n.isIntervalInDecimal?"":"ddd HH tt":""},t.prototype.increaseDateTimeInterval=function(n,t,i){var r=new Date(t),u;if(n.interval?(n.isIntervalInDecimal=i%1==0,n.visibleRange.interval=i):(i=Math.ceil(i),n.visibleRange.interval=i),u=n.actualIntervalType,n.isIntervalInDecimal)switch(u){case"Years":return r.setFullYear(r.getFullYear()+i),r;case"Quarter":return r.setMonth(r.getMonth()+3*i),r;case"Months":return r.setMonth(r.getMonth()+i),r;case"Weeks":return r.setDate(r.getDate()+7*i),r;case"Days":return r.setDate(r.getDate()+i),r;case"Hours":return r.setHours(r.getHours()+i),r;case"Minutes":return r.setMinutes(r.getMinutes()+i),r;case"Seconds":return r.setSeconds(r.getSeconds()+i),r}else r=this.getDecimalInterval(r,i,u);return r},t.prototype.alignRangeStart=function(n,t,i){var r=new Date(t),u,f,e,o,s,h;switch(n.actualIntervalType){case"Years":return u=Math.floor(Math.floor(r.getFullYear()/i)*i),new Date(u,r.getMonth(),r.getDate(),0,0,0);case"Months":return f=Math.floor(Math.floor(r.getMonth()/i)*i),new Date(r.getFullYear(),f,r.getDate(),0,0,0);case"Days":return e=Math.floor(Math.floor(r.getDate()/i)*i),new Date(r.getFullYear(),r.getMonth(),e,0,0,0);case"Hours":return o=Math.floor(Math.floor(r.getHours()/i)*i),new Date(r.getFullYear(),r.getMonth(),r.getDate(),o,0,0);case"Minutes":return s=Math.floor(Math.floor(r.getMinutes()/i)*i),new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),s,0,0);case"Seconds":return h=Math.floor(Math.floor(r.getSeconds()/i)*i),new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),h,0)}return r},t.prototype.getDecimalInterval=function(n,t,i){var r=Math.floor(t),u=t-r,f,e,o,s,h,c;switch(i){case"Years":return f=Math.round(12*u),n.setFullYear(n.getFullYear()+r),n.setMonth(n.getMonth()+f),n;case"Quarter":return n.setMonth(n.getMonth()+3*t),n;case"Months":return e=Math.round(30*u),n.setMonth(n.getMonth()+r),n.setDate(n.getDate()+e),n;case"Weeks":return n.setDate(n.getDate()+7*t),n;case"Days":return o=Math.round(24*u),n.setDate(n.getDate()+r),n.setHours(n.getHours()+o),n;case"Hours":return s=Math.round(60*u),n.setHours(n.getHours()+r),n.setMinutes(n.getMinutes()+s),n;case"Minutes":return h=Math.round(60*u),n.setMinutes(n.getMinutes()+r),n.setSeconds(n.getSeconds()+h),n;case"Seconds":return c=Math.round(1e3*u),n.setSeconds(n.getSeconds()+r),n.setMilliseconds(n.getMilliseconds()+c),n}return n},t.prototype.getModuleName=function(){return"DateTime"},t.prototype.destroy=function(){},t}(vs),ip=(te=function(n,t){return(te=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}te(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ys=function(n){function t(t){return n.call(this,t)||this}return ip(t,n),t.prototype.calculateRangeAndInterval=function(n,t){this.calculateRange(t);this.getActualRange(t,n);this.applyRangePadding(t,n);this.calculateVisibleLabels(t)},t.prototype.getActualRange=function(n,t){this.initializeDoubleRange(n);n.actualRange={};n.actualRange.interval=n.interval?Math.ceil(n.interval):Math.max(1,Math.floor(n.doubleRange.delta/kr(t,n)));n.actualRange.min=n.doubleRange.start;n.actualRange.max=n.doubleRange.end;n.actualRange.delta=n.doubleRange.delta},t.prototype.applyRangePadding=function(n,t){var i="BetweenTicks"===n.labelPlacement&&"PolarRadar"!==this.chart.chartAreaType?.5:0;i>0?(n.actualRange.min-=i,n.actualRange.max+=i):n.actualRange.max+=n.actualRange.max?0:.5;n.doubleRange=new bt(n.actualRange.min,n.actualRange.max);n.actualRange.delta=n.doubleRange.delta;this.calculateVisibleRange(t,n)},t.prototype.calculateVisibleLabels=function(n){
/*! Generate axis labels */
n.visibleLabels=[];var r,t,i=Math.ceil(n.visibleRange.min);for((n.zoomFactor<1||n.zoomPosition>0)&&(i=n.visibleRange.min-n.visibleRange.min%n.visibleRange.interval),n.startLabel=n.labels[Math.round(n.visibleRange.min)],n.endLabel=n.labels[Math.floor(n.visibleRange.max)];i<=n.visibleRange.max;i+=n.visibleRange.interval)r=sf.base.extend({},sf.base.getValue("properties",n.labelStyle),null,!0),ut(i,n.visibleRange)&&n.labels.length>0&&(t=Math.round(i),vi(this.chart,t,n.labels[t]?n.labels[t].toString():t.toString(),r,n));n.getMaxLabelWidth&&n.getMaxLabelWidth(this.chart)},t.prototype.getModuleName=function(){return"Category"},t.prototype.destroy=function(){},t}(vs),rp=(ie=function(n,t){return(ie=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ie(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),bl=function(n){function t(t){return n.call(this,t)||this}return rp(t,n),t.prototype.calculateRangeAndInterval=function(n,t){this.calculateRange(t);this.getActualRange(t,n);this.calculateVisibleRange(n,t);this.calculateVisibleLabels(t,this.chart)},t.prototype.getActualRange=function(n,t){var i,r;this.initializeDoubleRange(n);this.min=this.min<0?0:this.min;i=nt(this.min,n.logBase);i=isFinite(i)?i:this.min;r=1===this.max?1:nt(this.max,n.logBase);r=isFinite(i)?r:this.max;this.min=Math.floor(i/1);n.series&&n.series.some(function(n){return(-1!==n.type.indexOf("Column")||-1!==n.type.indexOf("Bar"))&&-1===n.type.indexOf("Range")})&&(this.min=this.min<=0?+this.min-1:this.min);this.max=Math.ceil(r/1);n.actualRange.interval=n.interval||this.calculateLogNiceInterval(this.max-this.min,t,n);n.actualRange.min=this.min;n.actualRange.max=this.max;n.actualRange.delta=this.max-this.min},t.prototype.calculateVisibleRange=function(n,t){t.visibleRange={interval:t.actualRange.interval,max:t.actualRange.max,min:t.actualRange.min,delta:t.actualRange.delta};var i=!sf.base.isNullOrUndefined(t.zoomingScrollBar)&&t.zoomingScrollBar.isLazyLoad;(t.zoomFactor<1||t.zoomPosition>0)&&!i&&(t.calculateVisibleRangeOnZooming(n),t.visibleRange.interval=t.enableAutoIntervalOnZooming?this.calculateLogNiceInterval(t.doubleRange.delta,n,t):t.visibleRange.interval,t.visibleRange.interval=0===Math.floor(t.visibleRange.interval)?1:Math.floor(t.visibleRange.interval),t.triggerRangeRender(this.chart,t.visibleRange.min,t.visibleRange.max,t.visibleRange.interval))},t.prototype.calculateLogNiceInterval=function(n,t,i){for(var f,e=kr(t,i),r=n,o=Math.pow(i.logBase,Math.floor(nt(r,10))),u=0,s=i.intervalDivs.length;u<s;u++){if(f=o*i.intervalDivs[u],e<n/f)break;r=f}return r},t.prototype.calculateVisibleLabels=function(n,t){
/*! Generate axis labels */
var e,r,i=n.visibleRange.min;n.visibleLabels=[];(n.zoomFactor<1||n.zoomPosition>0)&&(i=n.visibleRange.min-n.visibleRange.min%n.visibleRange.interval);var f=this.getFormat(n),o=null!==f.match("{value}"),u=Math.pow(n.logBase,n.visibleRange.min);for(n.format=t.intl.getNumberFormat({format:o?"":f,useGrouping:t.useGroupingSeparator,maximumFractionDigits:u<1?20:3}),n.startLabel=n.format(u<1?+u.toPrecision(1):u),n.endLabel=n.format(Math.pow(n.logBase,n.visibleRange.max));i<=n.visibleRange.max;i+=n.visibleRange.interval)e=sf.base.extend({},sf.base.getValue("properties",n.labelStyle),null,!0),ut(i,n.visibleRange)&&(r=Math.pow(n.logBase,i),vi(this.chart,i,this.formatValue(n,o,f,r<1?+r.toPrecision(1):r),e,n));n.getMaxLabelWidth&&n.getMaxLabelWidth(this.chart)},t.prototype.getModuleName=function(){return"Logarithmic"},t.prototype.destroy=function(){},t}(yr),up=(re=function(n,t){return(re=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}re(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),kl=function(n){function t(t){return n.call(this,t)||this}return up(t,n),t.prototype.calculateRangeAndInterval=function(n,t){this.axisSize=n;this.calculateRange(t);this.getActualRange(t,n);this.applyRangePadding(t,n);this.calculateVisibleLabels(t)},t.prototype.calculateVisibleLabels=function(n){var i,r,t;
/*! Generate axis labels */
for(n.visibleLabels=[],r="BetweenTicks"===n.labelPlacement?.5:0,"Auto"===n.intervalType?this.calculateDateTimeNiceInterval(n,this.axisSize,parseInt(n.labels[0],10),parseInt(n.labels[n.labels.length-1],10)):n.actualIntervalType=n.intervalType,n.format=this.chart.intl.getDateFormat({format:n.labelFormat||this.blazorCustomFormat(n),type:tt(n.skeletonType),skeleton:this.getSkeleton(n,null,null,this.chart.isBlazor)}),t=0;t<n.labels.length;t++)i=sf.base.extend({},sf.base.getValue("properties",n.labelStyle),null,!0),this.sameInterval(n.labels.map(Number)[t],n.labels.map(Number)[t-1],n.actualIntervalType,t)&&!n.isIndexed||ut(t-r,n.visibleRange)&&vi(this.chart,t,n.isIndexed?this.getIndexedAxisLabel(n.labels[t],n.format):n.format(new Date(n.labels.map(Number)[t])),i,n);n.getMaxLabelWidth&&n.getMaxLabelWidth(this.chart)},t.prototype.blazorCustomFormat=function(n){return this.chart.isBlazor&&"Years"===n.actualIntervalType?"yyyy":""},t.prototype.getIndexedAxisLabel=function(n,t){for(var i=n.split(","),r=0;r<i.length;r++)i[r]=t(new Date(parseInt(i[r],10)));return i.join(", ")},t.prototype.sameInterval=function(n,t,i,r){var u;if(0===r)u=!1;else switch(i){case"Years":u=new Date(n).getFullYear()===new Date(t).getFullYear();break;case"Months":u=new Date(n).getFullYear()===new Date(t).getFullYear()&&new Date(n).getMonth()===new Date(t).getMonth();break;case"Days":u=Math.abs(n-t)<864e5&&new Date(n).getDay()===new Date(t).getDay();break;case"Hours":u=Math.abs(n-t)<36e5&&new Date(n).getDay()===new Date(t).getDay();break;case"Minutes":u=Math.abs(n-t)<6e4&&new Date(n).getMinutes()===new Date(t).getMinutes();break;case"Seconds":u=Math.abs(n-t)<1e3&&new Date(n).getDay()===new Date(t).getDay()}return u},t.prototype.getModuleName=function(){return"DateTimeCategory"},t.prototype.destroy=function(){},t}(ys),dl=function(){function n(){}return n.prototype.measureStripLine=function(n,t,i,r,u,f){var c,l,a=n.orientation,v="DateTime"===n.valueType,e,o,h;t.isRepeat&&null!==t.size?(c=r,l=null):"DateTimeCategory"===n.valueType?(e=t.start,o=t.end,c=null!=e&&"number"!=typeof e?n.labels.indexOf(this.dateToMilliSeconds(e,f).toString()):e,l=null!=o&&"number"!=typeof o?n.labels.indexOf(this.dateToMilliSeconds(o,f).toString()):o):(c=null===t.start?null:v&&this.isCoreDate(t.start)?this.dateToMilliSeconds(t.start,f):+t.start,l=null===t.end?null:v&&this.isCoreDate(t.start)?this.dateToMilliSeconds(t.end,f):+t.end);var s=this.getFromTovalue(c,l,t.size,t.startFromAxis,n,t),y="Vertical"===a?(s.to-s.from)*n.rect.height:i.height,p="Horizontal"===a?(s.to-s.from)*n.rect.width:i.width,w="Vertical"===a?i.x:s.from*n.rect.width+n.rect.x,b="Horizontal"===a?i.y:n.rect.y+n.rect.height-("Pixel"===t.sizeType?s.from:s.to)*n.rect.height;return t.isSegmented&&null!=t.segmentStart&&null!=t.segmentEnd&&"Pixel"!==t.sizeType&&(e=v&&this.isCoreDate(t.segmentStart)?this.dateToMilliSeconds(t.segmentStart,f):+t.segmentStart,o=v&&this.isCoreDate(t.segmentEnd)?this.dateToMilliSeconds(t.segmentEnd,f):+t.segmentEnd,h=this.getFromTovalue(e,o,null,null,u,t),"Vertical"===u.orientation?(b=u.rect.y+u.rect.height-h.to*u.rect.height,y=(h.to-h.from)*u.rect.height):(w=h.from*u.rect.width+u.rect.x,p=(h.to-h.from)*u.rect.width)),0!==y&&0!==p||"Pixel"===t.sizeType&&(null!==t.start||t.startFromAxis)?new sf.svgbase.Rect(w,b,p,y):new sf.svgbase.Rect(0,0,0,0)},n.prototype.getFromTovalue=function(n,t,i,r,u,f){var e=!f.isRepeat&&r?u.visibleRange.min:n,o=this.getToValue(Math.max(n,sf.base.isNullOrUndefined(t)?n:t),e,i,u,t,f);return e=this.findValue(e,u),o=this.findValue(o,u),{from:a(u.isInversed?o:e,u),to:a(u.isInversed?e:o,u)}},n.prototype.getToValue=function(n,t,i,r,u,f){var s=f.sizeType,o=null===u,e;if("DateTime"!==r.valueType)return"Pixel"===f.sizeType?t:o?t+i:n;e=new Date(t);switch("Auto"===s&&(s=r.actualIntervalType,i*=r.visibleRange.interval),s){case"Years":return o?new Date(e.setFullYear(e.getFullYear()+i)):n;case"Months":return o?new Date(e.setMonth(e.getMonth()+i)):n;case"Days":return o?new Date(e.setDate(e.getDate()+i)):n;case"Hours":return o?new Date(e.setHours(e.getHours()+i)):n;case"Minutes":return o?new Date(e.setMinutes(e.getMinutes()+i)):n;case"Seconds":return o?new Date(e.setSeconds(e.getSeconds()+i)):n;default:return t}},n.prototype.findValue=function(n,t){return n<t.visibleRange.min?n=t.visibleRange.min:n>t.visibleRange.max&&(n=t.visibleRange.max),n},n.prototype.dateParse=function(n,t){var i=t.intl.getDateParser({skeleton:"full",type:"dateTime"}),r=t.intl.getDateFormat({skeleton:"full",type:"dateTime"});return new Date(Date.parse(i(r(new Date(sf.data.DataUtil.parse.parseJson({val:n}).val)))))},n.prototype.renderStripLine=function(n,t,i){var p,e=n.element.id+"_stripline_"+t+"_",w=n.chartAxisLayoutPanel.seriesClipRect,b=0,f=0,l=null,d=new y(e+"ClipRect","transparent",{width:1,color:"Gray"},1,{x:n.initialClipRect.x,y:n.initialClipRect.y,width:n.initialClipRect.width,height:n.initialClipRect.height}),o=n.renderer.createGroup({id:e+"collections","clip-path":"url(#"+e+"ClipRect)"}),s,a,r;for(n.enableCanvas||o.appendChild(vt(n.redraw,d,n.renderer)),s=0,a=i;s<a.length;s++)for(var u=a[s],c=0,v=0,k=u.stripLines;v<k.length;v++)if(r=k[v],r.visible&&r.zIndex===t)if(r.isSegmented&&null!=r.segmentStart&&null!=r.segmentEnd&&"Pixel"!==r.sizeType&&(l=this.getSegmentAxis(i,u,r)),r.isRepeat&&null!=r.repeatEvery&&null!==r.size&&"Pixel"!==r.sizeType)for(b=null!=r.repeatUntil?"DateTime"===u.valueType?this.dateToMilliSeconds(r.repeatUntil,n):+r.repeatUntil:u.actualRange.max,f="DateTime"===u.valueType&&this.isCoreDate(r.start)?this.dateToMilliSeconds(r.start,n):r.start,(r.startFromAxis&&"DateTime"===u.valueType&&"Auto"===r.sizeType||r.start<u.visibleRange.min)&&(f=u.visibleLabels[0].value===u.visibleRange.min?u.visibleRange.min:u.visibleLabels[0].value-("DateTime"===u.valueType?u.dateTimeInterval:u.visibleRange.interval)),f=r.startFromAxis&&"DateTime"!==u.valueType?u.visibleRange.min:f;f<b;)p=ut(f+("DateTime"===u.valueType?u.dateTimeInterval*+r.size:r.size),u.visibleRange),(f>=u.visibleRange.min&&f<u.visibleRange.max||p)&&this.renderStripLineElement(u,r,w,e,o,n,f,l,c),c++,f=this.getStartValue(u,r,f,n);else this.renderStripLineElement(u,r,w,e,o,n,null,l,c),c++;h(n.enableCanvas,n.svgObject,o,n.redraw)},n.prototype.isCoreDate=function(n){return"string"==typeof n},n.prototype.dateToMilliSeconds=function(n,t){return this.dateParse(n,t).getTime()},n.prototype.renderPath=function(n,t,i,u,f,e){var o=r(i),s=o?o.getAttribute("d"):"",c="Vertical"===e.orientation?"M "+t.x+" "+t.y+" L "+(t.x+t.width)+" "+t.y:"M "+t.x+" "+t.y+" L "+t.x+" "+(t.y+t.height);h(f.enableCanvas,u,f.renderer.drawPath(new sf.svgbase.PathOption(i,"none",n.size,n.color,n.opacity,n.dashArray,c)),f.redraw,!0,"x","y",null,s,!0)},n.prototype.renderRectangle=function(n,t,i,u,f){var e=r(i),o=e?new sf.svgbase.Rect(+e.getAttribute("x"),+e.getAttribute("y"),+e.getAttribute("width"),+e.getAttribute("height")):null;h(f.enableCanvas,u,f.renderer.drawRectangle(new y(i,n.color,n.border,n.opacity,t,0,0,"",n.dashArray)),f.redraw,!0,"x","y",null,null,!0,!0,o)},n.prototype.renderText=function(n,t,i,r,u,f){var c,l=sf.svgbase.measureText(n.text,n.textStyle),s=null===n.rotation,h=s?l.height/8*3:0,e=t.y+t.height/2+h,a=s?"Vertical"===f.orientation?0:-90:n.rotation,o=t.x+t.width/2;"Horizontal"===f.orientation?(o=this.getTextStart(o+h*this.factor(n.horizontalAlignment),t.width,n.horizontalAlignment),e=this.getTextStart(e-h,t.height,n.verticalAlignment)+("Start"!==n.verticalAlignment||s?0:l.height/4),c=s?this.invertAlignment(n.verticalAlignment):n.horizontalAlignment):(o=this.getTextStart(o,t.width,n.horizontalAlignment),e=this.getTextStart(e+h*this.factor(n.verticalAlignment)-5,t.height,n.verticalAlignment),c=n.horizontalAlignment);k(u.renderer,new sf.svgbase.TextOption(i,o,e,c,n.text,"rotate("+a+" "+o+","+e+")","middle"),n.textStyle,n.textStyle.color,r,null,null,null,null,null,null,0,null,u.enableCanvas)},n.prototype.invertAlignment=function(n){switch(n){case"Start":n="End";break;case"End":n="Start"}return n},n.prototype.getStartValue=function(n,t,i){return"DateTime"===n.valueType?this.getToValue(null,i,+t.repeatEvery,n,null,t):i+ +t.repeatEvery},n.prototype.getSegmentAxis=function(n,t,i){var u,r;if(null==i.segmentAxisName)return"Horizontal"===t.orientation?n[1]:n[0];for(r=0;r<n.length;r++)i.segmentAxisName===n[r].name&&(u=n[r]);return u},n.prototype.renderStripLineElement=function(n,t,i,r,u,f,e,o,s){var h=this.measureStripLine(n,t,i,e,o,f);"Pixel"===t.sizeType?this.renderPath(t,h,r+"path_"+n.name+"_"+s,u,f,n):0!==h.height&&0!==h.width&&this.renderRectangle(t,h,r+"rect_"+n.name+"_"+s,u,f);""!==t.text&&this.renderText(t,h,r+"text_"+n.name+"_"+s,u,f,n)},n.prototype.factor=function(n){var t=0;switch(n){case"Start":t=1;break;case"End":t=-1}return t},n.prototype.getTextStart=function(n,t,i){switch(i){case"Start":n=n-t/2+5;break;case"End":n=n+t/2-5}return n},n.prototype.getModuleName=function(){return"StripLine"},n.prototype.destroy=function(){},n}(),pt=function(){function n(n){this.chart=n}return n.prototype.enableComplexProperty=function(n){for(var t,u,r,f=[],l=[],a=n.xAxis.visibleRange,v=n.yAxis.visibleRange,i=n.points,y=n.clipRect,e=Math.abs(a.delta/y.width),o=Math.abs(v.delta/y.height),p=i[0]&&i[0].x>e?0:e,w=i[0]&&i[0].y>o?0:o,s=0,h=0,c=0,b=i;c<b.length;c++)t=b[c],t.symbolLocations=[],s=t.xValue?t.xValue:a.min,h=t.yValue?t.yValue:v.min,(Math.abs(p-s)>=e||Math.abs(w-h)>=o)&&(f.push(t),p=s,w=h);for(u=0;u<f.length;u++)r=f[u],sf.base.isNullOrUndefined(r.x)||""===r.x||l.push(r);return l},n.prototype.getLineDirection=function(n,t,i,r,u,f){var s="",e,o;return null!=n&&(e=u(n.xValue,n.yValue,i.xAxis,i.yAxis,r,i),o=u(t.xValue,t.yValue,i.xAxis,i.yAxis,r,i),s=f+" "+e.x+" "+e.y+" L "+o.x+" "+o.y+" "),s},n.prototype.appendLinePath=function(n,t,i){var f=r(n.id),e=t.chart,o=f?f.getAttribute("d"):null,u=t.chart.renderer.drawPath(n,new Int32Array([t.clipRect.x,t.clipRect.y]));u&&u.setAttribute("clip-path",i);t.pathElement=u;t.chart.enableCanvas||t.seriesElement.appendChild(u);t.isRectSeries=!1;ii(f,n.d,t.chart.redraw,o,e.duration)},n.prototype.renderMarker=function(n){n.marker&&n.marker.visible&&n.chart.markerRender.render(n)},n.prototype.doProgressiveAnimation=function(n,t){var r,f=new sf.base.Animation({}),i=n.pathElement,e=i.getAttribute("stroke-dasharray"),u=n.pathElement.getTotalLength();i.style.visibility="hidden";f.animate(i,{duration:t.duration,delay:t.delay,progress:function(n){n.timeStamp>=n.delay&&(i.style.visibility="visible",r=Math.abs(Math.round((n.timeStamp-n.delay)*u/n.duration)),i.setAttribute("stroke-dasharray",r+","+u))},end:function(){i.setAttribute("stroke-dasharray",e);n.chart.trigger("animationComplete",{series:n.chart.isBlazor?{}:n})}})},n.prototype.storePointLocation=function(n,t,i,r){var u=t.marker&&t.marker.width?t.marker.width:0,f=t.marker&&t.marker.height?t.marker.height:0;n.symbolLocations.push(r(n.xValue,n.yValue,t.xAxis,t.yAxis,i,t));n.regions.push(new sf.svgbase.Rect(n.symbolLocations[0].x-u,n.symbolLocations[0].y-f,2*u,2*f))},n.prototype.withinYRange=function(n,t){return n.yValue>=t.visibleRange.min&&n.yValue<=t.visibleRange.max},n.prototype.getFirstLastVisiblePoint=function(n){for(var t,r=null,i=null,u=0,f=n;u<f.length;u++)t=f[u],null===r&&t.visible&&(r=i=t),i=t.visible?t:i;return{first:r||n[0],last:i||n[n.length-1]}},n.prototype.doLinearAnimation=function(n,t){var r,i=n.clipRectElement.childNodes[0].childNodes[0],h=n.chart.animated?n.chart.duration:t.duration,e=nf("Linear"),o=+i.getAttribute("height"),s=+i.getAttribute("width"),u=+i.getAttribute("x"),f=n.chart.requireInvertedAxis?+i.getAttribute("height")+ +i.getAttribute("y"):+i.getAttribute("y");i.style.visibility="hidden";new sf.base.Animation({}).animate(i,{duration:h,delay:t.delay,progress:function(t){t.timeStamp>=t.delay&&(i.style.visibility="visible",n.chart.requireInvertedAxis?(r=e(t.timeStamp-t.delay,0,o,t.duration),i.setAttribute("transform","translate("+u+" "+f+") scale(1,"+r/o+") translate("+-u+" "+-f+")")):(r=e(t.timeStamp-t.delay,0,s,t.duration),i.setAttribute("transform","translate("+u+" "+f+") scale("+r/s+", 1) translate("+-u+" "+-f+")")))},end:function(){i.setAttribute("transform","translate(0,0)");n.chart.trigger("animationComplete",{series:n.chart.isBlazor?{}:n})}})},n}(),fp=(ue=function(n,t){return(ue=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ue(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),gl=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fp(t,n),t.prototype.render=function(n,t,i,r){for(var u,s,d,g,a,v,h="",o=null,f="M",p=n.chart&&"PolarRadar"===n.chart.chartAreaType,w=n.emptyPointSettings&&"Drop"===n.emptyPointSettings.mode,c=p?ei:e,l="TrendLine"===n.category?n.points:this.enableComplexProperty(n),y=0,k=l;y<k.length;y++)u=k[y],u.regions=[],u.symbolLocations=[],u.visible&&b(l[u.index-1],u,l[u.index+1],n)?(h+=this.getLineDirection(o,u,n,r,c,f),f=o?"L":f,o=u,this.storePointLocation(u,n,r,c)):(o=w?o:null,f=w?f:"M");p&&n.isClosed&&(s=this.getFirstLastVisiblePoint(l),v=c(s.last.xValue,s.last.yValue,t,i,r,n),a=c(s.first.xValue,s.first.yValue,t,i,r,n),h=h.concat(f+" "+v.x+" "+v.y+" L "+a.x+" "+a.y));d="Indicator"===n.category?n.chart.element.id+"_Indicator_"+n.index+"_"+n.name:"TrendLine"===n.category?n.chart.element.id+"_Series_"+n.sourceIndex+"_TrendLine_"+n.index:n.chart.element.id+"_Series_"+(void 0===n.index?n.category:n.index);g=new sf.svgbase.PathOption(d,"none",n.width,n.interior,n.opacity,n.dashArray,h);this.appendLinePath(g,n,"");this.renderMarker(n)},t.prototype.doAnimation=function(n){var t=n.animation;this.doProgressiveAnimation(n,t)},t.prototype.getModuleName=function(){return"LineSeries"},t.prototype.destroy=function(){},t}(pt),wt=function(){function n(){}return n.prototype.getSideBySideInfo=function(n){var u,i;if(n.chart.enableSideBySidePlacement&&!n.position&&this.getSideBySidePositions(n),n.columnWidthInPixel)return new bt(0,0);u=n.chart.enableSideBySidePlacement?n.position:0;i=n.chart.enableSideBySidePlacement?n.rectCount:1;n.isRectSeries=!0;var r,o=n.chart.visibleSeries,s=n.chart.enableSideBySidePlacement?n.columnSpacing:0,h=null===n.columnWidth||isNaN(+n.columnWidth)?"Histogram"===n.type?1:.7:n.columnWidth,f=gu(n.xAxis,o)*h,e=u/i-.5,t=new bt(e,e+1/i);return isNaN(t.start)||isNaN(t.end)||(r=s*(t=new bt(t.start*f,t.end*f)).delta,t=new bt(t.start+r/2,t.end-r/2)),t},n.prototype.getRectangle=function(n,t,i,r,u){var f=e(n,t,u.xAxis,u.yAxis,u.chart.requireInvertedAxis),o=e(i,r,u.xAxis,u.yAxis,u.chart.requireInvertedAxis);return new sf.svgbase.Rect(Math.min(f.x,o.x),Math.min(f.y,o.y),Math.abs(o.x-f.x),Math.abs(o.y-f.y))},n.prototype.getSideBySidePositions=function(n){for(var e,r=n.chart,t=0,u=r.columns;t<u.length;t++)for(var o=u[t],i=0,f=r.rows;i<f.length;i++)e=f[i],this.findRectPosition(n.findSeriesCollection(o,e,!1))},n.prototype.findRectPosition=function(n){for(var t,u=[],i={rectCount:0,position:null},r=0;r<n.length;r++)-1!==(t=n[r]).type.indexOf("Stacking")?t.stackingGroup?void 0===u[t.stackingGroup]?(t.position=i.rectCount,u[t.stackingGroup]=i.rectCount++):t.position=u[t.stackingGroup]:null===i.position?(t.position=i.rectCount,i.position=i.rectCount++):t.position=i.position:t.position=i.rectCount++;for(r=0;r<n.length;r++)(t=n[r]).rectCount=i.rectCount},n.prototype.updateSymbolLocation=function(n,t,i){i.chart.requireInvertedAxis?this.updateYRegion(n,t,i):this.updateXRegion(n,t,i);"Histogram"===i.type&&(n.minimum=+n.x-i.histogramValues.binWidth/2,n.maximum=+n.x+i.histogramValues.binWidth/2)},n.prototype.updateXRegion=function(n,t,i){n.symbolLocations.push({x:t.x+t.width/2,y:"BoxPlot"===i.seriesType||-1!==i.seriesType.indexOf("HighLow")||n.yValue>=0==!i.yAxis.isInversed?t.y:t.y+t.height});this.getRegion(n,t,i);"RangeColumn"===i.type&&n.symbolLocations.push({x:t.x+t.width/2,y:t.y+t.height})},n.prototype.updateYRegion=function(n,t,i){n.symbolLocations.push({x:"BoxPlot"===i.seriesType||-1!==i.seriesType.indexOf("HighLow")||n.yValue>=0==!i.yAxis.isInversed?t.x+t.width:t.x,y:t.y+t.height/2});this.getRegion(n,t,i);"RangeColumn"===i.type&&n.symbolLocations.push({x:t.x,y:t.y+t.height/2})},n.prototype.renderMarker=function(n){n.marker&&n.marker.visible&&n.chart.markerRender.render(n)},n.prototype.getRegion=function(n,t,i){if(0===n.y){var r=i.marker&&i.marker.width?i.marker.width:0,u=i.marker&&i.marker.height?i.marker.height:0;n.regions.push(new sf.svgbase.Rect(n.symbolLocations[0].x-r,n.symbolLocations[0].y-u,2*r,2*u))}else n.regions.push(t)},n.prototype.triggerEvent=function(n,t,i,r){var u={cancel:!1,name:"pointRender",series:n,point:t,fill:n.setPointColor(t,i),border:n.setBorderColor(t,r)};return n.chart.trigger("pointRender",u),t.color=u.fill,u},n.prototype.drawRectangle=function(n,t,i,r){var e,u=n.chart;if((u.requireInvertedAxis?i.height:i.width)<=0)return null;e=0===t.y?this.calculateRoundedRectPath(i,0,0,0,0):this.calculateRoundedRectPath(i,n.cornerRadius.topLeft,n.cornerRadius.topRight,n.cornerRadius.bottomLeft,n.cornerRadius.bottomRight);var o="Indicator"===n.category?u.element.id+"_Indicator_"+n.index+"_"+n.name+"_Point_"+t.index:u.element.id+"_Series_"+n.index+"_Point_"+t.index,s=yt(u.redraw,o),c=s?s.getAttribute("d"):"",l=new sf.svgbase.PathOption(o,r.fill,r.border.width,r.border.color,n.opacity,n.dashArray,e),f=u.renderer.drawPath(l,new Int32Array([n.clipRect.x,n.clipRect.y]));switch(n.seriesType){case"XY":f.setAttribute("aria-label",t.x.toString()+":"+t.yValue.toString());break;case"HighLow":f.setAttribute("aria-label",t.x.toString()+":"+t.high.toString()+":"+t.low.toString())}h(n.chart.enableCanvas,n.seriesElement,f,u.redraw);n.chart.enableCanvas||ii(f,e,u.redraw,c,u.duration)},n.prototype.animate=function(n){for(var t,f=n.seriesElement.childNodes,r="Indicator"===n.category?0:1,i=0,u=fi(n);i<u.length;i++)t=u[i],(t.symbolLocations.length||"BoxAndWhisker"===n.type&&t.regions.length)&&(this.animateRect(f[r],n,t),r++)},n.prototype.animateRect=function(n,t,i){var r,u,f,e,h,l=t.animation,y=t.chart.animated?t.chart.duration:l.duration,v=nf("Linear"),c=i.yValue<0,o=+i.regions[0].height,s=+i.regions[0].width;t.chart.requireInvertedAxis?(u=+i.regions[0].y,t.type.indexOf("Stacking")>-1?(r=a(0,t.yAxis)*t.yAxis.rect.width,f=r,e=u):(r=+i.regions[0].x,e=c?u:u+o,f=-1!==t.seriesType.indexOf("HighLow")||-1!==t.type.indexOf("Waterfall")?r+s/2:c!==t.yAxis.isInversed?r+s:r)):(r=+i.regions[0].x,t.type.indexOf("Stacking")>-1?(u=(1-a(0,t.yAxis))*t.yAxis.rect.height,f=r,e=u):(u=+i.regions[0].y,e=-1!==t.seriesType.indexOf("HighLow")||-1!==t.type.indexOf("Waterfall")?u+o/2:c!==t.yAxis.isInversed?u:u+o,f=c?r:r+s));sf.base.isNullOrUndefined(n)||(n.style.visibility="hidden",new sf.base.Animation({}).animate(n,{duration:y,delay:l.delay,progress:function(i){i.timeStamp>=i.delay&&(n.style.visibility="visible",t.chart.requireInvertedAxis?(s=s||1,h=v(i.timeStamp-i.delay,0,s,i.duration),n.setAttribute("transform","translate("+f+" "+e+") scale("+h/s+", 1) translate("+-f+" "+-e+")")):(o=o||1,h=v(i.timeStamp-i.delay,0,o,i.duration),n.setAttribute("transform","translate("+f+" "+e+") scale(1,"+h/o+") translate("+-f+" "+-e+")")))},end:function(){var u,f,r;if(n.setAttribute("transform","translate(0,0)"),u=t.seriesElement,(n===u.lastElementChild||i.index===t.points.length-1||"Waterfall"===t.type&&n===u.children[u.childElementCount-2])&&(t.chart.trigger("animationComplete",{series:t.chart.isBlazor?{}:t}),"Waterfall"===t.type))for(f=u.childNodes,r=0;r<f.length;r++)-1!==f[r].id.indexOf("Connector")&&(f[r].style.visibility="visible",f[r].setAttribute("transform","translate(0,0)"))}}))},n.prototype.calculateRoundedRectPath=function(n,t,i,r,u){return"M "+n.x+" "+(t+n.y)+" Q "+n.x+" "+n.y+" "+(n.x+t)+" "+n.y+" L "+(n.x+n.width-i)+" "+n.y+" Q "+(n.x+n.width)+" "+n.y+" "+(n.x+n.width)+" "+(n.y+i)+" L "+(n.x+n.width)+" "+(n.y+n.height-u)+" Q "+(n.x+n.width)+" "+(n.y+n.height)+" "+(n.x+n.width-u)+" "+(n.y+n.height)+" L "+(n.x+r)+" "+(n.y+n.height)+" Q "+n.x+" "+(n.y+n.height)+" "+n.x+" "+(n.y+n.height-r)+" L "+n.x+" "+(t+n.y)+" Z"},n}(),ep=(fe=function(n,t){return(fe=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}fe(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ps=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ep(t,n),t.prototype.render=function(n){for(var t,o,i,u,f=this.getSideBySideInfo(n),s=Math.max(n.yAxis.visibleRange.min,0),r=0,e=n.points;r<e.length;r++)t=e[r],(t.symbolLocations=[],t.regions=[],t.visible&&b(n.points[t.index-1],t,n.points[t.index+1],n))&&((i=this.getRectangle(t.xValue+f.start,t.yValue,t.xValue+f.end,s,n)).width=n.columnWidthInPixel?n.columnWidthInPixel:i.width,i.x=n.columnWidthInPixel?i.x-(n.columnWidthInPixel/2*n.rectCount-n.columnWidthInPixel*n.index):i.x,o="Indicator"===n.category?t.color:n.interior,(u=this.triggerEvent(n,t,o,{width:n.border.width,color:n.border.color})).cancel||(this.updateSymbolLocation(t,i,n),this.drawRectangle(n,t,i,u)));this.renderMarker(n)},t.prototype.doAnimation=function(n){this.animate(n)},t.prototype.getModuleName=function(){return"ColumnSeries"},t.prototype.destroy=function(){},t}(wt),op=(ee=function(n,t){return(ee=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ee(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),eu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return op(t,n),t.prototype.getAreaPathDirection=function(n,t,i,r,u,f,e){var o,s="";return null===f&&(s+=e+" "+(o=u(n,t,i.xAxis,i.yAxis,r,i)).x+" "+o.y+" "),s},t.prototype.getAreaEmptyDirection=function(n,t,i,r,u){var f="";return f+=this.getAreaPathDirection(n.x,n.y,i,r,u,null,"L"),f+this.getAreaPathDirection(t.x,t.y,i,r,u,null,"L")},t.prototype.setPointColor=function(n,t,i,r,u){if(""===i.pointColorMapping){for(var f=void 0,e=0;e<u.length;e++)if(f=u[e],(r?n.xValue:n.yValue)<=this.getAxisValue(f.value,r?i.xAxis:i.yAxis,i.chart)||!f.value){n.interior=f.color;break}return null==n.interior&&(n.interior=i.interior),!1}return!!t&&i.setPointColor(n,i.interior)!==i.setPointColor(t,i.interior)},t.prototype.sortSegments=function(n,t){var i=this,r="X"===n.segmentAxis?n.xAxis:n.yAxis;return[].concat(t).sort(function(t,u){return i.getAxisValue(t.value,r,n.chart)-i.getAxisValue(u.value,r,n.chart)})},t.prototype.applySegmentAxis=function(n,t,i){var v=this;if(""!==n.pointColorMapping)return t.map(function(t){v.appendLinePath(t,n,"")}),null;var u,h="X"===n.segmentAxis,f=h?n.xAxis:n.yAxis,c=n.chart;this.includeSegment(i,f,n,i.length);for(var l,a,e,y=i.length,p=function(s){u=i[s];l=o.getAxisValue(u.value,f,n.chart);(a=o.createClipRect(s?o.getAxisValue(i[s-1].value,f,n.chart):f.visibleRange.min,l,n,s,h))&&t.map(function(t){ii(r((e={"clip-path":a,"stroke-dasharray":u.dashArray,opacity:t.opacity,stroke:n.type.indexOf("Line")>-1?u.color||n.interior:n.border.color,"stroke-width":t["stroke-width"],fill:n.type.indexOf("Line")>-1?"none":u.color||n.interior,id:t.id+"_Segment_"+s,d:t.d}).id),e.d,c.redraw);n.seriesElement.appendChild(c.renderer.drawPath(e))})},o=this,s=0;s<y;s++)p(s)},t.prototype.includeSegment=function(n,t,i,r){if(r<=0)return n.push({value:t.visibleRange.max,color:i.interior}),null;this.getAxisValue(n[r-1].value,t,i.chart)<t.visibleRange.max&&n.push({value:t.visibleRange.max,color:i.interior})},t.prototype.createClipRect=function(n,t,i,r,u){var h,s=i.chart.requireInvertedAxis,f=e(u?n:i.xAxis.visibleRange.min,u?i.yAxis.visibleRange.max:t,i.xAxis,i.yAxis,s),o=e(u?t:i.xAxis.visibleRange.max,u?i.yAxis.visibleRange.min:n,i.xAxis,i.yAxis,s);return(o=s?[f,f=o][0]:o).x-f.x>0&&o.y-f.y>0?(h=new y(i.chart.element.id+"_ChartSegment"+i.index+"ClipRect_"+r,"transparent",{width:1,color:"Gray"},1,{x:f.x,y:f.y,width:o.x-f.x,height:o.y-f.y}),i.seriesElement.appendChild(vt(i.chart.redraw,h,i.chart.renderer)),"url(#"+i.chart.element.id+"_ChartSegment"+i.index+"ClipRect_"+r+")"):null},t.prototype.getAxisValue=function(n,t,i){var r,u;return(null===n&&(n=t.visibleRange.max),"DateTime"===t.valueType)?(r={skeleton:"full",type:"dateTime"},Date.parse(i.intl.getDateParser(r)(i.intl.getDateFormat(r)(new Date(sf.data.DataUtil.parse.parseJson({val:n}).val))))):t.valueType.indexOf("Category")>-1?(u="DateTimeCategory"===t.valueType?n.getTime().toString():n,t.labels.indexOf(u)<0?+n:t.labels.indexOf(u)):+n},t}(pt),sp=(oe=function(n,t){return(oe=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}oe(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),na=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return sp(t,n),t.prototype.render=function(n,t,i,r){var a,v=null,u="",y=n.chart&&"PolarRadar"===n.chart.chartAreaType,c=Math.max(n.yAxis.visibleRange.min,0),p,w;y&&(c=this.getFirstLastVisiblePoint(n.points).first.yValue);for(var o,k=n.emptyPointSettings&&"Drop"===n.emptyPointSettings.mode,d=n.border?n.border.width:0,g=n.border?n.border.color:"transparent",l="PolarRadar"===n.chart.chartAreaType?ei:e,h=this.enableComplexProperty(n),f=0;f<h.length;f++)a=(o=h[f]).xValue,o.symbolLocations=[],o.regions=[],o.visible&&b(h[f-1],o,h[f+1],n)&&(u+=this.getAreaPathDirection(a,c,n,r,l,v,"M"),v=v||new s(a,c),u+=this.getAreaPathDirection(a,o.yValue,n,r,l,null,"L"),h[f+1]&&!h[f+1].visible&&(!y||y&&this.withinYRange(h[f+1],i))&&!k&&(u+=this.getAreaEmptyDirection({x:a,y:c},v,n,r,l),v=null),this.storePointLocation(o,n,r,l));y&&""!==u&&(p="",w=this.chart,p+=this.getAreaPathDirection(0,c,n,r,l,null,"L"),(t.isInversed||i.isInversed)&&(u+="Polar"===n.type?w.polarSeriesModule.getPolarIsInversedPath(t,p):w.radarSeriesModule.getRadarIsInversedPath(t,p)),u=u.concat(u+" Z"));this.appendLinePath(new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index,n.interior,d,g,n.opacity,n.dashArray,n.points.length>1&&""!==u?u+this.getAreaPathDirection(n.points[n.points.length-1].xValue,"PolarRadar"===n.chart.chartAreaType?n.points[n.points.length-1].yValue:c,n,r,l,null,"L"):""),n,"");this.renderMarker(n)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"AreaSeries"},t.prototype.doAnimation=function(n){var t=n.animation;this.doLinearAnimation(n,t)},t}(eu),hp=(se=function(n,t){return(se=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}se(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ta=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return hp(t,n),t.prototype.render=function(n){for(var t,i,u,o=Math.max(n.yAxis.visibleRange.min,0),f=this.getSideBySideInfo(n),r=0,e=n.points;r<e.length;r++)t=e[r],t.symbolLocations=[],t.regions=[],t.visible&&b(n.points[t.index-1],t,n.points[t.index+1],n)&&((i=this.getRectangle(t.xValue+f.start,t.yValue,t.xValue+f.end,o,n)).height=n.columnWidthInPixel?n.columnWidthInPixel:i.height,i.y=n.columnWidthInPixel?i.y-(n.columnWidthInPixel/2*n.rectCount-n.columnWidthInPixel*n.index):i.y,(u=this.triggerEvent(n,t,n.interior,{width:n.border.width,color:n.border.color})).cancel||(this.updateSymbolLocation(t,i,n),this.drawRectangle(n,t,i,u)));this.renderMarker(n)},t.prototype.doAnimation=function(n){this.animate(n)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"BarSeries"},t}(wt),cp=(he=function(n,t){return(he=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}he(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),lp=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.visibleAxisLabelRect=[],t}return cp(t,n),t.prototype.measureAxis=function(n){var t=this.chart;this.initialClipRect=n;this.seriesClipRect=new sf.svgbase.Rect(n.x,n.y,n.width,n.height);this.measureRowAxis(t,this.initialClipRect);this.measureColumnAxis(t,this.initialClipRect);this.calculateAxisSize()},t.prototype.measureRowAxis=function(n,t){this.calculateRowSize(t);var i=n.rows[0];this.measureDefinition(i,n,new sf.svgbase.Size(n.availableSize.width,i.computedHeight))},t.prototype.measureColumnAxis=function(n,t){this.calculateColumnSize(t);var i=n.columns[0];this.measureDefinition(i,n,new sf.svgbase.Size(i.computedWidth,n.availableSize.height))},t.prototype.measureDefinition=function(n,t,i){for(var u,r=0,f=n.axes;r<f.length;r++)u=f[r],u.getModule(t),u.baseModule.calculateRangeAndInterval(i,u)},t.prototype.calculateAxisSize=function(){var n=this.chart;this.centerX=.5*this.initialClipRect.width+this.initialClipRect.x;this.centerY=.5*this.initialClipRect.height+this.initialClipRect.y;n.radius=Math.min(this.initialClipRect.width,this.initialClipRect.height)/2-5-n.primaryXAxis.majorTickLines.height-n.primaryXAxis.maxLabelSize.height;n.radius=n.primaryXAxis.coefficient*n.radius/100;this.seriesClipRect.y=this.centerY-n.radius;this.seriesClipRect.x=this.centerX-n.radius;this.seriesClipRect.height=2*n.radius;this.seriesClipRect.width=2*n.radius;this.calculateRowSize(this.seriesClipRect);n.primaryYAxis.rect=this.seriesClipRect;this.calculateColumnSize(this.seriesClipRect);n.primaryXAxis.rect=this.seriesClipRect},t.prototype.measure=function(){var n=this.chart,t,i;n.verticalAxes.push(n.primaryYAxis);t=n.rows[0];t.axes[0]=n.primaryYAxis;n.rows[0]=t;n.horizontalAxes.push(n.primaryXAxis);i=n.columns[0];i.axes[0]=n.primaryXAxis;n.columns[0]=i},t.prototype.calculateRowSize=function(n){
/*! Calculate row size */
var i=this.chart,t=i.rows[0];t.computedHeight=n.height/2;t.computedTop=n.y;i.rows[0]=t},t.prototype.calculateColumnSize=function(n){
/*! Calculate column size */
var i=this.chart,t=i.columns[0];t.computedLeft=n.x;t.computedWidth=n.width;i.columns[0]=t},t.prototype.renderAxes=function(){var n,t=this.chart;this.startAngle=t.primaryXAxis.startAngle;for(var r=t.renderer.createGroup({id:t.element.id+"AxisCollection"}),u=t.renderer.createGroup({id:t.element.id+"AxisOutsideCollection"}),i=0,f=t.axisCollections.length;i<f;i++)this.element=t.renderer.createGroup({id:t.element.id+"AxisGroup"+i}),"Horizontal"===(n=t.axisCollections[i]).orientation?((n.majorGridLines.width>0||n.majorTickLines.width>0)&&this.drawXAxisGridLine(n,i),n.visible&&n.internalVisibility&&this.drawXAxisLabels(n,i)):(this.drawYAxisGridLine(n,i),n.lineStyle.width>0&&this.drawYAxisLine(n,i),n.visible&&n.internalVisibility&&this.drawYAxisLabels(n,i)),r.appendChild(this.element);return r.appendChild(this.element),h(t.enableCanvas,t.svgObject,r,t.redraw),u},t.prototype.drawYAxisLine=function(n,t){var u,i=this.chart,f=st(ft(n.visibleLabels[0].value,n),this.startAngle),e="M "+this.centerX+" "+this.centerY+"L "+(this.centerX+i.radius*f.x)+" "+(this.centerY+i.radius*f.y),r;u={id:i.element.id+"AxisLine_"+t,d:e,"stroke-dasharray":n.lineStyle.dashArray,"stroke-width":n.lineStyle.width,stroke:n.lineStyle.color||i.themeStyle.axisLine};r=i.renderer.drawPath(u);this.setPointerEventNone(r);i.yAxisElements.appendChild(r)},t.prototype.drawYAxisLabels=function(n,t){var o,p,l,f,r=this.chart,v=0,s=0,w=this.startAngle<0?this.startAngle+360:this.startAngle,e=[],h=[],u,c,y,g;h[0]=!0;for(var nt=n.labelIntersectAction,b=r.renderer.createGroup({id:r.element.id+"AxisLabels"+t}),d=st(ft(n.visibleLabels[0].value,n),this.startAngle),i=0,tt=n.visibleLabels.length;i<tt;i++){if(f=!1,r.radius*a(n.visibleLabels[i].value,n),o=n.visibleLabels[i].size,l=r.radius*a(n.visibleLabels[i].value,n),v=this.centerX+l*d.x+(n.majorTickLines.height+o.width/2+2.5)*Math.cos(w*Math.PI/180)*("Inside"===n.labelPosition?1:-1),s=this.centerY+l*d.y+(n.majorTickLines.height+o.height/2)*Math.sin(w*Math.PI/180)*("Inside"===n.labelPosition?1:-1),s+=o.height/4,e[i]=this.getLabelRegion(v,s,n.visibleLabels[i],"middle"),0!==i&&"Hide"===nt){for(u=i;u>=0;u--){if(h[u=0===u?0:u===i?u-1:u]&&gi(e[i],e[u])){f=!0;h[i]=!1;break}h[i]=!0}if(f)continue;for(c=0,y=this.visibleAxisLabelRect;c<y.length;c++)if(g=y[c],gi(e[i],g)){f=!0;break}}f||(this.visibleAxisLabelRect.push(e[i]),p=new sf.svgbase.TextOption(r.element.id+t+"_AxisLabel_"+i,v,s,"middle",n.visibleLabels[i].text),k(r.renderer,p,n.labelStyle,n.labelStyle.color||r.themeStyle.axisLabel,b,!1,r.redraw,!0,!0,null,null,0,null,r.enableCanvas))}r.yAxisElements.appendChild(b)},t.prototype.drawYAxisGridLine=function(n,t){var o,f,y,p,w,e,c,i=this.chart,b="",v="",k=this.startAngle<0?this.startAngle+360:this.startAngle,d={color:n.majorGridLines.color||i.themeStyle.majorGridLine,width:n.majorGridLines.width},u,l;if(n.majorGridLines.width>0)if("Polar"===i.visibleSeries[0].type){for(u=0;u<n.visibleLabels.length;u++)e=(c=r(i.element.id+"_MajorGridLine_"+t+"_"+u))?c.getAttribute("r"):null,f=i.radius*a(n.visibleLabels[u].value,n),o=new si(i.element.id+"_MajorGridLine_"+t+"_"+u,"transparent",d,n.majorGridLines.width,this.centerX,this.centerY,f),h(i.enableCanvas,this.element,i.renderer.drawCircle(o),i.redraw,!0,"r","r",new s(+e,+e),null,!0);f!==i.radius&&(o=new si(i.element.id+"_MajorGridLine_"+t+"_"+n.visibleLabels.length+1,"transparent",d,n.majorGridLines.width,this.centerX,this.centerY,i.radius),h(i.enableCanvas,this.element,i.renderer.drawCircle(o),i.redraw,!0,"r","r",new s(+e,+e),null,!0))}else{for(u=0;u<n.visibleLabels.length;u++)f=i.radius*a(n.visibleLabels[u].value,n),v=this.renderRadarGrid(f,"",i),e=(c=r(i.element.id+"_MajorGridLine_"+t+"_"+u))?c.getAttribute("d"):null,o=new sf.svgbase.PathOption(i.element.id+"_MajorGridLine_"+t+"_"+u,"transparent",n.majorGridLines.width,n.majorGridLines.color||i.themeStyle.majorGridLine,null,null,v),h(i.enableCanvas,this.element,i.renderer.drawPath(o),i.redraw,!0,"x","y",null,e,!0);f!==i.radius&&(v=this.renderRadarGrid(i.radius,"",i),e=(c=r(i.element.id+"_MajorGridLine_"+t+"_"+n.visibleLabels.length))?c.getAttribute("d"):null,o=new sf.svgbase.PathOption(i.element.id+"_MajorGridLine_"+t+"_"+n.visibleLabels.length,"transparent",n.majorGridLines.width,n.majorGridLines.color||i.themeStyle.majorGridLine,null,null,v),h(i.enableCanvas,this.element,i.renderer.drawPath(o),i.redraw,!0,"x","y",null,e,!0))}if(n.majorTickLines.width>0)for(y=st(ft(n.visibleLabels[0].value,n),this.startAngle),l=0;l<n.visibleLabels.length;l++)f=i.radius*a(n.visibleLabels[l].value,n),b="M "+(p=this.centerX+f*y.x)+" "+(w=this.centerY+f*y.y)+" L "+(p+n.majorTickLines.height*Math.cos(k*Math.PI/180)*("Inside"===n.tickPosition?1:-1))+" "+(w+n.majorTickLines.height*Math.sin(k*Math.PI/180)*("Inside"===n.tickPosition?1:-1)),this.renderTickLine(n,t,b,"",l)},t.prototype.renderRadarGrid=function(n,t,i){for(var u,f,e,o,s,h,r=0,c=i.primaryXAxis.visibleLabels.length;r<c;r++)u=st(ft(i.primaryXAxis.visibleLabels[r].value,i.primaryXAxis),this.startAngle),f=st(ft(r+1<c?i.primaryXAxis.visibleLabels[r+1].value:i.primaryXAxis.visibleLabels[0].value,i.primaryXAxis),this.startAngle),e=this.centerX+n*u.x,o=this.centerY+n*u.y,s=this.centerX+n*f.x,h=this.centerY+n*f.y,t=t.concat((r?"L ":"M ")+" "+e+" "+o+" L  "+s+" "+h+" ");return t},t.prototype.drawXAxisGridLine=function(n,t){for(var h,r,u,f,c,e=this.chart,l="",a="",o="",s="",v=this.centerX,y=this.centerY,p=n.visibleLabels.length,i=0;i<p;i++)h=n.visibleLabels[i].value,r=st(ft(n.visibleLabels[i].value,n),this.startAngle),l="M "+v+" "+y+" L "+(u=this.centerX+e.radius*r.x)+" "+(f=this.centerY+e.radius*r.y),a="M "+u+" "+f+" L "+(u+n.majorTickLines.height*r.x*("Inside"===n.tickPosition?-1:1))+" "+(f+n.majorTickLines.height*r.y*("Inside"===n.tickPosition?-1:1)),n.minorTicksPerInterval>0&&(n.minorGridLines.width>0||n.minorTickLines.width>0)&&"Category"!==n.valueType&&"Radar"!==e.visibleSeries[0].type&&(o=(c=this.drawAxisMinorLine(n,h,o,s))[0],s=c[1]),this.renderTickLine(n,t,a,s,i),this.renderGridLine(n,t,l,o,i)},t.prototype.drawAxisMinorLine=function(n,t,i,r){for(var c,l,f,e,u,s=t,a=n.visibleRange,o=[],h=0;h<n.minorTicksPerInterval;h++)ai(s+=("DateTime"===n.valueType?n.dateTimeInterval:n.visibleRange.interval)/(n.minorTicksPerInterval+1),a)&&(u=st(ft(s,n),this.startAngle),f=this.centerX+this.chart.radius*u.x,e=this.centerY+this.chart.radius*u.y,c=f+n.minorTickLines.height*u.x*("Inside"===n.tickPosition?-1:1),l=e+n.minorTickLines.height*u.y*("Inside"===n.tickPosition?-1:1),i=i.concat("M "+this.centerX+" "+this.centerY+"L "+f+" "+e),r=r.concat("M "+f+" "+e+"L "+c+" "+l));return o.push(i),o.push(r),o},t.prototype.drawXAxisLabels=function(n,t){var y,i,ct,e,it;this.visibleAxisLabelRect=[];this.chart.legendModule&&(y=this.chart.legendModule.legendBounds);var rt,a,u,ut,et,h,c,f=this.chart,r=0,b=0,ot=f.renderer.createGroup({id:f.element.id+"AxisLabels"+t}),d="Inside"===n.labelPosition,g="",l=[],p=[];p[0]=!0;var ht=n.labelIntersectAction,yt="Category"===n.valueType&&"BetweenTicks"===n.labelPlacement?.5:0,v=f.radius+n.majorTickLines.height;for(v=d?-v:v,i=0,ct=n.visibleLabels.length;i<ct;i++){if(c=!1,a=st(ft(n.visibleLabels[i].value+yt,n),this.startAngle),isNaN(a.x)||isNaN(a.y)||(r=this.centerX+(v+n.majorTickLines.height+5)*a.x,b=this.centerY+(v+n.majorTickLines.height+5)*a.y,g=parseFloat(r.toFixed(1))===parseFloat(this.centerX.toFixed(1))?"middle":r<this.centerX&&!d||r>this.centerX&&d?"end":"start"),u=(h=n.visibleLabels[i]).text,n.enableTrim||"Trim"===ht)for(var nt=n.visibleLabels[i].originalText,tt=void 0,o=void 0,lt=n.labelPosition,s=f.availableSize.width,vt=nt.length,w=vt-1;w>=0;--w)if(tt=nt.substring(0,w)+"...",o=sf.svgbase.measureText(tt,n.labelStyle).width,r===s/2?r-o/2>=0&&r+o/2<=s:"Outside"===lt&&(r>=s/2&&r+o<=s||r<=s/2&&r-o>=0)||"Inside"===lt&&(r+o<=s/2||r-o>=s/2)){u=w===vt-1?nt:tt;h.size.width=sf.svgbase.measureText(u,n.labelStyle).width;h.text=u;break}if(l[i]=this.getLabelRegion(r,b,h,g),0===i?ut=r:i===n.visibleLabels.length-1&&"Category"!==n.valueType&&(et=sf.svgbase.measureText(u,n.labelStyle).height,u=(et+=r)>ut?"":u),0!==i&&"Hide"===ht)for(e=i;e>=0;e--){if(p[e=0===e?0:e===i?e-1:e]&&gi(l[i],l[e])){c=!0;p[i]=!1;break}p[i]=!0}!c&&y&&(c=gi(l[i],y))&&(it=this.getAvailableSpaceToTrim(y,l[i]),it>0&&(u=at(it,n.visibleLabels[i].originalText,n.labelStyle),c=!1));rt=new sf.svgbase.TextOption(f.element.id+t+"_AxisLabel_"+i,r,b,g,u,"","central");c||(this.visibleAxisLabelRect.push(l[i]),k(f.renderer,rt,h.labelStyle,h.labelStyle.color||f.themeStyle.axisLabel,ot,!1,f.redraw,!0,!0,null,null,0,null,f.enableCanvas))}this.element.appendChild(ot)},t.prototype.getAvailableSpaceToTrim=function(n,t){var i=n.x,u=i+n.width,r=t.x,f=r+t.width,e=0;return r>i&&r<u&&f>u?e=f-u:r>i&&r<u&&f<u?e=0:(f>i&&f<u&&r<i||f>i&&f>u&&r<i)&&(e=i-r),e},t.prototype.getLabelRegion=function(n,t,i,r){return"middle"===r?n-=i.size.width/2:"end"===r?n-=i.size.width:n=n,t-=i.size.height/2,new sf.svgbase.Rect(n,t,i.size.width,i.size.height)},t.prototype.renderTickLine=function(n,t,i,u,f){var s,c,o,e=this.chart;n.majorTickLines.width>0&&(c=(o=r(e.element.id+"_MajorTickLine_"+t+"_"+f))?o.getAttribute("d"):null,s=new sf.svgbase.PathOption(e.element.id+"_MajorTickLine_"+t+"_"+f,"transparent",n.majorTickLines.width,n.majorTickLines.color||e.themeStyle.majorTickLine,null,null,i),o=e.renderer.drawPath(s),this.setPointerEventNone(o),h(e.enableCanvas,e.yAxisElements,o,e.redraw,!0,"x","y",null,c));n.minorTickLines.width>0&&(c=(o=r(e.element.id+"_MinorTickLine_"+t+"_"+f))?o.getAttribute("d"):null,s=new sf.svgbase.PathOption(e.element.id+"_MinorTickLine_"+t+"_"+f,"transparent",n.minorTickLines.width,n.minorTickLines.color||e.themeStyle.minorTickLine,null,null,u),o=e.renderer.drawPath(s),this.setPointerEventNone(o),h(e.enableCanvas,e.yAxisElements,o,e.redraw,!0,"x","y",null,c))},t.prototype.renderGridLine=function(n,t,i,u,f){var o,s,c,e=this.chart;n.majorGridLines.width>0&&(s=(c=r(e.element.id+"_MajorGridLine_"+t+"_"+f))?c.getAttribute("d"):null,o=new sf.svgbase.PathOption(e.element.id+"_MajorGridLine_"+t+"_"+f,"transparent",n.majorGridLines.width,n.majorGridLines.color||e.themeStyle.majorGridLine,null,n.majorGridLines.dashArray,i),h(e.enableCanvas,this.element,e.renderer.drawPath(o),e.redraw,!0,"x","y",null,s));n.minorGridLines.width>0&&(s=(c=r(e.element.id+"_MinorGridLine_"+t+"_"+f))?c.getAttribute("d"):null,o=new sf.svgbase.PathOption(e.element.id+"_MinorGridLine_"+t+"_"+f,"transparent",n.minorGridLines.width,n.minorGridLines.color||e.themeStyle.minorGridLine,null,n.minorGridLines.dashArray,u),h(e.enableCanvas,this.element,e.renderer.drawPath(o),e.redraw,!0,"x","y",null,s))},t.prototype.setPointerEventNone=function(n){n&&n.setAttribute("style","pointer-events:none")},t}(pt),ap=(ce=function(n,t){return(ce=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ce(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ws=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ap(t,n),t.prototype.render=function(n,t,i,r){for(var u,h=tt(n.drawType),e=i.minimum,o=i.maximum,f=0,s=n.points;f<s.length;f++)u=s[f],u.visible=u.visible&&!(!sf.base.isNullOrUndefined(e)&&u.yValue<e||!sf.base.isNullOrUndefined(o)&&u.yValue>o);n.points.length&&(n.drawType.indexOf("Column")>-1?this.columnDrawTypeRender(n,t,i):n.chart[h+"SeriesModule"].render(n,t,i,r))},t.prototype.columnDrawTypeRender=function(n,t,i){var ct,l,u,f,v,o,lt,at,w,k,d,g,y,e,s,tt,it,rt,ut,st,vt=t.actualRange.min,h=n.clipRect.width/2+n.clipRect.x,c=n.clipRect.height/2+n.clipRect.y,p="RangeColumn"===n.drawType,yt="Polar"===n.type,kt="Logarithmic"===i.valueType,dt="StackingColumn"===n.drawType,pt="",ft=0,et=(n.points[1]?n.points[1].xValue:2*n.points[0].xValue)-n.points[0].xValue,gt="Category"===t.valueType&&"BetweenTicks"===t.labelPlacement?0:t.isInversed?-et/2:et/2,wt="DateTime"===t.valueType?t.dateTimeInterval:1,bt,ot,ht,r;this.getSeriesPosition(n);bt=t.isInversed?n.rectCount-1-n.position:n.position;do ft+=wt,vt+=wt;while(vt<=t.actualRange.max-("Category"===t.valueType?0:1));for(ot=0,ht=n.points;ot<ht.length;ot++)r=ht[ot],r.symbolLocations=[],r.regions=[],r.visible&&b(n.points[r.index-1],r,n.points[r.index+1],n)&&(v=(t.isInversed?t.visibleRange.max-r.xValue:r.xValue-t.visibleRange.min)+(et/n.rectCount*bt-gt)+ft/360*t.startAngle,v/=ft,u=2*Math.PI*(v+t.startAngle),f=2*Math.PI*(v+t.startAngle+et/n.rectCount/ft),0===u&&0===f?(f=2*Math.PI,st="1"):st="0",lt=u,at=f,u=u-.5*Math.PI+n.columnSpacing/2,f=f-.5*Math.PI-1e-6-n.columnSpacing/2,dt||p?(y=p?r.low:n.stackedValues.startValues[r.index],e=p?r.high:n.stackedValues.endValues[r.index],e=(e=kt?nt(0===e?1:e,i.logBase):e)>i.actualRange.max?i.actualRange.max:e):(y=i.visibleRange.min,e=r.yValue>i.actualRange.max?i.actualRange.max:r.yValue),w=h+(o=y===e?0:n.chart.radius*a(e,i))*Math.cos(u),k=h+o*Math.cos(f),d=c+o*Math.sin(u),g=c+o*Math.sin(f),tt=h+(s=n.chart.radius*a(0===y&&0!==i.visibleRange.min?i.visibleRange.min:y,i))*Math.cos(u),it=c+s*Math.sin(u),rt=h+s*Math.cos(f),ut=c+s*Math.sin(f),pt=yt?"M "+w+" "+d+" A "+o+" "+o+" 0 "+st+" 1 "+k+" "+g+" L "+rt+" "+ut+" A "+s+" "+s+" 1 0 0 "+tt+" "+it+" Z":"M "+w+" "+d+" L "+k+" "+g+" L "+rt+" "+ut+" L "+tt+" "+it+" Z",r.regionData=new bu(lt,at,s,o,v),l=this.triggerEvent(n.chart,n,r),ct=new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index+"_Point_"+r.index,l.fill,l.border.width,l.border.color,n.opacity,n.dashArray,pt),l.cancel||(this.appendLinePath(ct,n,""),yt?(r.symbolLocations.push({x:h+o*Math.cos(u+(f-u)/2),y:c+o*Math.sin(u+(f-u)/2)}),p&&r.symbolLocations.push({x:h+s*Math.cos(u+(f-u)/2),y:c+s*Math.sin(u+(f-u)/2)})):(r.symbolLocations.push({x:(w+k)/2,y:(d+g)/2}),p&&r.symbolLocations.push({x:(rt+tt)/2,y:(ut+it)/2}))));this.renderMarker(n);n.isRectSeries=!0},t.prototype.triggerEvent=function(n,t,i){var r={cancel:!1,name:"pointRender",series:t,point:i,fill:t.setPointColor(i,t.interior),border:t.setBorderColor(i,{width:t.border.width,color:t.border.color})};return n.trigger("pointRender",r),i.color=r.fill,r},t.prototype.getSeriesPosition=function(n){for(var u,r,t,f=[],e=[],i={rectCount:0,position:null},o=0,s=n.chart.visibleSeries;o<s.length;o++)u=s[o],u.visible&&("Polar"===u.type||"Radar"===u.type)&&-1!==u.drawType.indexOf("Column")&&f.push(u);for(r=0;r<f.length;r++)t=f[r],-1!==t.drawType.indexOf("Stacking")?t.stackingGroup?void 0===e[t.stackingGroup]?(t.position=i.rectCount,e[t.stackingGroup]=i.rectCount++):t.position=e[t.stackingGroup]:null===i.position?(t.position=i.rectCount,i.position=i.rectCount++):t.position=i.position:t.position=i.rectCount++;for(r=0;r<f.length;r++)f[r].rectCount=i.rectCount},t.prototype.doAnimation=function(n){var e=n.animation.duration,o=n.animation.delay,i=n.seriesElement.childNodes,t=1,r,f,u;if("Scatter"===n.drawType)for(r=0,f=n.points;r<f.length;r++)u=f[r],u.symbolLocations.length&&i[t]&&(oi(i[t],o,e,n,u.index,u.symbolLocations[0],!1),t++);else for(t=1;t<i.length;t++)this.doPolarRadarAnimation(i[t],o,e,n)},t.prototype.doPolarRadarAnimation=function(n,t,i,r){var u=r.clipRect.width/2+r.clipRect.x,f=r.clipRect.height/2+r.clipRect.y,e=0;n.style.visibility="hidden";new sf.base.Animation({}).animate(n,{duration:i,delay:t,progress:function(t){t.timeStamp>t.delay&&(t.element.style.visibility="visible",e=(t.timeStamp-t.delay)/t.duration,n.setAttribute("transform","translate("+u+" "+f+") scale("+e+") translate("+-u+" "+-f+")"))},end:function(){n.style.visibility="visible";n.removeAttribute("transform");r.chart.trigger("animationComplete",{series:r.chart.isBlazor?{}:r})}})},t.prototype.getPolarIsInversedPath=function(n,t){var r,u,f,i=this.chart.radius,o=t,e=n.isInversed?"1 1 ":"1 0 ";return r=st(ft(n.visibleLabels[0].value,n),this.startAngle),o+"L "+(u=this.centerX+i*r.x)+" "+(f=this.centerY+i*r.y)+" A "+i+" "+i+" 0 "+e+u+" "+(this.centerY+i)+" A "+i+" "+i+" 0 "+e+u+" "+f+" "},t.prototype.getModuleName=function(){return"PolarSeries"},t.prototype.destroy=function(){},t}(lp),vp=(le=function(n,t){return(le=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}le(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ia=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return vp(t,n),t.prototype.render=function(n,t,i,r){for(var u,h=tt(n.drawType),e=i.minimum,o=i.maximum,f=0,s=n.points;f<s.length;f++)u=s[f],u.visible=u.visible&&!(!sf.base.isNullOrUndefined(e)&&u.yValue<e||!sf.base.isNullOrUndefined(o)&&u.yValue>o);n.points.length&&(-1===n.drawType.indexOf("Column")?n.chart[h+"SeriesModule"].render(n,t,i,r):this.columnDrawTypeRender(n,t,i))},t.prototype.getRadarIsInversedPath=function(n,t){var r,i,u=this.chart.radius,o=n.visibleLabels.length,e=t,f;for(i=st(ft(n.visibleLabels[0].value,n),this.startAngle),r=this.centerY+u*i.y,e+=" L "+(this.centerX+u*i.x)+" "+r+" ",f=o-1;f>=0;f--)i=st(ft(n.visibleLabels[f].value,n),this.startAngle),r=this.centerY+u*i.y,e+="L "+(this.centerX+u*i.x)+" "+r+" ";return e},t.prototype.getModuleName=function(){return"RadarSeries"},t.prototype.destroy=function(){},t}(ws),yp=(ae=function(n,t){return(ae=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ae(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ra=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return yp(t,n),t.prototype.render=function(n){for(var t,i,u,f=this.getSideBySideInfo(n),e=n.stackedValues,r=0,o=n.points;r<o.length;r++)t=o[r],t.symbolLocations=[],t.regions=[],t.visible&&b(n.points[t.index-1],t,n.points[t.index+1],n)&&((i=this.getRectangle(t.xValue+f.start,e.endValues[t.index],t.xValue+f.end,e.startValues[t.index],n)).height=n.columnWidthInPixel?n.columnWidthInPixel:i.height,i.y=n.columnWidthInPixel?i.y-n.columnWidthInPixel/2:i.y,(u=this.triggerEvent(n,t,n.interior,{width:n.border.width,color:n.border.color})).cancel||(this.drawRectangle(n,t,i,u),this.updateSymbolLocation(t,i,n)));this.renderMarker(n)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingBarSeries"},t.prototype.doAnimation=function(n){this.animate(n)},t}(wt),pp=(ve=function(n,t){return(ve=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ve(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ua=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return pp(t,n),t.prototype.render=function(n){for(var o,r=this.getSideBySideInfo(n),u=Math.max(n.border.width,1),e=0,s=n.points;e<s.length;e++){var t=s[e],h="",f=void 0,i=void 0;t.regions=[];t.symbolLocations=[];t.visible&&b(n.points[t.index-1],t,n.points[t.index+1],n)&&(i=this.getRectangle(t.xValue+r.median,Math.max(t.high,t.low),t.xValue+r.median,Math.min(t.high,t.low),n),n.chart.requireInvertedAxis?(i.y-=u/2,i.height=u):(i.x-=u/2,i.width=u),f=this.getRectangle(t.xValue+r.start,Math.max(t.open,t.close),t.xValue+r.end,Math.min(t.open,t.close),n),h=this.getPathString(i,f,n),(o=this.triggerPointRenderEvent(n,t)).cancel||(this.drawCandle(n,t,f,o,h),this.updateSymbolLocation(t,i,n),this.updateSymbolLocation(t,f,n)))}},t.prototype.triggerPointRenderEvent=function(n,t){var i=this.getCandleColor(t,n),r={color:n.border.color,width:Math.max(n.border.width,1)};return this.triggerEvent(n,t,i,r)},t.prototype.getCandleColor=function(n,t){var i=t.points[n.index-1];return!1===t.enableSolidCandles?i&&i.close>n.close?t.bullFillColor:t.bearFillColor:n.open>n.close?t.bullFillColor:t.bearFillColor},t.prototype.getPathString=function(n,t,i){var u="",r=i.chart.requireInvertedAxis?n.y+n.height/2:n.x+n.width/2;return u=(u+=i.chart.requireInvertedAxis?"M "+n.x+" "+r+" L "+t.x+" "+r:"M "+r+" "+n.y+" L "+r+" "+t.y).concat(" M "+t.x+" "+t.y+" L "+(t.x+t.width)+" "+t.y+" L "+(t.x+t.width)+" "+(t.y+t.height)+" L "+t.x+" "+(t.y+t.height)+" Z"),u+(i.chart.requireInvertedAxis?" M "+(t.x+t.width)+" "+r+" L "+(n.x+n.width)+" "+r:" M "+r+" "+(t.y+t.height)+" L "+r+" "+(n.y+n.height))},t.prototype.drawCandle=function(n,t,i,u,f){var o;if((n.chart.requireInvertedAxis?i.height:i.width)<=0)return null;o=n.enableSolidCandles||t.open>t.close?u.fill:"transparent";u.border.color=u.fill;var s=new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index+"_Point_"+t.index,o,u.border.width,u.border.color,n.opacity,n.dashArray,f),e=r(s.id),c=e?e.getAttribute("d"):null,h=n.chart.renderer.drawPath(s,new Int32Array([n.clipRect.x,n.clipRect.y]));h.setAttribute("aria-label",t.x.toString()+":"+t.high.toString()+":"+t.low.toString()+":"+t.close.toString()+":"+t.open.toString());n.chart.enableCanvas||n.seriesElement.appendChild(h);ii(e,f,n.chart.redraw,c)},t.prototype.doAnimation=function(n){this.animate(n)},t.prototype.getModuleName=function(){return"CandleSeries"},t.prototype.destroy=function(){},t}(wt),wp=(ye=function(n,t){return(ye=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ye(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),fa=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return wp(t,n),t.prototype.render=function(n){var t;n.isRectSeries=!0;for(var i,f,e=this.getSideBySideInfo(n),o=n.stackedValues,r=fi(n),u=0,s=r;u<s.length;u++)t=s[u],t.symbolLocations=[],t.regions=[],t.visible&&b(r[t.index-1],t,r[t.index+1],n)&&((i=this.getRectangle(t.xValue+e.start,o.endValues[t.index],t.xValue+e.end,o.startValues[t.index],n)).width=n.columnWidthInPixel?n.columnWidthInPixel:i.width,i.x=n.columnWidthInPixel?i.x-n.columnWidthInPixel/2:i.x,(f=this.triggerEvent(n,t,n.interior,{width:n.border.width,color:n.border.color})).cancel||(this.drawRectangle(n,t,i,f),this.updateSymbolLocation(t,i,n)));this.renderMarker(n)},t.prototype.doAnimation=function(n){this.animate(n)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingColumnSeries"},t}(wt),bp=(pe=function(n,t){return(pe=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}pe(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ea=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return bp(t,n),t.prototype.render=function(n,t,i,r){var v,f,l,s="",h="M",c=null,o=this.enableComplexProperty(n),a,y,u,p;for(v="Category"===t.valueType&&"BetweenTicks"===t.labelPlacement?.5:0,a=0,y=o;a<y.length;a++)u=y[a],u.symbolLocations=[],u.regions=[],u.visible&&b(o[u.index-1],u,o[u.index+1],n)?(null!=c?(l=e(u.xValue,u.yValue,t,i,r),f=e(c.xValue,c.yValue,t,i,r),s=s.concat(h+" "+f.x+" "+f.y+" L "+l.x+" "+f.y+" L "+l.x+" "+l.y+" "),h="L"):(f=e(u.xValue-v,u.yValue,t,i,r),s=s.concat(h+" "+f.x+" "+f.y+" "),h="L"),this.storePointLocation(u,n,r,e),c=u):(c="Drop"===n.emptyPointSettings.mode?c:null,h="Drop"===n.emptyPointSettings.mode?h:"M");o.length>0&&(f=e(o[o.length-1].xValue+v,o[o.length-1].yValue,t,i,r),s=s.concat(h+" "+f.x+" "+f.y+" "));p=new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index,"transparent",n.width,n.interior,n.opacity,n.dashArray,s);this.appendLinePath(p,n,"");this.renderMarker(n)},t.prototype.doAnimation=function(n){var t=n.animation;this.doLinearAnimation(n,t)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StepLineSeries"},t}(pt),kp=(we=function(n,t){return(we=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}we(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),oa=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return kp(t,n),t.prototype.render=function(n,t,i,r){for(var u,a,f,y,l=null,o="",h=this.enableComplexProperty(n),p=h.length,k=Math.max(n.yAxis.visibleRange.min,0),w=null,d,v="Category"===t.valueType&&"BetweenTicks"===t.labelPlacement?.5:0,c=0;c<p;c++)y=(f=h[c]).xValue,f.symbolLocations=[],f.regions=[],f.visible&&b(h[c-1],f,h[c+1],n)&&(null===l&&(l=new s(y,0),o+="M "+(u=e(y-v,k,t,i,r)).x+" "+u.y+" ",o+="L "+(u=e(y-v,f.yValue,t,i,r)).x+" "+u.y+" "),null!=w?(u=e(f.xValue,f.yValue,t,i,r),a=e(w.xValue,w.yValue,t,i,r),o+="L "+u.x+" "+a.y+" L "+u.x+" "+u.y+" "):"Gap"===n.emptyPointSettings.mode&&(o+="L "+(u=e(f.xValue,f.yValue,t,i,r)).x+" "+u.y+" "),this.storePointLocation(f,n,r,e),w=f),h[c+1]&&!h[c+1].visible&&"Drop"!==n.emptyPointSettings.mode&&(o+="L "+(u=e(y+v,k,t,i,r)).x+" "+u.y,l=null,w=null);p>1&&""!==o?(o+="L "+(a=e((l={x:h[p-1].xValue+v,y:h[p-1].yValue}).x,l.y,t,i,r)).x+" "+a.y+" ",o+="L "+(a=e((l={x:h[p-1].xValue+v,y:k}).x,l.y,t,i,r)).x+" "+a.y+" "):o="";d=new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index,n.interior,n.border.width,n.border.color,n.opacity,n.dashArray,o);this.appendLinePath(d,n,"");this.renderMarker(n)},t.prototype.doAnimation=function(n){var t=n.animation;this.doLinearAnimation(n,t)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StepAreaSeries"},t}(pt),dp=(be=function(n,t){return(be=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}be(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),sa=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return dp(t,n),t.prototype.render=function(n,t,i,r){var h,c,p="PolarRadar"===n.chart.chartAreaType,a=p?ei:e,o="",f=this.enableComplexProperty(n),y=f.length,l=n.stackedValues,tt=p?Math.max(n.yAxis.visibleRange.min,l.endValues[0]):Math.max(n.yAxis.visibleRange.min,l.startValues[0]),w=0,v,u,s,k,d,g,nt;for(y>0&&(h=a(f[0].xValue,tt,t,i,r,n),o=o.concat("M "+h.x+" "+h.y+" ")),v=n.chart&&"PolarRadar"===n.chart.chartAreaType,u=0;u<y;u++)if(f[u].symbolLocations=[],f[u].regions=[],f[u].visible&&b(f[u-1],f[u],f[u+1],n))h=a(f[u].xValue,l.endValues[u],t,i,r,n),o=o.concat("L "+h.x+" "+h.y+" "),f[u].symbolLocations.push(a(f[u].xValue,l.endValues[u],t,i,r,n)),f[u].regions.push(new sf.svgbase.Rect(f[u].symbolLocations[0].x-n.marker.width,f[u].symbolLocations[0].y-n.marker.height,2*n.marker.width,2*n.marker.height));else if(!v&&"Drop"!==n.emptyPointSettings.mode){for(s=u-1;s>=w;s--)c=a(f[s].xValue,l.startValues[s],t,i,r,n),o=o.concat("L "+c.x+" "+c.y+" ");f[u+1]&&f[u+1].visible&&(!v||v&&this.withinYRange(f[u+1],i))&&(h=a(f[u+1].xValue,l.startValues[u+1],t,i,r,n),o=o.concat("M "+h.x+" "+h.y+" "));w=u+1}if("PolarRadar"===n.chart.chartAreaType&&f.length>1&&(k=this.getFirstLastVisiblePoint(n.points),d=this.chart,o+="L "+(c=a((h={x:k.first.xValue,y:l.endValues[k.first.index]}).x,h.y,t,i,r,n)).x+" "+c.y+" ",1===this.chart.visible&&(t.isInversed||i.isInversed)&&(this.chart.enableAnimation=!1,o="Polar"===n.type?d.polarSeriesModule.getPolarIsInversedPath(t,o):d.radarSeriesModule.getRadarIsInversedPath(t,o))),!v||v&&n.index!==this.getFirstSeriesIndex(n.chart.visibleSeries))for(s=y-1;s>=w;s--)(!v||f[s].visible)&&(g=this.getPreviousSeries(n),"Drop"===g.emptyPointSettings.mode&&g.points[s].isEmpty||(c=a(f[s].xValue,l.startValues[s],t,i,r,n),l.startValues[s]===l.endValues[s]&&(c.y=Math.floor(c.y)),o=o.concat((s===y-1&&p?"M":"L")+" "+c.x+" "+c.y+" ")));nt=new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index,n.interior,n.border.width,n.border.color,n.opacity,n.dashArray,o);this.appendLinePath(nt,n,"");this.renderMarker(n)},t.prototype.doAnimation=function(n){var t=n.animation;this.doLinearAnimation(n,t)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingAreaSeries"},t.prototype.getPreviousSeries=function(n){for(var i=n.chart.visibleSeries,t=0,r=i.length;t<r;t++)if(n.index===i[t].index&&0!==t)return i[t-1];return i[0]},t.prototype.getFirstSeriesIndex=function(n){for(var r,t=0,i=n;t<i.length;t++)if(r=i[t],r.visible)return r.index;return 0},t}(pt),gp=(ke=function(n,t){return(ke=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ke(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ha=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return gp(t,n),t.prototype.render=function(n,t,i,r){for(var h,p,ut,v,tt,ft,it,et,f,y=null,l="",c=n.stackedValues,u=this.enableComplexProperty(n),ot=Math.max(n.yAxis.visibleRange.min,c.startValues[0]),w=u.length,d=null,rt=0,g,o,nt,k="Category"===t.valueType&&"BetweenTicks"===t.labelPlacement?.5:0,a=0;a<w;a++)if(it=(v=u[a]).xValue,v.symbolLocations=[],v.regions=[],f=v.index,v.visible&&b(u[a-1],v,u[a+1],n)&&(null===y&&(y=new s(it,0),l+="M "+(h=e(it-k,ot,t,i,r)).x+" "+h.y+" ",l+="L "+(h=e(it-k,c.endValues[f],t,i,r)).x+" "+h.y+" "),null!=d?(h=e(v.xValue,c.endValues[f],t,i,r),p=e(d.xValue,c.endValues[d.index],t,i,r),l+="L "+h.x+" "+p.y+" L "+h.x+" "+h.y+" "):"Gap"===n.emptyPointSettings.mode&&(l+="L "+(h=e(v.xValue,c.endValues[f],t,i,r)).x+" "+h.y+" "),u[a].symbolLocations.push(e(u[a].xValue,c.endValues[f],t,i,r)),u[a].regions.push(new sf.svgbase.Rect(u[a].symbolLocations[0].x-n.marker.width,u[a].symbolLocations[0].y-n.marker.height,2*n.marker.width,2*n.marker.height)),d=v),u[a+1]&&!u[a+1].visible&&"Drop"!==n.emptyPointSettings.mode){for(g=void 0,o=a;o>=rt;o--)f=u[o].index,g=0===o?0:u[o-1].index,0!==o&&(c.startValues[f]<c.startValues[g]||c.startValues[f]>c.startValues[g])?(h=e(u[f].xValue,c.startValues[f],t,i,r),l=l.concat("L "+h.x+" "+h.y+" "),h=e(u[f].xValue,c.startValues[g],t,i,r)):h=e(u[f].xValue,c.startValues[f],t,i,r),l=l.concat("L "+h.x+" "+h.y+" ");rt=a+1;y=null;d=null}if(""!==l){for(w>1&&(f=u[w-1].index,l+="L "+(p=e((y={x:u[w-1].xValue+k,y:c.endValues[f]}).x,y.y,t,i,r)).x+" "+p.y+" ",l+="L "+(p=e((y={x:u[w-1].xValue+k,y:c.startValues[f]}).x,y.y,t,i,r)).x+" "+p.y+" "),o=w-1;o>=rt;o--)nt=void 0,u[o].visible&&(f=u[o].index,tt=e(u[o].xValue,c.startValues[f],t,i,r),l=l.concat("L "+tt.x+" "+tt.y+" ")),0===o||u[o-1].visible||(nt=this.getNextVisiblePointIndex(u,o)),0!==o&&(et=nt||o-1,f=nt?u[nt].index:u[o-1].index,ft=e(u[et].xValue,c.startValues[f],t,i,r),l=l.concat("L "+tt.x+" "+ft.y+" "));ut=new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index,n.interior,n.border.width,n.border.color,n.opacity,n.dashArray,l);this.appendLinePath(ut,n,"");this.renderMarker(n)}},t.prototype.doAnimation=function(n){var t=n.animation;this.doLinearAnimation(n,t)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingStepAreaSeries"},t.prototype.getNextVisiblePointIndex=function(n,t){for(var i=t-1;i>=0;i--)if(n[i].visible)return i;return 0},t}(pt),nw=(de=function(n,t){return(de=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}de(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ca=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return nw(t,n),t.prototype.render=function(n,t,i,r){for(var a,o,l,h="PolarRadar"===n.chart.chartAreaType?ei:e,s="",f=this.enableComplexProperty(n),v=f.length,c=n.stackedValues,u=0;u<v;u++)f[u].regions=[],f[u].symbolLocations=[],f[u].visible&&b(f[u-1],f[u],f[u+1],n)?(o=h(f[u].xValue,c.endValues[u],t,i,r,n),s=s.concat((u?"L":"M")+" "+o.x+" "+o.y+" "),f[u].symbolLocations.push(h(f[u].xValue,c.endValues[u],t,i,r,n)),f[u].regions.push(new sf.svgbase.Rect(f[u].symbolLocations[0].x-n.marker.width,f[u].symbolLocations[0].y-n.marker.height,2*n.marker.width,2*n.marker.height))):"Drop"!==n.emptyPointSettings.mode&&f[u+1]&&f[u+1].visible&&(o=h(f[u+1].xValue,c.endValues[u+1],t,i,r,n),s=s.concat("M "+o.x+" "+o.y+" "));"PolarRadar"===n.chart.chartAreaType&&f.length>1&&(s+="L "+(l=h((o={y:c.endValues[0],x:n.points[0].xValue}).x,o.y,t,i,r,n)).x+" "+l.y+" ");a=new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index,"none",n.width,n.interior,n.opacity,n.dashArray,s);this.appendLinePath(a,n,"");this.renderMarker(n)},t.prototype.doAnimation=function(n){var t=n.animation;this.doLinearAnimation(n,t)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingLineSeries"},t}(pt),la=function(){function n(){}return n.prototype.render=function(n,t,i,r){var u;n.isRectSeries=!1;for(var f,c,o=n.marker,s=this.enableComplexProperty(n),a="PolarRadar"===n.chart.chartAreaType?ei:e,v=n.chart.redraw,h=0,l=s;h<l.length;h++)u=l[h],c=v&&u.symbolLocations?u.symbolLocations[0]:null,u.symbolLocations=[],u.regions=[],u.visible&&b(s[u.index-1],u,s[u.index+1],n)&&(f={cancel:!1,name:"pointRender",series:n,point:u,fill:n.setPointColor(u,n.interior),border:n.setBorderColor(u,{width:n.border.width,color:n.border.color}),height:o.height,width:o.width,shape:o.shape},n.chart.trigger("pointRender",f),f.cancel?u.marker={visible:!0}:(u.symbolLocations.push(a(u.xValue,u.yValue,t,i,r,n)),u.color=f.fill,this.refresh(n,u,f,c)))},n.prototype.enableComplexProperty=function(n){for(var t,u,r,l=[],f=[],a=n.yAxis.visibleRange,v=n.xAxis.visibleRange,y=n.clipRect,i=n.points,e=Math.abs(a.delta/y.height),o=Math.abs(v.delta/y.width),p=i[0]&&i[0].y>e?0:e,w=i[0]&&i[0].x>o?0:o,s=0,h=0,c=0,b=i;c<b.length;c++)t=b[c],t.symbolLocations=[],s=t.yValue?t.yValue:a.min,h=t.xValue?t.xValue:v.min,(Math.abs(p-s)>=e||Math.abs(w-h)>=o)&&(f.push(t),p=s,w=h);for(u=0;u<f.length;u++)r=f[u],sf.base.isNullOrUndefined(r.x)||""===r.x||l.push(r);return l},n.prototype.refresh=function(n,t,i,u){var e,c,o=n.chart,f=n.marker,l=i.point.marker.imageUrl||f.imageUrl,s=new sf.svgbase.PathOption(o.element.id+"_Series_"+n.index+"_Point_"+t.index,i.fill,i.border.width,i.border.color,n.opacity,null);o.redraw&&r(s.id)&&(e="Circle"===i.shape?"c":"",c=r(s.id).getAttribute("d"));h(!1,n.seriesElement,rt(t.symbolLocations[0],i.shape,new sf.svgbase.Size(i.width,i.height),l,s,(t.x.toString(),t.yValue.toString()),n.chart.svgRenderer,n.clipRect),o.redraw,!0,e+"x",e+"y",u,c);t.regions.push(new sf.svgbase.Rect(t.symbolLocations[0].x-f.width,t.symbolLocations[0].y-f.height,2*f.width,2*f.height));t.marker={border:i.border,fill:i.fill,height:i.height,visible:!0,width:i.width,shape:i.shape,imageUrl:l}},n.prototype.doAnimation=function(n){for(var t,e=n.animation.duration,o=n.animation.delay,u=n.seriesElement.childNodes,i=1,r=0,f=n.points;r<f.length;r++)t=f[r],t.symbolLocations.length&&u[i]&&(oi(u[i],o,e,n,t.index,t.symbolLocations[0],!1),i++)},n.prototype.getModuleName=function(){return"ScatterSeries"},n.prototype.destroy=function(){},n}(),tw=(ge=function(n,t){return(ge=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ge(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),aa=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return tw(t,n),t.prototype.render=function(n){for(var t,i,u,f=this.getSideBySideInfo(n),r=0,e=n.points;r<e.length;r++)t=e[r],t.symbolLocations=[],t.regions=[],t.visible&&b(n.points[t.index-1],t,n.points[t.index+1],n)&&((i=this.getRectangle(t.xValue+f.start,t.high,t.xValue+f.end,t.low,n)).width=n.columnWidthInPixel?n.columnWidthInPixel:i.width,i.x=n.columnWidthInPixel?i.x-(n.columnWidthInPixel/2*n.rectCount-n.columnWidthInPixel*n.index):i.x,(u=this.triggerEvent(n,t,n.interior,{width:n.border.width,color:n.border.color})).cancel||(this.updateSymbolLocation(t,i,n),this.drawRectangle(n,t,i,u)));this.renderMarker(n)},t.prototype.getModuleName=function(){return"RangeColumnSeries"},t.prototype.doAnimation=function(n){this.animate(n)},t.prototype.destroy=function(){},t}(wt),iw=(no=function(n,t){return(no=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}no(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),va=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return iw(t,n),t.prototype.render=function(n){for(var t,v,d,u,l,nt,o,tt,it,e,rt=this.getSideBySideInfo(n),ht=Math.max(n.yAxis.visibleRange.min,0),p=0,s="",a=0,i=null,f=n.chart.requireInvertedAxis,ut=0,w=n.chart.redraw,k=0,ft=n.points;k<ft.length;k++)if(t=ft[k],t.symbolLocations=[],t.regions=[],t.visible&&b(n.points[t.index-1],t,n.points[t.index+1],n)){if(v=this.isIntermediateSum(n,t.index),d=this.isSumIndex(n,t.index),a+=v||!0===d?0:t.yValue,it=!0===v?ut:null===p||d?ht:p,o=this.getRectangle(t.xValue+rt.start,a,t.xValue+rt.end,it,n),v&&(ut=a),p=a,(tt=this.triggerPointRenderEvent(n,t)).cancel||(this.updateSymbolLocation(t,o,n),this.drawRectangle(n,t,o,tt)),u=t.regions[0],null!==i){var ct=f?i.x:i.y,et=f?u.x:u.y,g=void 0,y=void 0,ot=u.y,st=u.x,c=n.points[t.index-1];0===t.yValue?(g=f?i.x+i.width:i.y+i.height,y=f?t.symbolLocations[0].x:t.symbolLocations[0].y):(g=f?0===c.yValue?c.symbolLocations[0].x:i.x+i.width:0===c.yValue?c.symbolLocations[0].y:i.y+i.height,y=f?u.x+u.width:u.y+u.height);Math.round(ct)===Math.round(et)||Math.round(g)===Math.round(et)?(e=f?0===u.x&&0===i.x?y:u.x:u.y,e=0===t.yValue?f?t.symbolLocations[0].x:t.symbolLocations[0].y:e):e=y;f?(0===c.yValue&&(i.y=i.y+i.height/2+o.height/2-i.height),0===t.yValue&&(ot=u.y+u.height/2-o.height/2),s=s.concat("M "+e+" "+(i.y+i.height)+" L "+e+" "+ot+" ")):(0===c.yValue&&(i.x=i.x+i.width/2-o.width/2,st=u.x+u.width/2+o.width/2-u.width),s=s.concat("M "+i.x+" "+e+" L "+(st+u.width)+" "+e+" "))}i=t.regions[0]}l=new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index+"_Connector_","none",n.connector.width,n.connector.color,n.opacity,n.connector.dashArray,s);w&&r(l.id)&&(s=r(l.id).getAttribute("d"));nt=yt(w,l.id,l,n.chart.renderer)||n.chart.renderer.drawPath(l,new Int32Array([n.clipRect.x,n.clipRect.y]));nt.style.visibility=n.chart.enableCanvas?null:n.animation.enable&&n.chart.animateSeries?"hidden":"visible";h(n.chart.enableCanvas,n.seriesElement,nt,w,!0,null,null,null,s);this.renderMarker(n)},t.prototype.isIntermediateSum=function(n,t){return void 0!==n.intermediateSumIndexes&&-1!==n.intermediateSumIndexes.indexOf(t)},t.prototype.isSumIndex=function(n,t){return void 0!==n.sumIndexes&&-1!==n.sumIndexes.indexOf(t)},t.prototype.triggerPointRenderEvent=function(n,t){var i,r=this.isIntermediateSum(n,t.index),u=this.isSumIndex(n,t.index);return i=r||u?n.summaryFillColor:t.y<0?n.negativeFillColor:n.interior,this.triggerEvent(n,t,i,{color:n.border.color,width:n.border.width})},t.prototype.processInternalData=function(n,t){var s,r=n,u=t.intermediateSumIndexes,f=t.sumIndexes,e,i,o;if(void 0!==u&&u.length>0)for(e=0;e<u.length;e++)for(i=0;i<r.length;i++)i===u[e]&&(s=wr(r,0===e?-1:u[e-1],u[e],null,t),r[i][t.yName]=s);if(void 0!==f&&f.length>0)for(o=0;o<f.length;o++)for(i=0;i<r.length;i++)i===f[o]&&(s=void 0!==u?wr(r,u[o]-1,f[o],f,t):wr(r,-1,f[o],null,t),r[i][t.yName]=s);return r},t.prototype.doAnimation=function(n){this.animate(n)},t.prototype.getModuleName=function(){return"WaterfallSeries"},t.prototype.destroy=function(){},t}(wt),rw=(to=function(n,t){return(to=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}to(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ya=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return rw(t,n),t.prototype.render=function(n){for(var t,i,r,f=this.getSideBySideInfo(n),u=0,e=n.points;u<e.length;u++)t=e[u],t.symbolLocations=[],t.regions=[],t.visible&&b(n.points[t.index-1],t,n.points[t.index+1],n)&&(i=this.getRectangle(t.xValue+f.median,t.high,t.xValue+f.median,t.low,n),(r=this.triggerPointRenderEvent(n,t)).cancel||(n.chart.requireInvertedAxis?(i.height=r.border.width,i.y=i.y-i.height/2):(i.width=r.border.width,i.x=i.x-i.width/2),r.border.width=0,this.updateSymbolLocation(t,i,n),this.drawRectangle(n,t,i,r)))},t.prototype.triggerPointRenderEvent=function(t,i){var r={color:t.fill,width:Math.max(t.border.width,2)};return n.prototype.triggerEvent.call(this,t,i,t.interior,r)},t.prototype.getModuleName=function(){return"HiloSeries"},t.prototype.doAnimation=function(n){this.animate(n)},t.prototype.destroy=function(){},t}(wt),uw=(io=function(n,t){return(io=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}io(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),pa=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return uw(t,n),t.prototype.render=function(n){for(var t,c,l,o,r,u,s,i=this.getSideBySideInfo(n),f=Math.max(n.border.width,2),e=0,h=n.points;e<h.length;e++)t=h[e],(t.symbolLocations=[],t.regions=[],t.visible&&b(n.points[t.index-1],t,n.points[t.index+1],n))&&((o=this.getRectangle(t.xValue+i.start,Math.max(t.high,t.low),t.xValue+i.end,Math.min(t.high,t.low),n),t.regions.push(this.getRectangle(t.xValue+i.median,Math.max(t.high,t.low),t.xValue+i.median,Math.min(t.high,t.low),n)),this.updateTickRegion(!n.chart.requireInvertedAxis,t.regions[0],f),t.regions.push(this.getRectangle(t.xValue+i.start,Math.max(t.open,t.close),t.xValue+i.median,Math.max(t.open,t.close),n)),t.regions.push(this.getRectangle(t.xValue+i.median,Math.min(t.open,t.close),t.xValue+i.end,Math.min(t.open,t.close),n)),(s=this.triggerPointRenderEvent(n,t)).cancel)||(this.updateSymbolLocation(t,t.regions[0],n),r=t.open>t.close?1:2,u=t.open>t.close?2:1,c={x:t.regions[r].x,y:t.regions[r].y},l={x:t.regions[u].x,y:t.regions[u].y},this.drawHiloOpenClosePath(n,t,c,l,o,s)),this.updateTickRegion(n.chart.requireInvertedAxis,t.regions[1],f),this.updateTickRegion(n.chart.requireInvertedAxis,t.regions[2],f))},t.prototype.updateTickRegion=function(n,t,i){n?(t.x-=i/2,t.width=i):(t.y-=i/2,t.height=i)},t.prototype.triggerPointRenderEvent=function(n,t){var i=t.open<=t.close?n.bearFillColor:n.bullFillColor,r={color:n.border.color,width:Math.max(n.border.width,1)};return this.triggerEvent(n,t,i,r)},t.prototype.drawHiloOpenClosePath=function(n,t,i,u,f,e){var o,s,h;n.chart.requireInvertedAxis?(o="M "+f.x+" "+(f.y+f.height/2)+" L "+(f.x+f.width)+" "+(f.y+f.height/2)+" ",o+="M "+i.x+" "+(f.y+f.height/2)+" L "+i.x+" "+(f.y+f.height)+" ",o+="M "+u.x+" "+(f.y+f.height/2)+" L "+u.x+" "+f.y+" "):(o="M "+(f.x+f.width/2)+" "+(f.y+f.height)+" L "+(f.x+f.width/2)+" "+f.y+" ",o+="M "+f.x+" "+i.y+" L "+(f.x+f.width/2)+" "+i.y+" ",o+="M "+(f.x+f.width/2)+" "+u.y+" L "+(f.x+f.width)+" "+u.y+" ");s=new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index+"_Point_"+t.index,e.fill,e.border.width,e.fill,n.opacity,n.dashArray,o);ii(r(s.id),o,n.chart.redraw);h=n.chart.renderer.drawPath(s,new Int32Array([n.clipRect.x,n.clipRect.y]));h.setAttribute("aria-label",t.x.toString()+":"+t.high.toString()+":"+t.low.toString()+":"+t.close.toString()+":"+t.open.toString());n.chart.enableCanvas||n.seriesElement.appendChild(h)},t.prototype.getModuleName=function(){return"HiloOpenCloseSeries"},t.prototype.doAnimation=function(n){this.animate(n)},t.prototype.destroy=function(){},t}(wt),fw=(ro=function(n,t){return(ro=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ro(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),wa=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fw(t,n),t.prototype.render=function(n,t,i,r){for(var v,y,w,h,c,p,k,d,u,s="",l="M",a=void 0,f=this.enableComplexProperty(n),o=0,g=f.length;o<g;o++)(u=f[o]).symbolLocations=[],u.regions=[],v=Math.min(u.low,u.high),y=Math.max(u.low,u.high),i.isInversed&&(w=v,v=y,y=w),h=e(u.xValue,v,t,i,r),c=e(u.xValue,y,t,i,r),u.symbolLocations.push(c),u.symbolLocations.push(h),p=new sf.svgbase.Rect(Math.min(h.x,c.x),Math.min(h.y,c.y),Math.max(Math.abs(c.x-h.x),n.marker.width),Math.max(Math.abs(c.y-h.y),n.marker.width)),r?p.y-=n.marker.width/2:p.x-=n.marker.width/2,u.regions.push(p),u.visible&&b(f[u.index-1],u,f[u.index+1],n)?(s=s.concat(l+" "+h.x+" "+h.y+" "),a=!1,(o+1<f.length&&!f[o+1].visible||o===f.length-1)&&(l="M",s=(s=this.closeRangeAreaPath(f,u,n,s,o)).concat(" Z"),a=!0),l="L"):(!1===a&&0!==o&&(s=this.closeRangeAreaPath(f,u,n,s,o),a=!0),l="M",u.symbolLocations=[]);k="Indicator"===n.category?n.chart.element.id+"_Indicator_"+n.index+"_"+n.name:n.chart.element.id+"_Series_"+n.index;d=new sf.svgbase.PathOption(k,n.interior,n.border.width,n.border.color,n.opacity,n.dashArray,s);this.appendLinePath(d,n,"");this.renderMarker(n)},t.prototype.closeRangeAreaPath=function(n,t,i,r,u){for(var f=u;f>=0&&n[f].visible&&n[f].symbolLocations[0];f--)r+="L "+(t=n[f]).symbolLocations[0].x+" "+t.symbolLocations[0].y+" ";return r},t.prototype.doAnimation=function(n){var t=n.animation;this.doLinearAnimation(n,t)},t.prototype.getModuleName=function(){return"RangeAreaSeries"},t.prototype.destroy=function(){},t}(pt),ew=(uo=function(n,t){return(uo=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}uo(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),bs=function(n){function t(t){var i=n.call(this,t)||this;return i.splinePoints=[],i.lowSplinePoints=[],i}return ew(t,n),t.prototype.findSplinePoint=function(n){for(var u,l,e,t=[],a=0,f,s,c,i,r,v,h=this.filterEmptyPoints(n),o=0;o<h.length;o++)null!==(e=h[o]).x&&""!==e.x&&(e.index=a,a++,t.push(e));if(f=!1,this.splinePoints=this.findSplineCoefficients(t,n,f),"SplineRangeArea"===n.type&&(f=!f,this.lowSplinePoints=this.findSplineCoefficients(t,n,f)),t.length>1){for(n.drawPoints=[],n.lowDrawPoints=[],s=0,c=t;s<c.length;s++)i=c[s],0!==i.index&&(r=this.getPreviousIndex(t,i.index-1,n),"SplineRangeArea"===n.type&&(t[r].yValue=t[r].high>t[r].low?t[r].high:t[r].low,i.yValue=i.high>i.low?i.high:i.low),u=this.getControlPoints(t[r],i,this.splinePoints[r],this.splinePoints[i.index],n),n.drawPoints.push(u),"SplineRangeArea"===n.type&&(t[r].yValue=t[r].low<t[r].high?t[r].low:t[r].high,i.yValue=i.low<i.high?i.low:i.high,l=this.getControlPoints(t[r],i,this.lowSplinePoints[r],this.lowSplinePoints[i.index],n),n.lowDrawPoints.push(l)),v=n.yMax-n.yMin,i.yValue&&u.controlPoint1.y&&u.controlPoint2.y&&v>1&&(n.yMin=Math.min(n.yMin,i.yValue,u.controlPoint1.y,u.controlPoint2.y),n.yMax=Math.ceil(Math.max(n.yMax,i.yValue,u.controlPoint1.y,u.controlPoint2.y)),n.yMin="Logarithmic"!==n.yAxis.valueType?Math.floor(n.yMin):n.yMin));"PolarRadar"===n.chart.chartAreaType&&n.isClosed&&(u=this.getControlPoints({xValue:t[t.length-1].xValue,yValue:t[t.length-1].yValue},{xValue:t[t.length-1].xValue+1,yValue:t[0].yValue},this.splinePoints[0],this.splinePoints[t[t.length-1].index],n),n.drawPoints.push(u))}},t.prototype.getPreviousIndex=function(n,t,i){if("Drop"!==i.emptyPointSettings.mode)return t;for(;sf.base.isNullOrUndefined(n[t])&&t>-1;)t-=1;return t},t.prototype.getNextIndex=function(n,t,i){if("Drop"!==i.emptyPointSettings.mode)return t;for(;sf.base.isNullOrUndefined(n[t])&&t<n.length;)t+=1;return t},t.prototype.filterEmptyPoints=function(n,t){if("Drop"!==n.emptyPointSettings.mode&&this.isPointInRange(n.points))return t||n.points;for(var r=t||sf.base.extend([],n.points,null,!0),i=0;i<r.length;i++)r[i].index=i,r[i].isEmpty&&(r[i].symbolLocations=[],r[i].regions=[],r.splice(i,1),i--);return r},t.prototype.isPointInRange=function(n){for(var t=0,i=n;t<i.length;t++)if(!i[t].isPointInRange)return!1;return!0},t.prototype.findSplineCoefficients=function(n,t,i){var r=[],u=t.cardinalSplineTension?t.cardinalSplineTension:.5;switch(u=u<0?0:u>1?1:u,t.splineType){case"Monotonic":r=this.monotonicSplineCoefficients(n,t,i);break;case"Cardinal":r=this.cardinalSplineCofficients(n,t,i);break;default:"Clamped"===t.splineType?r=this.clampedSplineCofficients(n,t,i):(r[0]=[][0]=0,r[n.length-1]=0);r=this.naturalSplineCoefficients(n,t,i)}return r},t.prototype.monotonicSplineCoefficients=function(n,t,i){for(var u,s,h,c=n.length,o=[],e=[],l=[],f=[],r=0;r<c-1;r++)"SplineRangeArea"===t.type&&(i||(n[r+1].yValue=n[r+1].high>n[r+1].low?n[r+1].high:n[r+1].low,n[r].yValue=n[r].high>n[r].low?n[r].high:n[r].low),i&&(n[r+1].yValue=n[r+1].low<n[r+1].high?n[r+1].low:n[r+1].high,n[r].yValue=n[r].low<n[r].high?n[r].low:n[r].high)),e[r]=n[r+1].xValue-n[r].xValue,l[r]=n[r+1].yValue-n[r].yValue,f[r]=l[r]/e[r];for(h=f.length,o[0]=f[0],o[c-1]=f[h-1],u=0;u<e.length;u++)h>u+1&&(f[u]*f[u+1]<=0?o[u+1]=0:(s=e[u]+e[u+1],o[u+1]=3*s/((s+e[u+1])/f[u]+(s+e[u])/f[u+1])));return o},t.prototype.cardinalSplineCofficients=function(n,t){for(var u=n.length,f=[],r=t.cardinalSplineTension?t.cardinalSplineTension:.5,r=r<0?0:r>1?1:r,i=0;i<u;i++)f[i]=0===i?u>2?r*(n[i+2].xValue-n[i].xValue):0:i===u-1?u>2?r*(n[u-1].xValue-n[u-3].xValue):0:r*(n[i+1].xValue-n[i-1].xValue);return f},t.prototype.clampedSplineCofficients=function(n,t,i){for(var e=n.length,r=[],u=[],f=0;f<e-1;f++)"SplineRangeArea"===t.type&&(i||(n[1].yValue=n[1].high>n[1].low?n[1].high:n[1].low,n[0].yValue=n[0].high>n[0].low?n[0].high:n[0].low,n[n.length-1].yValue=n[n.length-1].high>n[n.length-1].low?n[n.length-1].high:n[n.length-1].low,n[n.length-2].yValue=n[n.length-2].high>n[n.length-2].low?n[n.length-2].high:n[n.length-2].low),i&&(n[1].yValue=n[1].low<n[1].high?n[1].low:n[1].high,n[0].yValue=n[0].low<n[0].high?n[0].low:n[0].high,n[n.length-1].yValue=n[n.length-1].low<n[n.length-1].high?n[n.length-1].low:n[n.length-1].high,n[n.length-2].yValue=n[n.length-2].low<n[n.length-2].high?n[n.length-2].low:n[n.length-2].high)),r[0]=3*(n[1].yValue-n[0].yValue)/(n[1].xValue-n[0].xValue)-3,u[0]=.5,r[n.length-1]=3*(n[n.length-1].yValue-n[n.length-2].yValue)/(n[n.length-1].xValue-n[n.length-2].xValue),r[0]=u[0]=Math.abs(r[0])===1/0?0:r[0],r[n.length-1]=u[n.length-1]=Math.abs(r[n.length-1])===1/0?0:r[n.length-1];return r},t.prototype.naturalSplineCoefficients=function(n,t,i){var l,a,e,h,s,v=n.length,u=[],o=[],r,c,f;for(u[0]=o[0]=0,u[n.length-1]=0,r=1;r<v-1;r++)("SplineRangeArea"===t.type&&(i||(n[r+1].yValue=n[r+1].low>n[r+1].high?n[r+1].low:n[r+1].high,n[r].yValue=n[r].low>n[r].high?n[r].low:n[r].high,n[r-1].yValue=n[r-1].low>n[r-1].high?n[r-1].low:n[r-1].high),i&&(n[r+1].yValue=n[r+1].high<n[r+1].low?n[r+1].high:n[r+1].low,n[r].yValue=n[r].high<n[r].low?n[r].high:n[r].low,n[r-1].yValue=n[r-1].high<n[r-1].low?n[r-1].high:n[r-1].low)),e=n[r].xValue-n[r-1].xValue,h=n[r+1].xValue-n[r-1].xValue,s=n[r+1].xValue-n[r].xValue,l=n[r+1].yValue-n[r].yValue||null,a=n[r].yValue-n[r-1].yValue||null,0===e||0===h||0===s)?(u[r]=0,o[r]=0):(c=1/(e*u[r-1]+2*h),u[r]=-c*s,o[r]=c*(6*(l/s-a/e)-e*o[r-1]));for(f=v-2;f>=0;f--)u[f]=u[f]*u[f+1]+o[f];return u},t.prototype.getControlPoints=function(n,t,i,r,u){var f,e,l,p=i,w=r,o=n.xValue,a=n.yValue,h=t.xValue,v=t.yValue,c,y,b;switch(u.splineType){case"Cardinal":"DateTime"===u.xAxis.valueType&&(p=i/this.dateTimeInterval(u),w=r/this.dateTimeInterval(u));f=new s(o+i/3,a+p/3);e=new s(h-r/3,v-w/3);l=new ru(f,e);break;case"Monotonic":c=(h-o)/3;f=new s(o+c,a+i*c);e=new s(h-c,v-r*c);l=new ru(f,e);break;default:y=h-o;b=1/3*(a+2*v-1/3*(y*=y)*(.5*i+r));f=new s((2*o+h)*(1/3),1/3*(2*a+v-1/3*y*(i+.5*r)));e=new s((o+2*h)*(1/3),b);l=new ru(f,e)}return l},t.prototype.dateTimeInterval=function(n){var t=n.xAxis.actualIntervalType;return"Years"===t?31536e6:"Months"===t?2592e6:"Days"===t?864e5:"Hours"===t?36e5:"Minutes"===t?6e4:"Seconds"===t?1e3:2592e6},t.prototype.doAnimation=function(n){var t=n.animation;this.doLinearAnimation(n,t)},t}(pt),ow=(fo=function(n,t){return(fo=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}fo(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ba=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ow(t,n),t.prototype.render=function(n,t,i,r){for(var u,w,k,d,g,nt,l,ut,o="",a=void 0,it=null,rt=[],ft=0,s,et,v,y,ot,h,c,p,st,ht,tt=this.filterEmptyPoints(n),f=0;f<tt.length;f++)null!==(u=tt[f]).x&&""!==u.x&&(u.index=ft,ft++,rt.push(u));for(s=this.enableComplexProperty(n),et=s.length,f=0;f<et;f++)(u=s[f]).regions=[],u.symbolLocations=[],ut=this.getNextIndex(rt,u.index-1,n),l=this.getPreviousIndex(rt,u.index-1,n),v=Math.min(u.low,u.high),y=Math.max(u.low,u.high),i.isInversed&&(ot=v,v=y,y=ot),h=e(u.xValue,v,t,i,r),c=e(u.xValue,y,t,i,r),u.symbolLocations.push(c),u.symbolLocations.push(h),p=new sf.svgbase.Rect(Math.min(h.x,c.x),Math.min(h.y,c.y),Math.max(Math.abs(c.x-h.x),n.marker.width),Math.max(Math.abs(c.y-h.y),n.marker.width)),r?p.y-=n.marker.width/2:p.x-=n.marker.width/2,u.regions.push(p),u.visible&&b(s[l],u,s[ut],n)?(it?(g=n.drawPoints[l].controlPoint1,nt=n.drawPoints[l].controlPoint2,w=e(u.xValue,u.high>u.low?u.high:u.low,t,i,r),k=e(g.x,g.y,t,i,r),d=e(nt.x,nt.y,t,i,r),o=o.concat("C "+k.x+" "+k.y+" "+d.x+" "+d.y+" "+w.x+" "+w.y+" ")):(o=i.isInversed?o.concat("M "+c.x+" "+c.y+" L "+h.x+" "+h.y+" "):o.concat("M "+h.x+" "+h.y+" L "+c.x+" "+c.y+" "),a=!1),(f+1<s.length&&!s[f+1].visible||f===s.length-1)&&(o=(o=this.closeSplineRangeAreaPath(s,u,n,o,f,t,i,r)).concat(" Z"),a=!0),it=u):(!1===a&&0!==f&&(o=this.closeSplineRangeAreaPath(s,u,n,o,f,t,i,r),a=!0),it=null,u.symbolLocations=[]);st="Indicator"===n.category?n.chart.element.id+"_Indicator_"+n.index+"_"+n.name:n.chart.element.id+"_Series_"+n.index;ht=new sf.svgbase.PathOption(st,n.interior,n.border.width,n.border.color,n.opacity,n.dashArray,o);this.appendLinePath(ht,n,"");this.renderMarker(n)},t.prototype.closeSplineRangeAreaPath=function(n,t,i,r,u,f,o,s){for(var a,v,y,p,w,c,l,g,k,d,b=null,h=u;h>0&&n[h].visible;h--)t=n[h],c=Math.min(t.low,t.high),l=Math.max(t.low,t.high),o.isInversed&&(g=c,c=l,l=g),k=e(t.xValue,c,f,o,s),d=e(t.xValue,l,f,o,s),b?(p=i.lowDrawPoints[h].controlPoint1,w=i.lowDrawPoints[h].controlPoint2,a=e(t.xValue,t.low<t.high?t.low:t.high,f,o,s),v=e(p.x,p.y,f,o,s),y=e(w.x,w.y,f,o,s),r=r.concat("C "+y.x+" "+y.y+" "+v.x+" "+v.y+" "+a.x+" "+a.y+" ")):r=o.isInversed?r.concat("L "+d.x+" "+d.y+" "):r.concat("L "+k.x+" "+k.y+" "),b=t;return r},t.prototype.doAnimation=function(n){var t=n.animation;this.doLinearAnimation(n,t)},t.prototype.getModuleName=function(){return"SplineRangeAreaSeries"},t.prototype.destroy=function(){},t}(bs),ka=function(){function n(){}return n.prototype.render=function(n,t,i,r){var tt,f,o,l,p,it,et=n.marker,w=n.points,ut=Math.max(n.chart.initialClipRect.height,n.chart.initialClipRect.width),ft=ut/100,k=n.maxRadius*ft,a=n.minRadius*ft,c=null,d=n.chart.redraw,v,g,s,y,nt,u;if(null===n.maxRadius||null===n.minRadius){for(v=0,g=n.chart.visibleSeries;v<g.length;v++)s=g[v],"Bubble"!==s.type||!0!==s.visible||null!==s.maxRadius&&null!==s.minRadius||(c=s.sizeMax>c?s.sizeMax:c);a=k=1;l=ut/10*k}else c=n.sizeMax,l=k-a;for(y=0,nt=w;y<nt.length;y++)u=nt[y],u.symbolLocations=[],u.regions=[],u.visible&&b(w[u.index-1],u,w[u.index+1],n)&&(o=(o=null===n.maxRadius||null===n.minRadius?l*Math.abs(+u.size/c):a+l*Math.abs(+u.size/c))||a,f={cancel:!1,name:"pointRender",series:n,point:u,fill:n.setPointColor(u,n.interior),border:n.setBorderColor(u,{width:n.border.width,color:n.border.color}),height:2*o,width:2*o},n.chart.trigger("pointRender",f),f.cancel?u.marker={visible:!1}:(u.symbolLocations.push(e(u.xValue,u.yValue,t,i,r)),u.color=f.fill,tt=new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index+"_Point_"+u.index,f.fill,f.border.width,f.border.color,n.opacity,null),p=rt(u.symbolLocations[0],"Circle",new sf.svgbase.Size(f.width,f.height),et.imageUrl,tt,(u.x.toString(),u.yValue.toString()),n.chart.svgRenderer,n.clipRect),h(!1,n.seriesElement,p,d),u.regions.push(new sf.svgbase.Rect(u.symbolLocations[0].x-o,u.symbolLocations[0].y-o,2*o,2*o)),u.marker={border:f.border,fill:f.fill,height:f.height,visible:!0,shape:"Circle",width:f.width},it=d?u.symbolLocations[0]:null,d&&cf(p,300,it,u.symbolLocations[0],"cx","cy")))},n.prototype.destroy=function(){},n.prototype.getModuleName=function(){return"BubbleSeries"},n.prototype.doAnimation=function(n){for(var t,f=n.animation.duration,e=n.animation.delay,o=n.seriesElement.childNodes,r=1,i=0,u=n.points;i<u.length;i++)t=u[i],t.symbolLocations.length&&(oi(o[r],e,f,n,t.index,t.symbolLocations[0],!1),r++)},n}(),sw=(eo=function(n,t){return(eo=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}eo(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),da=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return sw(t,n),t.prototype.render=function(n,t,i,r){var f,l,h=null,o="",s="M",k="TrendLine"===n.category?n.points:this.enableComplexProperty(n),u,c,p,w;f=this.filterEmptyPoints(n,k);for(var a="PolarRadar"===n.chart.chartAreaType?ei:e,v=0,y=f;v<y.length;v++)u=y[v],l=this.getPreviousIndex(f,u.index-1,n),u.symbolLocations=[],u.regions=[],u.visible&&b(f[l],u,f[this.getNextIndex(f,u.index-1,n)],n)?(null!==h&&(o=this.getSplineDirection(n.drawPoints[l],h,u,t,i,r,n,s,a,o),s="L"),h=u,this.storePointLocation(u,n,r,a)):(s="M",h=null,u.symbolLocations=[]);f.length>0&&n.drawPoints.length>0&&"PolarRadar"===n.chart.chartAreaType&&n.isClosed&&(c=this.getFirstLastVisiblePoint(f),o=this.getSplineDirection(n.drawPoints[n.drawPoints.length-1],c.last,{xValue:c.first.xValue,yValue:c.first.yValue},t,i,r,n,s,a,o),s="L");p="TrendLine"===n.category?n.chart.element.id+"_Series_"+n.sourceIndex+"_TrendLine_"+n.index:n.chart.element.id+"_Series_"+n.index;w=new sf.svgbase.PathOption(p,"transparent",n.width,n.interior,n.opacity,n.dashArray,o);this.appendLinePath(w,n,"");this.renderMarker(n)},t.prototype.getSplineDirection=function(n,t,i,r,u,f,e,o,s,h){var c=n.controlPoint1,l=n.controlPoint2,a=s(t.xValue,t.yValue,r,u,f,e),v=s(i.xValue,i.yValue,r,u,f,e),y=s(c.x,c.y,r,u,f,e),p=s(l.x,l.y,r,u,f,e);return h.concat(o+" "+a.x+" "+a.y+" C "+y.x+" "+y.y+" "+p.x+" "+p.y+" "+v.x+" "+v.y+" ")},t.prototype.getModuleName=function(){return"SplineSeries"},t.prototype.destroy=function(){},t}(bs),hw=(oo=function(n,t){return(oo=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}oo(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ga=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return hw(t,n),t.prototype.render=function(t){n.prototype.render.call(this,t);t.showNormalDistribution&&this.renderNormalDistribution(t)},t.prototype.calculateBinInterval=function(n,t){for(var u,i=g(n)/n.length,f=0,r=0,e=n;r<e.length;r++)u=e[r],f+=(u-i)*(u-i);t.histogramValues.mean=i;t.histogramValues.sDValue=Math.round(Math.sqrt(Math.abs(f/n.length-1)));t.histogramValues.binWidth=t.binInterval||Math.round(3.5*t.histogramValues.sDValue/Math.pow(n.length,1/3))||1},t.prototype.processInternalData=function(n,t){for(var a,i,o,f,r,s,h,c=[],u=[],l=Object.keys(n),e=0;e<l.length;e++)a=l[e],u.push(n[a][t.yName]);for(t.histogramValues={yValues:u},i=Math.min.apply(Math,t.histogramValues.yValues),o=Math.max.apply(Math,t.histogramValues.yValues),this.calculateBinInterval(t.histogramValues.yValues,t),r=t.histogramValues.binWidth,s=0;s<n.length;)f=u.filter(function(n){return n>=i&&n<i+r}).length,i+r===o&&(f+=u.filter(function(n){return n>=o}).length),c.push(((h={x:i+r/2})[t.yName]=f,h)),i+=r,s+=f;return c},t.prototype.calculateBinValues=function(n){var r,t,o=n.histogramValues.yValues.length,s=n.histogramValues.binWidth,f=n.histogramValues.mean,u=n.histogramValues.sDValue,e=n.xAxis.minimum?parseInt(n.xAxis.minimum.toString()):n.xMin,h=((n.xAxis.maximum?parseInt(n.xAxis.maximum.toString()):n.xMax)-e)/499,i;if(n.points.length)for(i=0;i<500;i++)r=e+i*h,t=Math.exp(-(r-f)*(r-f)/(2*u*u))/(u*Math.sqrt(2*Math.PI))*s*o,n.yMin=n.yMin>t?t:n.yMin,n.yMax=n.yMax<t?t:n.yMax},t.prototype.renderNormalDistribution=function(n){var i,f,o=n.xAxis.actualRange.min,l=n.xAxis.actualRange.max,s="",h="M",a=n.histogramValues.yValues.length,v=n.histogramValues.binWidth,c=n.histogramValues.mean,r=n.histogramValues.sDValue,y=(l-o)/499,t,u;if(n.points.length)for(t=0;t<500;t++)s+=h+" "+(f=e(i=o+t*y,Math.exp(-(i-c)*(i-c)/(2*r*r))/(r*Math.sqrt(2*Math.PI))*v*a,n.xAxis,n.yAxis,n.chart.requireInvertedAxis)).x+" "+f.y+" ",h="L";u=n.chart.renderer.drawPath(new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index+"_NDLine","transparent",2,n.chart.themeStyle.errorBar,n.opacity,n.dashArray,s),new Int32Array([n.clipRect.x,n.clipRect.y]));u.style.visibility=n.chart.enableCanvas?null:n.animation.enable&&n.chart.animateSeries?"hidden":"visible";n.chart.enableCanvas||n.seriesElement.appendChild(u)},t.prototype.doAnimation=function(t){n.prototype.doAnimation.call(this,t);t.showNormalDistribution&&er(t.seriesElement.lastElementChild,t.animation.duration,500,"FadeIn")},t.prototype.getModuleName=function(){return"HistogramSeries"},t.prototype.destroy=function(){},t}(ps),cw=(so=function(n,t){return(so=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}so(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),nv=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return cw(t,n),t.prototype.render=function(n,t,i,r){for(var l,v,y,p,w,u,d=null,s="",c=null,nt=null,o=[],tt=0,k=this.filterEmptyPoints(n),f=0;f<k.length;f++)null!==(u=k[f]).x&&""!==u.x&&(u.index=tt,tt++,o.push(u));var a,g=o.length,h="PolarRadar"===n.chart.chartAreaType?ei:e,it="PolarRadar"===n.chart.chartAreaType?n.points[0].yValue:Math.max(n.yAxis.visibleRange.min,0);for(f=0;f<g;f++)(u=o[f]).symbolLocations=[],u.regions=[],a=this.getPreviousIndex(o,u.index-1,n),u.visible&&b(o[a],u,o[this.getNextIndex(o,u.index-1,n)],n)?(d?(p=n.drawPoints[a].controlPoint1,w=n.drawPoints[a].controlPoint2,l=h(u.xValue,u.yValue,t,i,r,n),v=h(p.x,p.y,t,i,r,n),y=h(w.x,w.y,t,i,r,n),s=s.concat("C "+v.x+" "+v.y+" "+y.x+" "+y.y+" "+l.x+" "+l.y+" ")):(s+="M "+(c=h(u.xValue,it,t,i,r,n)).x+" "+c.y+" ",s+="L "+(nt=h(u.xValue,u.yValue,t,i,r,n)).x+" "+nt.y+" "),this.storePointLocation(u,n,r,h),d=u):(d=null,u.symbolLocations=[]),(f+1<g&&!o[f+1].visible||f===g-1)&&l&&c&&(c=h(u.xValue,it,t,i,r,n),s=s.concat("L "+c.x+" "+c.y));this.appendLinePath(new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index,n.interior,n.border.width,n.border.color,n.opacity,n.dashArray,s),n,"");this.renderMarker(n)},t.prototype.getModuleName=function(){return"SplineAreaSeries"},t.prototype.destroy=function(){},t}(bs),lw=(ho=function(n,t){return(ho=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ho(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ni=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return lw(t,n),t.prototype.initSeriesCollection=function(n,t){n.targetSeries=[];var i=new l(n,"targetSeries",{},!0);this.setSeriesProperties(i,n,n.type,n.fill,n.width,t)},t.prototype.setSeriesProperties=function(n,t,i,r,u,f){n.name=i.length<=4?i.toLocaleUpperCase():i;n.xName="x";n.yName="y";n.fill=r||"#606eff";n.dashArray=t.dashArray;n.width=u;n.xAxisName=t.xAxisName;n.animation=t.animation;n.yAxisName=t.yAxisName;n.clipRectElement=t.clipRectElement;n.points=[];n.enableTooltip=!0;n.interior=n.fill;n.category="Indicator";n.index=t.index;n.chart=f;n.xMin=1/0;n.xMax=-1/0;n.yMin=1/0;n.yMax=-1/0;n.xData=[];n.yData=[];n.marker.visible=!1;t.targetSeries.push(n)},t.prototype.createIndicatorElements=function(n,t,i){var r,h,e,f,o,u,s;for((t.seriesName||t.dataSource)&&br(t.targetSeries[0]),r=new sf.svgbase.Rect(0,0,0,0),(t.seriesName||t.dataSource)&&(r=t.targetSeries[0].clipRect),h=new y(n.element.id+"_ChartIndicatorClipRect_"+i,"transparent",{width:1,color:"Gray"},1,{x:0,y:0,width:r.width,height:r.height}),e=vt(n.redraw,h,n.renderer),t.indicatorElement=n.renderer.createGroup({id:n.element.id+"IndicatorGroup"+i,transform:"translate("+r.x+","+r.y+")","clip-path":"url(#"+n.element.id+"_ChartIndicatorClipRect_"+i+")"}),t.indicatorElement.appendChild(e),f=0,o=t.targetSeries;f<o.length;f++)u=o[f],u.clipRectElement=e,s=u.chart.renderer.createGroup({id:u.chart.element.id+"_Indicator_"+t.index+"_"+u.name+"_Group"}),t.indicatorElement.appendChild(s),u.seriesElement=s;n.indicatorElements.appendChild(t.indicatorElement)},t.prototype.getDataPoint=function(n,t,i,r,u,f){void 0===f&&(f=null);var e=new ir;return e.x=n,e.y=t,e.xValue=i.xValue,e.color=r.fill,e.index=u,e.yValue=t,e.visible=!0,r.xMin=Math.min(r.xMin,e.xValue),r.yMin=Math.min(r.yMin,e.yValue),r.xMax=Math.max(r.xMax,e.xValue),r.yMax=Math.max(r.yMax,e.yValue),r.xData.push(e.xValue),f&&"Macd"===f.type&&"Column"===r.type&&(e.color=e.y>=0?f.macdPositiveColor:f.macdNegativeColor),e},t.prototype.getRangePoint=function(n,t,i,r,u,f){var e=new ir;return e.x=n,e.high=t,e.low=i,e.xValue=r.xValue,e.color=u.fill,e.index=f,e.visible=!0,u.xData.push(e.xValue),e},t.prototype.setSeriesRange=function(n,t,i){void 0===i&&(i=null);i?i.points=n:t.targetSeries[0].points=n},t}(pt),aw=(co=function(n,t){return(co=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}co(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),tv=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return aw(t,n),t.prototype.initDataSource=function(n){var r=[],e=n.points,i;if(e&&e.length){var t=e,o=tt(n.field),h=n.targetSeries[0];if(t&&t.length&&t.length>=n.period){for(var u=0,f=0,s=0;s<n.period;s++)f+=t[s][o];for(u=f/n.period,r.push(this.getDataPoint(t[n.period-1].x,u,t[n.period-1],h,r.length)),i=n.period;i<t.length;)f-=t[i-n.period][o],u=(f+=t[i][o])/n.period,r.push(this.getDataPoint(t[i].x,u,t[i],h,r.length)),i++}this.setSeriesRange(r,n)}},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"SmaIndicator"},t}(ni),vw=(lo=function(n,t){return(lo=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}lo(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),iv=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return vw(t,n),t.prototype.initDataSource=function(n){var o=tt(n.field),r=[],u=n.targetSeries[0],t=n.points,i,e,c;if(t&&t.length&&t.length>=n.period){for(var s,h=0,l=2/(n.period+1),f=0;f<n.period;f++)h+=t[f][o];for(s=h/n.period,r.push(this.getDataPoint(t[n.period-1].x,s,t[n.period-1],u,r.length)),i=n.period;i<t.length;)e=r[i-n.period][u.yName],c=(t[i][o]-e)*l+e,r.push(this.getDataPoint(t[i].x,c,t[i],u,r.length)),i++}this.setSeriesRange(r,n)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"EmaIndicator"},t}(ni),yw=(ao=function(n,t){return(ao=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ao(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),rv=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return yw(t,n),t.prototype.initDataSource=function(n){var s=[],l=tt(n.field),h=n.points,a,r,i,f;if(h&&h.length&&h.length>=n.period&&(a=n.targetSeries[0],r=n.points,r.length&&r.length>=n.period)){for(var t=0,e=[],u=0,c=r.length,o=n.period;c>=o;){for(t=0,i=u=r.length-c;i<u+o;i++)t+=r[i][l];t/=o;e.push(t);c--}for(f=0;f<o-1;f++){for(t=0,i=0;i<f+1;i++)t+=r[i][l];t/=f+1;e.splice(f,0,t)}for(u=n.period;u<=e.length;){for(t=0,i=u-n.period;i<u;i++)t+=e[i];t/=n.period;s.push(this.getDataPoint(r[u-1].x,t,r[u-1],a,s.length));u++}}this.setSeriesRange(s,n)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"TmaIndicator"},t}(ni),pw=(vo=function(n,t){return(vo=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}vo(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),uv=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return pw(t,n),t.prototype.initDataSource=function(n){var i=[],t=n.points;t.length>0&&t.length>n.period&&(i=this.calculateADPoints(n,t));this.setSeriesRange(i,n)},t.prototype.calculateADPoints=function(n,t){for(var r=[],e=0,i=0,u=0,f=0,o=0,s=n.targetSeries[0],i=0;i<t.length;i++)u=Number(t[i].high),f=Number(t[i].low),e+=((o=Number(t[i].close))-f-(u-o))/(u-f)*Number(t[i].volume),r[i]=this.getDataPoint(t[i].x,e,t[i],s,r.length);return r},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"AccumulationDistributionIndicator"},t}(ni),ww=(yo=function(n,t){return(yo=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}yo(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),fv=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ww(t,n),t.prototype.initDataSource=function(n){var t=n.points;t.length>0&&t.length>n.period&&this.calculateATRPoints(n,t)},t.prototype.calculateATRPoints=function(n,t){for(var r=0,e=0,o=0,s=0,h=0,u=[],c=[],f=n.period,l=0,a=n.targetSeries[0],i=0;i<t.length;i++)e=Number(t[i].high)-Number(t[i].low),i>0&&(o=Math.abs(Number(t[i].high)-Number(t[i-1].close)),s=Math.abs(Number(t[i].low)-Number(t[i-1].close))),l+=h=Math.max(e,o,s),i>=f?(r=(Number(c[i-1].y)*(f-1)+h)/f,u.push(this.getDataPoint(t[i].x,r,t[i],a,u.length))):(r=l/f,i===f-1&&u.push(this.getDataPoint(t[i].x,r,t[i],a,u.length))),c[i]={x:t[i].x,y:r};this.setSeriesRange(u,n)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"AtrIndicator"},t}(ni),bw=(po=function(n,t){return(po=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}po(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ev=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return bw(t,n),t.prototype.initSeriesCollection=function(t,i){n.prototype.initSeriesCollection.call(this,t,i);var r=new l(t,"targetSeries",{},!0);n.prototype.setSeriesProperties.call(this,r,t,"UpperLine",t.upperLine.color,t.upperLine.width,i)},t.prototype.initDataSource=function(n){var r=[],u=[],t=n.points,i;if(t&&t.length){var e=n.targetSeries[1],o=n.targetSeries[0],f=n.period;if(t.length>=n.period)for(i=0;i<t.length;i++)r.push(this.getDataPoint(t[i].x,100,t[i],e,r.length)),i<f||u.push(this.getDataPoint(t[i].x,Number(t[i].close)/Number(t[i-f].close)*100,t[i],o,u.length));this.setSeriesRange(u,n,n.targetSeries[0]);this.setSeriesRange(r,n,n.targetSeries[1])}},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"MomentumIndicator"},t}(ni),kw=(wo=function(n,t){return(wo=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}wo(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ov=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return kw(t,n),t.prototype.initSeriesCollection=function(t,i){var r,u;(n.prototype.initSeriesCollection.call(this,t,i),t.showZones)&&(r=new l(t,"targetSeries",{},!0),n.prototype.setSeriesProperties.call(this,r,t,"LowerLine",t.lowerLine.color,t.lowerLine.width,i),u=new l(t,"targetSeries",{},!0),n.prototype.setSeriesProperties.call(this,u,t,"UpperLine",t.upperLine.color,t.upperLine.width,i))},t.prototype.initDataSource=function(n){var s=[],c=[],l=[],a=n.targetSeries[0],t=n.points,i,h,e,o;if(t.length&&t.length>=n.period){if(n.showZones)for(i=0;i<t.length;i++)l.push(this.getDataPoint(t[i].x,n.overBought,t[i],n.targetSeries[1],l.length)),c.push(this.getDataPoint(t[i].x,n.overSold,t[i],n.targetSeries[2],c.length));var r=Number(t[0].close),u=0,f=0;for(i=1;i<=n.period;i++)h=Number(t[i].close),h>r?u+=h-r:f+=r-h,r=h;for(u/=n.period,f/=n.period,s.push(this.getDataPoint(t[n.period].x,100-100/(1+u/f),t[n.period],a,s.length)),e=n.period+1;e<t.length;e++)o=Number(t[e].close),o>r?(u=(u*(n.period-1)+(o-r))/n.period,f=f*(n.period-1)/n.period):o<r&&(f=(f*(n.period-1)+(r-o))/n.period,u=u*(n.period-1)/n.period),r=o,s.push(this.getDataPoint(t[e].x,100-100/(1+u/f),t[e],a,s.length))}this.setSeriesRange(s,n,n.targetSeries[0]);n.showZones&&(this.setSeriesRange(l,n,n.targetSeries[1]),this.setSeriesRange(c,n,n.targetSeries[2]))},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"RsiIndicator"},t}(ni),dw=(bo=function(n,t){return(bo=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}bo(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),sv=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return dw(t,n),t.prototype.initSeriesCollection=function(t,i){var r,u,f;n.prototype.initSeriesCollection.call(this,t,i);r=new l(t,"targetSeries",{},!0);(this.setSeriesProperties(r,t,"PeriodLine",t.periodLine.color,t.periodLine.width,i),t.showZones)&&(u=new l(t,"targetSeries",{},!0),this.setSeriesProperties(u,t,"UpperLine",t.upperLine.color,t.upperLine.width,i),f=new l(t,"targetSeries",{},!0),this.setSeriesProperties(f,t,"LowerLine",t.lowerLine.color,t.lowerLine.width,i))},t.prototype.initDataSource=function(n){var e=[],r=[],u=[],o=[],f=[],t=n.points,i;if(t.length&&t.length>=n.period){if(n.showZones)for(i=0;i<t.length;i++)r.push(this.getDataPoint(t[i].x,n.overBought,t[i],n.targetSeries[2],r.length)),u.push(this.getDataPoint(t[i].x,n.overSold,t[i],n.targetSeries[3],u.length));f=this.calculatePeriod(n.period,n.kPeriod,t,n.targetSeries[1]);o=this.smaCalculation(n.period,n.kPeriod,f,n.targetSeries[1]);e=this.smaCalculation(n.period+n.kPeriod-1,n.dPeriod,f,n.targetSeries[0])}this.setSeriesRange(e,n,n.targetSeries[0]);this.setSeriesRange(o,n,n.targetSeries[1]);n.showZones&&(this.setSeriesRange(r,n,n.targetSeries[2]),this.setSeriesRange(u,n,n.targetSeries[3]))},t.prototype.smaCalculation=function(n,t,i,r){var s=[],a,c,e,o;if(i.length>=n+t){for(var l=n+(t-1),f=[],h=[],u=0;u<i.length;u++)a=Number(i[u].y),f.push(a);for(c=f.length;c>=l;){for(e=0,u=n-1;u<n+t-1;u++)e+=f[u];e/=t;h.push(e.toFixed(2));f.splice(0,1);c=f.length}for(o=l-1,u=0;u<i.length;u++)u<o||(s.push(this.getDataPoint(i[u].x,Number(h[u-o]),i[u],r,s.length)),i[u].y=Number(h[u-o]))}return s},t.prototype.calculatePeriod=function(n,t,i,r){for(var s,h,l,a,v=[],y=[],p=[],e=[],f=0;f<i.length;f++)v[f]=i[f].low,y[f]=i[f].high,p[f]=i[f].close;if(i.length>n){for(var o=[],c=[],u=0;u<n-1;++u)c.push(0),o.push(0),e.push(this.getDataPoint(i[u].x,i[u].close,i[u],r,e.length));for(u=n-1;u<i.length;++u){for(s=Number.MAX_VALUE,h=Number.MIN_VALUE,f=0;f<n;++f)s=Math.min(s,v[u-f]),h=Math.max(h,y[u-f]);c.push(h);o.push(s)}for(u=n-1;u<i.length;++u)l=0,a=0,l+=p[u]-o[u],a+=c[u]-o[u],e.push(this.getDataPoint(i[u].x,l/a*100,i[u],r,e.length))}return e},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StochasticIndicator"},t}(ni),gw=(ko=function(n,t){return(ko=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ko(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),hv=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return gw(t,n),t.prototype.initSeriesCollection=function(n,t){var i,r,u,f;n.targetSeries=[];i=new l(n,"targetSeries",{},!0);i.type="RangeArea";"transparent"!==n.bandColor&&"none"!==n.bandColor&&this.setSeriesProperties(i,n,"BollingerBand",n.bandColor,0,t);r=new l(n,"targetSeries",{},!0);this.setSeriesProperties(r,n,"BollingerBand",n.fill,n.width,t);u=new l(n,"targetSeries",{},!0);this.setSeriesProperties(u,n,"UpperLine",n.upperLine.color,n.upperLine.width,t);f=new l(n,"targetSeries",{},!0);this.setSeriesProperties(f,n,"LowerLine",n.lowerLine.color,n.lowerLine.width,t)},t.prototype.initDataSource=function(n){var a="transparent"!==n.bandColor&&"none"!==n.bandColor,s=a?1:0,w=[],v=[],y=[],b=[],ut=n.targetSeries[s+1],ft=n.targetSeries[s+2],et=n.targetSeries[s],ot=a?n.targetSeries[0]:null,i=n.points,u,t,c,l;if(i.length&&i.length>=n.period){for(var k=0,p=0,nt=n.standardDeviation,d=i.length,f=Math.round(n.period),e=[],o=[],h=[],g=0;g<f;g++)k+=Number(i[g].close);for(u=k/n.period,t=0;t<d;t++)if(c=Number(i[t].close),t>=f-1&&t<d){t-n.period>=0?(u=(k+=c-Number(i[t-f].close))/n.period,e[t]=u,o[t]=Math.pow(c-u,2),p+=o[t]-o[t-f]):(e[t]=u,o[t]=Math.pow(c-u,2),p+=o[t]);var tt=Math.sqrt(p/n.period),it=e[t]-nt*tt,rt=e[t]+nt*tt;if(t+1===f)for(l=0;l<f-1;l++)h[l]={X:i[l].x,mb:e[t],lb:it,ub:rt,visible:!0};h[t]={X:i[t].x,mb:e[t],lb:it,ub:rt,visible:!0}}else t<n.period-1&&(e[t]=u,o[t]=Math.pow(c-u,2),p+=o[t]);for(var st=-1,ht=-1,r=0;r<d;r++)r>=f-1&&(v.push(this.getDataPoint(i[r].x,h[r].ub,i[r],ut,v.length)),y.push(this.getDataPoint(i[r].x,h[r].lb,i[r],ft,y.length)),w.push(this.getDataPoint(i[r].x,h[r].mb,i[r],et,w.length)),a&&b.push(this.getRangePoint(i[r].x,v[++st].y,y[++ht].y,i[r],ot,b.length)))}a&&this.setSeriesRange(b,n,n.targetSeries[0]);this.setSeriesRange(w,n,n.targetSeries[s]);this.setSeriesRange(v,n,n.targetSeries[s+1]);this.setSeriesRange(y,n,n.targetSeries[s+2])},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"BollingerBandsIndicator"},t}(ni),nb=(go=function(n,t){return(go=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}go(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),cv=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return nb(t,n),t.prototype.initSeriesCollection=function(t,i){var u,r;(n.prototype.initSeriesCollection.call(this,t,i),"Line"===t.macdType||"Both"===t.macdType)&&(u=new l(t,"targetSeries",{},!0),this.setSeriesProperties(u,t,"MacdLine",t.macdLine.color,t.macdLine.width,i));("Histogram"===t.macdType||"Both"===t.macdType)&&(r=new l(t,"targetSeries",{},!0),r.type="Column",this.setSeriesProperties(r,t,"Histogram",t.macdPositiveColor,t.width,i))},t.prototype.initDataSource=function(n){var i,r,s=[],u=n.fastPeriod,f=n.slowPeriod,h=n.period,c=u+h,e=[],l=[],t=n.points,a=n.targetSeries[0],o;if("Histogram"===n.macdType?i=n.targetSeries[1]:(r=n.targetSeries[1],"Both"===n.macdType&&(i=n.targetSeries[2])),t&&c<t.length&&f<=u&&f>0&&c-2>=0){var y=this.calculateEMAValues(f,t,"close"),p=this.calculateEMAValues(u,t,"close"),v=this.getMACDVales(n,y,p);e=this.getMACDPoints(n,v,t,r||a);o=this.calculateEMAValues(h,e,"y");s=this.getSignalPoints(n,o,t,a);i&&(l=this.getHistogramPoints(n,v,o,t,i))}this.setSeriesRange(s,n,n.targetSeries[0]);i&&this.setSeriesRange(l,n,i);r&&this.setSeriesRange(e,n,r)},t.prototype.calculateEMAValues=function(n,t,i){for(var r,u,f,s=0,e=[],h=2/(n+1),o=0;o<n;o++)s+=Number(t[o][i]);for(f=s/n,e.push(f),r=f,u=n;u<t.length;u++)r=(Number(t[u][i])-r)*h+r,e.push(r);return e},t.prototype.getMACDPoints=function(n,t,i,r){for(var f=[],u=n.fastPeriod-1,e=0;u<i.length;)f.push(this.getDataPoint(i[u].x,t[e],i[u],r,f.length)),u++,e++;return f},t.prototype.getSignalPoints=function(n,t,i,r){for(var u=n.fastPeriod+n.period-2,e=0,f=[];u<i.length;)f.push(this.getDataPoint(i[u].x,t[e],i[u],r,f.length)),u++,e++;return f},t.prototype.getMACDVales=function(n,t,i){for(var u=[],f=n.fastPeriod-n.slowPeriod,r=0;r<i.length;r++)u.push(t[r+f]-i[r]);return u},t.prototype.getHistogramPoints=function(n,t,i,r,u){for(var f=n.fastPeriod+n.period-2,e=0,o=[];f<r.length;)o.push(this.getDataPoint(r[f].x,t[e+(n.period-1)]-i[e],r[f],u,o.length,n)),f++,e++;return o},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"MacdIndicator"},t}(ni),lv=function(){function n(){}return n.prototype.initSeriesCollection=function(n,t){var i=new l(n,"targetSeries",{},!0);i.type="Linear"===n.type||"MovingAverage"===n.type?"Line":"Spline";this.setSeriesProperties(i,n,n.type,n.fill,n.width,t)},n.prototype.setSeriesProperties=function(n,t,i,r,u,f){n.name=t.name;n.xName="x";n.yName="y";n.fill=r||"blue";n.width=u;n.dashArray=t.dashArray;n.clipRectElement=t.clipRectElement;n.points=[];n.enableTooltip=t.enableTooltip;n.index=t.index;n.sourceIndex=t.sourceIndex;n.interior=n.fill;n.animation=t.animation;n.legendShape="HorizontalLine";n.marker=t.marker;n.category="TrendLine";n.chart=f;n.xMin=1/0;n.xMax=-1/0;n.yMin=1/0;n.yMax=-1/0;n.xData=[];n.yData=[];t.targetSeries=n;f.isBlazor&&(t.targetSeries.border={},t.targetSeries.connector={})},n.prototype.createTrendLineElements=function(n,t,i,r,u){t.trendLineElement=r;t.targetSeries.clipRectElement=u;t.targetSeries.seriesElement=r;n.trendLineElements&&n.trendLineElements.appendChild(t.trendLineElement)},n.prototype.getDataPoint=function(n,t,i,r){var u=new ir;return u.x="DateTime"===i.xAxis.valueType?new Date(Number(n)):n,u.y=t,u.xValue=Number(n),u.color=i.fill,u.index=r,u.yValue=Number(t),u.visible=!0,i.xMin=Math.min(i.xMin,u.xValue),i.yMin=Math.min(i.yMin,u.yValue),i.xMax=Math.max(i.xMax,u.xValue),i.yMax=Math.max(i.yMax,u.yValue),i.xData.push(u.xValue),u},n.prototype.findSlopeIntercept=function(n,t,i,r){for(var o,e=0,s=0,h=0,c=0,u=0,f=0,l=0;u<r.length;)isNaN(t[u])&&(t[u]=(t[u-1]+t[u+1])/2),e+=n[u],s+=t[u],h+=n[u]*t[u],c+=n[u]*n[u],u++;if(o=i.type,i.intercept&&("Linear"===o||"Exponential"===o))switch(l=i.intercept,o){case"Linear":f=(h-i.intercept*e)/c;break;case"Exponential":f=(h-Math.log(Math.abs(i.intercept))*e)/c}else f=(r.length*h-e*s)/(r.length*c-e*e),f="Linear"===o?f:Math.abs(f),l="Exponential"===o||"Power"===o?Math.exp((s-f*e)/r.length):(s-f*e)/r.length;return{slope:f,intercept:l}},n.prototype.initDataSource=function(n){var i=n.points,t;if(i&&i.length){t=n.targetSeries;switch(n.type){case"Linear":this.setLinearRange(i,n,t);break;case"Exponential":this.setExponentialRange(i,n,t);break;case"MovingAverage":this.setMovingAverageRange(i,n,t);break;case"Polynomial":this.setPolynomialRange(i,n,t);break;case"Power":this.setPowerRange(i,n,t);break;case"Logarithmic":this.setLogarithmicRange(i,n,t)}"Linear"!==n.type&&"MovingAverage"!==n.type&&t.chart.splineSeriesModule.findSplinePoint(t)}},n.prototype.setExponentialRange=function(n,t,i){for(var r,o,s,u=[],f=[],e=0;e<n.length;)r=n[e],o=r.yValue?Math.log(r.yValue):0,u.push(r.xValue),f.push(o),e++;s=this.findSlopeIntercept(u,f,t,n);i.points=this.getExponentialPoints(t,n,u,f,i,s)},n.prototype.setLogarithmicRange=function(n,t,i){for(var r,s,h,e=[],u=[],o=[],f=0;f<n.length;)r=n[f],s=r.xValue?Math.log(r.xValue):0,o.push(r.xValue),e.push(s),u.push(r.yValue),f++;h=this.findSlopeIntercept(e,u,t,n);i.points=this.getLogarithmicPoints(t,n,o,u,i,h)},n.prototype.setPolynomialRange=function(n,t,i){for(var u,f=[],e=[],r=0;r<n.length;)u=n[r],f.push(u.xValue),e.push(u.yValue),r++;i.points=this.getPolynomialPoints(t,n,f,e,i)},n.prototype.setPowerRange=function(n,t,i){for(var s,e=[],u=[],o=[],f=0;f<n.length;){var r=n[f],h=r.xValue?Math.log(r.xValue):0,c=r.yValue?Math.log(r.yValue):0;o.push(r.xValue);e.push(h);u.push(c);f++}s=this.findSlopeIntercept(e,u,t,n);i.points=this.getPowerPoints(t,n,o,u,i,s)},n.prototype.setLinearRange=function(n,t,i){for(var e,o,r=[],u=[],f=0;f<n.length;)e=n[f],r.push(e.xValue),u.push(e.yValue),f++;o=this.findSlopeIntercept(r,u,t,n);i.points=this.getLinearPoints(t,n,r,u,i,o)},n.prototype.setMovingAverageRange=function(n,t,i){for(var u,o=[],f=[],e=[],r=0;r<n.length;)u=n[r],e.push(u.xValue),o.push(r+1),f.push(u.yValue),r++;i.points=this.getMovingAveragePoints(t,n,e,f,i)},n.prototype.getLogarithmicPoints=function(n,t,i,r,u,f){var c=Math.round(t.length/2),e=[],o=i[0]-n.backwardForecast,l=o?Math.log(o):0,a=f.intercept+f.slope*l,s=i[c-1],v=s?Math.log(s):0,y=f.intercept+f.slope*v,h=i[i.length-1]+n.forwardForecast,p=h?Math.log(h):0,w=f.intercept+f.slope*p;return e.push(this.getDataPoint(o,a,u,e.length)),e.push(this.getDataPoint(s,y,u,e.length)),e.push(this.getDataPoint(h,w,u,e.length)),e},n.prototype.getPowerPoints=function(n,t,i,r,u,f){var c=Math.round(t.length/2),e=[],o=i[0]-n.backwardForecast;o=o>-1?o:0;var l=f.intercept*Math.pow(o,f.slope),s=i[c-1],a=f.intercept*Math.pow(s,f.slope),h=i[i.length-1]+n.forwardForecast,v=f.intercept*Math.pow(h,f.slope);return e.push(this.getDataPoint(o,l,u,e.length)),e.push(this.getDataPoint(s,a,u,e.length)),e.push(this.getDataPoint(h,v,u,e.length)),e},n.prototype.getPolynomialPoints=function(n,t,i,r,u){var s=t.length<=n.polynomialOrder?t.length:n.polynomialOrder,h,f,o,c,y,a,v;for(s=Math.max(2,s),s=Math.min(6,s),n.polynomialOrder=s,n.polynomialSlopes=[],n.polynomialSlopes.length=n.polynomialOrder+1,h=0;h<i.length;){for(var w=i[h],b=r[h],e=0;e<=n.polynomialOrder;)n.polynomialSlopes[e]||(n.polynomialSlopes[e]=0),n.polynomialSlopes[e]+=Math.pow(w,e)*b,++e;h++}for(f=[],f.length=1+2*n.polynomialOrder,o=[],o.length=n.polynomialOrder+1,c=0;c<n.polynomialOrder+1;)o[c]=[],o[c].length=3,c++;for(y=0;y<i.length;){for(var k=i[y],p=1,l=0;l<f.length;)f[l]||(f[l]=0),f[l]+=p,p*=k,++l;++y}for(a=0;a<=n.polynomialOrder;){for(v=0;v<=n.polynomialOrder;)o[a][v]=f[a+v],++v;++a}return this.gaussJordanElimination(o,n.polynomialSlopes)||(n.polynomialSlopes=null),this.getPoints(n,t,i,u)},n.prototype.getMovingAveragePoints=function(n,t,i,r,u){for(var c=[],f=n.period>=t.length?t.length-1:n.period,e,a,l,s,h,f=Math.max(2,f),o=0;o<t.length-1;){for(e=l=s=0,h=o;l<f;h++)l++,r[h]||s++,e+=r[h];(e=f-s<=0?null:e/(f-s))&&!isNaN(e)&&(a=i[f-1+o],c.push(this.getDataPoint(a,e,u,c.length)));o++}return c},n.prototype.getLinearPoints=function(n,t,i,r,u,f){var e=[],h=i.indexOf(Math.max.apply(null,i)),c=i.indexOf(Math.min.apply(null,i)),o=i[c]-n.backwardForecast,l=f.slope*o+f.intercept,s=i[h]+n.forwardForecast,a=f.slope*s+f.intercept;return e.push(this.getDataPoint(o,l,u,e.length)),e.push(this.getDataPoint(s,a,u,e.length)),e},n.prototype.getExponentialPoints=function(n,t,i,r,u,f){var c=Math.round(t.length/2),e=[],o=i[0]-n.backwardForecast,l=f.intercept*Math.exp(f.slope*o),s=i[c-1],a=f.intercept*Math.exp(f.slope*s),h=i[i.length-1]+n.forwardForecast,v=f.intercept*Math.exp(f.slope*h);return e.push(this.getDataPoint(o,l,u,e.length)),e.push(this.getDataPoint(s,a,u,e.length)),e.push(this.getDataPoint(h,v,u,e.length)),e},n.prototype.getPoints=function(n,t,i,r){var u,e,o=n.polynomialSlopes,f=[],h=1,s=1;for(t.sort(function(n,t){return n.xValue-t.xValue}),i.sort(function(n,t){return n-t});s<=o.length;)1===s?(u=i[0]-n.backwardForecast,e=this.getPolynomialYValue(o,u),f.push(this.getDataPoint(u,e,r,f.length))):s===o.length?(u=i[t.length-1]+n.forwardForecast,e=this.getPolynomialYValue(o,u),f.push(this.getDataPoint(u,e,r,f.length))):(h+=(t.length+n.forwardForecast)/o.length,u=i[parseInt(h.toString(),10)-1],e=this.getPolynomialYValue(o,u),f.push(this.getDataPoint(u,e,r,f.length))),s++;return f},n.prototype.getPolynomialYValue=function(n,t){for(var r=0,i=0;i<n.length;)r+=n[i]*Math.pow(t,i),i++;return r},n.prototype.gaussJordanElimination=function(n,t){var r=n.length,l=[],a=[],v=[],w,y,u,s,p,g,k,b,e,f,h,nt;for(l.length=r,a.length=r,v.length=r,w=0;w<r;)v[w]=0,++w;for(y=0;y<r;){for(var d=0,o=0,i=0,c=0;c<r;){if(1!==v[c])for(u=0;u<r;)0===v[u]&&Math.abs(n[c][u])>=d&&(d=Math.abs(n[c][u]),o=c,i=u),++u;++c}if(++v[i],o!==i){for(s=0;s<r;)p=n[o][s],n[o][s]=n[i][s],n[i][s]=p,++s;g=t[o];t[o]=t[i];t[i]=g}if(a[y]=o,l[y]=i,0===n[i][i])return!1;for(k=1/n[i][i],n[i][i]=1,b=0;b<r;)n[i][b]*=k,++b;for(t[i]*=k,e=0;e<r;){if(e!==i){for(p=n[e][i],n[e][i]=0,u=0;u<r;)n[e][u]-=n[i][u]*p,++u;t[e]-=t[i]*p}++e}++y}for(f=r-1;f>=0;){if(a[f]!==l[f])for(h=0;h<r;)nt=n[h][a[f]],n[h][a[f]]=n[h][l[f]],n[h][l[f]]=nt,++h;--f}return!0},n.prototype.getTrendLineElements=function(n,t){var r,f,e;br(n);var i=n.clipRect,o=t.renderer.drawClipPath(new y(t.element.id+"_ChartTrendlineClipRect_"+n.index,"transparent",{width:1,color:"Gray"},1,{x:0,y:0,width:i.width,height:i.height})),u=t.renderer.createGroup({id:t.element.id+"TrendlineSeriesGroup"+n.index,transform:"translate("+i.x+","+i.y+")","clip-path":"url(#"+t.element.id+"_ChartTrendlineClipRect_"+n.index+")"});for(u&&u.appendChild(o),r=0,f=n.trendlines;r<f.length;r++)e=f[r],this.createTrendLineElements(t,e,e.index,u,o)},n.prototype.destroy=function(){},n.prototype.getModuleName=function(){return"TrendLine"},n}(),av=function(){function n(n){this.arrowLocation=new s(0,0);this.rx=2;this.ry=2;this.chart=n;this.elementID=this.chart.element.id;this.svgRenderer=new sf.svgbase.SvgRenderer(this.chart.element.id);this.addEventListener()}return n.prototype.addEventListener=function(){if(!this.chart.isDestroyed){var n=sf.base.Browser.isPointer?"pointerleave":"mouseleave";this.chart.on(sf.base.Browser.touchMoveEvent,this.mouseMoveHandler,this);this.chart.on(sf.base.Browser.touchEndEvent,this.mouseUpHandler,this);this.chart.on(n,this.mouseLeaveHandler,this);this.chart.on("tapHold",this.longPress,this)}},n.prototype.mouseUpHandler=function(){this.chart.startMove&&this.removeCrosshair(2e3)},n.prototype.mouseLeaveHandler=function(){this.removeCrosshair(1e3)},n.prototype.mouseMoveHandler=function(n){var t=this.chart;"touchmove"===n.type&&(sf.base.Browser.isIos||sf.base.Browser.isIos7)&&t.startMove&&n.preventDefault&&n.preventDefault();t.disableTrackTooltip||(v(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)?!t.startMove&&t.isTouch||this.crosshair():this.removeCrosshair(1e3))},n.prototype.longPress=function(){var n=this.chart;return v(n.mouseX,n.mouseY,n.chartAxisLayoutPanel.seriesClipRect)&&this.crosshair(),!1},n.prototype.crosshair=function(){var u,h,n=this.chart,o="",s="",f=document.getElementById(this.elementID+"_crosshair_axis"),t=n.crosshair,c=document.getElementById(this.elementID+"_tooltip"),i=n.chartAxisLayoutPanel.seriesClipRect,r=n.enableCanvas?document.getElementById(this.elementID+"_Secondary_Element"):document.getElementById(this.elementID+"_UserInteraction"),e=document.getElementById(this.elementID+"_Crosshair"),l;if(n.enableCanvas&&(e||(e=sf.base.createElement("div",{id:this.elementID+"_Crosshair",styles:"position: absolute; pointer-events: none"}),r.appendChild(e))),this.stopAnimation(),n.tooltip.enable&&!v(n.tooltipModule.valueX,n.tooltipModule.valueY,i))return null;if(n.stockChart&&n.stockChart.onPanning)return this.removeCrosshair(1e3),null;(this.valueX=n.tooltip.enable?n.tooltipModule.valueX:n.mouseX,this.valueY=n.tooltip.enable?n.tooltipModule.valueY:n.mouseY,n.enableCanvas||r.setAttribute("opacity","1"),"Both"!==t.lineType&&"Horizontal"!==t.lineType||(o+="M "+i.x+" "+this.valueY+" L "+(i.x+i.width)+" "+this.valueY),"Both"!==t.lineType&&"Vertical"!==t.lineType||(s+="M "+this.valueX+" "+i.y+" L "+this.valueX+" "+(i.y+i.height)),n.enableCanvas)?(f||(f=this.svgRenderer.createGroup({id:this.elementID+"_crosshair_axis"})),l=n.tooltip.enable?n.element.id+"_tooltip_svg":n.element.id+"_svg",h=this.svgRenderer.createSvg({id:l,width:n.availableSize.width,height:n.availableSize.height}),n.tooltip.enable&&((c=c||n.tooltipModule.createElement()).appendChild(h),r.appendChild(c)),u=new sf.svgbase.PathOption(this.elementID+"_HorizontalLine","none",t.line.width,t.horizontalLineColor||t.line.color||n.themeStyle.crosshairLine,t.opacity,t.dashArray,o),this.drawCrosshairLine(u,e,i.x,this.valueY,i.width,0,o),u=new sf.svgbase.PathOption(this.elementID+"_VerticalLine","none",t.line.width,t.verticalLineColor||t.line.color||n.themeStyle.crosshairLine,t.opacity,t.dashArray,s),this.drawCrosshairLine(u,e,this.valueX,i.y,0,i.height,s),this.renderAxisTooltip(n,i,f),h.appendChild(f),n.tooltip.enable||e.appendChild(h)):0===r.childNodes.length?(f=n.renderer.createGroup({id:this.elementID+"_crosshair_axis"}),u=new sf.svgbase.PathOption(this.elementID+"_HorizontalLine","none",t.line.width,t.horizontalLineColor||t.line.color||n.themeStyle.crosshairLine,t.opacity,t.dashArray,o),this.renderCrosshairLine(u,r),u=new sf.svgbase.PathOption(this.elementID+"_VerticalLine","none",t.line.width,t.verticalLineColor||t.line.color||n.themeStyle.crosshairLine,t.opacity,t.dashArray,s),this.renderCrosshairLine(u,r),r.appendChild(f),this.renderAxisTooltip(n,i,r.lastChild)):(document.getElementById(this.elementID+"_HorizontalLine").setAttribute("d",o),document.getElementById(this.elementID+"_VerticalLine").setAttribute("d",s),this.renderAxisTooltip(n,i,r.lastChild))},n.prototype.renderCrosshairLine=function(n,t){var i=this.chart.renderer.drawPath(n);t.appendChild(i)},n.prototype.drawCrosshairLine=function(n,t,i,r,u,f,e){var o;if(!document.getElementById(n.id)&&e&&(o=sf.base.createElement("div",{id:n.id}),t.appendChild(o)),document.getElementById(n.id)){var h="top:"+r.toString()+"px;left:"+i.toString()+"px;width:"+u+"px;height:"+f+"px;fill:"+n.stroke+";border: 0.5px solid "+n.stroke+";opacity: "+n.opacity+" ; position: absolute",c=document.getElementById(n.id),s=document.getElementById(this.elementID+"_crosshair_axis");c.setAttribute("style",h);t.style.opacity="1";s&&(s.style.opacity="1")}},n.prototype.renderAxisTooltip=function(n,t,i){for(var r,s,h,e,o,c,l,f,u=0,a=n.axisCollections.length;u<a;u++)if(f=(r=n.axisCollections[u]).placeNextToAxisLine?r.updatedRect:r.rect,r.crosshairTooltip.enable)if(this.valueX<=f.x+f.width&&f.x<=this.valueX||this.valueY<=f.y+f.height&&f.y<=this.valueY){if(e=document.getElementById(this.elementID+"_axis_tooltip_"+u),o=document.getElementById(this.elementID+"_axis_tooltip_text_"+u),!(s=this.getAxisText(r)))continue;(h=this.tooltipLocation(s,r,t,f),null===e)&&(e=n.enableCanvas?this.svgRenderer.drawPath({id:this.elementID+"_axis_tooltip_"+u,fill:r.crosshairTooltip.fill||n.themeStyle.crosshairFill}):n.renderer.drawPath({id:this.elementID+"_axis_tooltip_"+u,fill:r.crosshairTooltip.fill||n.themeStyle.crosshairFill},null),i.appendChild(e),c=new sf.svgbase.TextOption(this.elementID+"_axis_tooltip_text_"+u,0,0,"start",s),o=k(n.enableCanvas?this.svgRenderer:n.renderer,c,r.crosshairTooltip.textStyle,r.crosshairTooltip.textStyle.color||n.themeStyle.crosshairLabel,i,null,null,null,null,null,null,0,null,n.enableCanvas));l=sf.svgbase.findDirection(this.rx,this.ry,h,this.arrowLocation,10,this.isTop,this.isBottom,this.isLeft,this.valueX,this.valueY);e.setAttribute("d",l);o.textContent=s;o.setAttribute("x",(h.x+5).toString());o.setAttribute("y",(h.y+5+3*this.elementSize.height/4).toString())}else w(this.elementID+"_axis_tooltip_"+u),w(this.elementID+"_axis_tooltip_text_"+u)},n.prototype.getAxisText=function(n){var t,i;return this.isBottom=!1,this.isTop=!1,this.isLeft=!1,this.isRight=!1,i="Category"===n.valueType&&"BetweenTicks"===n.labelPlacement?.5:0,"Horizontal"===n.orientation?(t=ku(Math.abs(this.valueX-n.rect.x),n.rect.width,n)+i,this.isBottom=!n.opposedPosition,this.isTop=n.opposedPosition):(t=du(Math.abs(this.valueY-n.rect.y),n.rect.height,n)+i,this.isRight=n.opposedPosition,this.isLeft=!n.opposedPosition),"DateTime"===n.valueType?n.format(new Date(t)):"Category"===n.valueType?n.labels[Math.floor(t)]:"DateTimeCategory"===n.valueType?this.chart.dateTimeCategoryModule.getIndexedAxisLabel(n.labels[Math.floor(t)],n.format):"Logarithmic"===n.valueType?n.format(Math.pow(n.logBase,t)):n.labelFormat&&null!==n.labelFormat.match("{value}")?n.labelFormat.replace("{value}",n.format(t)):n.format(t)},n.prototype.tooltipLocation=function(n,t,i,r){var u,o=i.x,h=i.y,e="Inside"===t.labelPosition,f=t.scrollbarSettings.enable||t.zoomingScrollBar&&t.zoomingScrollBar.svgObject?t.scrollBarHeight:0,c,l,a;return(this.elementSize=sf.svgbase.measureText(n,t.crosshairTooltip.textStyle),"Horizontal"===t.orientation)?(c=e?r.y-this.elementSize.height-20:r.y+f,l=e?r.y-this.elementSize.height-10:r.y+10,this.arrowLocation=new s(this.valueX,c),u=new sf.svgbase.Rect(this.valueX-this.elementSize.width/2-5,l+(e?0:f),this.elementSize.width+10,this.elementSize.height+10),t.opposedPosition&&(u.y=e?r.y:r.y-(this.elementSize.height+10+10)-f),u.x<o&&(u.x=o),u.x+u.width>o+i.width&&(u.x-=u.x+u.width-(o+i.width)),this.arrowLocation.x+5>u.x+u.width-this.rx&&(this.arrowLocation.x=u.x+u.width-this.rx-5),this.arrowLocation.x-5<u.x+this.rx&&(this.arrowLocation.x=u.x+this.rx+5)):(f*=t.opposedPosition?1:-1,this.arrowLocation=new s(r.x,this.valueY),a=e?r.x-f:r.x-this.elementSize.width-20,u=new sf.svgbase.Rect(a+f,this.valueY-this.elementSize.height/2-5,this.elementSize.width+10,this.elementSize.height+10),t.opposedPosition?(u.x=e?r.x-this.elementSize.width-10:r.x+10+f,u.x+u.width>this.chart.availableSize.width&&(this.arrowLocation.x-=u.x+u.width-this.chart.availableSize.width,u.x-=u.x+u.width-this.chart.availableSize.width)):u.x<0&&(this.arrowLocation.x-=u.x,u.x=0),u.y<h&&(u.y=h),u.y+u.height>=h+i.height&&(u.y-=u.y+u.height-(h+i.height)),this.arrowLocation.y+5>u.y+u.height-this.ry&&(this.arrowLocation.y=u.y+u.height-this.ry-5),this.arrowLocation.y-5<u.y+this.ry&&(this.arrowLocation.y=u.y+this.ry+5)),u},n.prototype.stopAnimation=function(){or(this.crosshairInterval)},n.prototype.progressAnimation=function(){or(this.crosshairInterval)},n.prototype.removeCrosshair=function(n){var t=this.chart,i=t.enableCanvas?document.getElementById(this.elementID+"_Crosshair"):document.getElementById(this.elementID+"_UserInteraction"),r=t.enableCanvas?document.getElementById(this.elementID+"_crosshair_axis"):null;this.stopAnimation();i&&"0"!==i.getAttribute("opacity")&&(this.crosshairInterval=+setTimeout(function(){new sf.base.Animation({}).animate(i,{duration:200,progress:function(n){i.style.animation="";t.enableCanvas?(i.style.opacity=(1-n.timeStamp/n.duration).toString(),r.style.opacity=(1-n.timeStamp/n.duration).toString()):i.setAttribute("opacity",(1-n.timeStamp/n.duration).toString())},end:function(){t.enableCanvas?(i.style.opacity="0",r.style.opacity="0"):i.setAttribute("opacity","0");t.startMove=!1;t.tooltipModule&&(t.tooltipModule.valueX=null,t.tooltipModule.valueY=null)}})},n))},n.prototype.getModuleName=function(){return"Crosshair"},n.prototype.destroy=function(){},n}(),tb=(ns=function(n,t){return(ns=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ns(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ib=function(n){function t(t){var i=n.call(this,t)||this;return i.element=i.chart.element,i.textStyle=t.tooltip.textStyle,i.control=t,i}return tb(t,n),t.prototype.getElement=function(n){return document.getElementById(n)},t.prototype.getTooltipElement=function(n){this.inverted=this.chart.requireInvertedAxis;this.header=null===this.control.tooltip.header?this.control.tooltip.shared?"<b>${point.x}<\/b>":"<b>${series.name}<\/b>":this.control.tooltip.header;this.formattedText=[];var t=document.getElementById(this.chart.element.id+"_tooltip"),i=this.chart.element.id.indexOf("stockChart")>-1;return!n&&!t||i?this.createElement():null},t.prototype.createElement=function(){var n=document.createElement("div");return n.id=this.element.id+"_tooltip",n.className="ejSVGTooltip",n.setAttribute("style","pointer-events:none; position:absolute;z-index: 1"),n},t.prototype.pushData=function(n,t,i){return!!n.series.enableTooltip&&(this.currentPoints.push(n),this.stopAnimation(),i&&!document.getElementById(i.id)&&(this.chart.stockChart?document.getElementById(this.chart.stockChart.element.id+"_Secondary_Element").appendChild(i):document.getElementById(this.element.id+"_Secondary_Element").appendChild(i)),!0)},t.prototype.removeHighlight=function(){for(var n,t=0,i=this.previousPoints.length;t<i;t++)(n=this.previousPoints[t]).series.isRectSeries?n.series.visible&&this.highlightPoint(n.series,n.point.index,!1):n.series.marker.visible||"Scatter"===n.series.type||"Bubble"===n.series.type||(this.previousPoints.shift(),i-=1)},t.prototype.highlightPoint=function(n,t,i){var r=this.getElement(this.element.id+"_Series_"+n.index+"_Point_"+t),u=this.control.accumulationSelectionModule,f=!!(u&&u.selectedDataIndexes.length>0);r&&(!f||f&&r.getAttribute("class")&&-1===r.getAttribute("class").indexOf("_ej2_chart_selection_series_")?r.setAttribute("opacity",(i?n.opacity/2:n.opacity).toString()):r.setAttribute("opacity",n.opacity.toString()))},t.prototype.highlightPoints=function(){for(var n,t=0,i=this.currentPoints;t<i.length;t++)n=i[t],n.series.isRectSeries&&"Series"===n.series.category&&this.highlightPoint(n.series,n.point.index,!0)},t.prototype.createTooltip=function(n,t,i,r,u,f,e,o,h,c,l){var b,y,a,nt,tt;if(void 0===h&&(h=null),void 0===c&&(c=null),b=this.currentPoints[0].series,y=n.tooltipModule||n.accumulationTooltipModule,y){var k=b.isRectSeries&&"Waterfall"!==b.type&&u&&u.y<0,d=this.chart.requireInvertedAxis&&b.isRectSeries,v=null;if(this.text.length<=1){var p=void 0,w=void 0,g=l||n.tooltip.template;g&&"chart"===n.getModuleName()&&"#"!==g[0]&&"string"==typeof g?(a=document.createElement("div"),a.id="testing_template",a.className="ejSVGTooltip",a.setAttribute("style","pointer-events:none; position:absolute;z-index: 1"),document.getElementById(this.chart.element.id+"_Secondary_Element").appendChild(a),nt=g.replaceAll("${x}",u.x).replaceAll("${y}",u.y),a.innerHTML=nt,p=new sf.svgbase.Size(a.firstElementChild.offsetWidth,a.firstElementChild.offsetHeight),w=new sf.svgbase.Size(0,0),a.remove()):(p=sf.svgbase.measureText(this.text[0],n.tooltip.textStyle),w=""!==this.header&&"<b><\/b>"!==this.header?sf.svgbase.measureText(this.header,this.textStyle):new sf.svgbase.Size(0,0));p.width=Math.max(p.width,w.width)+(f.length>0?47:0);tt=32+(w.height>0?20:0);p.height=p.height+w.height+tt;v=this.getCurrentPosition(k,d);k="Left"===(v=this.getPositionBySize(p,new sf.svgbase.Rect(0,0,o.width,o.height),i,v))||"Bottom"===v;d="Left"===v||"Right"===v}t?this.svgTooltip=new sf.svgbase.Tooltip({opacity:n.tooltip.opacity,header:this.headerText,content:this.text,fill:n.tooltip.fill,border:n.tooltip.border,enableAnimation:n.tooltip.enableAnimation,location:i,shared:n.tooltip.shared,shapes:f,clipBounds:"PolarRadar"===this.chart.chartAreaType?new s(0,0):r,areaBounds:o,palette:this.findPalette(),template:l||n.tooltip.template,data:c,theme:n.theme,offset:e,textStyle:n.tooltip.textStyle,isNegative:k,inverted:d,arrowPadding:this.text.length>1||this.chart.stockChart?0:12,availableSize:n.availableSize,duration:this.chart.tooltip.duration,isCanvas:this.chart.enableCanvas,isTextWrap:n.tooltip.enableTextWrap&&"chart"===n.getModuleName(),blazorTemplate:{name:"Template",parent:this.chart.tooltip},controlInstance:this.chart,tooltipPlacement:v,tooltipRender:function(){y.removeHighlight();y.highlightPoints();y.updatePreviousPoint(h)},animationComplete:function(n){n.tooltip.fadeOuted&&y.fadeOut(y.previousPoints)}},"#"+this.element.id+"_tooltip"):this.svgTooltip&&(this.svgTooltip.location=i,this.svgTooltip.content=this.text,this.svgTooltip.header=this.headerText,this.svgTooltip.offset=e,this.svgTooltip.palette=this.findPalette(),this.svgTooltip.shapes=f,this.svgTooltip.data=c,this.svgTooltip.template=n.tooltip.template,this.svgTooltip.textStyle=n.tooltip.textStyle,this.svgTooltip.isNegative=k,this.svgTooltip.inverted=d,this.svgTooltip.clipBounds="PolarRadar"===this.chart.chartAreaType?new s(0,0):r,this.svgTooltip.arrowPadding=this.text.length>1||this.chart.stockChart?0:12,this.svgTooltip.tooltipPlacement=v,this.svgTooltip.dataBind());this.chart.isReact&&this.chart.renderReactTemplates()}},t.prototype.getPositionBySize=function(n,t,i,r){var u=this.isTooltipFitPosition("Top",new sf.svgbase.Rect(0,0,t.width,t.height),i,n),o=this.isTooltipFitPosition("Bottom",new sf.svgbase.Rect(0,0,t.width,t.height),i,n),f=this.isTooltipFitPosition("Right",new sf.svgbase.Rect(0,0,t.width,t.height),i,n),s=this.isTooltipFitPosition("Left",new sf.svgbase.Rect(0,0,t.width,t.height),i,n),h,e;return(u||o||f||s)?"Top"===r?u?"Top":o?"Bottom":f?"Right":"Left":"Bottom"===r?o?"Bottom":u?"Top":f?"Right":"Left":"Right"===r?f?"Right":s?"Left":u?"Top":"Bottom":s?"Left":f?"Right":u?"Top":"Bottom":(h=[i.x-t.x,t.x+t.width-i.x,i.y-t.y,t.y+t.height-i.y],e=h.indexOf(Math.max.apply(this,h)),0===e?"Left":1===e?"Right":2===e?"Top":"Bottom")},t.prototype.isTooltipFitPosition=function(n,t,i,r){var u=new s(0,0),f=new s(0,0);switch(n){case"Top":u.x=i.x-r.width/2;u.y=i.y-r.height;f.x=i.x+r.width/2;f.y=i.y;break;case"Bottom":u.x=i.x-r.width/2;u.y=i.y;f.x=i.x+r.width/2;f.y=i.y+r.height;break;case"Right":u.x=i.x;u.y=i.y-r.height/2;f.x=i.x+r.width;f.y=i.y+r.height/2;break;case"Left":u.x=i.x-r.width;u.y=i.y-r.height/2;f.x=i.x;f.y=i.y+r.height/2}return v(u.x,u.y,t)&&v(f.x,f.y,t)},t.prototype.getCurrentPosition=function(n,t){return t?n?"Left":"Right":n?"Bottom":"Top"},t.prototype.findPalette=function(){for(var t,i=[],n=0,r=this.currentPoints;n<r.length;n++)t=r[n],i.push(this.findColor(t,t.series));return i},t.prototype.findColor=function(n,t){return!t.isRectSeries||"Candle"!==t.type&&"Hilo"!==t.type&&"HiloOpenClose"!==t.type?(n.point.color&&"#ffffff"!==n.point.color?n.point.color:n.point.interior)||t.marker.fill||t.interior:n.point.color},t.prototype.updatePreviousPoint=function(n){n&&(this.currentPoints=this.currentPoints.concat(n));this.previousPoints=sf.base.extend([],this.currentPoints,null,!0)},t.prototype.fadeOut=function(n){var t=this.chart.enableCanvas?this.getElement(this.element.id+"_tooltip_group"):this.getElement(this.element.id+"_tooltip_svg");t&&parseInt(t.getAttribute("opacity"),10)>0||(this.valueX=null,this.valueY=null,this.currentPoints=[],this.removeHighlight(),this.removeHighlightedMarker(n),this.svgTooltip=null,this.control.trigger("animationComplete",{}))},t.prototype.removeHighlightedMarker=function(n){var t,i,r;if(this.chart.markerRender){for(t=0,i=n;t<i.length;t++)r=i[t],w(this.element.id+"_Series_"+r.series.index+"_Point_"+r.point.index+"_Trackball");this.chart.markerRender.removeHighlightedMarker()}this.previousPoints=[]},t.prototype.removeText=function(){this.textElements=[];var n=this.getElement(this.element.id+"_tooltip_group");if(n&&n.childNodes.length>0)for(;n.lastChild&&1!==n.childNodes.length;)n.removeChild(n.lastChild)},t.prototype.stopAnimation=function(){or(this.toolTipInterval)},t.prototype.removeTooltip=function(n){var r=this,t=this.getElement(this.element.id+"_tooltip"),i=t?this.getElement(t.id+"parent_template"):null,u=i&&"<div><\/div>"!==i.innerHTML;this.stopAnimation();this.chart.isReact&&u&&this.chart.clearTemplate([i.id],[0]);t&&this.previousPoints.length>0&&(this.toolTipInterval=+setTimeout(function(){r.svgTooltip&&r.svgTooltip.fadeOut()},n))},t}(lr),rb=(ts=function(n,t){return(ts=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ts(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),vv=function(n){function t(t){var i=n.call(this,t)||this;return i.addEventListener(),i}return rb(t,n),t.prototype.addEventListener=function(){if(!this.chart.isDestroyed){var n=sf.base.Browser.isPointer?"pointerleave":"mouseleave";this.chart.on(n,this.mouseLeaveHandler,this);this.chart.on("tapHold",this.longPress,this);this.chart.on(sf.base.Browser.touchMoveEvent,this.mouseMoveHandler,this);this.chart.on(sf.base.Browser.touchEndEvent,this.mouseUpHandler,this)}},t.prototype.mouseUpHandler=function(){var n=this.control,t=this.getData();t.lierIndex=this.lierIndex;n.isTouch&&!this.isSelected(n)&&(v(n.mouseX,n.mouseY,n.chartAxisLayoutPanel.seriesClipRect)&&n.tooltip.shared||!n.tooltip.shared)?n.crosshair.enable?n.startMove&&"Move"===n.tooltip.fadeOutMode&&this.removeTooltip(2e3):(this.tooltip(),"Move"===n.tooltip.fadeOutMode&&this.removeTooltip(2e3)):this.findData(t,this.previousPoints[0])||"Click"!==n.tooltip.fadeOutMode||this.removeTooltip(0)},t.prototype.mouseLeaveHandler=function(){this.removeTooltip(this.chart.tooltip.fadeOutDuration)},t.prototype.mouseMoveHandler=function(){var n=this.chart;n.disableTrackTooltip||this.isSelected(n)||(n.tooltip.shared||n.isTouch&&!n.startMove||this.tooltip(),v(n.mouseX,n.mouseY,n.chartAxisLayoutPanel.seriesClipRect)?!n.tooltip.shared||n.isTouch&&!n.startMove||this.tooltip():n.tooltip.shared&&"Move"===n.tooltip.fadeOutMode&&this.removeTooltip(this.chart.tooltip.fadeOutDuration))},t.prototype.longPress=function(){var n=this.chart;return n.crosshair.enable&&v(n.mouseX,n.mouseY,n.chartAxisLayoutPanel.seriesClipRect)&&this.tooltip(),!1},t.prototype.tooltip=function(){if(this.chart.stockChart&&this.chart.stockChart.onPanning)return this.removeTooltip(1e3),null;var r=this.chart.enableCanvas?this.element.id+"_tooltip_group":this.element.id+"_tooltip_svg",t=this.getElement(r),u=this.chart.stockChart&&t&&t.firstChild.childNodes.length>1,i=t&&parseInt(t.getAttribute("opacity"),10)>0&&!u,n=this.getTooltipElement(i);this.chart.enableCanvas&&n&&(document.getElementById(this.chart.element.id+"_Secondary_Element").appendChild(n),n.appendChild(document.getElementById(this.chart.element.id+"_tooltip_svg")));this.chart.tooltip.shared?this.renderGroupedTooltip(this.chart,!i,n):this.renderSeriesTooltip(this.chart,!i,n)},t.prototype.findHeader=function(n){return""===this.header?"":(this.header=this.parseTemplate(n.point,n.series,this.header,n.series.xAxis,n.series.yAxis),""!==this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()?this.header:"")},t.prototype.findShapes=function(){var t;if(!this.chart.tooltip.enableMarker)return[];for(var i=[],n=0,r=this.currentPoints;n<r.length;n++)t=r[n],i.push(t.point.marker.shape||t.series.marker.shape);return i},t.prototype.renderSeriesTooltip=function(n,t,i){var r=this.getData(),u;if(r.lierIndex=this.lierIndex,this.currentPoints=[],this.findData(r,this.previousPoints[0])){if((!n.dataEditingModule||!n.dataEditingModule.isPointDragging)&&this.previousPoints[0]&&r.point.index===this.previousPoints[0].point.index&&r.series.index===this.previousPoints[0].series.index)return null;this.pushData(r,t,i,!0)&&this.triggerTooltipRender(r,t,this.getTooltipText(r),this.findHeader(r))}else if(!r.point&&this.isRemove&&"Move"===n.tooltip.fadeOutMode)this.removeTooltip(this.chart.tooltip.fadeOutDuration),this.isRemove=!1;else for(var o=this.mergeXvalues(this.chart.visibleSeries),f=0,e=n.visibleSeries;f<e.length;f++)u=e[f],u.visible&&"TrendLine"!==u.category&&(r=this.getClosestX(n,u,o)||r);r&&r.point&&this.findMouseValue(r,n)},t.prototype.triggerTooltipRender=function(n,t,i,r){var u=this,e={cancel:!1,name:"tooltipRender",text:i,headerText:r,template:void 0,series:this.chart.isBlazor?{}:n.series,textStyle:this.textStyle,point:n.point,data:{pointX:n.point.x,pointY:n.point.y,seriesIndex:n.series.index,seriesName:n.series.name,pointIndex:n.point.index,pointText:n.point.text}},f=function(i){i.cancel?(u.removeHighlight(),sf.base.remove(u.getElement(u.element.id+"_tooltip"))):("BoxAndWhisker"===n.series.type&&(u.removeText(),t=!0),u.headerText=i.headerText,u.formattedText=u.formattedText.concat(i.text),u.text=u.formattedText,u.createTooltip(u.chart,t,u.getSymbolLocation(n),n.series.clipRect,n.point,u.findShapes(),u.findMarkerHeight(u.currentPoints[0]),u.chart.chartAxisLayoutPanel.seriesClipRect,null,u.getTemplateText(n),u.chart.tooltip.template?i.template:""));u.isRemove=!0};f.bind(this,n);this.chart.trigger("tooltipRender",e,f)},t.prototype.findMarkerHeight=function(n){if(!this.chart.tooltip.enableMarker)return 0;var t=n.series;return(t.marker.visible||this.chart.tooltip.shared&&(!t.isRectSeries||t.marker.visible)||"Scatter"===t.type||"Scatter"===t.drawType)&&"Candle"!==t.type&&"Hilo"!==t.type&&"HiloOpenClose"!==t.type?(t.marker.height+2)/2+2*t.marker.border.width:0},t.prototype.findData=function(n,t){return n.point&&(!t||t.point!==n.point||t&&t.lierIndex>3&&t.lierIndex!==this.lierIndex||t.point===n.point)},t.prototype.getSymbolLocation=function(n){var t;if("BoxAndWhisker"!==n.series.type){if(!n.point.symbolLocations[0])return null;t=new s(n.point.symbolLocations[0].x,n.point.symbolLocations[0].y)}switch(n.series.type){case"BoxAndWhisker":return this.getBoxLocation(n);case"Waterfall":return this.getWaterfallRegion(n,t);case"RangeArea":case"SplineRangeArea":return this.getRangeArea(n,t);default:return t}},t.prototype.getRangeArea=function(n,t){return n.point.regions[0]&&(this.inverted?t.x=n.point.regions[0].x+n.point.regions[0].width/2:t.y=n.point.regions[0].y+n.point.regions[0].height/2),t},t.prototype.getWaterfallRegion=function(n,t){return this.inverted?t.x=n.point.y<0?t.x+n.point.regions[0].width:t.x:t.y=n.point.y<0?t.y-n.point.regions[0].height:t.y,t},t.prototype.getTooltipText=function(n){var t=n.series;return this.parseTemplate(n.point,t,this.getFormat(this.chart,t),t.xAxis,t.yAxis)},t.prototype.getTemplateText=function(n){if(this.chart.tooltip.template){var t=sf.base.extend({},n.point);return t.x=this.formatPointValue(n.point,n.series.xAxis,"x",!0,!1),"XY"===n.series.seriesType?t.y=this.formatPointValue(n.point,n.series.yAxis,"y",!1,!0):(t.low=this.formatPointValue(n.point,n.series.yAxis,"low",!1,!0),t.high=this.formatPointValue(n.point,n.series.yAxis,"high",!1,!0)),t}return n.point},t.prototype.findMouseValue=function(n,t){t.requireInvertedAxis?(this.valueY=(1-a(n.point.xValue,n.series.xAxis))*n.series.xAxis.rect.height+n.series.xAxis.rect.y,this.valueX=t.mouseX):(this.valueX="PolarRadar"===t.chartAreaType?ft(n.point.xValue,n.series.xAxis)*n.series.xAxis.rect.width+n.series.xAxis.rect.x:"TrendLine"===n.series.category&&t.tooltip.shared?this.valueX:a(n.point.xValue,n.series.xAxis)*n.series.xAxis.rect.width+n.series.xAxis.rect.x,this.valueY=t.mouseY)},t.prototype.renderGroupedTooltip=function(n,t,i){var r,o,h="PolarRadar"===n.chartAreaType?this.getData():null,e,u;this.stopAnimation();this.removeHighlight();this.currentPoints=[];e=[];t&&(n.stockChart?i&&!sf.svgbase.getElement(i.id)&&document.getElementById(n.stockChart.element.id+"_Secondary_Element").appendChild(i):i&&document.getElementById(this.element.id+"_Secondary_Element").appendChild(i));this.removeText();for(var f={text:[],cancel:!1,name:"sharedTooltipRender",data:[],headerText:"",textStyle:this.textStyle},l=this.mergeXvalues(this.chart.visibleSeries),s=0,c=n.visibleSeries;s<c.length;s++)u=c[s],u.enableTooltip&&u.visible&&("Cartesian"===n.chartAreaType&&u.visible?r=this.getClosestX(n,u,l):"PolarRadar"===n.chartAreaType&&u.visible&&null!==h.point&&(r=new tr(u.points[h.point.index],u)),r&&(n.isBlazor?(f.data.push({pointX:r.point.x,pointY:r.point.y,seriesIndex:r.series.index,seriesName:r.series.name,pointIndex:r.point.index,pointText:r.point.text}),f.headerText=this.findHeader(r),this.currentPoints.push(r),f.text.push(this.getTooltipText(r)),o="TrendLine"===r.series.category&&n.tooltip.shared?o:r):this.triggerSharedTooltip(r,t,this.getTooltipText(r),this.findHeader(r),e)));n.isBlazor&&r&&this.triggerBlazorSharedTooltip(f,o,e,n,t);this.currentPoints.length>0?this.createTooltip(n,t,this.findSharedLocation(),1===this.currentPoints.length?this.currentPoints[0].series.clipRect:null,null,this.findShapes(),this.findMarkerHeight(this.currentPoints[0]),n.chartAxisLayoutPanel.seriesClipRect,e,this.chart.tooltip.template?this.getTemplateText(r):null,this.chart.tooltip.template?f.template:""):this.getElement(this.element.id+"_tooltip_path")&&this.getElement(this.element.id+"_tooltip_path").setAttribute("d","")},t.prototype.triggerBlazorSharedTooltip=function(n,t,i,r,u){var f=this,o={cancel:!1,name:"sharedTooltipRender",text:n.text,headerText:n.headerText,textStyle:n.textStyle,data:n.data},e=function(n){n.cancel?i.push(t):(f.text=n.text,f.headerText=n.headerText,f.findMouseValue(t,f.chart),t=null,f.createTooltip(r,u,f.findSharedLocation(),null,null,f.findShapes(),f.findMarkerHeight(f.currentPoints[0]),r.chartAxisLayoutPanel.seriesClipRect,i))};e.bind(this,t,i);this.chart.trigger("sharedTooltipRender",o,e)},t.prototype.triggerSharedTooltip=function(n,t,i,r,u){var f=this,e={cancel:!1,name:"tooltipRender",text:i,headerText:r,point:n.point,series:this.chart.isBlazor?{}:n.series,textStyle:this.textStyle,data:{pointX:n.point.x,pointY:n.point.y,seriesIndex:n.series.index,seriesName:n.series.name,pointIndex:n.point.index,pointText:n.point.text}},o=function(t){t.cancel?u.push(n):("BoxAndWhisker"===n.series.type&&(f.removeText(),!0),f.formattedText=f.formattedText.concat(t.text),f.text=f.formattedText,f.headerText=t.headerText,f.findMouseValue(n,f.chart),f.currentPoints.push(n),n=null)};o.bind(this,n,u);this.chart.trigger("tooltipRender",e,o);e.template&&(this.chart.tooltip.template=e.template)},t.prototype.findSharedLocation=function(){var n=this.chart.stockChart;if(n){1===this.text.length&&this.text.push("");var t=n.enablePeriodSelector?n.toolbarHeight:0,i=document.getElementById(n.element.id+"_ChartTitle"),r=""!==n.title?i.getBoundingClientRect().height+10:0;return new s(this.chart.chartAxisLayoutPanel.seriesClipRect.x+5,this.chart.chartAxisLayoutPanel.seriesClipRect.y+t+5+r)}return this.currentPoints.length>1?new s(this.valueX,this.valueY):this.getSymbolLocation(this.currentPoints[0])},t.prototype.getBoxLocation=function(n){return this.lierIndex>3?n.point.symbolLocations[this.lierIndex-4]:{x:n.point.regions[0].x+n.point.regions[0].width/2,y:n.point.regions[0].y+n.point.regions[0].height/2}},t.prototype.parseTemplate=function(n,t,i,r,u){for(var f,l,e,s,c,o=0,h=Object.keys(n);o<h.length;o++)e=h[o],f=new RegExp("${point."+e+"}","gm"),i=i.replace(f.source,this.formatPointValue(n,"${point.x}"===f.source?r:u,e,"${point.x}"===f.source,"${point.high}"===f.source||"${point.open}"===f.source||"${point.close}"===f.source||"${point.low}"===f.source||"${point.y}"===f.source||"${point.minimum}"===f.source||"${point.maximum}"===f.source||"${point.outliers}"===f.source||"${point.upperQuartile}"===f.source||"${point.lowerQuartile}"===f.source||"${point.median}"===f.source));for(s=0,c=Object.keys(Object.getPrototypeOf(t));s<c.length;s++)e=c[s],f=new RegExp("${series."+e+"}","gm"),l=t[e],i=i.replace(f.source,l);return i},t.prototype.formatPointValue=function(n,t,i,r,u){var f,e,o;return"Category"!==t.valueType&&r?f=(e=t.labelFormat&&null!==t.labelFormat.match("{value}"))?t.labelFormat.replace("{value}",t.format(n[i])):t.format(n[i]):u&&!sf.base.isNullOrUndefined(n[i])?(e=t.labelFormat&&null!==t.labelFormat.match("{value}"),o="outliers"===i?t.format(n[i][this.lierIndex-4]):t.format(n[i]),f=e?t.labelFormat.replace("{value}",o):o):f=n[i],f},t.prototype.getFormat=function(n,t){if(t.tooltipFormat)return"XY"===t.seriesType&&"Indicator"===t.category?this.getIndicatorTooltipFormat(t,n,n.tooltip.format):t.tooltipFormat;if(!t.tooltipFormat&&n.tooltip.format)return"XY"===t.seriesType&&"Indicator"===t.category?this.getIndicatorTooltipFormat(t,n,n.tooltip.format):n.tooltip.format;var r="Histogram"===t.type?"${point.minimum}-${point.maximum}":"${point.x}",i=n.tooltip.shared?"${series.name}":r;switch(t.seriesType){case"XY":return"Indicator"===t.category&&this.getIndicatorTooltipFormat(t,n,n.tooltip.format),i+" : "+("Bubble"===t.type?"<b>${point.y}<\/b>  Size : <b>${point.size}<\/b>":"<b>${point.y}<\/b>");case"HighLow":return i+"<br/>High : <b>${point.high}<\/b><br/>Low : <b>${point.low}<\/b>";case"HighLowOpenClose":return i+"<br/>High : <b>${point.high}<\/b><br/>Low : <b>${point.low}<\/b><br/>Open : <b>${point.open}<\/b><br/>Close : <b>${point.close}<\/b>";case"BoxPlot":return i+"<br/>"+(this.lierIndex>3?"Outliers : <b>${point.outliers}<\/b>":"Maximum : <b>${point.maximum}<\/b><br/>Q3 : <b>${point.upperQuartile}<\/b><br/>Median : <b>${point.median}<\/b><br/>Q1 : <b>${point.lowerQuartile}<\/b><br/>Minimum : <b>${point.minimum}<\/b>");default:return""}},t.prototype.getIndicatorTooltipFormat=function(n,t,i){return"XY"===n.seriesType?n.name+" : <b>${point.y}<\/b>":i},t.prototype.removeHighlightedMarker=function(n){for(var r,t=0,i=n;t<i.length;t++)r=i[t],w(this.element.id+"_Series_"+r.series.index+"_Point_"+r.point.index+"_Trackball");this.chart.markerRender&&this.chart.markerRender.removeHighlightedMarker();this.previousPoints=[]},t.prototype.getModuleName=function(){return"Tooltip"},t.prototype.destroy=function(){},t}(ib),ub=function(){function n(n){this.iconRectOverFill="transparent";this.iconRectSelectionFill="transparent";this.zoomCompleteEvtCollection=[];this.chart=n;this.elementId=n.element.id;this.chart.svgRenderer=new sf.svgbase.SvgRenderer(this.elementId);this.selectionColor="Bootstrap4"===n.theme?"#FFFFFF":"Tailwind"===n.theme||"Bootstrap5"===n.theme||"Bootstrap5Dark"===n.theme||"TailwindDark"===n.theme?"#374151":"#ff4081";this.fillColor="Bootstrap4"===n.theme?"#495057":"Tailwind"===n.theme?"#6B7280":"TailwindDark"===n.theme?"#D1D5DB":"#737373";this.iconRectOverFill="Bootstrap4"===n.theme?"#5A6268":this.iconRectOverFill;this.iconRectSelectionFill="Bootstrap4"===n.theme?"#5B6269":this.iconRectSelectionFill;this.iconRect="Bootstrap4"===n.theme?new sf.svgbase.Rect(-5,-5,26,26):new sf.svgbase.Rect(0,0,16,16)}return n.prototype.createPanButton=function(n,t){var i=this.chart.svgRenderer,r=this.chart.zoomModule.isPanning?this.selectionColor:this.fillColor;n.id=this.elementId+"_Zooming_Pan";n.setAttribute("aria-label",this.chart.getLocalizedLabel("Pan"));this.panElements=n;n.appendChild(i.drawRectangle(new y(this.elementId+"_Zooming_Pan_1","transparent",{},1,this.iconRect)));n.appendChild(i.drawPath(new sf.svgbase.PathOption(this.elementId+"_Zooming_Pan_2",r,null,null,1,null,"M5,3h2.3L7.275,5.875h1.4L8.65,3H11L8,0L5,3z M3,11V8.7l2.875,0.025v-1.4L3,7.35V5L0,8L3,11z M11,13H8.7l0.025-2.875h-1.4L7.35,13H5l3,3L11,13z M13,5v2.3l-2.875-0.025v1.4L13,8.65V11l3-3L13,5z")));t.appendChild(n);this.wireEvents(n,this.pan)},n.prototype.createZoomButton=function(n,t){var r=this.chart.svgRenderer,u=this.chart.zoomModule.isPanning?this.fillColor:this.selectionColor,f=this.chart.zoomModule.isPanning?"transparent":this.iconRectSelectionFill,i="M0.001,14.629L1.372,16l4.571-4.571v-0.685l0.228-0.274c1.051,0.868,2.423,1.417,3.885,1.417c3.291,0,";i+="5.943-2.651,5.943-5.943S13.395,0,10.103,0S4.16,2.651,4.16,5.943c0,1.508,0.503,2.834,1.417,3.885l-0.274,0.228H4.571";i+="L0.001,14.629L0.001,14.629z M5.943,5.943c0-2.285,1.828-4.114,4.114-4.114s4.114,1.828,4.114,";n.id=this.elementId+"_Zooming_Zoom";n.setAttribute("aria-label",this.chart.getLocalizedLabel("Zoom"));this.zoomElements=n;this.selectedID=this.chart.zoomModule.isPanning?this.chart.element.id+"_Zooming_Pan_1":this.elementId+"_Zooming_Zoom_1";n.appendChild(r.drawRectangle(new y(this.elementId+"_Zooming_Zoom_1",f,{},1,this.iconRect)));n.appendChild(r.drawPath(new sf.svgbase.PathOption(this.elementId+"_Zooming_Zoom_3",u,null,null,1,null,i+"4.114s-1.828,4.114-4.114,4.114S5.943,8.229,5.943,5.943z")));t.appendChild(n);this.wireEvents(n,this.zoom)},n.prototype.createZoomInButton=function(n,t,i){var r=this.chart.svgRenderer,u=this.fillColor;n.id=this.elementId+"_Zooming_ZoomIn";n.setAttribute("aria-label",this.chart.getLocalizedLabel("ZoomIn"));n.appendChild(r.drawRectangle(new y(this.elementId+"_Zooming_ZoomIn_1","transparent",{},1,this.iconRect)));n.appendChild(r.drawPath(new sf.svgbase.PathOption(this.elementId+"_Zooming_ZoomIn_2",u,null,null,1,null,"M10.103,0C6.812,0,4.16,2.651,4.16,5.943c0,1.509,0.503,2.834,1.417,3.885l-0.274,0.229H4.571L0,14.628l0,0L1.372,16l4.571-4.572v-0.685l0.228-0.275c1.052,0.868,2.423,1.417,3.885,1.417c3.291,0,5.943-2.651,5.943-5.943C16,2.651,13.395,0,10.103,0z M10.058,10.058c-2.286,0-4.114-1.828-4.114-4.114c0-2.286,1.828-4.114,4.114-4.114c2.286,0,4.114,1.828,4.114,4.114C14.172,8.229,12.344,10.058,10.058,10.058z")));n.appendChild(r.drawPolygon(new il(this.elementId+"_Zooming_ZoomIn_3","12.749,5.466 10.749,5.466 10.749,3.466 9.749,3.466 9.749,5.466 7.749,5.466 7.749,6.466 9.749,6.466 9.749,8.466 10.749,8.466 10.749,6.466 12.749,6.466",u)));this.zoomInElements=n;this.elementOpacity=i.zoomModule.isPanning?"0.2":"1";n.setAttribute("opacity",this.elementOpacity);t.appendChild(n);this.wireEvents(n,this.zoomIn)},n.prototype.createZoomOutButton=function(n,t,i){var r=this.chart.svgRenderer,u=this.fillColor;n.id=this.elementId+"_Zooming_ZoomOut";n.setAttribute("aria-label",this.chart.getLocalizedLabel("ZoomOut"));n.appendChild(r.drawRectangle(new y(this.elementId+"_Zooming_ZoomOut_1","transparent",{},1,this.iconRect)));n.appendChild(r.drawPath(new sf.svgbase.PathOption(this.elementId+"_Zooming_ZoomOut_2",u,null,null,1,null,"M0,14.622L1.378,16l4.533-4.533v-0.711l0.266-0.266c1.022,0.889,2.4,1.422,3.866,1.422c3.289,0,5.955-2.666,5.955-5.955S13.333,0,10.044,0S4.089,2.667,4.134,5.911c0,1.466,0.533,2.844,1.422,3.866l-0.266,0.266H4.578L0,14.622L0,14.622z M5.911,5.911c0-2.311,1.822-4.133,4.133-4.133s4.133,1.822,4.133,4.133s-1.866,4.133-4.133,4.133S5.911,8.222,5.911,5.911z M12.567,6.466h-5v-1h5V6.466z")));this.zoomOutElements=n;this.elementOpacity=i.zoomModule.isPanning?"0.2":"1";n.setAttribute("opacity",this.elementOpacity);t.appendChild(n);this.wireEvents(n,this.zoomOut)},n.prototype.createResetButton=function(n,t,i,r){var u,f=this.chart.svgRenderer,e=this.fillColor;n.id=this.elementId+"_Zooming_Reset";n.setAttribute("aria-label",this.chart.getLocalizedLabel("Reset"));r?(u=sf.svgbase.measureText(this.chart.getLocalizedLabel("ResetZoom"),{size:"12px"}),n.appendChild(f.drawRectangle(new y(this.elementId+"_Zooming_Reset_1","transparent",{},1,new sf.svgbase.Rect(0,0,u.width,u.height)))),k(i.renderer,new sf.svgbase.TextOption(this.elementId+"_Zooming_Reset_2",0+u.width/2,0+3*u.height/4,"middle",this.chart.getLocalizedLabel("ResetZoom"),"rotate(0,0,0)","auto"),{size:"12px"},"black",n,null,null,null,null,null,null,0,null,i.enableCanvas)):(n.appendChild(f.drawRectangle(new y(this.elementId+"_Zooming_Reset_1","transparent",{},1,this.iconRect))),n.appendChild(f.drawPath(new sf.svgbase.PathOption(this.elementId+"_Zooming_Reset_2",e,null,null,1,null,"M12.364,8h-2.182l2.909,3.25L16,8h-2.182c0-3.575-2.618-6.5-5.818-6.5c-1.128,0-2.218,0.366-3.091,1.016l1.055,1.178C6.581,3.328,7.272,3.125,8,3.125C10.4,3.125,12.363,5.319,12.364,8L12.364,8z M11.091,13.484l-1.055-1.178C9.419,12.672,8.728,12.875,8,12.875c-2.4,0-4.364-2.194-4.364-4.875h2.182L2.909,4.75L0,8h2.182c0,3.575,2.618,6.5,5.818,6.5C9.128,14.5,10.219,14.134,11.091,13.484L11.091,13.484z"))));t.appendChild(n);this.wireEvents(n,this.reset)},n.prototype.wireEvents=function(n,t){sf.base.EventHandler.add(n,"mousedown touchstart",t,this);sf.base.EventHandler.add(n,"mouseover",this.showTooltip,this);sf.base.EventHandler.add(n,"mouseout",this.removeTooltip,this)},n.prototype.showTooltip=function(n){var i=n.currentTarget.id.split("_Zooming_")[1],e=n.pageX-(sf.svgbase.measureText(i,{size:"10px"}).width+5),t=r(n.currentTarget.id+"_1"),u=r(n.currentTarget.id+"_2"),f=r(n.currentTarget.id+"_3");t&&(this.hoveredID=t.id,t.setAttribute("fill",this.iconRectOverFill));u&&u.setAttribute("fill",this.selectionColor);f&&f.setAttribute("fill",this.selectionColor);this.chart.isTouch||ec("EJ2_Chart_ZoomTip",this.chart.getLocalizedLabel(i),n.pageY+10,e,"10px")},n.prototype.removeTooltip=function(){var u,t,i,n;r(this.hoveredID)&&(u=this.chart.zoomModule.isPanning?this.hoveredID.indexOf("_Pan_")>-1?this.iconRectSelectionFill:"transparent":this.hoveredID.indexOf("_Zoom_")>-1?this.iconRectSelectionFill:"transparent",r(this.hoveredID).setAttribute("fill",u));t=this.hoveredID?r(this.hoveredID.replace("_1","_2")):null;i=this.hoveredID?r(this.hoveredID.replace("_1","_3")):null;t&&(n=this.chart.zoomModule.isPanning?this.hoveredID.indexOf("_Pan_")>-1?this.selectionColor:this.fillColor:this.hoveredID.indexOf("_Zoom_")>-1?this.selectionColor:this.fillColor,t.setAttribute("fill",n));i&&(n=this.chart.zoomModule.isPanning?this.fillColor:this.hoveredID.indexOf("_Zoom_")>-1?this.selectionColor:this.fillColor,i.setAttribute("fill",n));w("EJ2_Chart_ZoomTip")},n.prototype.reset=function(){var i,e,o=this,t=this.chart,u,r,f,n;for(t.zoomModule.isDevice||sf.base.remove(t.zoomModule.toolkitElements),this.removeTooltip(),t.svgObject.setAttribute("cursor","auto"),u=[],this.zoomCompleteEvtCollection=[],r=0,f=t.axisCollections;r<f.length;r++)n=f[r],i={cancel:!1,name:"zoomComplete",axis:n,previousZoomFactor:n.zoomFactor,previousZoomPosition:n.zoomPosition,currentZoomFactor:1,currentZoomPosition:0,previousVisibleRange:n.visibleRange,currentVisibleRange:null},n.zoomFactor=1,n.zoomPosition=0,n.zoomingScrollBar&&(n.zoomingScrollBar.isScrollUI=!1),i.cancel||(n.zoomFactor=i.currentZoomFactor,n.zoomPosition=i.currentZoomPosition,this.zoomCompleteEvtCollection.push(i)),u.push({zoomFactor:n.zoomFactor,zoomPosition:n.zoomFactor,axisName:n.name,axisRange:n.visibleRange});return!(e={cancel:!1,axisCollection:u,name:"onZooming"}).cancel&&this.chart.isBlazor?(this.chart.trigger("onZooming",e,function(){o.setDefferedZoom(t)}),!1):this.setDefferedZoom(t)},n.prototype.setDefferedZoom=function(n){return n.disableTrackTooltip=!1,n.zoomModule.isZoomed=n.zoomModule.isPanning=n.isChartDrag=n.delayRedraw=!1,n.zoomModule.touchMoveList=n.zoomModule.touchStartList=[],n.zoomModule.pinchTarget=null,n.removeSvg(),n.enableAutoIntervalOnBothAxis&&n.processData(!1),n.refreshAxis(),n.refreshBound(),this.elementOpacity="1",!1},n.prototype.zoomIn=function(){return this.zoomInOutCalculation(1,this.chart,this.chart.axisCollections,this.chart.zoomSettings.mode),!1},n.prototype.zoomOut=function(){return this.zoomInOutCalculation(-1,this.chart,this.chart.axisCollections,this.chart.zoomSettings.mode),!1},n.prototype.zoom=function(){return this.chart.zoomModule.isPanning=!1,this.chart.zoomModule,this.elementOpacity="1",this.chart.svgObject.setAttribute("cursor","auto"),this.zoomInElements.setAttribute("opacity",this.elementOpacity),this.zoomOutElements.setAttribute("opacity",this.elementOpacity),this.applySelection(this.zoomElements.childNodes,this.selectionColor),this.applySelection(this.panElements.childNodes,"#737373"),r(this.selectedID)&&r(this.selectedID).setAttribute("fill","transparent"),this.selectedID=this.chart.element.id+"_Zooming_Zoom_1",r(this.selectedID).setAttribute("fill",this.iconRectSelectionFill),!1},n.prototype.pan=function(){return this.chart.zoomModule.isPanning=!0,this.chart.svgObject.setAttribute("cursor","pointer"),this.elementOpacity="0.2",this.zoomInElements?this.zoomInElements.setAttribute("opacity",this.elementOpacity):null,this.zoomOutElements?this.zoomOutElements.setAttribute("opacity",this.elementOpacity):null,this.panElements?this.applySelection(this.panElements.childNodes,this.selectionColor):null,this.zoomElements?this.applySelection(this.zoomElements.childNodes,"#737373"):null,r(this.selectedID)&&r(this.selectedID).setAttribute("fill","transparent"),this.selectedID=this.chart.element.id+"_Zooming_Pan_1",r(this.selectedID).setAttribute("fill",this.iconRectSelectionFill),!1},n.prototype.zoomInOutCalculation=function(n,t,i,r){var f,s,c,u;if(!t.zoomModule.isPanning&&"0.2"!==this.elementOpacity){var e=void 0,o=void 0,h=void 0;for(t.disableTrackTooltip=!0,t.delayRedraw=!0,f=void 0,this.zoomCompleteEvtCollection=[],s=0,c=i;s<c.length;s++)u=c[s],f={cancel:!1,name:"zoomComplete",axis:u,previousZoomFactor:u.zoomFactor,previousZoomPosition:u.zoomPosition,currentZoomFactor:u.zoomFactor,currentZoomPosition:u.zoomPosition,previousVisibleRange:u.visibleRange,currentVisibleRange:null},("Horizontal"===u.orientation&&"Y"!==r||"Vertical"===u.orientation&&"X"!==r)&&(e=1===(h=Math.max(Math.max(1/dt(u.zoomFactor,0,1),1)+.25*n,1))?1:dt(1/h,0,1),o=1===h?0:u.zoomPosition+.5*(u.zoomFactor-e),u.zoomPosition===o&&u.zoomFactor===e||(e=o+e>1?1-o:e),f.currentZoomFactor=e,f.currentZoomPosition=o,f.cancel||(u.zoomFactor=f.currentZoomFactor,u.zoomPosition=f.currentZoomPosition,this.zoomCompleteEvtCollection.push(f)))}},n.prototype.applySelection=function(n,t){for(var i=1,r=n.length;i<r;i++)n[i].setAttribute("fill",t)},n}(),yv=function(){function n(n){this.zoomCompleteEvtCollection=[];this.chart=n;this.isPointer=sf.base.Browser.isPointer;this.browserName=sf.base.Browser.info.name;this.wheelEvent="mozilla"===this.browserName?this.isPointer?"mousewheel":"DOMMouseScroll":"mousewheel";this.cancelEvent=this.isPointer?"pointerleave":"mouseleave";this.addEventListener();this.isDevice=sf.base.Browser.isDevice;var t=n.zoomSettings;this.toolkit=new ub(n);this.zooming=t;this.elementId=n.element.id;this.zoomingRect=new sf.svgbase.Rect(0,0,0,0);this.zoomAxes=[];this.zoomkitOpacity=.3;this.isIOS=sf.base.Browser.isIos||sf.base.Browser.isIos7;this.isZoomed=this.performedUI=this.zooming.enablePan&&this.zooming.enableSelectionZooming;t.enableScrollbar&&(n.scrollElement=sf.base.createElement("div",{id:n.element.id+"_scrollElement"}))}return n.prototype.renderZooming=function(n,t,i){this.calculateZoomAxesRange(t);!this.zooming.enableSelectionZooming||i&&(!t.isDoubleTap||1!==this.touchStartList.length)||this.isPanning&&!t.isDoubleTap?this.isPanning&&t.isChartDrag&&(!i||i&&1===this.touchStartList.length)&&(this.pinchTarget=i?n.target:null,this.doPan(t,t.axisCollections)):(this.isPanning=!!this.isDevice||this.isPanning,this.performedUI=!0,this.drawZoomingRectangle(t))},n.prototype.drawZoomingRectangle=function(n){var i=n.chartAxisLayoutPanel.seriesClipRect,r=new s(n.previousMouseMoveX,n.previousMouseMoveY),u=new s(n.mouseX,n.mouseY),t=this.zoomingRect=lc(r,u,i);t.width>0&&t.height>0&&(this.isZoomed=!0,n.disableTrackTooltip=!0,n.svgObject.setAttribute("cursor","crosshair"),"X"===this.zooming.mode?(t.height=i.height,t.y=i.y):"Y"===this.zooming.mode&&(t.width=i.width,t.x=i.x),(n.enableCanvas?document.getElementById(this.elementId+"_tooltip_svg"):n.svgObject).appendChild(n.svgRenderer.drawRectangle(new y(this.elementId+"_ZoomArea",n.themeStyle.selectionRectFill,{color:n.themeStyle.selectionRectStroke,width:1},1,t,0,0,"","3"))))},n.prototype.doPan=function(n,t){var f,u,r,c=this,i,o;if(n.startMove&&n.crosshair.enable)return null;this.isZoomed=!0;this.offset=n.delayRedraw?this.offset:n.chartAxisLayoutPanel.seriesClipRect;n.delayRedraw=!0;this.zoomCompleteEvtCollection=[];n.disableTrackTooltip=!0;for(var s=[],e=0,h=t;e<h.length;e++)i=h[e],r={cancel:!1,name:"zoomComplete",axis:i,previousZoomFactor:i.zoomFactor,previousZoomPosition:i.zoomPosition,currentZoomFactor:i.zoomFactor,currentZoomPosition:i.zoomPosition,previousVisibleRange:i.visibleRange,currentVisibleRange:null},f=Math.max(1/dt(i.zoomFactor,0,1),1),"Horizontal"===i.orientation?(u=(n.previousMouseMoveX-n.mouseX)/i.rect.width/f,r.currentZoomPosition=dt(i.zoomPosition+u,0,1-i.zoomFactor)):(u=(n.previousMouseMoveY-n.mouseY)/i.rect.height/f,r.currentZoomPosition=dt(i.zoomPosition-u,0,1-i.zoomFactor)),r.cancel||(i.zoomFactor=r.currentZoomFactor,i.zoomPosition=r.currentZoomPosition,this.zoomCompleteEvtCollection.push(r)),s.push({zoomFactor:i.zoomFactor,zoomPosition:i.zoomFactor,axisName:i.name,axisRange:i.visibleRange});o={cancel:!1,axisCollection:s,name:"onZooming"};!o.cancel&&this.chart.isBlazor?this.chart.trigger("onZooming",o,function(){c.performDefferedZoom(n)}):(this.performDefferedZoom(n),this.redrawOnZooming(n,!1))},n.prototype.performDefferedZoom=function(n){var t,i;if(this.zooming.enableDeferredZooming){switch(t=n.mouseX-n.mouseDownX,i=n.mouseY-n.mouseDownY,this.zooming.mode){case"X":i=0;break;case"Y":t=0}this.setTransform(t,i,null,null,n,!1);this.refreshAxis(n.chartAxisLayoutPanel,n,n.axisCollections);n.enableCanvas&&this.performZoomRedraw(n)}else this.performZoomRedraw(n);n.previousMouseMoveX=n.mouseX;n.previousMouseMoveY=n.mouseY},n.prototype.performZoomRedraw=function(n){var t=this.zoomingRect;n.animateSeries=!1;this.isZoomed&&(t.width>0&&t.height>0?(this.performedUI=!0,n.svgObject.setAttribute("cursor","auto"),this.doZoom(n,n.axisCollections,n.chartAxisLayoutPanel.seriesClipRect),n.isDoubleTap=!1):n.disableTrackTooltip&&(n.disableTrackTooltip=!1,n.delayRedraw=!1,n.enableCanvas?n.createChartSvg():n.removeSvg(),n.refreshAxis(),n.refreshBound()))},n.prototype.refreshAxis=function(n,t,i){var r=t.zoomSettings.mode;n.measureAxis(new sf.svgbase.Rect(t.initialClipRect.x,t.initialClipRect.y,t.initialClipRect.width,t.initialClipRect.height));i.map(function(t,i){"Horizontal"===t.orientation&&"Y"!==r&&n.drawXAxisLabels(t,i,null,t.placeNextToAxisLine?t.updatedRect:t.rect);"Vertical"===t.orientation&&"X"!==r&&n.drawYAxisLabels(t,i,null,t.placeNextToAxisLine?t.updatedRect:t.rect)})},n.prototype.doZoom=function(n,t,i){var u,c=this,f=this.zoomingRect,l=this.zooming.mode,o,e,s,r,h;for(this.isPanning=n.zoomSettings.enablePan||this.isPanning,o=[],this.zoomCompleteEvtCollection=[],e=0,s=t;e<s.length;e++)r=s[e],u={cancel:!1,name:"zoomComplete",axis:r,previousZoomFactor:r.zoomFactor,previousZoomPosition:r.zoomPosition,currentZoomFactor:r.zoomFactor,currentZoomPosition:r.zoomPosition,previousVisibleRange:r.visibleRange,currentVisibleRange:null},"Horizontal"===r.orientation?"Y"!==l&&(u.currentZoomPosition+=Math.abs((f.x-i.x)/i.width)*r.zoomFactor,u.currentZoomFactor*=f.width/i.width):"X"!==l&&(u.currentZoomPosition+=(1-Math.abs((f.height+(f.y-i.y))/i.height))*r.zoomFactor,u.currentZoomFactor*=f.height/i.height),parseFloat(u.currentZoomFactor.toFixed(3))<=.001&&(u.currentZoomFactor=u.previousZoomFactor,u.currentZoomPosition=u.previousZoomPosition),u.cancel||(r.zoomFactor=u.currentZoomFactor,r.zoomPosition=u.currentZoomPosition,this.zoomCompleteEvtCollection.push(u)),o.push({zoomFactor:r.zoomFactor,zoomPosition:r.zoomFactor,axisName:r.name,axisRange:r.visibleRange});h={cancel:!1,axisCollection:o,name:"onZooming"};!h.cancel&&this.chart.isBlazor?this.chart.trigger("onZooming",h,function(){c.zoomingRect=new sf.svgbase.Rect(0,0,0,0);c.performZoomRedraw(n)}):(this.zoomingRect=new sf.svgbase.Rect(0,0,0,0),this.redrawOnZooming(n))},n.prototype.redrawOnZooming=function(n,t,i){var f,u,r;for(void 0===t&&(t=!0),void 0===i&&(i=!1),u=i?this.toolkit.zoomCompleteEvtCollection:this.zoomCompleteEvtCollection,t&&this.performZoomRedraw(n),r=0;r<u.length;r++)u[r].cancel||(f={cancel:!1,name:"zoomComplete",axis:n.axisCollections[r],previousZoomFactor:u[r].previousZoomFactor,previousZoomPosition:u[r].previousZoomPosition,currentZoomFactor:n.axisCollections[r].zoomFactor,currentZoomPosition:n.axisCollections[r].zoomPosition,currentVisibleRange:n.axisCollections[r].visibleRange,previousVisibleRange:u[r].previousVisibleRange},n.trigger("zoomComplete",f))},n.prototype.performMouseWheelZooming=function(n,t,i,r,u){var c,e,s,o,b=this,v="mozilla"!==this.browserName||this.isPointer?n.wheelDelta>0?1:-1:-n.detail/3>0?1:-1,y=this.zooming.mode,h=.5,f,a;this.isZoomed=!0;this.calculateZoomAxesRange(r);r.disableTrackTooltip=!0;this.performedUI=!0;this.isPanning=r.zoomSettings.enablePan||this.isPanning;this.zoomCompleteEvtCollection=[];for(var p=[],l=0,w=u;l<w.length;l++)f=w[l],o={cancel:!1,name:"zoomComplete",axis:f,previousZoomFactor:f.zoomFactor,previousZoomPosition:f.zoomPosition,currentZoomFactor:f.zoomFactor,currentZoomPosition:f.zoomPosition,currentVisibleRange:null,previousVisibleRange:f.visibleRange},("Vertical"===f.orientation&&"X"!==y||"Horizontal"===f.orientation&&"Y"!==y)&&((c=Math.max(Math.max(1/dt(f.zoomFactor,0,1),1)+.25*v,1))>=1&&(h=(h="Horizontal"===f.orientation?t/f.rect.width:1-i/f.rect.height)>1?1:h<0?0:h,e=1===c?1:dt((v>0?.9:1.1)/c,0,1),s=1===c?0:f.zoomPosition+(f.zoomFactor-e)*h,f.zoomPosition===s&&f.zoomFactor===e||(e=s+e>1?1-s:e),o.currentZoomFactor=e,o.currentZoomPosition=s),o.cancel||(f.zoomFactor=o.currentZoomFactor,f.zoomPosition=o.currentZoomPosition,this.zoomCompleteEvtCollection.push(o))),p.push({zoomFactor:f.zoomFactor,zoomPosition:f.zoomFactor,axisName:f.name,axisRange:f.visibleRange});a={cancel:!1,axisCollection:p,name:"onZooming"};!a.cancel&&this.chart.isBlazor?this.chart.trigger("onZooming",a,function(){b.performZoomRedraw(r)}):this.redrawOnZooming(r)},n.prototype.performPinchZooming=function(n,t){if(this.zoomingRect.width>0&&this.zoomingRect.height>0||t.startMove&&t.crosshair.enable)return!1;this.calculateZoomAxesRange(t);this.isZoomed=!0;this.isPanning=!0;this.performedUI=!0;this.offset=t.delayRedraw?this.offset:t.chartAxisLayoutPanel.seriesClipRect;t.delayRedraw=!0;t.disableTrackTooltip=!0;var i=t.element.getBoundingClientRect(),f=this.touchStartList,e=this.touchMoveList,o=f[0].pageX-i.left,s=f[0].pageY-i.top,h=e[0].pageX-i.left,c=e[0].pageY-i.top,v=f[1].pageX-i.left,y=f[1].pageY-i.top,p=e[1].pageX-i.left,w=e[1].pageY-i.top,r=Math.abs(h-p)/Math.abs(o-v),u=Math.abs(c-w)/Math.abs(s-y),b=(this.offset.x-h)/r+o,k=(this.offset.y-c)/u+s,d=new sf.svgbase.Rect(b,k,this.offset.width/r,this.offset.height/u),l=h-r*o,a=c-u*s;if(!isNaN(r-r)&&!isNaN(u-u))switch(this.zooming.mode){case"XY":this.setTransform(l,a,r,u,t,!0);break;case"X":this.setTransform(l,0,r,1,t,!0);break;case"Y":this.setTransform(0,a,1,u,t,!0)}return this.calculatePinchZoomFactor(t,d),this.refreshAxis(t.chartAxisLayoutPanel,t,t.axisCollections),this.redrawOnZooming(t,!1),!0},n.prototype.calculatePinchZoomFactor=function(n,t){var l,v,h,c,f,e,u,o,s,y=this.zooming.mode,p=[],r,i,a;for(this.zoomCompleteEvtCollection=[],r=0;r<n.axisCollections.length;r++)i=n.axisCollections[r],("Horizontal"===i.orientation&&"Y"!==y||"Vertical"===i.orientation&&"X"!==y)&&(o=i.zoomFactor,s=i.zoomPosition,u={cancel:!1,name:"zoomComplete",axis:i,previousZoomFactor:i.zoomFactor,previousZoomPosition:i.zoomPosition,currentZoomFactor:o,currentZoomPosition:s,previousVisibleRange:i.visibleRange,currentVisibleRange:null},"Horizontal"===i.orientation?(h=(f=t.x-this.offset.x)/(e=i.rect.width/this.zoomAxes[r].delta)+this.zoomAxes[r].min,c=(f=t.x+t.width-this.offset.x)/e+this.zoomAxes[r].min):(f=t.y-this.offset.y,e=i.rect.height/this.zoomAxes[r].delta,h=(-1*f+i.rect.height)/e+this.zoomAxes[r].min,c=(-1*(f=t.y+t.height-this.offset.y)+i.rect.height)/e+this.zoomAxes[r].min),l=Math.min(h,c),v=Math.max(h,c),s=(l-this.zoomAxes[r].actualMin)/this.zoomAxes[r].actualDelta,o=(v-l)/this.zoomAxes[r].actualDelta,u.currentZoomPosition=s<0?0:s,u.currentZoomFactor=o>1?1:o,u.cancel||(i.zoomFactor=u.currentZoomFactor,i.zoomPosition=u.currentZoomPosition,this.zoomCompleteEvtCollection.push(u)),p.push({zoomFactor:i.zoomFactor,zoomPosition:i.zoomFactor,axisName:i.name,axisRange:i.visibleRange}));a={cancel:!1,axisCollection:p,name:"onZooming"};!a.cancel&&this.chart.isBlazor&&this.chart.trigger("onZooming",a)},n.prototype.setTransform=function(n,t,i,u,f,e){var s,c,l,a,h,v,o;if(f.enableCanvas||f.seriesElements.setAttribute("clip-path","url(#"+this.elementId+"_ChartAreaClipRect_)"),f.indicatorElements&&f.indicatorElements.setAttribute("clip-path","url(#"+this.elementId+"_ChartAreaClipRect_)"),null!==n&&null!==t)for(h=0,v=f.visibleSeries;h<v.length;h++)o=v[h],c=f.requireInvertedAxis?o.yAxis.rect.x:o.xAxis.rect.x,l=f.requireInvertedAxis?o.xAxis.rect.y:o.yAxis.rect.y,s="translate("+(n+(e?i*c:c))+","+(t+(e?u*l:l))+")",s=i||u?s+" scale("+i+" "+u+")":s,o.visible&&("Indicator"===o.category?o.seriesElement.parentNode.setAttribute("transform",s):f.enableCanvas||o.seriesElement.setAttribute("transform",s),a=r(f.element.id+"_Series_"+o.index+"_DataLabelCollections"),o.errorBarElement&&o.errorBarElement.setAttribute("transform",s),o.symbolElement&&o.symbolElement.setAttribute("transform",s),o.textElement&&(o.textElement.setAttribute("visibility","hidden"),o.shapeElement.setAttribute("visibility","hidden")),a&&(a.style.visibility="hidden"))},n.prototype.calculateZoomAxesRange=function(n){for(var u,i,r,t=0;t<n.axisCollections.length;t++)r=n.axisCollections[t],i=r.visibleRange,this.zoomAxes[t]?n.delayRedraw||(this.zoomAxes[t].min=i.min,this.zoomAxes[t].delta=i.delta):(u={actualMin:r.actualRange.min,actualDelta:r.actualRange.delta,min:i.min,delta:i.delta},this.zoomAxes[t]=u)},n.prototype.showZoomingToolkit=function(n){var t,o=this.zooming.toolbarItems,l=n.chartAxisLayoutPanel.seriesClipRect,u=n.svgRenderer,f=this.isDevice?1:o.length,b=this.isDevice?sf.svgbase.measureText("Reset Zoom",{size:"12px"}).width:16,k=this.isDevice?sf.svgbase.measureText("Reset Zoom",{size:"12px"}).height:22,a=f*b+5*(f+1)+5*(f-1),tt=l.x+l.width-a-5,it=l.y+5,d=5,i=this.toolkit,v,p,g,s,w,h,e,nt,c;if(0===f||r(this.elementId+"_Zooming_KitCollection"))return!1;for(v=u.createDefs(),o=this.isDevice?["Reset"]:o,v.innerHTML='<filter id="chart_shadow" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="5"/><feOffset dx="-3" dy="4" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="1"/><\/feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/><\/feMerge><\/filter>',this.toolkitElements=u.createGroup({id:this.elementId+"_Zooming_KitCollection",transform:"translate("+tt+","+it+")"}),this.toolkitElements.appendChild(v),p="Tailwind"===this.chart.theme?"#F3F4F6":"#fafafa",this.toolkitElements.appendChild(u.drawRectangle(new y(this.elementId+"_Zooming_Rect",p,{color:"transparent",width:1},1,new sf.svgbase.Rect(0,0,a,k+10),0,0))),s=u.drawRectangle(new y(this.elementId+"_Zooming_Rect",p,{color:"transparent",width:1},.1,new sf.svgbase.Rect(0,0,a,k+10),0,0)),"Tailwind"===this.chart.theme||"TailwindDark"===this.chart.theme?s.setAttribute("box-shadow","0px 1px 2px rgba(0, 0, 0, 0.06), 0px 1px 3px rgba(0, 0, 0, 0.1)"):s.setAttribute("filter","url(#chart_shadow)"),this.toolkitElements.appendChild(s),w=!1,h=1;h<=f;h++){switch(g=o[h-1],t=u.createGroup({transform:"translate("+d+","+(this.isDevice?5:8)+")"}),g){case"Pan":i.createPanButton(t,this.toolkitElements);w=!0;break;case"Zoom":i.createZoomButton(t,this.toolkitElements);break;case"ZoomIn":i.createZoomInButton(t,this.toolkitElements,n);break;case"ZoomOut":i.createZoomOutButton(t,this.toolkitElements,n);break;case"Reset":i.createResetButton(t,this.toolkitElements,n,this.isDevice)}d+=b+10}return(this.toolkitElements.setAttribute("opacity",this.isDevice?"1":""+this.zoomkitOpacity),this.toolkitElements.setAttribute("cursor","auto"),n.enableCanvas)?(e=document.createElement("div"),e.id=n.element.id+"_zoom",e.setAttribute("style","position:absolute; z-index:1"),nt=n.availableSize.height/2,c=n.svgRenderer.createSvg({id:n.element.id+"_zoomkit_svg",width:n.availableSize.width,height:nt}),c.setAttribute("style","position:absolute"),c.appendChild(this.toolkitElements),e.appendChild(c),document.getElementById(this.elementId+"_Secondary_Element").appendChild(e)):n.svgObject.appendChild(this.toolkitElements),this.isDevice||(sf.base.EventHandler.add(this.toolkitElements,"mousemove touchstart",this.zoomToolkitMove,this),sf.base.EventHandler.add(this.toolkitElements,"mouseleave touchend",this.zoomToolkitLeave,this),this.isPanning&&w&&i.pan()),!0},n.prototype.applyZoomToolkit=function(n,t){this.isAxisZoomed(t)?(this.showZoomingToolkit(n),this.isZoomed=!0):(this.toolkit.removeTooltip(),this.isPanning=!1,this.isZoomed=!1,n.svgObject.setAttribute("cursor","auto"))},n.prototype.isAxisZoomed=function(n){for(var r,t=!1,i=0,u=n;i<u.length;i++)r=u[i],t=t||1!==r.zoomFactor||0!==r.zoomPosition;return t},n.prototype.zoomToolkitMove=function(){var n=this.toolkitElements;return this.zoomkitOpacity=1,n.setAttribute("opacity",""+this.zoomkitOpacity),!1},n.prototype.zoomToolkitLeave=function(){var n=this.toolkitElements;return this.zoomkitOpacity=.3,n.setAttribute("opacity",""+this.zoomkitOpacity),!1},n.prototype.addEventListener=function(){this.chart.isDestroyed||(sf.base.EventHandler.add(this.chart.element,this.wheelEvent,this.chartMouseWheel,this),this.chart.on(sf.base.Browser.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(sf.base.Browser.touchStartEvent,this.mouseDownHandler,this),this.chart.on(sf.base.Browser.touchEndEvent,this.mouseUpHandler,this),this.chart.on(this.cancelEvent,this.mouseCancelHandler,this))},n.prototype.removeEventListener=function(){this.chart.isDestroyed||(sf.base.EventHandler.remove(this.chart.element,this.wheelEvent,this.chartMouseWheel),this.chart.off(sf.base.Browser.touchMoveEvent,this.mouseMoveHandler),this.chart.off(sf.base.Browser.touchStartEvent,this.mouseDownHandler),this.chart.off(sf.base.Browser.touchEndEvent,this.mouseUpHandler),this.chart.off(this.cancelEvent,this.mouseCancelHandler))},n.prototype.chartMouseWheel=function(n){var t=this.chart,i=t.element.getBoundingClientRect(),u=r(t.svgId).getBoundingClientRect(),f=n.clientX-i.left-Math.max(u.left-i.left,0),e=n.clientY-i.top-Math.max(u.top-i.top,0);return this.zooming.enableMouseWheelZooming&&v(f,e,t.chartAxisLayoutPanel.seriesClipRect)&&(n.preventDefault(),this.performMouseWheelZooming(n,f,e,t,t.axisCollections)),!1},n.prototype.mouseMoveHandler=function(n){var t=this.chart,i=null;"touchmove"===n.type&&(n.preventDefault&&this.isIOS&&(this.isPanning||t.isDoubleTap||this.zooming.enablePinchZooming&&this.touchStartList.length>1)&&n.preventDefault(),i=n.touches);t.isChartDrag&&(t.isTouch&&(this.touchMoveList=this.addTouchPointer(this.touchMoveList,n,i),this.zooming.enablePinchZooming&&this.touchMoveList.length>1&&this.touchStartList.length>1&&this.performPinchZooming(n,t)),this.renderZooming(n,t,t.isTouch))},n.prototype.mouseDownHandler=function(n){var i,t=this.chart,r=null;"touchstart"===n.type?(r=n.touches,i=n.target):i=n.target;-1===i.id.indexOf(t.element.id+"_Zooming_")&&v(t.previousMouseMoveX,t.previousMouseMoveY,t.chartAxisLayoutPanel.seriesClipRect)&&(t.isChartDrag=!0);t.isTouch&&(this.touchStartList=this.addTouchPointer(this.touchStartList,n,r))},n.prototype.mouseUpHandler=function(n){var t=this.chart,i=-1===n.target.id.indexOf(t.element.id+"_ZoomOut_")||-1===n.target.id.indexOf(t.element.id+"_ZoomIn_");(t.isChartDrag||i)&&this.redrawOnZooming(t,!0,!0);t.isTouch&&(t.isDoubleTap&&v(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)&&1===this.touchStartList.length&&this.isZoomed&&this.toolkit.reset(),this.touchStartList=[],t.isDoubleTap=!1)},n.prototype.mouseCancelHandler=function(){this.isZoomed&&this.performZoomRedraw(this.chart);this.pinchTarget=null;this.touchStartList=[];this.touchMoveList=[]},n.prototype.addTouchPointer=function(n,t,i){var r,u,f;if(i)for(n=[],r=0,u=i.length;r<u;r++)n.push({pageX:i[r].clientX,pageY:i[r].clientY,pointerId:null});else if(0===(n=n||[]).length)n.push({pageX:t.clientX,pageY:t.clientY,pointerId:t.pointerId});else for(r=0,f=n.length;r<f;r++)n[r].pointerId===t.pointerId?n[r]={pageX:t.clientX,pageY:t.clientY,pointerId:t.pointerId}:n.push({pageX:t.clientX,pageY:t.clientY,pointerId:t.pointerId});return n},n.prototype.getModuleName=function(){return"Zoom"},n.prototype.destroy=function(){this.removeEventListener()},n}(),fb=function(){function n(n){this.control=n}return n.prototype.seriesStyles=function(){var l,u,r=document.getElementById(this.styleId),i="{}",f=this.control.selectionPattern,e=this.control.highlightPattern,o,h,t,n,c,s;if(sf.base.isNullOrUndefined(r)||"None"!==f||"None"!==e){for((r=document.createElement("style")).setAttribute("id",this.styleId),o=0,h=this.control.visibleSeries;o<h.length;o++){if(t=h[o],n=this.control.visibleSeries[t.index]||this.control.visibleSeries[t.index],!(sf.base.isNullOrUndefined(f)&&sf.base.isNullOrUndefined(e)||"None"===f&&"None"===e))if(c=this.styleId.indexOf("highlight")>0?e:f,"Pie"===n.type||"Funnel"===n.type||"Pyramid"===n.type)for(s=0;s<n.points.length;s++)u=n.opacity,i="{ fill:"+this.pattern(this.control,n.points[s].color,t.index,c,u)+"}";else n.type&&(u=n.opacity,i="{ fill:"+this.pattern(this.control,n.interior,t.index,c,u)+"}");l=t.selectionStyle||this.styleId+"_series_"+t.index+",."+this.styleId+"_series_"+t.index+"> *";i=i.indexOf("None")>-1?"{}":i;r.innerHTML+=t.selectionStyle?"":"."+l+i}r.innerHTML+="."+this.unselected+" { opacity:0.3;} ";document.body.appendChild(r)}},n.prototype.pattern=function(n,t,i,r,u){var h=n.svgObject,f=[],e={id:n.element.id+"_"+r+"_Selection_"+i,patternUnits:"userSpaceOnUse"},o,s;switch(r){case"Dots":e.height=e.width=6;e.width=6;f[0]={x:0,y:0,width:7,height:7,transform:"translate(0,0)",fill:"#ffffff",opacity:u,name:"rect"};f[1]={cx:3,cy:3,r:2,"stroke-width":1,fill:t,name:"circle"};break;case"Pacman":e.height="18.384";e.width="17.917";f[0]={name:"rect",x:0,y:0,width:17.917,height:18.384,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M9.081,9.194l5.806-3.08c-0.812-1.496-2.403-3.052-4.291-3.052H8.835C6.138,3.063,3,6.151,3,8.723v1.679   c0,2.572,3.138,5.661,5.835,5.661h1.761c2.085,0,3.835-1.76,4.535-3.514L9.081,9.194z","stroke-width":1,stroke:t,fill:t};break;case"Chessboard":e.height=e.width=10;f[0]={x:0,y:0,width:10,height:10,fill:"#ffffff",opacity:u,name:"rect"};f[1]={x:0,y:0,width:5,height:5,fill:t,opacity:u,name:"rect"};f[2]={x:5,y:5,width:5,height:5,fill:t,opacity:u,name:"rect"};break;case"Crosshatch":e.height=e.width="8";f[0]={x:0,y:0,width:8,height:8,transform:"translate(0,0)",fill:"#ffffff",opacity:u,name:"rect"};f[1]={d:"M0 0L8 8ZM8 0L0 8Z","stroke-width":1,stroke:t,name:"path"};break;case"DiagonalForward":e.height=e.width=6;f[0]={x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:"#ffffff",opacity:u,name:"rect"};f[1]={d:"M 3 -3 L 9 3 M 6 6 L 0 0 M 3 9 L -3 3","stroke-width":2,stroke:t,name:"path"};break;case"DiagonalBackward":e.height=e.width=6;f[0]={x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:"#ffffff",opacity:u,name:"rect"};f[1]={d:"M 3 -3 L -3 3 M 0 6 L 6 0 M 9 3 L 3 9","stroke-width":2,stroke:t,name:"path"};break;case"Grid":e.height=e.width=6;f[0]={name:"rect",x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M1 3.5L11 3.5 M0 3.5L11 3.5 M0 7.5L11 7.5 M0 11.5L11 11.5 M5.5 0L5.5 12 M11.5 0L11.5 12Z","stroke-width":1,stroke:t};break;case"Turquoise":e.height=e.width=17;f[0]={name:"rect",x:0,y:0,width:17,height:17,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M0.5739999999999998,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};f[2]={name:"path",d:"M11.805,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};f[3]={name:"path",d:"M6.19,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};f[4]={name:"path",d:"M11.805,8.217a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};f[5]={name:"path",d:"M6.19,8.217a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};f[6]={name:"path",d:"M11.805,13.899a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};f[7]={name:"path",d:"M6.19,13.899a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};break;case"Star":e.height=e.width=21;f[0]={name:"rect",x:0,y:0,width:21,height:21,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M15.913,18.59L10.762 12.842 5.613 18.75 8.291 11.422 0.325 9.91 8.154 8.33 5.337 0.91 10.488 6.658 15.637 0.75 12.959 8.078 20.925 9.59 13.096 11.17 z","stroke-width":1,stroke:t,fill:t};break;case"Triangle":e.height=e.width=10;f[0]={name:"rect",x:0,y:0,width:10,height:10,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M4.987,0L7.48 4.847 9.974 9.694 4.987 9.694 0 9.694 2.493 4.847 z","stroke-width":1,stroke:t,fill:t};break;case"Circle":e.height=e.width=9;f[0]={name:"rect",x:0,y:0,width:9,height:9,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"circle",cx:5.125,cy:3.875,r:3.625,"stroke-width":1,fill:t};break;case"Tile":e.height=e.width=18;f[0]={name:"rect",x:0,y:0,width:18,height:18,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M0,9L0 0 9 0 z","stroke-width":1,stroke:t,fill:t};f[2]={name:"path",d:"M9,9L9 0 18 0 z","stroke-width":1,stroke:t,fill:t};f[3]={name:"path",d:"M0,18L0 9 9 9 z","stroke-width":1,stroke:t,fill:t};f[4]={name:"path",d:"M9,18L9 9 18 9 z","stroke-width":1,stroke:t,fill:t};break;case"HorizontalDash":e.height=e.width=12;f[0]={name:"rect",x:0,y:0,width:12,height:12,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M0,1.5 L10 1.5 M0,5.5 L10 5.5 M0,9.5 L10 9.5 z","stroke-width":1,stroke:t,fill:t};break;case"VerticalDash":e.height=e.width=12;f[0]={name:"rect",x:0,y:0,width:12,height:12,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M1.5,0 L1.5 10 M5.5,0 L5.5 10 M9.5,0 L9.5 10 z","stroke-width":1,stroke:t,fill:t};break;case"Rectangle":e.height=e.width=12;f[0]={name:"rect",width:12,height:12,fill:"#ffffff",opacity:u};f[1]={name:"rect",x:1,y:2,width:4,height:9,fill:t,opacity:u};f[2]={name:"rect",x:7,y:2,width:4,height:9,fill:t,opacity:u};break;case"Box":e.height=e.width=10;f[0]={name:"rect",width:13,height:13,fill:"#ffffff",opacity:u};f[1]={name:"rect",x:1.5,y:1.5,width:10,height:9,fill:t,opacity:u};break;case"HorizontalStripe":e.height=12;e.width=10;f[0]={name:"rect",x:0,y:0,width:10,height:12,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M0,0.5 L10 0.5 M0,4.5 L10 4.5 M0,8.5 L10 8.5 z","stroke-width":1,stroke:t,fill:t};break;case"VerticalStripe":e.height=10;e.width=12;f[0]={name:"rect",x:0,y:0,width:12,height:10,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"path",d:"M0.5,0 L0.5 10 M4.5,0 L4.5 10 M8.5,0 L8.5 10 z","stroke-width":1,stroke:t,fill:t};break;case"Bubble":e.height=e.width=20;f[0]={name:"rect",x:0,y:0,width:20,height:20,transform:"translate(0,0)",fill:"#ffffff",opacity:u};f[1]={name:"circle",cx:5.217,cy:11.325,r:3.429,"stroke-width":1,fill:"#D0A6D1"};f[2]={name:"circle",cx:13.328,cy:6.24,r:4.884,"stroke-width":1,fill:t};f[3]={name:"circle",cx:13.277,cy:14.66,r:3.018,"stroke-width":1,fill:"#D0A6D1"}}return o=n.svgRenderer||n.renderer,s=o.createPattern(e,"pattern"),this.loadPattern(n,f,s,o),h.appendChild(s),"url(#"+n.element.id+"_"+r+"_Selection_"+i+")"},n.prototype.loadPattern=function(n,t,i,r){for(var f,u=0;u<t.length;u++)f=r.createPattern(t[u],t[u].name),i.appendChild(f)},n.prototype.concatIndexes=function(n,t){return n.concat(t)},n.prototype.checkVisibility=function(n){var t,i,f;if(!n)return!1;for(var e=!1,r=[],u=0,o=n;u<o.length;u++)t=o[u],-1===r.indexOf(t.series)&&r.push(t.series);for(i=0,f=r;i<f.length;i++)if(t=f[i],this.control.series[t].visible){e=!0;break}return e},n.prototype.addSvgClass=function(n,t){var i=n.getAttribute("class")||"";-1===(i+=""!==i?" ":"").indexOf(t)&&n.setAttribute("class",i+t)},n.prototype.removeSvgClass=function(n,t){var i=n.getAttribute("class")||"";i.indexOf(t)>-1&&n.setAttribute("class",i.replace(t,""))},n.prototype.getChildren=function(n){for(var i=[],t=0;t<n.childNodes.length;t++)"defs"!==n.childNodes[t].tagName&&i.push(n.childNodes[t]);return i},n}(),eb=(is=function(n,t){return(is=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}is(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ks=function(n){function t(t){var i=n.call(this,t)||this,r;return i.isdrawRect=!0,i.multiDataIndexes=[],i.pathIndex=0,i.seriesIndex=0,i.count=-1,i.dragRectArray=[],i.filterArray=[],i.totalSelectedPoints=[],i.chart=t,i.renderer=t.renderer,r=t.selectionMode,i.isMultiDrag=t.isMultiSelect&&r.indexOf("Drag")>-1,i.addEventListener(),i}return eb(t,n),t.prototype.addEventListener=function(){if(!(this.chart.isDestroyed||this.chart.stockChart&&this.chart.stockChart.onPanning)){var n=sf.base.Browser.isPointer?"pointerleave":"mouseleave";this.chart.on(sf.base.Browser.touchMoveEvent,this.mouseMove,this);this.chart.on(n,this.completeSelection,this);this.chart.on("click",this.calculateSelectedElements,this);this.chart.on(sf.base.Browser.touchStartEvent,this.mousedown,this);this.chart.on(sf.base.Browser.touchEndEvent,this.completeSelection,this)}},t.prototype.mousedown=function(n){var t=this.chart;t.isPointMouseDown||"None"===t.selectionMode||t.isChartDrag||(t.isDoubleTap||!t.isTouch||this.rectPoints)&&this.dragStart(t,t.chartAxisLayoutPanel.seriesClipRect,t.mouseDownX,t.mouseDownY,n)},t.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(sf.base.Browser.touchMoveEvent,this.mouseMove),this.chart.off("pointerleave",this.completeSelection),this.chart.off("click",this.calculateSelectedElements),this.chart.off(sf.base.Browser.touchStartEvent,this.mousedown),this.chart.off(sf.base.Browser.touchEndEvent,this.completeSelection))},t.prototype.initPrivateVariables=function(n){this.styleId=n.element.id+"_ej2_chart_selection";this.unselected=n.element.id+"_ej2_deselected";this.closeIconId=n.element.id+"_ej2_drag_close";this.draggedRectGroup=n.element.id+"_ej2_drag_group";this.multiRectGroup=n.element.id+"_ej2_drag_multi_group";this.draggedRect=n.element.id+"_ej2_drag_rect";this.lassoPath=n.element.id+"_ej2_drag_path";this.selectedDataIndexes=[];this.rectPoints=null;this.isSeriesMode="Series"===n.selectionMode},t.prototype.invokeSelection=function(n){this.initPrivateVariables(n);this.series=sf.base.extend({},n.visibleSeries,null,!0);this.seriesStyles();this.currentMode=n.selectionMode;n.selectionMode.indexOf("Drag")>-1||this.selectDataIndex(n,this.concatIndexes(n.selectedDataIndexes,this.selectedDataIndexes))},t.prototype.generateStyle=function(n){return n?(this.styleId.indexOf("selection")>1&&"None"!==this.chart.selectionMode&&(this.unselected=n.unSelectedStyle||this.unselected),this.styleId.indexOf("highlight")>0&&"None"!==this.chart.highlightMode&&(this.unselected=n.nonHighlightStyle||this.unselected),n.selectionStyle||this.styleId+"_series_"+n.index):"undefined"},t.prototype.selectDataIndex=function(n,t){for(var u,i=0,r=t;i<r.length;i++)u=r[i],this.performSelection(u,n,this.getElementByIndex(n,u)[0])},t.prototype.getElementByIndex=function(n,t,i,u){void 0===i&&(i="");var e=n.element.id+"_Series_"+t.series+"_Point_"+t.point,f=n.series[t.series];return[r(e="Scatter"!==f.type&&"Bubble"!==f.type&&u?e+"_Symbol"+i:e),"RangeArea"!==f.type&&"SplineRangeArea"!==f.type||!f.marker.visible?null:r(e+"1")]},t.prototype.getClusterElements=function(n,t){for(var i,s,f,r,u=[],e=0,o=n.visibleSeries;e<o.length;e++)i=o[e],i.visible&&(t=new ui(i.index,t.point),i.isRectSeries&&u.push(this.getElementByIndex(n,t)[0]),u.push(this.getElementByIndex(n,t,"",i.marker.visible)[0]),f=this.generateStyle(n.visibleSeries[t.series]),r=document.querySelectorAll("."+f),this.findTrackballElements(r,f),s=i.marker.visible&&i.isRectSeries?2:1,!n.isMultiSelect&&r.length>0&&r[0].id!==u[u.length-s].id&&this.removeSelection(n,t.series,r,f,!0));return u},t.prototype.findTrackballElements=function(n,t){for(var u,f,r,i=0;i<n.length;i++)if(!sf.base.isNullOrUndefined(n[i])&&(u=sf.base.isNullOrUndefined(n[i].parentNode)?[]:[].slice.call(n[0].parentNode.querySelectorAll("."+t))).length>0){for(f=[],r=0;r<u.length;r++)u[r].id.indexOf("Trackball")>-1&&f.push(u[r]);this.removeStyles(f)}},t.prototype.findElements=function(n,t,i,r,u){return void 0===r&&(r=""),this.isSeriesMode?this.getSeriesElements(t):"Cluster"===this.currentMode?this.getClusterElements(n,i):this.getElementByIndex(n,i,r,u)},t.prototype.isAlreadySelected=function(n){var u=n.target,r,i,t;if("click"===n.type?(this.currentMode=this.chart.selectionMode,this.styleId=this.chart.element.id+"_ej2_chart_selection"):"mousemove"===n.type&&(this.currentMode=this.chart.highlightMode,this.highlightDataIndexes=[],this.styleId=this.chart.element.id+"_ej2_chart_highlight"),"None"!==this.chart.highlightMode&&"None"===this.chart.selectionMode&&"click"===n.type)return!1;if("None"!==this.chart.highlightMode&&this.previousSelectedEle&&this.previousSelectedEle[0])for(r=u.parentNode.id,i=void 0,u.parentNode&&(i=r.indexOf("SeriesGroup")>0||r.indexOf("SymbolGroup")>0),t=0;t<this.previousSelectedEle.length;t++)this.previousSelectedEle[t].hasAttribute("class")&&(this.previousSelectedEle[t].getAttribute("class").indexOf("highlight")>-1&&(i||"click"===n.type)?(this.previousSelectedEle[t].removeAttribute("class"),this.addOrRemoveIndex(this.highlightDataIndexes,this.indexFinder(this.previousSelectedEle[t].id))):!i&&this.previousSelectedEle[t].getAttribute("class").indexOf("highlight")>-1&&this.performSelection(this.indexFinder(this.previousSelectedEle[t].id),this.chart,this.previousSelectedEle[t]));return!0},t.prototype.calculateSelectedElements=function(n){var t,i;if(!sf.base.isNullOrUndefined(n.target)&&(t=n.target,("None"!==this.chart.selectionMode||"None"!==this.chart.highlightMode)&&-1!==t.id.indexOf(this.chart.element.id+"_"))){if("mousemove"===n.type){if(t.hasAttribute("class")&&(t.getAttribute("class").indexOf("highlight")>-1||t.getAttribute("class").indexOf("selection")>-1))return;if(!sf.base.isNullOrUndefined(t.parentNode)&&t.parentNode.hasAttribute("class")&&(t.parentNode.getAttribute("class").indexOf("highlight")>0||t.parentNode.getAttribute("class").indexOf("selection")>0))return}if(this.isAlreadySelected(n),t.id.indexOf("_Series_")>-1){if(i=void 0,t.id.indexOf("_Trackball_1")>-1)i=r(t.id.split("_Trackball_")[0]+"_Symbol"),i=sf.base.isNullOrUndefined(i)?r(t.id.split("_Trackball_")[0]):i;else if(t.id.indexOf("_Trackball_0")>-1)return null;this.performSelection(this.indexFinder(t.id),this.chart,i||t)}}},t.prototype.performSelection=function(n,t,i){var f,e,u;(this.isSeriesMode="Series"===this.currentMode,"BoxAndWhisker"===t.series[n.series].type&&i&&i.id===t.element.id+"_Series_"+n.series+"_Point_"+n.point+"_BoxPath"&&(i=i.parentNode),"Area"===t.series[n.series].type&&("Point"===this.currentMode||"Cluster"===this.currentMode)&&i&&i.id===this.chart.element.id+"_Series_"+n.series)&&(f=this.generateStyle(t.series[n.series]),e=document.querySelectorAll("."+f),this.findTrackballElements(e,f),this.blurEffect(t.element.id,t.visibleSeries));switch(this.currentMode){case"Series":this.selection(t,n,this.getSeriesElements(t.series[n.series]));this.selectionComplete(t,n,this.currentMode);this.blurEffect(t.element.id,t.visibleSeries);break;case"Point":!isNaN(n.point)&&i&&(u=[],u.push(i),null===u[0]||!t.series[n.series].marker.visible||-1===t.series[n.series].type.indexOf("Column")&&-1===t.series[n.series].type.indexOf("Bar")||(-1===i.id.indexOf("_Symbol")&&r(i.id+"_Symbol")?u.push(r(i.id+"_Symbol")):-1!==i.id.indexOf("_Symbol")&&r(i.id.replace("_Symbol",""))&&u.push(r(i.id.replace("_Symbol","")))),this.selection(t,n,u),this.selectionComplete(t,n,this.currentMode),this.blurEffect(t.element.id,t.visibleSeries));break;case"Cluster":isNaN(n.point)||(this.clusterSelection(t,n),this.selectionComplete(t,n,this.currentMode),this.blurEffect(t.element.id,t.visibleSeries))}},t.prototype.selectionComplete=function(n,t,i){var f,r,e,c,o,h=[],l,a,u,s,v;if("Cluster"===i){for(l=0,a=n.visibleSeries;l<a.length;l++)if((s=a[l]).visible)for(u=0;u<this.selectedDataIndexes.length;u++)r=n.isMultiSelect?this.selectedDataIndexes[u].point:t.point,e=s.index,f=s.points,isNaN(r)||(s.type,c=f[r].yValue,o=f[r].xValue,"Category"===n.primaryXAxis.valueType?o=f[r].x.toLocaleString():"DateTime"===n.primaryXAxis.valueType&&(o=new Date(f[r].xValue)),"Indicator"!==s.category&&h.push({x:o,y:c,seriesIndex:e,pointIndex:r}),"RangeArea"!==s.type&&"SplineRangeArea"!==s.type||h.push({x:o,y:f[r].regions[0].y,seriesIndex:e,pointIndex:r}))}else if("Series"===i)if(n.isMultiSelect)for(u=0;u<this.selectedDataIndexes.length;u++)e=this.selectedDataIndexes[u].series,h.push({seriesIndex:e});else e=this.selectedDataIndexes.length>0?this.selectedDataIndexes[0].series:0,h.push({seriesIndex:e});else if("Point"===i)for(u=0;u<this.selectedDataIndexes.length;u++)r=this.selectedDataIndexes[u].point,e=this.selectedDataIndexes[u].series,f=(s=n.series[e]).points,isNaN(r)||(o=f[r].xValue,s.type,c=f[r].yValue,"Category"===n.primaryXAxis.valueType?o=f[r].x.toLocaleString():"DateTime"===n.primaryXAxis.valueType&&(o=new Date(f[r].xValue)),h.push({x:o,y:c,seriesIndex:e,pointIndex:r}));v={name:"selectionComplete",selectedDataValues:h,cancel:!1};n.trigger("selectionComplete",v)},t.prototype.selection=function(n,t,i){if("Lasso"!==this.currentMode&&(n.isMultiSelect||-1!==this.currentMode.indexOf("Drag")||-1!==this.styleId.indexOf("highlight")||"None"===n.selectionMode||this.removeMultiSelectElements(n,this.selectedDataIndexes,t,n.series)),!sf.base.isNullOrUndefined(i[0])){n.series[t.series].isRectSeries&&i[0].id&&(document.getElementById(i[0].id+"_Symbol")?i.push(r(i[0].id+"_Symbol")):-1!==i[0].id.indexOf("SeriesGroup")&&document.getElementById(i[0].id.replace("SeriesGroup","SymbolGroup"))&&i.push(r(i[0].id.replace("SeriesGroup","SymbolGroup"))));var u=void 0,f=i[0]&&(i[0].getAttribute("class")||""),e=i[0].parentNode&&(i[0].parentNode.getAttribute("class")||"");""!==f&&"Cluster"!==this.currentMode&&this.findTrackballElements(i,f);i[0]&&f.indexOf(this.getSelectionClass(i[0].id))>-1?this.removeStyles(i):i[0].parentNode&&e.indexOf(this.getSelectionClass(i[0].id))>-1?this.removeStyles([i[0].parentNode]):(this.previousSelectedEle="None"!==n.highlightMode?i:[],this.applyStyles(i),u=!0);this.styleId.indexOf("highlight")>0&&"None"!==n.highlightMode?this.addOrRemoveIndex(this.highlightDataIndexes,t,u):this.addOrRemoveIndex(this.selectedDataIndexes,t,u)}},t.prototype.clusterSelection=function(n,t){this.selection(n,t,this.getClusterElements(n,new ui(t.series,t.point)))},t.prototype.removeMultiSelectElements=function(n,t,i,r){for(var f,u=0;u<t.length;u++)f=r[t[u].series],(!this.isSeriesMode||this.toEquals(t[u],i,this.isSeriesMode))&&("Cluster"!==this.currentMode||this.toEquals(t[u],i,!1))&&(this.isSeriesMode||!this.toEquals(t[u],i,!0)||this.toEquals(t[u],i,!1))||(this.removeStyles(this.findElements(n,f,t[u],"",!1)),f.marker.visible&&this.removeStyles(this.findElements(n,f,t[u],"",!0)),t.splice(u,1),u--)},t.prototype.blurEffect=function(n,t,i){var u;void 0===i&&(i=!1);for(var e=this.checkVisibility(this.highlightDataIndexes)||this.checkVisibility(this.selectedDataIndexes),f=0,o=t;f<o.length;f++)u=o[f],u.visible&&(this.checkSelectionElements(r(n+"SeriesGroup"+u.index),this.generateStyle(u),e,i,u.index),sf.base.isNullOrUndefined(r(n+"SymbolGroup"+u.index))||this.checkSelectionElements(r(n+"SymbolGroup"+u.index),this.generateStyle(u),e,i,u.index))},t.prototype.checkSelectionElements=function(n,t,i,u,f){var h,c,s,o=this.isSeriesMode?[n]:n.childNodes,l,e,a;for("None"!==this.chart.selectionMode&&"None"!==this.chart.highlightMode&&(o=n.children),l=n,e=0;e<o.length;e++)h=o[e].getAttribute("class")||"",c=o[e].parentNode.getAttribute("class")||"","None"!==this.chart.selectionMode&&"None"!==this.chart.highlightMode&&(t=h.indexOf("selection")>0||h.indexOf("highlight")>0?h:t,t=c.indexOf("selection")>0||c.indexOf("highlight")>0?c:t),-1===h.indexOf(t)&&-1===c.indexOf(t)&&i?this.addSvgClass(o[e],this.unselected):(l=o[e],this.removeSvgClass(o[e],this.unselected),this.removeSvgClass(o[e].parentNode,this.unselected)),o[e].id.indexOf("Trackball")>0&&l.classList[0]===t&&(this.removeSvgClass(o[e],this.unselected),this.removeSvgClass(o[e].parentNode,this.unselected),this.addSvgClass(o[e],t));n.id.indexOf("Symbol")>-1&&n.querySelectorAll("."+t)[0]&&n.querySelectorAll("."+t)[0].getAttribute("class")===t&&(a=r(this.control.element.id+"_Series_"+n.id[n.id.length-1]),(a&&a.hasAttribute("class")?a.getAttribute("class"):"").indexOf(this.unselected)>-1&&this.removeSvgClass(a,this.unselected));this.control.legendModule&&this.control.legendSettings.visible&&(s=r(this.control.element.id+"_chart_legend_shape_"+f))&&(s.hasAttribute("class")&&this.removeSvgClass(s,s.getAttribute("class")),h=l.getAttribute("class")||"",c=l.parentNode.getAttribute("class")||"",-1===h.indexOf(t)&&-1===c.indexOf(t)&&i?(this.addSvgClass(s,this.unselected),this.removeSvgClass(s,t)):(this.removeSvgClass(s,this.unselected),""===h&&""===c||"EJ2-Trackball"===h.trim()?this.removeSvgClass(s,t):this.addSvgClass(s,t)),u&&c.indexOf(t)>-1&&this.addSvgClass(s,t))},t.prototype.applyStyles=function(n){for(var t,i=0,r=n;i<r.length;i++)t=r[i],t&&(this.removeSvgClass(t.parentNode,this.unselected),this.removeSvgClass(t,this.unselected),this.addSvgClass(t,this.getSelectionClass(t.id)))},t.prototype.getSelectionClass=function(n){return this.generateStyle(this.control.series[this.indexFinder(n).series])},t.prototype.removeStyles=function(n){for(var i,t=0,r=n;t<r.length;t++)i=r[t],i&&this.removeSvgClass(i,this.getSelectionClass(i.id))},t.prototype.addOrRemoveIndex=function(n,t,i){for(var r=0;r<n.length;r++)this.toEquals(n[r],t,this.isSeriesMode)&&(n.splice(r,1),r--);i&&n.push(t)},t.prototype.toEquals=function(n,t,i){return(n.series===t.series||"Cluster"===this.currentMode&&!i)&&(i||n.point===t.point)},t.prototype.redrawSelection=function(n,t,i){this.isSeriesMode="Series"===t;sf.base.isNullOrUndefined(t)||(n.isRedrawSelection=-1!==t.indexOf("Drag")||"Lasso"===t||i?!1:!0);var r=sf.base.extend([],this.selectedDataIndexes,null,!0),u=sf.base.extend([],this.highlightDataIndexes,null,!0);this.styleId.indexOf("highlight")>0&&u.length>0?(this.removeSelectedElements(n,this.highlightDataIndexes,n.series),r=u):this.removeSelectedElements(n,this.selectedDataIndexes,n.series);this.blurEffect(n.element.id,n.visibleSeries);this.selectDataIndex(n,r)},t.prototype.legendSelection=function(n,t,i){var e=i.target,u,f,o,s,h,l;if("mousemove"===i.type){if(i.target.id.indexOf("text")>1&&(e=r(i.target.id.replace("text","shape"))),e.hasAttribute("class")&&(e.getAttribute("class").indexOf("highlight")>-1||e.getAttribute("class").indexOf("selection")>-1))return;this.currentMode=this.chart.highlightMode}if(this.isAlreadySelected(i))if(u=this.generateStyle(n.visibleSeries[t]),f=document.querySelectorAll("."+u),this.isSeriesMode="Series"===this.currentMode,f.length>0)this.removeSelection(n,t,f,u,!0);else{for(o=0,s=n.visibleSeries;o<s.length;o++)h=s[o],h.index===t||n.isMultiSelect||(u=this.generateStyle(n.visibleSeries[h.index]),f=document.querySelectorAll("."+u),this.removeSelection(n,t,f,u,!0));for(var a=this.getSeriesElements(n.visibleSeries[t]),c=0,v=a;c<v.length;c++){if(l=v[c],sf.base.isNullOrUndefined(l))return;this.checkSelectionElements(l,u,!1,!0,t)}this.isSeriesMode=!0;this.selection(n,new ui(t,NaN),a);this.isSeriesMode="Series"===n.selectionMode;this.blurEffect(n.element.id,n.visibleSeries,!0)}},t.prototype.removeSelection=function(n,t,i,r,u){var f,e,o,h,l,s,c,a;if(i.length>0){for(f=[],e=0;e<i.length;e++)f.push(i[e]);for(this.removeStyles(f),this.isSeriesMode=!0,this.addOrRemoveIndex(this.selectedDataIndexes,new ui(t,NaN)),o=0,h=n.visibleSeries;o<h.length;o++)if(l=h[o],r=this.generateStyle(l),document.querySelectorAll("."+r).length>0){for(s=0,c=f;s<c.length;s++)a=c[s],this.checkSelectionElements(a,r,!0,!0,t);u=!1;break}u&&(this.isSeriesMode="Series"===n.selectionMode,this.blurEffect(n.element.id,n.visibleSeries))}},t.prototype.getSeriesElements=function(n){var t=[n.seriesElement];return(n.marker.visible&&"Scatter"!==n.type&&"Bubble"!==n.type&&!n.isRectSeries||n.marker.visible&&n.isRectSeries)&&t.push(n.symbolElement),t},t.prototype.indexFinder=function(n){var t=["NaN","NaN"];return n.indexOf("SeriesGroup")>-1?(t=n.split("SeriesGroup"))[0]=t[1]:n.indexOf("SymbolGroup")>-1?(t=n.split("SymbolGroup"))[0]=t[1]:n.indexOf("_Point_")>-1?t=n.split("_Series_")[1].split("_Point_"):n.indexOf("_Series_")>-1?t[0]=n.split("_Series_")[1]:n.indexOf("_chart_legend_shape_")>-1&&((t=n.split("_chart_legend_shape_"))[0]=t[1]),new ui(parseInt(t[0],10),parseInt(t[1],10))},t.prototype.calculateDragSelectedElements=function(n,t,i){var f,c,l,a,b,k,d;this.removeSelectedElements(n,this.selectedDataIndexes,n.series);var r,o,p="Lasso"===n.selectionMode,h=new sf.svgbase.Rect(t.x,t.y,t.width,t.height),u=new s(n.chartAxisLayoutPanel.seriesClipRect.x,n.chartAxisLayoutPanel.seriesClipRect.y);this.removeOffset(h,u);f=[];c=[];this.isSeriesMode=!1;l=n.allowMultiSelection&&(this.rectGrabbing||this.resizing);(this.rectPoints=this.dragRectArray[l?this.targetIndex:this.count]=new sf.svgbase.Rect(t.x,t.y,t.width,t.height),t.width&&t.height&&!i)&&(a=new sf.svgbase.Rect(t.x,t.y,t.width,t.height),this.removeOffset(a,u),this.filterArray[l?this.targetIndex:this.count]=a);for(var g=function(t){var s,l,i;if(t.visible){for(r=t.points,f=[],!n.isTransposed&&-1===t.type.indexOf("Bar")||n.isTransposed&&-1!==t.type.indexOf("Bar")?(s=t.xAxis.rect.x-u.x,l=t.yAxis.rect.y-u.y):(s=t.xAxis.rect.y-u.y,l=t.yAxis.rect.x-u.x),i=0;i<r.length;i++){var p=(t.type,r[i].yValue),y=void 0,a=r[i].xValue;"Category"===n.primaryXAxis.valueType?a=r[i].x.toLocaleString():"DateTime"===n.primaryXAxis.valueType&&(a=new Date(r[i].xValue));(y="BoxAndWhisker"===t.type?r[i].regions.some(function(n){return v(n.x+s,n.y+l,h)}):"Lasso"===n.selectionMode?r[i].isSelect:n.allowMultiSelection?e.isPointSelect(r[i],s,l,e.filterArray):r[i].symbolLocations.some(function(n){return n&&v(n.x+s,n.y+l,h)}))&&"Indicator"!==t.category&&(o=new ui(t.index,r[i].index),e.selection(n,o,e.findElements(n,t,o,"",!t.isRectSeries&&t.marker.visible)),f.push({x:a,y:p}));!y||"RangeArea"!==t.type&&"SplineRangeArea"!==t.type||f.push({x:a,y:r[i].regions[0].y})}c.push(f)}},e=this,y=0,w=n.visibleSeries;y<w.length;y++)g(w[y]);this.blurEffect(n.element.id,n.visibleSeries);b=p?n.mouseDownX:t.x+t.width;k=p?n.mouseDownY:t.y;i||this.createCloseButton(b,k);d={name:"dragComplete",selectedDataValues:c,cancel:!1};n.trigger("dragComplete",d)},t.prototype.removeOffset=function(n,t){n.x-=t.x;n.y-=t.y},t.prototype.isPointSelect=function(n,t,i,r){for(var e,u=n.symbolLocations[0],f=0,o=r;f<o.length;f++)if(e=o[f],e&&u&&v(u.x+t,u.y+i,e))return!0;return!1},t.prototype.drawDraggingRect=function(n,t){var i=n.chartAxisLayoutPanel.seriesClipRect,e=n.chartArea.border.width,o=n.themeStyle.selectionRectFill,s=n.themeStyle.selectionRectStroke,l="Lasso"===n.selectionMode,v,a,c;switch(this.isdrawRect&&(i.x=i.x-e/2,i.y=i.y-e/2,i.width=i.width+e,i.height=i.height+e,this.isdrawRect=!1),n.selectionMode){case"DragX":t.y=i.y;t.height=i.height;break;case"DragY":t.x=i.x;t.width=i.width}if((t.width<5||t.height<5)&&!l)return null;if(v=n.selectionMode.indexOf("Drag")>-1||"Lasso"===n.selectionMode,n.allowMultiSelection&&v){var u=void 0,f=void 0,h=r(this.multiRectGroup);(h||(h=n.svgRenderer.createGroup({id:this.multiRectGroup}),n.svgObject.appendChild(h)),this.rectGrabbing||this.resizing)?((a=r(this.draggedRect+this.targetIndex)).nextSibling&&sf.base.remove(a.nextSibling),this.setAttributes(a,t)):r(this.draggedRectGroup+this.count)||(f=n.svgRenderer.createGroup({id:this.draggedRectGroup+this.count}),c=document.getElementById(n.element.id+"_series_svg"),n.enableCanvas?c.appendChild(f):h.appendChild(f));"Lasso"!==n.selectionMode?(u=n.svgRenderer.drawRectangle(new y(this.draggedRect+this.count,o,{color:s,width:1},1,t))).setAttribute("style","cursor:move;"):u=n.svgRenderer.drawPath(new sf.svgbase.PathOption(this.lassoPath+this.count,o,3,s,1,"",this.path));f||this.rectGrabbing||this.resizing?this.rectGrabbing||this.resizing||f.appendChild(u):r(this.draggedRectGroup+this.count).appendChild(u)}else u=r(l?this.lassoPath:this.draggedRect),(this.closeIcon&&w(this.closeIconId),u)?l?u.setAttribute("d",this.path):this.setAttributes(u,t):(f=n.svgRenderer.createGroup({id:this.draggedRectGroup}),c=document.getElementById(n.element.id+"_series_svg"),n.enableCanvas?c.appendChild(f):n.svgObject.appendChild(f),u="Lasso"!==n.selectionMode?n.svgRenderer.drawRectangle(new y(this.draggedRect,o,{color:s,width:1},1,t)):n.svgRenderer.drawPath(new sf.svgbase.PathOption(this.lassoPath,o,3,s,1,"",this.path)),f.appendChild(u))},t.prototype.getIndex=function(n){for(var i,t=n.length-1;t>0;t--)if(i=Number(n[t]),isNaN(i))break;return+n.substr(t+1,n.length-1)},t.prototype.createCloseButton=function(n,t){var i=this.chart.allowMultiSelection,e=this.chart.themeStyle.selectionCircleStroke,u=this.rectGrabbing||this.resizing,f=this.chart.svgRenderer.createGroup({id:this.closeIconId+(i?u?this.targetIndex:this.count:""),style:"cursor:pointer; visibility: visible;"}),s,o;f.appendChild(this.chart.svgRenderer.drawCircle(new si(this.closeIconId+"_circle"+(i?u?this.targetIndex:this.count:""),"#FFFFFF",{color:e,width:1},1,n,t,10)));s="M "+(n-4)+" "+(t-4)+" L "+(n+4)+" "+(t+4)+" M "+(n-4)+" "+(t+4)+" L "+(n+4)+" "+(t-4);f.appendChild(this.chart.svgRenderer.drawPath({id:this.closeIconId+"_cross"+(i?u?this.targetIndex:this.count:""),d:s,stroke:e,"stroke-width":2,fill:e}));this.closeIcon=f;o=r(this.draggedRectGroup+(i?u?this.targetIndex:this.count:""));o&&o.appendChild(f)},t.prototype.removeDraggedElements=function(n,t){var e,i,o,u,f,s;if(t.target.id.indexOf(this.closeIconId)>-1&&-1===t.type.indexOf("move")){if(e=!0,n.allowMultiSelection)if(i=this.getIndex(t.target.id),o=r(this.multiRectGroup),sf.base.remove(r(this.draggedRectGroup+i)),this.dragRectArray[i]=null,this.filterArray[i]=null,this.totalSelectedPoints[i]=null,o&&0===o.childElementCount&&(w(o),this.dragRectArray=[],this.filterArray=[],this.totalSelectedPoints=[]),"Lasso"===this.currentMode){if(null!=this.multiDataIndexes[i])for(u=0;u<this.multiDataIndexes[i].length;u++)this.multiDataIndexes[i][u].isSelect=!1;for(this.multiDataIndexes[i]=null,f=0;f<this.multiDataIndexes.length;f++)if(null!=this.multiDataIndexes[f])for(e=!1,s=0;s<this.multiDataIndexes[f].length;s++)this.multiDataIndexes[f][s].isSelect=!0;this.calculateDragSelectedElements(n,this.dragRect,!0)}else if(this.filterArray.length)for(u=0;u<this.filterArray.length;u++)this.filterArray[u]&&(e=!1,this.calculateDragSelectedElements(n,this.filterArray[u],!0));else this.calculateDragSelectedElements(n,new sf.svgbase.Rect(0,0,0,0),!0);else sf.base.remove(r(this.draggedRectGroup)),this.removeSelectedElements(n,this.selectedDataIndexes,n.series);this.blurEffect(n.element.id,n.visibleSeries);this.changeCursorStyle(!1,n.svgObject,"auto");n.allowMultiSelection&&!e||(this.rectPoints=null)}},t.prototype.resizingSelectionRect=function(n,t,i,r){var u,f,e;(n.allowMultiSelection&&r.id.indexOf("_ej2_drag_rect")>-1||this.dragRectArray[this.targetIndex])&&(r.id.indexOf("_ej2_drag_rect")>-1&&(this.targetIndex=this.getIndex(r.id)),f=this.dragRectArray[this.targetIndex],u=new sf.svgbase.Rect(f.x,f.y,f.width,f.height));(n.allowMultiSelection||(u=new sf.svgbase.Rect(this.rectPoints.x,this.rectPoints.y,this.rectPoints.width,this.rectPoints.height)),u)&&(e=this.findResizeMode(n.svgObject,u,t),this.resizing&&(u=dr(u.x,u.y,u.x+u.width,u.y+u.height,n.chartAxisLayoutPanel.seriesClipRect),this.drawDraggingRect(n,u),this.dragRect=u),i&&(this.resizing=e))},t.prototype.findResizeMode=function(n,t,i){var f="se-resize",e=!1,l,u;if(this.resizing){var h=t.x,c=t.y,o=i.x-h,s=i.y-c;switch(this.resizeMode){case 0:s=Math.abs(t.height+t.y-i.y);t.y=Math.min(t.height+t.y,i.y);t.height=s;break;case 1:o=Math.abs(t.width+t.x-i.x);t.x=Math.min(t.width+t.x,i.x);t.width=o;break;case 2:t.height=Math.abs(s);t.y=Math.min(i.y,c);break;case 3:t.width=Math.abs(o);t.x=Math.min(i.x,h);break;case 4:t.width=Math.abs(o);t.height=Math.abs(s);t.x=Math.min(i.x,h);t.y=Math.min(i.y,c)}}else for(l=[new sf.svgbase.Rect(t.x,t.y,t.width-5,5),new sf.svgbase.Rect(t.x,t.y,5,t.height),new sf.svgbase.Rect(t.x,t.y+t.height-5,t.width-5,5),new sf.svgbase.Rect(t.x+t.width-5,t.y+5,5,t.height-15),new sf.svgbase.Rect(t.x+t.width-10,t.y+t.height-10,10,10)],u=0;u<l.length;u++)if(v(i.x,i.y,l[u])){f=4===u?f:u%2==0?"ns-resize":"ew-resize";e=!0;this.resizeMode=u;break}return"Lasso"!==this.currentMode&&this.changeCursorStyle(e,r(this.chart.allowMultiSelection?this.draggedRect+this.targetIndex:this.draggedRect),f),this.changeCursorStyle(e,n,f),e},t.prototype.changeCursorStyle=function(n,t,i){i=n?i:this.control.svgObject===t?"auto":"move";t&&t.setAttribute("style","cursor:"+i+";")},t.prototype.removeSelectedElements=function(n,t,i){var f,r,e,s,u,o,h;for(t=n.isRedrawSelection?t:t.splice(0,t.length),r=0,e=i;r<e.length;r++)for(s=e[r],f=this.getSeriesElements(s),this.removeStyles(f),u=0,o=f;u<o.length;u++)h=o[u],this.removeStyles(this.getChildren(h))},t.prototype.setAttributes=function(n,t){for(var u,i=0,r=Object.keys(t);i<r.length;i++)u=r[i],n.setAttribute(u,t[u])},t.prototype.draggedRectMoved=function(n,t,i,r){var u,f;(this.resizing||this.rectGrabbing)&&n.allowMultiSelection?(f=this.dragRectArray[this.targetIndex],u=new sf.svgbase.Rect(f.x,f.y,f.width,f.height)):u=new sf.svgbase.Rect(this.rectPoints.x,this.rectPoints.y,this.rectPoints.width,this.rectPoints.height);u.x-=t.x-n.mouseX;u.y-=t.y-n.mouseY;u=dr(u.x,u.y,u.x+u.width,u.height+u.y,n.chartAxisLayoutPanel.seriesClipRect);i?this.drawDraggingRect(n,u,r):this.calculateDragSelectedElements(n,u)},t.prototype.completeSelection=function(n){var t=this.chart;"None"!==t.selectionMode&&(this.currentMode=t.selectionMode,(this.dragging||this.resizing)&&this.dragRect.width>5&&this.dragRect.height>5?this.calculateDragSelectedElements(t,this.dragRect):(!t.allowMultiSelection&&this.rectGrabbing&&this.rectPoints.width&&this.rectPoints.height||this.rectGrabbing&&this.dragRectArray[this.targetIndex].width&&this.dragRectArray[this.targetIndex].height)&&this.draggedRectMoved(t,this.dragRect),"Lasso"===t.selectionMode&&this.dragging&&this.path&&-1!==this.path.indexOf("L")&&(t.allowMultiSelection?r(this.lassoPath+this.count)&&(r(this.lassoPath+this.count).setAttribute("d",this.path+"Z"),this.pointChecking(r(this.lassoPath+this.count))):(r(this.lassoPath).setAttribute("d",this.path+"Z"),this.pointChecking(r(this.lassoPath))),(this.dragging||this.resizing)&&this.calculateDragSelectedElements(t,this.dragRect)),this.dragging=!1,this.rectGrabbing=!1,this.resizing=!1,this.removeDraggedElements(t,n))},t.prototype.getDragRect=function(n,t){return dr(n.mouseDownX,n.mouseDownY,n.mouseX,n.mouseY,t)},t.prototype.dragStart=function(n,t,i,u,f){var o=n.selectionMode,e,h,l,a,c,y,w,p;if(this.currentMode=n.selectionMode,this.dragging=(o.indexOf("Drag")>-1||"Lasso"===o)&&(n.isDoubleTap||!n.isTouch)&&"PolarRadar"!==n.chartAreaType,e=f.target,this.path=void 0,this.dragging&&(this.count=r(this.multiRectGroup)?this.count+1:0,this.dragRect=new sf.svgbase.Rect(n.mouseDownX,n.mouseDownY,0,0),(n.mouseDownX<t.x||n.mouseDownX>t.x+t.width||n.mouseDownY<t.y||n.mouseDownY>t.y+t.height)&&(this.dragging=!1)),"Lasso"===o)for(h=0,l=n.visibleSeries;h<l.length;h++)if(a=l[h],a.visible)for(c=0,y=a.points;c<y.length;c++)w=y[c],n.allowMultiSelection||(w.isSelect=!1);"Lasso"!==o&&(this.rectPoints&&!n.allowMultiSelection&&(this.dragRect=new sf.svgbase.Rect(n.mouseDownX,n.mouseDownY,0,0),this.resizingSelectionRect(n,new s(i,u),!0),this.rectGrabbing=v(i,u,this.rectPoints)),n.allowMultiSelection)&&(p=this.getIndex(e.id),this.targetIndex=this.isDragRect(e.id)?p:void 0,this.dragRectArray.length&&this.isDragRect(e.id)&&(this.resizingSelectionRect(n,new s(i,u),!0,e),this.rectGrabbing=v(i,u,this.dragRectArray[p])))},t.prototype.isDragRect=function(n){return n.indexOf("_ej2_drag_rect")>-1},t.prototype.mouseMove=function(n){var t=this.chart,i=n.target;if("None"===t.highlightMode||sf.base.isNullOrUndefined(i))"None"!==t.selectionMode&&("touchmove"===n.type&&(sf.base.Browser.isIos||sf.base.Browser.isIos7)&&this.dragging&&n.preventDefault&&n.preventDefault(),v(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)?(this.rectGrabbing&&!this.resizing?this.draggedRectMoved(t,this.dragRect,!0,i):this.dragging&&!this.resizing&&("Lasso"===t.selectionMode?(this.getPath(t.mouseDownX,t.mouseDownY,t.mouseX,t.mouseY),this.drawDraggingRect(t,this.dragRect,i)):(this.dragRect=this.getDragRect(t,t.chartAxisLayoutPanel.seriesClipRect),this.drawDraggingRect(t,this.dragRect,i))),(this.rectPoints&&!t.allowMultiSelection||t.allowMultiSelection&&!this.dragging||this.resizing)&&this.resizingSelectionRect(t,new s(t.mouseX,t.mouseY),null,i)):this.completeSelection(n));else{if(n.target.id.indexOf("text")>1&&(i=r(n.target.id.replace("text","shape"))),i.hasAttribute("class")&&(i.getAttribute("class").indexOf("highlight")>-1||i.getAttribute("class").indexOf("selection")>-1))return;this.calculateSelectedElements(n)}},t.prototype.getPath=function(n,t,i,r){this.dragging&&(this.path=this.path?this.path+" L"+i+" "+r:"M "+n+" "+t)},t.prototype.pointChecking=function(n){var e,t=this,i=this.chart,o=r(i.svgId).getBoundingClientRect(),s=i.chartAxisLayoutPanel.seriesClipRect.x+Math.max(o.left,0),h=i.chartAxisLayoutPanel.seriesClipRect.y+Math.max(o.top,0),u,f;for(this.multiDataIndexes[this.count]=[],u=0,f=i.visibleSeries;u<f.length;u++)f[u].points.filter(function(r){r.symbolLocations&&r.symbolLocations.length&&(e=document.elementFromPoint(r.symbolLocations[0].x+s,r.symbolLocations[0].y+h));e===n?(r.isSelect=!0,t.chart.allowMultiSelection&&"Lasso"===t.currentMode&&(t.multiDataIndexes[t.count][t.seriesIndex]=r,t.seriesIndex++)):i.allowMultiSelection||(r.isSelect=!1)});this.seriesIndex=0},t.prototype.getModuleName=function(){return"Selection"},t.prototype.destroy=function(){this.removeEventListener()},t}(fb),pv=function(){function n(n){this.isPointDragging=!1;this.chart=n}return n.prototype.pointMouseDown=function(){var n=this.chart,i=new lr(n),t=i.getData();t.point&&(i.insideRegion||!t.series.isRectSeries)&&(this.seriesIndex=t.series.index,this.pointIndex=t.point.index,n.series[this.seriesIndex].dragSettings.enable&&!n.zoomModule&&(n.trigger("dragStart",{series:t.series,seriesIndex:this.seriesIndex,pointIndex:this.pointIndex,point:t.point,oldValue:n.visibleSeries[this.seriesIndex].yData[this.pointIndex],newValue:n.visibleSeries[this.seriesIndex].points[this.pointIndex].yValue}),n.isPointMouseDown=!0,n.zoomSettings.enableDeferredZooming=!1))},n.prototype.pointMouseMove=function(n){var r,t=this.chart,u,i;"touchmove"===n.type&&n.preventDefault&&n.preventDefault();u=new lr(t);i=u.getData();i.series.dragSettings.enable&&i.point&&(u.insideRegion||!i.series.isRectSeries)?this.getCursorStyle(i):t.svgObject.setAttribute("style","cursor: null");t.isPointMouseDown&&((r=t.series[this.seriesIndex]).type.indexOf("Spline")>-1&&t[tt(r.type)+"SeriesModule"].findSplinePoint(r),this.pointDragging(this.seriesIndex,this.pointIndex))},n.prototype.getCursorStyle=function(n){var t=this.chart;"Bar"===n.series.type&&t.isTransposed?t.svgObject.setAttribute("style","cursor:ns-resize"):t.isTransposed||"Bar"===n.series.type?t.svgObject.setAttribute("style","cursor:ew-resize"):t.svgObject.setAttribute("style","cursor:ns-resize")},n.prototype.pointDragging=function(n,t){var h,c,e,r=this.chart,l=[],i=r.visibleSeries[n],o=i.dragSettings,y=i.xAxis,u=i.yAxis,a=i.isRectSeries?1:0,f=sc(y,u,r.requireInvertedAxis),v,s;if("Bar"===i.type?(h=r.isTransposed?f.y+f.height-r.mouseY:r.mouseX-f.x,c=r.isTransposed?f.height:f.width):(h=r.isTransposed?r.mouseX-f.x:f.y+f.height-r.mouseY,c=r.isTransposed?f.width:f.height),e=(e=u.isInversed?1-h/c:h/c)*u.visibleRange.delta+u.visibleRange.min,v=null!==u.minimum?u.visibleRange.min+a:sf.base.isNullOrUndefined(o.minY)?e:o.minY,(null!==u.maximum?u.visibleRange.max+a:sf.base.isNullOrUndefined(o.maxY)?e:o.maxY)>=e&&v<=e){for(i.points[t].yValue=i.points[t].y=r.dragY="Logarithmic"===u.valueType?Math.pow(u.logBase,e):parseFloat(e.toFixed(2)),i.points[t].interior=o.fill,s=0;s<i.points.length;s++)l[s]=i.points[s].yValue;i.yMin=Math.min.apply(null,l);i.yMax=Math.max.apply(null,l);this.isPointDragging=!0;r.refreshBound();r.trigger("drag",{seriesIndex:n,pointIndex:t,series:i,point:i.points[t],oldValue:r.visibleSeries[this.seriesIndex].yData[this.pointIndex],newValue:i.points[t].yValue})}},n.prototype.pointMouseUp=function(){var n=this.chart;n.isPointMouseDown&&n.series[this.seriesIndex].dragSettings.enable&&(n.trigger("dragEnd",{series:n.series[this.seriesIndex],point:n.visibleSeries[this.seriesIndex].points[this.pointIndex],seriesIndex:this.seriesIndex,pointIndex:this.pointIndex,oldValue:n.visibleSeries[this.seriesIndex].yData[this.pointIndex],newValue:n.visibleSeries[this.seriesIndex].points[this.pointIndex].yValue}),n.visibleSeries[this.seriesIndex].points[this.pointIndex].y=n.visibleSeries[this.seriesIndex].points[this.pointIndex].yValue,n.isPointMouseDown=!1,this.isPointDragging=!1,this.seriesIndex=this.pointIndex=void 0)},n.prototype.getModuleName=function(){return"DataEditing"},n.prototype.destroy=function(){},n}(),ob=(rs=function(n,t){return(rs=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}rs(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),wv=function(n){function t(t){var i=n.call(this,t)||this;return i.chart=t,i.renderer=t.renderer,i.wireEvents(),i}return ob(t,n),t.prototype.wireEvents=function(){this.chart.isDestroyed||this.chart.stockChart&&this.chart.stockChart.onPanning||this.chart.on(sf.base.Browser.touchMoveEvent,this.mouseMove,this)},t.prototype.unWireEvents=function(){this.chart.isDestroyed||this.chart.off(sf.base.Browser.touchMoveEvent,this.mouseMove)},t.prototype.declarePrivateVariables=function(n){this.styleId=n.element.id+"_ej2_chart_highlight";this.unselected=n.element.id+"_ej2_deselected";this.selectedDataIndexes=[];this.highlightDataIndexes=[];this.isSeriesMode="Series"===n.highlightMode},t.prototype.invokeHighlight=function(n){this.declarePrivateVariables(n);this.series=sf.base.extend({},n.visibleSeries,null,!0);this.seriesStyles();this.currentMode=n.highlightMode},t.prototype.getModuleName=function(){return"Highlight"},t.prototype.destroy=function(){this.unWireEvents()},t}(ks),bv=function(){function n(n){this.errorHeight=0;this.chart=n}return n.prototype.initPrivateVariables=function(n,t){var r="",u="",f=n.chart.renderer,i=void 0===n.index?n.category:n.index;"Cartesian"===n.chart.chartAreaType&&(r="translate("+n.clipRect.x+","+n.clipRect.y+")",u="url(#"+this.chart.element.id+"_ChartSeriesClipRect_"+i+")");t.dataLabel.visible&&(n.shapeElement=f.createGroup({id:this.chart.element.id+"ShapeGroup"+i,transform:r,"clip-path":"url(#"+this.chart.element.id+"_ChartSeriesClipRect_"+i+")"}),n.textElement=f.createGroup({id:this.chart.element.id+"TextGroup"+i,transform:r,"clip-path":u}));this.markerHeight="Scatter"===n.type||t.visible?t.height/2:0;this.commonId=this.chart.element.id+"_Series_"+i+"_Point_";this.calculateErrorHeight(n,n.marker.dataLabel.position);this.chartBackground="transparent"===this.chart.chartArea.background?this.chart.background||this.chart.themeStyle.background:this.chart.chartArea.background},n.prototype.calculateErrorHeight=function(n,t){if(!n.errorBar.visible)return null;if(n.errorBar.visible&&"PolarRadar"!==this.chart.chartAreaType){var i=n.errorBar.direction,r=this.chart.errorBarModule.positiveHeight,u=this.chart.errorBarModule.negativeHeight;this.isRectSeries(n)?("Top"!==t&&"Auto"!==t||(this.errorHeight="Both"===i||"Minus"===i?u:0),"Outer"!==t&&"Auto"!==t||(this.errorHeight="Both"===i||"Plus"===i?r:0)):("Top"!==t&&"Outer"!==t&&"Auto"!==t||(this.errorHeight="Both"!==i&&"Plus"!==i||n.chart.isTransposed?0:r),"Bottom"!==t&&"Auto"!==t||(this.errorHeight="Both"===i||"Minus"===i?u:0))}else this.errorHeight=0},n.prototype.isRectSeries=function(n){return n.isRectSeries||"RangeArea"===n.type||"SplineRangeArea"===n.type},n.prototype.render=function(n,t,i){var u,b,ot,f,st,d,s,l,a,dt,o,nt,et,gt,ni,p,w;this.initPrivateVariables(n,n.marker);a={x:0,y:0};this.inverted=t.requireInvertedAxis;this.yAxisInversed=n.yAxis.isInversed;for(var e,ct,lt,at=t.redraw,v=!1,tt=[],ti=t.element.id+"_Series_"+(void 0===n.index?n.category:n.index)+"_DataLabelCollections",g=sf.base.createElement("div",{id:ti}),vt=fi(n),it=0;it<vt.length;it++){if(e=vt[it],!i.showZero&&(0!==e.y||0===e.y&&"Zero"===n.emptyPointSettings.mode))return null;this.margin=i.margin;var rt=[],yt=void 0,pt=void 0,wt=void 0,ut=void 0,ft=void 0,bt=!0,c=n.clipRect,kt=void 0;if(v=!1,s=l=i.angle,st={width:i.border.width,color:i.border.color},dt=sf.base.extend({},sf.base.getValue("properties",i.font),null,!0),e.symbolLocations.length&&e.symbolLocations[0]||"BoxAndWhisker"===n.type&&e.regions.length)for(yt=(rt=bc(e,n,t)).length,o=0;o<yt;o++)if(f={cancel:!1,name:"textRender",series:n,point:e,text:rt[o],border:st,color:i.fill,template:i.template,font:dt,location:a,textSize:sf.svgbase.measureText(rt[o],i.font)},t.trigger("textRender",f),!f.cancel)if(this.fontBackground=f.color,this.isDataLabelShape(f),this.markerHeight="Bubble"===n.type?e.regions[0].height/2:this.markerHeight,null!==f.template)this.createDataLabelTemplate(g,n,i,e,f,o,at);else{if(d=sf.svgbase.measureText(f.text,i.font),u=this.calculateTextPosition(e,n,d,i,o),"PolarRadar"===t.chartAreaType)for(nt=0,et=t.chartAxisLayoutPanel.visibleAxisLabelRect;nt<et.length;nt++)if(gt=et[nt],gi(new sf.svgbase.Rect(u.x,u.y,u.width,u.height),gt)){bt=!1;break}if(ni=new sf.svgbase.Rect(u.x+c.x,u.y+c.y,u.width,u.height),i.enableRotation){if(tt=yu(this.getRectanglePoints(u),ct=u.x+u.width/2,lt=u.y+u.height/2,s),!(v=this.isDataLabelOverlapWithChartBound(tt,t,c)))for(this.chart.rotatedDataLabelCollections.push(tt),p=this.chart.rotatedDataLabelCollections.length-1,w=p;w>=0;w--)if(this.chart.rotatedDataLabelCollections[p]&&this.chart.rotatedDataLabelCollections[w-1]&&pu(this.chart.rotatedDataLabelCollections[p],this.chart.rotatedDataLabelCollections[w-1])){v=!0;this.chart.rotatedDataLabelCollections[p]=null;break}}else v=di(u,t.dataLabelCollections,c);v&&"None"!==i.labelIntersectAction||!bt||(t.dataLabelCollections.push(ni),this.isShape&&(kt=t.renderer.drawRectangle(new y(this.commonId+e.index+"_TextShape_"+o,f.color,f.border,i.opacity,u,i.rx,i.ry),new Int32Array([c.x,c.y])),n.shapeElement&&n.shapeElement.appendChild(kt)),b=nu(ht(this.fontBackground)),ot=Math.round((299*b.r+587*b.g+114*b.b)/1e3),pt=u.x+this.margin.left+d.width/2+a.x,wt=u.y+this.margin.top+3*d.height/4+a.y,a={x:0,y:0},0!==s&&i.enableRotation?(ut=ct,ft=lt,l=s>360?s-360:s<-360?s+360:s):(l=0,ut=u.x,ft=u.y),k(t.renderer,new sf.svgbase.TextOption(this.commonId+e.index+"_Text_"+o,pt,wt,"middle",f.text,"rotate("+l+","+ut+","+ft+")","auto",l),f.font,f.font.color||(ot>=128||"Hilo"===n.type?"black":"white"),n.textElement,!1,at,!0,!1,n.chart.duration,n.clipRect,0,null,t.enableCanvas))}}g.childElementCount&&(t.enableCanvas?r(t.element.id+"_Secondary_Element").appendChild(g):h(t.enableCanvas,r(t.element.id+"_Secondary_Element"),g,t.redraw,!1,"x","y",null,"",!1,!1,null,t.duration))},n.prototype.getRectanglePoints=function(n){return[new s(n.x,n.y),new s(n.x+n.width,n.y),new s(n.x+n.width,n.y+n.height),new s(n.x,n.y+n.height)]},n.prototype.isDataLabelOverlapWithChartBound=function(n,t,i){for(var r=0;r<n.length;r++)if(!v(n[r].x+i.x,n[r].y+i.y,t.initialClipRect))return!0;return!1},n.prototype.createDataLabelTemplate=function(n,t,i,r,u,f,e){this.margin={left:0,right:0,bottom:0,top:0};var o=t.clipRect,s=tf(sf.base.createElement("div",{id:this.chart.element.id+"_Series_"+(void 0===t.index?t.category:t.index)+"_DataLabel_"+r.index+(f?"_"+f:""),styles:"position: absolute;background-color:"+u.color+";"+pc(i.font)+";border:"+u.border.width+"px solid "+u.border.color+";"}),r.index,u.template,this.chart,r,t,this.chart.element.id+"_DataLabel",f);this.calculateTemplateLabelSize(n,s,r,t,i,f,o,e)},n.prototype.calculateTemplateLabelSize=function(n,t,i,r,u,f,e,o,s){var l=rf(t,o,s),c=this.calculateTextPosition(i,r,{width:l.width,height:l.height},u,f),p=!1;s&&(p=0===l.width||0===l.height);t.style.left=("PolarRadar"===this.chart.chartAreaType?0:r.clipRect.x)+c.x-0+"px";t.style.top=("PolarRadar"===this.chart.chartAreaType?0:r.clipRect.y)+c.y+0+"px";var a=nu(ht(this.fontBackground)),v=r.chart.requireInvertedAxis?r.xAxis:r.yAxis,y=r.chart.requireInvertedAxis?r.yAxis:r.xAxis;t.style.color=u.font.color||(Math.round((299*a.r+587*a.g+114*a.b)/1e3)>=128?"black":"white");t.childElementCount&&!p&&(!di(c,this.chart.dataLabelCollections,e)||"None"===u.labelIntersectAction)&&("XY"!==r.seriesType||void 0===i.yValue||ut(i.yValue,r.yAxis.visibleRange)||r.type.indexOf("Stacking")>-1||r.type.indexOf("100")>-1&&ut(r.stackedValues.endValues[i.index],r.yAxis.visibleRange))&&ut(i.xValue,r.xAxis.visibleRange)&&parseFloat(t.style.top)>=v.rect.y&&parseFloat(t.style.left)>=y.rect.x&&parseFloat(t.style.top)<=v.rect.y+v.rect.height&&parseFloat(t.style.left)<=y.rect.x+y.rect.width&&(this.chart.dataLabelCollections.push(new sf.svgbase.Rect(c.x+e.x,c.y+e.y,c.width,c.height)),h(this.chart.enableCanvas,n,t,o,!0,"left","top"),r.animation.enable&&this.chart.animateSeries&&!this.chart.enableCanvas?this.doDataLabelAnimation(r,t):this.chart.enableCanvas&&n.appendChild(t))},n.prototype.calculateTextPosition=function(n,t,i,r,u){var e,h=u>1&&"Candle"===t.type?n.regions[1]:n.regions[0],o,s,f;return u>1&&"HiloOpenClose"===t.type&&(h=2===u?n.regions[1]:n.regions[2]),e=this.getLabelLocation(n,t,i,u),o=t.clipRect,this.chart.requireInvertedAxis&&this.isRectSeries(t)&&"BoxAndWhisker"!==t.type?(this.locationY=e.y,s=i.width+this.borderWidth+this.margin.left+this.margin.right-5,e.x="Auto"===r.position?e.x:this.calculateAlignment(s,e.x,r.alignment,n.yValue<0),e.x=this.calculateRectPosition(e.x,h,n.yValue<0!==this.yAxisInversed,r.position,t,i,u,n)):(this.locationX=e.x,s=i.height+2*this.borderWidth+this.markerHeight+this.margin.bottom+this.margin.top+5,e.y="Auto"===r.position?e.y:this.calculateAlignment(s,e.y,r.alignment,!!this.isRectSeries(t)&&n.yValue<0),e.y=this.isRectSeries(t)&&"BoxAndWhisker"!==t.type?this.calculateRectPosition(e.y,h,n.yValue<0!==this.yAxisInversed,r.position,t,i,u,n):this.calculatePathPosition(e.y,r.position,t,n,i,u),this.isRectSeries(t)&&"PolarRadar"===this.chart.chartAreaType&&(e=this.calculatePolarRectPosition(e,r.position,t,n,i,u,r.alignment,s))),f=sr(e,i,this.margin),!0===r.enableRotation&&0!==r.angle||f.y>o.y+o.height||f.x>o.x+o.width||f.x+f.width<0||f.y+f.height<0||(f.x=f.x<0?5:f.x,f.y=f.y<0&&"None"!==r.labelIntersectAction?5:f.y,f.x-=f.x+f.width>o.x+o.width?f.x+f.width-(o.x+o.width)+5:0,f.y-=f.y+f.height>o.y+o.height?f.y+f.height-(o.y+o.height)+5:0,this.fontBackground="transparent"===this.fontBackground?this.chartBackground:this.fontBackground),f},n.prototype.calculatePolarRectPosition=function(n,t,i,r,u,f,e,o){var s,h=this.chart.availableSize.width,l="Center"===e?0:"Far"===e?1:-1,c=r.regionData.startAngle-.5*Math.PI+(r.regionData.endAngle-r.regionData.startAngle)/2;return s=0===f?r.regionData.radius<r.regionData.innerRadius?r.regionData.innerRadius:r.regionData.radius:r.regionData.radius>r.regionData.innerRadius?r.regionData.innerRadius:r.regionData.radius,this.fontBackground="transparent"===this.fontBackground?this.chartBackground:this.fontBackground,i.drawType.indexOf("Stacking")>-1?t="Outer"===t?"Top":t:i.drawType.indexOf("Range")>-1&&(t="Outer"===t||"Top"===t?t:"Auto"),"Outer"===t?s=0===f?s+10+this.markerHeight:s-10-this.markerHeight:"Middle"===t?(s=s/2+5,"StackingColumn"===i.drawType&&(s=r.regionData.innerRadius+(r.regionData.radius-r.regionData.innerRadius)/2+5-u.height/2)):"Top"===t?s=0===f?s-10-this.markerHeight:s+10+this.markerHeight:"Bottom"===t?(s=10,s+="StackingColumn"===i.drawType?r.regionData.innerRadius+this.markerHeight:0):s=0===f?s>=i.chart.radius?s-5:"StackingColumn"===i.drawType?s-10:s+10:s>=i.chart.radius?s+5:s-10,s+=o*l,n.x=i.clipRect.width/2+i.clipRect.x+s*Math.cos(c),"StackingColumn"===i.drawType?n.x=n.x<h/2?n.x+u.width/2:n.x>h/2?n.x-u.width/2:n.x:"Column"===i.drawType&&(n.x=n.x<h/2?n.x-u.width/2:n.x>h/2?n.x+u.width/2:n.x),n.y=i.clipRect.height/2+i.clipRect.y+s*Math.sin(c),n},n.prototype.getLabelLocation=function(n,t,i,r){var u=new s(0,0),f="Candle"===t.type&&r>1?n.regions[1]:n.regions[0],l,a;"HiloOpenClose"===t.type&&(f=2===r?n.regions[1]:n.regions[2]);var h=t.xAxis,c=t.yAxis,o=t.chart.requireInvertedAxis;if("BoxAndWhisker"===t.type){switch(this.markerHeight=0,r){case 0:u=e(n.xValue,n.median,h,c,o);break;case 1:u=e(n.xValue,n.maximum,h,c,o);break;case 2:u=e(n.xValue,n.minimum,h,c,o);break;case 3:u=e(n.xValue,n.upperQuartile,h,c,o);break;case 4:u=e(n.xValue,n.lowerQuartile,h,c,o);break;default:u=e(n.xValue,n.outliers[r-5],h,c,o);this.markerHeight=t.marker.height/2}o?u.y=n.regions[0].y+n.regions[0].height/2:u.x=n.regions[0].x+n.regions[0].width/2}else u=0===r||1===r?new s(n.symbolLocations[0].x,n.symbolLocations[0].y):2!==r&&3!==r||"Candle"!==t.type?o?{x:f.x+f.width/2,y:f.y}:{x:f.x+f.width,y:f.y+f.height/2}:new s(n.symbolLocations[1].x,n.symbolLocations[1].y);return r>1&&"HiloOpenClose"===t.type&&(t.chart.requireInvertedAxis?(l=f.height,u.y=f.y+l/2+2*(2===r?1:-1)):(a=f.width,u.x=f.x+a/2+2*(2===r?1:-1))),u},n.prototype.calculateRectPosition=function(n,t,i,r,u,f,e,o){var y,a;if("PolarRadar"===u.chart.chartAreaType)return null;var c=this.margin,p=this.inverted?f.width:f.height,s=this.borderWidth+p/2+5;switch("StackingColumn100"===u.type||"StackingBar100"===u.type?r="Outer"===r?"Top":r:u.type.indexOf("Range")>-1?r="Outer"===r||"Top"===r?r:"Auto":"Waterfall"===u.type&&(r="Auto"===r?"Middle":r),r){case"Bottom":n=this.inverted?i?n+t.width-s-c.left:n-t.width+s+c.right:i?n-t.height+s+c.top:n+t.height-s-c.bottom;break;case"Middle":n=n=this.inverted?i?n+t.width/2:n-t.width/2:i?n-t.height/2:n+t.height/2;break;case"Auto":n=this.calculateRectActualPosition(n,t,i,u,f,e,o);break;default:s+=this.errorHeight;n=this.calculateTopAndOuterPosition(n,t,r,u,e,s,i)}if(y=this.inverted?n<t.x||n>t.x+t.width:n<t.y||n>t.y+t.height,this.fontBackground=y?"transparent"===this.fontBackground?this.chartBackground:this.fontBackground:"transparent"===this.fontBackground?o.color||u.interior:this.fontBackground,a=u.chart.series.length,"Outer"===r&&u.type.indexOf("Stacking")>-1&&a-1>u.index)for(var l=void 0,h=void 0,v=u.index+1;v<a;v++)if(h=(l=u.chart.series[v]).points[o.index],l.type.indexOf("Stacking")>-1&&-1===l.type.indexOf("100")){this.fontBackground=h&&(h.yValue<0&&o.yValue<0||h.yValue>0&&o.yValue>0)?h?h.color:l.interior:this.fontBackground;break}return n},n.prototype.calculatePathPosition=function(n,t,i,r,u,f){switch(i.type.indexOf("Area")>-1&&"RangeArea"!==i.type&&"SplineRangeArea"!==i.type&&this.yAxisInversed&&"Auto"!==i.marker.dataLabel.position&&(t="Top"===t?"Bottom":"Bottom"===t?"Top":t),this.fontBackground="transparent"===this.fontBackground?this.chartBackground:this.fontBackground,t){case"Top":case"Outer":n=n-this.markerHeight-this.borderWidth-u.height/2-this.margin.bottom-5-this.errorHeight;break;case"Bottom":n=n+this.markerHeight+this.borderWidth+u.height/2+this.margin.top+5+this.errorHeight;break;case"Auto":n=this.calculatePathActualPosition(n,this.markerHeight,i,r,u,f)}return n},n.prototype.isDataLabelShape=function(n){this.isShape="transparent"!==n.color||n.border.width>0;this.borderWidth=n.border.width;this.isShape||(this.margin={left:0,right:0,bottom:0,top:0})},n.prototype.calculateRectActualPosition=function(n,t,i,r,u,f,e){for(var l,h,o,a=!0,c=0,v=this.chart.dataLabelCollections,y=-1!==r.type.indexOf("Range")||"Hilo"===r.type?2:4;a&&c<y;)l=this.getPosition(c),r.type.indexOf("Stacking")>-1&&"Outer"===l&&(l="Top",c++),h=this.calculateRectPosition(n,t,i,l,r,u,f,e),a=this.inverted?(o=sr(new s(h,this.locationY),u,this.margin)).x<0||di(o,v,r.clipRect)||o.x+o.width>r.clipRect.width:(o=sr(new s(this.locationX,h),u,this.margin)).y<0||di(o,v,r.clipRect)||o.y>r.clipRect.height,c++;return h},n.prototype.calculateAlignment=function(n,t,i,r){switch(i){case"Far":t=this.inverted?r?t-n:t+n:r?t+n:t-n;break;case"Near":t=this.inverted?r?t+n:t-n:r?t-n:t+n;break;case"Center":t=t}return t},n.prototype.calculateTopAndOuterPosition=function(n,t,i,r,u,f,e){var s,o=this.margin;switch(r.type){case"RangeColumn":case"RangeArea":case"SplineRangeArea":case"Hilo":s=0===u&&!this.yAxisInversed||1===u&&this.yAxisInversed;n=this.updateLabelLocation(i,n,f,o,t,s);break;case"Candle":s=(0===u||2===u)&&!this.yAxisInversed||(1===u||3===u)&&this.yAxisInversed;n=this.updateLabelLocation(i,n,f,o,t,s,u>1);break;case"HiloOpenClose":u<=1?(s=0===u&&!this.yAxisInversed||1===u&&this.yAxisInversed,n=this.updateLabelLocation(i,n,f,o,t,s)):n=this.yAxisInversed?this.inverted?n-f-o.right:n+f+o.top:this.inverted?n+f+o.left:n-f-o.bottom;break;default:n=e&&"Top"===i||!e&&"Outer"===i?this.inverted?n+f+o.left+this.markerHeight:n-f-o.bottom-this.markerHeight:this.inverted?n-f-o.right-this.markerHeight:n+f+o.top+this.markerHeight}return n},n.prototype.updateLabelLocation=function(n,t,i,r,u,f,e){return void 0===e&&(e=!1),t=this.inverted?f?"Outer"!==n||e?t-i-r.right-this.markerHeight:t+i+r.left+this.markerHeight:"Outer"!==n||e?t-u.width+i+r.left+this.markerHeight:t-u.width-i-r.right-this.markerHeight:f?"Outer"!==n||e?t+i+r.top+this.markerHeight:t-i-r.bottom-this.markerHeight:"Outer"!==n||e?t+u.height-i-r.bottom-this.markerHeight:t+u.height+i+r.top+this.markerHeight},n.prototype.calculatePathActualPosition=function(n,t,i,r,u,f){var e,y,p,w,a,v=i.points,h=r.index,c=v[h].yValue,l=v.length-1>h?v[h+1]:null,o=h>0?v[h-1]:null,b=!0,g=this.chart.dataLabelCollections,k,d;for("Bubble"===i.type?e="Top":i.type.indexOf("Step")>-1?(e="Top",h&&(e=o&&o.visible&&c>o.yValue===this.yAxisInversed&&c!==o.yValue?"Bottom":"Top")):"BoxAndWhisker"===i.type?1===f||3===f||f>4?e=i.yAxis.isInversed?"Bottom":"Top":2===f||4===f?e=i.yAxis.isInversed?"Top":"Bottom":(b=!1,e="Middle",y=this.calculatePathPosition(n,e,i,r,u,f)):0===h?e=!l||!l.visible||c>l.yValue||c<l.yValue&&this.yAxisInversed?"Top":"Bottom":h===v.length-1?e=!o||!o.visible||c>o.yValue||c<o.yValue&&this.yAxisInversed?"Top":"Bottom":l.visible||o&&o.visible?l.visible&&o?(k=(l.yValue-o.yValue)/2,d=k*h+(l.yValue-k*(h+1)),e=this.yAxisInversed?d<c?"Bottom":"Top":d<c?"Top":"Bottom"):e=l.yValue>c||o&&o.yValue>c?"Bottom":"Top":e="Top",w="Bottom"===e,a=["Outer","Top","Bottom","Middle","Auto"].indexOf(e);b&&a<4;)y=this.calculatePathPosition(n,this.getPosition(a),i,r,u,f),b=(p=sr(new s(this.locationX,y),u,this.margin)).y<0||di(p,g,i.clipRect)||p.y+p.height>i.clipRect.height,a=w?a-1:a+1,w=!1;return y},n.prototype.doDataLabelAnimation=function(n,t){for(var u,i,o=n.shapeElement.childNodes,h=n.textElement.childNodes,f=n.animation.delay+n.animation.duration,e=n.chart.animated?n.chart.duration:200,c=t?1:h.length,r=0;r<c;r++)i=h[r],t?(t.style.visibility="hidden",er(t,f,e,"ZoomIn")):(u=new s(+i.getAttribute("x")+ +i.getAttribute("width")/2,+i.getAttribute("y")+ +i.getAttribute("height")/2),oi(i,f,e,n,null,u,!0),o[r]&&(i=o[r],u=new s(+i.getAttribute("x")+ +i.getAttribute("width")/2,+i.getAttribute("y")+ +i.getAttribute("height")/2),oi(i,f,e,n,null,u,!0)))},n.prototype.getPosition=function(n){return["Outer","Top","Bottom","Middle","Auto"][n]},n.prototype.getModuleName=function(){return"DataLabel"},n.prototype.destroy=function(){},n}(),kv=function(){function n(n){this.chart=n}return n.prototype.render=function(n){if("PolarRadar"===this.chart.chartAreaType)return null;this.createElement(n,this.chart);this.renderErrorBar(n)},n.prototype.renderErrorBar=function(n){for(var i,e,o,a,v,y,p=n.index,t=n.errorBar,w=n.errorBar.errorBarCap,f=["",""],s=n.chart.redraw,c=0,b=n.points;c<b.length;c++)if(i=b[c],i.visible&&i.symbolLocations[0]){e=0;o=0;switch(t.mode){case"Vertical":o=t.verticalError;break;case"Horizontal":e=t.horizontalError;break;case"Both":e=t.horizontalError;o=t.verticalError}f=this["calculate"+t.type+"Value"](i,n,this.chart.requireInvertedAxis,e,o);v=this.chart.element.id+"_Series__ErrorBarGroup_"+p+"_Point_"+i.index;y=this.chart.element.id+"_Series__ErrorBarCap_"+p+"_Point_"+i.index;var k=new sf.svgbase.PathOption(v,"",t.width,t.color||this.chart.themeStyle.errorBar,null,"",f[0]),u=r(k.id),l=u?u.getAttribute("d"):null;n.errorBarElement.appendChild(this.chart.renderer.drawPath(k));ii(u,f[0],s,l);a=new sf.svgbase.PathOption(y,"",w.width,w.color||this.chart.themeStyle.errorBar,null,"",f[1]);l=(u=r(a.id))?u.getAttribute("d"):null;h(this.chart.enableCanvas,n.errorBarElement,this.chart.renderer.drawPath(a),s);ii(u,f[1],s,l)}},n.prototype.findLocation=function(n,t,i,r,u){var f=t.errorBar,s=f.direction,o=[],c=t.type.indexOf("Stacking")>-1?t.stackedValues.endValues[n.index]:"HighLow"===t.seriesType||"HighLowOpenClose"===t.seriesType?t.points[n.index].high:n.yValue,a=e(n.xValue+("Plus"===s||"Both"===s?"Custom"!==f.type||"Horizontal"!==f.mode&&"Both"!==f.mode?r:r=f.horizontalPositiveError:0),c+("Plus"===s||"Both"===s?"Custom"!==f.type||"Vertical"!==f.mode&&"Both"!==f.mode?u:u=f.verticalPositiveError:0),t.xAxis,t.yAxis,i),h,l;return(o.push(a),t.isRectSeries)?(h=n.symbolLocations[0],o.push(h)):(h=e(n.xValue,n.yValue,t.xAxis,t.yAxis,i),o.push(h)),l=e(n.xValue-("Minus"===s||"Both"===s?"Custom"!==f.type||"Horizontal"!==f.mode&&"Both"!==f.mode?r:r=f.horizontalNegativeError:0),c-("Minus"===s||"Both"===s?"Custom"!==f.type||"Vertical"!==f.mode&&"Both"!==f.mode?u:u=f.verticalNegativeError:0),t.xAxis,t.yAxis,i),o.push(l),n.error="Vertical"===f.mode?f.verticalError:f.horizontalError,this.negativeHeight="Vertical"===f.mode||"Both"===f.mode?i?o[1].x-o[2].x:o[2].y-o[1].y:0,this.positiveHeight="Vertical"===f.mode||"Both"===f.mode?i?o[0].x-o[1].x:o[1].y-o[0].y:0,this.getErrorDirection(o[0],o[1],o[2],t,i)},n.prototype.calculateFixedValue=function(n,t,i,r,u){return t.errorBar,this.findLocation(n,t,i,r,u)},n.prototype.calculatePercentageValue=function(n,t,i,r,u){return r=r/100*n.xValue,u=u/100*n.yValue,this.findLocation(n,t,i,r,u)},n.prototype.calculateStandardDeviationValue=function(n,t,i,r,u){var f=this.meanCalculation(t,t.errorBar.mode);return r*=f.horizontalSquareRoot+f.horizontalMean,u*=f.verticalSquareRoot+f.verticalMean,this.findLocation(n,t,i,r,u)},n.prototype.calculateStandardErrorValue=function(n,t,i,r,u){var f=t.points.length,e=this.meanCalculation(t,t.errorBar.mode);return r=r*e.horizontalSquareRoot/Math.sqrt(f),u=u*e.verticalSquareRoot/Math.sqrt(f),this.findLocation(n,t,i,r,u)},n.prototype.calculateCustomValue=function(n,t,i,r,u){return t.errorBar,this.findLocation(n,t,i,r,u)},n.prototype.getHorizontalDirection=function(n,t,i,r,u,f){var e="",o="";return e+="M "+n.x+" "+t.y+" L "+i.x+" "+t.y,o+="Plus"===r||"Both"===r?"M "+n.x+" "+(t.y-f)+" L "+n.x+" "+(t.y+f):"",[e,o+="Minus"===r||"Both"===r?"M "+i.x+" "+(t.y-f)+" L "+i.x+" "+(t.y+f):" "]},n.prototype.getVerticalDirection=function(n,t,i,r,u,f){var e="",o="";return e+="M "+t.x+" "+n.y+" L "+t.x+" "+i.y,o+="Plus"===r||"Both"===r?"M "+(t.x-f)+" "+n.y+" L "+(t.x+f)+" "+n.y:"",[e,o+="Minus"===r||"Both"===r?"M "+(t.x-f)+" "+i.y+" L "+(t.x+f)+" "+i.y:""]},n.prototype.getBothDirection=function(n,t,i,r,u,f){var e=this.getHorizontalDirection(n,t,i,r,u,f),o=this.getVerticalDirection(n,t,i,r,u,f);return[e[0].concat(o[0]),e[1].concat(o[1])]},n.prototype.getErrorDirection=function(n,t,i,r,u){var e,s=r.errorBar.direction,o=r.errorBar.mode,h=r.errorBar.errorBarCap.length,f=o;switch(o){case"Both":f=o;break;case"Horizontal":f=u?"Vertical":o;break;case"Vertical":f=u?"Horizontal":o}switch(f){case"Horizontal":e=this.getHorizontalDirection(n,t,i,s,f,h);break;case"Vertical":e=this.getVerticalDirection(n,t,i,s,f,h);break;case"Both":e=this.getBothDirection(n,t,i,s,f,h)}return[e[0],e[1]]},n.prototype.meanCalculation=function(n,t){var u=0,r=0,f=0,e=0,i=n.points.length,o,h,s;switch(t){case"Vertical":f=(r=g(n.yData))/i;break;case"Horizontal":e=(u=g(n.xData))/i;break;case"Both":f=(r=g(n.yData))/i;e=(u=g(n.xData))/i}for(o=0,h=n.points;o<h.length;o++)s=h[o],"Vertical"===t?r+=Math.pow(s.yValue-f,2):("Horizontal"===t||(r+=Math.pow(s.yValue-f,2)),u+=Math.pow(s.xValue-e,2));var c=r/(i-1),l=Math.sqrt(r/(i-1)),a=u/(i-1),v=Math.sqrt(u/(i-1));return new wu(c,l,a,v,f,e)},n.prototype.createElement=function(n,t){var f="Cartesian"===t.chartAreaType?"translate("+n.clipRect.x+","+n.clipRect.y+")":"",i=n.marker.height/2,r=n.marker.width/2,u;"Cartesian"===t.chartAreaType&&(u=new y(t.element.id+"_ChartErrorBarClipRect_"+n.index,"transparent",{width:1,color:"Gray"},1,{x:-r,y:-i,width:n.clipRect.width+2*r,height:n.clipRect.height+2*i}),n.errorBarElement=t.renderer.createGroup({id:t.element.id+"ErrorBarGroup"+n.index,transform:f,"clip-path":"url(#"+t.element.id+"_ChartErrorBarClipRect_"+n.index+")"}),n.errorBarElement.appendChild(vt(t.redraw,u,t.renderer)))},n.prototype.doErrorBarAnimation=function(n){var i=n.errorBarElement.childNodes,u,t,r;if(!i)return null;for(u=n.animation.delay+n.animation.duration,t=1;t<i.length;){for(r=0;r<n.points.length;r++)n.points[r].symbolLocations[0]&&(i[t].style.visibility="hidden",er(i[t],u,350,n.chart.requireInvertedAxis?"SlideLeftIn":"SlideBottomIn",!1));t++}},n.prototype.getModuleName=function(){return"ErrorBar"},n.prototype.destroy=function(){},n}(),sb=(us=function(n,t){return(us=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}us(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),dv=function(n){function t(t){var i=n.call(this,t)||this;return i.library=i,i.addEventListener(),i}return sb(t,n),t.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(sf.base.Browser.touchMoveEvent,this.mouseMove,this),this.chart.on("click",this.click,this),this.chart.on(sf.base.Browser.touchEndEvent,this.mouseEnd,this))},t.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(sf.base.Browser.touchMoveEvent,this.mouseMove),this.chart.off("click",this.click),this.chart.off(sf.base.Browser.touchEndEvent,this.mouseEnd))},t.prototype.mouseMove=function(n){this.chart.legendSettings.visible&&!this.chart.isTouch&&(this.move(n),this.chart.highlightModule&&"None"!==this.chart.highlightMode&&this.click(n))},t.prototype.mouseEnd=function(n){this.chart.legendSettings.visible&&this.chart.isTouch&&this.move(n)},t.prototype.getLegendOptions=function(n,t){var u,r,h,e,c,i,o,v,f,y,s,p,w,k,d;for(this.legendCollections=[],h=[],n.length>1&&(this.legend.mode="Series"),e=0,c=n;e<c.length;e++)if(i=c[e],"Series"===this.legend.mode)"Indicator"!==i.category&&(u="PolarRadar"===t.chartAreaType?i.drawType:i.type,r=i.pointColorMapping&&i.points.length>0&&i.points[0].interior?i.points[0].interior:i.interior,this.legendCollections.push(new ar(i.name,r,i.legendShape,"TrendLine"===i.category?this.chart.series[i.sourceIndex].trendlines[i.index].visible:i.visible,u,i.legendImageUrl,i.marker.shape,i.marker.visible)));else if("Point"===this.legend.mode)for(var g=function(n){u="PolarRadar"===t.chartAreaType?i.drawType:i.type;r=n.interior?n.interior:i.interior;0===l.legendCollections.filter(function(t){return t.text===n.x.toString()}).length&&l.legendCollections.push(new ar(n.x.toString(),r,i.legendShape,"TrendLine"===i.category?l.chart.series[i.sourceIndex].trendlines[i.index].visible:n.visible,u,"",i.marker.shape,i.marker.visible))},l=this,a=0,b=i.points;a<b.length;a++)g(f=b[a]);else if("Range"===this.legend.mode){for(o=0,v=i.points;o<v.length;o++)if(f=v[o],u="PolarRadar"===t.chartAreaType?i.drawType:i.type,r=f.interior?f.interior:i.interior,y="Others",h.indexOf(r)<0&&(h.push(r),t.rangeColorSettings.length>=1&&1===t.rangeColorSettings[0].colors.length)){for(s=0,p=t.rangeColorSettings;s<p.length;s++)w=p[s],w.colors[0]===r&&(y=w.label);this.legendCollections.push(new ar(y,r,i.legendShape,"TrendLine"===i.category?this.chart.series[i.sourceIndex].trendlines[i.index].visible:f.visible,u,"",i.marker.shape,i.marker.visible))}}else 0===this.legendCollections.length&&t.rangeColorSettings.length>0&&(k=t.rangeColorSettings[0].start.toString(),d=t.rangeColorSettings[t.rangeColorSettings.length-1].end.toString(),this.legendCollections.push(new ar(k,i.interior,"Rectangle",!0,u,"",i.marker.shape,i.marker.visible)),this.legendCollections.push(new ar(d,i.interior,"Rectangle",!0,u,"",i.marker.shape,i.marker.visible)))},t.prototype.getLegendBounds=function(n,t,i){var r;this.calculateLegendTitle(i,t);this.isTitle=!!i.title;var u=i.padding,s=i.titlePosition,p=0,w=0,d=this.arrowWidth,g=this.arrowHeight,nt=this.isVertical&&!i.enablePages?g:0,h=this.isTitle&&"Top"===s?this.legendTitleSize.height+this.fivePixel:0;h=this.isTitle&&this.isVertical&&"Top"!==s?this.legendTitleSize.height+this.fivePixel:h;this.isVertical?w=i.width?0:n.width/20:p=i.height?0:n.height/20;t.height+=p;t.width+=w;var f,tt=i.shapeWidth,it=i.shapePadding,v=0,e=0,c=0,o=0,l=0,a=0;this.maxItemHeight=Math.max(sf.svgbase.measureText("MeasureText",i.textStyle).height,i.shapeHeight);for(var b=!1,y=0,k=this.legendCollections;y<k.length;y++)r=k[y],pr.test(r.text)&&(r.text=lf(r.text,pr)),sh.test(r.text)&&(r.text=lf(r.text,sh)),f={fill:r.fill,text:r.text,shape:r.shape,markerShape:r.markerShape,name:"legendRender",cancel:!1},this.chart.trigger("legendRender",f),r.render=!f.cancel,r.text=f.text,r.fill=f.fill,r.shape=f.shape,r.markerShape=f.markerShape,r.textSize=sf.svgbase.measureText(r.text,i.textStyle),r.render&&(b=!0,e+=c=tt+it+r.textSize.width+u,i.enablePages||this.isVertical||(a=this.isTitle&&"Top"!==s?this.legendTitleSize.width+this.fivePixel:0,a+=d),(t.width<u+e+a||this.isVertical)&&(v=Math.max(v,e+u+a-(this.isVertical?0:c)),0===l&&c!==e&&(l=1),e=this.isVertical?0:c,o=++l*(this.maxItemHeight+u)+u+h+nt));o=Math.max(o,this.maxItemHeight+u+u+h);this.isPaging=t.height<o;this.isPaging&&!i.enablePages&&(o=this.isVertical?o:this.maxItemHeight+u+u+("Top"===s?h:0));this.totalPages=l;this.isPaging||this.isVertical||(e+=this.isTitle&&"Top"!==s?this.fivePixel+this.legendTitleSize.width+this.fivePixel:0);b?this.setBounds(Math.max(e+u,v),o,i,t):this.setBounds(0,0,i,t)},t.prototype.getRenderPoint=function(n,t,i,r,u,f,e){var h=this.legend.padding,o=r.location.x+i+r.textSize.width,s;o+(n.textSize.width+i)>u.x+u.width+this.legend.shapeWidth/2||this.isVertical?(n.location.x=t.x,n.location.y=f===e?r.location.y:r.location.y+this.maxItemHeight+h):(n.location.x=f===e?r.location.x:o,n.location.y=r.location.y);s=this.legendBounds.x+this.legendBounds.width-(n.location.x+i-this.legend.shapeWidth/2);n.text=at(+s.toFixed(4),n.text,this.legend.textStyle)},t.prototype.LegendClick=function(n,t){var i=this.chart,v="Series"===i.legendSettings.mode?n:0,r=i.visibleSeries[v],f=this.legendCollections[n],e,u,s,l;if("Series"===i.legendSettings.mode)e={legendText:f.text,legendShape:f.shape,chart:i.isBlazor?{}:i,series:r,points:r.points,name:"legendClick",cancel:!1},this.chart.trigger("legendClick",e),r.legendShape=e.legendShape,null!==r.fill&&(i.visibleSeries[n].interior=r.fill),i.legendSettings.toggleVisibility?("TrendLine"===r.category?i.series[r.sourceIndex].trendlines[r.index].visible=i.series[r.sourceIndex].trendlines[r.index].visible?!1:!0:(r.chart.isProtectedOnChange=!0,this.changeSeriesVisiblity(r,r.visible)),f.visible="TrendLine"===r.category?i.series[r.sourceIndex].trendlines[r.index].visible:r.visible,this.refreshLegendToggle(i,r)):i.selectionModule?i.selectionModule.legendSelection(i,n,t):i.highlightModule&&i.highlightModule.legendSelection(i,n,t),r.chart.isProtectedOnChange=!1;else if("Point"===i.legendSettings.mode)u=r.points[n],e={legendText:f.text,legendShape:f.shape,chart:i.isBlazor?{}:i,series:r,points:[u],name:"legendClick",cancel:!1},(this.chart.trigger("legendClick",e),i.legendSettings.toggleVisibility)&&(u.visible=!u.visible,(o=this.legendCollections[n]).visible=u.visible,this.refreshLegendToggle(i,r));else if("Range"===i.legendSettings.mode){for(var h=[],o=this.legendCollections[n],c=0,a=r.points;c<a.length;c++)u=a[c],o.fill===(u.interior||r.interior)&&h.push(u);if(e={legendText:f.text,legendShape:f.shape,chart:i.isBlazor?{}:i,series:r,points:h,name:"legendClick",cancel:!1},this.chart.trigger("legendClick",e),i.legendSettings.toggleVisibility){for(o.visible=!o.visible,s=0,l=h;s<l.length;s++)(u=l[s]).visible=!u.visible;this.refreshLegendToggle(i,r)}}},t.prototype.refreshLegendToggle=function(n,t){var i=[];if(n.selectionModule&&(i=sf.base.extend([],n.selectionModule.selectedDataIndexes,null,!0)),n.svgObject.childNodes.length>0&&!n.enableAnimation&&!n.enableCanvas){for(;n.svgObject.lastChild;)n.svgObject.removeChild(n.svgObject.lastChild);sf.base.remove(n.svgObject)}n.animateSeries=!1;n.redraw=n.enableAnimation;n.rotatedDataLabelCollections=[];w(sf.svgbase.getElement(n.element.id+"_Secondary_Element").querySelectorAll(".ejSVGTooltip")[0]);af(n);this.redrawSeriesElements(t,n);n.removeSvg();n.refreshAxis();t.refreshAxisLabel();this.refreshSeries(n.visibleSeries);n.markerRender.removeHighlightedMarker();n.refreshBound();n.trigger("loaded",{chart:n});i.length>0&&(n.selectionModule.selectedDataIndexes=i,n.selectionModule.redrawSelection(n,n.selectionMode));n.highlightModule&&"None"!==n.highlightMode&&n.highlightModule.redrawSelection(n,n.highlightMode);n.redraw=!1},t.prototype.changeSeriesVisiblity=function(n,t){n.visible=!t;this.isSecondaryAxis(n.xAxis)&&(n.xAxis.internalVisibility=n.xAxis.series.some(function(n){return n.visible}));this.isSecondaryAxis(n.yAxis)&&(n.yAxis.internalVisibility=n.yAxis.series.some(function(n){return n.visible}))},t.prototype.isSecondaryAxis=function(n){return this.chart.axes.indexOf(n)>-1},t.prototype.redrawSeriesElements=function(n,t){if(!t.redraw)return null;w(t.element.id+"_Series_"+(void 0===n.index?n.category:n.index)+"_DataLabelCollections")},t.prototype.refreshSeries=function(n){for(var t=0,i=n;t<i.length;t++)i[t].position=void 0},t.prototype.click=function(n){var i=this,u;if(this.chart.legendSettings.visible){for(var f,e,o=this.chart.mouseX,s=this.chart.mouseY,t=n.target.id,r=0,h=[this.legendID+"_text_",this.legendID+"_shape_marker_",this.legendID+"_shape_"];r<h.length;r++)if(u=h[r],t.indexOf(u)>-1){e=parseInt(t.split(u)[1],10);this.LegendClick(e,n);break}t.indexOf(this.legendID+"_pageup")>-1?this.changePage(n,!0):t.indexOf(this.legendID+"_pagedown")>-1&&this.changePage(n,!1);this.chart.enableCanvas&&this.pagingRegions.length&&this.checkWithinBounds(o,s);(f=this.legendRegions.filter(function(n){return v(o,s+(i.isPaging?(i.currentPageNumber-1)*i.translatePage(null,1,2):0),n.rect)})).length&&this.chart.enableCanvas&&this.LegendClick(f[0].index,n)}},t.prototype.checkWithinBounds=function(n,t){var r=this.chart.renderer,u=this.legendBounds,f=this.chart.legendSettings.border.width,i=new sf.svgbase.Rect(u.x,u.y,u.width,u.height);return i.x=i.x-f/2,i.y=i.y-f/2,i.width=i.width+f,i.height=i.height+f,v(n,t,this.pagingRegions[0])?(--this.currentPageNumber>0?(this.legendRegions=[],r.clearRect(i),r.canvasClip(new y("legendClipPath","transparent",{width:0,color:""},null,i)),this.renderLegend(this.chart,this.legend,u),r.canvasRestore()):++this.currentPageNumber,null):v(n,t,this.pagingRegions[1])?(++this.currentPageNumber>0&&this.currentPageNumber<=this.totalNoOfPages?(this.legendRegions=[],r.clearRect(i),r.canvasClip(new y("legendClipPath","transpaent",{width:0,color:""},null,i)),this.renderLegend(this.chart,this.legend,u),r.canvasRestore()):--this.currentPageNumber,null):void 0},t.prototype.getModuleName=function(){return"Legend"},t.prototype.destroy=function(){this.removeEventListener()},t}(dy),hb=function(){function t(n){this.control=n}return t.prototype.render=function(n,t){return this.isChart="chart"===this.control.getModuleName(),this.annotation=n,tf(sf.base.createElement("div",{id:this.control.element.id+"_Annotation_"+t,styles:"position: absolute; z-index: 1"}),t,n.content,this.control)},t.prototype.setAnnotationPixelValue=function(n){var t="Chart"===this.annotation.region?new sf.svgbase.Rect(0,0,this.control.availableSize.width,this.control.availableSize.height):this.isChart?this.control.chartAxisLayoutPanel.seriesClipRect:this.control.series[0].accumulationBound;return n.x=("string"!=typeof this.annotation.x?"number"==typeof this.annotation.x?this.annotation.x:0:ri(this.annotation.x,t.width))+t.x,n.y=("number"==typeof this.annotation.y?this.annotation.y:ri(this.annotation.y,t.height))+t.y,!0},t.prototype.setAnnotationPointValue=function(t){var l=new s(0,0),f,y,p;if(this.isChart){for(var h=this.control,r=this.annotation,w=r.xAxisName,b=r.yAxisName,a=h.requireInvertedAxis,c=this.control.stockChart,i=void 0,u=void 0,o=void 0,v=0,k=h.axisCollections;v<k.length;v++)if(f=k[v],w===f.name||null==w&&"primaryXAxis"===f.name)if((i=f).valueType.indexOf("Category")>-1){if(y="DateTimeCategory"===i.valueType?r.x.getTime().toString():r.x,i.labels.indexOf(y)<0)return!1;o=i.labels.indexOf(y)}else"DateTime"===i.valueType?(p={skeleton:"full",type:"dateTime"},o="object"===n(this.annotation.x)||"object"===n(new Date(this.annotation.x))?Date.parse(h.intl.getDateParser(p)(h.intl.getDateFormat(p)(new Date(sf.data.DataUtil.parse.parseJson({val:r.x}).val)))):0):o=+r.x;else(b===f.name||null==b&&"primaryYAxis"===f.name)&&(u=f);return!!(i&&u&&ut("Logarithmic"===i.valueType?nt(o,i.logBase):o,i.visibleRange)&&ut("Logarithmic"===u.valueType?nt(+r.y,u.logBase):+r.y,u.visibleRange))&&(l=e(o,+r.y,i,u,a),t.x=l.x+(a?u.rect.x:i.rect.x),t.y=l.y+(a?i.rect.y:u.rect.y)+(c&&c.enablePeriodSelector?c.toolbarHeight+c.titleSize.height:0),!0)}return this.setAccumulationPointValue(t)},t.prototype.processAnnotation=function(n,t,i){var f=this.control,r=new s(0,0),u=this.render(n,t),e=function(){u.style.transform="translate(-50%, -50%)"};e.bind(r,this);this["setAnnotation"+n.coordinateUnits+"Value"](r)?this.setElementStyle(r,u,i):this.control.redraw&&w(u.id);sf.base.updateBlazorTemplate((this.control.element.id+"Annotation"+t).replace(/[^a-zA-Z0-9]/g,""),"ContentTemplate",f.stockChart?f.stockChart.annotations[t]:this.control.annotations[t],void 0,e)},t.prototype.setAccumulationPointValue=function(t){for(var r,i,u=0,f=this.control.visibleSeries[0].points;u<f.length;u++)if(i=f[u],"object"===n(i.x)){if(Date.parse(i.x)===Date.parse(this.annotation.x)&&i.y===this.annotation.y){r=i;break}}else if(i.x==this.annotation.x&&i.y==this.annotation.y){r=i;break}return!(!r||!r.visible)&&(t.x=r.symbolLocation.x,t.y=r.symbolLocation.y,!0)},t.prototype.setElementStyle=function(n,t,i){var u=rf(t,this.control.redraw),r={cancel:!1,name:"annotationRender",content:t,location:n};this.control.trigger("annotationRender",r);r.cancel||(r.content.style.left=this.setAlignmentValue(this.annotation.horizontalAlignment,u.width,r.location.x)+"px",r.content.style.top=this.setAlignmentValue(this.annotation.verticalAlignment,u.height,r.location.y)+"px",r.content.setAttribute("aria-label",this.annotation.description||"Annotation"),uf(r.content,i,this.control.redraw,!0,"left","top"))},t.prototype.setAlignmentValue=function(n,t,i){switch(n){case"Top":case"Near":i-=t;break;case"Bottom":case"Far":i+=0;break;case"Middle":case"Center":i-=t/2}return i},t}(),cb=(fs=function(n,t){return(fs=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}fs(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),gv=function(n){function t(t,i){var r=n.call(this,t)||this;return r.chart=t,r.annotations=i,r}return cb(t,n),t.prototype.renderAnnotations=function(n){var t=this;this.annotations=this.chart.annotations;this.parentElement=yt(this.chart.redraw,this.chart.element.id+"_Annotation_Collections")||sf.base.createElement("div",{id:this.chart.element.id+"_Annotation_Collections"});this.annotations.map(function(n,i){t.processAnnotation(n,i,t.parentElement)});uf(this.parentElement,n,this.chart.redraw)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"Annotation"},t}(hb),lb=(es=function(n,t){return(es=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}es(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ny=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return lb(t,n),t.prototype.render=function(n,t,i,r){for(var u,s,h,f=this.getSideBySideInfo(n),o=0,c=n.points;o<c.length;o++)u=c[o],u.symbolLocations=[],u.regions=[],s=void 0,u.visible&&b(n.points[u.index-1],u,n.points[u.index+1],n)&&(this.findBoxPlotValues(u.y,u,n.boxPlotMode),this.updateTipRegion(n,u,f),s=this.getRectangle(u.xValue+f.start,u.upperQuartile,u.xValue+f.end,u.lowerQuartile,n),u.regions.push(s),(h=this.triggerEvent(n,u,n.interior,{color:sf.base.isNullOrUndefined(n.border.color)||"transparent"===n.border.color?hf(n.interior,-.6):n.border.color,width:n.border.width?n.border.width:1})).cancel||this.renderBoxAndWhisker(n,u,h,this.getPathString(u,n,e(u.xValue,u.median,t,i,r),e(u.xValue+f.median,u.average,t,i,r)),f.median));n.marker.visible&&n.chart.markerRender.render(n)},t.prototype.updateTipRegion=function(n,t,i){var r=this.getRectangle(t.xValue+i.median,t.maximum,t.xValue+i.median,t.minimum,n);this.updateTipSize(n,t,r,n.chart.requireInvertedAxis)},t.prototype.updateTipSize=function(n,t,i,r){var u=n.border.width||1;r?(i.y-=u/2,i.height=i.height||u):(i.x-=u/2,i.width=i.width||u);t.regions.push(i)},t.prototype.getPathString=function(n,t,i,r){var f=n.regions[0],u=n.regions[1],e="",h=t.chart.requireInvertedAxis?f.y+f.height/2:f.x+f.width/2,o=u.x+u.width,s=u.y+u.height,c=f.x+f.width,l=f.y+f.height;return t.chart.requireInvertedAxis?(this.updateTipSize(t,n,{x:f.x,y:u.y,width:0,height:s-u.y},!1),this.updateTipSize(t,n,{x:c,y:u.y,width:0,height:s-u.y},!0),e+="M "+f.x+" "+u.y+" L "+f.x+" "+s,e+="M "+f.x+" "+h+"  L "+u.x+" "+h,e+=" M "+u.x+" "+u.y+"  L "+o+" "+u.y+" L "+o+" "+s+" L "+u.x+" "+s+" Z",e+=" M "+o+" "+h+" L "+c+" "+h,e+=" M "+c+" "+u.y+" L "+c+" "+s,e+=" M "+i.x+" "+u.y+"  L "+i.x+" "+s,e+=t.showMean?"M "+(r.x+5)+" "+(r.y-5)+" L "+(r.x-5)+" "+(r.y+5)+"M "+(r.x-5)+" "+(r.y-5)+" L "+(r.x+5)+" "+(r.y+5):""):(this.updateTipSize(t,n,{x:u.x,y:f.y,width:o-u.x,height:0},!0),this.updateTipSize(t,n,{x:u.x,y:l,width:o-u.x,height:0},!0),e+="M "+u.x+" "+f.y+"  L "+o+" "+f.y,e+=" M "+h+" "+f.y+"  L "+h+" "+u.y,e+=" M "+u.x+" "+u.y+"  L "+o+" "+u.y+" L "+o+" "+s+" L "+u.x+" "+s+" Z",e+=" M "+h+" "+s+" L "+h+" "+l,e+=" M "+u.x+" "+l+" L "+o+" "+l,e+=" M "+u.x+" "+i.y+" L "+o+" "+i.y,e+=t.showMean?" M "+(r.x-5)+" "+(r.y-5)+" L "+(r.x+5)+" "+(r.y+5)+" M "+(r.x+5)+" "+(r.y-5)+" L "+(r.x-5)+" "+(r.y+5):""),e},t.prototype.renderBoxAndWhisker=function(n,t,i,r,u){var o,f,c=n.chart.element.id+"_Series_"+n.index+"_Point_"+t.index,l=n.chart.renderer.drawPath(new sf.svgbase.PathOption(c+"_BoxPath",i.fill,i.border.width,i.border.color,n.opacity,n.dashArray,r)),h,s;for(l.setAttribute("aria-label",t.x.toString()+":"+t.maximum.toString()+":"+t.minimum.toString()+":"+t.lowerQuartile.toString()+":"+t.upperQuartile.toString()),h=n.chart.renderer.createGroup({id:c}),h.appendChild(l),s=0;s<t.outliers.length;s++)o=e(t.xValue+u,t.outliers[s],n.xAxis,n.yAxis,n.chart.requireInvertedAxis),f=new sf.svgbase.Size(n.marker.width,n.marker.height),t.symbolLocations.push(o),this.updateTipSize(n,t,{x:o.x-f.width/2,y:o.y-f.height/2,width:f.width,height:f.height},!0);n.seriesElement.appendChild(h)},t.prototype.findBoxPlotValues=function(n,t,i){var u=n.length,r={average:g(n)/u,lowerQuartile:0,upperQuartile:0,maximum:0,minimum:0,median:0,outliers:[]};"Exclusive"===i?(r.lowerQuartile=this.getExclusiveQuartileValue(n,u,.25),r.upperQuartile=this.getExclusiveQuartileValue(n,u,.75),r.median=this.getExclusiveQuartileValue(n,u,.5)):"Inclusive"===i?(r.lowerQuartile=this.getInclusiveQuartileValue(n,u,.25),r.upperQuartile=this.getInclusiveQuartileValue(n,u,.75),r.median=this.getInclusiveQuartileValue(n,u,.5)):(r.median=tu(n),this.getQuartileValues(n,u,r));this.getMinMaxOutlier(n,u,r);t.minimum=r.minimum;t.maximum=r.maximum;t.lowerQuartile=r.lowerQuartile;t.upperQuartile=r.upperQuartile;t.median=r.median;t.outliers=r.outliers;t.average=r.average},t.prototype.getExclusiveQuartileValue=function(n,t,i){if(0===t)return 0;if(1===t)return n[0];var u=i*(t+1),r=Math.floor(Math.abs(u)),f=u-r;return 0===r?n[0]:r>t-1?n[t-1]:f*(n[r]-n[r-1])+n[r-1]},t.prototype.getInclusiveQuartileValue=function(n,t,i){if(0===t)return 0;if(1===t)return n[0];var u=i*(t-1),r=Math.floor(Math.abs(u));return(u-r)*(n[r+1]-n[r])+n[r]},t.prototype.getQuartileValues=function(n,t,i){if(1===t)return i.lowerQuartile=n[0],i.upperQuartile=n[0],null;var u=t%2==0,r=t/2,f=n.slice(0,r),e=n.slice(u?r:r+1,t);i.lowerQuartile=tu(f);i.upperQuartile=tu(e)},t.prototype.getMinMaxOutlier=function(n,t,i){for(var u=1.5*(i.upperQuartile-i.lowerQuartile),r=0;r<t;r++){if(!(n[r]<i.lowerQuartile-u)){i.minimum=n[r];break}i.outliers.push(n[r])}for(r=t-1;r>=0;r--){if(!(n[r]>i.upperQuartile+u)){i.maximum=n[r];break}i.outliers.push(n[r])}},t.prototype.doAnimation=function(n){this.animate(n)},t.prototype.getModuleName=function(){return"BoxAndWhiskerSeries"},t.prototype.destroy=function(){},t}(wt),ab=(os=function(n,t){return(os=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}os(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ty=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ab(t,n),t.prototype.render=function(n,t,i,r){var f,v,o,a,h=this,c=null,u="",l=Math.max(n.yAxis.visibleRange.min,0),y=[],p=this.sortSegments(n,n.segments);n.visiblePoints.map(function(w,k,d){w.symbolLocations=[];w.regions=[];a=!1;w.visible&&b(d[k-1],w,d[k+1],n)&&(u+=h.getAreaPathDirection(w.xValue,l,n,r,e,c,"M"),c=c||new s(w.xValue,l),f=e(w.xValue,w.yValue,t,i,r),o&&h.setPointColor(w,o,n,"X"===n.segmentAxis,p)?(a=!0,v=e(c.x,l,t,i,r),u+="L "+f.x+" "+f.y+" ",u+="L "+f.x+" "+v.y+" ",h.generatePathOption(y,n,o,u,"_Point_"+o.index),u="M "+f.x+" "+v.y+" L "+f.x+" "+f.y+" "):(u+="L "+f.x+" "+f.y+" ",h.setPointColor(w,null,n,"X"===n.segmentAxis,p)),d[k+1]&&!d[k+1].visible&&"Drop"!==n.emptyPointSettings.mode&&(u+=h.getAreaEmptyDirection({x:w.xValue,y:l},c,n,r,e),c=null),o=w,h.storePointLocation(w,n,r,e))});sf.base.isNullOrUndefined(a)||a||(u=n.points.length>1?u+this.getAreaPathDirection(o.xValue,l,n,r,e,null,"L"):"",this.generatePathOption(y,n,o,u,""));this.applySegmentAxis(n,y,p);this.renderMarker(n)},t.prototype.generatePathOption=function(n,t,i,r,u){n.push(new sf.svgbase.PathOption(t.chart.element.id+"_Series_"+t.index+u,t.setPointColor(i,t.interior),t.border.width,t.border.color,t.opacity,t.dashArray,r))},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"MultiColoredAreaSeries"},t.prototype.doAnimation=function(n){this.doLinearAnimation(n,n.animation)},t}(eu),vb=(ss=function(n,t){return(ss=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ss(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),iy=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return vb(t,n),t.prototype.render=function(n,t,i,r){for(var u,f=null,o="M",s=this.enableComplexProperty(n),c=[],h="",l=this.sortSegments(n,n.segments),a=0,v=s;a<v.length;a++)u=v[a],u.regions=[],u.visible&&b(s[u.index-1],u,s[u.index+1],n)?(h+=this.getLineDirection(f,u,n,r,e,o),null!=f?this.setPointColor(u,f,n,"X"===n.segmentAxis,l)?(c.push(new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index+"_Point_"+f.index,"none",n.width,n.setPointColor(f,n.interior),n.opacity,n.dashArray,h)),o="M",h=""):o="L":this.setPointColor(u,null,n,"X"===n.segmentAxis,l),f=u,this.storePointLocation(u,n,r,e)):(f="Drop"===n.emptyPointSettings.mode?f:null,o="Drop"===n.emptyPointSettings.mode?o:"M",u.symbolLocations=[]);""!==h&&c.push(new sf.svgbase.PathOption(n.chart.element.id+"_Series_"+n.index,"none",n.width,n.setPointColor(s[s.length-1],n.interior),n.opacity,n.dashArray,h));this.applySegmentAxis(n,c,l);this.renderMarker(n)},t.prototype.doAnimation=function(n){this.doLinearAnimation(n,n.animation)},t.prototype.getModuleName=function(){return"MultiColoredLineSeries"},t.prototype.destroy=function(){},t}(eu),ry=function(){function n(n){this.xAxisPrevHeight=[];this.xAxisMultiLabelHeight=[];this.yAxisPrevHeight=[];this.yAxisMultiLabelHeight=[];this.multiLevelLabelRectXRegion=[];this.xLabelCollection=[];this.chart=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.chart.isDestroyed||this.chart.on("click",this.click,this)},n.prototype.getMultilevelLabelsHeight=function(n){var r,i,u,e=0,t=[],o=[],f="Vertical"===n.orientation,s=f?n.rect.height:n.rect.width;n.multiLevelLabels.map(function(h,c){h.categories.map(function(e){""!==e.text&&null!==e.start&&null!==e.end&&(r=sf.svgbase.measureText(e.text,h.textStyle),i=f?r.width:r.height,i+=2*h.border.width+("CurlyBrace"===h.border.type?10:0),u=null!==e.maximumTextWidth?e.maximumTextWidth:a("string"==typeof e.end?Number(new Date(e.end)):e.end,n)*s-a("string"==typeof e.start?Number(new Date(e.start)):e.start,n)*s,r.width>u-10&&u>0&&"Wrap"===h.overflow&&!f&&(i*=nr(e.text,u-10,h.textStyle).length),t[c]=t[c]?t[c]<i?i:t[c]:i)});o[c]=e;e+=t[c]?t[c]+10:0});n.multiLevelLabelHeight=e+(""!==n.title||this.chart.legendModule&&this.chart.legendSettings.visible?5:0);f?(this.yAxisMultiLabelHeight=t,this.yAxisPrevHeight=o):(this.xAxisMultiLabelHeight=t,this.xAxisPrevHeight=o)},n.prototype.renderXAxisMultiLevelLabels=function(n,t,i,r){var c,l,e,y,o,g,nt,p,d,w,f,u=this,v=(n.labelPosition===n.tickPosition?n.majorTickLines.height:0)+n.maxLabelSize.height+10,b="",s="Outside"===n.labelPosition,it=n.isInversed,h=n.opposedPosition,tt=n.scrollbarSettings.enable||s&&sf.base.isNullOrUndefined(n.crossesAt)?n.scrollBarHeight:0,rt=h&&!s||!h&&s?r.y+v-n.majorTickLines.width:r.y-v-n.multiLevelLabelHeight;this.createClipRect(r.x-n.majorTickLines.width,rt+tt,n.multiLevelLabelHeight+10,r.width+2*n.majorTickLines.width,this.chart.element.id+"_XAxis_Clippath_"+t,this.chart.element.id+"XAxisMultiLevelLabel"+t);n.multiLevelLabels.map(function(i,rt){y=0;u.labelElement=u.chart.renderer.createGroup({id:u.chart.element.id+t+"_MultiLevelLabel"+rt});i.categories.map(function(ut,ft){var et,ot;(b="",g="string"==typeof ut.start?Number(new Date(ut.start)):ut.start,nt="string"==typeof ut.end?Number(new Date(ut.end)):ut.end,(f=u.triggerMultiLabelRender(n,ut.text,n.multiLevelLabels[rt].textStyle,n.multiLevelLabels[rt].alignment,ut.customAttributes)).cancel)||(e=a(g,n)*r.width,o=a(nt,n)*r.width,o=it?[e,e=o][0]:o,p=sf.svgbase.measureText(f.text,f.textStyle),d=(null===ut.maximumTextWidth?o-e:ut.maximumTextWidth)-10,c=e+r.x+10,l=(h&&!s||!h&&s?v+r.y+p.height/2+10+u.xAxisPrevHeight[rt]:r.y-v+p.height/2-u.xAxisMultiLabelHeight[rt]-u.xAxisPrevHeight[rt])+tt,"Center"===f.alignment?(c+=(o-e-10)/2,w="middle"):"Far"===f.alignment?(c=c+(o-e-10)-i.border.width/2,w="end"):(w="start",c+=i.border.width/2),l="CurlyBrace"===i.border.type?!h&&s||h&&!s?l+10:l-5:l,et=new sf.svgbase.TextOption(u.chart.element.id+t+"_Axis_MultiLevelLabel_Level_"+rt+"_Text_"+ft,c,l,w,f.text),("None"!==i.overflow&&(et.text="Wrap"===i.overflow?nr(f.text,d,f.textStyle):at(d,f.text,f.textStyle),et.x=et.x-5),k(u.chart.renderer,et,f.textStyle,f.textStyle.color||u.chart.themeStyle.axisLabel,u.labelElement,!1,u.chart.redraw,!0,null,null,null,0,null,u.chart.enableCanvas),u.chart.enableCanvas)&&(ot=sf.svgbase.measureText(f.text,f.textStyle),u.multiLevelLabelRectXRegion.push(new sf.svgbase.Rect(et.x,et.y,ot.width,ot.height)),u.xLabelCollection.push(et)),i.border.width>0&&"WithoutBorder"!==i.border.type&&""!==(b=u.renderXAxisLabelBorder(rt,o-e-10,n,e,v,p,et,r,f.alignment,b,s,h,y))&&(u.createBorderElement(rt,t,n,b,y),y++),u.chart.enableCanvas||u.multiElements.appendChild(u.labelElement))})});this.chart.enableCanvas||i.appendChild(this.multiElements)},n.prototype.renderXAxisLabelBorder=function(n,t,i,r,u,f,e,o,s,h,c,l,a){var k,d,g,nt,w=10,it=i.multiLevelLabels[n],ut=it.categories[a].type,p=t+w,b=this.xAxisMultiLabelHeight[n]+w,rt="Outside"===i.labelPosition?i.scrollBarHeight:0,y=r+o.x,v=!l&&c||l&&!c?u+o.y+this.xAxisPrevHeight[n]+rt:o.y-u-this.xAxisPrevHeight[n]-rt,tt=ut||it.border.type;switch(tt){case"WithoutTopandBottomBorder":case"Rectangle":case"WithoutTopBorder":h+="M "+y+" "+v+" L "+y+" "+(v+(b=!l&&c||l&&!c?b:-b))+" M "+(y+p)+" "+v+" L "+(y+p)+" "+(v+b);h+="WithoutTopandBottomBorder"!==tt?" L "+y+" "+(v+b)+" ":" ";h+="Rectangle"===tt?"M "+y+" "+v+" L "+(y+p)+" "+v:" ";break;case"Brace":"Near"===s?(g=e.x,nt=e.x+f.width+2):"Center"===s?(g=e.x-f.width/2-2,nt=e.x+f.width/2+2):(g=e.x-f.width-2,nt=e.x);h+="M "+y+" "+v+" L "+y+" "+(v+(b=!l&&c||l&&!c?b:-b)/2)+" M "+y+" "+(v+b/2)+" L "+(g-2)+" "+(v+b/2)+" M "+nt+" "+(v+b/2)+" L "+(y+p)+" "+(v+b/2)+" M "+(y+p)+" "+(v+b/2)+" L "+(y+p)+" "+v;break;case"CurlyBrace":!l&&c||l&&!c?(w=10,k=15,d=5):(w=-10,k=-15,d=-5);h+="Center"===s?"M "+y+" "+v+" C "+y+" "+v+" "+(y+5)+" "+(v+w)+" "+(y+10)+" "+(v+w)+" L "+(y+p/2-5)+" "+(v+w)+" L "+(y+p/2)+" "+(v+k)+" L "+(y+p/2+5)+" "+(v+w)+" L "+(y+p-10)+" "+(v+w)+" C "+(y+p-10)+" "+(v+w)+" "+(y+p)+" "+(v+d)+" "+(y+p)+" "+v:"Near"===s?"M "+y+" "+v+" C "+y+" "+v+" "+(y+5)+" "+(v+w)+" "+(y+10)+" "+(v+w)+" L "+(y+15)+" "+(v+k)+" L "+(y+20)+" "+(v+w)+" L "+(y+p-10)+" "+(v+w)+" C "+(y+p-10)+" "+(v+w)+" "+(y+p)+" "+(v+d)+" "+(y+p)+" "+v:"M "+y+" "+v+" C "+y+" "+v+" "+(y+5)+" "+(v+w)+" "+(y+10)+" "+(v+w)+" L "+(y+p-20)+" "+(v+w)+" L "+(y+p-15)+" "+(v+k)+" L "+(y+p-10)+" "+(v+w)+" L "+(y+p-10)+" "+(v+w)+" C "+(y+p-10)+" "+(v+w)+" "+(y+p)+" "+(v+d)+" "+(y+p)+" "+v}return h},n.prototype.renderYAxisMultiLevelLabels=function(n,t,i,r){var y,e,c,l,v,f,w,g,nt,p,u=this,o="Outside"===n.labelPosition,s=(n.tickPosition===n.labelPosition?n.majorTickLines.height:0)+n.maxLabelSize.width+10,b="",it=n.isInversed,h=n.opposedPosition,d=o&&sf.base.isNullOrUndefined(n.crossesAt)?n.scrollBarHeight:0,tt;d*=h?1:-1;tt=h&&!o||!h&&o?r.x-n.multiLevelLabelHeight-s-10:r.x+s;this.createClipRect(tt+d,r.y-n.majorTickLines.width,r.height+2*n.majorTickLines.width,n.multiLevelLabelHeight+10,this.chart.element.id+"_YAxis_Clippath_"+t,this.chart.element.id+"YAxisMultiLevelLabel"+t);n.multiLevelLabels.map(function(i,tt){u.labelElement=u.chart.renderer.createGroup({id:u.chart.element.id+t+"_MultiLevelLabel"+tt});w=0;i.categories.map(function(rt,ut){if(b="",nt="string"==typeof rt.end?Number(new Date(rt.end)):rt.end,g="string"==typeof rt.start?Number(new Date(rt.start)):rt.start,l=a(g,n)*r.height,v=a(nt,n)*r.height,v=it?[l,l=v][0]:v,!(f=u.triggerMultiLabelRender(n,rt.text,i.textStyle,i.alignment,rt.customAttributes)).cancel){y=sf.svgbase.measureText(f.text,f.textStyle);p=v-l;e=r.x-s-u.yAxisPrevHeight[tt]-u.yAxisMultiLabelHeight[tt]/2-5;c=r.height+r.y-l-p/2;e=h?o?r.x+s+5+u.yAxisMultiLabelHeight[tt]/2+u.yAxisPrevHeight[tt]+d:r.x-s-u.yAxisMultiLabelHeight[tt]/2-u.yAxisPrevHeight[tt]-5:o?e+d:r.x+s+5+u.yAxisMultiLabelHeight[tt]/2+u.yAxisPrevHeight[tt];"Center"===f.alignment?c+=y.height/4:"Far"===f.alignment?c+=p/2-y.height/2:c=c-p/2+y.height;e="CurlyBrace"===i.border.type?!h&&o||h&&!o?e-10:e+10:e;var ft=new sf.svgbase.TextOption(u.chart.element.id+t+"_Axis_MultiLevelLabel_Level_"+tt+"_Text_"+ut,e,c,"middle",f.text);ft.text="Trim"===i.overflow?at(null===rt.maximumTextWidth?u.yAxisMultiLabelHeight[tt]:rt.maximumTextWidth,f.text,f.textStyle):ft.text;k(u.chart.renderer,ft,f.textStyle,f.textStyle.color||u.chart.themeStyle.axisLabel,u.labelElement,u.chart.redraw,!0,null,null,null,null,0,null,u.chart.enableCanvas);i.border.width>0&&"WithoutBorder"!==i.border.type&&""!==(b=u.renderYAxisLabelBorder(tt,p,n,v,s,l,y,ft,r,f.alignment,b,o,h,w))&&(u.createBorderElement(tt,t,n,b,w),w++);u.chart.enableCanvas||u.multiElements.appendChild(u.labelElement)}})});this.chart.enableCanvas||i.appendChild(this.multiElements)},n.prototype.renderYAxisLabelBorder=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){var d,g,w=r-f,b=10,tt=i.multiLevelLabels[n],it=tt.categories[v].type,p=s.y+s.height-r,rt=(l&&sf.base.isNullOrUndefined(i.crossesAt)?i.scrollBarHeight:0)*(a?1:-1);var k=this.yAxisMultiLabelHeight[n]+b,y=(!a&&l||a&&!l?s.x-u-this.yAxisPrevHeight[n]:s.x+u+this.yAxisPrevHeight[n])+rt,nt=it||tt.border.type;switch(nt){case"WithoutTopandBottomBorder":case"Rectangle":case"WithoutTopBorder":c+="M "+y+" "+p+" L "+(y+(k=!a&&l||a&&!l?-k:k))+" "+p+" M "+y+" "+(p+w)+" L "+(y+k)+" "+(p+w);c+="WithoutTopandBottomBorder"!==nt?" L "+(y+k)+" "+p+" ":" ";c+="Rectangle"===nt?"M "+y+" "+(p+w)+"L "+y+" "+p+" ":" ";break;case"Brace":c+="M "+y+" "+p+" L "+(y-(k=!a&&l||a&&!l?k:-k)/2)+" "+p+" L "+(y-k/2)+" "+(o.y-e.height/2-4)+" M "+(y-k/2)+" "+(o.y+e.height/4+2)+" L "+(y-k/2)+" "+(p+w)+" L "+y+" "+(p+w);break;case"CurlyBrace":!a&&l||a&&!l?(b=-10,d=-15,g=-5):(b=10,d=15,g=5);c+="Center"===h?"M "+y+" "+p+" C "+y+" "+p+" "+(y+b)+" "+p+" "+(y+b)+" "+(p+10)+" L "+(y+b)+" "+(p+(w-10)/2)+" L "+(y+d)+" "+(p+(w-10)/2+5)+" L "+(y+b)+" "+(p+(w-10)/2+10)+" L "+(y+b)+" "+(p+(w-10))+" C "+(y+b)+" "+(p+(w-10))+" "+(y+g)+" "+(p+w)+" "+y+" "+(p+w):"Far"===h?"M "+y+" "+p+" C "+y+" "+p+" "+(y+b)+" "+p+" "+(y+b)+" "+(p+10)+" L "+(y+b)+" "+(p+w-20)+"  L "+(y+d)+" "+(p+(w-15))+" L "+(y+b)+" "+(p+(w-10))+" L "+(y+b)+" "+(p+(w-10))+" C "+(y+b)+" "+(p+(w-10))+" "+(y+b)+" "+(p+w)+" "+y+" "+(p+w):"M "+y+" "+p+" C "+y+" "+p+" "+(y+b)+" "+p+" "+(y+b)+" "+(p+10)+" L "+(y+d)+" "+(p+15)+" L "+(y+b)+" "+(p+20)+" L "+(y+b)+" "+(p+(w-10))+" C "+(y+b)+" "+(p+(w-10))+" "+(y+g)+" "+(p+w)+" "+y+" "+(p+w)}return c},n.prototype.createClipRect=function(n,t,i,r,u,f){this.multiElements=this.chart.renderer.createGroup({id:f,"clip-path":"url(#"+u+")"});this.chart.enableCanvas||this.multiElements.appendChild(vt(this.chart.redraw,{id:u,x:n,y:t,width:r,height:i,fill:"white","stroke-width":1,stroke:"Gray"},this.chart.renderer))},n.prototype.createBorderElement=function(n,t,i,r,u){var e=r,f=this.chart.renderer.drawPath(new sf.svgbase.PathOption(this.chart.element.id+t+"_Axis_MultiLevelLabel_Rect_"+n+"_"+u,"Transparent",i.multiLevelLabels[n].border.width,i.multiLevelLabels[n].border.color||this.chart.themeStyle.axisLine,1,"",r));f.setAttribute("style","pointer-events: none");h(this.chart.enableCanvas,this.labelElement,f,this.chart.redraw,!0,"x","y",null,e)},n.prototype.triggerMultiLabelRender=function(n,t,i,r,u){var f={cancel:!1,name:"axisMultiLabelRender",axis:n,text:t,textStyle:i,alignment:r,customAttributes:u};return this.chart.trigger("axisMultiLabelRender",f),f},n.prototype.MultiLevelLabelClick=function(n,t){var u=parseInt(n.substr(0,1),10),i=parseInt(n.substr(7),10),f=this.chart.axisCollections[t],r=f.multiLevelLabels[u].categories,o=r[i].text,s=r[i].start,h=r[i].end,e={axis:f,level:u,text:o,customAttributes:r[i].customAttributes,start:s,end:h,name:"multiLevelLabelClick",cancel:!1};return this.chart.trigger("multiLevelLabelClick",e),e},n.prototype.click=function(n){var f,r,e,i=n.target.id,u="_Axis_MultiLevelLabel_Level_",t;if(this.chart.enableCanvas)for(t=0;t<this.multiLevelLabelRectXRegion.length;t++)v(n.x,n.y,this.multiLevelLabelRectXRegion[t],this.multiLevelLabelRectXRegion[t].width,this.multiLevelLabelRectXRegion[t].height)&&(i=this.xLabelCollection[t].id);i.indexOf(u)>-1&&(f=i.split(u)[1],r=i.split(u)[0],e=parseInt(r.charAt(r.length-1),10),this.MultiLevelLabelClick(f,e))},n.prototype.getModuleName=function(){return"MultiLevelLabel"},n.prototype.destroy=function(){},n}(),ds,yb=function(){function n(n){this.chartId=n.element.id+"_"}return n.prototype.renderElements=function(n,t){var r=t.createGroup({id:this.chartId+"scrollBar_"+n.axis.name,transform:"translate("+(n.isVertical&&n.axis.isInversed?n.height:n.axis.isInversed?n.width:"0")+","+(n.isVertical&&n.axis.isInversed?"0":n.axis.isInversed?n.height:n.isVertical?n.width:"0")+") rotate("+(n.isVertical&&n.axis.isInversed?"90":n.isVertical?"270":n.axis.isInversed?"180":"0")+")"}),u=t.createGroup({id:this.chartId+"scrollBar_backRect_"+n.axis.name}),i=t.createGroup({id:this.chartId+"scrollBar_thumb_"+n.axis.name,transform:"translate(0,0)"});return this.backRect(n,t,u),this.thumb(n,t,i),this.renderCircle(n,t,i),this.arrows(n,t,i),this.thumbGrip(n,t,i),r.appendChild(u),r.appendChild(i),r},n.prototype.backRect=function(n,t,i){var r=n.scrollbarThemeStyle,u=t.drawRectangle(new y(this.chartId+"scrollBarBackRect_"+n.axis.name,r.backRect,{width:1,color:r.backRect},1,new sf.svgbase.Rect(0,0,n.width,n.height),0,0));i.appendChild(u)},n.prototype.arrows=function(n,t,i){var u=n.scrollbarThemeStyle,r=new sf.svgbase.PathOption(this.chartId+"scrollBar_leftArrow_"+n.axis.name,u.arrow,1,u.arrow,1,"","");this.leftArrowEle=t.drawPath(r);r.id=this.chartId+"scrollBar_rightArrow_"+n.axis.name;this.rightArrowEle=t.drawPath(r);this.setArrowDirection(this.thumbRectX,this.thumbRectWidth,n.height);i.appendChild(this.leftArrowEle);i.appendChild(this.rightArrowEle)},n.prototype.setArrowDirection=function(n,t,i){var r="M "+(n-3)+" "+i/2+" L "+(n- -2)+" 11 L "+(n- -2)+" 5 Z",u="M "+(n+t+4-.5)+" "+i/2+" L "+(n+t+4-6)+" 11.5 L "+(n+t+4-6)+" 4.5 Z";this.leftArrowEle.setAttribute("d",r);this.rightArrowEle.setAttribute("d",u)},n.prototype.thumb=function(n,t,i){n.startX=this.thumbRectX;var r=n.scrollbarThemeStyle;this.slider=t.drawRectangle(new y(this.chartId+"scrollBarThumb_"+n.axis.name,r.thumb,{width:1,color:""},1,new sf.svgbase.Rect(this.thumbRectX,0,this.thumbRectWidth,n.height)));i.appendChild(this.slider)},n.prototype.renderCircle=function(n,t,i){var u=n.scrollbarThemeStyle,r=new si(this.chartId+"scrollBar_leftCircle_"+n.axis.name,u.circle,{width:1,color:u.circle},1,this.thumbRectX,n.height/2,8),f=t.createDefs(),e=t.createGroup({id:this.chartId+n.axis.name+"_thumb_shadow"});f.innerHTML='<filter x="-25.0%" y="-20.0%" width="150.0%" height="150.0%" filterUnits="objectBoundingBox"id="scrollbar_shadow"><feOffset dx="0" dy="1" in="SourceAlpha" result="shadowOffsetOuter1"><\/feOffset><feGaussianBlur stdDeviation="1.5" in="shadowOffsetOuter1" result="shadowBlurOuter1"><\/feGaussianBlur><feComposite in="shadowBlurOuter1" in2="SourceAlpha" operator="out" result="shadowBlurOuter1"><\/feComposite><feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.16 0" type="matrix" in="shadowBlurOuter1"><\/feColorMatrix><\/filter>';e.innerHTML='<use fill="black" fill-opacity="1" filter="url(#scrollbar_shadow)" xlink:href="#'+this.chartId+"scrollBar_leftCircle_"+n.axis.name+'"><\/use><use fill="black" fill-opacity="1" filter="url(#scrollbar_shadow)" xlink:href="#'+this.chartId+"scrollBar_rightCircle_"+n.axis.name+'"><\/use>';this.leftCircleEle=t.drawCircle(r);r.id=this.chartId+"scrollBar_rightCircle_"+n.axis.name;r.cx=this.thumbRectX+this.thumbRectWidth;this.rightCircleEle=t.drawCircle(r);i.appendChild(f);i.appendChild(this.leftCircleEle);i.appendChild(this.rightCircleEle);i.appendChild(e)},n.prototype.thumbGrip=function(n,t,i){var f=0,e=0,o=n.scrollbarThemeStyle,u=new si(this.chartId+"scrollBar_gripCircle0_"+n.axis.name,o.grip,{width:1,color:o.grip},1,0,0,1),r;for(this.gripCircle=t.createGroup({id:this.chartId+"scrollBar_gripCircle_"+n.axis.name,transform:"translate("+(this.thumbRectX+this.thumbRectWidth/2+5*(n.isVertical?1:-1))+","+(n.isVertical?"10":"5")+") rotate("+(n.isVertical?"180":"0")+")"}),r=1;r<=6;r++)u.id=this.chartId+"scrollBar_gripCircle"+r+"_"+n.axis.name,u.cx=f,u.cy=e,this.gripCircle.appendChild(t.drawCircle(u)),f=3===r?0:f+5,e=r>=3?5:0;i.appendChild(this.gripCircle)},n}(),uy=function(){function n(n,t){this.scrollRange={max:null,min:null,interval:null,delta:null};this.component=n;this.elements=[];this.scrollElements=new yb(n);this.axis=t;this.mouseMoveListener=this.scrollMouseMove.bind(this);this.mouseUpListener=this.scrollMouseUp.bind(this);this.animateDuration=500;this.isPointer=sf.base.Browser.isPointer;this.browserName=sf.base.Browser.info.name}return n.prototype.getMouseXY=function(n){var t,i,f,u;n.type.indexOf("touch")>-1?(t=(f=n).changedTouches[0].clientX,i=f.changedTouches[0].clientY):(t=n.clientX,i=n.clientY);u=r(this.component.element.id+"_scrollBar_svg"+this.axis.name).getBoundingClientRect();this.mouseX=t-Math.max(u.left,0);this.mouseY=i-Math.max(u.top,0)},n.prototype.wireEvents=function(n){sf.base.EventHandler.add(n,sf.base.Browser.touchStartEvent,this.scrollMouseDown,this);sf.base.EventHandler.add(n,sf.base.Browser.touchMoveEvent,this.scrollMouseMove,this);sf.base.EventHandler.add(n,sf.base.Browser.touchEndEvent,this.scrollMouseUp,this);sf.base.EventHandler.add(n,"mousewheel",this.scrollMouseWheel,this);window.addEventListener("mousemove",this.mouseMoveListener,!1);window.addEventListener("mouseup",this.mouseUpListener,!1)},n.prototype.unWireEvents=function(n){sf.base.EventHandler.remove(n,sf.base.Browser.touchStartEvent,this.scrollMouseDown);sf.base.EventHandler.remove(n,sf.base.Browser.touchMoveEvent,this.scrollMouseMove);sf.base.EventHandler.remove(n,sf.base.Browser.touchEndEvent,this.scrollMouseUp);sf.base.EventHandler.remove(n,"mousewheel",this.scrollMouseWheel);window.removeEventListener("mousemove",this.mouseMoveListener,!1);window.removeEventListener("mouseup",this.mouseUpListener,!1)},n.prototype.scrollMouseDown=function(n){var i=n.target.id,t=this.scrollElements,r,f,u;(this.getMouseXY(n),this.isResizeLeft=this.isExist(i,"_leftCircle_")||this.isExist(i,"_leftArrow_"),this.isResizeRight=this.isExist(i,"_rightCircle_")||this.isExist(i,"_rightArrow_"),this.previousXY=this.isVertical&&this.axis.isInversed?this.mouseY:this.isVertical?this.width-this.mouseY:this.axis.isInversed?this.width-this.mouseX:this.mouseX,this.previousWidth=t.thumbRectWidth,this.previousRectX=t.thumbRectX,this.startZoomPosition=this.axis.zoomPosition,this.startZoomFactor=this.axis.zoomFactor,this.startRange=this.axis.visibleRange,this.scrollStarted=!0,this.component.trigger("scrollStart",this.getArgs("scrollStart")),this.isExist(i,"scrollBarThumb_")||this.isExist(i,"gripCircle"))?(this.isThumbDrag=!0,this.svgObject.style.cursor="-webkit-grabbing"):this.isExist(i,"scrollBarBackRect_")&&(r=this.moveLength(this.previousXY,this.previousRectX),(t.thumbRectX=this.isWithIn(r)?r:t.thumbRectX,this.positionThumb(t.thumbRectX,t.thumbRectWidth),this.setZoomFactorPosition(t.thumbRectX,t.thumbRectWidth,!1),this.isLazyLoad)&&(f=t.thumbRectX>this.previousRectX?"RightMove":"LeftMove",u=this.calculateLazyRange(t.thumbRectX,t.thumbRectWidth,f),u&&this.component.trigger("scrollEnd",u)));""===this.component.element.style.height&&(this.isCustomHeight=!0,this.component.element.style.height=this.component.availableSize.height+"px")},n.prototype.isExist=function(n,t){return n.indexOf(t)>-1},n.prototype.isWithIn=function(n){return n-8>=0&&n+this.scrollElements.thumbRectWidth+8<=this.width},n.prototype.moveLength=function(n,t,i){void 0===i&&(i=8);var r=.1*(this.width-2*i);return n<t?t-(t-r>i?r:i):t+(t+this.scrollElements.thumbRectWidth+r<this.width-i?r:i)},n.prototype.setZoomFactorPosition=function(n,t,i){void 0===i&&(i=!0);this.isScrollUI=!0;var r=this.axis,u=n+t+8+1;this.zoomPosition=(n-(n-8.5<=0?8.5:0))/(this.isVertical?r.rect.height:this.width);this.zoomFactor=(t+(u>=this.width?9:0))/(this.isVertical?r.rect.height:this.width);r.zoomPosition=this.zoomPosition<0?0:this.zoomPosition>.9?1:this.zoomPosition;r.zoomFactor=i?this.zoomFactor:r.zoomFactor},n.prototype.scrollMouseMove=function(n){var f=n.target,t=this.scrollElements,o,u;if(!r(this.svgObject.id))return null;this.getMouseXY(n);this.setCursor(f);this.setTheme(f);var e,i=this.isVertical&&this.axis.isInversed?this.width-this.mouseY:this.isVertical?this.mouseY:this.mouseX,s=this.axis.visibleRange,h=this.zoomPosition,c=this.zoomFactor,l=this.previousRectX-t.thumbRectX<0?"RightMove":"LeftMove";this.isLazyLoad&&(this.isThumbDrag||this.isResizeLeft||this.isResizeRight)&&(e=this.calculateLazyRange(t.thumbRectX,t.thumbRectWidth,l));o=e?e.currentRange:null;this.isThumbDrag?(this.component.isScrolling=this.isThumbDrag,i=this.isVertical||this.axis.isInversed?this.width-i:i,u=t.thumbRectX+(i-this.previousXY),i>=u+t.thumbRectWidth?this.setCursor(f):this.svgObject.style.cursor="-webkit-grabbing",i>=0&&i<=u+t.thumbRectWidth&&(t.thumbRectX=this.isWithIn(u)?u:t.thumbRectX,this.positionThumb(t.thumbRectX,t.thumbRectWidth),this.previousXY=i,this.setZoomFactorPosition(u,t.thumbRectWidth,!1)),this.component.trigger("scrollChanged",this.getArgs("scrollChanged",s,h,c,o))):(this.isResizeLeft||this.isResizeRight)&&(this.resizeThumb(),this.component.trigger("scrollChanged",this.getArgs("scrollChanged",s,h,c,o)))},n.prototype.scrollMouseWheel=function(n){var o=r(this.component.element.id+"_scrollBar_svg"+this.axis.name).getBoundingClientRect();this.mouseX=n.clientX-Math.max(o.left,0);this.mouseY=n.clientY-Math.max(o.top,0);var u,f=.5,t=this.scrollElements,i=this.axis,s="mozilla"!==this.browserName||this.isPointer?n.wheelDelta/120>0?1:-1:-n.detail/3>0?1:-1,e=Math.max(Math.max(1/dt(i.zoomFactor,0,1),1)+.25*s,1),h=this.axis.visibleRange,c=this.zoomPosition,l=this.zoomFactor;e>=1&&(f=(f="Horizontal"===i.orientation?this.mouseX/i.rect.width:1-this.mouseY/i.rect.height)>1?1:f<0?0:f,this.zoomFactor=1===e?1:dt(1/e,0,1),this.zoomPosition=1===e?0:i.zoomPosition+(i.zoomFactor-this.zoomFactor)*f);t.thumbRectX=this.isWithIn(this.zoomPosition*this.width)?this.zoomPosition*this.width:t.thumbRectX;this.isScrollUI=!0;this.positionThumb(t.thumbRectX,t.thumbRectWidth);this.isLazyLoad&&this.setZoomFactorPosition(t.thumbRectX,t.thumbRectWidth);i.zoomFactor=this.zoomFactor;i.zoomPosition=this.zoomPosition;this.isLazyLoad&&(u=this.calculateMouseWheelRange(t.thumbRectX,t.thumbRectWidth))&&u.currentRange.minimum!==u.previousAxisRange.minimum&&u.currentRange.maximum!==u.previousAxisRange.maximum&&(this.component.trigger("scrollEnd",u),this.isScrollEnd=!1);this.isLazyLoad||this.component.trigger("scrollChanged",this.getArgs("scrollChanged",h,c,l))},n.prototype.scrollMouseUp=function(){var t,r,n,i;this.startX=this.scrollElements.thumbRectX;r=this.startX+this.scrollElements.thumbRectWidth+8+1;(!this.isResizeLeft&&!this.isResizeRight||this.isLazyLoad||(this.axis.zoomFactor=r>=this.width-1&&this.startX-8.5<=0?1:this.zoomFactor),this.isLazyLoad)&&(n=this.previousRectX-this.startX,(n>0||n<0)&&this.isThumbDrag&&(i=n<0?"RightMove":"LeftMove",this.startX="RightMove"===i?this.startX+Math.abs(n)<this.width-8?this.startX:this.width-8-this.scrollElements.thumbRectWidth:this.startX+this.scrollElements.thumbRectWidth-Math.abs(n)>8?this.startX:8,(t=this.calculateLazyRange(this.startX,this.scrollElements.thumbRectWidth,i))&&(this.component.trigger("scrollEnd",t),this.scrollStarted=!1)),(this.isResizeLeft||this.isResizeRight)&&(t=this.calculateLazyRange(this.startX,this.scrollElements.thumbRectWidth))&&(this.component.trigger("scrollEnd",t),this.scrollStarted=!1));this.isThumbDrag=!1;this.isResizeLeft=!1;this.isResizeRight=!1;this.isScrollEnd=!1;this.component.isScrolling=!1;this.scrollStarted&&!this.isLazyLoad&&(this.component.trigger("scrollEnd",this.getArgs("scrollChanged",this.startRange,this.startZoomPosition,this.startZoomFactor)),this.scrollStarted=!1);this.isCustomHeight&&(this.component.element.style.height=null)},n.prototype.calculateMouseWheelRange=function(n,t){var f,e,o,i=this.scrollRange,s=this.getStartEnd(this.previousStart,this.previousEnd,!1),r,u;return n+t+8<=this.width&&(e=(n-8)/this.width,f=t/this.width),r=i.min+e*i.delta,u=r+f*i.delta,u&&(o={axis:this.axis,currentRange:this.getStartEnd(r,u,!0),previousAxisRange:s}),o},n.prototype.calculateLazyRange=function(n,t,i){var f,e,u,o,h,s=t,r=this.scrollRange,c=this.getStartEnd(this.previousStart,this.previousEnd,!1);return this.isResizeRight||"RightMove"===i?(f=((s=this.isResizeRight?s+16:s)+8)/this.width,e="RightMove"===i?(n+8)/this.width:this.axis.zoomPosition,o=(u="RightMove"===i?r.min+e*r.delta:this.previousStart)+f*r.delta):this.isResizeLeft||"LeftMove"===i?(e=(n-8)/this.width,f=s/this.width,u=(u=r.min+e*r.delta)>=r.min?u:r.min,o="LeftMove"===i?u+f*r.delta:this.previousEnd):this.isThumbDrag&&(e="RightMove"===i?(n+8)/this.width:(n-8)/this.width,f=this.scrollElements.thumbRectWidth/this.width,o=(u=(u=r.min+e*r.delta)>=r.min?u:r.min)+f*r.delta),o&&(h={axis:this.component.isBlazor?{}:this.axis,currentRange:this.getStartEnd(u,o,!0),previousAxisRange:c}),h},n.prototype.getStartEnd=function(n,t,i){var r=this.valueType;switch("DateTime"!==r&&"DateTimeCategory"!==r||!i?i&&(this.previousStart=Math.round(n),this.previousEnd=Math.ceil(t)):(this.previousStart=n,this.previousEnd=t),r){case"Double":case"Category":case"Logarithmic":n=Math.round(n);t=Math.ceil(t);break;case"DateTime":case"DateTimeCategory":n=new Date(n);t=new Date(t)}return{minimum:n,maximum:t}},n.prototype.render=function(n){return(this.component.zoomModule||n&&this.axis.scrollbarSettings.enable)&&this.getDefaults(),this.getTheme(),this.removeScrollSvg(),function(n,t){for(var r,o,i,s,h=n.axis.rect,c="Horizontal"===n.axis.orientation,u=!1,f=0,e=0,l=n.axis.series;e<l.length;e++)(i=l[e]).marker.visible&&i.marker.height>f&&(f=i.marker.height);for(r=0,o=n.axis.series;r<o.length;r++)if((i=o[r]).visible&&(s=i.yMin.toString(),u=i.yData.some(function(n){return n===s})),u)break;n.svgObject=t.createSvg({id:n.component.element.id+"_scrollBar_svg"+n.axis.name,width:n.isVertical?n.height:n.width,height:n.isVertical?n.width:n.height,style:"position: absolute;top: "+((n.axis.opposedPosition&&c?-16:u?f:0)+h.y)+"px;left: "+((n.axis.opposedPosition&&!c?16:0)+h.x-(n.isVertical?n.height:0))+"px;cursor:auto;"});n.elements.push(n.svgObject)}(this,this.component.svgRenderer),this.wireEvents(this.svgObject),this.svgObject.appendChild(this.scrollElements.renderElements(this,this.component.svgRenderer)),this.svgObject},n.prototype.getTheme=function(){this.scrollbarThemeStyle=function(n){var t;switch(n){case"HighContrastLight":t={backRect:"#333",thumb:"#bfbfbf",circle:"#fff",circleHover:"#685708",arrow:"#333",grip:"#333",arrowHover:"#fff",backRectBorder:"#969696"};break;case"Bootstrap":t={backRect:"#f5f5f5",thumb:"#e6e6e6",circle:"#fff",circleHover:"#eee",arrow:"#8c8c8c",grip:"#8c8c8c"};break;case"Fabric":t={backRect:"#f8f8f8",thumb:"#eaeaea",circle:"#fff",circleHover:"#eaeaea",arrow:"#a6a6a6",grip:"#a6a6a6"};break;default:t={backRect:"#f5f5f5",thumb:"#e0e0e0",circle:"#fff",circleHover:"#eee",arrow:"#9e9e9e",grip:"#9e9e9e"}}return t}(this.component.theme)},n.prototype.removeScrollSvg=function(){document.getElementById(this.component.element.id+"_scrollBar_svg"+this.axis.name)&&sf.base.remove(document.getElementById(this.component.element.id+"_scrollBar_svg"+this.axis.name))},n.prototype.setCursor=function(n){var t=n.id;this.svgObject.style.cursor=t.indexOf("scrollBarThumb_")>-1||t.indexOf("_gripCircle")>-1?"-webkit-grab":t.indexOf("Circle_")>-1||t.indexOf("Arrow_")>-1?this.isVertical?"ns-resize":"ew-resize":"auto"},n.prototype.setTheme=function(n){var f=n.id,r=f.indexOf("_leftCircle_")>-1||f.indexOf("_leftArrow_")>-1,u=f.indexOf("_rightCircle_")>-1||f.indexOf("_rightArrow_")>-1,t=this.scrollbarThemeStyle,e=this.scrollElements.leftArrowEle,h=this.scrollElements.rightArrowEle,o=this.scrollElements.leftCircleEle,s=this.scrollElements.rightCircleEle,i=this.isCurrentAxis(n,e);o.style.fill=r&&i?t.circleHover:t.circle;s.style.fill=u&&i?t.circleHover:t.circle;o.style.stroke=r&&i?t.circleHover:t.circle;s.style.stroke=u&&i?t.circleHover:t.circle;"HighContrastLight"===this.component.theme&&(e.style.fill=r&&i?t.arrowHover:t.arrow,e.style.stroke=r&&i?t.arrowHover:t.arrow,h.style.fill=u&&i?t.arrowHover:t.arrow,h.style.stroke=u&&i?t.arrowHover:t.arrow,o.style.stroke=r&&i?t.circleHover:t.circle,s.style.stroke=u&&i?t.circleHover:t.circle)},n.prototype.isCurrentAxis=function(n,t){return n.id.split("_")[2]===t.id.split("_")[2]},n.prototype.resizeThumb=function(){var n,u=this.previousRectX,t=this.isVertical&&this.axis.isInversed?this.mouseY:this.isVertical?this.width-this.mouseY:this.axis.isInversed?this.width-this.mouseX:this.mouseX,r=Math.abs(this.previousXY-t),i;this.isResizeLeft&&t>=0?(i=u+(t>this.previousXY?r:-r),n=i-8>=0?this.previousWidth+(t>this.previousXY?-r:r):this.previousWidth,i=i-8>=0?i:u,n>=40&&t<i+n&&(this.scrollElements.thumbRectX=this.previousRectX=i,this.scrollElements.thumbRectWidth=this.previousWidth=n,this.previousXY=t,this.positionThumb(i,n),this.setZoomFactorPosition(i,n))):this.isResizeRight&&(n=t>=40+this.scrollElements.thumbRectX&&t<=this.width-8?t-this.scrollElements.thumbRectX:this.previousWidth,this.scrollElements.thumbRectWidth=this.previousWidth=n,this.previousXY=t,this.positionThumb(this.startX,n),this.setZoomFactorPosition(this.startX,n),this.isLazyLoad||this.setZoomFactorPosition(this.startX,n))},n.prototype.positionThumb=function(n,t){var i=this.scrollElements;i.slider.setAttribute("x",n.toString());i.slider.setAttribute("width",t.toString());i.leftCircleEle.setAttribute("cx",n.toString());i.rightCircleEle.setAttribute("cx",(n+t).toString());i.setArrowDirection(n,t,this.height);i.gripCircle.setAttribute("transform","translate("+(n+t/2+5*(this.isVertical?1:-1))+","+(this.isVertical?"10":"5")+") rotate("+(this.isVertical?"180":"0")+")")},n.prototype.getDefaults=function(){var n=this.axis,t,i,r;this.axis.scrollbarSettings.enable&&(this.isLazyLoad=!0,this.getLazyDefaults(n));this.isVertical="Vertical"===n.orientation;this.zoomFactor=this.isLazyLoad?this.zoomFactor:n.zoomFactor;this.zoomPosition=this.isLazyLoad?this.zoomPosition:n.zoomPosition;t=this.zoomFactor*(this.isVertical?n.rect.height:n.rect.width);t=t>40?t:40;this.scrollX=n.rect.x;this.scrollY=n.rect.y;this.width=this.isVertical?n.rect.height:n.rect.width;this.height=16;i=this.zoomPosition*(this.isVertical?n.rect.height:this.width);r=this.width-48;this.scrollElements.thumbRectX=i>r?r:i<8?8:i;this.scrollElements.thumbRectWidth=t+this.scrollElements.thumbRectX<this.width-16?t:this.width-this.scrollElements.thumbRectX-8},n.prototype.getLazyDefaults=function(n){var r,u,f=n.valueType,e=n.scrollbarSettings,t=n.scrollbarSettings.range,i=n.visibleRange,o=n.scrollbarSettings.pointsLength,l,a;this.valueType=f=e.range.minimum&&e.range.maximum||!e.pointsLength?f:"Double";var s={skeleton:"full",type:"dateTime"},h=this.component.intl.getDateParser(s),c=this.component.intl.getDateFormat(s);switch(f){case"Double":case"Category":case"Logarithmic":r=t.minimum?t.minimum:o?0:i.min;u=t.maximum?t.maximum:o?o-1:i.max;break;case"DateTime":case"DateTimeCategory":r=t.minimum?Date.parse(h(c(t.minimum))):i.min;u=t.maximum?Date.parse(h(c(t.maximum))):i.max}r=Math.min(r,i.min);u=Math.max(u,i.max);l=(i.max-i.min)/(u-r);a=(i.min-r)/(u-r);this.zoomFactor=t.minimum||t.maximum?l:this.axis.maxPointLength/n.scrollbarSettings.pointsLength;this.zoomPosition=t.minimum||t.maximum?a:n.zoomPosition;this.scrollRange.min=r;this.scrollRange.max=u;this.scrollRange.delta=u-r;this.previousStart=i.min;this.previousEnd=i.max},n.prototype.getLogRange=function(n){var i=n.scrollbarSettings.range,t=nt(i.minimum,n.logBase),r=nt(i.maximum,n.logBase);return t=isFinite(t)?t:i.minimum,r=isFinite(t)?r:i.maximum,{minimum:Math.floor(t/1),maximum:Math.ceil(r/1)}},n.prototype.injectTo=function(t,i){t.zoomingScrollBar=new n(i,t)},n.prototype.destroy=function(){var n=this;this.axes?this.axes.map(function(n){n.zoomingScrollBar.destroy()}):(this.elements.map(function(t){n.unWireEvents(t);sf.base.remove(t.firstChild)}),this.elements=[])},n.prototype.getModuleName=function(){return"ScrollBar"},n.prototype.getArgs=function(n,t,i,r,u){return{axis:this.component.isBlazor?{}:this.axis,name:n,range:this.axis.visibleRange,zoomFactor:this.axis.zoomFactor,zoomPosition:this.axis.zoomPosition,previousRange:t,previousZoomFactor:r,previousZoomPosition:i,currentRange:u}},n}(),pb=(ds=function(n,t){return(ds=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ds(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),fy=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.paretoAxes=[],t}return pb(t,n),t.prototype.initSeries=function(n,t){var i=new l(t,"series",n.properties,!0);i.name="Pareto";i.yAxisName=n.yAxisName+"_CumulativeAxis";i.category="Pareto";n.category="Pareto";i.type="Line";i.interior=t.themeStyle.errorBar;t.visibleSeries.push(i);this.initAxis(n,i,t)},t.prototype.initAxis=function(n,t,i){if(!this.paretoAxes.some(function(n){return n.name===t.yAxisName})){var r=n.yAxisName?i.axes.filter(function(t){return t.name===n.yAxisName})[0]:i.primaryYAxis,u=new wi(i,"axis",{name:t.yAxisName,majorGridLines:{width:0},majorTickLines:r.majorTickLines,lineStyle:r.lineStyle,minimum:0,maximum:100,rowIndex:r.rowIndex,opposedPosition:!0,labelFormat:"{value}%"});this.paretoAxes.push(u)}},t.prototype.render=function(n){n.chart.columnSeriesModule.render(n)},t.prototype.performCumulativeCalculation=function(n,t){for(var r=n,u=0,f=0,e=r.length,i=0;i<e;i++)u+=r[i][t.yName];for(i=0;i<e;i++)f+=r[i][t.yName],r[i][t.yName]=Math.round(f/u*100);return r},t.prototype.doAnimation=function(n){this.animate(n)},t.prototype.getModuleName=function(){return"ParetoSeries"},t.prototype.destroy=function(){},t}(wt),ey=function(){function n(n){this.chart=n}return n.prototype.export=function(n,t,i,r,u,f,e,o,s){var c=new as(this.chart),h;r=r||[this.chart];h={cancel:!1,name:"beforeExport",width:u,height:f};this.chart.trigger("beforeExport",h);h.cancel||c.export(n,t,i,r,u=h.width,f=h.height,e,o,s)},n.prototype.getDataUrl=function(n){return new as(n).getDataUrl(n)},n.prototype.getModuleName=function(){return"Export"},n.prototype.destroy=function(){},n}();return pl.Inject(gl,la,ps,da,nv,dl,na,uy,ea,oa,fa,ca,sa,ha,ta,ra,aa,ka,vv,av,ys,wl,bl,dv,yv,bv,ks,gv,ya,pa,va,wa,ba,ua,ws,ia,tv,rv,iv,uv,cv,fv,ov,ev,sv,hv,ny,ga,kv,lv,kl,iy,ty,ry,fy,ey,pv,wv),t.RangeColorSetting=al,t.CrosshairSettings=vl,t.ZoomSettings=yl,t.Chart=pl,t.Row=ph,t.Column=wh,t.MajorGridLines=bh,t.MinorGridLines=kh,t.AxisLine=dh,t.MajorTickLines=gh,t.MinorTickLines=nc,t.CrosshairTooltip=tc,t.Axis=wi,t.VisibleLabels=ic,t.Double=yr,t.DateTime=wl,t.Category=ys,t.Logarithmic=bl,t.DateTimeCategory=kl,t.NiceInterval=vs,t.StripLine=dl,t.Connector=pi,t.Font=lt,t.Border=ot,t.Offset=gs,t.ChartArea=nh,t.Margin=vr,t.ContainerPadding=th,t.Animation=lu,t.Indexes=ih,t.CornerRadius=rh,t.Index=ui,t.EmptyPointSettings=uh,t.DragSettings=fh,t.TooltipSettings=eh,t.Periods=oh,t.PeriodSelectorSettings=oy,t.LineSeries=gl,t.ColumnSeries=ps,t.AreaSeries=na,t.BarSeries=ta,t.PolarSeries=ws,t.RadarSeries=ia,t.StackingBarSeries=ra,t.CandleSeries=ua,t.StackingColumnSeries=fa,t.StepLineSeries=ea,t.StepAreaSeries=oa,t.StackingAreaSeries=sa,t.StackingStepAreaSeries=ha,t.StackingLineSeries=ca,t.ScatterSeries=la,t.RangeColumnSeries=aa,t.WaterfallSeries=va,t.HiloSeries=ya,t.HiloOpenCloseSeries=pa,t.RangeAreaSeries=wa,t.SplineRangeAreaSeries=ba,t.BubbleSeries=ka,t.SplineSeries=da,t.HistogramSeries=ga,t.SplineAreaSeries=nv,t.TechnicalIndicator=ls,t.SmaIndicator=tv,t.EmaIndicator=iv,t.TmaIndicator=rv,t.AccumulationDistributionIndicator=uv,t.AtrIndicator=fv,t.MomentumIndicator=ev,t.RsiIndicator=ov,t.StochasticIndicator=sv,t.BollingerBands=hv,t.MacdIndicator=cv,t.Trendlines=lv,t.sort=uc,t.isBreakLabel=li,t.getVisiblePoints=fi,t.rotateTextSize=fc,t.removeElement=w,t.logBase=nt,t.showTooltip=rr,t.inside=ai,t.withIn=ut,t.logWithIn=bi,t.withInRange=b,t.sum=g,t.subArraySum=wr,t.subtractThickness=kt,t.subtractRect=function(n,t){return n.x+=t.x,n.y+=t.y,n.width-=t.x+t.width,n.height-=t.y+t.height,n},t.degreeToLocation=vu,t.degreeToRadian=ur,t.getRotatedRectangleCoordinates=yu,t.isRotatedRectIntersect=pu,t.getAngle=function(n,t){var i=Math.atan2(t.y-n.y,t.x-n.x);return(i=i<0?6.283+i:i)*(180/Math.PI)},t.subArray=fr,t.valueToCoefficient=a,t.TransformToVisible=ei,t.indexFinder=function(n,t){void 0===t&&(t=!1);var i=["NaN","NaN"];return n.indexOf("_Point_")>-1?i=n.split("_Series_")[1].split("_Point_"):n.indexOf("_shape_")>-1&&(!t||t&&-1===n.indexOf("_legend_"))?(i=n.split("_shape_"))[0]="0":n.indexOf("_text_")>-1&&(!t||t&&-1===n.indexOf("_legend_"))&&((i=n.split("_text_"))[0]="0"),new ui(parseInt(i[0],10),parseInt(i[1],10))},t.CoefficientToVector=st,t.valueToPolarCoefficient=ft,t.Mean=wu,t.PolarArc=bu,t.createTooltip=ec,t.createZoomingLabels=oc,t.withInBounds=v,t.getValueXByPoint=ku,t.getValueYByPoint=du,t.findClipRect=br,t.firstToLowerCase=tt,t.getTransform=sc,t.getMinPointsDelta=gu,t.getAnimationFunction=nf,t.linear=et,t.markerAnimate=oi,t.animateRectElement=hc,t.pathAnimation=ii,t.appendClipElement=vt,t.triggerLabelRender=vi,t.setRange=ki,t.isZoomSet=yi,t.getActualDesiredIntervalsCount=kr,t.templateAnimate=er,t.drawSymbol=rt,t.calculateShapes=cc,t.getRectLocation=lc,t.minMax=dt,t.getElement=r,t.getTemplateFunction=ac,t.accReactTemplate=vc,t.chartReactTemplate=yc,t.createTemplate=tf,t.getFontStyle=pc,t.measureElementRect=rf,t.findlElement=wc,t.getPoint=e,t.appendElement=uf,t.appendChildElement=h,t.getDraggedRectLocation=dr,t.checkBounds=ff,t.getLabelText=bc,t.stopTimer=or,t.isCollide=di,t.isOverlap=gi,t.containsRect=function(n,t){return n.x<=t.x&&n.x+n.width>=t.x+t.width&&n.y<=t.y&&n.height+n.y>=t.y+t.height},t.calculateRect=sr,t.convertToHexCode=ef,t.componentToHex=gr,t.convertHexToColor=nu,t.colorNameToHex=ht,t.getSaturationColor=hf,t.getMedian=tu,t.calculateLegendShapes=kc,t.textTrim=at,t.lineBreakLabelTrim=dc,t.stringToNumber=ri,t.redrawElement=yt,t.animateRedrawElement=cf,t.textElement=k,t.calculateSize=gc,t.createSvg=nl,t.getTitle=hr,t.titlePositionX=iu,t.textWrap=nr,t.getUnicodeText=lf,t.blazorTemplatesReset=af,t.CustomizeOption=sy,t.StackValues=tl,t.RectOption=y,t.ImageOption=vf,t.CircleOption=si,t.PolygonOption=il,t.ChartLocation=s,t.LabelLocation=hy,t.Thickness=gt,t.ColorValue=cr,t.PointData=tr,t.AccPointData=cy,t.ControlPoints=ru,t.getColorByValue=rl,t.getGradientColor=ul,t.getPercentageColor=fl,t.getPercentage=uu,t.Crosshair=av,t.Tooltip=vv,t.Zoom=yv,t.Selection=ks,t.DataEditing=pv,t.Highlight=wv,t.DataLabel=bv,t.ErrorBar=kv,t.DataLabelSettings=el,t.MarkerSettings=hs,t.Points=ir,t.Trendline=ol,t.ErrorBarCapSettings=sl,t.ChartSegment=hl,t.ErrorBarSettings=cl,t.SeriesBase=cs,t.Series=l,t.Legend=dv,t.ChartAnnotation=gv,t.ChartAnnotationSettings=hh,t.LabelBorder=au,t.MultiLevelCategories=ch,t.StripLineSettings=lh,t.MultiLevelLabels=ah,t.ScrollbarSettingsRange=vh,t.ScrollbarSettings=yh,t.BoxAndWhiskerSeries=ny,t.MultiColoredAreaSeries=ty,t.MultiColoredLineSeries=iy,t.MultiColoredSeries=eu,t.MultiLevelLabel=ry,t.ScrollBar=uy,t.ParetoSeries=fy,t.Export=ey,t}({}))},"./modules/compression.js":function(){window.sf=window.sf||{};window.sf.compression=function(n){"use strict";var r=new Int16Array(286),i=new Uint8Array(286),o=new Int16Array(30),e=new Uint8Array(30),s=function(){function n(i){this.pendingBuffer=new Uint8Array(65536);this.pendingBufLength=0;this.pendingBufCache=0;this.pendingBufBitsInCache=0;this.bufferPosition=0;this.extraBits=0;this.currentHash=0;this.matchStart=0;this.matchLength=0;this.matchPrevAvail=!1;this.blockStart=0;this.stringStart=0;this.lookAhead=0;this.totalBytesIn=0;this.inputOffset=0;this.inputEnd=0;this.windowSize=32768;this.windowMask=this.windowSize-1;this.hashSize=32768;this.hashMask=this.hashSize-1;this.hashShift=Math.floor(17/3);this.maxDist=this.windowSize-262;this.checkSum=1;this.noWrap=!1;n.isHuffmanTreeInitiated||(n.initHuffmanTree(),n.isHuffmanTreeInitiated=!0);this.treeLiteral=new t(this,286,257,15);this.treeDistances=new t(this,30,1,15);this.treeCodeLengths=new t(this,19,4,7);this.arrDistances=new Uint16Array(16384);this.arrLiterals=new Uint8Array(16384);this.stream=[];this.dataWindow=new Uint8Array(2*this.windowSize);this.hashHead=new Int16Array(this.hashSize);this.hashPrevious=new Int16Array(this.windowSize);this.blockStart=this.stringStart=1;this.noWrap=i;i||this.writeZLibHeader()}return Object.defineProperty(n.prototype,"compressedData",{get:function(){return this.stream},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"getCompressedString",{get:function(){var t="",n;if(void 0!==this.stream)for(n=0;n<this.stream.length;n++)t+=String.fromCharCode.apply(null,this.stream[n]);return t},enumerable:!0,configurable:!0}),n.prototype.write=function(n,t,i){var r,u;if(null==n)throw new Error("ArgumentException: data cannot null or undefined");if(r=t+i,0>t||t>r||r>n.length)throw new Error("ArgumentOutOfRangeException: Offset or length is incorrect");for("string"==typeof n&&(u=new sf.fileutils.Encoding(!1),u.type="Utf8",r=t+(n=new Uint8Array(u.getBytes(n,0,n.length))).length),this.inputBuffer=n,this.inputOffset=t,this.inputEnd=r,this.noWrap||(this.checkSum=h.checksumUpdate(this.checkSum,this.inputBuffer,this.inputOffset,r));this.inputEnd!==this.inputOffset||0!==this.pendingBufLength;)this.pendingBufferFlush(),this.compressData(!1)},n.prototype.writeZLibHeader=function(){var n=30720;n|=64;n+=31-n%31;this.pendingBufferWriteShortBytes(n)},n.prototype.pendingBufferWriteShortBytes=function(n){this.pendingBuffer[this.pendingBufLength++]=n>>8;this.pendingBuffer[this.pendingBufLength++]=n},n.prototype.compressData=function(n){var t,i;do this.fillWindow(),i=n&&this.inputEnd===this.inputOffset,t=this.compressSlow(i,n);while(0===this.pendingBufLength&&t);return t},n.prototype.compressSlow=function(n,t){if(this.lookAhead<262&&!n)return!1;for(;this.lookAhead>=262||n;){if(0===this.lookAhead)return this.lookAheadCompleted(t);this.stringStart>=2*this.windowSize-262&&this.slideWindow();var r=this.matchStart,i=this.matchLength;if(this.lookAhead>=3&&this.discardMatch(),i>=3&&this.matchLength<=i?i=this.matchPreviousBest(r,i):this.matchPreviousAvailable(),this.bufferPosition>=16384)return this.huffmanIsFull(t)}return!0},n.prototype.discardMatch=function(){var n=this.insertString();0!==n&&this.stringStart-n<=this.maxDist&&this.findLongestMatch(n)&&this.matchLength<=5&&3===this.matchLength&&this.stringStart-this.matchStart>4096&&(this.matchLength=2)},n.prototype.matchPreviousAvailable=function(){this.matchPrevAvail&&this.huffmanTallyLit(255&this.dataWindow[this.stringStart-1]);this.matchPrevAvail=!0;this.stringStart++;this.lookAhead--},n.prototype.matchPreviousBest=function(n,t){this.huffmanTallyDist(this.stringStart-1-n,t);t-=2;do this.stringStart++,this.lookAhead--,this.lookAhead>=3&&this.insertString();while(--t>0);return this.stringStart++,this.lookAhead--,this.matchPrevAvail=!1,this.matchLength=2,t},n.prototype.lookAheadCompleted=function(n){return this.matchPrevAvail&&this.huffmanTallyLit(255&this.dataWindow[this.stringStart-1]),this.matchPrevAvail=!1,this.huffmanFlushBlock(this.dataWindow,this.blockStart,this.stringStart-this.blockStart,n),this.blockStart=this.stringStart,!1},n.prototype.huffmanIsFull=function(n){var t=this.stringStart-this.blockStart,i;return this.matchPrevAvail&&t--,i=n&&0===this.lookAhead&&!this.matchPrevAvail,this.huffmanFlushBlock(this.dataWindow,this.blockStart,t,i),this.blockStart+=t,!i},n.prototype.fillWindow=function(){for(this.stringStart>=this.windowSize+this.maxDist&&this.slideWindow();this.lookAhead<262&&this.inputOffset<this.inputEnd;){var n=2*this.windowSize-this.lookAhead-this.stringStart;n>this.inputEnd-this.inputOffset&&(n=this.inputEnd-this.inputOffset);this.dataWindow.set(this.inputBuffer.subarray(this.inputOffset,this.inputOffset+n),this.stringStart+this.lookAhead);this.inputOffset+=n;this.totalBytesIn+=n;this.lookAhead+=n}this.lookAhead>=3&&this.updateHash()},n.prototype.slideWindow=function(){var n,t;for(this.dataWindow.set(this.dataWindow.subarray(this.windowSize,this.windowSize+this.windowSize),0),this.matchStart-=this.windowSize,this.stringStart-=this.windowSize,this.blockStart-=this.windowSize,n=0;n<this.hashSize;++n)t=65535&this.hashHead[n],this.hashHead[n]=t>=this.windowSize?t-this.windowSize:0;for(n=0;n<this.windowSize;n++)t=65535&this.hashPrevious[n],this.hashPrevious[n]=t>=this.windowSize?t-this.windowSize:0},n.prototype.insertString=function(){var t,n=(this.currentHash<<this.hashShift^this.dataWindow[this.stringStart+2])&this.hashMask;return this.hashPrevious[this.stringStart&this.windowMask]=t=this.hashHead[n],this.hashHead[n]=this.stringStart,this.currentHash=n,65535&t},n.prototype.findLongestMatch=function(n){var r,o=4096,e=258,i=this.stringStart,u=this.stringStart+this.matchLength,f=Math.max(this.matchLength,2),c=Math.max(this.stringStart-this.maxDist,0),l=this.stringStart+258-1,s=this.dataWindow[u-1],h=this.dataWindow[u],t=this.dataWindow;f>=32&&(o>>=2);e>this.lookAhead&&(e=this.lookAhead);do if(t[n+f]===h&&t[n+f-1]===s&&t[n]===t[i]&&t[n+1]===t[i+1]){for(r=n+2,i+=2;t[++i]===t[++r]&&t[++i]===t[++r]&&t[++i]===t[++r]&&t[++i]===t[++r]&&t[++i]===t[++r]&&t[++i]===t[++r]&&t[++i]===t[++r]&&t[++i]===t[++r]&&i<l;);if(i>u){if(this.matchStart=n,u=i,(f=i-this.stringStart)>=e)break;s=t[u-1];h=t[u]}i=this.stringStart}while((n=65535&this.hashPrevious[n&this.windowMask])>c&&0!=--o);return this.matchLength=Math.min(f,this.lookAhead),this.matchLength>=3},n.prototype.updateHash=function(){this.currentHash=this.dataWindow[this.stringStart]<<this.hashShift^this.dataWindow[this.stringStart+1]},n.prototype.huffmanTallyLit=function(n){return this.arrDistances[this.bufferPosition]=0,this.arrLiterals[this.bufferPosition++]=n,this.treeLiteral.codeFrequencies[n]++,this.bufferPosition>=16384},n.prototype.huffmanTallyDist=function(n,t){var i,r;return this.arrDistances[this.bufferPosition]=n,this.arrLiterals[this.bufferPosition++]=t-3,i=this.huffmanLengthCode(t-3),this.treeLiteral.codeFrequencies[i]++,i>=265&&i<285&&(this.extraBits+=Math.floor((i-261)/4)),r=this.huffmanDistanceCode(n-1),this.treeDistances.codeFrequencies[r]++,r>=4&&(this.extraBits+=Math.floor(r/2-1)),this.bufferPosition>=16384},n.prototype.huffmanFlushBlock=function(n,u,f,s){var l,h,a,c;for(this.treeLiteral.codeFrequencies[256]++,this.treeLiteral.buildTree(),this.treeDistances.buildTree(),this.treeLiteral.calculateBLFreq(this.treeCodeLengths),this.treeDistances.calculateBLFreq(this.treeCodeLengths),this.treeCodeLengths.buildTree(),l=4,h=18;h>l;h--)this.treeCodeLengths.codeLengths[t.huffCodeLengthOrders[h]]>0&&(l=h+1);for(a=14+3*l+this.treeCodeLengths.getEncodedLength()+this.treeLiteral.getEncodedLength()+this.treeDistances.getEncodedLength()+this.extraBits,c=this.extraBits,h=0;h<286;h++)c+=this.treeLiteral.codeFrequencies[h]*i[h];for(h=0;h<30;h++)c+=this.treeDistances.codeFrequencies[h]*e[h];a>=c&&(a=c);u>=0&&f+4<a>>3?this.huffmanFlushStoredBlock(n,u,f,s):a==c?(this.pendingBufferWriteBits(2+(s?1:0),3),this.treeLiteral.setStaticCodes(r,i),this.treeDistances.setStaticCodes(o,e),this.huffmanCompressBlock(),this.huffmanReset()):(this.pendingBufferWriteBits(4+(s?1:0),3),this.huffmanSendAllTrees(l),this.huffmanCompressBlock(),this.huffmanReset())},n.prototype.huffmanFlushStoredBlock=function(n,t,i,r){this.pendingBufferWriteBits(0+(r?1:0),3);this.pendingBufferAlignToByte();this.pendingBufferWriteShort(i);this.pendingBufferWriteShort(~i);this.pendingBufferWriteByteBlock(n,t,i);this.huffmanReset()},n.prototype.huffmanLengthCode=function(n){if(255===n)return 285;for(var t=257;n>=8;)t+=4,n>>=1;return t+n},n.prototype.huffmanDistanceCode=function(n){for(var t=0;n>=4;)t+=2,n>>=1;return t+n},n.prototype.huffmanSendAllTrees=function(n){this.treeCodeLengths.buildCodes();this.treeLiteral.buildCodes();this.treeDistances.buildCodes();this.pendingBufferWriteBits(this.treeLiteral.treeLength-257,5);this.pendingBufferWriteBits(this.treeDistances.treeLength-1,5);this.pendingBufferWriteBits(n-4,4);for(var i=0;i<n;i++)this.pendingBufferWriteBits(this.treeCodeLengths.codeLengths[t.huffCodeLengthOrders[i]],3);this.treeLiteral.writeTree(this.treeCodeLengths);this.treeDistances.writeTree(this.treeCodeLengths)},n.prototype.huffmanReset=function(){this.bufferPosition=0;this.extraBits=0;this.treeLiteral.reset();this.treeDistances.reset();this.treeCodeLengths.reset()},n.prototype.huffmanCompressBlock=function(){for(var i,r,u,n,f,t=0;t<this.bufferPosition;t++)i=255&this.arrLiterals[t],r=this.arrDistances[t],0!=r--?(u=this.huffmanLengthCode(i),this.treeLiteral.writeCodeToStream(u),n=Math.floor((u-261)/4),n>0&&n<=5&&this.pendingBufferWriteBits(i&(1<<n)-1,n),f=this.huffmanDistanceCode(r),this.treeDistances.writeCodeToStream(f),(n=Math.floor(f/2-1))>0&&this.pendingBufferWriteBits(r&(1<<n)-1,n)):this.treeLiteral.writeCodeToStream(i);this.treeLiteral.writeCodeToStream(256)},n.prototype.pendingBufferWriteBits=function(n,t){var i=new Uint32Array(1);i[0]=this.pendingBufCache|n<<this.pendingBufBitsInCache;this.pendingBufCache=i[0];this.pendingBufBitsInCache+=t;this.pendingBufferFlushBits()},n.prototype.pendingBufferFlush=function(){if(this.pendingBufferFlushBits(),this.pendingBufLength>0){var n=new Uint8Array(this.pendingBufLength);n.set(this.pendingBuffer.subarray(0,this.pendingBufLength),0);this.stream.push(n)}this.pendingBufLength=0},n.prototype.pendingBufferFlushBits=function(){for(var n=0;this.pendingBufBitsInCache>=8&&this.pendingBufLength<65536;)this.pendingBuffer[this.pendingBufLength++]=this.pendingBufCache,this.pendingBufCache>>=8,this.pendingBufBitsInCache-=8,n++;return n},n.prototype.pendingBufferWriteByteBlock=function(n,t,i){var r=n.subarray(t,t+i);this.pendingBuffer.set(r,this.pendingBufLength);this.pendingBufLength+=i},n.prototype.pendingBufferWriteShort=function(n){this.pendingBuffer[this.pendingBufLength++]=n;this.pendingBuffer[this.pendingBufLength++]=n>>8},n.prototype.pendingBufferAlignToByte=function(){this.pendingBufBitsInCache>0&&(this.pendingBuffer[this.pendingBufLength++]=this.pendingBufCache);this.pendingBufCache=0;this.pendingBufBitsInCache=0},n.initHuffmanTree=function(){for(var n=0;n<144;)r[n]=t.bitReverse(48+n<<8),i[n++]=8;for(;n<256;)r[n]=t.bitReverse(256+n<<7),i[n++]=9;for(;n<280;)r[n]=t.bitReverse(-256+n<<9),i[n++]=7;for(;n<286;)r[n]=t.bitReverse(-88+n<<8),i[n++]=8;for(n=0;n<30;n++)o[n]=t.bitReverse(n<<11),e[n]=5},n.prototype.close=function(){do this.pendingBufferFlush(!0),this.compressData(!0)||(this.pendingBufferFlush(!0),this.pendingBufferAlignToByte(),this.noWrap||(this.pendingBufferWriteShortBytes(this.checkSum>>16),this.pendingBufferWriteShortBytes(65535&this.checkSum)),this.pendingBufferFlush(!0));while(this.inputEnd!==this.inputOffset||0!==this.pendingBufLength)},n.prototype.destroy=function(){this.stream=[];this.stream=void 0;this.pendingBuffer=void 0;this.treeLiteral=void 0;this.treeDistances=void 0;this.treeCodeLengths=void 0;this.arrLiterals=void 0;this.arrDistances=void 0;this.hashHead=void 0;this.hashPrevious=void 0;this.dataWindow=void 0;this.inputBuffer=void 0;this.pendingBufLength=void 0;this.pendingBufCache=void 0;this.pendingBufBitsInCache=void 0;this.bufferPosition=void 0;this.extraBits=void 0;this.currentHash=void 0;this.matchStart=void 0;this.matchLength=void 0;this.matchPrevAvail=void 0;this.blockStart=void 0;this.stringStart=void 0;this.lookAhead=void 0;this.totalBytesIn=void 0;this.inputOffset=void 0;this.inputEnd=void 0;this.windowSize=void 0;this.windowMask=void 0;this.hashSize=void 0;this.hashMask=void 0;this.hashShift=void 0;this.maxDist=void 0;this.checkSum=void 0;this.noWrap=void 0},n.isHuffmanTreeInitiated=!1,n}(),t=function(){function n(n,t,i,r){this.writer=n;this.codeMinCount=i;this.maxLength=r;this.codeFrequency=new Uint16Array(t);this.lengthCount=new Int32Array(r)}return Object.defineProperty(n.prototype,"treeLength",{get:function(){return this.codeCount},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"codeLengths",{get:function(){return this.codeLength},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"codeFrequencies",{get:function(){return this.codeFrequency},enumerable:!0,configurable:!0}),n.prototype.setStaticCodes=function(n,t){var r=new Int16Array(n.length),i;r.set(n,0);this.codes=r;i=new Uint8Array(t.length);i.set(t,0);this.codeLength=i},n.prototype.reset=function(){for(var n=0;n<this.codeFrequency.length;n++)this.codeFrequency[n]=0;this.codes=void 0;this.codeLength=void 0},n.prototype.writeCodeToStream=function(n){this.writer.pendingBufferWriteBits(65535&this.codes[n],this.codeLength[n])},n.prototype.buildCodes=function(){var u=new Int32Array(this.maxLength),f,t,i,r;for(this.codes=new Int16Array(this.codeCount),f=0,t=0;t<this.maxLength;t++)u[t]=f,f+=this.lengthCount[t]<<15-t;for(i=0;i<this.codeCount;i++)r=this.codeLength[i],r>0&&(this.codes[i]=n.bitReverse(u[r-1]),u[r-1]+=1<<16-r)},n.bitReverse=function(t){return n.reverseBits[15&t]<<12|n.reverseBits[t>>4&15]<<8|n.reverseBits[t>>8&15]<<4|n.reverseBits[t>>12]},n.prototype.getEncodedLength=function(){for(var t=0,n=0;n<this.codeFrequency.length;n++)t+=this.codeFrequency[n]*this.codeLength[n];return t},n.prototype.calculateBLFreq=function(n){for(var f,e,i,u,r=-1,t=0;t<this.codeCount;){for(i=1,u=this.codeLength[t],0===u?(f=138,e=3):(f=6,e=3,r!==u&&(n.codeFrequency[u]++,i=0)),r=u,t++;t<this.codeCount&&r===this.codeLength[t]&&(t++,!(++i>=f)););i<e?n.codeFrequency[r]+=i:0!==r?n.codeFrequency[16]++:i<=10?n.codeFrequency[17]++:n.codeFrequency[18]++}},n.prototype.writeTree=function(n){for(var f,e,t,u,r=-1,i=0;i<this.codeCount;){for(t=1,u=this.codeLength[i],0===u?(f=138,e=3):(f=6,e=3,r!==u&&(n.writeCodeToStream(u),t=0)),r=u,i++;i<this.codeCount&&r===this.codeLength[i]&&(i++,!(++t>=f)););if(t<e)for(;t-->0;)n.writeCodeToStream(r);else 0!==r?(n.writeCodeToStream(16),this.writer.pendingBufferWriteBits(t-3,2)):t<=10?(n.writeCodeToStream(17),this.writer.pendingBufferWriteBits(t-3,3)):(n.writeCodeToStream(18),this.writer.pendingBufferWriteBits(t-11,7))}},n.prototype.buildTree=function(){for(var s,r,e,h,c,l=this.codeFrequency.length,n=new Int32Array(l),t=0,f=0,u=0;u<l;u++)if(s=this.codeFrequency[u],0!==s){for(r=t++,e=0;r>0&&this.codeFrequency[n[e=Math.floor((r-1)/2)]]>s;)n[r]=n[e],r=e;n[r]=u;f=u}for(;t<2;)n[t++]=f<2?++f:0;this.codeCount=Math.max(f+1,this.codeMinCount);for(var v=t,o=new Int32Array(4*t-2),a=new Int32Array(2*t-1),i=0;i<t;i++)h=n[i],c=2*i,o[c]=h,o[c+1]=-1,a[i]=this.codeFrequency[h]<<8,n[i]=i;this.constructHuffmanTree(n,t,a,v,o);this.buildLength(o)},n.prototype.constructHuffmanTree=function(n,t,i,r,u){var s,l;do{for(var h=n[0],o=n[--t],c=i[o],e=0,f=1;f<t;)f+1<t&&i[n[f]]>i[n[f+1]]&&f++,n[e]=n[f],f=2*(e=f)+1;for(;(f=e)>0&&i[n[e=Math.floor((f-1)/2)]]>c;)n[f]=n[e];for(n[f]=o,s=n[0],u[2*(o=r++)]=h,u[2*o+1]=s,l=Math.min(255&i[h],255&i[s]),i[o]=c=i[h]+i[s]-l+1,e=0,f=1;f<t;)f+1<t&&i[n[f]]>i[n[f+1]]&&f++,n[e]=n[f],f=2*(e=f)+1;for(;(f=e)>0&&i[n[e=Math.floor((f-1)/2)]]>c;)n[f]=n[e];n[f]=o}while(t>1)},n.prototype.buildLength=function(n){var i;this.codeLength=new Uint8Array(this.codeFrequency.length);for(var u=Math.floor(n.length/2),f=Math.floor((u+1)/2),t=0,r=0;r<this.maxLength;r++)this.lengthCount[r]=0;if(0!==(t=this.calculateOptimalCodeLength(n,t,u))){i=this.maxLength-1;do{for(;0===this.lengthCount[--i];);do this.lengthCount[i]--,this.lengthCount[++i]++,t-=1<<this.maxLength-1-i;while(t>0&&i<this.maxLength-1)}while(t>0);this.recreateTree(n,t,f)}},n.prototype.recreateTree=function(n,t,i){var e,r,u,f;for(this.lengthCount[this.maxLength-1]+=t,this.lengthCount[this.maxLength-2]-=t,e=2*i,r=this.maxLength;0!==r;r--)for(u=this.lengthCount[r-1];u>0;)f=2*n[e++],-1===n[f+1]&&(this.codeLength[n[f]]=r,u--)},n.prototype.calculateOptimalCodeLength=function(n,t,i){var u=new Int32Array(i),r,f,e;for(u[i-1]=0,r=i-1;r>=0;r--)f=2*r+1,-1!==n[f]?((e=u[r]+1)>this.maxLength&&(e=this.maxLength,t++),u[n[f-1]]=u[n[f]]=e):(e=u[r],this.lengthCount[e-1]++,this.codeLength[n[f-1]]=u[r]);return t},n.reverseBits=[0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15],n.huffCodeLengthOrders=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],n}(),h=function(){function n(){}return n.checksumUpdate=function(t,i,r,u){var f=new Uint32Array(1),s;f[0]=t;for(var h=f[0],e=f[0]=65535&h,o=f[0]=h>>n.checkSumBitOffset;u>0;){for(s=Math.min(u,n.checksumIterationCount),u-=s;--s>=0;)o+=e+=f[0]=255&i[r++];e%=n.checksumBase;o%=n.checksumBase}return o<<n.checkSumBitOffset|e},n.checkSumBitOffset=16,n.checksumBase=65521,n.checksumIterationCount=3800,n}(),u=[],c=function(){function n(){0===u.length&&n.initCrc32Table();this.files=[];this.level="Normal";sf.fileutils.Save.isMicrosoftBrowser=!!navigator.msSaveBlob}return Object.defineProperty(n.prototype,"compressionLevel",{get:function(){return this.level},set:function(n){this.level=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"length",{get:function(){return void 0===this.files?0:this.files.length},enumerable:!0,configurable:!0}),n.prototype.addItem=function(n){var t,i;if(null==n)throw new Error("ArgumentException: item cannot be null or undefined");for(t=0;t<this.files.length;t++)if(i=this.files[t],_instanceof(i,f)&&i.name===n.name)throw new Error("item with same name already exist");this.files.push(n)},n.prototype.addDirectory=function(n){if(null==n)throw new Error("ArgumentException: string cannot be null or undefined");if(0===n.length)throw new Error("ArgumentException: string cannot be empty");if("/"!==n.slice(-1)&&(n+="/"),-1!==this.files.indexOf(n))throw new Error("item with same name already exist");this.files.push(n)},n.prototype.getItem=function(n){if(n>=0&&n<this.files.length)return this.files[n]},n.prototype.contains=function(n){return-1!==this.files.indexOf(n)},n.prototype.save=function(n){if(null==n||0===n.length)throw new Error("ArgumentException: fileName cannot be null or undefined");if(0===this.files.length)throw new Error("InvalidOperation");var t=this;return new Promise(function(i){t.saveInternal(n,!1).then(function(){i(t)})})},n.prototype.saveAsBlob=function(){var n=this;return new Promise(function(t){n.saveInternal("",!0).then(function(n){t(n)})})},n.prototype.saveInternal=function(n,t){var r=this,i=this;return new Promise(function(u){for(var f=[],e=0,o=0;o<i.files.length;o++)r.getCompressedData(r.files[o]).then(function(r){if(e=i.constructZippedObject(f,r,e,r.isDirectory),f.length===i.files.length){var o=i.writeZippedContent(n,f,e,t);u(o)}})})},n.prototype.destroy=function(){var n,t;if(void 0!==this.files&&this.files.length>0){for(n=0;n<this.files.length;n++)t=this.files[n],_instanceof(t,f)&&t.destroy(),t=void 0;this.files=[]}this.files=void 0;this.level=void 0},n.prototype.getCompressedData=function(n){var t=this;return new Promise(function(i){if(_instanceof(n,f)){var r=new FileReader;r.onload=function(){var e=new Uint8Array(r.result),f={fileName:n.name,crc32Value:0,compressedData:[],compressedSize:void 0,uncompressedDataSize:e.length,compressionType:void 0,isDirectory:!1},s,o;if("Normal"===t.level){for(t.compressData(e,f,u),s=0,o=0;o<f.compressedData.length;o++)s+=f.compressedData[o].length;f.compressedSize=s;f.compressionType="\b\0"}else f.compressedSize=e.length,f.crc32Value=t.calculateCrc32Value(0,e,u),f.compressionType="\0\0",f.compressedData.push(e);i(f)};r.readAsArrayBuffer(n.data)}else i({fileName:n,crc32Value:0,compressedData:"",compressedSize:0,uncompressedDataSize:0,compressionType:"\0\0",isDirectory:!0})})},n.prototype.compressData=function(n,t,i){var u=new s(!0),r=0,f=0,e;do{if(r>=n.length){u.close();break}f=Math.min(n.length,r+16384);e=n.subarray(r,f);t.crc32Value=this.calculateCrc32Value(t.crc32Value,e,i);u.write(e,0,f-r);r=f}while(r<=n.length);t.compressedData=u.compressedData;u.destroy()},n.prototype.constructZippedObject=function(n,t,i,r){var u=0,o=new Date;r&&(u|=16);u|=0;var f=this.writeHeader(t,o),e="PK\x03\x04"+f+t.fileName,s=this.writeCentralDirectory(t,f,i,u);return n.push({localHeader:e,centralDir:s,compressedData:t}),i+e.length+t.compressedSize},n.prototype.writeHeader=function(n,t){var i="";return i+="\n\0\0\0",i+=n.compressionType,i+=this.getBytes(this.getModifiedTime(t),2),i+=this.getBytes(this.getModifiedDate(t),2),i+=this.getBytes(n.crc32Value,4),i+=this.getBytes(n.compressedSize,4),i+=this.getBytes(n.uncompressedDataSize,4),i+=this.getBytes(n.fileName.length,2),i+this.getBytes(0,2)},n.prototype.writeZippedContent=function(n,t,i,r){for(var e,o,s=0,f=[],u=0;u<t.length;u++)for(e=t[u],s+=e.centralDir.length,f.push(this.getArrayBuffer(e.localHeader));e.compressedData.compressedData.length;)f.push(e.compressedData.compressedData.shift().buffer);for(u=0;u<t.length;u++)f.push(this.getArrayBuffer(t[u].centralDir));return f.push(this.getArrayBuffer(this.writeFooter(t,s,i))),o=new Blob(f,{type:"application/zip"}),r||sf.fileutils.Save.save(n,o),o},n.prototype.writeCentralDirectory=function(n,t,i,r){return"PK\x01\x02"+this.getBytes(20,2)+t+this.getBytes(0,2)+"\0\0\0\0"+this.getBytes(r,4)+this.getBytes(i,4)+n.fileName},n.prototype.writeFooter=function(n,t,i){return"PK\0\0\0\0"+this.getBytes(n.length,2)+this.getBytes(n.length,2)+this.getBytes(t,4)+this.getBytes(i,4)+this.getBytes(0,2)},n.prototype.getArrayBuffer=function(n){for(var i=new Uint8Array(n.length),t=0;t<n.length;++t)i[t]=255&n.charCodeAt(t);return i.buffer},n.prototype.getBytes=function(n,t){for(var i="",r=0;r<t;r++)i+=String.fromCharCode(255&n),n>>>=8;return i},n.prototype.getModifiedTime=function(n){var t=n.getHours();return t<<=6,t|=n.getMinutes(),(t<<=5)|n.getSeconds()/2},n.prototype.getModifiedDate=function(n){var t=n.getFullYear()-1980;return t<<=4,t|=n.getMonth()+1,(t<<=5)|n.getDate()},n.prototype.calculateCrc32Value=function(n,t,i){n^=-1;for(var r=0;r<t.length;r++)n=n>>>8^i[255&(n^t[r])];return-1^n},n.initCrc32Table=function(){for(var n,i,t=0;t<256;t++){for(n=t,i=0;i<8;i++)n=1&n?3988292384^n>>>1:n>>>1;u[t]=n}},n}(),f=function(){function n(n,t){if(null==n)throw new Error("ArgumentException: data cannot be null or undefined");if(null==t)throw new Error("ArgumentException: string cannot be null or undefined");if(0===t.length)throw new Error("string cannot be empty");this.data=n;this.name=t}return Object.defineProperty(n.prototype,"name",{get:function(){return this.fileName},set:function(n){this.fileName=n},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){this.fileName=void 0;this.data=void 0},n}();return n.ZipArchive=c,n.ZipArchiveItem=f,n.CompressedStreamWriter=s,n.CompressorHuffmanTree=t,n.ChecksumCalculator=h,n};sf.compression=sf.compression({})},"./modules/data.js":function(){function n(t){return(n="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(n){return _typeof2(n)}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":_typeof2(n)})(t)}window.sf=window.sf||{};window.sf.data=function(t){"use strict";var l,r=function(){function n(n){return this.subQuery=null,this.isChild=!1,this.distincts=[],this.queries=[],this.key="",this.fKey="","string"==typeof n?this.fromTable=n:n&&_instanceof(n,Array)&&(this.lookups=n),this.expands=[],this.sortedColumns=[],this.groupedColumns=[],this.subQuery=null,this.isChild=!1,this.params=[],this.lazyLoad=[],this}return n.prototype.setKey=function(n){return this.key=n,this},n.prototype.using=function(n){return this.dataManager=n,this},n.prototype.execute=function(n,t,r,u){return(n=n||this.dataManager)?n.executeQuery(this,t,r,u):i.throwError('Query - execute() : dataManager needs to be is set using "using" function or should be passed as argument')},n.prototype.executeLocal=function(n){return(n=n||this.dataManager)?n.executeLocal(this):i.throwError('Query - executeLocal() : dataManager needs to be is set using "using" function or should be passed as argument')},n.prototype.clone=function(){var t=new n;return t.queries=this.queries.slice(0),t.key=this.key,t.isChild=this.isChild,t.dataManager=this.dataManager,t.fromTable=this.fromTable,t.params=this.params.slice(0),t.expands=this.expands.slice(0),t.sortedColumns=this.sortedColumns.slice(0),t.groupedColumns=this.groupedColumns.slice(0),t.subQuerySelector=this.subQuerySelector,t.subQuery=this.subQuery,t.fKey=this.fKey,t.isCountRequired=this.isCountRequired,t.distincts=this.distincts.slice(0),t.lazyLoad=this.lazyLoad.slice(0),t},n.prototype.from=function(n){return this.fromTable=n,this},n.prototype.addParams=function(n,t){return"function"==typeof t?this.params.push({key:n,fn:t}):this.params.push({key:n,value:t}),this},n.prototype.distinct=function(n){return this.distincts="string"==typeof n?[].slice.call([n],0):n.slice(0),this},n.prototype.expand=function(n){return this.expands="string"==typeof n?[].slice.call([n],0):n.slice(0),this},n.prototype.where=function(n,t,i,r,f){t=t?t.toLowerCase():null;var e=null;return"string"==typeof n?e=new u(n,t,i,r,f):_instanceof(n,u)&&(e=n),this.queries.push({fn:"onWhere",e:e}),this},n.prototype.search=function(n,t,r,u,f){"string"==typeof t&&(t=[t]);r&&"none"!==r||(r="contains");var e=i.fnOperators[r];return this.queries.push({fn:"onSearch",e:{fieldNames:t,operator:r,searchKey:n,ignoreCase:u,ignoreAccent:f,comparer:e}}),this},n.prototype.sortBy=function(n,t,i){return this.sortByForeignKey(n,t,i)},n.prototype.sortByForeignKey=function(t,r,u,f){var h,e,c=sf.base.isNullOrUndefined(f)?"ascending":f,s,o;if("string"==typeof t&&i.endsWith(t.toLowerCase()," desc")&&(t=t.replace(/ desc$/i,""),r="descending"),r&&"string"!=typeof r||(c=r?r.toLowerCase():"ascending",r=i.fnSort(r)),u)for(h=n.filterQueries(this.queries,"onSortBy"),s=0;s<h.length;s++)if("string"==typeof(e=h[s].e.fieldName)){if(e===t)return this}else if(_instanceof(e,Array))for(o=0;o<e.length;o++)if(e[o]===t||t.toLowerCase()===e[o]+" desc")return this;return this.queries.push({fn:"onSortBy",e:{fieldName:t,comparer:r,direction:c}}),this},n.prototype.sortByDesc=function(n){return this.sortBy(n,"descending")},n.prototype.group=function(n,t,i){return this.sortBy(n,null,!0),this.queries.push({fn:"onGroup",e:{fieldName:n,comparer:t||null,format:i||null}}),this},n.prototype.page=function(n,t){return this.queries.push({fn:"onPage",e:{pageIndex:n,pageSize:t}}),this},n.prototype.range=function(n,t){return this.queries.push({fn:"onRange",e:{start:n,end:t}}),this},n.prototype.take=function(n){return this.queries.push({fn:"onTake",e:{nos:n}}),this},n.prototype.skip=function(n){return this.queries.push({fn:"onSkip",e:{nos:n}}),this},n.prototype.select=function(n){return"string"==typeof n&&(n=[].slice.call([n],0)),this.queries.push({fn:"onSelect",e:{fieldNames:n}}),this},n.prototype.hierarchy=function(n,t){return this.subQuerySelector=t,this.subQuery=n,this},n.prototype.foreignKey=function(n){return this.fKey=n,this},n.prototype.requiresCount=function(){return this.isCountRequired=!0,this},n.prototype.aggregate=function(n,t){return this.queries.push({fn:"onAggregates",e:{field:t,type:n}}),this},n.filterQueries=function(n,t){return n.filter(function(n){return n.fn===t})},n.filterQueryLists=function(n,t){for(var r=n.filter(function(n){return-1!==t.indexOf(n.fn)}),u={},i=0;i<r.length;i++)u[r[i].fn]||(u[r[i].fn]=r[i].e);return u},n}(),u=function(){function n(t,r,u,f,e){return void 0===f&&(f=!1),this.ignoreAccent=!1,this.isComplex=!1,"string"==typeof t?(this.field=t,this.operator=r.toLowerCase(),this.value=u,this.ignoreCase=f,this.ignoreAccent=e,this.isComplex=!1,this.comparer=i.fnOperators.processOperator(this.operator)):(_instanceof(t,n)&&_instanceof(u,n)||_instanceof(u,Array))&&(this.isComplex=!0,this.condition=r.toLowerCase(),this.predicates=[t],_instanceof(u,Array)?[].push.apply(this.predicates,u):this.predicates.push(u)),this}return n.and=function(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];return n.combinePredicates([].slice.call(i,0),"and")},n.prototype.and=function(t,i,r,u,f){return n.combine(this,t,i,r,"and",u,f)},n.or=function(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];return n.combinePredicates([].slice.call(i,0),"or")},n.prototype.or=function(t,i,r,u,f){return n.combine(this,t,i,r,"or",u,f)},n.fromJson=function(n){var r;if(_instanceof(n,Array)){for(var i=[],t=0,u=n.length;t<u;t++)i.push(this.fromJSONData(n[t]));return i}return r=n,this.fromJSONData(r)},n.prototype.validate=function(n){var r,u,f=this.predicates?this.predicates:[],t;if(!this.isComplex&&this.comparer)return this.comparer.call(this,i.getObject(this.field,n),this.value,this.ignoreCase,this.ignoreAccent);for(r="and"===this.condition,t=0;t<f.length;t++)if(u=f[t].validate(n),r){if(!u)return!1}else if(u)return!0;return r},n.prototype.toJson=function(){var t,i,n;if(this.isComplex)for(t=[],i=this.predicates,n=0;n<i.length;n++)t.push(i[n].toJson());return{isComplex:this.isComplex,field:this.field,operator:this.operator,value:this.value,ignoreCase:this.ignoreCase,ignoreAccent:this.ignoreAccent,condition:this.condition,predicates:t}},n.combinePredicates=function(t,i){if(1===t.length){if(!_instanceof(t[0],Array))return t[0];t=t[0]}return new n(t[0],i,t.slice(1))},n.combine=function(t,r,u,f,e,o,s){return _instanceof(r,n)?n[e](t,r):"string"==typeof r?n[e](t,new n(r,u,f,o,s)):i.throwError("Predicate - "+e+" : invalid arguments")},n.fromJSONData=function(t){for(var u=t.predicates||[],f=u.length,i=[],r=0;r<f;r++)i.push(this.fromJSONData(u[r]));return t.isComplex?new n(i[0],t.condition,i.slice(1)):new n(t.field,t.operator,t.value,t.ignoreCase,t.ignoreAccent)},n}(),v={GroupGuid:"{271bbba0-1ee7}"},i=function(){function t(){}return t.getValue=function(n,t){return"function"==typeof n?n.call(t||{}):n},t.endsWith=function(n,t){return n.slice&&n.slice(-t.length)===t},t.startsWith=function(n,t){return n.slice(0,t.length)===t},t.fnSort=function(n){return"ascending"===(n=n?t.toLowerCase(n):"ascending")?this.fnAscending:this.fnDescending},t.fnAscending=function(n,t){return sf.base.isNullOrUndefined(n)&&sf.base.isNullOrUndefined(t)||null==t?-1:"string"==typeof n?n.localeCompare(t):null==n?1:n-t},t.fnDescending=function(n,t){return sf.base.isNullOrUndefined(n)&&sf.base.isNullOrUndefined(t)?-1:null==t?1:"string"==typeof n?-1*n.localeCompare(t):null==n?-1:t-n},t.extractFields=function(n,t){for(var r={},i=0;i<t.length;i++)r=this.setValue(t[i],this.getObject(t[i],n),r);return r},t.select=function(n,t){for(var r=[],i=0;i<n.length;i++)r.push(this.extractFields(n[i],t));return r},t.group=function(n,i,r,u,f,e,o){var s,l,h,p;if(u=u||1,s=n,s.GroupGuid===v.GroupGuid){for(var w=function(n){if(sf.base.isNullOrUndefined(f))s[n].items=y.group(s[n].items,i,r,s.level+1,null,e,o),s[n].count=s[n].items.length;else{var t,u=f.filter(function(t){return t.key===s[n].key});t=f.indexOf(u[0]);s[n].items=y.group(s[n].items,i,r,s.level+1,f[t].items,e,o);s[n].count=f[t].count}},y=this,a=0;a<s.length;a++)w(a);return s.childLevels+=1,s}l={};h=[];h.GroupGuid=v.GroupGuid;h.level=u;h.childLevels=0;h.records=s;for(var b=function(n){var t=k.getVal(s,n,i),u;(sf.base.isNullOrUndefined(e)||(t=e(t,i)),l[t]||(l[t]={key:t,count:0,items:[],aggregates:{},field:i},h.push(l[t]),sf.base.isNullOrUndefined(f)))||(u=f.filter(function(n){return n.key===l[t].key}),l[t].count=u[0].count);l[t].count=sf.base.isNullOrUndefined(f)?l[t].count+=1:l[t].count;(!o||o&&r.length)&&l[t].items.push(s[n])},k=this,c=0;c<s.length;c++)b(c);if(r&&r.length)for(p=function(n){for(var s,o={},e=void 0,u=r,i=0;i<r.length;i++)(e=t.aggregates[r[i].type],sf.base.isNullOrUndefined(f))?e&&(o[u[i].field+" - "+u[i].type]=e(h[n].items,u[i].field)):(s=f.filter(function(t){return t.key===h[n].key}),e&&(o[u[i].field+" - "+u[i].type]=e(s[0].items,u[i].field)));h[n].aggregates=o},c=0;c<h.length;c++)p(c);if(o&&h.length&&r.length)for(c=0;c<h.length;c++)h[c].items=[];return s.length&&h||s},t.buildHierarchy=function(n,t,i,r,u){var f,o={},e;for(r.result&&(r=r.result),r.GroupGuid&&this.throwError("DataManager: Do not have support Grouping in hierarchy"),f=0;f<r.length;f++)(o[e=this.getObject(n,r[f])]||(o[e]=[])).push(r[f]);for(f=0;f<i.length;f++)e=this.getObject(u||n,i[f]),i[f][t]=o[e]},t.getFieldList=function(t,i,r){var u;if(void 0===r&&(r=""),null==i)return this.getFieldList(t,[],r);for(var f=t,e=0,o=Object.keys(t);e<o.length;e++)u=o[e],"object"!==n(f[u])||_instanceof(f[u],Array)?i.push(r+u):this.getFieldList(f[u],i,r+u+".");return i},t.getObject=function(n,t){if(!n)return t;if(t){if(-1===n.indexOf("."))return t[n];for(var i=t,u=n.split("."),r=0;r<u.length&&null!=i;r++)i=i[u[r]];return i}},t.setValue=function(n,t,i){for(var u,e=n.toString().split("."),o=i||{},f=o,s=e.length,r=0;r<s;r++)u=e[r],r+1===s?f[u]=void 0===t?void 0:t:sf.base.isNullOrUndefined(f[u])&&(f[u]={}),f=f[u];return o},t.sort=function(n,t,i){if(n.length<=1)return n;var f=parseInt((n.length/2).toString(),10),r=n.slice(0,f),u=n.slice(f);return r=this.sort(r,t,i),u=this.sort(u,t,i),this.merge(r,u,t,i)},t.ignoreDiacritics=function(n){return"string"!=typeof n?n:n.split("").map(function(n){return n in t.diacritics?t.diacritics[n]:n}).join("")},t.merge=function(n,t,i,r){for(var u,f=[];n.length>0||t.length>0;)u=n.length>0&&t.length>0?r?r(this.getVal(n,0,i),this.getVal(t,0,i),n[0],t[0])<=0?n:t:n[0][i]<n[0][i]?n:t:n.length>0?n:t,f.push(u.shift());return f},t.getVal=function(n,t,i){return i?this.getObject(i,n[t]):n[t]},t.toLowerCase=function(n){return n?"string"==typeof n?n.toLowerCase():n.toString():0===n||!1===n?n.toString():""},t.callAdaptorFunction=function(n,t,i,r){if(t in n){var u=n[t](i,r);sf.base.isNullOrUndefined(u)||(i=u)}return i},t.getAddParams=function(n,i,r){var u={};return t.callAdaptorFunction(n,"addParams",{dm:i,query:r,params:r.params,reqParams:u}),u},t.isPlainObject=function(n){return!!n&&n.constructor===Object},t.isCors=function(){var n=null;try{n=new window.XMLHttpRequest}catch(n){}return!!n&&"withCredentials"in n},t.getGuid=function(n){var t;return(n||"")+"00000000-0000-4000-0000-000000000000".replace(/0/g,function(n,i){if("crypto"in window&&"getRandomValues"in crypto){var r=new Uint8Array(1);window.crypto.getRandomValues(r);t=r[0]%16|0}else t=16*Math.random()|0;return"0123456789abcdef"[19===i?3&t|8:t]})},t.isNull=function(n){return null==n},t.getItemFromComparer=function(n,i,r){var f,e,o,u=0,s="string"==typeof t.getVal(n,0,i);if(n.length)for(;sf.base.isNullOrUndefined(f)&&u<n.length;)f=t.getVal(n,u,i),o=n[u++];for(;u<n.length;u++)e=t.getVal(n,u,i),sf.base.isNullOrUndefined(e)||(s&&(f=+f,e=+e),r(f,e)>0&&(f=e,o=n[u]));return o},t.distinct=function(i,r,u){u=!sf.base.isNullOrUndefined(u)&&u;var f,e=[],o={};return i.forEach(function(s,h){(f="object"===n(i[h])?t.getVal(i,h,r):i[h])in o||(e.push(u?i[h]:f),o[f]=1)}),e},t.processData=function(n,t){var r=this.prepareQuery(n),f=new c(t),i,u;return n.requiresCounts&&r.requiresCount(),i=f.executeLocal(r),u={result:n.requiresCounts?i.result:i,count:i.count,aggregates:JSON.stringify(i.aggregates)},n.requiresCounts?u:i},t.prepareQuery=function(n){var f=this,i=new r;return(n.select&&i.select(n.select),n.where)&&t.parse.parseJson(n.where).filter(function(n){if(sf.base.isNullOrUndefined(n.condition))i.where(n.field,n.operator,n.value,n.ignoreCase,n.ignoreAccent);else{var t=[];n.field?t.push(new u(n.field,n.operator,n.value,n.ignoreCase,n.ignoreAccent)):t=t.concat(f.getPredicate(n.predicates));"or"==n.condition?i.where(u.or(t)):"and"==n.condition&&i.where(u.and(t))}}),n.search&&t.parse.parseJson(n.search).filter(function(n){return i.search(n.key,n.fields,n.operator,n.ignoreCase,n.ignoreAccent)}),n.aggregates&&n.aggregates.filter(function(n){return i.aggregate(n.type,n.field)}),n.sorted&&n.sorted.filter(function(n){return i.sortBy(n.name,n.direction)}),n.skip&&i.skip(n.skip),n.take&&i.take(n.take),n.group&&n.group.filter(function(n){return i.group(n)}),i},t.getPredicate=function(n){for(var t,h,i=[],r=0;r<n.length;r++)if(t=n[r],t.field)i.push(new u(t.field,t.operator,t.value,t.ignoreCase,t.ignoreAccent));else{for(var f=[],o=this.getPredicate(t.predicates),e=0,s=Object.keys(o);e<s.length;e++)h=s[e],f.push(o[h]);i.push("or"==t.condition?u.or(f):u.and(f))}return i},t.serverTimezoneOffset=null,t.timeZoneHandling=!0,t.throwError=function(n){try{throw new Error(n);}catch(n){throw n.message+"\n"+n.stack;}},t.aggregates={sum:function(n,i){for(var r,f=0,e="number"!=typeof t.getVal(n,0,i),u=0;u<n.length;u++)r=t.getVal(n,u,i),isNaN(r)||null===r||(e&&(r=+r),f+=r);return f},average:function(n,i){return t.aggregates.sum(n,i)/n.length},min:function(n,i){var r;return"function"==typeof i&&(r=i,i=null),t.getObject(i,t.getItemFromComparer(n,i,r||t.fnAscending))},max:function(n,i){var r;return"function"==typeof i&&(r=i,i=null),t.getObject(i,t.getItemFromComparer(n,i,r||t.fnDescending))},truecount:function(n,t){return new c(n).executeLocal((new r).where(t,"equal",!0,!0)).length},falsecount:function(n,t){return new c(n).executeLocal((new r).where(t,"equal",!1,!0)).length},count:function(n){return n.length}},t.operatorSymbols={"<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal","==":"equal","!=":"notequal","*=":"contains","$=":"endswith","^=":"startswith"},t.odBiOperator={"<":" lt ",">":" gt ","<=":" le ",">=":" ge ","==":" eq ","!=":" ne ",lessthan:" lt ",lessthanorequal:" le ",greaterthan:" gt ",greaterthanorequal:" ge ",equal:" eq ",notequal:" ne "},t.odUniOperator={"$=":"endswith","^=":"startswith","*=":"substringof",endswith:"endswith",startswith:"startswith",contains:"substringof"},t.odv4UniOperator={"$=":"endswith","^=":"startswith","*=":"contains",endswith:"endswith",startswith:"startswith",contains:"contains"},t.diacritics={"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oi","":"ou","":"oo","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},t.fnOperators={equal:function(n,i,r,u){return u&&(n=t.ignoreDiacritics(n),i=t.ignoreDiacritics(i)),r?t.toLowerCase(n)===t.toLowerCase(i):n===i},notequal:function(n,i,r,u){return u&&(n=t.ignoreDiacritics(n),i=t.ignoreDiacritics(i)),!t.fnOperators.equal(n,i,r)},lessthan:function(n,i,r){return r?t.toLowerCase(n)<t.toLowerCase(i):(sf.base.isNullOrUndefined(n)&&(n=void 0),n<i)},greaterthan:function(n,i,r){return r?t.toLowerCase(n)>t.toLowerCase(i):n>i},lessthanorequal:function(n,i,r){return r?t.toLowerCase(n)<=t.toLowerCase(i):n<=i},greaterthanorequal:function(n,i,r){return r?t.toLowerCase(n)>=t.toLowerCase(i):n>=i},contains:function(n,i,r,u){return u&&(n=t.ignoreDiacritics(n),i=t.ignoreDiacritics(i)),r?!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(i)&&-1!==t.toLowerCase(n).indexOf(t.toLowerCase(i)):!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(i)&&-1!==n.toString().indexOf(i)},notnull:function(n){return null!==n},isnull:function(n){return null===n},startswith:function(n,i,r,u){return u&&(n=t.ignoreDiacritics(n),i=t.ignoreDiacritics(i)),r?n&&i&&t.startsWith(t.toLowerCase(n),t.toLowerCase(i)):n&&i&&t.startsWith(n,i)},endswith:function(n,i,r,u){return u&&(n=t.ignoreDiacritics(n),i=t.ignoreDiacritics(i)),r?n&&i&&t.endsWith(t.toLowerCase(n),t.toLowerCase(i)):n&&i&&t.endsWith(n,i)},processSymbols:function(n){var i=t.operatorSymbols[n];return i?t.fnOperators[i]:t.throwError("Query - Process Operator : Invalid operator")},processOperator:function(n){var i=t.fnOperators[n];return i||t.fnOperators.processSymbols(n)}},t.parse={parseJson:function(i){return"string"==typeof i?i=JSON.parse(i,t.parse.jsonReviver):_instanceof(i,Array)?t.parse.iterateAndReviveArray(i):"object"===n(i)&&null!==i&&t.parse.iterateAndReviveJson(i),i},iterateAndReviveArray:function(i){for(var r=0;r<i.length;r++)"object"===n(i[r])&&null!==i[r]?t.parse.iterateAndReviveJson(i[r]):i[r]="string"!=typeof i[r]||/^[\s]*\[|^[\s]*\{(.)+:|\"/g.test(i[r])?t.parse.parseJson(i[r]):t.parse.jsonReviver("",i[r])},iterateAndReviveJson:function(i){for(var r,u,f=0,e=Object.keys(i);f<e.length;f++)u=e[f],t.startsWith(u,"__")||("object"===n(r=i[u])?_instanceof(r,Array)?t.parse.iterateAndReviveArray(r):r&&t.parse.iterateAndReviveJson(r):i[u]=t.parse.jsonReviver(i[u],r))},jsonReviver:function(n,i){var f,s,h,r;if("string"==typeof i){if(f=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(i),s=t.timeZoneHandling?t.serverTimezoneOffset:null,f)return t.dateParse.toTimeZone(new Date(parseInt(f[1],10)),s,!0);if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(i)){if(h=i.indexOf("Z")>-1||i.indexOf("z")>-1,r=i.split(/[^0-9.]/),h)i=t.dateParse.toTimeZone(new Date(parseInt(r[0],10),parseInt(r[1],10)-1,parseInt(r[2],10),parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10)),t.serverTimezoneOffset,!1);else{var u=new Date(parseInt(r[0],10),parseInt(r[1],10)-1,parseInt(r[2],10),parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10)),e=parseInt(r[6],10),o=parseInt(r[7],10);if(isNaN(e)&&isNaN(o))return u;i.indexOf("+")>-1?u.setHours(u.getHours()-e,u.getMinutes()-o):u.setHours(u.getHours()+e,u.getMinutes()+o);i=t.dateParse.toTimeZone(u,t.serverTimezoneOffset,!1)}null==t.serverTimezoneOffset&&(i=t.dateParse.addSelfOffset(i))}}return i},isJson:function(n){return"string"==typeof n[0]?n:t.parse.parseJson(n)},isGuid:function(n){return null!=/[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i.exec(n)},replacer:function(n,i){return t.isPlainObject(n)?t.parse.jsonReplacer(n,i):_instanceof(n,Array)?t.parse.arrayReplacer(n):_instanceof(n,Date)?t.parse.jsonReplacer({val:n},i).val:n},jsonReplacer:function(n){for(var e,u,i,r=0,f=Object.keys(n);r<f.length;r++)u=f[r],_instanceof(e=n[u],Date)&&(i=e,null==t.serverTimezoneOffset?n[u]=t.dateParse.toTimeZone(i,null).toJSON():(i=new Date(+i+36e5*t.serverTimezoneOffset),n[u]=t.dateParse.toTimeZone(t.dateParse.addSelfOffset(i),null).toJSON()));return n},arrayReplacer:function(n){for(var i=0;i<n.length;i++)t.isPlainObject(n[i])?n[i]=t.parse.jsonReplacer(n[i]):_instanceof(n[i],Date)&&(n[i]=t.parse.jsonReplacer({date:n[i]}).date);return n},jsonDateReplacer:function(n,i){var u,r;return"value"===n&&i&&("string"==typeof i&&(u=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(i),u?i=t.dateParse.toTimeZone(new Date(parseInt(u[1],10)),null,!0):/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(i)&&(r=i.split(/[^0-9]/),i=t.dateParse.toTimeZone(new Date(parseInt(r[0],10),parseInt(r[1],10)-1,parseInt(r[2],10),parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10)),null,!0))),_instanceof(i,Date))?(i=t.dateParse.addSelfOffset(i),null===t.serverTimezoneOffset?t.dateParse.toTimeZone(t.dateParse.addSelfOffset(i),null).toJSON():(i=t.dateParse.toTimeZone(i,i.getTimezoneOffset()/30-t.serverTimezoneOffset,!1)).toJSON()):i}},t.dateParse={addSelfOffset:function(n){return new Date(+n-6e4*n.getTimezoneOffset())},toUTC:function(n){return new Date(+n+6e4*n.getTimezoneOffset())},toTimeZone:function(n,i,r){if(null===i)return n;var u=r?t.dateParse.toUTC(n):n;return new Date(+u-36e5*i)},toLocalTime:function(n){var t=n,r=-t.getTimezoneOffset(),u=r>=0?"+":"-",i=function(n){var t=Math.floor(Math.abs(n));return(t<10?"0":"")+t};return t.getFullYear()+"-"+i(t.getMonth()+1)+"-"+i(t.getDate())+"T"+i(t.getHours())+":"+i(t.getMinutes())+":"+i(t.getSeconds())+u+i(r/60)+":"+i(r%60)}},t}(),f=(l=function(n,t){return(l=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}l(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),b={GroupGuid:"{271bbba0-1ee7}"},a=function(){function n(t){this.options={from:"table",requestType:"json",sortBy:"sorted",select:"select",skip:"skip",group:"group",take:"take",search:"search",count:"requiresCounts",where:"where",aggregates:"aggregates",expand:"expand"};this.type=n;this.dataSource=t;this.pvt={}}return n.prototype.processResponse=function(n){return n},n}(),h=function(t){function u(){return null!==t&&t.apply(this,arguments)||this}return f(u,t),u.prototype.processQuery=function(n,t){for(var o,y,s,f,i,h,r=n.dataSource.json.slice(0),e=r.length,c=!0,l={},a=0,v=[],u=0;u<t.lazyLoad.length;u++)a++,l[t.lazyLoad[u].key]=t.lazyLoad[u].value;for(o={},u=0;u<t.queries.length;u++)"onPage"!==(i=t.queries[u]).fn&&"onGroup"!==i.fn||!t.lazyLoad.length?(f=this[i.fn].call(this,r,i.e,t),"onAggregates"===i.fn?o[i.e.field+" - "+i.e.type]=f:r=void 0!==f?f:r,"onPage"!==i.fn&&"onSkip"!==i.fn&&"onTake"!==i.fn&&"onRange"!==i.fn||(c=!1),c&&(e=r.length)):("onGroup"===i.fn&&v.push(i.e),"onPage"===i.fn&&(h=i.e));return a&&(y={query:t,lazyLoad:l,result:r,group:v,page:h},s=this.lazyLoadGroup(y),r=s.result,e=s.count),t.isCountRequired&&(r={result:r,count:e,aggregates:o}),r},u.prototype.lazyLoadGroup=function(n){var o=0,s=this.getAggregate(n.query),t=n.result,r,u,f,e;if(sf.base.isNullOrUndefined(n.lazyLoad.onDemandGroupInfo))f=n.group[0].fieldName,o=(t=i.group(t,f,s,null,null,n.group[0].comparer,!0)).length,e=t,n.page&&(t=this.onPage(t,n.page,n.query)),this.formGroupResult(t,e);else{for(r=n.lazyLoad.onDemandGroupInfo,u=r.where.length-1;u>=0;u--)t=this.onWhere(t,r.where[u]);n.group.length!==r.level&&(f=n.group[r.level].fieldName,t=i.group(t,f,s,null,null,n.group[0].comparer,!0));o=t.length;e=t;t=(t=t.slice(r.skip)).slice(0,r.take);n.group.length!==r.level&&this.formGroupResult(t,e)}return{result:t,count:o}},u.prototype.formGroupResult=function(n,t){return n.length&&t.length&&(n.GroupGuid=t.GroupGuid,n.childLevels=t.childLevels,n.level=t.level,n.records=t.records),n},u.prototype.getAggregate=function(n){var f=r.filterQueries(n.queries,"onAggregates"),e=[],t,u;if(f.length)for(t=void 0,u=0;u<f.length;u++)t=f[u].e,e.push({type:t.type,field:i.getValue(t.field,n)});return e},u.prototype.batchRequest=function(n,t,i){for(var u=t.deletedRecords.length,r=0;r<t.addedRecords.length;r++)this.insert(n,t.addedRecords[r]);for(r=0;r<t.changedRecords.length;r++)this.update(n,i.key,t.changedRecords[r]);for(r=0;r<u;r++)this.remove(n,i.key,t.deletedRecords[r]);return t},u.prototype.onWhere=function(n,t){return n&&n.length?n.filter(function(n){if(t)return t.validate(n)}):n},u.prototype.onAggregates=function(n,t){var r=i.aggregates[t.type];return n&&r&&0!==n.length?r(n,t.field):null},u.prototype.onSearch=function(n,t){return n&&n.length?(0===t.fieldNames.length&&i.getFieldList(n[0],t.fieldNames),n.filter(function(n){for(var r=0;r<t.fieldNames.length;r++)if(t.comparer.call(n,i.getObject(t.fieldNames[r],n),t.searchKey,t.ignoreCase,t.ignoreAccent))return!0;return!1})):n},u.prototype.onSortBy=function(n,t,r){var e,u,f;if(!n||!n.length)return n;if(u=i.getValue(t.fieldName,r),!u)return n.sort(t.comparer);if(_instanceof(u,Array)){for(f=(u=u.slice(0)).length-1;f>=0;f--)u[f]&&(e=t.comparer,i.endsWith(u[f]," desc")&&(e=i.fnSort("descending"),u[f]=u[f].replace(" desc","")),n=i.sort(n,u[f],e));return n}return i.sort(n,u,t.comparer)},u.prototype.onGroup=function(n,t,r){if(!n||!n.length)return n;var u=this.getAggregate(r);return i.group(n,i.getValue(t.fieldName,r),u,null,null,t.comparer)},u.prototype.onPage=function(n,t,r){var u=i.getValue(t.pageSize,r),f=(i.getValue(t.pageIndex,r)-1)*u,e=f+u;return n&&n.length?n.slice(f,e):n},u.prototype.onRange=function(n,t){return n&&n.length?n.slice(i.getValue(t.start),i.getValue(t.end)):n},u.prototype.onTake=function(n,t){return n&&n.length?n.slice(0,i.getValue(t.nos)):n},u.prototype.onSkip=function(n,t){return n&&n.length?n.slice(i.getValue(t.nos)):n},u.prototype.onSelect=function(n,t){return n&&n.length?i.select(n,i.getValue(t.fieldNames)):n},u.prototype.insert=function(n,t,i,r,u){return sf.base.isNullOrUndefined(u)?n.dataSource.json.push(t):n.dataSource.json.splice(u,0,t)},u.prototype.remove=function(t,r,u){var f,e=t.dataSource.json;for("object"!==n(u)||_instanceof(u,Date)||(u=i.getObject(r,u)),f=0;f<e.length&&i.getObject(r,e[f])!==u;f++);return f!==e.length?e.splice(f,1):null},u.prototype.update=function(n,t,i){var r,f,u=n.dataSource.json;for(sf.base.isNullOrUndefined(t)||(f=sf.base.getValue(t,i)),r=0;r<u.length&&(sf.base.isNullOrUndefined(t)||sf.base.getValue(t,u[r])!==f);r++);return r<u.length?sf.base.merge(u[r],i):null},u}(a),e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.processQuery=function(t,u,f){var o,y,h=this.getQueryRequest(u),a=r.filterQueryLists(u.queries,["onSelect","onPage","onSkip","onTake","onRange"]),it=u.params,d=t.dataSource.url,p=null,v=this.options,c={sorts:[],groups:[],filters:[],searches:[],aggregates:[]},e,w,b,g,l,s,k,nt,tt;for(("onPage"in a)?(o=a.onPage,y=((y=i.getValue(o.pageIndex,u))-1)*(p=i.getValue(o.pageSize,u))):("onRange"in a)&&(y=(o=a.onRange).start,p=o.end-o.start),e=0;e<h.sorts.length;e++)o=i.getValue(h.sorts[e].e.fieldName,u),c.sorts.push(i.callAdaptorFunction(this,"onEachSort",{name:o,direction:h.sorts[e].e.direction},u));for(f&&(o=this.getFiltersFrom(f,u))&&c.filters.push(i.callAdaptorFunction(this,"onEachWhere",o.toJson(),u)),e=0;e<h.filters.length;e++)for(w=i.callAdaptorFunction(this,"onEachWhere",h.filters[e].e.toJson(),u),this.getModuleName&&"ODataV4Adaptor"===this.getModuleName()&&!sf.base.isNullOrUndefined(h.filters[e].e.key)&&h.filters.length>1&&(w="("+w+")"),c.filters.push(w),b=0,g="object"===n(c.filters[e])?Object.keys(c.filters[e]):[];b<g.length;b++)l=g[b],i.isNull(c[l])&&delete c[l];for(e=0;e<h.searches.length;e++)o=h.searches[e].e,c.searches.push(i.callAdaptorFunction(this,"onEachSearch",{fields:o.fieldNames,operator:o.operator,key:o.searchKey,ignoreCase:o.ignoreCase},u));for(e=0;e<h.groups.length;e++)c.groups.push(i.getValue(h.groups[e].e.fieldName,u));for(e=0;e<h.aggregates.length;e++)o=h.aggregates[e].e,c.aggregates.push({type:o.type,field:i.getValue(o.field,u)});if(s={},this.getRequestQuery(v,u,a,c,s),i.callAdaptorFunction(this,"addParams",{dm:t,query:u,params:it,reqParams:s}),u.lazyLoad.length)for(e=0;e<u.lazyLoad.length;e++)s[u.lazyLoad[e].key]=u.lazyLoad[e].value;for(k=0,nt=Object.keys(s);k<nt.length;k++)l=nt[k],(i.isNull(s[l])||""===s[l]||0===s[l].length)&&delete s[l];return v.skip in s&&v.take in s||null===p||(s[v.skip]=i.callAdaptorFunction(this,"onSkip",y,u),s[v.take]=i.callAdaptorFunction(this,"onTake",p,u)),tt=this.pvt,this.pvt={},"json"===this.options.requestType?{data:JSON.stringify(s,i.parse.jsonDateReplacer),url:d,pvtData:tt,type:"POST",contentType:"application/json; charset=utf-8"}:(o=this.convertToQueryString(s,u,t),{type:"GET",url:(o=(-1!==t.dataSource.url.indexOf("?")?"&":"/")+o).length?d.replace(/\/*$/,o):d,pvtData:tt})},e.prototype.getRequestQuery=function(n,t,r,u,f){var e=f;e[n.from]=t.fromTable;n.apply&&t.distincts.length&&(e[n.apply]="onDistinct"in this?i.callAdaptorFunction(this,"onDistinct",t.distincts):"");!t.distincts.length&&n.expand&&(e[n.expand]="onExpand"in this&&"onSelect"in r?i.callAdaptorFunction(this,"onExpand",{selects:i.getValue(r.onSelect.fieldNames,t),expands:t.expands},t):t.expands);e[n.select]="onSelect"in r&&!t.distincts.length?i.callAdaptorFunction(this,"onSelect",i.getValue(r.onSelect.fieldNames,t),t):"";e[n.count]=t.isCountRequired?i.callAdaptorFunction(this,"onCount",t.isCountRequired,t):"";e[n.search]=u.searches.length?i.callAdaptorFunction(this,"onSearch",u.searches,t):"";e[n.skip]="onSkip"in r?i.callAdaptorFunction(this,"onSkip",i.getValue(r.onSkip.nos,t),t):"";e[n.take]="onTake"in r?i.callAdaptorFunction(this,"onTake",i.getValue(r.onTake.nos,t),t):"";e[n.where]=u.filters.length||u.searches.length?i.callAdaptorFunction(this,"onWhere",u.filters,t):"";e[n.sortBy]=u.sorts.length?i.callAdaptorFunction(this,"onSortBy",u.sorts,t):"";e[n.group]=u.groups.length?i.callAdaptorFunction(this,"onGroup",u.groups,t):"";e[n.aggregates]=u.aggregates.length?i.callAdaptorFunction(this,"onAggregates",u.aggregates,t):"";e.param=[]},e.prototype.convertToQueryString=function(){return""},e.prototype.processResponse=function(n,t,r,u,f,e){var a,c,o,l,s,y;u&&u.getResponseHeader("Content-Type")&&-1!==u.getResponseHeader("Content-Type").indexOf("application/json")&&(a=i.timeZoneHandling,t&&!t.timeZoneHandling&&(i.timeZoneHandling=!1),n=i.parse.parseJson(n),i.timeZoneHandling=a);var v=f,h=v.pvtData||{},p=n?n.groupDs:[];if(u&&u.getResponseHeader("Content-Type")&&-1!==u.getResponseHeader("Content-Type").indexOf("xml"))return r.isCountRequired?{result:[],count:0}:[];if(c=JSON.parse(v.data),c&&"batch"===c.action&&n&&n.addedRecords)return e.addedRecords=n.addedRecords,e;if(n&&n.d&&(n=n.d),o={},n&&"count"in n&&(o.count=n.count),o.result=n&&n.result?n.result:n,l=!1,Array.isArray(n.result)&&n.result.length&&(sf.base.isNullOrUndefined(n.result[0].key)||(o.result=this.formRemoteGroupedData(o.result,1,h.groups.length-1)),r&&r.lazyLoad.length&&h.groups.length))for(s=0;s<r.lazyLoad.length;s++)"onDemandGroupInfo"===r.lazyLoad[s].key&&(y=r.lazyLoad[s].value.level,h.groups.length===y&&(l=!0));return l||this.getAggregateResult(h,n,o,p,r),i.isNull(o.count)?o.result:{result:o.result,count:o.count,aggregates:o.aggregates}},e.prototype.formRemoteGroupedData=function(n,t,i){for(var r=0;r<n.length;r++)n[r].items.length&&Object.keys(n[r].items[0]).indexOf("key")>-1&&this.formRemoteGroupedData(n[r].items,t+1,i-1);return n.GroupGuid=b.GroupGuid,n.level=t,n.childLevels=i,n.records=n[0].items.length?this.getGroupedRecords(n,!sf.base.isNullOrUndefined(n[0].items.records)):[],n},e.prototype.getGroupedRecords=function(n,t){for(var u,r=[],i=0;i<n.length;i++)if(t)r=r.concat(n[i].items.records);else for(u=0;u<n[i].items.length;u++)r.push(n[i].items[u]);return r},e.prototype.onGroup=function(n){return this.pvt.groups=n,n},e.prototype.onAggregates=function(n){this.pvt.aggregates=n},e.prototype.batchRequest=function(n,t,r,u){return{type:"POST",url:n.dataSource.batchUrl||n.dataSource.crudUrl||n.dataSource.removeUrl||n.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(sf.base.extend({},{changed:t.changedRecords,added:t.addedRecords,deleted:t.deletedRecords,action:"batch",table:r[void 0],key:r[void 0]},i.getAddParams(this,n,u)))}},e.prototype.beforeSend=function(){},e.prototype.insert=function(n,t,r,u){return{url:n.dataSource.insertUrl||n.dataSource.crudUrl||n.dataSource.url,data:JSON.stringify(sf.base.extend({},{value:t,table:r,action:"insert"},i.getAddParams(this,n,u)))}},e.prototype.remove=function(n,t,r,u,f){return{type:"POST",url:n.dataSource.removeUrl||n.dataSource.crudUrl||n.dataSource.url,data:JSON.stringify(sf.base.extend({},{key:r,keyColumn:t,table:u,action:"remove"},i.getAddParams(this,n,f)))}},e.prototype.update=function(n,t,r,u,f){return{type:"POST",url:n.dataSource.updateUrl||n.dataSource.crudUrl||n.dataSource.url,data:JSON.stringify(sf.base.extend({},{value:r,action:"update",keyColumn:t,key:i.getObject(t,r),table:u},i.getAddParams(this,n,f)))}},e.prototype.getFiltersFrom=function(t,r){var e,o=r.fKey,s=o,c=r.key,h=[],f;for("object"!==n(t[0])&&(s=null),f=0;f<t.length;f++)e="object"===n(t[0])?i.getObject(c||s,t[f]):t[f],h.push(new u(o,"equal",e));return u.or(h)},e.prototype.getAggregateResult=function(n,t,u,f,e){var s=t,o,y,c,p;if(t&&t.result&&(s=t.result),n&&n.aggregates&&n.aggregates.length){var h=n.aggregates,l=void 0,a=s,v={};for(t.aggregate&&(a=t.aggregate),o=0;o<h.length;o++)(l=i.aggregates[h[o].type])&&(v[h[o].field+" - "+h[o].type]=l(a,h[o].field));u.aggregates=v}if(y=Array.isArray(t.result)&&t.result.length&&!sf.base.isNullOrUndefined(t.result[0].key),n&&n.groups&&n.groups.length&&!y){for(c=n.groups,o=0;o<c.length;o++)sf.base.isNullOrUndefined(f)||(f=i.group(f,c[o])),p=r.filterQueries(e.queries,"onGroup")[o].e,s=i.group(s,c[o],n.aggregates,null,f,p.comparer);u.result=s}return u},e.prototype.getQueryRequest=function(n){var t={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return t.sorts=r.filterQueries(n.queries,"onSortBy"),t.groups=r.filterQueries(n.queries,"onGroup"),t.filters=r.filterQueries(n.queries,"onWhere"),t.searches=r.filterQueries(n.queries,"onSearch"),t.aggregates=r.filterQueries(n.queries,"onAggregates"),t},e.prototype.addParams=function(n){var i=n.reqParams,r,u,t;for(n.params.length&&(i.params={}),r=0,u=n.params;r<u.length;r++){if(t=u[r],i[t.key])throw new Error("Query() - addParams: Custom Param is conflicting other request arguments");i[t.key]=t.value;t.fn&&(i[t.key]=t.fn.call(n.query,t.key,n.query,n.dm));i.params[t.key]=i[t.key]}},e}(a),o=function(t){function r(n){var i=t.call(this)||this;return i.options=sf.base.extend({},i.options,{requestType:"get",accept:"application/json;odata=light;q=1,application/json;odata=verbose;q=0.5",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$inlinecount",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PUT"}),sf.base.extend(i.options,n||{}),i}return f(r,t),r.prototype.getModuleName=function(){return"ODataAdaptor"},r.prototype.onPredicate=function(t,u,f){var c,h,o="",e=t.value,a=n(e),s=t.field?r.getField(t.field):null,l;return(_instanceof(e,Date)&&(e="datetime'"+i.parse.replacer(e)+"'"),"string"===a&&(e="'"+(e=encodeURIComponent(e))+"'",f&&(s="cast("+s+", 'Edm.String')"),i.parse.isGuid(e)&&(h="guid"),t.ignoreCase&&(h||(s="tolower("+s+")"),e=e.toLowerCase())),c=i.odBiOperator[t.operator])?(o+=s,o+=c,h&&(o+=h),o+e):("substringof"===(c=sf.base.isNullOrUndefined(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?i.odUniOperator[t.operator]:i.odv4UniOperator[t.operator])&&(l=e,e=s,s=l),o+=c+"(",o+=s+",",h&&(o+=h),o+(e+")"))},r.prototype.addParams=function(n){t.prototype.addParams.call(this,n);delete n.reqParams.params},r.prototype.onComplexPredicate=function(n,t,i){for(var u=[],r=0;r<n.predicates.length;r++)u.push("("+this.onEachWhere(n.predicates[r],t,i)+")");return u.join(" "+n.condition+" ")},r.prototype.onEachWhere=function(n,t,i){return n.isComplex?this.onComplexPredicate(n,t,i):this.onPredicate(n,t,i)},r.prototype.onWhere=function(n){return this.pvt.search&&n.push(this.onEachWhere(this.pvt.search,null,!0)),n.join(" and ")},r.prototype.onEachSearch=function(n){n.fields&&0===n.fields.length&&i.throwError("Query() - Search : oData search requires list of field names to search");for(var r=this.pvt.search||[],t=0;t<n.fields.length;t++)r.push(new u(n.fields[t],n.operator,n.key,n.ignoreCase));this.pvt.search=r},r.prototype.onSearch=function(){return this.pvt.search=u.or(this.pvt.search),""},r.prototype.onEachSort=function(n){var i=[],t;if(_instanceof(n.name,Array))for(t=0;t<n.name.length;t++)i.push(r.getField(n.name[t])+("descending"===n.direction?" desc":""));else i.push(r.getField(n.name)+("descending"===n.direction?" desc":""));return i.join(",")},r.prototype.onSortBy=function(n){return n.reverse().join(",")},r.prototype.onGroup=function(n){return this.pvt.groups=n,[]},r.prototype.onSelect=function(n){for(var t=0;t<n.length;t++)n[t]=r.getField(n[t]);return n.join(",")},r.prototype.onAggregates=function(n){return this.pvt.aggregates=n,""},r.prototype.onCount=function(n){return!0===n?"allpages":""},r.prototype.beforeSend=function(n,t,r){i.endsWith(r.url,this.options.batch)&&"post"===r.type.toLowerCase()?(t.setRequestHeader("Accept",this.options.multipartAccept),t.setRequestHeader("DataServiceVersion","2.0"),t.overrideMimeType("text/plain; charset=x-user-defined")):t.setRequestHeader("Accept",this.options.accept);t.setRequestHeader("DataServiceVersion","2.0");t.setRequestHeader("MaxDataServiceVersion","2.0")},r.prototype.processResponse=function(n,t,r,u,f,e){var l,s,h,v,a,o;if(f&&"GET"===f.type&&!this.rootUrl&&n["odata.metadata"]&&(l=n["odata.metadata"].split("/$metadata#"),this.rootUrl=l[0],this.resourceTableName=l[1]),!sf.base.isNullOrUndefined(n.d)&&(s=r&&r.isCountRequired?n.d.results:n.d,!sf.base.isNullOrUndefined(s)))for(h=0;h<s.length;h++)sf.base.isNullOrUndefined(s[h].__metadata)||delete s[h].__metadata;if(v=f&&f.pvtData,a=this.processBatchResponse(n,r,u,f,e),a)return a;var y=u&&f.getResponseHeader("DataServiceVersion"),c=null,p=y&&parseInt(y,10)||2;return r&&r.isCountRequired&&((n.__count||n["odata.count"])&&(c=n.__count||n["odata.count"]),n.d&&(n=n.d),(n.__count||n["odata.count"])&&(c=n.__count||n["odata.count"])),3===p&&n.value&&(n=n.value),n.d&&(n=n.d),p<3&&n.results&&(n=n.results),o={},o.count=c,o.result=n,this.getAggregateResult(v,n,o,null,r),i.isNull(c)?o.result:{result:o.result,count:o.count,aggregates:o.aggregates}},r.prototype.convertToQueryString=function(n,t,i){var r=[],f=n.table||"",u,e,o;for(delete n.table,i.dataSource.requiresFormat&&(n.$format="json"),u=0,e=Object.keys(n);u<e.length;u++)o=e[u],r.push(o+"="+n[o]);return r=r.join("&"),i.dataSource.url&&-1!==i.dataSource.url.indexOf("?")&&!f?r:r.length?f+"?"+r:f||""},r.prototype.localTimeReplacer=function(n,t){for(var u,r=0,f=sf.base.isNullOrUndefined(t)?[]:Object.keys(t);r<f.length;r++)u=f[r],_instanceof(t[u],Date)&&(t[u]=i.dateParse.toLocalTime(t[u]));return t},r.prototype.insert=function(n,t,i){return{url:(n.dataSource.insertUrl||n.dataSource.url).replace(/\/*$/,i?"/"+i:""),data:JSON.stringify(t,this.options.localTime?this.localTimeReplacer:null)}},r.prototype.remove=function(n,t,r,u){var f;return f="string"!=typeof r||i.parse.isGuid(r)?"("+r+")":"('"+r+"')",{type:"DELETE",url:(n.dataSource.removeUrl||n.dataSource.url).replace(/\/*$/,u?"/"+u:"")+f}},r.prototype.update=function(n,t,r,u,f,e){var o;return"PATCH"!==this.options.updateType||sf.base.isNullOrUndefined(e)||(r=this.compareAndRemove(r,e,t)),o="string"!=typeof r[t]||i.parse.isGuid(r[t])?"("+r[t]+")":"('"+r[t]+"')",{type:this.options.updateType,url:(n.dataSource.updateUrl||n.dataSource.url).replace(/\/*$/,u?"/"+u:"")+o,data:JSON.stringify(r,this.options.localTime?this.localTimeReplacer:null),accept:this.options.accept}},r.prototype.batchRequest=function(n,t,r,u,f){var s=r.guid=i.getGuid(this.options.batchPre),h=this.rootUrl?this.rootUrl+"/"+this.options.batch:n.dataSource.url.replace(/\/*$/,"/"+this.options.batch),o,e;return r.url=this.resourceTableName?this.resourceTableName:r.url,o={url:r.url,key:r.key,cid:1,cSet:i.getGuid(this.options.changeSet)},e="--"+s+"\n",e+="Content-Type: multipart/mixed; boundary="+o.cSet.replace("--","")+"\n",this.pvt.changeSet=0,e+=this.generateInsertRequest(t.addedRecords,o,n),e+=this.generateUpdateRequest(t.changedRecords,o,n,f?f.changedRecords:[]),e+=this.generateDeleteRequest(t.deletedRecords,o,n),e+=o.cSet+"--\n",{type:"POST",url:h,dataType:"json",contentType:"multipart/mixed; charset=UTF-8;boundary="+s,data:e+="--"+s+"--"}},r.prototype.generateDeleteRequest=function(n,t,r){if(!n)return"";var u={method:"DELETE ",url:function(n,t,r){var u=i.getObject(r,n[t]);return"number"==typeof u||i.parse.isGuid(u)?"("+u+")":_instanceof(u,Date)?"("+n[t][r].toJSON()+")":"('"+u+"')"},data:function(){return""}};return this.generateBodyContent(n,t,u,r)+"\n"},r.prototype.generateInsertRequest=function(n,t,i){if(!n)return"";var r={method:"POST ",url:function(){return""},data:function(n,t){return JSON.stringify(n[t])+"\n\n"}};return this.generateBodyContent(n,t,r,i)},r.prototype.generateUpdateRequest=function(n,t,r,u){var e=this,f;return n?(n.forEach(function(n){return n=e.compareAndRemove(n,u.filter(function(r){return i.getObject(t.key,r)===i.getObject(t.key,n)})[0],t.key)}),f={method:this.options.updateType+" ",url:function(n,t,r){return"number"==typeof n[t][r]||i.parse.isGuid(n[t][r])?"("+n[t][r]+")":_instanceof(n[t][r],Date)?"("+n[t][r].toJSON()+")":"('"+n[t][r]+"')"},data:function(n,t){return JSON.stringify(n[t])+"\n\n"}},this.generateBodyContent(n,t,f,r)):""},r.getField=function(n){return n.replace(/\./g,"/")},r.prototype.generateBodyContent=function(n,t,i,r){for(var u="",f=0;f<n.length;f++)u+="\n"+t.cSet+"\n",u+=this.options.changeSetContent+"\n\n",u+=i.method,"POST "===i.method?u+=(r.dataSource.insertUrl||r.dataSource.crudUrl||t.url)+i.url(n,f,t.key)+" HTTP/1.1\n":"PUT "===i.method||"PATCH "===i.method?u+=(r.dataSource.updateUrl||r.dataSource.crudUrl||t.url)+i.url(n,f,t.key)+" HTTP/1.1\n":"DELETE "===i.method&&(u+=(r.dataSource.removeUrl||r.dataSource.crudUrl||t.url)+i.url(n,f,t.key)+" HTTP/1.1\n"),u+="Accept: "+this.options.accept+"\n",u+="Content-Id: "+this.pvt.changeSet+++"\n",u+=this.options.batchChangeSetContentType+"\n",sf.base.isNullOrUndefined(n[f]["@odata.etag"])?u+="\n":(u+="If-Match: "+n[f]["@odata.etag"]+"\n\n",delete n[f]["@odata.etag"]),u+=i.data(n,f);return u},r.prototype.processBatchResponse=function(n,t,r,u,f){var s,a,o;if(r&&r.getResponseHeader("Content-Type")&&-1!==r.getResponseHeader("Content-Type").indexOf("xml"))return t.isCountRequired?{result:[],count:0}:[];if(u&&this.options.batch&&i.endsWith(u.url,this.options.batch)&&"post"===u.type.toLowerCase()){var h=r.getResponseHeader("Content-Type"),c=void 0,l=void 0,e=n+"";if(h=h.substring(h.indexOf("=batchresponse")+1),(e=e.split(h)).length<2)return{};for(e=e[1],s=/(?:\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(e),s&&e.replace(s[0],""),a=s?s[1]:"",o=(e=e.split(a)).length;o>-1;o--)/\bContent-ID:/i.test(e[o])&&/\bHTTP.+201/.test(e[o])&&(c=parseInt(/\bContent-ID: (\d+)/i.exec(e[o])[1],10),f.addedRecords[c]&&(l=i.parse.parseJson(/^\{.+\}/m.exec(e[o])[0]),sf.base.extend({},f.addedRecords[c],this.processResponse(l))));return f}return null},r.prototype.compareAndRemove=function(n,t,r){var u=this;return sf.base.isNullOrUndefined(t)||Object.keys(n).forEach(function(f){f!==r&&"@odata.etag"!==f&&(i.isPlainObject(n[f])?(u.compareAndRemove(n[f],t[f]),0===Object.keys(n[f]).filter(function(n){return"@odata.etag"!==n}).length&&delete n[f]):(n[f]===t[f]||n[f]&&t[f]&&n[f].valueOf()===t[f].valueOf())&&delete n[f])}),n},r}(e),k=function(n){function t(t){var i=n.call(this,t)||this;return i.options=sf.base.extend({},i.options,{requestType:"get",accept:"application/json, text/javascript, */*; q=0.01",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$count",search:"$search",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PATCH",localTime:!1,apply:"$apply"}),sf.base.extend(i.options,t||{}),i}return f(t,n),t.prototype.getModuleName=function(){return"ODataV4Adaptor"},t.prototype.onCount=function(n){return!0===n?"true":""},t.prototype.onPredicate=function(t,u,f){var e="",h=t.value,c=_instanceof(h,Date),s,o;if(_instanceof(u,r))for(s=this.getQueryRequest(u),o=0;o<s.filters.length;o++)s.filters[o].e.key===t.value&&(f=!0);return e=n.prototype.onPredicate.call(this,t,u,f),c&&(e=e.replace(/datetime'(.*)'$/,"$1")),i.parse.isGuid(h)&&(e=e.replace("guid","").replace(/'/g,"")),e},t.prototype.onEachSearch=function(n){var t=this.pvt.searches||[];t.push(n.key);this.pvt.searches=t},t.prototype.onSearch=function(){return this.pvt.searches.join(" OR ")},t.prototype.onExpand=function(n){var f=this,t={},i={},r=n.expands.slice(),u=[];return n.selects.filter(function(n){return n.indexOf(".")>-1}).forEach(function(n){var i=n.split(".");i[0]in t||(t[i[0]]=[]);t[i[0]].push(i[1])}),Object.keys(t).forEach(function(n){-1===r.indexOf(n)&&r.push(n)}),r.forEach(function(n){i[n]=n in t?n+"("+f.options.select+"="+t[n].join(",")+")":n}),Object.keys(i).forEach(function(n){return u.push(i[n])}),u.join(",")},t.prototype.onDistinct=function(n){return"groupby(("+n.map(function(n){return o.getField(n)}).join(",")+"))"},t.prototype.onSelect=function(t){return n.prototype.onSelect.call(this,t.filter(function(n){return-1===n.indexOf(".")}))},t.prototype.beforeSend=function(n,t,i){"POST"!==i.type&&"PUT"!==i.type&&"PATCH"!==i.type||t.setRequestHeader("Prefer","return=representation");t.setRequestHeader("Accept",this.options.accept)},t.prototype.processResponse=function(t,r,u,f,e,o){var c,a,l,h,s;return(e&&"GET"===e.type&&!this.rootUrl&&t["@odata.context"]&&(c=t["@odata.context"].split("/$metadata#"),this.rootUrl=c[0],this.resourceTableName=c[1]),a=e&&e.pvtData,l=n.prototype.processBatchResponse.call(this,t,u,f,e,o),l)?l:(h=null,u&&u.isCountRequired&&"@odata.count"in t&&(h=t["@odata.count"]),t=sf.base.isNullOrUndefined(t.value)?t:t.value,s={},s.count=h,s.result=t,this.getAggregateResult(a,t,s,null,u),i.isNull(h)?s.result:{result:s.result,count:h,aggregates:s.aggregates})},t}(o),d=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getModuleName=function(){return"WebApiAdaptor"},t.prototype.insert=function(n,t){return{type:"POST",url:n.dataSource.url,data:JSON.stringify(t)}},t.prototype.remove=function(n,t,i){return{type:"DELETE",url:n.dataSource.url+"/"+i,data:JSON.stringify(i)}},t.prototype.update=function(n,t,i){return{type:"PUT",url:n.dataSource.url,data:JSON.stringify(i)}},t.prototype.batchRequest=function(n,t,r){var c=this,e=r.guid=i.getGuid(this.options.batchPre),l=n.dataSource.url.replace(/\/*$/,"/"+this.options.batch),s,h;r.url=this.resourceTableName?this.resourceTableName:r.url;for(var u=[],a=function(i){t.addedRecords.forEach(function(f){var o=function(){return""};u.push("--"+e);u.push("Content-Type: application/http; msgtype=request","");u.push("POST /api/"+(n.dataSource.insertUrl||n.dataSource.crudUrl||r.url)+o(t.addedRecords,i,r.key)+" HTTP/1.1");u.push("Content-Type: application/json; charset=utf-8");u.push("Host: "+location.host);u.push("",f?JSON.stringify(f):"")})},f=0,o=t.addedRecords.length;f<o;f++)a(f);for(s=function(i){t.changedRecords.forEach(function(f){c.options.updateType;var o=function(){return""};u.push("--"+e);u.push("Content-Type: application/http; msgtype=request","");u.push("PUT /api/"+(n.dataSource.updateUrl||n.dataSource.crudUrl||r.url)+o(t.changedRecords,i,r.key)+" HTTP/1.1");u.push("Content-Type: application/json; charset=utf-8");u.push("Host: "+location.host);u.push("",f?JSON.stringify(f):"")})},f=0,o=t.changedRecords.length;f<o;f++)s(f);for(h=function(f){t.deletedRecords.forEach(function(o){var s=function(n,t,r){var u=i.getObject(r,n[t]);return"number"==typeof u||i.parse.isGuid(u)?"/"+u:_instanceof(u,Date)?"/"+n[t][r].toJSON():"/'"+u+"'"};u.push("--"+e);u.push("Content-Type: application/http; msgtype=request","");u.push("DELETE /api/"+(n.dataSource.removeUrl||n.dataSource.crudUrl||r.url)+s(t.deletedRecords,f,r.key)+" HTTP/1.1");u.push("Content-Type: application/json; charset=utf-8");u.push("Host: "+location.host);u.push("",o?JSON.stringify(o):"")})},f=0,o=t.deletedRecords.length;f<o;f++)h(f);return u.push("--"+e+"--",""),{type:"POST",url:l,contentType:"multipart/mixed; boundary="+e,data:u.join("\r\n")}},t.prototype.beforeSend=function(n,t){t.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01")},t.prototype.processResponse=function(n,t,r,u,f){var c=f&&f.pvtData,o=null,e={},s,h;return f&&"post"!==f.type.toLowerCase()&&(s=u&&f.getResponseHeader("DataServiceVersion"),h=s&&parseInt(s,10)||2,r&&r.isCountRequired&&(i.isNull(n.Count)||(o=n.Count)),h<3&&n.Items&&(n=n.Items),e.count=o,e.result=n,this.getAggregateResult(c,n,e,null,r)),e.result=e.result||n,i.isNull(o)?e.result:{result:e.result,count:e.count,aggregates:e.aggregates}},t}(o),g=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.processQuery=function(n,t,r){var o=(new e).processQuery(n,t,r),u=i.parse.parseJson(o.data),s={},f,h,c;if(u.param)for(f=0;f<u.param.length;f++)h=u.param[f],c=Object.keys(h)[0],s[c]=h[c];return s.value=u,{data:JSON.stringify(s),url:o.url,pvtData:o.pvtData,type:"POST",contentType:"application/json; charset=utf-8"}},t}(e),y=function(n){function t(){var t=n.call(this)||this;return sf.base.setValue("beforeSend",e.prototype.beforeSend,t),t}return f(t,n),t.prototype.insert=function(n,t,r,u,f){return this.pvt.position=f,this.updateType="add",{url:n.dataSource.insertUrl||n.dataSource.crudUrl||n.dataSource.url,data:JSON.stringify(sf.base.extend({},{value:t,table:r,action:"insert"},i.getAddParams(this,n,u)))}},t.prototype.remove=function(t,r,u,f,e){return n.prototype.remove.call(this,t,r,u),{type:"POST",url:t.dataSource.removeUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify(sf.base.extend({},{key:u,keyColumn:r,table:f,action:"remove"},i.getAddParams(this,t,e)))}},t.prototype.update=function(n,t,r,u,f){return this.updateType="update",this.updateKey=t,{type:"POST",url:n.dataSource.updateUrl||n.dataSource.crudUrl||n.dataSource.url,data:JSON.stringify(sf.base.extend({},{value:r,action:"update",keyColumn:t,key:r[t],table:u},i.getAddParams(this,n,f)))}},t.prototype.processResponse=function(t,r,u,f,e,o,s){var h;if(t="batch"===(e?JSON.parse(e.data):t).action?i.parse.parseJson(t):t,"add"===this.updateType&&n.prototype.insert.call(this,r,t,null,null,this.pvt.position),"update"===this.updateType&&n.prototype.update.call(this,r,this.updateKey,t),this.updateType=void 0,t.added)for(h=0;h<t.added.length;h++)n.prototype.insert.call(this,r,t.added[h]);if(t.changed)for(h=0;h<t.changed.length;h++)n.prototype.update.call(this,r,s.key,t.changed[h]);if(t.deleted)for(h=0;h<t.deleted.length;h++)n.prototype.remove.call(this,r,s.key,t.deleted[h]);return t},t.prototype.batchRequest=function(n,t,r,u){return{type:"POST",url:n.dataSource.batchUrl||n.dataSource.crudUrl||n.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(sf.base.extend({},{changed:t.changedRecords,added:t.addedRecords,deleted:t.deletedRecords,action:"batch",table:r.url,key:r.key},i.getAddParams(this,n,u)))}},t.prototype.addParams=function(n){(new e).addParams(n)},t}(h),p=function(n){function t(t){var i=n.call(this)||this;return i.options=sf.base.extend({},i.options,{getData:new Function,addRecord:new Function,updateRecord:new Function,deleteRecord:new Function,batchUpdate:new Function}),sf.base.extend(i.options,t||{}),i}return f(t,n),t.prototype.getModuleName=function(){return"CustomDataAdaptor"},t}(e),nt=function(n){function t(t){var i=n.call(this)||this;return i.opt=t,i.schema=i.opt.response,i.query=i.opt.query,i.getVariables=i.opt.getVariables?i.opt.getVariables:function(){},i.getQuery=function(){return i.query},i}return f(t,n),t.prototype.getModuleName=function(){return"GraphQLAdaptor"},t.prototype.processQuery=function(){var t=n.prototype.processQuery.apply(this,arguments),r=JSON.parse(t.data),u={},e="searchwhereparams",i,f;return["skip","take","sorted","table","select","where","search","requiresCounts","aggregates","params"].filter(function(n){u[n]=e.indexOf(n)>-1?JSON.stringify(r[n]):r[n]}),i=this.getVariables()||{},i.datamanager=u,f=JSON.stringify({query:this.getQuery(),variables:i}),t.data=f,t},t.prototype.processResponse=function(n,t,r,u,f){var h,e,c=n,l=sf.base.getValue(this.schema.result,c.data);this.schema.count&&(h=sf.base.getValue(this.schema.count,c.data));this.schema.aggregates&&(e=sf.base.getValue(this.schema.aggregates,c.data),e=sf.base.isNullOrUndefined(e)?e:i.parse.parseJson(e));var o=f.pvtData||{},s={result:l,aggregates:e},a=s;return o&&o.groups&&o.groups.length&&this.getAggregateResult(o,a,s,null,r),sf.base.isNullOrUndefined(h)?s.result:{result:s.result,count:h,aggregates:e}},t.prototype.insert=function(){var t=n.prototype.insert.apply(this,arguments);return this.generateCrudData(t,"insert")},t.prototype.update=function(){var t=n.prototype.update.apply(this,arguments);return this.generateCrudData(t,"update")},t.prototype.remove=function(){var t=n.prototype.remove.apply(this,arguments);return this.generateCrudData(t,"remove")},t.prototype.batchRequest=function(t,i,r){var u=n.prototype.batchRequest.apply(this,arguments),f=JSON.parse(u.data);return f.key=r.key,u.data=JSON.stringify(f),this.generateCrudData(u,"batch")},t.prototype.generateCrudData=function(n,t){var i=JSON.parse(n.data);return n.data=JSON.stringify({query:this.opt.getMutation(t),variables:i}),n},t}(e),w=function(n){function t(t,r,u){var f=n.call(this)||this,e;return f.isCrudAction=!1,f.isInsertAction=!1,sf.base.isNullOrUndefined(t)||(f.cacheAdaptor=t),f.pageSize=u,f.guidId=i.getGuid("cacheAdaptor"),window.localStorage.setItem(f.guidId,JSON.stringify({keys:[],results:[]})),e=f.guidId,sf.base.isNullOrUndefined(r)||setInterval(function(){var t,u,n,f,o;for(t=i.parse.parseJson(window.localStorage.getItem(e)),u=[],n=0;n<t.results.length;n++)f=+new Date,o=+new Date(t.results[n].timeStamp),t.results[n].timeStamp=f-o,f-o>r&&u.push(n);for(n=0;n<u.length;n++)t.results.splice(u[n],1),t.keys.splice(u[n],1);window.localStorage.removeItem(e);window.localStorage.setItem(e,JSON.stringify(t))},r),f}return f(t,n),t.prototype.generateKey=function(n,t){var f=this.getQueryRequest(t),h=r.filterQueryLists(t.queries,["onSelect","onPage","onSkip","onTake","onRange"]),u=n,e,i,o,s;for(("onPage"in h)&&(u+=h.onPage.pageIndex),f.sorts.forEach(function(n){u+=n.e.direction+n.e.fieldName}),f.groups.forEach(function(n){u+=n.e.fieldName}),f.searches.forEach(function(n){u+=n.e.searchKey}),e=0;e<f.filters.length;e++)if(i=f.filters[e],i.e.isComplex){for(o=t.clone(),o.queries=[],s=0;s<i.e.predicates.length;s++)o.queries.push({fn:"onWhere",e:i.e.predicates[s],filter:t.queries.filter});u+=i.e.condition+this.generateKey(n,o)}else u+=i.e.field+i.e.operator+i.e.value;return u},t.prototype.processQuery=function(n,t){var r,f=this.generateKey(n.dataSource.url,t),u=(r=i.parse.parseJson(window.localStorage.getItem(this.guidId)))?r.results[r.keys.indexOf(f)]:null;return null==u||this.isCrudAction||this.isInsertAction?(this.isCrudAction=null,this.isInsertAction=null,this.cacheAdaptor.processQuery.apply(this.cacheAdaptor,[].slice.call(arguments,0))):u},t.prototype.processResponse=function(n,t,r,u,f,e){if(this.isInsertAction||f&&this.cacheAdaptor.options.batch&&i.endsWith(f.url,this.cacheAdaptor.options.batch)&&"post"===f.type.toLowerCase())return this.cacheAdaptor.processResponse(n,t,r,u,f,e);n=this.cacheAdaptor.processResponse.apply(this.cacheAdaptor,[].slice.call(arguments,0));var s=r?this.generateKey(t.dataSource.url,r):t.dataSource.url,o={},h=(o=i.parse.parseJson(window.localStorage.getItem(this.guidId))).keys.indexOf(s);for(-1!==h&&(o.results.splice(h,1),o.keys.splice(h,1)),o.results[o.keys.push(s)-1]={keys:s,result:n.result,timeStamp:new Date,count:n.count};o.results.length>this.pageSize;)o.results.splice(0,1),o.keys.splice(0,1);return window.localStorage.setItem(this.guidId,JSON.stringify(o)),n},t.prototype.beforeSend=function(n,t,r){!sf.base.isNullOrUndefined(this.cacheAdaptor.options.batch)&&i.endsWith(r.url,this.cacheAdaptor.options.batch)&&"post"===r.type.toLowerCase()&&t.setRequestHeader("Accept",this.cacheAdaptor.options.multipartAccept);n.dataSource.crossDomain||t.setRequestHeader("Accept",this.cacheAdaptor.options.accept)},t.prototype.update=function(n,t,i,r){return this.isCrudAction=!0,this.cacheAdaptor.update(n,t,i,r)},t.prototype.insert=function(n,t,i){return this.isInsertAction=!0,this.cacheAdaptor.insert(n,t,i)},t.prototype.remove=function(n,t,i,r){return this.isCrudAction=!0,this.cacheAdaptor.remove(n,t,i,r)},t.prototype.batchRequest=function(n,t,i){return this.cacheAdaptor.batchRequest(n,t,i)},t}(e),c=function(){function t(t,u,f){var e,s=this;return this.dateParse=!0,this.timeZoneHandling=!0,this.requests=[],t||this.dataSource||(t=[]),f=f||t.adaptor,t&&!1===t.timeZoneHandling&&(this.timeZoneHandling=t.timeZoneHandling),_instanceof(t,Array)?e={json:t,offline:!0}:"object"===n(t)?(t.json||(t.json=[]),e={url:t.url,insertUrl:t.insertUrl,removeUrl:t.removeUrl,updateUrl:t.updateUrl,crudUrl:t.crudUrl,batchUrl:t.batchUrl,json:t.json,headers:t.headers,accept:t.accept,data:t.data,timeTillExpiration:t.timeTillExpiration,cachingPageSize:t.cachingPageSize,enableCaching:t.enableCaching,requestType:t.requestType,key:t.key,crossDomain:t.crossDomain,jsonp:t.jsonp,dataType:t.dataType,offline:void 0!==t.offline?t.offline:!(_instanceof(t.adaptor,y)||_instanceof(t.adaptor,p))&&!t.url,requiresFormat:t.requiresFormat}):i.throwError("DataManager: Invalid arguments"),void 0!==e.requiresFormat||i.isCors()||(e.requiresFormat=!!sf.base.isNullOrUndefined(e.crossDomain)||e.crossDomain),void 0===e.dataType&&(e.dataType="json"),this.dataSource=e,this.defaultQuery=u,e.url&&e.offline&&!e.json.length?(this.isDataAvailable=!1,this.adaptor=f||new o,this.dataSource.offline=!1,this.ready=this.executeQuery(u||new r),this.ready.then(function(n){s.dataSource.offline=!0;s.isDataAvailable=!0;e.json=n.result;s.adaptor=new h})):this.adaptor=e.offline?new h:new o,!e.jsonp&&_instanceof(this.adaptor,o)&&(e.jsonp="callback"),this.adaptor=f||this.adaptor,e.enableCaching&&(this.adaptor=new w(this.adaptor,e.timeTillExpiration,e.cachingPageSize)),this}return t.prototype.setDefaultQuery=function(n){return this.defaultQuery=n,this},t.prototype.executeLocal=function(n){var e,u;if(this.defaultQuery||_instanceof(n,r)||i.throwError("DataManager - executeLocal() : A query is required to execute"),this.dataSource.json||i.throwError("DataManager - executeLocal() : Json data is required to execute"),n=n||this.defaultQuery,e=this.adaptor.processQuery(this,n),n.subQuery){var o=n.subQuery.fromTable,s=n.subQuery.lookups,f=n.isCountRequired?e.result:e;for(s&&_instanceof(s,Array)&&i.buildHierarchy(n.subQuery.fKey,o,f,s,n.subQuery.key),u=0;u<f.length;u++)_instanceof(f[u][o],Array)&&(f[u]=sf.base.extend({},{},f[u]),f[u][o]=this.adaptor.processResponse(n.subQuery.using(new t(f[u][o].slice(0))).executeLocal(),this,n))}return this.adaptor.processResponse(e,this,n)},t.prototype.executeQuery=function(n,u,f,e){var l=this,h,o,c;return"function"==typeof n&&(e=f,f=u,u=n,n=null),n||(n=this.defaultQuery),_instanceof(n,r)||i.throwError("DataManager - executeQuery() : A query is required to execute"),h=new s,o={query:n},(this.dataSource.offline||void 0===this.dataSource.url||""===this.dataSource.url)&&sf.base.isNullOrUndefined(this.adaptor.makeRequest)&&!this.isCustomDataAdaptor(this.adaptor)?t.nextTick(function(){var i=l.executeLocal(n);o=t.getDeferedArgs(n,i,o);h.resolve(o)}):(c=this.adaptor.processQuery(this,n),sf.base.isNullOrUndefined(this.adaptor.makeRequest)?!sf.base.isNullOrUndefined(c.url)||this.isCustomDataAdaptor(this.adaptor)?this.makeRequest(c,h,o,n):(o=t.getDeferedArgs(n,c,o),h.resolve(o)):this.adaptor.makeRequest(c,h,o,n)),(u||f)&&h.promise.then(u,f),e&&h.promise.then(e,e),h.promise},t.getDeferedArgs=function(n,t,i){return n.isCountRequired?(i.result=t.result,i.count=t.count,i.aggregates=t.aggregates):i.result=t,i},t.nextTick=function(n){(window.setImmediate||window.setTimeout)(n,0)},t.prototype.extendRequest=function(n,t,i){return sf.base.extend({},{type:"GET",dataType:this.dataSource.dataType,crossDomain:this.dataSource.crossDomain,jsonp:this.dataSource.jsonp,cache:!0,processData:!1,onSuccess:t,onFailure:i},n)},t.prototype.makeRequest=function(n,t,r,u){var f=this,h=!!u.subQuerySelector,a=function(n){r.error=n;t.reject(r)},v=function(n,i,u,f,e,o,s){r.xhr=u;r.count=i?parseInt(i.toString(),10):0;r.result=n;r.request=f;r.aggregates=o;r.actual=e;r.virtualSelectRecords=s;t.resolve(r)},y=function(n,t){var e=new s,l={parent:r},o,c;return u.subQuery.isChild=!0,o=f.adaptor.processQuery(f,u.subQuery,n?f.adaptor.processResponse(n):t),c=f.makeRequest(o,e,l,u.subQuery),h||e.then(function(t){n&&(i.buildHierarchy(u.subQuery.fKey,u.subQuery.fromTable,n,t,u.subQuery.key),v(n,t.count,t.xhr))},a),c},e=this.extendRequest(n,function(n,t){if(f.isGraphQLAdaptor(f.adaptor)&&!sf.base.isNullOrUndefined(n.errors))return a(n.errors);f.isCustomDataAdaptor(f.adaptor)&&(t=sf.base.extend({},f.ajaxReqOption,t));-1===t.httpRequest.getResponseHeader("Content-Type").indexOf("xml")&&f.dateParse&&(n=i.parse.parseJson(n));var r=f.adaptor.processResponse(n,f,u,t.httpRequest,t),e=0,o=null,s=n.virtualSelectRecords;u.isCountRequired&&(e=r.count,o=r.aggregates,r=r.result);u.subQuery?h||y(r,t):v(r,e,t.httpRequest,t.type,n,o,s)},a),c,o,l;return this.isCustomDataAdaptor(this.adaptor)?(this.ajaxReqOption=e,c=e,this.adaptor.options.getData({data:c.data,onSuccess:c.onSuccess,onFailure:c.onFailure})):(o=new sf.base.Ajax(e),o.beforeSend=function(){f.beforeSend(o.httpRequest,o)},(e=o.send()).catch(function(){return!0}),this.requests.push(o)),h&&(l=u.subQuerySelector.call(this,{query:u.subQuery,parent:u}),l&&l.length?Promise.all([e,y(null,l)]).then(function(){for(var r,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];var s=o[0],t=f.adaptor.processResponse(s[0],f,u,f.requests[0].httpRequest,f.requests[0]),e=0;u.isCountRequired&&(e=t.count,t=t.result);r=f.adaptor.processResponse(s[1],f,u.subQuery,f.requests[1].httpRequest,f.requests[1]);e=0;u.subQuery.isCountRequired&&(e=r.count,r=r.result);i.buildHierarchy(u.subQuery.fKey,u.subQuery.fromTable,t,r,u.subQuery.key);h=!1;v(t,e,f.requests[0].httpRequest)}):h=!1),e},t.prototype.beforeSend=function(n,t){var o,i,r,u,e,f;for(this.adaptor.beforeSend(this,n,t),i=this.dataSource.headers,r=0;i&&r<i.length;r++)for(o=[],u=0,e=Object.keys(i[r]);u<e.length;u++)f=e[u],o.push(f),n.setRequestHeader(f,i[r][f])},t.prototype.saveChanges=function(n,t,i,u,f){var o=this,l,h,c,e;return(_instanceof(i,r)&&(u=i,i=null),l={url:i,key:t||this.dataSource.key},h=this.adaptor.batchRequest(this,n,l,u||new r,f),this.dataSource.offline)?h:sf.base.isNullOrUndefined(this.adaptor.doAjaxRequest)?this.isCustomDataAdaptor(this.adaptor)?this.doAjaxRequest(h,this.adaptor.options.batchUpdate):(c=new s,e=new sf.base.Ajax(h),e.beforeSend=function(){o.beforeSend(e.httpRequest,e)},e.onSuccess=function(t,i){o.isGraphQLAdaptor(o.adaptor)&&(sf.base.isNullOrUndefined(t.errors)||e.onFailure(JSON.stringify(t.errors)));c.resolve(o.adaptor.processResponse(t,o,null,i.httpRequest,i,n,l))},e.onFailure=function(n){c.reject([{error:n}])},e.send().catch(function(){return!0}),c.promise):this.adaptor.doAjaxRequest(h)},t.prototype.insert=function(n,t,i,u){_instanceof(t,r)&&(i=t,t=null);var f=this.adaptor.insert(this,n,t,i,u);return this.dataSource.offline?f:sf.base.isNullOrUndefined(this.adaptor.doAjaxRequest)?this.doAjaxRequest(f,this.adaptor.options.addRecord):this.adaptor.doAjaxRequest(f)},t.prototype.remove=function(t,u,f,e){var o,s;return("object"===n(u)&&(u=i.getObject(t,u)),_instanceof(f,r)&&(e=f,f=null),o=this.adaptor.remove(this,t,u,f,e),this.dataSource.offline)?o:sf.base.isNullOrUndefined(this.adaptor.doAjaxRequest)?(s=this.adaptor.options.deleteRecord,this.doAjaxRequest(o,s)):this.adaptor.doAjaxRequest(o)},t.prototype.update=function(n,t,i,u,f){var e,o;return(_instanceof(i,r)&&(u=i,i=null),e=this.adaptor.update(this,n,t,i,u,f),this.dataSource.offline)?e:sf.base.isNullOrUndefined(this.adaptor.doAjaxRequest)?(o=this.adaptor.options.updateRecord,this.doAjaxRequest(e,o)):this.adaptor.doAjaxRequest(e)},t.prototype.isCustomDataAdaptor=function(){return this.adaptor.getModuleName&&"CustomDataAdaptor"===this.adaptor.getModuleName()},t.prototype.isGraphQLAdaptor=function(){return this.adaptor.getModuleName&&"GraphQLAdaptor"===this.adaptor.getModuleName()},t.prototype.successFunc=function(n,t){if(this.isGraphQLAdaptor(this.adaptor)){var r=JSON.parse(n);sf.base.isNullOrUndefined(r.errors)||this.failureFunc(JSON.stringify(r.errors))}this.isCustomDataAdaptor(this.adaptor)&&(t=sf.base.extend({},this.ajaxReqOption,t));try{i.parse.parseJson(n)}catch(t){n=[]}n=this.adaptor.processResponse(i.parse.parseJson(n),this,null,t.httpRequest,t);this.ajaxDeffered.resolve(n)},t.prototype.failureFunc=function(n){this.ajaxDeffered.reject([{error:n}])},t.prototype.doAjaxRequest=function(n,t){var r=this,i;return(n=sf.base.extend({},{type:"POST",contentType:"application/json; charset=utf-8",processData:!1},n),this.ajaxDeffered=new s,this.isCustomDataAdaptor(this.adaptor))?(this.ajaxReqOption=n,t.call(this,{data:n.data,onSuccess:this.successFunc.bind(this),onFailure:this.failureFunc.bind(this)})):(i=new sf.base.Ajax(n),i.beforeSend=function(){r.beforeSend(i.httpRequest,i)},i.onSuccess=this.successFunc.bind(this),i.onFailure=this.failureFunc.bind(this),i.send().catch(function(){return!0})),this.ajaxDeffered.promise},t}(),s=function(){var n=this;this.promise=new Promise(function(t,i){n.resolve=t;n.reject=i});this.then=this.promise.then.bind(this.promise);this.catch=this.promise.catch.bind(this.promise)};return t.DataManager=c,t.Deferred=s,t.Query=r,t.Predicate=u,t.Adaptor=a,t.JsonAdaptor=h,t.UrlAdaptor=e,t.ODataAdaptor=o,t.ODataV4Adaptor=k,t.WebApiAdaptor=d,t.WebMethodAdaptor=g,t.RemoteSaveAdaptor=y,t.CustomDataAdaptor=p,t.GraphQLAdaptor=nt,t.CacheAdaptor=w,t.DataUtil=i,t};sf.data=sf.data({});sfBlazor.initBlazorAdaptor()},"./modules/fileutils.js":function(){window.sf=window.sf||{};window.sf.fileutils=function(n){"use strict";function t(n,t){if(null==n)throw new Error("ArgumentException: "+t+" cannot be null or undefined");}var i=function(){function n(){}return n.save=function(n,t){var i,r,u;if(null==n||""===n)throw new Error("ArgumentException: fileName cannot be undefined, null or empty");i=n.substring(n.lastIndexOf(".")+1,n.length);r=this.getMimeType(i);(""!==r&&(t=new Blob([t],{type:r})),this.isMicrosoftBrowser)?navigator.msSaveBlob(t,n):(u=document.createElementNS("http://www.w3.org/1999/xhtml","a"),this.saveInternal(n,i,t,u,"download"in u))},n.saveInternal=function(n,t,i,r,u){var e,o,s,f;u?(r.download=n,e=window.URL.createObjectURL(i),r.href=e,o=document.createEvent("MouseEvent"),o.initEvent("click",!0,!0),r.dispatchEvent(o),setTimeout(function(){window.URL.revokeObjectURL(e);e=void 0})):"docx"!==t&&"xlsx"!==t?(s=window.URL.createObjectURL(i),window.open(s,"_blank")||(window.location.href=s)):(f=new FileReader,f.onloadend=function(){window.open(f.result,"_blank")||(window.location.href=f.result)},f.readAsDataURL(i))},n.getMimeType=function(n){var t="";switch(n){case"html":t="text/html";break;case"pdf":t="application/pdf";break;case"docx":t="application/vnd.openxmlformats-officedocument.wordprocessingml.document";break;case"xlsx":t="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";break;case"txt":t="text/plain"}return t},n}(),o=function(){function n(){this.contentPos=0;this.bufferText="";this.bufferBlob=new Blob([""],{type:"text/plain"});this.currentState="Initial";this.namespaceStack=[];this.namespaceStack.push(new r);this.namespaceStack[0].set("xmlns","http://www.w3.org/2000/xmlns/","Special");this.namespaceStack.push(new r);this.namespaceStack[1].set("xml","http://www.w3.org/XML/1998/namespace","Special");this.namespaceStack.push(new r);this.namespaceStack[2].set("","","Implied");this.elementStack=[];this.elementStack.push(new u);this.elementStack[0].set("","","",this.namespaceStack.length-1);this.attributeStack=[];i.isMicrosoftBrowser=!!navigator.msSaveBlob}return Object.defineProperty(n.prototype,"buffer",{get:function(){return this.flush(),this.bufferBlob},enumerable:!0,configurable:!0}),n.prototype.writeProcessingInstruction=function(n,t){if(null==n||0===n.length)throw new Error("ArgumentException: name should not be undefined, null or empty");if(this.checkName(n),null==t&&(t=""),3===n.length&&"xml"===n&&"Initial"!==this.currentState)throw new Error("InvalidArgumentException: Cannot write XML declaration.WriteStartDocument method has already written it");if("Initial"!==this.currentState||void 0===this.bufferBlob)throw new Error("InvalidOperationException: Wrong Token");this.writeStartDocument();this.writeProcessingInstructionInternal(n,t)},n.prototype.writeStartDocument=function(n){if("Initial"!==this.currentState||void 0===this.bufferBlob)throw new Error("InvalidOperationException: Wrong Token");this.currentState="StartDocument";this.rawText('<?xml version="1.0" encoding="utf-8');null!=n&&(this.rawText('" standalone="'),this.rawText(n?"yes":"no"));this.rawText('"?>')},n.prototype.writeEndDocument=function(){for(;this.elementStack.length-1>0;)this.writeEndElement();this.currentState="EndDocument";this.flush()},n.prototype.writeStartElement=function(n,t,i){if(void 0===this.bufferBlob)throw new Error("InvalidOperationException: Wrong Token");if(null==t||0===t.length)throw new Error("ArgumentException: localName cannot be undefined, null or empty");if(this.checkName(t),"Initial"===this.currentState&&this.writeStartDocument(),"StartElement"===this.currentState&&this.startElementContent(),this.currentState="StartElement",null==n)null!=i&&(n=this.lookupPrefix(i)),null==n&&(n="");else if(n.length>0&&(null==i&&(i=this.lookupNamespace(n)),null==i||void 0!==i&&0===i.length))throw new Error("ArgumentException: Cannot use a prefix with an empty namespace");null==i&&(i=this.lookupNamespace(n));this.writeStartElementInternal(n,t,i)},n.prototype.writeEndElement=function(){"StartElement"===this.currentState?(this.startElementContent(),this.currentState="ElementContent"):"ElementContent"===this.currentState&&(this.currentState="ElementContent");this.currentState="EndElement";var n=this.elementStack.length-1;this.writeEndElementInternal(this.elementStack[n].prefix,this.elementStack[n].localName);this.namespaceStack.splice(this.elementStack[n].previousTop+1);this.elementStack.splice(n);this.bufferText.length>10240&&this.flush()},n.prototype.writeElementString=function(n,t,i,r){this.writeStartElement(n,t,i);null!=r&&0!==r.length&&this.writeString(r);this.writeEndElement()},n.prototype.writeAttributeString=function(n,t,i,r){this.writeStartAttribute(n,t,i,r);this.writeStringInternal(r,!0);this.writeEndAttribute()},n.prototype.writeString=function(n){this.writeInternal(n,!1)},n.prototype.writeRaw=function(n){this.writeInternal(n,!0)},n.prototype.writeInternal=function(n,t){if(null!=n){if("StartElement"!==this.currentState&&"ElementContent"!==this.currentState)throw new Error("InvalidOperationException: Wrong Token");"StartElement"===this.currentState&&this.startElementContent();this.currentState="ElementContent";t?this.rawText(n):this.writeStringInternal(n,!1)}},n.prototype.save=function(n){for(;this.elementStack.length-1>0;)this.writeEndElement();""!==this.bufferText&&this.flush();i.save(n,this.buffer)},n.prototype.destroy=function(){this.bufferBlob=void 0;for(var n=0;n<this.namespaceStack.length;n++)this.namespaceStack[n].destroy();for(this.namespaceStack=[],n=0;n<this.elementStack.length;n++)this.elementStack[n].destroy();this.elementStack=[];this.bufferText="";this.contentPos=0},n.prototype.flush=function(){void 0!==this.bufferBlob&&(this.bufferBlob=new Blob([this.bufferBlob,this.bufferText],{type:"text/plain"}),this.bufferText="")},n.prototype.writeProcessingInstructionInternal=function(n,t){this.bufferText+="<?";this.rawText(n);t.length>0&&(this.bufferText+=" ",t=t.replace(/\?\>/g,"? >"),this.bufferText+=t);this.bufferText+="?";this.bufferText+=">"},n.prototype.writeStartAttribute=function(n,t,i,r){if(null==t||0===t.length){if("xmlns"!==n)throw new Error("ArgumentException: localName cannot be undefined, null or empty");t="xmlns";n=""}if("StartElement"!==this.currentState)throw new Error("InvalidOperationException: Wrong Token");this.checkName(t);this.writeStartAttributePrefixAndNameSpace(n,t,i,r)},n.prototype.writeStartAttributePrefixAndNameSpace=function(n,t,i,r){null==n&&(null!=i&&("xmlns"===t&&"http://www.w3.org/2000/xmlns/"===i||(n=this.lookupPrefix(i))),null==n&&(n=""));null==i&&(null!=n&&n.length>0&&(i=this.lookupNamespace(n)),null==i&&(i=""));this.writeStartAttributeSpecialAttribute(n,t,i,r)},n.prototype.writeStartAttributeSpecialAttribute=function(n,t,i,r){if(0===n.length){if("x"===t[0]&&"xmlns"===t)return this.skipPushAndWrite(n,t,i),void this.pushNamespaceExplicit("",r);i.length>0&&(n=this.lookupPrefix(i))}else{if("x"===n[0]){if("xmlns"===n)return this.skipPushAndWrite(n,t,i),void this.pushNamespaceExplicit(t,r);if("xml"===n&&("space"===t||"lang"===t))return void this.skipPushAndWrite(n,t,i)}0===i.length&&(n="")}null!=n&&0!==n.length&&this.pushNamespaceImplicit(n,i);this.skipPushAndWrite(n,t,i)},n.prototype.writeEndAttribute=function(){this.currentState="StartElement";this.bufferText+='"'},n.prototype.writeStartElementInternal=function(n,t,i){var f,r;for(this.bufferText+="<",n.length>0&&(this.rawText(n),this.bufferText+=":"),this.rawText(t),f=this.elementStack.length,this.elementStack.push(new u),this.elementStack[f].set(n,t,i,this.namespaceStack.length-1),this.pushNamespaceImplicit(n,i),r=0;r<this.attributeStack.length;r++)this.attributeStack[r].destroy();this.attributeStack=[]},n.prototype.writeEndElementInternal=function(n,t){this.contentPos!==this.bufferText.length+1?(this.bufferText+="<\/",null!=n&&0!==n.length&&(this.rawText(n),this.bufferText+=":"),this.rawText(t),this.bufferText+=">"):(this.bufferText=this.bufferText.substring(0,this.bufferText.length-1),this.bufferText+=" />")},n.prototype.writeStartAttributeInternal=function(n,t){this.bufferText+=" ";null!=n&&n.length>0&&(this.rawText(n),this.bufferText+=":");this.rawText(t);this.bufferText+="=";this.bufferText+='"'},n.prototype.writeNamespaceDeclaration=function(n,t){this.writeStartNamespaceDeclaration(n);this.writeStringInternal(t,!0);this.bufferText+='"'},n.prototype.writeStartNamespaceDeclaration=function(n){null==n||0===n.length?this.rawText(' xmlns="'):(this.rawText(" xmlns:"),this.rawText(n),this.bufferText+="=",this.bufferText+='"')},n.prototype.writeStringInternal=function(n,t){null==n&&(n="");n=(n=(n=n.replace(/\&/g,"&amp;")).replace(/\</g,"&lt;")).replace(/\>/g,"&gt;");t&&(n=n.replace(/\"/g,"&quot;"));this.bufferText+=n;t||(this.contentPos=0)},n.prototype.startElementContent=function(){for(var t=this.elementStack[this.elementStack.length-1].previousTop,n=this.namespaceStack.length-1;n>t;n--)"NeedToWrite"===this.namespaceStack[n].kind&&this.writeNamespaceDeclaration(this.namespaceStack[n].prefix,this.namespaceStack[n].namespaceUri);this.bufferText+=">";this.contentPos=this.bufferText.length+1},n.prototype.rawText=function(n){this.bufferText+=n},n.prototype.addNamespace=function(n,t,i){var u=this.namespaceStack.length;this.namespaceStack.push(new r);this.namespaceStack[u].set(n,t,i)},n.prototype.lookupPrefix=function(n){for(var t=this.namespaceStack.length-1;t>=0;t--)if(this.namespaceStack[t].namespaceUri===n)return this.namespaceStack[t].prefix},n.prototype.lookupNamespace=function(n){for(var t=this.namespaceStack.length-1;t>=0;t--)if(this.namespaceStack[t].prefix===n)return this.namespaceStack[t].namespaceUri},n.prototype.lookupNamespaceIndex=function(n){for(var t=this.namespaceStack.length-1;t>=0;t--)if(this.namespaceStack[t].prefix===n)return t;return-1},n.prototype.pushNamespaceImplicit=function(n,t){var r,i=this.lookupNamespaceIndex(n);if(-1!==i){if(i>this.elementStack[this.elementStack.length-1].previousTop){if(this.namespaceStack[i].namespaceUri!==t)throw new Error("XmlException namespace Uri needs to be the same as the one that is already declared");return}if("Special"===this.namespaceStack[i].kind){if("xml"!==n)throw new Error('InvalidArgumentException: Prefix "xmlns" is reserved for use by XML.');if(t!==this.namespaceStack[i].namespaceUri)throw new Error("InvalidArgumentException: Xml String");r="Implied"}else r=this.namespaceStack[i].namespaceUri===t?"Implied":"NeedToWrite"}else{if("http://www.w3.org/XML/1998/namespace"===t&&"xml"!==n||"http://www.w3.org/2000/xmlns/"===t&&"xmlns"!==n)throw new Error("InvalidArgumentException");r="NeedToWrite"}this.addNamespace(n,t,r)},n.prototype.pushNamespaceExplicit=function(n,t){var i=this.lookupNamespaceIndex(n);-1!==i&&i>this.elementStack[this.elementStack.length-1].previousTop?this.namespaceStack[i].kind="Written":this.addNamespace(n,t,"Written")},n.prototype.addAttribute=function(n,t,i){var u=this.attributeStack.length,r;for(this.attributeStack.push(new e),this.attributeStack[u].set(n,t,i),r=0;r<u;r++)if(this.attributeStack[r].isDuplicate(n,t,i))throw new Error("XmlException: duplicate attribute name");},n.prototype.skipPushAndWrite=function(n,t,i){this.addAttribute(n,t,i);this.writeStartAttributeInternal(n,t,i)},n.prototype.checkName=function(n){if(/[ !@#$%^&*()+\=\[\]{};':"\\|,<>\/?]/.test(n))throw new Error("InvalidArgumentException: invalid name character");},n}(),r=function(){function n(){}return n.prototype.set=function(n,t,i){this.prefix=n;this.namespaceUri=t;this.kind=i},n.prototype.destroy=function(){this.prefix=void 0;this.namespaceUri=void 0;this.kind=void 0},n}(),u=function(){function n(){}return n.prototype.set=function(n,t,i,r){this.previousTop=r;this.prefix=n;this.namespaceUri=i;this.localName=t},n.prototype.destroy=function(){this.previousTop=void 0;this.prefix=void 0;this.localName=void 0;this.namespaceUri=void 0},n}(),e=function(){function n(){}return n.prototype.set=function(n,t,i){this.prefix=n;this.namespaceUri=i;this.localName=t},n.prototype.isDuplicate=function(n,t,i){return this.localName===t&&(this.prefix===n||this.namespaceUri===i)},n.prototype.destroy=function(){this.prefix=void 0;this.namespaceUri=void 0;this.localName=void 0},n}(),f=function(){function n(n){this.emitBOM=!0;this.encodingType="Ansi";this.initBOM(n)}return Object.defineProperty(n.prototype,"includeBom",{get:function(){return this.emitBOM},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return this.encodingType},set:function(n){this.encodingType=n},enumerable:!0,configurable:!0}),n.prototype.initBOM=function(n){this.emitBOM=null==n||n},n.prototype.getByteCount=function(n){return t(n,"string"),""===n?this.utf8Len(n.charCodeAt(0)):(null!==this.type&&void 0!==this.type||(this.type="Ansi"),this.getByteCountInternal(n,0,n.length))},n.prototype.utf8Len=function(n){return n<=127?1:n<=2047?2:n<=65535?3:n<=2097151?4:0},n.prototype.isHighSurrogate=function(n){return n>=55296&&n<=56319},n.prototype.toCodepoint=function(n,t){return((n=(1023&n)<<10)|1023&t)+65536},n.prototype.getByteCountInternal=function(n,t,i){var u=0,r,f,e,o,s;if("Utf8"===this.encodingType||"Unicode"===this.encodingType){for(r="Utf8"===this.encodingType,f=0;f<i;f++)e=n.charCodeAt(r?t:t++),this.isHighSurrogate(e)?r?(o=e,s=n.charCodeAt(++t),u+=this.utf8Len(this.toCodepoint(o,s))):(u+=4,++f):u+=r?this.utf8Len(e):2,r&&t++;return u}return i},n.prototype.getBytes=function(n,i,r){if(t(n,"string"),t(i,"charIndex"),t(r,"charCount"),i<0||r<0)throw new RangeError("Argument Out Of Range Exception: charIndex or charCount is less than zero");if(n.length-i<r)throw new RangeError("Argument Out Of Range Exception: charIndex and charCount do not denote a valid range in string");if(""===n)return new ArrayBuffer(0);null!==this.type&&void 0!==this.type||(this.type="Ansi");var u=this.getByteCountInternal(n,i,r);switch(this.type){case"Utf8":return this.getBytesOfUtf8Encoding(u,n,i,r);case"Unicode":return this.getBytesOfUnicodeEncoding(u,n,i,r);default:return this.getBytesOfAnsiEncoding(u,n,i,r)}},n.prototype.getString=function(n,i,r){var u,f,s,e,o,h;if(t(n,"bytes"),t(i,"index"),t(r,"count"),i<0||r<0)throw new RangeError("Argument Out Of Range Exception: index or count is less than zero");if(n.byteLength-i<r)throw new RangeError("Argument Out Of Range Exception: index and count do not denote a valid range in bytes");if(0===n.byteLength||0===r)return"";null!==this.type&&void 0!==this.type||(this.type="Ansi");u="";f=new Uint8Array(n);switch(this.type){case"Utf8":return this.getStringOfUtf8Encoding(f,i,r);case"Unicode":return s=new Uint16Array(n),this.getStringofUnicodeEncoding(s,i,r);default:for(e=i,o=0;o<r;o++)h=f[e],u+=String.fromCharCode(h),e++;return u}},n.prototype.getBytesOfAnsiEncoding=function(n,t,i,r){for(var u,f=new ArrayBuffer(n),s=new Uint8Array(f),e=0,o=0;o<r;o++)u=t.charCodeAt(i++),s[e]=u<2048?u:63,e++;return f},n.prototype.getBytesOfUtf8Encoding=function(n,t,i,r){for(var u,o=new ArrayBuffer(n),e=new Uint8Array(o),s=i,f=0,h=0;h<r;h++)u=t.charCodeAt(s),u<=127?e[f]=u:u<2048?(e[f]=192|u>>6,e[++f]=128|63&u):u<55296||u>=57344?(e[f]=224|u>>12,e[++f]=128|u>>6&63,e[++f]=128|63&u):(e[f]=239,e[++f]=191,e[++f]=189),++f,++s;return o},n.prototype.getBytesOfUnicodeEncoding=function(n,t,i,r){for(var e,f=new ArrayBuffer(n),o=new Uint16Array(f),u=0;u<r;u++)e=t.charCodeAt(u),o[u]=e;return f},n.prototype.getStringOfUtf8Encoding=function(n,t,i){for(var r,e=0,u=t,f="";e<i;e++){for(r=n[u++];u>n.length;)return f;r>127&&(r>191&&r<224&&u<i?r=(31&r)<<6|63&n[u]:r>223&&r<240&&u<n.byteLength?r=(15&r)<<12|(63&n[u])<<6|63&n[++u]:r>239&&r<248&&u<n.byteLength&&(r=(7&r)<<18|(63&n[u])<<12|(63&n[++u])<<6|63&n[++u]),++u);f+=String.fromCharCode(r)}return f},n.prototype.getStringofUnicodeEncoding=function(n,t,i){if(i>n.length)throw new RangeError("ArgumentOutOfRange_Count");for(var u=new Uint16Array(i),r=0;r<i&&r<n.length;r++)u[r]=n[t++];return String.fromCharCode.apply(null,u)},n.prototype.destroy=function(){this.emitBOM=void 0;this.encodingType=void 0},n}(),s=function(){function n(n){this.bufferBlob=new Blob([""]);this.bufferText="";this.init(n);i.isMicrosoftBrowser=!!navigator.msSaveBlob}return Object.defineProperty(n.prototype,"buffer",{get:function(){return this.flush(),this.bufferBlob},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"encoding",{get:function(){return this.enc},enumerable:!0,configurable:!0}),n.prototype.init=function(n){null==n?(this.enc=new f(!1),this.enc.type="Utf8"):(this.enc=n,this.setBomByte())},n.prototype.setBomByte=function(){var t,i,r,n;if(this.encoding.includeBom)switch(this.encoding.type){case"Unicode":t=new ArrayBuffer(2);i=new Uint8Array(t);i[0]=255;i[1]=254;this.bufferBlob=new Blob([t]);break;case"Utf8":r=new ArrayBuffer(3);n=new Uint8Array(r);n[0]=239;n[1]=187;n[2]=191;this.bufferBlob=new Blob([r]);break;default:this.bufferBlob=new Blob([""])}},n.prototype.save=function(n){""!==this.bufferText&&this.flush();i.save(n,this.buffer)},n.prototype.write=function(n){if(void 0===this.encoding)throw new Error("Object Disposed Exception: current writer is disposed");t(n,"string");this.bufferText+=n;this.bufferText.length>=10240&&this.flush()},n.prototype.flush=function(){if(void 0!==this.bufferText&&null!==this.bufferText&&0!==this.bufferText.length){var n=this.encoding.getBytes(this.bufferText,0,this.bufferText.length);this.bufferText="";this.bufferBlob=new Blob([this.bufferBlob,n])}},n.prototype.writeLine=function(n){if(void 0===this.encoding)throw new Error("Object Disposed Exception: current writer is disposed");t(n,"string");this.bufferText=this.bufferText+n+"\r\n";this.bufferText.length>=10240&&this.flush()},n.prototype.destroy=function(){this.bufferBlob=void 0;this.bufferText=void 0;_instanceof(this.enc,f)&&this.enc.destroy();this.enc=void 0},n}();return n.XmlWriter=o,n.Namespace=r,n.XmlElement=u,n.XmlAttribute=e,n.StreamWriter=s,n.Encoding=f,n.validateNullOrUndefined=t,n.Save=i,n}({})},"./modules/navigationsbase.js":function(){function n(t){return(n="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(n){return _typeof2(n)}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":_typeof2(n)})(t)}window.sf=window.sf||{};window.sf.navigations=window.sf.base.extend({},window.sf.navigations,function(t){"use strict";function s(n,t,i,r,u,e){var s=n("div",{className:"e-menu-"+r});return t.appendChild(s),s.appendChild(i),e?(s.style.overflow="hidden",s.style.height=e+"px"):(s.style.maxHeight=t.style.maxHeight,t.style.overflow="hidden"),"vscroll"===r?new o({enableRtl:u},s).scrollStep=sf.base.select(".e-"+r+"-bar",t).offsetHeight/2:new f({enableRtl:u},s).scrollStep=sf.base.select(".e-"+r+"-bar",t).offsetWidth,s}var i,r,h=(i=function(n,t){return(i=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function r(){this.constructor=n}i(n,t);n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},f=function(n){function t(t,i){return n.call(this,t,i)||this}return h(t,n),t.prototype.preRender=function(){this.browser=sf.base.Browser.info.name;this.browserCheck="mozilla"===this.browser;this.isDevice=sf.base.Browser.isDevice;this.customStep=!0;var n=this.element;this.ieCheck="edge"===this.browser||"msie"===this.browser;this.initialize();""===n.id&&(n.id=sf.base.getUniqueID("hscroll"),this.uniqueId=!0);n.style.display="block";this.enableRtl&&n.classList.add("e-rtl")},t.prototype.render=function(){this.touchModule=new sf.base.Touch(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)});sf.base.EventHandler.add(this.scrollEle,"scroll",this.scrollHandler,this);this.isDevice?(this.element.classList.add("e-scroll-device"),this.createOverlay(this.element)):this.createNavIcon(this.element);this.setScrollState()},t.prototype.setScrollState=function(){sf.base.isNullOrUndefined(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetWidth,this.customStep=!1):this.customStep=!0},t.prototype.initialize=function(){var t=this.createElement("div",{className:"e-hscroll-content"}),n=this.createElement("div",{className:"e-hscroll-bar"}),f;n.setAttribute("tabindex","-1");for(var r=this.element,i=0,u=[].slice.call(r.children);i<u.length;i++)f=u[i],t.appendChild(f);n.appendChild(t);r.appendChild(n);n.style.overflowX="hidden";this.scrollEle=n;this.scrollItems=t},t.prototype.getPersistData=function(){return this.addOnPersist(["scrollStep"])},t.prototype.getModuleName=function(){return"hScroll"},t.prototype.destroy=function(){var t=this.element,i,f,r,u,e;for(t.style.display="",t.classList.remove("e-hscroll"),t.classList.remove("e-scroll-device"),i=sf.base.selectAll(".e-"+t.id+"_nav.e-scroll-nav",t),f=sf.base.selectAll(".e-scroll-overlay",t),[].slice.call(f).forEach(function(n){sf.base.detach(n)}),r=0,u=[].slice.call(this.scrollItems.children);r<u.length;r++)e=u[r],t.appendChild(e);this.uniqueId&&this.element.removeAttribute("id");sf.base.detach(this.scrollEle);i.length>0&&(sf.base.detach(i[0]),sf.base.isNullOrUndefined(i[1])||sf.base.detach(i[1]));sf.base.EventHandler.remove(this.scrollEle,"scroll",this.scrollHandler);this.touchModule.destroy();this.touchModule=null;n.prototype.destroy.call(this)},t.prototype.disable=function(n){var t=sf.base.selectAll(".e-scroll-nav:not(.e-overlay)",this.element);n?this.element.classList.add("e-overlay"):this.element.classList.remove("e-overlay");[].slice.call(t).forEach(function(t){t.setAttribute("tabindex",n?"-1":"0")})},t.prototype.createOverlay=function(n){var r=n.id.concat("_nav"),u=this.createElement("div",{className:"e-scroll-overlay e-scroll-right-overlay"}),f="e-"+n.id.concat("_nav e-scroll-nav e-scroll-right-nav"),t=this.createElement("div",{id:r.concat("_right"),className:f}),e=this.createElement("div",{className:"e-nav-right-arrow e-nav-arrow e-icons"}),i;t.appendChild(e);i=this.createElement("div",{className:"e-scroll-overlay e-scroll-left-overlay"});this.ieCheck&&t.classList.add("e-ie-align");n.appendChild(u);n.appendChild(t);n.insertBefore(i,n.firstChild);this.eventBinding([t])},t.prototype.createNavIcon=function(n){var r=n.id.concat("_nav"),f="e-"+n.id.concat("_nav e-scroll-nav e-scroll-right-nav"),t=this.createElement("div",{id:r.concat("_right"),className:f}),u;t.setAttribute("aria-disabled","false");var e=this.createElement("div",{className:"e-nav-right-arrow e-nav-arrow e-icons"}),o="e-"+n.id.concat("_nav e-scroll-nav e-scroll-left-nav"),i=this.createElement("div",{id:r.concat("_left"),className:o+" e-overlay"});i.setAttribute("aria-disabled","true");u=this.createElement("div",{className:"e-nav-left-arrow e-nav-arrow e-icons"});i.appendChild(u);t.appendChild(e);n.appendChild(t);n.insertBefore(i,n.firstChild);this.ieCheck&&(t.classList.add("e-ie-align"),i.classList.add("e-ie-align"));this.eventBinding([t,i])},t.prototype.onKeyPress=function(n){var t=this;"Enter"===n.key&&(this.keyTimer=window.setTimeout(function(){t.keyTimeout=!0;t.eleScrolling(10,n.target,!0)},100))},t.prototype.onKeyUp=function(n){"Enter"===n.key&&(this.keyTimeout?this.keyTimeout=!1:n.target.click(),clearTimeout(this.keyTimer))},t.prototype.eventBinding=function(n){var t=this;[].slice.call(n).forEach(function(n){new sf.base.Touch(n,{tapHold:t.tabHoldHandler.bind(t),tapHoldThreshold:500});n.addEventListener("keydown",t.onKeyPress.bind(t));n.addEventListener("keyup",t.onKeyUp.bind(t));n.addEventListener("mouseup",t.repeatScroll.bind(t));n.addEventListener("touchend",t.repeatScroll.bind(t));n.addEventListener("contextmenu",function(n){n.preventDefault()});sf.base.EventHandler.add(n,"click",t.clickEventHandler,t)})},t.prototype.repeatScroll=function(){clearInterval(this.timeout)},t.prototype.tabHoldHandler=function(n){var i=this,t=n.originalEvent.target;t=this.contains(t,"e-scroll-nav")?t.firstElementChild:t;this.timeout=window.setInterval(function(){i.eleScrolling(10,t,!0)},50)},t.prototype.contains=function(n,t){return n.classList.contains(t)},t.prototype.eleScrolling=function(n,t,i){var u=this.element,r=t.classList;r.contains("e-scroll-nav")&&(r=t.querySelector(".e-nav-arrow").classList);this.contains(u,"e-rtl")&&this.browserCheck&&(n=-n);!this.contains(u,"e-rtl")||this.browserCheck||this.ieCheck?r.contains("e-nav-right-arrow")?this.frameScrollRequest(n,"add",i):this.frameScrollRequest(n,"",i):r.contains("e-nav-left-arrow")?this.frameScrollRequest(n,"add",i):this.frameScrollRequest(n,"",i)},t.prototype.clickEventHandler=function(n){this.eleScrolling(this.scrollStep,n.target,!1)},t.prototype.swipeHandler=function(n){var t,r=this.scrollEle,i;t=n.velocity<=1?n.distanceX/(10*n.velocity):n.distanceX/n.velocity;i=.5;!function u(){var f=Math.sin(i);f<=0?window.cancelAnimationFrame(f):("Left"===n.swipeDirection?r.scrollLeft+=t*f:"Right"===n.swipeDirection&&(r.scrollLeft-=t*f),i-=.5,window.requestAnimationFrame(u))}()},t.prototype.scrollUpdating=function(n,t){"add"===t?this.scrollEle.scrollLeft+=n:this.scrollEle.scrollLeft-=n},t.prototype.frameScrollRequest=function(n,t,i){var r=this;i?this.scrollUpdating(n,t):(this.customStep||[].slice.call(sf.base.selectAll(".e-scroll-overlay",this.element)).forEach(function(t){n-=t.offsetWidth}),!function i(){var f,u;r.contains(r.element,"e-rtl")&&r.browserCheck?(f=-n,u=-10):(f=n,u=10);f<10?window.cancelAnimationFrame(u):(r.scrollUpdating(u,t),n-=u,window.requestAnimationFrame(i))}())},t.prototype.touchHandler=function(n){var t=this.scrollEle,i=n.distanceX;this.ieCheck&&this.contains(this.element,"e-rtl")&&(i=-i);"Left"===n.scrollDirection?t.scrollLeft=t.scrollLeft+i:"Right"===n.scrollDirection&&(t.scrollLeft=t.scrollLeft-i)},t.prototype.arrowDisabling=function(n,t){if(this.isDevice){var i=(sf.base.isNullOrUndefined(n)?t:n).querySelector(".e-nav-arrow");sf.base.isNullOrUndefined(n)?sf.base.classList(i,["e-nav-right-arrow"],["e-nav-left-arrow"]):sf.base.classList(i,["e-nav-left-arrow"],["e-nav-right-arrow"])}else n.classList.add("e-overlay"),n.setAttribute("aria-disabled","true"),n.removeAttribute("tabindex"),t.classList.remove("e-overlay"),t.setAttribute("aria-disabled","false"),t.setAttribute("tabindex","0");this.repeatScroll()},t.prototype.scrollHandler=function(n){var i=n.target,u=i.offsetWidth,f=(this.element,this.element.querySelector(".e-scroll-left-nav")),e=this.element.querySelector(".e-scroll-right-nav"),o=this.element.querySelector(".e-scroll-left-overlay"),s=this.element.querySelector(".e-scroll-right-overlay"),t=i.scrollLeft,r;(t<=0&&(t=-t),this.isDevice&&(!this.enableRtl||this.browserCheck||this.ieCheck||(o=this.element.querySelector(".e-scroll-right-overlay"),s=this.element.querySelector(".e-scroll-left-overlay")),o.style.width=t<40?t+"px":"40px",s.style.width=i.scrollWidth-Math.ceil(u+t)<40?i.scrollWidth-Math.ceil(u+t)+"px":"40px"),0===t)?this.arrowDisabling(f,e):Math.ceil(u+t+.1)>=i.scrollWidth?this.arrowDisabling(e,f):(r=this.element.querySelector(".e-scroll-nav.e-overlay"),r&&(r.classList.remove("e-overlay"),r.setAttribute("aria-disabled","false"),r.setAttribute("tabindex","0")))},t.prototype.onPropertyChanged=function(n){for(var t=0,i=Object.keys(n);t<i.length;t++)switch(i[t]){case"scrollStep":this.setScrollState();break;case"enableRtl":n.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}},u([sf.base.Property(null)],t.prototype,"scrollStep",void 0),t=u([sf.base.NotifyPropertyChanges],t)}(sf.base.Component),c=(r=function(n,t){return(r=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),e=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},o=function(n){function t(t,i){return n.call(this,t,i)||this}return c(t,n),t.prototype.preRender=function(){this.browser=sf.base.Browser.info.name;this.browserCheck="mozilla"===this.browser;this.isDevice=sf.base.Browser.isDevice;this.customStep=!0;var n=this.element;this.ieCheck="edge"===this.browser||"msie"===this.browser;this.initialize();""===n.id&&(n.id=sf.base.getUniqueID("vscroll"),this.uniqueId=!0);n.style.display="block";this.enableRtl&&n.classList.add("e-rtl")},t.prototype.render=function(){this.touchModule=new sf.base.Touch(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)});sf.base.EventHandler.add(this.scrollEle,"scroll",this.scrollEventHandler,this);this.isDevice?(this.element.classList.add("e-scroll-device"),this.createOverlayElement(this.element)):this.createNavIcon(this.element);this.setScrollState();sf.base.EventHandler.add(this.element,"wheel",this.wheelEventHandler,this)},t.prototype.setScrollState=function(){sf.base.isNullOrUndefined(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetHeight,this.customStep=!1):this.customStep=!0},t.prototype.initialize=function(){var t=sf.base.createElement("div",{className:"e-vscroll-content"}),n=sf.base.createElement("div",{className:"e-vscroll-bar"}),f;n.setAttribute("tabindex","-1");for(var r=this.element,i=0,u=[].slice.call(r.children);i<u.length;i++)f=u[i],t.appendChild(f);n.appendChild(t);r.appendChild(n);n.style.overflowY="hidden";this.scrollEle=n;this.scrollItems=t},t.prototype.getPersistData=function(){return this.addOnPersist(["scrollStep"])},t.prototype.getModuleName=function(){return"vScroll"},t.prototype.destroy=function(){var t=this.element,i,f,r,u,e;for(t.style.display="",sf.base.removeClass([this.element],["e-vscroll","e-scroll-device"]),i=sf.base.selectAll(".e-"+t.id+"_nav.e-scroll-nav",t),f=sf.base.selectAll(".e-scroll-overlay",t),[].slice.call(f).forEach(function(n){sf.base.detach(n)}),r=0,u=[].slice.call(this.scrollItems.children);r<u.length;r++)e=u[r],t.appendChild(e);this.uniqueId&&this.element.removeAttribute("id");sf.base.detach(this.scrollEle);i.length>0&&(sf.base.detach(i[0]),sf.base.isNullOrUndefined(i[1])||sf.base.detach(i[1]));sf.base.EventHandler.remove(this.scrollEle,"scroll",this.scrollEventHandler);this.touchModule.destroy();this.touchModule=null;n.prototype.destroy.call(this)},t.prototype.disable=function(n){var t=sf.base.selectAll(".e-scroll-nav:not(.e-overlay)",this.element);n?this.element.classList.add("e-overlay"):this.element.classList.remove("e-overlay");[].slice.call(t).forEach(function(t){t.setAttribute("tabindex",n?"-1":"0")})},t.prototype.createOverlayElement=function(n){var r=n.id.concat("_nav"),u=sf.base.createElement("div",{className:"e-scroll-overlay e-scroll-down-overlay"}),f="e-"+n.id.concat("_nav e-scroll-nav e-scroll-down-nav"),t=sf.base.createElement("div",{id:r.concat("down"),className:f}),e=sf.base.createElement("div",{className:"e-nav-down-arrow e-nav-arrow e-icons"}),i;t.appendChild(e);i=sf.base.createElement("div",{className:"e-scroll-overlay e-scroll-up-overlay"});this.ieCheck&&t.classList.add("e-ie-align");n.appendChild(u);n.appendChild(t);n.insertBefore(i,n.firstChild);this.eventBinding([t])},t.prototype.createNavIcon=function(n){var r=n.id.concat("_nav"),f="e-"+n.id.concat("_nav e-scroll-nav e-scroll-down-nav"),t=sf.base.createElement("div",{id:r.concat("_down"),className:f}),u;t.setAttribute("aria-disabled","false");var e=sf.base.createElement("div",{className:"e-nav-down-arrow e-nav-arrow e-icons"}),o="e-"+n.id.concat("_nav e-scroll-nav e-scroll-up-nav"),i=sf.base.createElement("div",{id:r.concat("_up"),className:o+" e-overlay"});i.setAttribute("aria-disabled","true");u=sf.base.createElement("div",{className:"e-nav-up-arrow e-nav-arrow e-icons"});i.appendChild(u);t.appendChild(e);t.setAttribute("tabindex","0");n.appendChild(t);n.insertBefore(i,n.firstChild);this.ieCheck&&(t.classList.add("e-ie-align"),i.classList.add("e-ie-align"));this.eventBinding([t,i])},t.prototype.onKeyPress=function(n){var t=this;"Enter"===n.key&&(this.keyTimer=window.setTimeout(function(){t.keyTimeout=!0;t.eleScrolling(10,n.target,!0)},100))},t.prototype.onKeyUp=function(n){"Enter"===n.key&&(this.keyTimeout?this.keyTimeout=!1:n.target.click(),clearTimeout(this.keyTimer))},t.prototype.eventBinding=function(n){var t=this;[].slice.call(n).forEach(function(n){new sf.base.Touch(n,{tapHold:t.tabHoldHandler.bind(t),tapHoldThreshold:500});n.addEventListener("keydown",t.onKeyPress.bind(t));n.addEventListener("keyup",t.onKeyUp.bind(t));n.addEventListener("mouseup",t.repeatScroll.bind(t));n.addEventListener("touchend",t.repeatScroll.bind(t));n.addEventListener("contextmenu",function(n){n.preventDefault()});sf.base.EventHandler.add(n,"click",t.clickEventHandler,t)})},t.prototype.repeatScroll=function(){clearInterval(this.timeout)},t.prototype.tabHoldHandler=function(n){var i=this,t=n.originalEvent.target;t=this.contains(t,"e-scroll-nav")?t.firstElementChild:t;this.timeout=window.setInterval(function(){i.eleScrolling(10,t,!0)},50)},t.prototype.contains=function(n,t){return n.classList.contains(t)},t.prototype.eleScrolling=function(n,t,i){var r=t.classList;r.contains("e-scroll-nav")&&(r=t.querySelector(".e-nav-arrow").classList);r.contains("e-nav-down-arrow")?this.frameScrollRequest(n,"add",i):r.contains("e-nav-up-arrow")&&this.frameScrollRequest(n,"",i)},t.prototype.clickEventHandler=function(n){this.eleScrolling(this.scrollStep,n.target,!1)},t.prototype.wheelEventHandler=function(n){n.preventDefault();this.frameScrollRequest(this.scrollStep,n.deltaY>0?"add":"",!1)},t.prototype.swipeHandler=function(n){var t,r=this.scrollEle,i;t=n.velocity<=1?n.distanceY/(10*n.velocity):n.distanceY/n.velocity;i=.5;!function u(){var f=Math.sin(i);f<=0?window.cancelAnimationFrame(f):("Up"===n.swipeDirection?r.scrollTop+=t*f:"Down"===n.swipeDirection&&(r.scrollTop-=t*f),i-=.02,window.requestAnimationFrame(u))}()},t.prototype.scrollUpdating=function(n,t){"add"===t?this.scrollEle.scrollTop+=n:this.scrollEle.scrollTop-=n},t.prototype.frameScrollRequest=function(n,t,i){var r=this;i?this.scrollUpdating(n,t):(this.customStep||[].slice.call(sf.base.selectAll(".e-scroll-overlay",this.element)).forEach(function(t){n-=t.offsetHeight}),!function i(){n<10?window.cancelAnimationFrame(10):(r.scrollUpdating(10,t),n-=10,window.requestAnimationFrame(i))}())},t.prototype.touchHandler=function(n){var t=this.scrollEle,i=n.distanceY;"Up"===n.scrollDirection?t.scrollTop=t.scrollTop+i:"Down"===n.scrollDirection&&(t.scrollTop=t.scrollTop-i)},t.prototype.arrowDisabling=function(n,t){if(this.isDevice){var i=(sf.base.isNullOrUndefined(n)?t:n).querySelector(".e-nav-arrow");sf.base.isNullOrUndefined(n)?sf.base.classList(i,["e-nav-down-arrow"],["e-nav-up-arrow"]):sf.base.classList(i,["e-nav-up-arrow"],["e-nav-down-arrow"])}else n.classList.add("e-overlay"),n.setAttribute("aria-disabled","true"),n.removeAttribute("tabindex"),t.classList.remove("e-overlay"),t.setAttribute("aria-disabled","false"),t.setAttribute("tabindex","0");this.repeatScroll()},t.prototype.scrollEventHandler=function(n){var i=n.target,u=i.offsetHeight,f=this.element.querySelector(".e-scroll-up-nav"),e=this.element.querySelector(".e-scroll-down-nav"),o=this.element.querySelector(".e-scroll-up-overlay"),s=this.element.querySelector(".e-scroll-down-overlay"),t=i.scrollTop,r;(t<=0&&(t=-t),this.isDevice&&(o.style.height=t<40?t+"px":"40px",s.style.height=i.scrollHeight-Math.ceil(u+t)<40?i.scrollHeight-Math.ceil(u+t)+"px":"40px"),0===t)?this.arrowDisabling(f,e):Math.ceil(u+t+.1)>=i.scrollHeight?this.arrowDisabling(e,f):(r=this.element.querySelector(".e-scroll-nav.e-overlay"),r&&(r.classList.remove("e-overlay"),r.setAttribute("aria-disabled","false"),r.setAttribute("tabindex","0")))},t.prototype.onPropertyChanged=function(n){for(var t=0,i=Object.keys(n);t<i.length;t++)switch(i[t]){case"scrollStep":this.setScrollState();break;case"enableRtl":n.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}},e([sf.base.Property(null)],t.prototype,"scrollStep",void 0),t=e([sf.base.NotifyPropertyChanges],t)}(sf.base.Component);return t.HScroll=f,t.VScroll=o,t.addScrolling=function(n,t,i,r,u,f){var e,o,c=t.parentElement,h;return("vscroll"===r?(e=f||t.getBoundingClientRect().height,o=i.getBoundingClientRect().height):(e=t.getBoundingClientRect().width,o=i.getBoundingClientRect().width),e<o)?s(n,t,i,r,u,f):c?(h=c.getBoundingClientRect().width,h<e&&"hscroll"===r?(o=h,t.style.maxWidth=h+"px",s(n,t,i,r,u,f)):i):i},t.destroyScroll=function(n,t,i){if(n){var r=sf.base.select(".e-menu-parent",t);r?i&&i!==r||(n.destroy(),t.parentElement.appendChild(r),sf.base.detach(t)):(n.destroy(),sf.base.detach(t))}},t}({}))},"./modules/officechart.js":function(){window.sf=window.sf||{};window.sf.officechart=function(n){"use strict";sf.charts.Chart.Inject(sf.charts.AreaSeries,sf.charts.StackingAreaSeries,sf.charts.BarSeries,sf.charts.PieSeries,sf.charts.StackingBarSeries,sf.charts.PolarSeries,sf.charts.ScatterSeries,sf.charts.BubbleSeries,sf.charts.RadarSeries,sf.charts.DateTime,sf.charts.ColumnSeries,sf.charts.StackingColumnSeries,sf.charts.LineSeries,sf.charts.StackingLineSeries,sf.charts.ErrorBar,sf.charts.Trendlines,sf.charts.SplineSeries,sf.charts.DataLabel,sf.charts.Category,sf.charts.Legend,sf.charts.Tooltip,sf.charts.Export);sf.charts.AccumulationChart.Inject(sf.charts.AccumulationLegend,sf.charts.PieSeries,sf.charts.AccumulationTooltip,sf.charts.AccumulationDataLabel);var t=function(){function n(){}return n.prototype.chartRender=function(n){var r,i,t;for(this.chartType=n.chartType,this.isPieType="Pie"===this.chartType||"Doughnut"===this.chartType,r=this.chartData(n,this.chartType),i={enableAnimation:!1,width:n.width*(96/72)+"px",height:n.height*(96/72)+"px"},this.isPieType?this.chart=new sf.charts.AccumulationChart(i):(this.chart=new sf.charts.Chart(i),this.chart.primaryXAxis=this.chartPrimaryXAxis(n.chartPrimaryCategoryAxis,this.chartType),this.chart.primaryYAxis=this.chartPrimaryYAxis(n.chartPrimaryValueAxis)),this.chart.series=this.chartSeries(n.chartSeries,r,this.chartType),t=0;t<this.chart.series.length;t++)this.chart.series[t].animation.enable=!1;this.chart.title=n.chartTitle;this.chart.legendSettings=this.parseChartLegend(n.chartLegend)},n.prototype.convertChartToImage=function(n,t,i){var r=this;return new Promise(function(u,f){var s=0,h=0,l=r.getControlsValue([n],t,i),e,o;s=s||l.width;h=h||l.height;e=sf.base.createElement("canvas");o=Math.max(1,window.devicePixelRatio||1);e.width=s*o;e.height=h*o;e.style.width=s+"px";e.style.height=h+"px";var a=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(l.svg)],{type:"image/svg+xml"})),c=new Image,v=e.getContext("2d");v.scale(o,o);c.onload=function(){v.drawImage(c,0,0);window.URL.revokeObjectURL(a);var n=e.toDataURL("image/png");u(n)};c.onerror=function(){f("Invalid data")};c.src=a})},n.prototype.getControlsValue=function(n,t){var u=0,i=0,r=new sf.svgbase.SvgRenderer("").createSvg({id:"Image_Export",width:200,height:200});return n.map(function(n){if(n){var e=n.svgObject.cloneNode(!0),f=n.renderer.createGroup({style:"transform: translateY("+i+"px)"});f.appendChild(e);u=Math.max(n.availableSize.width,t);i+=n.availableSize.height;n.svgObject.outerHTML;r.appendChild(f)}}),r.setAttribute("width",u+""),r.setAttribute("height",i+""),{width:u,height:i,svg:r}},n.prototype.officeChartType=function(n){var t="";switch(n){case"Area_Stacked":t="StackingArea";break;case"Area":t="Area";break;case"Area_Stacked_100":t="StackingArea100";break;case"Bar_Clustered":t="Bar";break;case"Bar_Stacked":t="StackingBar";break;case"Bar_Stacked_100":t="StackingBar100";break;case"Column_Clustered":t="Column";break;case"Column_Stacked":t="StackingColumn";break;case"Column_Stacked_100":t="StackingColumn100";break;case"Scatter_Markers":t="Scatter";break;case"Bubble":t="Bubble";break;case"Doughnut":case"Pie":t="Pie";break;case"Line_Stacked_100":case"Line_Markers_Stacked_100":t="StackingLine100";break;case"Line":case"Line_Markers":t="Line";break;case"Line_Stacked":case"Line_Markers_Stacked":t="StackingLine"}return t},n.prototype.chartSeries=function(n,t,i){for(var f,e,u=[],r=0;r<n.length;r++)f=n[r],e=this.writeChartSeries(f,t,i,r),u.push(e);return u},n.prototype.writeChartSeries=function(n,t,i,r){var f,s=this.officeChartType(i),u={},h,e,c,v,y;if(u.type=s,u.dataSource=t,u.name=n.seriesName,u.xName="x",u.yName="y"+r,"Bubble"===i&&(u.size="size"+r),h=n.dataPoints[0],(this.isPieType?(u.pointColorMapping="color","Doughnut"===i&&(u.innerRadius="75%",u.radius="70%")):(f=this.chartFormat(h,s),u.fill=f),"Line_Markers"!==i&&"Line_Markers_Stacked"!==i&&"Line_Markers_Stacked_100"!==i||(u.marker={visible:!0}),n.hasOwnProperty("dataLabel"))&&(this.isPieType?u.dataLabel=this.parseDataLabels(n.dataLabel):(e={},e.dataLabel=this.parseDataLabels(n.dataLabel),u.marker=e)),n.hasOwnProperty("errorBar")&&(c=n.errorBar,u.errorBar=this.parseErrorBars(c)),n.hasOwnProperty("trendLines"))for(var l=n.trendLines,a=[],o=0;o<l.length;o++)y=l[o],v=this.parseTrendLines(y,f),a.push(v),u.trendlines=a;return u},n.prototype.parseDataLabels=function(n){var t={visible:!0};return t.position=this.isPieType?"BestFit"===n.position||"Inside"===n.position?"Inside":"Outside":this.dataLabelPosition(n.position),t},n.prototype.parseErrorBars=function(n){var t={visible:!0};return t.type=n.type,t.direction=n.direction,t.errorBarCap="Cap"===n.endStyle?{width:1}:{width:0},t},n.prototype.parseTrendLines=function(n,t){var i={};return i.type=n.type,i.name=n.name,i.forwardForecast=n.forward,i.backwardForecast=n.backward,i.intercept="NaN"===n.intercept?0:n.intercept,i.fill=t,i},n.prototype.dataLabelPosition=function(n){var t="Auto";switch(n){case"Outside":t="Outer";break;case"Center":t="Middle";break;case"Inside":t="Top";break;case"OutsideBase":t="Bottom"}return t},n.prototype.chartFormat=function(n,t){var i=n;return"Line"===t||"StackingLine"===t||"StackingLine100"===t?i.line.rgb:i.fill.rgb},n.prototype.chartPrimaryXAxis=function(n,t){var i={},r;return n.chartTitle&&(i.title=n.chartTitle),r=this.chartCategoryType(n.categoryType),i.valueType=r,"DateTime"===r&&(i.intervalType="Days",i.labelFormat="M/d/yyyy",i.edgeLabelPlacement="Shift"),"Scatter_Markers"!==t&&"Bubble"!==t||(i.minimum=n.minimumValue,i.maximum=n.maximumValue,i.interval=n.majorUnit),n.hasMajorGridLines&&(i.majorGridLines={width:1}),n.hasMinorGridLines&&(i.minorTicksPerInterval=4),i},n.prototype.chartCategoryType=function(n){var t="";switch(n){case"Time":t="DateTime";break;case"Automatic":t="Category"}return t},n.prototype.chartPrimaryYAxis=function(n){var t={};return n.chartTitle&&(t.title=n.chartTitle),t.minimum=n.minimumValue,t.maximum=n.maximumValue,t.interval=n.majorUnit,n.hasMajorGridLines&&(t.majorGridLines={width:1}),n.hasMinorGridLines&&(t.minorTicksPerInterval=4),t},n.prototype.chartData=function(n,t){for(var f,e,r=n.chartCategory,u=[],i=0;i<r.length;i++)f=r[i],e=this.chartPlotData(f,n,t,i),u.push(e);return u},n.prototype.chartPlotData=function(n,t,i,r){var f={},s=t.chartSeries,u,o,h;if("m/d/yyyy"===t.chartPrimaryCategoryAxis.numberFormat){var e=n.categoryXName.split("/"),c=Number(e[0]),l=Number(e[1]),a=Number(e[2]);f.x=new Date(a,c-1,l)}else f.x=n.categoryXName;for(u=0;u<s.length;u++)o=n.chartData[u],(f["y"+u]=o.yValue,"Bubble"===i&&(f["size"+u]=o.size),"Pie"===t.chartType||"Doughnut"===t.chartType)&&(h=s[u].dataPoints[r],f.color=this.chartFormat(h,i));return f},n.prototype.parseChartLegend=function(n){var i={},t=n.position;return"Corner"===t&&(t="right"),t?(i.visible=!0,i.position=t.charAt(0).toUpperCase()+t.slice(1)):i.visible=!1,i},n.prototype.destroy=function(){this.chart&&this.chart.destroy();this.chart=void 0},n}();return n.ChartComponent=t,n};sf.officechart=sf.officechart({})},"./modules/popup.js":function(){function n(t){return(n="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(n){return _typeof2(n)}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":_typeof2(n)})(t)}window.sf=window.sf||{};sf.popups=sf.base.extend({},sf.popups,function(t){"use strict";function c(n,t){for(var r,f=getComputedStyle(n),u=[],i=n.parentElement;i&&"HTML"!==i.tagName;)r=getComputedStyle(i),("absolute"!==f.position||"static"!==r.position)&&/(auto|scroll)/.test(r.overflow+r.overflowY+r.overflowX)&&u.push(i),i=i.parentElement;return t||u.push(document),u}function l(n){for(var i,u,e,t,s,f,c,h,r=n.parentElement,o=[];r&&"BODY"!==r.tagName;)i=document.defaultView.getComputedStyle(r,null).getPropertyValue("z-index"),u=document.defaultView.getComputedStyle(r,null).getPropertyValue("position"),"auto"!==i&&"static"!==u&&o.push(i),r=r.parentElement;for(e=[],t=0;t<document.body.children.length;t++)n.isEqualNode(document.body.children[t])||(i=document.defaultView.getComputedStyle(document.body.children[t],null).getPropertyValue("z-index"),u=document.defaultView.getComputedStyle(document.body.children[t],null).getPropertyValue("position"),"auto"!==i&&"static"!==u&&e.push(i));if(e.push("999"),s=[],!sf.base.isNullOrUndefined(n.parentElement)&&"BODY"!==n.parentElement.tagName)for(f=[].slice.call(n.parentElement.children),t=0;t<f.length;t++)n.isEqualNode(f[t])||(i=document.defaultView.getComputedStyle(f[t],null).getPropertyValue("z-index"),u=document.defaultView.getComputedStyle(f[t],null).getPropertyValue("position"),"auto"!==i&&"static"!==u&&s.push(i));return c=o.concat(e,s),h=Math.max.apply(Math,c)+1,h>2147483647?2147483647:h}var f,o=(f=function(n,t){return(f=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),i=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return o(t,n),i([sf.base.Property("left")],t.prototype,"X",void 0),i([sf.base.Property("top")],t.prototype,"Y",void 0),t}(sf.base.ChildProperty),h="e-popup",e="e-rtl",r="e-popup-open",u="e-popup-close",a=function(t){function f(n,i){return t.call(this,i,n)||this}return o(f,t),f.prototype.onPropertyChanged=function(n,t){for(var u,f,i=0,r=Object.keys(n);i<r.length;i++)switch(r[i]){case"width":sf.base.setStyleAttribute(this.element,{width:sf.base.formatUnit(n.width)});break;case"height":sf.base.setStyleAttribute(this.element,{height:sf.base.formatUnit(n.height)});break;case"zIndex":sf.base.setStyleAttribute(this.element,{zIndex:n.zIndex});break;case"enableRtl":this.setEnableRtl();break;case"position":case"relateTo":this.refreshPosition();break;case"offsetX":u=n.offsetX-t.offsetX;this.element.style.left=(parseInt(this.element.style.left,10)+u).toString()+"px";break;case"offsetY":f=n.offsetY-t.offsetY;this.element.style.top=(parseInt(this.element.style.top,10)+f).toString()+"px";break;case"content":this.setContent();break;case"actionOnScroll":"none"!==n.actionOnScroll?this.wireScrollEvents():this.unwireScrollEvents()}},f.prototype.getModuleName=function(){return"popup"},f.prototype.resolveCollision=function(){this.checkCollision()},f.prototype.getPersistData=function(){return this.addOnPersist([])},f.prototype.destroy=function(){this.element.classList.remove(h,e,r,u);this.unwireEvents();t.prototype.destroy.call(this)},f.prototype.render=function(){this.element.classList.add(h);var n={};1e3!==this.zIndex&&(n.zIndex=this.zIndex);"auto"!==this.width&&(n.width=sf.base.formatUnit(this.width));"auto"!==this.height&&(n.height=sf.base.formatUnit(this.height));sf.base.setStyleAttribute(this.element,n);this.fixedParent=!1;this.setEnableRtl();this.setContent()},f.prototype.wireEvents=function(){sf.base.Browser.isDevice&&sf.base.EventHandler.add(window,"orientationchange",this.orientationOnChange,this);"none"!==this.actionOnScroll&&this.wireScrollEvents()},f.prototype.wireScrollEvents=function(){var n,t,i;if(this.getRelateToElement())for(n=0,t=this.getScrollableParent(this.getRelateToElement());n<t.length;n++)i=t[n],sf.base.EventHandler.add(i,"scroll",this.scrollRefresh,this)},f.prototype.unwireEvents=function(){sf.base.Browser.isDevice&&sf.base.EventHandler.remove(window,"orientationchange",this.orientationOnChange);"none"!==this.actionOnScroll&&this.unwireScrollEvents()},f.prototype.unwireScrollEvents=function(){var n,t,i;if(this.getRelateToElement())for(n=0,t=this.getScrollableParent(this.getRelateToElement());n<t.length;n++)i=t[n],sf.base.EventHandler.remove(i,"scroll",this.scrollRefresh)},f.prototype.getRelateToElement=function(){var n=""===this.relateTo||sf.base.isNullOrUndefined(this.relateTo)?document.body:this.relateTo;return this.setProperties({relateTo:n},!0),"string"==typeof this.relateTo?document.querySelector(this.relateTo):this.relateTo},f.prototype.scrollRefresh=function(n){if("reposition"===this.actionOnScroll?sf.base.isNullOrUndefined(this.element)||this.element.offsetParent===n.target||this.element.offsetParent&&"BODY"===this.element.offsetParent.tagName&&null==n.target.parentElement||this.refreshPosition():"hide"===this.actionOnScroll&&this.hide(),"none"!==this.actionOnScroll&&this.getRelateToElement()){var t=this.isElementOnViewport(this.getRelateToElement(),n.target);t||this.targetInvisibleStatus?t&&(this.targetInvisibleStatus=!1):(this.trigger("targetExitViewport"),this.targetInvisibleStatus=!0)}},f.prototype.isElementOnViewport=function(n){for(var i=this.getScrollableParent(n),t=0;t<i.length;t++)if(!this.isElementVisible(n,i[t]))return!1;return!0},f.prototype.isElementVisible=function(n,t){var i=this.checkGetBoundingClientRect(n),u;if(!i.height||!i.width)return!1;if(sf.base.isNullOrUndefined(this.checkGetBoundingClientRect(t))){var r=window,f={top:r.scrollY,left:r.scrollX,right:r.scrollX+r.outerWidth,bottom:r.scrollY+r.outerHeight},e=sf.popups.calculatePosition(n),o={top:e.top,left:e.left,right:e.left+i.width,bottom:e.top+i.height},s={top:f.bottom-o.top,left:f.right-o.left,bottom:o.bottom-f.top,right:o.right-f.left};return s.top>0&&s.left>0&&s.right>0&&s.bottom>0}return u=t.getBoundingClientRect(),!(i.bottom<u.top||i.bottom>u.bottom||i.right>u.right||i.left<u.left)},f.prototype.preRender=function(){},f.prototype.setEnableRtl=function(){this.reposition();this.enableRtl?this.element.classList.add(e):this.element.classList.remove(e)},f.prototype.setContent=function(){sf.base.isNullOrUndefined(this.content)||(this.element.innerHTML="","string"==typeof this.content?this.element.textContent=this.content:this.element.appendChild(this.content))},f.prototype.orientationOnChange=function(){var n=this;setTimeout(function(){n.refreshPosition()},200)},f.prototype.refreshPosition=function(n,t){sf.base.isNullOrUndefined(n)||this.checkFixedParent(n);this.reposition();t||this.checkCollision()},f.prototype.reposition=function(){var n,i,r=this.getRelateToElement(),u,t;"number"==typeof this.position.X&&"number"==typeof this.position.Y?n={left:this.position.X,top:this.position.Y}:"string"==typeof this.position.X&&"number"==typeof this.position.Y||"number"==typeof this.position.X&&"string"==typeof this.position.Y?(u=void 0,t=this.element.style.display,this.element.style.display="block",this.element.classList.contains("e-dlg-modal")&&(u=this.element.parentElement.style.display,this.element.parentElement.style.display="block"),i=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY),n="string"==typeof this.position.X?{left:i.left,top:this.position.Y}:{left:this.position.X,top:i.top},this.element.style.display=t,this.element.classList.contains("e-dlg-modal")&&(this.element.parentElement.style.display=u)):r?(t=this.element.style.display,this.element.style.display="block",n=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY),this.element.style.display=t):n={left:0,top:0};sf.base.isNullOrUndefined(n)||(this.element.style.left=n.left+"px",this.element.style.top=n.top+"px")},f.prototype.checkGetBoundingClientRect=function(n){try{return n.getBoundingClientRect()}catch(n){return null}},f.prototype.getAnchorPosition=function(n,t,i,r,u){var e=this.checkGetBoundingClientRect(t),o=this.checkGetBoundingClientRect(n),s,f;if(sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(o))return null;s=n;f={left:0,top:0};switch(t.offsetParent&&"BODY"===t.offsetParent.tagName&&"BODY"===n.tagName?f=sf.popups.calculatePosition(n):(t.classList.contains("e-dlg-modal")&&"BODY"!==s.tagName&&(t=t.parentElement),f=sf.popups.calculateRelativeBasedPosition(s,t)),i.X){case"center":f.left+=t.classList.contains("e-dlg-modal")&&"BODY"===s.tagName&&"container"===this.targetType?window.innerWidth/2-e.width/2:"container"===this.targetType?o.width/2-e.width/2:o.width/2;break;case"right":f.left+=t.classList.contains("e-dlg-modal")&&"BODY"===s.tagName&&"container"===this.targetType?window.innerWidth-e.width:"container"===this.targetType?o.width-e.width:o.width}switch(i.Y){case"center":f.top+=t.classList.contains("e-dlg-modal")&&"BODY"===s.tagName&&"container"===this.targetType?window.innerHeight/2-e.height/2:"container"===this.targetType?o.height/2-e.height/2:o.height/2;break;case"bottom":f.top+=t.classList.contains("e-dlg-modal")&&"BODY"===s.tagName&&"container"===this.targetType?window.innerHeight-e.height:"container"===this.targetType?o.height-e.height:o.height}return f.left+=r,f.top+=u,f},f.prototype.callFlip=function(n){var t=this.getRelateToElement();sf.popups.flip(this.element,t,this.offsetX,this.offsetY,this.position.X,this.position.Y,this.viewPortElement,n,this.fixedParent)},f.prototype.callFit=function(n){var r,t,i;if(0!==sf.popups.isCollide(this.element,this.viewPortElement).length)if(sf.base.isNullOrUndefined(this.viewPortElement))r=sf.popups.fit(this.element,this.viewPortElement,n),n.X&&(this.element.style.left=r.left+"px"),n.Y&&(this.element.style.top=r.top+"px");else{if(t=this.checkGetBoundingClientRect(this.element),i=this.checkGetBoundingClientRect(this.viewPortElement),sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(i))return null;n&&!0===n.Y&&(i.top>t.top?this.element.style.top="0px":i.bottom<t.bottom&&(this.element.style.top=parseInt(this.element.style.top,10)-(t.bottom-i.bottom)+"px"));n&&!0===n.X&&(i.right<t.right?this.element.style.left=parseInt(this.element.style.left,10)-(t.right-i.right)+"px":i.left>t.left&&(this.element.style.left=parseInt(this.element.style.left,10)+(i.left-t.left)+"px"))}},f.prototype.checkCollision=function(){var n=this.collision.X,t=this.collision.Y;"none"===n&&"none"===t||("flip"===n&&"flip"===t?this.callFlip({X:!0,Y:!0}):"fit"===n&&"fit"===t?this.callFit({X:!0,Y:!0}):("flip"===n?this.callFlip({X:!0,Y:!1}):"flip"===t&&this.callFlip({Y:!0,X:!1}),"fit"===n?this.callFit({X:!0,Y:!1}):"fit"===t&&this.callFit({X:!1,Y:!0})))},f.prototype.show=function(t,i){var f=this,e;(this.wireEvents(),1e3!==this.zIndex&&sf.base.isNullOrUndefined(i))||(e=sf.base.isNullOrUndefined(i)?this.element:i,this.zIndex=l(e),sf.base.setStyleAttribute(this.element,{zIndex:this.zIndex}));t=sf.base.isNullOrUndefined(t)||"object"!==n(t)?this.showAnimation:t;"none"===this.collision.X&&"none"===this.collision.Y||(sf.base.removeClass([this.element],u),sf.base.addClass([this.element],r),this.checkCollision(),sf.base.removeClass([this.element],r),sf.base.addClass([this.element],u));sf.base.isNullOrUndefined(t)?(sf.base.removeClass([this.element],u),sf.base.addClass([this.element],r),this.trigger("open")):(t.begin=function(){f.isDestroyed||(sf.base.removeClass([f.element],u),sf.base.addClass([f.element],r))},t.end=function(){f.isDestroyed||f.trigger("open")},new sf.base.Animation(t).animate(this.element))},f.prototype.hide=function(t){var i=this;t=sf.base.isNullOrUndefined(t)||"object"!==n(t)?this.hideAnimation:t;sf.base.isNullOrUndefined(t)?(sf.base.removeClass([this.element],r),sf.base.addClass([this.element],u),this.trigger("close")):(t.end=function(){i.isDestroyed||(sf.base.removeClass([i.element],r),sf.base.addClass([i.element],u),i.trigger("close"))},new sf.base.Animation(t).animate(this.element));this.unwireEvents()},f.prototype.getScrollableParent=function(n){return this.checkFixedParent(n),c(n,this.fixedParent)},f.prototype.checkFixedParent=function(n){for(var i,t=n.parentElement;t&&"HTML"!==t.tagName;)i=getComputedStyle(t),"fixed"===i.position&&!sf.base.isNullOrUndefined(this.element)&&this.element.offsetParent&&"BODY"===this.element.offsetParent.tagName&&(this.element.style.top=window.scrollY>parseInt(this.element.style.top)?sf.base.formatUnit(window.scrollY-parseInt(this.element.style.top)):sf.base.formatUnit(parseInt(this.element.style.top)-window.scrollY),this.element.style.position="fixed",this.fixedParent=!0),t=t.parentElement,!sf.base.isNullOrUndefined(this.element)&&sf.base.isNullOrUndefined(this.element.offsetParent)&&"fixed"===i.position&&"fixed"===this.element.style.position&&(this.fixedParent=!0)},i([sf.base.Property("auto")],f.prototype,"height",void 0),i([sf.base.Property("auto")],f.prototype,"width",void 0),i([sf.base.Property(null)],f.prototype,"content",void 0),i([sf.base.Property("container")],f.prototype,"targetType",void 0),i([sf.base.Property(null)],f.prototype,"viewPortElement",void 0),i([sf.base.Property({X:"none",Y:"none"})],f.prototype,"collision",void 0),i([sf.base.Property("")],f.prototype,"relateTo",void 0),i([sf.base.Complex({},s)],f.prototype,"position",void 0),i([sf.base.Property(0)],f.prototype,"offsetX",void 0),i([sf.base.Property(0)],f.prototype,"offsetY",void 0),i([sf.base.Property(1e3)],f.prototype,"zIndex",void 0),i([sf.base.Property(!1)],f.prototype,"enableRtl",void 0),i([sf.base.Property("reposition")],f.prototype,"actionOnScroll",void 0),i([sf.base.Property(null)],f.prototype,"showAnimation",void 0),i([sf.base.Property(null)],f.prototype,"hideAnimation",void 0),i([sf.base.Event()],f.prototype,"open",void 0),i([sf.base.Event()],f.prototype,"close",void 0),i([sf.base.Event()],f.prototype,"targetExitViewport",void 0),f=i([sf.base.NotifyPropertyChanges],f)}(sf.base.Component);return t.PositionData=s,t.Popup=a,t.getScrollableParent=c,t.getZindexPartial=l,t.getMaxZindex=function(n){var u,i,r,t,f,o,e;for(void 0===n&&(n=["*"]),u=[],i=0;i<n.length;i++)for(r=document.getElementsByTagName(n[i]),t=0;t<r.length;t++)f=document.defaultView.getComputedStyle(r[t],null).getPropertyValue("z-index"),o=document.defaultView.getComputedStyle(r[t],null).getPropertyValue("position"),"auto"!==f&&"static"!==o&&u.push(f);return e=Math.max.apply(Math,u)+1,e>2147483647?2147483647:e},t}({}))},"./modules/popupsbase.js":function(){window.sf=window.sf||{};window.sf.popups=window.sf.base.extend({},window.sf.popups,function(n){"use strict";function u(n,t,i,r,u){return(l=void 0,l=u,et=!!r,!n)?{left:0,top:0}:(t||(t="left"),i||(i="top"),w=n.ownerDocument,nt=n,function(n,t,i){switch(f=nt.getBoundingClientRect(),t+n){case"topcenter":o(ct(),i);s(tt(),i);break;case"topright":o(ht(),i);s(tt(),i);break;case"centercenter":o(ct(),i);s(st(),i);break;case"centerright":o(ht(),i);s(st(),i);break;case"centerleft":o(it(),i);s(st(),i);break;case"bottomcenter":o(ct(),i);s(ot(),i);break;case"bottomright":o(ht(),i);s(ot(),i);break;case"bottomleft":o(it(),i);s(ot(),i);break;default:case"topleft":o(it(),i);s(tt(),i)}return i}(t.toLowerCase(),i.toLowerCase(),{left:0,top:0}))}function o(n,t){t.left=n}function s(n,t){t.top=n}function oi(){return w.documentElement.scrollTop||w.body.scrollTop}function si(){return w.documentElement.scrollLeft||w.body.scrollLeft}function ot(){return et?f.bottom:f.bottom+oi()}function st(){return tt()+f.height/2}function tt(){return et?f.top:f.top+oi()}function it(){return f.left+si()}function ht(){var n=nt&&nt.classList.contains("e-date-range-wrapper")?l?l.width:0:l&&f.width>=l.width?l.width:0;return f.right+si()-n}function ct(){return it()+f.width/2}function lt(n,t,i){n.TL={top:t.position.top+t.offsetY,left:t.position.left+t.offsetX};n.TR={top:n.TL.top,left:n.TL.left+i.width};n.BL={top:n.TL.top+i.height,left:n.TL.left};n.BR={top:n.TL.top+i.height,left:n.TL.left+i.width}}function hi(n,t){var i=!1,r=!1;return n-ut()<vt()&&(i=!0),t>yt()&&(r=!0),{leftSide:i,rightSide:r}}function ci(n,t){var i=!1,r=!1;return n-rt()<at()&&(i=!0),t>pt()&&(r=!0),{topSide:i,bottomSide:r}}function li(){return r.getBoundingClientRect().width}function ai(){return r.getBoundingClientRect().height}function vi(){return r.getBoundingClientRect().left}function yi(){return r.getBoundingClientRect().top}function at(){return r?yi():0}function vt(){return r?vi():0}function yt(){return r?ut()+vi()+li():ut()+wi()}function pt(){return r?rt()+yi()+ai():rt()+pi()}function rt(){return a.documentElement.scrollTop||a.body.scrollTop}function ut(){return a.documentElement.scrollLeft||a.body.scrollLeft}function pi(){return window.innerHeight}function wi(){var n=window.innerWidth,t=document.documentElement.getBoundingClientRect();return n-(n-(sf.base.isNullOrUndefined(document.documentElement)?0:t.width))}function or(n){ii();var t=sf.base.createElement("span",{attrs:{unselectable:"on",contenteditable:"false"}});t.setAttribute("class","e-dialog-border-resize e-"+n);"south"===n&&(t.style.height="2px",t.style.width="100%",t.style.bottom="0px",t.style.left="0px");"north"===n&&(t.style.height="2px",t.style.width="100%",t.style.top="0px",t.style.left="0px");"east"===n&&(t.style.height="100%",t.style.width="2px",t.style.right="0px",t.style.top="0px");"west"===n&&(t.style.height="100%",t.style.width="2px",t.style.left="0px",t.style.top="0px");i.appendChild(t)}function tr(n){var t;return sf.base.isNullOrUndefined(n)||(t="string"==typeof n?document.querySelector(n):n),t}function ir(n){var f,t,r,u;for(sf.base.isNullOrUndefined(n)&&(n=this),f=i.querySelectorAll(".e-resize-handle"),t=0;t<f.length;t++)e=f[t],sf.base.EventHandler.add(e,"mousedown",ur,n),r="msie"===sf.base.Browser.info.name?"pointerdown":"touchstart",sf.base.EventHandler.add(e,r,fr,n);if(u=i.querySelectorAll(".e-dialog-border-resize"),!sf.base.isNullOrUndefined(u))for(t=0;t<u.length;t++)e=u[t],sf.base.EventHandler.add(e,"mousedown",ur,n),r="msie"===sf.base.Browser.info.name?"pointerdown":"touchstart",sf.base.EventHandler.add(e,r,fr,n)}function rr(n){return n.indexOf("mouse")>-1?"mouse":"touch"}function ur(n){var u,r;if(n.preventDefault(),i=n.target.parentElement,ii(),b=n.pageX,k=n.pageY,n.target.classList.add("e-focused-handle"),sf.base.isNullOrUndefined(d)||!0!==d(n,this))for(u=sf.base.isNullOrUndefined(t)?document:t,sf.base.EventHandler.add(u,"mousemove",g,this),sf.base.EventHandler.add(document,"mouseup",ft,this),r=0;r<bi.length;r++)ti=!i.classList.contains(bi[r])}function ft(n){var r="msie"===sf.base.Browser.info.name?"pointermove":"touchmove",u="msie"===sf.base.Browser.info.name?"pointerup":"touchend",i=sf.base.isNullOrUndefined(t)?document:t,f="msie"===sf.base.Browser.info.name?"pointerdown":"touchstart";sf.base.EventHandler.remove(i,"mousemove",g);sf.base.EventHandler.remove(i,r,g);sf.base.EventHandler.remove(i,f,g);sf.base.isNullOrUndefined(document.body.querySelector(".e-focused-handle"))||document.body.querySelector(".e-focused-handle").classList.remove("e-focused-handle");sf.base.isNullOrUndefined(ni)||ni(n,this);sf.base.EventHandler.remove(document,"mouseup",ft);sf.base.EventHandler.remove(document,u,ft)}function ii(){kt=parseFloat(getComputedStyle(i,null).getPropertyValue("width").replace("px",""));dt=parseFloat(getComputedStyle(i,null).getPropertyValue("height").replace("px",""));ki=i.getBoundingClientRect().left;di=i.getBoundingClientRect().top}function fr(n){var r;if(i=n.target.parentElement,ii(),r=n.touches?n.changedTouches[0]:n,b=r.pageX,k=r.pageY,sf.base.isNullOrUndefined(d)||!0!==d(n,this)){var u="msie"===sf.base.Browser.info.name?"pointermove":"touchmove",f="msie"===sf.base.Browser.info.name?"pointerup":"touchend",e=sf.base.isNullOrUndefined(t)?document:t;sf.base.EventHandler.add(e,u,g,this);sf.base.EventHandler.add(document,f,ft)}}function g(n){if(n.target.classList.contains("e-resize-handle")&&n.target.classList.contains("e-focused-handle")?e=n.target:sf.base.isNullOrUndefined(document.body.querySelector(".e-focused-handle"))||(e=document.body.querySelector(".e-focused-handle")),!sf.base.isNullOrUndefined(e)){for(var i="",t=0;t<bt.length;t++)e.classList.contains("e-"+bt[t])&&(i=bt[t]);switch(sf.base.isNullOrUndefined(gt)||gt(n,this),i){case"south":ri(n);break;case"north":ui(n);break;case"west":fi(n);break;case"east":ei(n);break;case"south-east":ri(n);ei(n);break;case"south-west":ri(n);fi(n);break;case"north-east":ui(n);ei(n);break;case"north-west":ui(n);fi(n)}}}function c(n){return n.getBoundingClientRect()}function ri(n){var l,o=document.documentElement.clientHeight,e=!1,a=(n.touches?n.changedTouches[0]:n).pageY,r=c(i),u,s,y,f,h,w;if(sf.base.isNullOrUndefined(t)||(l=c(t)),sf.base.isNullOrUndefined(t)?sf.base.isNullOrUndefined(t)&&(o-a>=0||r.top<0)&&(e=!0):e=!0,u=dt+(a-k),u=u>p?u:p,s=0,sf.base.isNullOrUndefined(t)||(s=l.top),y=sf.base.isNullOrUndefined(t)?0:t.offsetHeight-t.clientHeight,f=r.top-s-y/2,f=f<0?0:f,r.top>0&&f+u>v){if(e=!1,i.classList.contains("e-resize-viewport"))return;i.style.height=v-parseInt(f.toString(),10)+"px"}else h=0,e&&(r.top<0&&o+(r.height+r.top)>0&&u+(h=r.top)<=30&&(u=r.height-(r.height+r.top)+30),u+r.top>=v&&(i.style.height=r.height+(o-(r.height+r.top))+"px"),w=sf.base.isNullOrUndefined(t)?h:f,u>=p&&u+w<=v&&(i.style.height=u+"px"))}function ui(n){var f,s=!1,e="mouse"===rr(n.type)?n.pageY:n.touches[0].pageY,h=c(i),u,o,r;sf.base.isNullOrUndefined(t)||(f=c(t));(!sf.base.isNullOrUndefined(t)&&h.top-f.top>0||sf.base.isNullOrUndefined(t)&&e>0)&&(s=!0);u=dt-(e-k);s&&u>=p&&u<=v&&(o=0,sf.base.isNullOrUndefined(t)||(o=f.top),r=di-o+(e-k),r=r>0?r:1,i.style.height=u+"px",i.style.top=r+"px")}function fi(n){var u,v=document.documentElement.clientWidth,a=!1,r,l,f;sf.base.isNullOrUndefined(t)||(u=c(t));var o="mouse"===rr(n.type)?n.pageX:n.touches[0].pageX,e=c(i),s=sf.base.isNullOrUndefined(t)?0:t.offsetWidth-t.clientWidth,p=sf.base.isNullOrUndefined(t)?0:u.left,w=sf.base.isNullOrUndefined(t)?0:u.width;sf.base.isNullOrUndefined(y)&&(sf.base.isNullOrUndefined(t)?y=v:(y=e.left-p-s/2+e.width,y+=w-s-y));(!sf.base.isNullOrUndefined(t)&&Math.floor(e.left-u.left+e.width+(u.right-e.right))-s<=h||sf.base.isNullOrUndefined(t)&&o>=0)&&(a=!0);r=kt-(o-b);(ti&&(r=r>y?y:r),a&&r>=wt&&r<=h)&&(l=0,sf.base.isNullOrUndefined(t)||(l=u.left),f=ki-l+(o-b),f=f>0?f:1,r!==gi&&nr&&(i.style.width=r+"px"),ti&&(i.style.left=f+"px",nr=1!==f));gi=r}function ei(n){var f,l=document.documentElement.clientWidth,o=!1,s,r,u,e;if(sf.base.isNullOrUndefined(t)||(f=c(t)),s=(n.touches?n.changedTouches[0]:n).pageX,r=c(i),(!sf.base.isNullOrUndefined(t)&&(r.left-f.left+r.width<=h||r.right-f.left>=r.width)||sf.base.isNullOrUndefined(t)&&l-s>0)&&(o=!0),u=kt+(s-b),e=0,sf.base.isNullOrUndefined(t)||(e=f.left),r.left-e+u>h){if(o=!1,i.classList.contains("e-resize-viewport"))return;i.style.width=h-(r.left-e)+"px"}o&&u>=wt&&u<=h&&(i.style.width=u+"px")}var f,l,nt,w,a,r,et=!1,i,e,p,v,wt,h,t,y,bt=["north-west","north","north-east","west","east","south-west","south","south-east"],bi=["e-restrict-left"],er=["north","west","east","south"],kt=0,dt=0,ki=0,di=0,b=0,k=0,d=null,gt=null,ni=null,ti=!0,gi=0,nr=!0;return n.fit=function(n,t,i,f){var e;if(void 0===t&&(t=null),void 0===i&&(i={X:!1,Y:!1}),!i.Y&&!i.X)return{left:0,top:0};if(e=n.getBoundingClientRect(),r=t,a=n.ownerDocument,f||(f=u(n,"left","top")),i.X){var w=r?li():wi(),l=vt(),v=yt(),o=l-f.left,s=f.left+e.width-v;e.width>w?f.left=o>0&&s<=0?v-e.width:s>0&&o<=0?l:o>s?v-e.width:l:o>0?f.left+=o:s>0&&(f.left-=s)}if(i.Y){var b=r?ai():pi(),y=at(),p=pt(),h=y-f.top,c=f.top+e.height-p;e.height>b?f.top=h>0&&c<=0?p-e.height:c>0&&h<=0?y:h>c?p-e.height:y:h>0?f.top+=h:c>0&&(f.top-=c)}return f},n.isCollide=function(n,t,i,f){var e,o;void 0===t&&(t=null);e=u(n,"left","top");i&&(e.left=i);f&&(e.top=f);o=[];r=t;a=n.ownerDocument;var s=n.getBoundingClientRect(),l=e.top,v=e.left,y=e.left+s.width,h=ci(l,e.top+s.height),c=hi(v,y);return h.topSide&&o.push("top"),c.rightSide&&o.push("right"),c.leftSide&&o.push("left"),h.bottomSide&&o.push("bottom"),o},n.flip=function(n,t,i,f,e,o,s,h,c){var l,y,p,w,v;(void 0===s&&(s=null),void 0===h&&(h={X:!0,Y:!0}),t&&n&&e&&o&&(h.X||h.Y))&&(y={TL:null,TR:null,BL:null,BR:null},p={TL:null,TR:null,BL:null,BR:null},"none"===window.getComputedStyle(n).display?(w=n.style.visibility,n.style.visibility="hidden",n.style.display="block",l=n.getBoundingClientRect(),n.style.removeProperty("display"),n.style.visibility=w):l=n.getBoundingClientRect(),v={posX:e,posY:o,offsetX:i,offsetY:f,position:{left:0,top:0}},r=s,a=t.ownerDocument,function(n,t,i,r,f){i.position=u(n,i.posX,i.posY,r,f);t.TL=u(n,"left","top",r,f);t.TR=u(n,"right","top",r,f);t.BR=u(n,"left","bottom",r,f);t.BL=u(n,"right","bottom",r,f)}(t,y,v,c,l),lt(p,v,l),h.X&&function n(t,i,r,f,e,o){var s=hi(i.TL.left,i.TR.left);r.TL.left-ut()<=vt()&&(s.leftSide=!1);r.TR.left>yt()&&(s.rightSide=!1);(s.leftSide&&!s.rightSide||!s.leftSide&&s.rightSide)&&(f.posX="right"===f.posX?"left":"right",f.offsetX=f.offsetX+e.width,f.offsetX=-1*f.offsetX,f.position=u(t,f.posX,f.posY,!1),lt(i,f,e),o&&n(t,i,r,f,e,!1))}(t,p,y,v,l,!0),h.Y&&y.TL.top>-1&&function n(t,i,r,f,e,o){var s=ci(i.TL.top,i.BL.top);r.TL.top-rt()<=at()&&(s.topSide=!1);r.BL.top>=pt()&&t.getBoundingClientRect().bottom<window.innerHeight&&(s.bottomSide=!1);(s.topSide&&!s.bottomSide||!s.topSide&&s.bottomSide)&&(f.posY="top"===f.posY?"bottom":"top",f.offsetY=f.offsetY+e.height,f.offsetY=-1*f.offsetY,f.position=u(t,f.posX,f.posY,!1,e),lt(i,f,e),o&&n(t,i,r,f,e,!1))}(t,p,y,v,l,!0),function(n,t,i){var f=0,e=0,r;null!=n.offsetParent&&("absolute"===getComputedStyle(n.offsetParent).position||"relative"===getComputedStyle(n.offsetParent).position)&&(r=u(n.offsetParent,"left","top",!1,i),f=r.left,e=r.top);n.style.top=t.position.top+t.offsetY-e+"px";n.style.left=t.position.left+t.offsetX-f+"px"}(n,v,l))},n.calculateRelativeBasedPosition=function(n,t){var r=!1,i={left:0,top:0},u=n;if(!n||!t)return i;for(sf.base.isNullOrUndefined(t.offsetParent)&&"fixed"===t.style.position&&(r=!0);(t.offsetParent||r)&&n&&t.offsetParent!==n;)i.left+=n.offsetLeft,i.top+=n.offsetTop,n=n.offsetParent;for(n=u;(t.offsetParent||r)&&n&&t.offsetParent!==n;)i.left-=n.scrollLeft,i.top-=n.scrollTop,n=n.parentElement;return i},n.calculatePosition=u,n.createResize=function(n){var u,r,f;for(d=n.resizeBegin,gt=n.resizing,ni=n.resizeComplete,i=tr(n.element),t=tr(n.boundary),u=n.direction.split(" "),r=0;r<u.length;r++)er.indexOf(u[r])>=0&&u[r]?or(u[r]):""!==u[r].trim()&&(f=sf.base.createElement("div",{className:"e-icons e-resize-handle e-"+u[r]}),i.appendChild(f));p=n.minHeight;wt=n.minWidth;h=n.maxWidth;v=n.maxHeight;n.proxy&&n.proxy.element&&n.proxy.element.classList.contains("e-dialog")?ir(n.proxy):ir()},n.setMinHeight=function(n){p=n},n.setMaxWidth=function(n){h=n},n.setMaxHeight=function(n){v=n},n.removeResize=function(){for(var t,r=i.querySelectorAll(".e-resize-handle"),n=0;n<r.length;n++)sf.base.detach(r[n]);if(t=i.querySelectorAll(".e-dialog-border-resize"),!sf.base.isNullOrUndefined(t))for(n=0;n<t.length;n++)sf.base.detach(t[n])},n}({}))},"./modules/sf-colorpicker.js":function(){window.sfBlazor=window.sfBlazor||{};window.sfBlazor.ColorPicker=function(){"use strict";var n=function(){function n(n,t,i){this.element=n;this.dotnetRef=t;this.element.blazor__instance=this;i&&(this.addScrollEvents(!0),this.setPaletteWidth(this.element.querySelector(".e-container"),!1))}return n.prototype.getOffset=function(n){var i=n.querySelector(".e-hsv-container");if(!i)return{IsDevice:sf.base.Browser.isDevice};var t=i.getBoundingClientRect(),r=i.querySelector(".e-hsv-color"),u=i.querySelector(".e-handler");return u&&u.focus(),{Left:t.left,Top:t.top,Width:t.width,Height:t.height,Right:t.right,ClientLeft:r.offsetLeft,ClientTop:r.offsetTop,ClientWidth:r.offsetWidth,ClientHeight:r.offsetHeight,IsDevice:sf.base.Browser.isDevice}},n.prototype.setOffset=function(n,t){var i=this.getOffset(n);t&&!sf.base.Browser.isDevice&&(this.setZIndex(this.element,t,".e-split-colorpicker"),this.setZIndex(this.element,t,".e-dropdown-btn"));i&&this.dotnetRef.invokeMethodAsync("SetOffset",i)},n.prototype.setZIndex=function(n,t,i){var r=n.querySelector(i);r&&(r.style.zIndex=t+1+"")},n.prototype.setPaletteWidth=function(n,t,i){var r,e,u,f;sf.base.Browser.isDevice&&!sf.base.isNullOrUndefined(i)&&(r=n.querySelector(".e-colorpicker.e-modal"),r&&(r.style.zIndex=i-1+"",document.body.insertBefore(r,n.parentElement),r.style.display=""));n.querySelector(".e-hsv-container")?n.style.width="":(e=parseInt(getComputedStyle(n).borderBottomWidth,10),n.style.width=n.children[0].offsetWidth+e+e+"px",u=n.querySelector(".e-selected-value"),u&&(u.style.width="100%",(u=n.querySelector(".e-switch-ctrl-btn"))&&(u.style.width="100%")));t&&(f=this.element.querySelector(".sf-colorpicker"),f&&!sf.base.isNullOrUndefined(f.blazor__instance)&&f.blazor__instance.setPosition(!0))},n.prototype.scrollHandler=function(n){this.element.parentElement?this.setOffset(this.element):sf.base.EventHandler.remove(n.target,"scroll",this.scrollHandler)},n.prototype.addScrollEvents=function(n){for(var r,t=0,i=sf.popups.getScrollableParent(this.element);t<i.length;t++)r=i[t],n?sf.base.EventHandler.add(r,"scroll",this.scrollHandler,this):sf.base.EventHandler.remove(r,"scroll",this.scrollHandler)},n.prototype.focusIn=function(n,t){if(t){var i=n.querySelector(".e-container");i&&(i.classList.contains("e-color-palette")?this.setFocus(".e-palette"):this.setFocus(".e-handler"))}else this.setFocus(".e-split-colorpicker")},n.prototype.setFocus=function(n){var t=this.element.querySelector(n);t&&t.focus()},n.prototype.paletteKeyDown=function(n,t){var s=n.target;if(s.classList.contains("e-palette")){var r,e,f,i=[].slice.call(sf.base.selectAll(".e-tile",s)),u=i.filter(function(n){return n.classList.contains("e-selected")}).pop(),o=s.parentElement;switch(!n.altKey&&n.keyCode){case 39:n.preventDefault();f=(r=u?i[this.tilePosition(i,u,t?-1:1)]:i[t?i.length-1:0]).getAttribute("aria-label");this.keySelectionChanges(r,o,f);break;case 37:n.preventDefault();f=(r=u?i[this.tilePosition(i,u,t?1:-1)]:i[t?0:i.length-1]).getAttribute("aria-label");this.keySelectionChanges(r,o,f);break;case 38:n.preventDefault();f=(r=i[e=u?this.tilePosition(i,u,-10):0]?i[e]:i[e-10]).getAttribute("aria-label");this.keySelectionChanges(r,o,f);break;case 40:n.preventDefault();i[e=u?this.tilePosition(i,u,10):i.length-1]?r=i[e]:(e%=i.length,r=i[e+=i[i.length-1].parentElement.childElementCount]);f=r.getAttribute("aria-label");this.keySelectionChanges(r,o,f);break;case 13:(n.preventDefault(),u)&&(u.getAttribute("aria-label"),this.dotnetRef.invokeMethodAsync("Close"))}}},n.prototype.tilePosition=function(n,t,i){var u=(n=Array.prototype.slice.call(n)).length,f=10-n[u-1].parentElement.childElementCount,r=n.indexOf(t);return(r+=i)<0?r+=u+f:r%=u+f,r},n.prototype.keySelectionChanges=function(n,t,i){this.removeTileSelection(t);this.addTileSelection(n);this.dotnetRef.invokeMethodAsync("Click",i)},n.prototype.removeTileSelection=function(n){[].slice.call(sf.base.selectAll(".e-selected",n.children[0])).forEach(function(n){n.classList.remove("e-selected");n.setAttribute("aria-selected","false")})},n.prototype.addTileSelection=function(n){n.classList.add("e-selected");n.setAttribute("aria-selected","true")},n}();return{initialize:function(t,i,r){return sf.base.isNullOrUndefined(t)?null:(new n(t,i,r),t.blazor__instance.getOffset(t))},getOffset:function(n,t){return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||sf.base.isNullOrUndefined(t)?null:(n.blazor__instance.setPaletteWidth(t,!0),n.blazor__instance.getOffset(t))},focusIn:function(n,t){sf.base.isNullOrUndefined(n)||n.blazor__instance.focusIn(n,t)},destroy:function(n){sf.base.isNullOrUndefined(n)||n.blazor__instance.addScrollEvents(!1)}}}()},"./modules/sf-contextmenu.js":function(){window.sfBlazor=window.sfBlazor||{};window.sfBlazor.ContextMenu=function(){"use strict";function t(n,i,r,u){void 0===u&&(u=0);var f=n.children[i];return u===n.childElementCount?-1:((f.classList.contains("e-separator")||f.classList.contains("e-disabled")||f.classList.contains("e-menu-hide"))&&(i=r?i===n.childElementCount-1?0:i+1:0===i?n.childElementCount-1:i-1,u++),((f=n.children[i]).classList.contains("e-separator")||f.classList.contains("e-disabled")||f.classList.contains("e-menu-hide"))&&(i=t(n,i,r)),i)}var n="e-menu-parent",i="CloseMenuAsync",r=function(){function r(n,t,i,r,u){this.element=n;this.target=t;this.filter=i;this.showOn=r;this.dotnetRef=u;this.element.blazor__instance=this;this.addContextMenuEvent();this.addEventListener()}return r.prototype.addContextMenuEvent=function(n){var t,i,r,c,o,u,s,l,f,e,h,a;if((void 0===n&&(n=!0),this.target)&&(i=sf.base.selectAll(this.target),i.length)){for(r=0,c=i.length;r<c;r++)(t=i[r],n)?sf.base.Browser.isIos?new sf.base.Touch(t,{tapHold:this.touchHandler.bind(this)}):sf.base.EventHandler.add(t,this.showOn,this.cmenuHandler,this):sf.base.Browser.isIos?(o=sf.base.getInstance(t,sf.base.Touch),o&&o.destroy()):sf.base.EventHandler.remove(t,this.showOn,this.cmenuHandler);if(sf.base.isNullOrUndefined(this.targetElement)&&(this.targetElement=t),n)for(sf.base.EventHandler.add(this.targetElement,"scroll",this.scrollHandler,this),u=0,s=sf.popups.getScrollableParent(this.targetElement);u<s.length;u++)l=s[u],sf.base.EventHandler.add(l,"scroll",this.scrollHandler,this);else{for(f=void 0,this.targetElement.parentElement?(sf.base.EventHandler.remove(this.targetElement,"scroll",this.scrollHandler),f=sf.popups.getScrollableParent(this.targetElement)):f=sf.popups.getScrollableParent(t),e=0,h=f;e<h.length;e++)a=h[e],sf.base.EventHandler.remove(a,"scroll",this.scrollHandler);this.targetElement=null}}},r.prototype.scrollHandler=function(){sf.base.select("."+n,this.element)&&this.dotnetRef.invokeMethodAsync(i,0,!1,!0,!1)},r.prototype.touchHandler=function(n){this.cmenuHandler(n.originalEvent)},r.prototype.keyDownHandler=function(i){var r=i.target.classList;(r.contains("e-menu-item")||r.contains(n))&&i.preventDefault(),function(n,i,r,u){var o,l;if(40===r||38===r){var f=void 0,e=void 0,s=void 0;i.classList.contains("e-menu-parent")?((s=(e=i).querySelector(".e-menu-item.e-focused"))?(f=Array.prototype.indexOf.call(e.children,s),f=40===r?f===e.childElementCount-1?0:f+1:0===f?e.childElementCount-1:f-1):f=0,f=t(e,f,40===r)):i.classList.contains("e-menu-item")&&(s=(e=i.parentElement).querySelector(".e-menu-item.e-focused"),f=Array.prototype.indexOf.call(e.children,s||i),f=t(e,f=40===r?f===e.childElementCount-1?0:f+1:0===f?e.childElementCount-1:f-1,40===r));e&&-1!==f&&e.children[f].focus()}else if(((n.classList.contains("e-rtl")?39===r:37===r)||27===r||13===r&&sf.base.closest(i,".e-menu-container"))&&(i.classList.contains("e-ul")||i.classList.contains("e-menu-item")&&!i.parentElement.classList.contains("e-contextmenu"))){o=void 0;u&&(o=sf.base.select(u));e=i.classList.contains("e-ul")?i:i.parentElement;var c=sf.base.closest(e,".e-menu-vscroll"),h=void 0,a=c?c.previousElementSibling:e.previousElementSibling;!o||a&&13!==r?(l=sf.base.closest(e,".e-hamburger"),h=l?sf.base.select(".e-menu-item.e-selected",l):sf.base.select(".e-menu-item.e-selected",a)):(h=sf.base.select(".e-menu-item.e-selected",o),(c=sf.base.select(".e-menu-vscroll",n))&&o.blazor__instance.destroyScroll("none"));h&&h.focus()}}(this.element,i.target,i.keyCode,this.menuId)},r.prototype.cmenuHandler=function(n){var u,f;if(this.filter){for(var i=!1,r=this.filter.split(" "),t=0,e=r.length;t<e;t++)if(sf.base.closest(n.target,r[t])){i=!0;break}if(!i)return}n.preventDefault();u=n.changedTouches?n.changedTouches[0].clientX:n.clientX;f=n.changedTouches?n.changedTouches[0].clientY:n.clientY;this.dotnetRef.invokeMethodAsync("OpenContextMenuAsync",Math.ceil(u),Math.ceil(f))},r.prototype.contextMenuPosition=function(n,t,i,r,u){var f=this.hideMenu(!0),o,e,s,h;if(f){if(this.subMenuOpen=!1,this.setBlankIconStyle(f,i),o=f.getBoundingClientRect(),e=this.getMenuWidth(f,o.width,i),r&&sf.base.Browser.isDevice)return f.style.width=Math.ceil(e)+"px",void(f.style.visibility="");u&&(t+o.height>document.documentElement.clientHeight&&(s=document.documentElement.clientHeight-o.height-20,s>document.documentElement.clientTop&&(t=s)),n+e>document.documentElement.clientWidth&&(h=document.documentElement.clientWidth-e-20,h>document.documentElement.clientLeft&&(n=h)));this.element.style.top=Math.ceil(t+1)+"px";this.element.style.left=Math.ceil(n+1)+"px";f.style.width=Math.ceil(e)+"px";this.element.style.zIndex=sf.popups.getZindexPartial(this.element).toString();f.style.visibility="";f.focus()}},r.prototype.setBlankIconStyle=function(n,t){var o=[].slice.call(n.getElementsByClassName("e-blankicon")),r=t?{padding:"paddingRight",cssSelector:"padding-right",margin:"marginLeft"}:{padding:"paddingLeft",cssSelector:"padding-left",margin:"marginRight"},f,e,i,u,s;([].slice.call(n.querySelectorAll('.e-menu-item[style*="'+r.cssSelector+'"]:not(.e-blankicon)')).forEach(function(n){n.style[r.padding]=""}),o.length)&&(f=n.querySelector(".e-menu-item:not(.e-blankicon):not(.e-separator)"),e=f.querySelector(".e-menu-icon"),e&&(i=getComputedStyle(e),u=parseInt(i.fontSize,10),parseInt(i.width,10)&&parseInt(i.width,10)>u&&(u=parseInt(i.width,10)),s=u+parseInt(i[r.margin],10)+parseInt(getComputedStyle(f)[r.padding],10)+"px",o.forEach(function(n){n.style[r.padding]=s})))},r.prototype.getMenuWidth=function(n,t,i){var r=n.getElementsByClassName("e-caret")[0];return r&&(t+=parseInt(getComputedStyle(r)[i?"marginRight":"marginLeft"],10)),t<120?120:t},r.prototype.addEventListener=function(){this.delegateMouseDownHandler=this.mouseDownHandler.bind(this);this.delegateMouseOverHandler=this.mouseOverHandler.bind(this);sf.base.EventHandler.add(document,"mousedown touchstart",this.delegateMouseDownHandler,this);sf.base.EventHandler.add(document,"mouseover",this.delegateMouseOverHandler,this);sf.base.EventHandler.add(this.element,"keydown",this.keyDownHandler,this)},r.prototype.removeEventListener=function(){sf.base.EventHandler.remove(document,"mousedown touchstart",this.delegateMouseDownHandler);sf.base.EventHandler.remove(document,"mouseover",this.delegateMouseOverHandler);sf.base.EventHandler.remove(this.element,"keydown",this.keyDownHandler)},r.prototype.mouseDownHandler=function(t){document.getElementById(this.element.id)?sf.base.closest(t.target,"#"+this.element.id)||!sf.base.isNullOrUndefined(this.menuId)&&sf.base.closest(t.target,this.menuId)||!sf.base.select("."+n,this.element)||this.dotnetRef.invokeMethodAsync(i,0,!1,!0,!1):this.removeEventListener()},r.prototype.mouseOverHandler=function(t){var r,u,f,e,o,s;if(document.getElementById(this.element.id)){if(r=t.target,u=[].slice.call(sf.base.selectAll("."+n,this.element)),u.length){if(f=sf.base.closest(r,".e-scroll-nav"),this.subMenuOpen&&(u.length>1||!sf.base.isNullOrUndefined(this.menuId)&&!f)){if(!sf.base.closest(r,"#"+this.element.id)&&(sf.base.isNullOrUndefined(this.menuId)||!sf.base.closest(r,this.menuId))||f){if(e=1,!sf.base.isNullOrUndefined(this.menuId)&&(e=0,f&&(e=u.indexOf(sf.base.select("."+n,f.parentElement))+1)===u.length))return;this.dotnetRef.invokeMethodAsync(i,e,!1,!0,!1);sf.base.isNullOrUndefined(this.menuId)||sf.base.closest(r,".e-scroll-nav")||this.destroyMenuScroll(null)}!sf.base.isNullOrUndefined(this.menuId)&&(sf.base.closest(r,"#"+this.element.id)||sf.base.closest(r,this.menuId))&&sf.base.closest(r,".e-menu-item")&&!sf.base.closest(r,".e-selected")&&this.destroyMenuScroll(sf.base.closest(r,"."+n))}this.openAsMenu||(o=document.activeElement,!sf.base.closest(o,"#"+this.element.id)&&u.length&&"BODY"==o.tagName&&(s=this.getLastMenu(),s&&s.focus()))}}else this.removeEventListener()},r.prototype.destroyMenuScroll=function(n){var t,i;sf.base.select(".e-menu-vscroll",this.element)&&(t=sf.base.select(this.menuId),t&&(i=t.blazor__instance,sf.base.isNullOrUndefined(i)||i.destroyScroll("none",n)))},r.prototype.hideMenu=function(t){var i,r;if(t){if(!(i=sf.base.select("."+n,this.element))||sf.base.isNullOrUndefined(this.element.parentElement))return null;this.element.parentElement!==document.body&&document.body.appendChild(this.element)}else{if(r=sf.base.selectAll("."+n,this.element),r.length<2)return null;i=r[r.length-1]}return i.style.width="",i.style.visibility="hidden",i.classList.remove("e-transparent"),i},r.prototype.subMenuPosition=function(t,i,r,u,f){var c,k,l,s,a,v,y,p,w;if(t){var b=sf.base.selectAll("."+n,this.element),e=b[b.length-2].querySelector(".e-menu-item.e-selected").getBoundingClientRect(),h=this.element.getBoundingClientRect(),o=t.classList.contains(n)?t:sf.base.select("."+n,t);this.setBlankIconStyle(o,i);l=o.getBoundingClientRect();s=this.getMenuWidth(o,l.width,i);i?(k=parseInt(getComputedStyle(o).borderWidth,10),c=e.left-s-h.left):c=e.right-h.left;a=e.top-h.top;i?e.left-k-s<document.documentElement.clientLeft&&e.right+s<document.documentElement.clientWidth&&(c=e.right-h.left):e.right+s>document.documentElement.clientWidth&&(v=e.left-s,v>document.documentElement.clientLeft&&(c=v-h.left));y=f||l.height;e.top+y>document.documentElement.clientHeight&&(p=document.documentElement.clientHeight-y-20,p>document.documentElement.clientTop&&(a=p-h.top));this.subMenuOpen=!r;t.style.left=Math.ceil(c)+"px";t.style.top=Math.ceil(a)+"px";t.style.width=Math.ceil(s)+"px";o.style.visibility="";w=o.querySelector(".e-menu-item.e-focused");w?w.focus():o.focus();u&&(this.openAsMenu=!0)}},r.prototype.getLastMenu=function(){var t=sf.base.selectAll("."+n,this.element);return t.length?t[t.length-1]:null},r.prototype.onPropertyChanged=function(n,t){switch(n){case"Target":this.addContextMenuEvent(!1);this.target=t;this.addContextMenuEvent();break;case"Filter":this.filter=t;break;case"ShowOn":this.addContextMenuEvent(!1);this.showOn=t;this.addContextMenuEvent()}},r.prototype.destroy=function(n){this.removeEventListener();this.addContextMenuEvent(!1);n&&n.parentElement&&n.previousElementSibling!==this.element&&n.parentElement.insertBefore(this.element,n);n&&n.parentElement||!this.element.parentElement||this.element.parentElement!==document.body||document.body.removeChild(this.element)},r.prototype.updateProperty=function(n,t){t&&(this.menuId="#"+t.id);this.subMenuOpen=!n},r}();return{initialize:function(n,t,i,u,f){sf.base.isNullOrUndefined(n)||new r(n,t,i,u,f)},contextMenuPosition:function(n,t,i,r,u,f){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.contextMenuPosition(t,i,r,u,f)},subMenuPosition:function(n,t,i,r){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var u=n.blazor__instance.hideMenu();n.blazor__instance.subMenuPosition(u,t,i,r)}},onPropertyChanged:function(n,t,i){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.onPropertyChanged(t,i)},destroy:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.destroy(t)}}}()},"./modules/sf-datepicker.js":function(){window.sfBlazor=window.sfBlazor||{};window.sfBlazor.DatePicker=function(){"use strict";var n="e-datepicker",t=function(){function t(n,t,i,r){this.containerElement=n;this.element=t;this.options=r;this.element.blazor__instance=this;this.dotNetRef=i}return t.prototype.initialize=function(){this.defaultKeyConfigs={altUpArrow:"alt+uparrow",altDownArrow:"alt+downarrow",escape:"escape",enter:"enter",controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",shiftTab:"shift+tab",tab:"tab"};this.defaultKeyConfigs=sf.base.extend(this.defaultKeyConfigs,this.options.keyConfigs);new sf.base.KeyboardEvents(this.element,{eventName:"keydown",keyAction:this.inputKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs});this.index=this.options.showClearButton?2:1;sf.base.EventHandler.add(this.element,"blur",this.inputBlurHandler,this)},t.prototype.inputKeyActionHandle=function(n){var r,t,i;this.popupObj&&this.popupObj.element.classList.contains("e-popup")&&this.options.isDatePopup?(t=this.tableBodyElement.querySelector("tr td.e-focused-date"),i=this.tableBodyElement.querySelector("tr td.e-selected"),this.tableBodyElement.focus(),r={Action:n.action,Key:n.key,Events:n,SelectDate:i?i.id:null,FocusedDate:t?t.id:null,classList:i?i.classList.toString():t?t.classList.toString():"e-cell",Id:t?t.id:i?i.id:null,TargetClassList:this.calendarElement.classList.toString()}):r={Action:n.action,Key:n.key,Events:n};this.isDisposed||this.dotNetRef.invokeMethodAsync("InputKeyActionHandle",r);"select"!==n.action&&this.popupObj&&document.body.contains(this.popupObj.element)&&n.preventDefault()},t.prototype.inputBlurHandler=function(n){this.isCalendar()&&document.activeElement===this.element&&this.dotNetRef.invokeMethodAsync("HidePopup",n)},t.prototype.renderPopup=function(n,t,i,r){var u,f;(this.options=r,this.popupHolder=t,n)&&(u=document.getElementById(n.id),u&&sf.base.remove(u));this.createCalendar(n,r);sf.base.Browser.isDevice&&(this.mobilePopupContainer=sf.base.createElement("div",{className:"e-datepick-mob-popup-wrap"}),document.body.appendChild(this.mobilePopupContainer));("model"===i.appendTo&&this.mobilePopupContainer?this.mobilePopupContainer:document.body).appendChild(this.popupContainer);this.popupObj.refreshPosition(this.element);r.isDatePopup||this.setScrollPosition();f={name:"FadeIn",duration:sf.base.Browser.isDevice?0:300};1e3===this.options.zIndex?this.popupObj.show(new sf.base.Animation(f),this.element):this.popupObj.show(new sf.base.Animation(f),null);this.setOverlayIndex(this.mobilePopupContainer,this.popupObj.element,this.modal,sf.base.Browser.isDevice);sf.base.EventHandler.add(document,"mousedown touchstart",this.documentHandler,this)},t.prototype.setOverlayIndex=function(n,t,i,r){if(r&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(n)){var u=parseInt(t.style.zIndex,10)?parseInt(t.style.zIndex,10):1e3;i.style.zIndex=(u-1).toString();n.style.zIndex=u.toString()}},t.prototype.closePopup=function(n,t){this.options=t;this.closeEventCallback(n)},t.prototype.createCalendar=function(t,i){var r=this,u,f;this.popupContainer=t;this.calendarElement=this.popupContainer.firstElementChild;this.tableBodyElement=sf.base.select("tbody",this.calendarElement);u=n+" e-date-modal";f="e-date-overflow";i.isDatePopup?this.calendarElement.querySelector("table tbody").className="":(u="e-datetimepicker e-time-modal",f="e-time-overflow");sf.base.Browser.isDevice&&(this.modal=sf.base.createElement("div"),this.modal.className=u,document.body.classList.add(f),this.modal.style.display="block",document.body.appendChild(this.modal));this.popupObj=new sf.popups.Popup(this.popupContainer,{width:i.isDatePopup?"auto":this.setPopupWidth(this.options.width),relateTo:sf.base.Browser.isDevice?document.body:this.containerElement,position:sf.base.Browser.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},offsetY:4,targetType:"container",enableRtl:i.enableRtl,zIndex:i.zIndex,collision:sf.base.Browser.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},open:function(){document.activeElement!==r.element&&i.isDatePopup&&(r.defaultKeyConfigs=sf.base.extend(r.defaultKeyConfigs,i.keyConfigs),r.calendarElement.children[1].firstElementChild.focus(),new sf.base.KeyboardEvents(r.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:r.CalendarKeyActionHandle.bind(r),keyConfigs:r.defaultKeyConfigs}),new sf.base.KeyboardEvents(r.containerElement.children[r.index],{eventName:"keydown",keyAction:r.CalendarKeyActionHandle.bind(r),keyConfigs:r.defaultKeyConfigs}))},close:function(){r.popupHolder.appendChild(r.popupContainer);r.popupObj&&r.popupObj.destroy();r.isDisposed||r.dotNetRef.invokeMethodAsync("ClosePopup").catch(function(){});r.popupObj=null},targetExitViewport:function(){sf.base.Browser.isDevice||r.isDisposed||r.dotNetRef.invokeMethodAsync("HidePopup",null)}});i.isDatePopup||(this.popupObj.element.style.maxHeight="240px")},t.prototype.getPopupHeight=function(){var n=parseInt("240px",10),t=this.popupContainer.getBoundingClientRect().height;return t>n?n:t},t.prototype.setScrollPosition=function(){if((this.popupContainer&&this.popupContainer.querySelector(".e-navigation")||this.popupContainer.querySelector(".e-active"))&&!this.options.isDatePopup){var n=this.popupContainer.querySelector(".e-navigation")||this.popupContainer.querySelector(".e-active");this.findScrollTop(n)}},t.prototype.findScrollTop=function(n){var r=this.getPopupHeight(),t=n.nextElementSibling,i=t?t.offsetTop:n.offsetTop,u=n.getBoundingClientRect().height;this.popupContainer.scrollTop=i+n.offsetTop>r?t?i-(r/2+u/2):i:0},t.prototype.closeEventCallback=function(n){var t=n;this.isCalendar()&&!t.cancel&&this.popupObj&&this.popupObj.hide();sf.base.Browser.isDevice&&this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null);sf.base.Browser.isDevice&&(sf.base.removeClass([document.body],"e-date-overflow"),sf.base.removeClass([document.body],"e-time-overflow"),sf.base.isNullOrUndefined(this.mobilePopupContainer)||(this.mobilePopupContainer.remove(),this.mobilePopupContainer=null));sf.base.EventHandler.remove(document,"mousedown touchstart",this.documentHandler);sf.base.Browser.isDevice&&this.options.allowEdit&&!this.options.readonly&&this.element.removeAttribute("readonly")},t.prototype.documentHandler=function(t){!sf.base.isNullOrUndefined(this.popupObj)&&(this.containerElement.contains(t.target)||this.popupObj.element&&this.popupObj.element.contains(t.target))&&"touchstart"!==t.type&&t.preventDefault();var u=this.containerElement.querySelector(".e-clear-icon"),f=this.tableBodyElement?this.tableBodyElement.querySelector(".e-selected"):null,r=this.options.value?this.options.value.toString():null,i=t.target;i==u&&f&&sf.base.removeClass([this.tableBodyElement.querySelector(".e-selected")],"e-selected");sf.base.closest(i,"."+n+".e-popup-wrapper")||sf.base.closest(i,".e-datetimepicker.e-popup-wrapper")||sf.base.closest(i,".e-input-group")===this.containerElement||i.classList.contains("e-day")||this.isDisposed?sf.base.closest(i,"."+n+".e-popup-wrapper")&&(i.classList.contains("e-day")&&!sf.base.isNullOrUndefined(t.target.parentElement)&&t.target.parentElement.classList.contains("e-selected")&&sf.base.closest(i,".e-content")&&sf.base.closest(i,".e-content").classList.contains("e-"+this.options.depth.toLowerCase())&&!this.isDisposed||sf.base.closest(i,".e-footer-container")&&i.classList.contains("e-today")&&i.classList.contains("e-btn")&&+new Date(r)==+this.generateTodayVal(new Date(r))&&!this.isDisposed)&&this.dotNetRef.invokeMethodAsync("HidePopup",t):(this.dotNetRef.invokeMethodAsync("HidePopup",t),this.element.focus())},t.prototype.generateTodayVal=function(n){var t=new Date;return n?(t.setHours(n.getHours()),t.setMinutes(n.getMinutes()),t.setSeconds(n.getSeconds()),t.setMilliseconds(n.getMilliseconds())):t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),t},t.prototype.isCalendar=function(){return this.popupContainer&&this.popupContainer.classList.contains("e-popup-wrapper")},t.prototype.CalendarKeyActionHandle=function(n){switch(n.action){case this.defaultKeyConfigs.escape:this.isCalendar()?this.dotNetRef.invokeMethodAsync("HidePopup",n):this.element.blur();break;case this.defaultKeyConfigs.enter:this.isCalendar()||this.dotNetRef.invokeMethodAsync("ShowPopup",n);break;case this.defaultKeyConfigs.tab:this.dotNetRef.invokeMethodAsync("HidePopup",n)}},t.prototype.setWidth=function(n){return"number"==typeof n?sf.base.formatUnit(n):"string"==typeof n?n.match(/px|%|em/)?n:sf.base.formatUnit(n):"100%"},t.prototype.setPopupWidth=function(n){return(n=this.setWidth(n)).indexOf("%")>-1&&(n=(this.containerElement.getBoundingClientRect().width*parseFloat(n)/100).toString()+"px"),n},t}();return{initialize:function(n,i,r,u){i&&new t(n,i,r,u);i&&i.blazor__instance&&i.blazor__instance.initialize()},renderPopup:function(n,t,i,r,u){n&&n.blazor__instance&&t&&i&&n.blazor__instance.renderPopup(t,i,r,u)},updateScrollPosition:function(n){n&&n.blazor__instance&&n.blazor__instance.setScrollPosition()},closePopup:function(n,t,i,r,u){n&&n.blazor__instance&&n.blazor__instance.closePopup(r,u)},focusIn:function(n){n&&n.focus()},focusOut:function(n){n&&n.blur()},destroy:function(n,t,i,r,u){n&&n.blazor__instance&&t&&_instanceof(t,HTMLElement)&&i&&(n.blazor__instance.isDisposed=!0,n.blazor__instance.closePopup(r,u))}}}()},"./modules/sf-dialog.js":function(){window.sfBlazor=window.sfBlazor||{};window.sfBlazor.Dialog=function(){"use strict";var n="e-dlg-target",t=function(){function t(n,t,i){this.hasFocusableNode=!1;this.createdEnabled=!1;this.element=n;this.dotNetRef=i;this.updateContext(t);this.element&&(this.element.blazor__instance=this)}return t.prototype.initialize=function(){this.dlgContainer=void 0;this.popupObj=null;this.calculatezIndex=1e3===this.zIndex;this.render();this.createdEnabled&&this.dotNetRef.invokeMethodAsync("CreatedEvent",null);this.element.classList.remove("e-blazor-hidden");this.visible?this.dotNetRef.invokeMethodAsync("ShowDialog",null):this.isModal&&(this.dlgOverlay.style.display="none");this.setWidth();this.setMinHeight();this.enableResize&&(this.setResize(),"None"===this.animationSettings.effect&&this.getMinHeight());this.bindEvent(this.element)},t.prototype.updateContext=function(n){sf.base.extend(this,this,n)},t.prototype.setWidth=function(){"100%"===this.width?this.element.style.width="":(sf.base.setStyleAttribute(this.element,{width:sf.base.formatUnit(this.width)}),"auto"===this.width&&this.refreshPosition())},t.prototype.setHeight=function(){sf.base.setStyleAttribute(this.element,{height:sf.base.formatUnit(this.height)})},t.prototype.setMinHeight=function(){""!==this.minHeight&&sf.base.setStyleAttribute(this.element,{minHeight:sf.base.formatUnit(this.minHeight)})},t.prototype.render=function(){var n=this,t;(this.checkPositionData(),this.targetEle=this.getTargetEle(this.target),sf.base.Browser.isDevice&&sf.base.addClass([this.element],"e-device"),sf.base.isNullOrUndefined(this.headerContent)&&(this.headerContent=this.element.querySelector(".e-dlg-header-content")),sf.base.isNullOrUndefined(this.contentEle)&&(this.contentEle=this.element.querySelector(".e-dlg-content")),this.setMaxHeight(),1e3===this.zIndex&&this.setzIndex(this.element,!1),this.allowDragging&&!sf.base.isNullOrUndefined(this.headerContent)&&this.setAllowDragging(),this.isModal&&sf.base.isNullOrUndefined(this.dlgContainer)&&(this.dlgContainer=this.element.parentElement,this.dlgOverlay=this.element.parentElement.getElementsByClassName("e-dlg-overlay")[0]),sf.base.isNullOrUndefined(this.element.parentElement))||(t=this.isModal?this.dlgContainer.parentElement:this.element.parentElement,this.refElement=sf.base.createElement("div",{className:"e-dlg-ref-element"}),t.insertBefore(this.refElement,this.isModal?this.dlgContainer:this.element));sf.base.isNullOrUndefined(this.targetEle)||(this.isModal?this.targetEle.appendChild(this.dlgContainer):this.targetEle.appendChild(this.element));this.popupObj=new sf.popups.Popup(this.element,{height:this.height,width:this.width,zIndex:this.zIndex,relateTo:this.getTargetEle(this.target),actionOnScroll:"none",enableRtl:this.enableRtl,open:function(){n.enableResize&&n.resetResizeIcon();n.dotNetRef.invokeMethodAsync("OpenEvent",n.element.classList.toString())},close:function(){n.isModal&&(sf.base.addClass([n.dlgOverlay],"e-fade"),n.dlgContainer.style.display="none");n.hasFocusableNode=!1;n.dotNetRef.invokeMethodAsync("CloseEvent",n.element.classList.toString())}});this.positionChange();this.setEnableRTL()},t.prototype.checkPositionData=function(){sf.base.isNullOrUndefined(this.position)||(sf.base.isNullOrUndefined(this.position.X)||"number"==typeof this.position.X||this.isNumberValue(this.position.X)&&(this.position.X=parseFloat(this.position.X)),sf.base.isNullOrUndefined(this.position.Y)||"number"==typeof this.position.Y||this.isNumberValue(this.position.Y)&&(this.position.Y=parseFloat(this.position.Y)))},t.prototype.isNumberValue=function(n){return/^[-+]?\d*\.?\d+$/.test(n)},t.prototype.getTargetEle=function(n){var t;return sf.base.isNullOrUndefined(n)||"string"!=typeof n||(t=document.querySelector(n)),sf.base.isNullOrUndefined(t)?document.body:t},t.prototype.setMaxHeight=function(){if(this.allowMaxHeight){var n=this.element.style.display;this.element.style.display="none";this.element.style.maxHeight=!sf.base.isNullOrUndefined(this.target)&&this.targetEle.offsetHeight<window.innerHeight?this.targetEle.offsetHeight-20+"px":window.innerHeight-20+"px";this.element.style.display=n;sf.base.Browser.isIE&&"auto"===this.height&&!sf.base.isNullOrUndefined(this.contentEle)&&this.element.offsetHeight<this.contentEle.offsetHeight&&(this.element.style.height="inherit")}},t.prototype.setzIndex=function(n,t){this.zIndex=sf.popups.getZindexPartial(n);t&&(this.popupObj.zIndex=this.zIndex)},t.prototype.updatezIndex=function(){this.popupObj.zIndex=this.zIndex;this.isModal&&this.setOverlayZindex(this.zIndex);this.calculatezIndex=this.element.style.zIndex===this.zIndex.toString()},t.prototype.updateTarget=function(){this.targetEle=this.getTargetEle(this.target);this.popupObj.relateTo=this.targetEle;this.dragObj&&(this.dragObj.dragArea=this.targetEle);this.setMaxHeight();this.isModal&&this.targetEle.appendChild(this.dlgContainer);this.enableResize&&this.setResize()},t.prototype.resetResizeIcon=function(){var t=this.getMinHeight(),n;this.targetEle.offsetHeight<t&&(n=this.element.querySelector("."+this.resizeIconDirection),sf.base.isNullOrUndefined(n)||(n.style.bottom="-"+t.toString()+"px"))},t.prototype.getMouseEvtArgs=function(n){return{altKey:n.altKey,button:n.button,buttons:n.buttons,clientX:n.clientX,clientY:n.clientY,ctrlKey:n.ctrlKey,detail:n.detail,metaKey:n.metaKey,screenX:n.screenX,screenY:n.screenY,shiftKey:n.shiftKey,type:n.type}},t.prototype.setAllowDragging=function(){var n=this;this.dragObj=new sf.base.Draggable(this.element,{clone:!1,isDragScroll:!0,abort:".e-dlg-closeicon-btn",handle:".e-dlg-header-content",dragStart:function(t){n.dotNetRef.invokeMethodAsync("DragStartEvent",{target:{ID:t.target.id},event:n.getMouseEvtArgs(t.event)});t.bindEvents(t.dragElement)},drag:function(t){n.dotNetRef.invokeMethodAsync("DragEvent",{target:{ID:t.target.id},event:n.getMouseEvtArgs(t.event)})},dragStop:function(t){n.isModal&&(sf.base.isNullOrUndefined(n.position)||n.dlgContainer.classList.remove("e-dlg-"+n.position.X+"-"+n.position.Y),n.element.style.position="relative");n.dotNetRef.invokeMethodAsync("DragStopEvent",{target:{ID:t.target.id},event:n.getMouseEvtArgs(t.event)});n.element.classList.remove("e-restrict-left")}});sf.base.isNullOrUndefined(this.targetEle)||(this.dragObj.dragArea=this.targetEle)},t.prototype.positionChange=function(){this.isModal&&(isNaN(parseFloat(this.position.X))||isNaN(parseFloat(this.position.Y)))?!isNaN(parseFloat(this.position.X))&&isNaN(parseFloat(this.position.Y))||isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():(this.element.style.top="0px",this.element.style.left="0px",this.dlgContainer.classList.add("e-dlg-"+this.position.X+"-"+this.position.Y)):this.setPopupPosition()},t.prototype.setPopupPosition=function(){this.popupObj.setProperties({position:{X:this.position.X,Y:this.position.Y}})},t.prototype.setEnableRTL=function(){var n=this.element.querySelector(".e-resize-handle");sf.base.isNullOrUndefined(n)||n.parentElement!==this.element||(sf.popups.removeResize(),this.setResize())},t.prototype.setResize=function(){if(this.enableResize){if(!sf.base.isNullOrUndefined(this.element.querySelector(".e-icons.e-resize-handle")))return;var t=getComputedStyle(this.element).minHeight,n=getComputedStyle(this.element).minWidth;this.isModal&&this.enableRtl?this.element.classList.add("e-restrict-left"):!this.isModal||this.target!==document.body&&"body"!==this.target||this.element.classList.add("e-resize-viewport");sf.popups.createResize({element:this.element,direction:this.resizeIconDirection,minHeight:parseInt(t.slice(0,n.indexOf("p")),10),maxHeight:this.targetEle.clientHeight,minWidth:parseInt(n.slice(0,n.indexOf("p")),10),maxWidth:this.targetEle.clientWidth,boundary:"body"===this.target||"document.body"===this.target?null:this.targetEle,resizeBegin:this.onResizeStart.bind(this),resizeComplete:this.onResizeComplete.bind(this),resizing:this.onResizing.bind(this),proxy:this});this.wireWindowResizeEvent()}else sf.popups.removeResize(),this.unWireWindowResizeEvent(),this.isModal?this.element.classList.remove("e-restrict-left"):this.element.classList.remove("e-resize-viewport")},t.prototype.getMinHeight=function(){var t="0px",i="0px",r,u,n;return sf.base.isNullOrUndefined(this.element.querySelector(".e-dlg-header-content"))||(t=getComputedStyle(this.headerContent).height),r=sf.base.select(".e-footer-content",this.element),sf.base.isNullOrUndefined(r)||(i=getComputedStyle(r).height),u=parseInt(t.slice(0,t.indexOf("p")),10),n=parseInt(i.slice(0,i.indexOf("p")),10),sf.popups.setMinHeight(u+30+(isNaN(n)?0:n)),u+30+n},t.prototype.changePosition=function(n){this.isModal&&this.dlgContainer.classList.contains("e-dlg-"+this.position.X+"-"+this.position.Y)&&this.dlgContainer.classList.remove("e-dlg-"+this.position.X+"-"+this.position.Y);this.updateContext(n);this.checkPositionData();this.positionChange()},t.prototype.setOverlayZindex=function(n){var t;t=sf.base.isNullOrUndefined(n)?parseInt(this.element.style.zIndex,10)?parseInt(this.element.style.zIndex,10):this.zIndex:n;this.dlgOverlay.style.zIndex=(t-1).toString();this.dlgContainer.style.zIndex=t.toString()},t.prototype.focusContent=function(n){var t=this.getAutoFocusNode(n);(sf.base.isNullOrUndefined(t)?n:t).focus();this.hasFocusableNode=!0},t.prototype.getAutoFocusNode=function(n){var i=n.querySelector(".e-dlg-closeicon-btn"),r=n.querySelectorAll("[autofocus]"),t=this.getValidFocusNode(r);if(this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0],sf.base.isNullOrUndefined(t)){if(t=this.focusableElements(this.contentEle),!sf.base.isNullOrUndefined(t))return t;if(!sf.base.isNullOrUndefined(this.primaryButtonEle))return this.element.querySelector(".e-primary")}else i=t;return i},t.prototype.getValidFocusNode=function(n){for(var t,i=0;i<n.length;i++){if(((t=n[i]).clientHeight>0||"a"===t.tagName.toLowerCase()&&t.hasAttribute("href"))&&t.tabIndex>-1&&!t.disabled&&!this.disableElement(t,'[disabled],[aria-disabled="true"],[type="hidden"]'))return t;t=null}return t},t.prototype.disableElement=function(n,t){var i=n?n.matches||n.webkitMatchesSelector||n.msGetRegionContent:null;if(i)for(;n;n=n.parentNode)if(_instanceof(n,Element)&&i.call(n,t))return n;return null},t.prototype.focusableElements=function(n){if(!sf.base.isNullOrUndefined(n)){var t=n.querySelectorAll('input,select,textarea,button,a,[contenteditable="true"],[tabindex]');return this.getValidFocusNode(t)}return null},t.prototype.getMaxHeight=function(n){return n.style.maxHeight},t.prototype.OnPropertyChanged=function(n,t){this.updateContext(n);for(var i=0,r=t;i<r.length;i++)switch(r[i]){case"width":sf.base.setStyleAttribute(this.element,{width:sf.base.formatUnit(this.width)});break;case"height":this.setHeight();break;case"minHeight":this.setMinHeight();break;case"target":this.updateTarget();break;case"zIndex":this.updatezIndex();break;case"allowDragging":this.setAllowDragging();break;case"destroyDraggable":this.destroyDraggable();break;case"enableRtl":this.setEnableRTL();break;case"enableResize":this.setResize()}},t.prototype.fullScreen=function(t){if(t){sf.base.addClass([this.element],"e-dlg-fullscreen");var i=this.element.style.display;this.element.style.display="none";this.element.style.maxHeight=sf.base.isNullOrUndefined(this.target)?window.innerHeight+"px":this.targetEle.offsetHeight+"px";this.element.style.display=i;sf.base.addClass([document.body],[n,"e-scroll-disabled"]);this.allowDragging&&!sf.base.isNullOrUndefined(this.dragObj)&&(this.dragObj.destroy(),this.dragObj=void 0)}else sf.base.removeClass([this.element],"e-dlg-fullscreen"),sf.base.removeClass([document.body],[n,"e-scroll-disabled"]),this.allowDragging&&!sf.base.isNullOrUndefined(this.headerContent)&&this.setAllowDragging()},t.prototype.show=function(t,i,r){if(this.updateContext(r),!this.element.classList.contains("e-popup-open")||!sf.base.isNullOrUndefined(t)){sf.base.isNullOrUndefined(t)||this.fullScreen(t);this.element.style.maxHeight!==i&&(this.allowMaxHeight=!1,this.element.style.maxHeight=i);this.storeActiveElement=document.activeElement;this.element.tabIndex=-1;this.isModal&&sf.base.isNullOrUndefined(this.dlgOverlay)&&(this.dlgOverlay=this.element.parentElement.querySelector(".e-dlg-overlay"));this.isModal&&!sf.base.isNullOrUndefined(this.dlgOverlay)&&(this.dlgOverlay.style.display="block",this.dlgContainer.style.display="flex",sf.base.removeClass([this.dlgOverlay],"e-fade"),sf.base.isNullOrUndefined(this.targetEle)?sf.base.addClass([document.body],[n,"e-scroll-disabled"]):(this.dlgContainer.style.position=this.targetEle===document.body?"fixed":"absolute",this.dlgOverlay.style.position="absolute",this.element.style.position="relative",sf.base.addClass([this.targetEle],[n,"e-scroll-disabled"])));var u={name:this.animationSettings.effect+"In",duration:this.animationSettings.duration,delay:this.animationSettings.delay},f=this.isModal?this.element.parentElement:this.element;this.calculatezIndex&&(this.setzIndex(f,!0),sf.base.setStyleAttribute(this.element,{zIndex:this.zIndex}),this.isModal&&this.setOverlayZindex(this.zIndex));"None"===this.animationSettings.effect?this.popupObj.show():this.popupObj.show(u)}},t.prototype.hide=function(){this.isModal&&(sf.base.isNullOrUndefined(this.targetEle)?sf.base.removeClass([document.body],[n,"e-scroll-disabled"]):sf.base.removeClass([this.targetEle],[n,"e-scroll-disabled"]));var t={name:this.animationSettings.effect+"Out",duration:this.animationSettings.duration,delay:this.animationSettings.delay};"None"===this.animationSettings.effect?this.popupObj.hide():this.popupObj.hide(t)},t.prototype.refreshPosition=function(){this.isModal?(this.element.style.top=this.element.style.left="0px",this.dlgContainer.classList.add("e-dlg-"+this.position.X+"-"+this.position.Y)):this.popupObj.refreshPosition()},t.prototype.destroyDraggable=function(){sf.base.isNullOrUndefined(this.dragObj)||(this.dragObj.destroy(),this.dragObj=void 0)},t.prototype.destroy=function(t,i){var u,e,r,f;if(this.updateContext(t),u=["role","aria-modal","aria-labelledby","aria-describedby","aria-grabbed","tabindex","style"],sf.base.isNullOrUndefined(this.cssClass)||""===this.cssClass||(e=this.cssClass.split(" "),sf.base.removeClass([this.element],e)),sf.base.Browser.isDevice&&sf.base.removeClass([this.element],"e-device"),sf.base.removeClass([this.getTargetEle(this.target)],[n,"e-scroll-disabled"]),this.unBindEvent(this.element),this.element.classList.contains("e-dlg-fullscreen")&&sf.base.removeClass([document.body],[n,"e-scroll-disabled"]),this.isModal&&sf.base.removeClass([sf.base.isNullOrUndefined(this.targetEle)?document.body:this.targetEle],"e-scroll-disabled"),this.element.classList.contains("e-dlg-resizable")&&this.element.classList.remove("e-dlg-resizable"),this.element.classList.contains("e-draggable")&&(this.dragObj.destroy(),this.dragObj=void 0),this.element.classList.contains("e-popup")&&(this.popupObj.destroy(),this.popupObj=void 0),sf.base.isNullOrUndefined(this.refElement)||sf.base.isNullOrUndefined(this.refElement.parentElement)||(this.refElement.parentElement.insertBefore(this.isModal?this.dlgContainer:this.element,this.refElement),sf.base.detach(this.refElement),this.refElement=void 0),i)for(r=0;r<this.element.children.length;r++)this.element.children[r].classList.add("e-hide");else if(!sf.base.isNullOrUndefined(this.element.children))for(r=0;r<=this.element.children.length;r++)r-=r,sf.base.detach(this.element.children[r]);for(r=0;r<u.length;r++)this.element.removeAttribute(u[r]);this.isModal&&(sf.base.detach(this.element.nextElementSibling),f=this.element.parentElement,f.removeAttribute("class"),f.removeAttribute("style"),this.element.classList.remove("e-dlg-modal"));this.element.classList.remove("e-dialog")},t.prototype.bindEvent=function(n){sf.base.EventHandler.add(n,"keydown",this.keyDown,this)},t.prototype.unBindEvent=function(n){sf.base.EventHandler.remove(n,"keydown",this.keyDown)},t.prototype.wireWindowResizeEvent=function(){window.addEventListener("resize",this.windowResizeHandler.bind(this))},t.prototype.unWireWindowResizeEvent=function(){window.removeEventListener("resize",this.windowResizeHandler.bind(this))},t.prototype.popupCloseHandler=function(){var n=document.activeElement;sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blur)||n.blur();sf.base.isNullOrUndefined(this.storeActiveElement)||sf.base.isNullOrUndefined(this.storeActiveElement.focus)||this.storeActiveElement.focus()},t.prototype.windowResizeHandler=function(){sf.popups.setMaxWidth(this.targetEle.clientWidth);sf.popups.setMaxHeight(this.targetEle.clientHeight);this.setMaxHeight()},t.prototype.onResizeStart=function(n){var t=this.getMouseEvtArgs(n);this.dotNetRef.invokeMethodAsync("ResizeStartEvent",t)},t.prototype.onResizing=function(n){this.dotNetRef.invokeMethodAsync("ResizingEvent",this.getMouseEvtArgs(n))},t.prototype.onResizeComplete=function(n){this.dotNetRef.invokeMethodAsync("ResizeStopEvent",this.getMouseEvtArgs(n))},t.prototype.getFocusElement=function(n){var t=n.querySelectorAll('input,select,textarea,button:enabled,a,[contenteditable="true"],[tabindex]');return t[t.length-1]},t.prototype.keyDown=function(n){var o=this;if(9===n.keyCode&&this.isModal){var t=void 0,u=void 0,i=this.element.querySelector(".e-footer-content");sf.base.isNullOrUndefined(i)||(u=i.querySelectorAll("button"),!sf.base.isNullOrUndefined(t)&&u.length>0&&(t=u[u.length-1]),sf.base.isNullOrUndefined(t)&&i.childNodes.length>0&&(t=this.getFocusElement(i)));sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(this.contentEle)&&(t=this.getFocusElement(this.contentEle));sf.base.isNullOrUndefined(t)||document.activeElement!==t||n.shiftKey||(n.preventDefault(),this.focusableElements(this.element).focus());document.activeElement===this.focusableElements(this.element)&&n.shiftKey&&(n.preventDefault(),sf.base.isNullOrUndefined(t)||t.focus())}if(27===n.keyCode&&this.closeOnEscape&&this.dotNetRef.invokeMethodAsync("CloseDialog",{altKey:n.altKey,ctrlKey:n.ctrlKey,code:n.code,key:n.key,location:n.location,repeat:n.repeat,shiftKey:n.shiftKey,metaKey:n.metaKey,type:n.type}),this.hasFocusableNode){var r=document.activeElement,f=["input","textarea"].indexOf(r.tagName.toLowerCase())>-1,e=!1;f||(e=r.hasAttribute("contenteditable")&&"true"===r.getAttribute("contenteditable"));(13===n.keyCode&&!n.ctrlKey&&"textarea"!==r.tagName.toLowerCase()&&f&&!sf.base.isNullOrUndefined(this.primaryButtonEle)||13===n.keyCode&&n.ctrlKey&&("textarea"===r.tagName.toLowerCase()||e)&&!sf.base.isNullOrUndefined(this.primaryButtonEle))&&setTimeout(function(){o.element.querySelector(".e-footer-content button.e-btn.e-primary").click()})}},t}();return{initialize:function(n,i,r){n&&(new t(n,i,r),n.blazor__instance.initialize())},getClassList:function(n){return n&&n.classList.toString()},getMaxHeight:function(n){return n?n.blazor__instance.getMaxHeight(n):null},changePosition:function(n){sf.base.isNullOrUndefined(n.element)||n.element.blazor__instance.changePosition(n)},focusContent:function(n){sf.base.isNullOrUndefined(n)||n.blazor__instance.focusContent(n)},refreshPosition:function(n){sf.base.isNullOrUndefined(n)||n.blazor__instance.refreshPosition()},popupCloseHandler:function(n){sf.base.isNullOrUndefined(n)||n.blazor__instance.popupCloseHandler()},propertyChanged:function(n,t){sf.base.isNullOrUndefined(n.element)||n.element.blazor__instance.OnPropertyChanged(n,t)},show:function(n,t,i){i.element&&i.element.blazor__instance.show(n,t,i)},hide:function(n){sf.base.isNullOrUndefined(n)||n.blazor__instance.hide()},destroy:function(n,t){var i=n&&n.element;sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.blazor__instance)||i.blazor__instance.destroy(n,t)}}}()},"./modules/sf-documenteditor.js":function(){function n(t){return(n="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(n){return _typeof2(n)}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":_typeof2(n)})(t)}window.sfBlazor=window.sfBlazor||{};window.sfBlazor.DocumentEditor=function(){"use strict";!function(){function n(n,t,i,r){this.previousContext="";this.showHeaderProperties=!0;this.element=n;sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(n)||(this.element.blazor__instance=this),this.dotNetRef=r,this.element=n,this.options=t,this.editorOptions=i,this.updateOptions(t))}Object.defineProperty(n.prototype,"documentEditor",{get:function(){return this.documentEditorInternal},enumerable:!0,configurable:!0});n.prototype.updateOptions=function(n){this.showPropertiesPane=n.showPropertiesPane;this.currentUser=n.currentUser;this.enableComment=n.enableComment;this.enableLocalPaste=n.enableLocalPaste;this.enableSpellCheck=n.enableSpellCheck;this.enableTrackChanges=n.enableTrackChanges;this.height=n.height;this.serviceUrl=n.serviceUrl;this.userColor=n.userColor;this.width=n.width;this.zIndex=n.zIndex;this.requiredModules()};n.prototype.setOptions=function(n){for(var u,t,i=0,r=Object.keys(n);i<r.length;i++)if(u=r[i],t=n[u],!sf.base.isNullOrUndefined(t))switch(u){case"zoomFactor":this.documentEditor.zoomFactor=t;this.documentEditor.onPropertyChanged({zoomFactor:t},null);break;case"layoutType":this.documentEditor.layoutType=t;this.documentEditor.onPropertyChanged({layoutType:t},null);break;case"enableTrackChanges":this.enableTrackChanges=t;this.documentEditor.enableTrackChanges=t;this.documentEditor.showRevisions=t;this.documentEditor.onPropertyChanged({enableTrackChanges:t},null);this.documentEditor.onPropertyChanged({showRevisions:t},null);break;case"restrictEditing":this.restrictEditing=t;this.documentEditor.isReadOnly=t;this.documentEditor.onPropertyChanged({isReadOnly:t},null);break;case"enableLocalPaste":this.enableLocalPaste=t;this.documentEditor.enableLocalPaste=t;this.documentEditor.onPropertyChanged({enableLocalPaste:t},null)}};n.prototype.getModuleName=function(){return"DocumentEditorContainer"};n.prototype.onPropertyChanged=function(n){for(var r,t=0,i=Object.keys(n);t<i.length;t++)switch(i[t]){case"restrictEditing":this.documentEditor.isReadOnly=n.restrictEditing;break;case"showPropertiesPane":this.showHidePropertiesPane(n.showPropertiesPane);break;case"enableTrackChanges":this.documentEditor&&(this.documentEditor.enableTrackChanges=n.enableTrackChanges,this.documentEditor.showRevisions=n.enableTrackChanges,this.documentEditor.resize());break;case"enableLocalPaste":this.documentEditor&&(this.documentEditor.enableLocalPaste=n.enableLocalPaste);break;case"serviceUrl":this.documentEditor&&(this.documentEditor.serviceUrl=n.serviceUrl);break;case"serverActionSettings":this.documentEditor&&this.setserverActionSettings();break;case"zIndex":this.documentEditor&&(this.documentEditor.zIndex=n.zIndex);break;case"enableComment":this.documentEditor&&(this.documentEditor.enableComment=n.enableComment);break;case"enableSpellCheck":this.documentEditor&&(this.documentEditor.enableSpellCheck=n.enableSpellCheck);break;case"documentEditorSettings":this.documentEditor&&this.customizeDocumentEditorSettings();break;case"currentUser":this.documentEditor&&(this.documentEditor.currentUser=n.currentUser);break;case"userColor":this.documentEditor&&(this.documentEditor.userColor=n.userColor);break;case"layoutType":this.documentEditor&&(this.documentEditor.layoutType=n.layoutType);break;case"enableToolbar":this.documentEditor&&this.documentEditor.resize();break;case"height":r="";r=-1!==this.height.indexOf("%")?window.innerHeight*(parseInt(this.height)/100)+"px":sf.base.formatUnit(this.height);this.element.style.height=r;this.documentEditor&&this.documentEditor.resize();break;case"width":this.element.style.width=sf.base.formatUnit(this.width);this.documentEditor&&this.documentEditor.resize()}};n.prototype.preRender=function(){var n="";n=-1!==this.height.indexOf("%")?window.innerHeight*(parseInt(this.height)/100)+"px":sf.base.formatUnit(this.height);this.element.style.height=n;""!==this.width&&(this.element.style.width=sf.base.formatUnit(this.width));this.element.style.minHeight="320px"};n.prototype.render=function(n){this.initializeDocumentEditor(n);this.setserverActionSettings();this.customizeDocumentEditorSettings()};n.prototype.setFormat=function(){};n.prototype.setserverActionSettings=function(){};n.prototype.customizeDocumentEditorSettings=function(){};n.prototype.getPersistData=function(){return"documenteditor-container"};n.prototype.requiredModules=function(){var n=[];return this.enableToolbar&&n.push({member:"toolbar",args:[this]}),n};n.prototype.initializeDocumentEditor=function(n){var t=n;this.documentEditorInternal=n.blazor__instance;sf.base.EventHandler.add(t,"selectionChange",this.onSelectionChange,this);this.documentEditor.enableAllModules();this.documentEditor.enableComment=this.enableComment;this.setFormat();this.documentEditor.resize()};n.prototype.showHidePropertiesPane=function(){this.showPropertiesPane&&this.showPropertiesPaneOnSelection();this.documentEditor.resize()};n.prototype.resize=function(n,t){this.element&&(sf.base.isNullOrUndefined(t)&&this.element&&this.element.parentElement.parentElement&&(t=this.element.parentElement.parentElement.clientHeight),sf.base.isNullOrUndefined(n)&&this.element&&this.element.parentElement.parentElement&&(n=this.element.parentElement.parentElement.clientWidth),!sf.base.isNullOrUndefined(n)&&n>200&&(this.width=n.toString(),this.element.style.width=n+"px"),!sf.base.isNullOrUndefined(t)&&t>200&&(this.height=t.toString(),this.element.style.height=t+"px"),this.documentEditor&&this.documentEditor.resize())};n.prototype.onContentChange=function(){};n.prototype.onDocumentChange=function(){this.enableTrackChanges=this.documentEditor.enableTrackChanges};n.prototype.onSelectionChange=function(){this.showPropertiesPaneOnSelection()};n.prototype.showPropertiesPaneOnSelection=function(){var n=this.documentEditor.selection.contextType,t=n.indexOf("Header")>=0||n.indexOf("Footer")>=0;t||(this.showHeaderProperties=!0);this.showPropertiesPane?t&&this.showHeaderProperties?this.showProperties("headerfooter"):n.indexOf("List")>=0||n.indexOf("Text")>=0&&n.indexOf("Table")<0?this.showProperties("text"):n.indexOf("Image")>=0?this.showProperties("image"):n.indexOf("TableOfContents")>=0?this.showProperties("toc"):n.indexOf("Table")>=0&&this.showProperties("table"):this.showHidePropertiesPane(!1);this.previousContext=this.documentEditor.selection.contextType};n.prototype.showProperties=function(n){this.textProperties.showTextProperties("text"===n);this.tableProperties.showTableProperties("table"===n);this.imageProperties.showImageProperties("image"===n);this.headerFooterProperties.showHeaderFooterPane("headerfooter"===n);this.tocProperties.showTocPane("toc"===n)};n.prototype.destroy=function(){this.propertiesPaneContainer&&this.editorContainer.parentElement&&(this.propertiesPaneContainer.innerHTML="",this.propertiesPaneContainer.parentElement.removeChild(this.propertiesPaneContainer));this.propertiesPaneContainer=void 0;this.editorContainer&&this.editorContainer.parentElement&&(this.editorContainer.innerHTML="",this.editorContainer.parentElement.removeChild(this.editorContainer));this.statusBarElement&&this.statusBarElement.parentElement&&(this.statusBarElement.innerHTML="",this.statusBarElement.parentElement.removeChild(this.statusBarElement));this.containerTarget&&this.containerTarget.parentElement&&(this.containerTarget.innerHTML="",this.containerTarget.parentElement.removeChild(this.containerTarget));this.containerTarget=void 0;this.statusBarElement=void 0;this.editorContainer=void 0}}();var er,or,sr,hr,du=function(){function n(){}return n.prototype.getModuleName=function(){return"Print"},n.prototype.print=function(n,t){this.printWindow(n,navigator.userAgent,t)},n.prototype.printWindow=function(n,t,i){var u=this.getPageHeight(n.pages),f=this.getPageWidth(n.pages),r=document.createElement("div"),e;r.style.width="100%";r.style.height="100%";r.style.overflow="scroll";this.generatePrintContent(n,r);sf.base.isNullOrUndefined(i)&&(i=window.open("","print","height=452,width=1024,tabbar=no"));-1!==t.indexOf("Chrome")||-1!==t.indexOf("Firefox")?(i.document.write("<!DOCTYPE html>"),i.document.write("<html moznomarginboxes mozdisallowselectionprint><head><style>html, body { height: 100 %; } img { height: 100 %; width: 100 %; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:"+f.toString()+"px "+u.toString()+"px; }@media print{ body { margin: 0cm; }<\/style><\/head> <body><center>")):i.document.write("<html><head><style>@page{margin:0;size:"+f.toString()+"px "+u.toString()+"px;}<\/style><\/head><body><center>");i.document.write(r.innerHTML+"<\/center><script> (function() { window.ready = true; })(); <\/script><\/body><\/html>");r=void 0;i.document.close();i.focus();e=setInterval(function(){i.ready&&(i.print(),i.close(),clearInterval(e))},500)},n.prototype.generateDoumentImages=function(n,t){var i,u;if(!sf.base.isNullOrUndefined(t)&&t<=n.pages.length&&t>=1){var r=n.pages[t-1],f=r.boundingRectangle.height,e=r.boundingRectangle.width;n.render.isPrinting=!0;n.render.renderWidgets(r,0,0,0,0);u=n.render.pageCanvas.toDataURL();n.render.isPrinting=!1;(i=new Image).src=u;i.setAttribute("style","margin:0px;display:block;width:"+e.toString()+"px;height:"+f.toString()+"px;")}return i},n.prototype.generatePrintContent=function(n,t){for(var f,r="",i=0;i<n.pages.length;i++){var u=n.pages[i],e=u.boundingRectangle.height,o=u.boundingRectangle.width;n.render.isPrinting=!0;n.render.renderWidgets(u,0,0,0,0);f=n.render.pageCanvas.toDataURL();n.render.isPrinting=!1;r+="<div><img src="+f+' style="margin:0px;display:block;width: '+o.toString()+"px; height:"+e.toString()+'px; "/><\/div><br/>'}t.innerHTML=r},n.prototype.getPageWidth=function(n){for(var i=0,t=0;t<n.length;t++)i<n[t].boundingRectangle.width&&(i=n[t].boundingRectangle.width);return i},n.prototype.getPageHeight=function(n){for(var i=0,t=0;t<n.length;t++)i<n[t].boundingRectangle.height&&(i=n[t].boundingRectangle.height);return i},n.prototype.destroy=function(){},n}(),h=function(){function n(){this.keysInternal=[];this.valuesInternal=[]}return Object.defineProperty(n.prototype,"length",{get:function(){return this.keysInternal.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"keys",{get:function(){return this.keysInternal},enumerable:!0,configurable:!0}),n.prototype.add=function(n,t){if(sf.base.isNullOrUndefined(n))throw new ReferenceError("Provided key or value is not valid.");return this.keysInternal.indexOf(n)<0&&(this.keysInternal.push(n),this.valuesInternal.push(t)),1},n.prototype.get=function(n){if(sf.base.isNullOrUndefined(n))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(n);if(!(t<0)&&!(t>this.keysInternal.length-1))return this.valuesInternal[t]},n.prototype.set=function(n,t){if(sf.base.isNullOrUndefined(n))throw new ReferenceError("Provided key is not valid.");var i=this.keysInternal.indexOf(n);if(i<0||i>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");this.valuesInternal[i]=t},n.prototype.remove=function(n){if(sf.base.isNullOrUndefined(n))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(n);if(t<0||t>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");return this.keysInternal.splice(t,1),this.valuesInternal.splice(t,1),!0},n.prototype.containsKey=function(n){if(sf.base.isNullOrUndefined(n))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(n);return!(t<0||t>this.keysInternal.length-1)},n.prototype.clear=function(){this.keysInternal=[];this.valuesInternal=[]},n.prototype.destroy=function(){this.clear();this.keysInternal=void 0;this.valuesInternal=void 0},n}(),y=function(){function n(n){this.referenceCount=0;this.uniqueFormatType=n;this.propertiesHash=new h}return n.prototype.isEqual=function(n,t,i){var r=!1;switch(this.uniqueFormatType){case 1:r=this.isBorderEqual(n,t,i);break;case 2:r=this.isCharacterFormatEqual(n,t,i);break;case 3:r=this.isParagraphFormatEqual(n,t,i);break;case 4:r=this.isCellFormatEqual(n,t,i);break;case 5:r=this.isShadingEqual(n,t,i);break;case 6:r=this.isRowFormatEqual(n,t,i);break;case 7:r=this.isListFormatEqual(n,t,i);break;case 8:r=this.isTableFormatEqual(n,t,i);break;case 9:r=this.isListLevelEqual(n,t,i);break;case 10:r=this.isSectionFormatEqual(n,t,i)}return r},n.prototype.isNotEqual=function(t,i,r,u,f){var o=void 0,s=n.getPropertyType(f,t),e;return this.propertiesHash.containsKey(s)&&(o=this.propertiesHash.get(s)),e=void 0,t===r?e=u:i.containsKey(s)&&(e=i.get(s)),!(o===e||!sf.base.isNullOrUndefined(o)&&!sf.base.isNullOrUndefined(e)&&o===e)},n.getPropertyType=function(n,t){var i=0;switch(n){case 1:i=this.getBorderPropertyType(t);break;case 2:i=this.getCharacterFormatPropertyType(t);break;case 3:i=this.getParaFormatPropertyType(t);break;case 4:i=this.getCellFormatPropertyType(t);break;case 5:i=this.getShadingPropertyType(t);break;case 6:i=this.getRowFormatType(t);break;case 7:i=this.getListFormatType(t);break;case 8:i=this.getTableFormatType(t);break;case 9:i=this.getListLevelType(t);break;case 10:i=this.getSectionFormatType(t)}return i},n.getRowFormatType=function(n){return"allowBreakAcrossPages"===n?1:"isHeader"===n?2:"height"===n?3:"heightType"===n?4:"gridBefore"===n?5:"gridBeforeWidth"===n?6:"gridBeforeWidthType"===n?7:"gridAfter"===n?8:"gridAfterWidth"===n?9:"gridAfterWidthType"===n?10:"leftMargin"===n?11:"topMargin"===n?12:"bottomMargin"===n?13:"rightMargin"===n?14:"leftIndent"===n?15:0},n.getListFormatType=function(n){return"listId"===n?1:"listLevelNumber"===n?2:0},n.getTableFormatType=function(n){return"leftMargin"===n?1:"rightMargin"===n?2:"topMargin"===n?3:"bottomMargin"===n?4:"cellSpacing"===n?5:"leftIndent"===n?6:"tableAlignment"===n?7:"preferredWidth"===n?8:"preferredWidthType"===n?9:"bidi"===n?10:"allowAutoFit"===n?11:"horizontalPositionAbs"===n?12:"horizontalPosition"===n?13:0},n.getListLevelType=function(n){return"listLevelPattern"===n?1:"startAt"===n?2:"followCharacter"===n?3:"numberFormat"===n?4:"restartLevel"===n?5:0},n.getShadingPropertyType=function(n){return"backgroundColor"===n?1:"foregroundColor"===n?2:"textureStyle"===n?3:0},n.getCellFormatPropertyType=function(n){return"leftMargin"===n?1:"rightMargin"===n?2:"topMargin"===n?3:"bottomMargin"===n?4:"columnSpan"===n?5:"rowSpan"===n?6:"verticalAlignment"===n?7:"preferredWidthType"===n?8:"preferredWidth"===n?9:"cellWidth"===n?10:0},n.getBorderPropertyType=function(n){return"color"===n?1:"lineStyle"===n?2:"lineWidth"===n?3:"shadow"===n?4:"space"===n?5:"hasNoneStyle"===n?6:0},n.getCharacterFormatPropertyType=function(n){return"fontColor"===n?1:"fontFamily"===n?2:"fontSize"===n?3:"bold"===n?4:"italic"===n?5:"underline"===n?6:"strikethrough"===n?7:"baselineAlignment"===n?8:"highlightColor"===n?9:"bidi"===n?10:"bdo"===n?11:"boldBidi"===n?12:"italicBidi"===n?13:"fontFamilyBidi"===n?14:"fontSizeBidi"===n?15:"allCaps"===n?16:0},n.getParaFormatPropertyType=function(n){return"leftIndent"===n?1:"rightIndent"===n?2:"firstLineIndent"===n?3:"textAlignment"===n?4:"beforeSpacing"===n?5:"afterSpacing"===n?6:"lineSpacing"===n?7:"lineSpacingType"===n?8:"outlineLevel"===n?9:"bidi"===n?10:"contextualSpacing"===n?11:"keepWithNext"===n?12:"keepLinesTogether"===n?13:"widowControl"===n?14:0},n.getSectionFormatType=function(n){return"headerDistance"===n?1:"footerDistance"===n?2:"differentFirstPage"===n?3:"differentOddAndEvenPages"===n?4:"pageWidth"===n?5:"pageHeight"===n?6:"leftMargin"===n?7:"topMargin"===n?8:"rightMargin"===n?9:"bottomMargin"===n?10:"bidi"===n?11:"restartPageNumbering"===n?12:"pageStartingNumber"===n?13:"endnoteNumberFormat"===n?14:"endnotePosition"===n?15:"footNoteNumberFormat"===n?16:"footnotePosition"===n?17:"restartIndexForEndnotes"===n?18:"restartIndexForFootnotes"===n?19:"initialFootNoteNumber"===n?20:"initialEndNoteNumber"===n?21:0},n.prototype.isBorderEqual=function(n,t,i){return!this.isNotEqual("color",n,t,i,1)&&!this.isNotEqual("lineStyle",n,t,i,1)&&!this.isNotEqual("lineWidth",n,t,i,1)&&!this.isNotEqual("shadow",n,t,i,1)&&!this.isNotEqual("space",n,t,i,1)&&!this.isNotEqual("hasNoneStyle",n,t,i,1)},n.prototype.isCharacterFormatEqual=function(n,t,i){return!this.isNotEqual("fontColor",n,t,i,2)&&!this.isNotEqual("fontFamily",n,t,i,2)&&!this.isNotEqual("fontSize",n,t,i,2)&&!this.isNotEqual("bold",n,t,i,2)&&!this.isNotEqual("italic",n,t,i,2)&&!this.isNotEqual("underline",n,t,i,2)&&!this.isNotEqual("strikethrough",n,t,i,2)&&!this.isNotEqual("baselineAlignment",n,t,i,2)&&!this.isNotEqual("highlightColor",n,t,i,2)&&!this.isNotEqual("bidi",n,t,i,2)&&!this.isNotEqual("bdo",n,t,i,2)&&!this.isNotEqual("fontColor",n,t,i,2)&&!this.isNotEqual("fontFamilyBidi",n,t,i,2)&&!this.isNotEqual("fontSizeBidi",n,t,i,2)&&!this.isNotEqual("boldBidi",n,t,i,2)&&!this.isNotEqual("italicBidi",n,t,i,2)&&!this.isNotEqual("allCaps",n,t,i,2)},n.prototype.isParagraphFormatEqual=function(n,t,i){return!this.isNotEqual("leftIndent",n,t,i,3)&&!this.isNotEqual("rightIndent",n,t,i,3)&&!this.isNotEqual("firstLineIndent",n,t,i,3)&&!this.isNotEqual("textAlignment",n,t,i,3)&&!this.isNotEqual("beforeSpacing",n,t,i,3)&&!this.isNotEqual("afterSpacing",n,t,i,3)&&!this.isNotEqual("lineSpacing",n,t,i,3)&&!this.isNotEqual("lineSpacingType",n,t,i,3)&&!this.isNotEqual("outlineLevel",n,t,i,3)&&!this.isNotEqual("bidi",n,t,i,3)&&!this.isNotEqual("contextualSpacing",n,t,i,3)&&!this.isNotEqual("keepWithNext",n,t,i,3)&&!this.isNotEqual("keepLinesTogether",n,t,i,3)&&!this.isNotEqual("widowControl",n,t,i,3)},n.prototype.isCellFormatEqual=function(n,t,i){return!this.isNotEqual("leftMargin",n,t,i,4)&&!this.isNotEqual("rightMargin",n,t,i,4)&&!this.isNotEqual("topMargin",n,t,i,4)&&!this.isNotEqual("bottomMargin",n,t,i,4)&&!this.isNotEqual("columnSpan",n,t,i,4)&&!this.isNotEqual("rowSpan",n,t,i,4)&&!this.isNotEqual("verticalAlignment",n,t,i,4)&&!this.isNotEqual("preferredWidthType",n,t,i,4)&&!this.isNotEqual("preferredWidth",n,t,i,4)&&!this.isNotEqual("cellWidth",n,t,i,4)},n.prototype.isShadingEqual=function(n,t,i){return!this.isNotEqual("backgroundColor",n,t,i,5)&&!this.isNotEqual("foregroundColor",n,t,i,5)&&!this.isNotEqual("textureStyle",n,t,i,5)},n.prototype.isRowFormatEqual=function(n,t,i){return!this.isNotEqual("allowBreakAcrossPages",n,t,i,6)&&!this.isNotEqual("isHeader",n,t,i,6)&&!this.isNotEqual("height",n,t,i,6)&&!this.isNotEqual("heightType",n,t,i,6)&&!this.isNotEqual("gridBefore",n,t,i,6)&&!this.isNotEqual("gridBeforeWidth",n,t,i,6)&&!this.isNotEqual("gridBeforeWidthType",n,t,i,6)&&!this.isNotEqual("gridAfter",n,t,i,6)&&!this.isNotEqual("gridAfterWidth",n,t,i,6)&&!this.isNotEqual("gridAfterWidthType",n,t,i,6)&&!this.isNotEqual("leftMargin",n,t,i,6)&&!this.isNotEqual("topMargin",n,t,i,6)&&!this.isNotEqual("bottomMargin",n,t,i,6)&&!this.isNotEqual("rightMargin",n,t,i,6)&&!this.isNotEqual("leftIndent",n,t,i,6)},n.prototype.isListFormatEqual=function(n,t,i){return!this.isNotEqual("listId",n,t,i,7)&&!this.isNotEqual("listLevelNumber",n,t,i,7)},n.prototype.isTableFormatEqual=function(n,t,i){return!this.isNotEqual("leftMargin",n,t,i,8)&&!this.isNotEqual("rightMargin",n,t,i,8)&&!this.isNotEqual("topMargin",n,t,i,8)&&!this.isNotEqual("bottomMargin",n,t,i,8)&&!this.isNotEqual("cellSpacing",n,t,i,8)&&!this.isNotEqual("leftIndent",n,t,i,8)&&!this.isNotEqual("tableAlignment",n,t,i,8)&&!this.isNotEqual("preferredWidth",n,t,i,8)&&!this.isNotEqual("preferredWidthType",n,t,i,8)&&!this.isNotEqual("bidi",n,t,i,8)&&!this.isNotEqual("allowAutoFit",n,t,i,8)&&!this.isNotEqual("horizontalPositionAbs",n,t,i,8)&&!this.isNotEqual("horizontalPosition",n,t,i,8)},n.prototype.isListLevelEqual=function(n,t,i){return!this.isNotEqual("listLevelPattern",n,t,i,9)&&!this.isNotEqual("startAt",n,t,i,9)&&!this.isNotEqual("followCharacter",n,t,i,9)&&!this.isNotEqual("numberFormat",n,t,i,9)&&!this.isNotEqual("restartLevel",n,t,i,9)},n.prototype.isSectionFormatEqual=function(n,t,i){return!this.isNotEqual("headerDistance",n,t,i,10)&&!this.isNotEqual("footerDistance",n,t,i,10)&&!this.isNotEqual("differentFirstPage",n,t,i,10)&&!this.isNotEqual("differentOddAndEvenPages",n,t,i,10)&&!this.isNotEqual("pageWidth",n,t,i,10)&&!this.isNotEqual("pageHeight",n,t,i,10)&&!this.isNotEqual("leftMargin",n,t,i,10)&&!this.isNotEqual("topMargin",n,t,i,10)&&!this.isNotEqual("rightMargin",n,t,i,10)&&!this.isNotEqual("bottomMargin",n,t,i,10)&&!this.isNotEqual("bidi",n,t,i,10)&&!this.isNotEqual("restartPageNumbering",n,t,i,10)&&!this.isNotEqual("pageStartingNumber",n,t,i,10)&&!this.isNotEqual("endnoteNumberFormat",n,t,i,10)&&!this.isNotEqual("endnotePosition",n,t,i,10)&&!this.isNotEqual("footNoteNumberFormat",n,t,i,10)&&!this.isNotEqual("footnotePosition",n,t,i,10)&&!this.isNotEqual("restartIndexForEndnotes",n,t,i,10)&&!this.isNotEqual("restartIndexForFootnotes",n,t,i,10)&&!this.isNotEqual("initialFootNoteNumber",n,t,i,10)&&!this.isNotEqual("initialEndNoteNumber",n,t,i,10)},n.prototype.cloneItems=function(t,i,r,u){for(var e=n.getPropertyType(u,i),o=t.propertiesHash.keys,f=0;f<o.length;f++)o[f]===e?this.propertiesHash.add(e,r):this.propertiesHash.add(o[f],t.propertiesHash.get(o[f]));t.propertiesHash.containsKey(e)||this.propertiesHash.add(e,r)},n.prototype.mergeProperties=function(n){for(var r=n.cloneProperties(),i=this.propertiesHash.keys,t=0;t<i.length;t++)r.containsKey(i[t])||r.add(i[t],this.propertiesHash.get(i[t]));return r},n.prototype.cloneProperties=function(){for(var i=new h,t=this.propertiesHash.keys,n=0;n<t.length;n++)i.add(t[n],this.propertiesHash.get(t[n]));return i},n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.propertiesHash)||this.propertiesHash.destroy();this.propertiesHash=void 0;this.referenceCount=void 0;this.uniqueFormatType=void 0},n}(),ei=function(){function n(){this.items=[]}return n.prototype.addUniqueFormat=function(n,t){for(var i=void 0,r=0;r<this.items.length;r++)if(this.items[r].isEqual(n,void 0,void 0)){i=this.items[r];break}return sf.base.isNullOrUndefined(i)?((i=new y(t)).propertiesHash=n,i.referenceCount=1,this.items.push(i)):i.referenceCount++,i},n.prototype.updateUniqueFormat=function(n,t,i){for(var r=void 0,u=0;u<this.items.length;u++)if(this.items[u].isEqual(n.propertiesHash,t,i)){r=this.items[u];break}return sf.base.isNullOrUndefined(r)?((r=new y(n.uniqueFormatType)).cloneItems(n,t,i,n.uniqueFormatType),r.referenceCount=1,this.items.push(r)):r.referenceCount++,this.remove(n),n=void 0,r},n.prototype.remove=function(n){n.referenceCount--;n.referenceCount<=0&&(this.items.splice(this.items.indexOf(n),1),n.destroy(),n=void 0)},n.prototype.clear=function(){if(sf.base.isNullOrUndefined(this.items))for(var n=0;n<this.items.length;n++)this.items[n].destroy();this.items=[]},n.prototype.destroy=function(){this.clear();this.items=void 0},n}(),dt=function(){function n(n){this.uniqueSectionFormat=void 0;this.ownerBase=n}return Object.defineProperty(n.prototype,"headerDistance",{get:function(){return this.getPropertyValue("headerDistance")},set:function(n){this.setPropertyValue("headerDistance",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"footerDistance",{get:function(){return this.getPropertyValue("footerDistance")},set:function(n){this.setPropertyValue("footerDistance",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"differentFirstPage",{get:function(){return this.getPropertyValue("differentFirstPage")},set:function(n){this.setPropertyValue("differentFirstPage",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"differentOddAndEvenPages",{get:function(){return this.getPropertyValue("differentOddAndEvenPages")},set:function(n){this.setPropertyValue("differentOddAndEvenPages",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageHeight",{get:function(){return this.getPropertyValue("pageHeight")},set:function(n){this.setPropertyValue("pageHeight",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(n){this.setPropertyValue("rightMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageWidth",{get:function(){return this.getPropertyValue("pageWidth")},set:function(n){this.setPropertyValue("pageWidth",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(n){this.setPropertyValue("leftMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(n){this.setPropertyValue("bottomMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(n){this.setPropertyValue("topMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(n){this.setPropertyValue("bidi",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"restartPageNumbering",{get:function(){return this.getPropertyValue("restartPageNumbering")},set:function(n){this.setPropertyValue("restartPageNumbering",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageStartingNumber",{get:function(){return this.getPropertyValue("pageStartingNumber")},set:function(n){this.setPropertyValue("pageStartingNumber",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"endnoteNumberFormat",{get:function(){return this.getPropertyValue("endnoteNumberFormat")},set:function(n){this.setPropertyValue("endnoteNumberFormat",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"restartIndexForEndnotes",{get:function(){return this.getPropertyValue("restartIndexForEndnotes")},set:function(n){this.setPropertyValue("restartIndexForEndnotes",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"restartIndexForFootnotes",{get:function(){return this.getPropertyValue("restartIndexForFootnotes")},set:function(n){this.setPropertyValue("restartIndexForFootnotes",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"footNoteNumberFormat",{get:function(){return this.getPropertyValue("footNoteNumberFormat")},set:function(n){this.setPropertyValue("footNoteNumberFormat",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"initialFootNoteNumber",{get:function(){return this.getPropertyValue("initialFootNoteNumber")},set:function(n){this.setPropertyValue("initialFootNoteNumber",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"initialEndNoteNumber",{get:function(){return this.getPropertyValue("initialEndNoteNumber")},set:function(n){this.setPropertyValue("initialEndNoteNumber",n)},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.uniqueSectionFormat)||n.uniqueSectionFormats.remove(this.uniqueSectionFormat);this.uniqueSectionFormat=void 0},n.prototype.hasValue=function(n){if(!sf.base.isNullOrUndefined(this.uniqueSectionFormat)){var t=y.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,n);return this.uniqueSectionFormat.propertiesHash.containsKey(t)}return!1},n.getPropertyDefaultValue=function(n){var t=void 0;switch(n){case"headerDistance":case"footerDistance":t=36;break;case"differentFirstPage":case"differentOddAndEvenPages":t=!1;break;case"pageWidth":t=612;break;case"pageHeight":t=792;break;case"leftMargin":case"topMargin":case"rightMargin":case"bottomMargin":t=72;break;case"bidi":case"restartPageNumbering":t=!1;break;case"pageStartingNumber":t=1;break;case"footnotePosition":t="PrintAtBottomOfPage";break;case"endnoteNumberFormat":t="LowerCaseRoman";break;case"endnotePosition":t="DisplayEndOfDocument";break;case"restartIndexForEndnotes":case"restartIndexForFootnotes":t="DoNotRestart";break;case"footNoteNumberFormat":t="Arabic";break;case"initialFootNoteNumber":case"initialEndNoteNumber":t=1}return t},n.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=y.getPropertyType(n.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueSectionFormat)&&this.uniqueSectionFormat.propertiesHash.containsKey(i))return this.uniqueSectionFormat.propertiesHash.get(i)}return n.getPropertyDefaultValue(t)},n.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=n.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueSectionFormat))this.initializeUniqueSectionFormat(t,i);else{var r=y.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,t);if(this.uniqueSectionFormat.propertiesHash.containsKey(r)&&this.uniqueSectionFormat.propertiesHash.get(r)===i)return;this.uniqueSectionFormat=n.uniqueSectionFormats.updateUniqueFormat(this.uniqueSectionFormat,t,i)}},n.prototype.initializeUniqueSectionFormat=function(t,i){var r=new h;this.addUniqueSectionFormat("headerDistance",t,i,r);this.addUniqueSectionFormat("footerDistance",t,i,r);this.addUniqueSectionFormat("differentFirstPage",t,i,r);this.addUniqueSectionFormat("differentOddAndEvenPages",t,i,r);this.addUniqueSectionFormat("pageWidth",t,i,r);this.addUniqueSectionFormat("pageHeight",t,i,r);this.addUniqueSectionFormat("leftMargin",t,i,r);this.addUniqueSectionFormat("topMargin",t,i,r);this.addUniqueSectionFormat("rightMargin",t,i,r);this.addUniqueSectionFormat("bottomMargin",t,i,r);this.addUniqueSectionFormat("bidi",t,i,r);this.addUniqueSectionFormat("restartPageNumbering",t,i,r);this.addUniqueSectionFormat("pageStartingNumber",t,i,r);this.addUniqueSectionFormat("endnoteNumberFormat",t,i,r);this.addUniqueSectionFormat("endnotePosition",t,i,r);this.addUniqueSectionFormat("footNoteNumberFormat",t,i,r);this.addUniqueSectionFormat("footnotePosition",t,i,r);this.addUniqueSectionFormat("restartIndexForEndnotes",t,i,r);this.addUniqueSectionFormat("restartIndexForFootnotes",t,i,r);this.addUniqueSectionFormat("initialFootNoteNumber",t,i,r);this.addUniqueSectionFormat("initialEndNoteNumber",t,i,r);this.uniqueSectionFormat=n.uniqueSectionFormats.addUniqueFormat(r,n.uniqueFormatType)},n.prototype.addUniqueSectionFormat=function(t,i,r,u){var f=y.getPropertyType(n.uniqueFormatType,t);t===i?u.add(f,r):u.add(f,n.getPropertyDefaultValue(t))},n.prototype.copyFormat=function(n,t){t&&(t.isUndoing||t.isRedoing)?this.uniqueSectionFormat=n.uniqueSectionFormat:sf.base.isNullOrUndefined(n)||!sf.base.isNullOrUndefined(n.uniqueSectionFormat)&&n.uniqueSectionFormat.propertiesHash&&this.updateUniqueSectionFormat(n)},n.prototype.updateUniqueSectionFormat=function(t){var i=void 0;this.uniqueSectionFormat&&(i=this.uniqueSectionFormat.mergeProperties(t.uniqueSectionFormat),0===this.uniqueSectionFormat.referenceCount&&(n.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0));this.uniqueSectionFormat=new y(n.uniqueFormatType);sf.base.isNullOrUndefined(i)&&(i=this.uniqueSectionFormat.mergeProperties(t.uniqueSectionFormat));this.uniqueSectionFormat=n.uniqueSectionFormats.addUniqueFormat(i,n.uniqueFormatType)},n.prototype.cloneFormat=function(){var t=new n;return t.uniqueSectionFormat=this.uniqueSectionFormat,t},n.clear=function(){this.uniqueSectionFormats.clear()},n.uniqueSectionFormats=new ei,n.uniqueFormatType=10,n}(),nr=function(){function n(){}return n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.overrideListLevel)||this.overrideListLevel.destroy();this.levelNumber=void 0;this.startAt=void 0;this.overrideListLevel=void 0},n.prototype.clone=function(){var t=new n;return t.startAt=this.startAt,t.levelNumber=this.levelNumber,sf.base.isNullOrUndefined(this.overrideListLevel)||(t.overrideListLevel=this.overrideListLevel.clone(t)),t},n}(),pi=function(){function n(){this.listId=-1;this.sourceListId=-1;this.abstractListId=-1;this.abstractList=void 0;this.levelOverrides=[]}return n.prototype.getListLevel=function(n){var t=this.getLevelOverride(n);return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.overrideListLevel)?this.abstractList.levels[n]:t.overrideListLevel},n.prototype.getLevelOverride=function(n){for(var i,t=0;t<this.levelOverrides.length;t++)if(_instanceof(this.levelOverrides[t],nr)&&(i=this.levelOverrides[t],i.levelNumber===n))return i},n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.levelOverrides)||(this.levelOverrides=[]);this.abstractListId=void 0;this.listId=void 0;this.sourceListId=void 0;this.levelOverrides=void 0},n.prototype.mergeList=function(n){sf.base.isNullOrUndefined(this.abstractListId)||-1===this.abstractListId||(this.abstractListId=n.abstractListId);sf.base.isNullOrUndefined(this.listId)||-1===this.listId||(this.listId=n.listId);sf.base.isNullOrUndefined(this.sourceListId)||-1===this.sourceListId||(this.sourceListId=n.sourceListId);sf.base.isNullOrUndefined(this.levelOverrides)||0===this.levelOverrides.length||(this.levelOverrides=n.levelOverrides)},n.prototype.clone=function(){for(var i=new n,t=0;t<this.levelOverrides.length;t++)i.levelOverrides.push(this.levelOverrides[t].clone());return i},n}(),ai=function(){function n(n){this.uniqueListFormat=void 0;this.ownerBase=void 0;this.baseStyle=void 0;this.list=void 0;this.ownerBase=n}return Object.defineProperty(n.prototype,"listId",{get:function(){return this.getPropertyValue("listId")},set:function(n){this.setPropertyValue("listId",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"listLevelNumber",{get:function(){return this.getPropertyValue("listLevelNumber")},set:function(n){this.setPropertyValue("listLevelNumber",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"listLevel",{get:function(){var t=void 0,n;if(sf.base.isNullOrUndefined(this.list))for(n=this.baseStyle;!sf.base.isNullOrUndefined(n);){if(n.paragraphFormat.listFormat.list){t=n.paragraphFormat.listFormat.list;break}n=n.basedOn}else t=this.list;if(!sf.base.isNullOrUndefined(t))return t.getListLevel(this.listLevelNumber)},enumerable:!0,configurable:!0}),n.prototype.getPropertyValue=function(t){var i,r;if(this.hasValue(t)){if(r=y.getPropertyType(n.uniqueFormatType,t),!sf.base.isNullOrUndefined(this.uniqueListFormat)&&this.uniqueListFormat.propertiesHash.containsKey(r))return this.uniqueListFormat.propertiesHash.get(r)}else if(_instanceof(this.baseStyle,fi)){for(i=this.baseStyle;!sf.base.isNullOrUndefined(i)&&!i.paragraphFormat.listFormat.hasValue(t);)i=i.basedOn;if(!sf.base.isNullOrUndefined(i))return r=y.getPropertyType(n.uniqueFormatType,t),i.paragraphFormat.listFormat.uniqueListFormat.propertiesHash.get(r)}return n.getPropertyDefaultValue(t)},n.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=n.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueListFormat))this.initializeUniqueListFormat(t,i);else{var r=y.getPropertyType(this.uniqueListFormat.uniqueFormatType,t);if(this.uniqueListFormat.propertiesHash.containsKey(r)&&this.uniqueListFormat.propertiesHash.get(r)===i)return;this.uniqueListFormat=n.uniqueListFormats.updateUniqueFormat(this.uniqueListFormat,t,i)}},n.prototype.initializeUniqueListFormat=function(t,i){var r=new h;this.addUniqueListFormat("listId",t,i,r);this.addUniqueListFormat("listLevelNumber",t,i,r);this.uniqueListFormat=n.uniqueListFormats.addUniqueFormat(r,n.uniqueFormatType)},n.prototype.addUniqueListFormat=function(t,i,r,u){var f=y.getPropertyType(n.uniqueFormatType,t);t===i&&u.add(f,r)},n.getPropertyDefaultValue=function(n){var t=void 0;switch(n){case"listId":t=-1;break;case"listLevelNumber":t=0}return t},n.prototype.copyFormat=function(n){sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(n.uniqueListFormat)||(this.listId=n.listId,this.listLevelNumber=n.listLevelNumber),sf.base.isNullOrUndefined(n.baseStyle)||(this.baseStyle=n.baseStyle),sf.base.isNullOrUndefined(n.list)||(this.list=n.list))},n.prototype.hasValue=function(n){if(!sf.base.isNullOrUndefined(this.uniqueListFormat)){var t=y.getPropertyType(this.uniqueListFormat.uniqueFormatType,n);return this.uniqueListFormat.propertiesHash.containsKey(t)}return!1},n.prototype.clearFormat=function(){sf.base.isNullOrUndefined(this.uniqueListFormat)||0!==this.uniqueListFormat.referenceCount||n.uniqueListFormats.remove(this.uniqueListFormat);this.uniqueListFormat=void 0;this.list=void 0},n.prototype.destroy=function(){this.clearFormat()},n.clear=function(){this.uniqueListFormats.clear()},n.prototype.applyStyle=function(n){this.baseStyle=n},n.prototype.getValue=function(n){if(this.hasValue(n))return this.getPropertyValue(n)},n.prototype.mergeFormat=function(n){sf.base.isNullOrUndefined(this.getValue("listId"))&&(this.listId=n.getValue("listId"));sf.base.isNullOrUndefined(this.getValue("listLevelNumber"))&&(this.listLevelNumber=n.getValue("listLevelNumber"));sf.base.isNullOrUndefined(n.list)||(sf.base.isNullOrUndefined(this.list)&&(this.list=new pi),this.list.mergeList(n.list))},n.prototype.cloneListFormat=function(){var t=new n(void 0);return t.list=this.list,t.listId=this.listId,t.baseStyle=this.baseStyle,t.listLevelNumber=this.listLevelNumber,t.uniqueListFormat=this.uniqueListFormat,t},n.uniqueListFormats=new ei,n.uniqueFormatType=7,n}(),t=function(){function n(){}return n.insert=function(n,t,i){return t>=0?[n.slice(0,t)+i+n.slice(t)].join(""):i+this},n.remove=function(n,t){return 0===t?n.substring(t+1,n.length):n.substring(0,t)+n.substring(t+1,n.length)},n.indexOfAny=function(n,t){for(var r,i=void 0,u=0;u<t.length;u++)r=n.indexOf(t[u]),(-1!==r&&sf.base.isNullOrUndefined(i)||-1!==r&&r<i)&&(i=r);return sf.base.isNullOrUndefined(i)?-1:i},n.lastIndexOfAny=function(n,t){for(var r,i=n.length-1;i>=0;i--)for(r=0;r<=t.length-1;r++)if(n[i]===t[r])return i;return-1},n.addCssStyle=function(n){var t=document.createElement("style");t.style.cssText?t.style.cssText=n:t.appendChild(document.createTextNode(n));document.getElementsByTagName("head")[0].appendChild(t)},n.getHighlightColorCode=function(n){var t="#ffffff";switch(n){case"Yellow":t="#ffff00";break;case"BrightGreen":t="#00ff00";break;case"Turquoise":t="#00ffff";break;case"Pink":t="#ff00ff";break;case"Blue":t="#0000ff";break;case"Red":t="#ff0000";break;case"DarkBlue":t="#000080";break;case"Teal":t="#008080";break;case"Green":t="#008000";break;case"Violet":t="#800080";break;case"DarkRed":t="#800000";break;case"DarkYellow":t="#808000";break;case"Gray50":t="#808080";break;case"Gray25":t="#c0c0c0";break;case"Black":t="#000000"}return t},n.isVeryDark=function(n){var t=n.substring(1);return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3<=60},n.getColor=function(n){return n.length>0&&"#"===n[0]&&n.length>7?n.substr(0,7):n},n.convertPointToPixel=function(t){return n.round(96*t/72,5)},n.convertPixelToPoint=function(t){return n.round(72*t/96,5)},n.isLinkedFieldCharacter=function(n){return _instanceof(n,r)&&0===n.fieldType?!sf.base.isNullOrUndefined(n.fieldEnd):_instanceof(n,r)&&2===n.fieldType?!sf.base.isNullOrUndefined(n.fieldBegin)&&!sf.base.isNullOrUndefined(n.fieldEnd):!sf.base.isNullOrUndefined(n.fieldBegin)},n.removeSpace=function(n){if(!sf.base.isNullOrUndefined(n)&&0!==n.length)for(var t=0;t<n.length;t++)" "===n.charAt(t)&&(n=n.replace(" ",""));return n},n.trimStart=function(n){for(var t=0;t<n.length&&" "===n[t];t++);return n.substring(t,n.length)},n.trimEnd=function(n){for(var t=n.length-1;t>=0&&" "===n[t];t--);return n.substring(0,t+1)},n.endsWith=function(n){return!sf.base.isNullOrUndefined(n)&&0!==n.length&&" "===n[n.length-1]},n.addSpace=function(n){var i="",t;if(n>0)for(t=0;t<n;t++)i+=" ";return i},n.writeCharacterFormat=function(n,t,i){n.bold=t?i.bold:i.getValue("bold");n.italic=t?i.italic:i.getValue("italic");n.fontSize=t?this.toWriteInline(i,"fontSize"):i.getValue("fontSize");n.fontFamily=t?this.toWriteInline(i,"fontFamily"):i.getValue("fontFamily");n.underline=t?i.underline:i.getValue("underline");n.strikethrough=t?i.strikethrough:i.getValue("strikethrough");n.baselineAlignment=t?i.baselineAlignment:i.getValue("baselineAlignment");n.highlightColor=t?i.highlightColor:i.getValue("highlightColor");n.fontColor=t?this.toWriteInline(i,"fontColor"):i.getValue("fontColor");n.styleName=sf.base.isNullOrUndefined(i.baseCharStyle)?void 0:i.baseCharStyle.name;n.bidi=t?i.bidi:i.getValue("bidi");n.bdo=t?i.bdo:i.getValue("bdo");n.boldBidi=t?i.boldBidi:i.getValue("boldBidi");n.italicBidi=t?i.italicBidi:i.getValue("italicBidi");n.fontSizeBidi=t?i.fontSizeBidi:i.getValue("fontSizeBidi");n.fontFamilyBidi=t?i.fontFamilyBidi:i.getValue("fontFamilyBidi");n.allCaps=t?i.allCaps:i.getValue("allCaps")},n.toWriteInline=function(n,t){return!sf.base.isNullOrUndefined(n.ownerBase)&&_instanceof(n.ownerBase,tt)?n.hasValue(t)?n[t]:n.getValue(t):n[t]},n.round=function(n,t){for(var i=n,r=0;r<t;r++)i*=10;for(i=Math.round(i),r=0;r<t;r++)i/=10;return i},n.reverseString=function(n){if(!sf.base.isNullOrUndefined(n)&&""!==n){var t=n.split("");n=t.reverse().join("")}return n},n.formatClippedString=function(n){var t="",i="";return this.startsWith(n,"data:image/bmp;base64,")?(t=".bmp",i=n.replace("data:image/bmp;base64,","")):this.startsWith(n,"data:image/x-emf;base64,")?(t=".emf",i=n.replace("data:image/x-emf;base64,","")):this.startsWith(n,"data:image/exif;base64,")?(t=".exif",i=n.replace("data:image/exif;base64,","")):this.startsWith(n,"data:image/gif;base64,")?(t=".gif",i=n.replace("data:image/gif;base64,","")):this.startsWith(n,"data:image/icon;base64,")?(t=".ico",i=n.replace("data:image/icon;base64,","")):this.startsWith(n,"data:image/jpeg;base64,")?(t=".jpeg",i=n.replace("data:image/jpeg;base64,","")):this.startsWith(n,"data:image/jpg;base64,")?(t=".jpg",i=n.replace("data:image/jpg;base64,","")):this.startsWith(n,"data:image/png;base64,")?(t=".png",i=n.replace("data:image/png;base64,","")):this.startsWith(n,"data:image/tiff;base64,")?(t=".tif",i=n.replace("data:image/tiff;base64,","")):this.startsWith(n,"data:image/x-wmf;base64,")?(t=".wmf",i=n.replace("data:image/x-wmf;base64,","")):t=".jpeg",{extension:t,formatClippedString:i}},n.startsWith=function(n,t){return t.length>0&&n.substring(0,t.length)===t},n.formatText=function(n,t){var i=t;switch(n.toLowerCase()){case"uppercase":i=t.toUpperCase();break;case"lowercase":i=t.toLowerCase();break;case"firstlower":i=this.lowerFirstChar(t);break;case"firstcapital":i=this.capitaliseFirst(t,"FirstCapital");break;case"titlecase":i=this.capitaliseFirst(t,"Titlecase")}return i},n.formatNumber=function(n,t){var i=new sf.base.Internationalization,f=t.split("."),r,u;return(t=f[0],r=i.parseNumber(t),"NaN"===t.toString())?"":(""===n&&(n="0"),u={format:n},i.formatNumber(r,u))},n.formatDate=function(n,t){var u=new sf.base.Internationalization,i=new Date(t),r;return isNaN(i.getDate())?"":""===n?t:(-1!==n.indexOf("am/pm")&&(n=n.replace(/am\/pm/gi,"a")),r={format:n},u.formatDate(i,r))},n.capitaliseFirst=function(n,t,i){var f="",r,u;if("Titlecase"===t){for(r=i?n.split(i):n.split(" "),u=0;u<r.length;u++)f+=i?r[u].charAt(0).toUpperCase()+r[u].slice(1,r[u].length):this.capitaliseFirstInternal(r[u]),r.length>=0&&!i&&(f+=" ");i||(f=this.capitaliseFirst(f,"Titlecase","\r"))}else"FirstCapital"===t&&(f=this.capitaliseFirstInternal(n));return f},n.lowerFirstChar=function(n){return n.charAt(0).toLowerCase()+n.slice(1,n.length)},n.capitaliseFirstInternal=function(n){return n.charAt(0).toUpperCase()+n.slice(1,n.length).toLowerCase()},n.getModifiedDate=function(n){var t=new Date(n);return t.toLocaleDateString([],{year:"numeric",month:"long",day:"numeric"})+" "+t.toLocaleTimeString([],{hour:"numeric",minute:"numeric"})},n.getCompatibilityModeValue=function(n){var t;switch(n){case"Word2003":t="11";break;case"Word2007":t="12";break;case"Word2010":t="14";break;default:t="15"}return t},n.wordBefore="\\b",n.wordAfter="\\b",n.wordSplitCharacters=[" ",",",".",":",";","<",">","=","+","-","_","{","}","[","]","`","~","!","@","#","$","%","^","&","*","(",")",'"',"?","/","|","\\","","","","","","",""],n}(),d=function(){function n(n,t){this.xIn=0;this.yIn=0;this.xIn=n;this.yIn=t}return Object.defineProperty(n.prototype,"x",{get:function(){return this.xIn},set:function(n){this.xIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.yIn},set:function(n){this.yIn=n},enumerable:!0,configurable:!0}),n.prototype.copy=function(n){this.xIn=n.xIn;this.yIn=n.yIn},n.prototype.destroy=function(){this.xIn=void 0;this.yIn=void 0},n}(),gu=function(){function n(){this.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}return n.prototype.encodeString=function(n){var o,r,u,s,h,f,t,e="",i=0;for(n=this.unicodeEncode(n);i<n.length;)s=(o=n.charCodeAt(i++))>>2,h=(3&o)<<4|(r=n.charCodeAt(i++))>>4,f=(15&r)<<2|(u=n.charCodeAt(i++))>>6,t=63&u,isNaN(r)?f=t=64:isNaN(u)&&(t=64),e=e+this.keyStr.charAt(s)+this.keyStr.charAt(h)+this.keyStr.charAt(f)+this.keyStr.charAt(t);return e},n.prototype.unicodeEncode=function(n){for(var t,u=n.replace(/\r\n/g,"\n"),i="",r=0;r<u.length;r++)t=u.charCodeAt(r),t<128?i+=String.fromCharCode(t):t>127&&t<2048?(i+=String.fromCharCode(t>>6|192),i+=String.fromCharCode(63&t|128)):(i+=String.fromCharCode(t>>12|224),i+=String.fromCharCode(t>>6&63|128),i+=String.fromCharCode(63&t|128));return i},n.prototype.decodeString=function(n){var e,o,s,h,u,c,t=0,f=0,r=3*(n=n.replace(/[^A-Za-z0-9+/=]/g,"")).length/4,i;if(n.charAt(n.length-1)===this.keyStr.charAt(64)&&r--,n.charAt(n.length-2)===this.keyStr.charAt(64)&&r--,r%1!=0)throw new Error("Invalid base64 input, bad content length.");for(i=new Uint8Array(0|r);t<n.length;)e=this.keyStr.indexOf(n.charAt(t++))<<2|(h=this.keyStr.indexOf(n.charAt(t++)))>>4,o=(15&h)<<4|(u=this.keyStr.indexOf(n.charAt(t++)))>>2,s=(3&u)<<6|(c=this.keyStr.indexOf(n.charAt(t++))),i[f++]=e,64!==u&&(i[f++]=o),64!==c&&(i[f++]=s);return i},n}(),nf=function(){function n(n,t){this.x=0;this.width=0;this.x=n;this.width=t}return Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),n}(),wi=function(){function n(){this.abstractListIdIn=-1;this.levels=[]}return Object.defineProperty(n.prototype,"abstractListId",{get:function(){return this.abstractListIdIn},set:function(n){this.abstractListIdIn=n},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){var n,t;if(!sf.base.isNullOrUndefined(this.levels)){for(n=0;n<this.levels.length;n++)t=this.levels[n],t.destroy(),this.levels.splice(this.levels.indexOf(t),1),n--;this.levels=[]}this.levels=void 0},n.prototype.clone=function(){for(var t=new n,i=0;i<this.levels.length;i++)t.levels.push(this.levels[i].clone(t));return t},n}(),ft=function(){function n(n){this.uniqueBorderFormat=void 0;this.ownerBase=void 0;this.ownerBase=n}return Object.defineProperty(n.prototype,"color",{get:function(){return this.getPropertyValue("color")},set:function(n){this.setPropertyValue("color",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineStyle",{get:function(){return this.getPropertyValue("lineStyle")},set:function(n){this.setPropertyValue("lineStyle",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineWidth",{get:function(){return this.getPropertyValue("lineWidth")},set:function(n){this.setPropertyValue("lineWidth",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"shadow",{get:function(){return this.getPropertyValue("shadow")},set:function(n){this.setPropertyValue("shadow",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"space",{get:function(){return this.getPropertyValue("space")},set:function(n){this.setPropertyValue("space",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasNoneStyle",{get:function(){return this.getPropertyValue("hasNoneStyle")},set:function(n){this.setPropertyValue("hasNoneStyle",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isBorderDefined",{get:function(){return"None"!==this.lineStyle||this.hasNoneStyle&&this.hasValue("hasNoneStyle")},enumerable:!0,configurable:!0}),n.prototype.getPropertyValue=function(t){var r,i;return this.hasValue(t)&&(r=y.getPropertyType(n.uniqueFormatType,t),!sf.base.isNullOrUndefined(this.uniqueBorderFormat)&&(i=this.uniqueBorderFormat.propertiesHash.get(r),!sf.base.isNullOrUndefined(i)))?i:n.getPropertyDefaultValue(t)},n.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=n.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueBorderFormat))this.initializeUniqueBorder(t,i);else{var r=y.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,t);if(this.uniqueBorderFormat.propertiesHash.containsKey(r)&&this.uniqueBorderFormat.propertiesHash.get(r)===i)return;this.uniqueBorderFormat=n.uniqueBorderFormats.updateUniqueFormat(this.uniqueBorderFormat,t,i)}},n.prototype.initializeUniqueBorder=function(t,i){var r=new h;this.addUniqueBorderFormat("color",t,i,r);this.addUniqueBorderFormat("lineStyle",t,i,r);this.addUniqueBorderFormat("lineWidth",t,i,r);this.addUniqueBorderFormat("shadow",t,i,r);this.addUniqueBorderFormat("space",t,i,r);this.addUniqueBorderFormat("hasNoneStyle",t,i,r);this.uniqueBorderFormat=n.uniqueBorderFormats.addUniqueFormat(r,n.uniqueFormatType)},n.prototype.addUniqueBorderFormat=function(t,i,r,u){var f=y.getPropertyType(n.uniqueFormatType,t);t===i&&u.add(f,r)},n.getPropertyDefaultValue=function(n){var t=void 0;switch(n){case"color":t="#000000";break;case"lineStyle":t="None";break;case"lineWidth":t=0;break;case"shadow":t=!1;break;case"space":t=0;break;case"hasNoneStyle":t=!1}return t},n.prototype.getLineWidth=function(){switch(this.lineStyle){case"None":case"Cleared":return 0;case"Triple":case"Double":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"Emboss3D":case"Engrave3D":for(var t=this.getBorderLineWidthArray(this.lineStyle,this.lineWidth),i=0,n=0;n<t.length;n++)i+=t[n];return i;case"Single":case"DashLargeGap":case"DashSmallGap":case"Dot":case"DashDot":case"DashDotDot":case"Thick":return this.lineWidth;case"SingleWavy":return 1.5===this.lineWidth?3:2.5;case"DoubleWavy":return 6.75;case"DashDotStroked":case"Outset":return this.lineWidth}return this.lineWidth},n.prototype.getBorderLineWidthArray=function(n,t){var i=[t],r;switch(n){case"Double":i=[1,1,1];break;case"ThinThickSmallGap":i=[1,-.75,-.75];break;case"ThickThinSmallGap":i=[-.75,-.75,1];break;case"ThinThickMediumGap":i=[1,.5,.5];break;case"ThickThinMediumGap":i=[.5,.5,1];break;case"ThinThickLargeGap":i=[-1.5,1,-.75];break;case"ThickThinLargeGap":i=[-.75,1,-1.5];break;case"Triple":i=[1,1,1,1,1];break;case"ThinThickThinSmallGap":i=[-.75,-.75,1,-.75,-.75];break;case"ThinThickThinMediumGap":i=[.5,.5,1,.5,.5];break;case"ThinThickThinLargeGap":i=[-.75,1,-1.5,1,-.75];break;case"Emboss3D":case"Engrave3D":i=[.25,0,1,0,.25]}if(1===i.length)return[t];for(r=0;r<i.length;r++)i[r]=i[r]>=0?i[r]*t:Math.abs(i[r]);return i},n.prototype.getBorderWeight=function(){var n=0,t=this.getNumberOfLines(),i=this.getBorderNumber();switch(this.lineStyle){case"Single":case"DashSmallGap":case"DashDot":case"DashDotDot":case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"SingleWavy":case"DoubleWavy":case"DashDotStroked":case"Emboss3D":case"Engrave3D":case"Outset":case"Inset":case"Thick":n=t*i;break;case"Dot":case"DashLargeGap":n=1}return n},n.prototype.getBorderNumber=function(){var n=0;switch(this.lineStyle){case"Single":n=1;break;case"Thick":n=2;break;case"Double":n=3;break;case"Dot":n=4;break;case"DashLargeGap":n=5;break;case"DashDot":n=6;break;case"DashDotDot":n=7;break;case"Triple":n=8;break;case"ThinThickSmallGap":n=9;break;case"ThickThinSmallGap":n=10;break;case"ThinThickThinSmallGap":n=11;break;case"ThinThickMediumGap":n=12;break;case"ThickThinMediumGap":n=13;break;case"ThinThickThinMediumGap":n=14;break;case"ThinThickLargeGap":n=15;break;case"ThickThinLargeGap":n=16;break;case"ThinThickThinLargeGap":n=17;break;case"SingleWavy":n=18;break;case"DoubleWavy":n=19;break;case"DashSmallGap":n=20;break;case"DashDotStroked":n=21;break;case"Emboss3D":n=22;break;case"Engrave3D":n=23;break;case"Outset":n=24;break;case"Inset":n=25}return n},n.prototype.getNumberOfLines=function(){var n=0;switch(this.lineStyle){case"Single":case"Dot":case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":n=1;break;case"Double":n=3;break;case"Triple":n=5;break;case"ThinThickSmallGap":case"ThickThinSmallGap":n=3;break;case"ThinThickThinSmallGap":n=5;break;case"ThinThickMediumGap":case"ThickThinMediumGap":n=3;break;case"ThinThickThinMediumGap":n=5;break;case"ThinThickLargeGap":case"ThickThinLargeGap":n=3;break;case"ThinThickThinLargeGap":n=5;break;case"SingleWavy":n=1;break;case"DoubleWavy":n=2;break;case"DashDotStroked":n=1;break;case"Emboss3D":case"Engrave3D":n=3;break;case"Outset":case"Inset":case"Thick":n=1}return n},n.prototype.getPrecedence=function(){var n=0;switch(this.lineStyle){case"Single":n=1;break;case"Thick":n=2;break;case"Double":n=3;break;case"Dot":n=4;break;case"DashLargeGap":n=5;break;case"DashDot":n=6;break;case"DashDotDot":n=7;break;case"Triple":n=8;break;case"ThinThickSmallGap":n=9;break;case"ThickThinSmallGap":n=10;break;case"ThinThickThinSmallGap":n=11;break;case"ThinThickMediumGap":n=12;break;case"ThickThinMediumGap":n=13;break;case"ThinThickThinMediumGap":n=14;break;case"ThinThickLargeGap":n=15;break;case"ThickThinLargeGap":n=16;break;case"ThinThickThinLargeGap":n=17;break;case"SingleWavy":n=18;break;case"DoubleWavy":n=19;break;case"DashSmallGap":n=20;break;case"DashDotStroked":n=21;break;case"Emboss3D":n=22;break;case"Engrave3D":n=23;break;case"Outset":n=24;break;case"Inset":n=25}return n},n.prototype.hasValue=function(n){if(!sf.base.isNullOrUndefined(this.uniqueBorderFormat)){var t=y.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,n);return this.uniqueBorderFormat.propertiesHash.containsKey(t)}return!1},n.prototype.cloneFormat=function(){var t=new n(void 0);return t.color=this.color,t.lineStyle=this.lineStyle,t.lineWidth=this.lineWidth,t.shadow=this.shadow,t.space=this.space,t},n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.uniqueBorderFormat)||n.uniqueBorderFormats.remove(this.uniqueBorderFormat);this.uniqueBorderFormat=void 0},n.prototype.copyFormat=function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.uniqueBorderFormat)||(n.hasValue("color")&&(this.color=n.color),n.hasValue("lineStyle")&&(this.lineStyle=n.lineStyle),n.hasValue("lineWidth")&&(this.lineWidth=n.lineWidth),n.hasValue("shadow")&&(this.shadow=n.shadow),n.hasValue("space")&&(this.space=n.space))},n.clear=function(){this.uniqueBorderFormats.clear()},n.uniqueBorderFormats=new ei,n.uniqueFormatType=1,n}(),ni=function(){function n(n){this.leftIn=new ft(this);this.rightIn=new ft(this);this.topIn=new ft(this);this.bottomIn=new ft(this);this.horizontalIn=new ft(this);this.verticalIn=new ft(this);this.diagonalUpIn=new ft(this);this.diagonalDownIn=new ft(this);this.lineWidthIn=0;this.ownerBase=n}return Object.defineProperty(n.prototype,"left",{get:function(){return this.leftIn},set:function(n){this.leftIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.rightIn},set:function(n){this.rightIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.topIn},set:function(n){this.topIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.bottomIn},set:function(n){this.bottomIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"horizontal",{get:function(){return this.horizontalIn},set:function(n){this.horizontalIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"vertical",{get:function(){return this.verticalIn},set:function(n){this.verticalIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"diagonalUp",{get:function(){return this.diagonalUpIn},set:function(n){this.diagonalUpIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"diagonalDown",{get:function(){return this.diagonalDownIn},set:function(n){this.diagonalDownIn=n},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.left)||this.left.destroy();sf.base.isNullOrUndefined(this.top)||this.top.destroy();sf.base.isNullOrUndefined(this.bottom)||this.bottom.destroy();sf.base.isNullOrUndefined(this.right)||this.right.destroy();sf.base.isNullOrUndefined(this.horizontal)||this.horizontal.destroy();sf.base.isNullOrUndefined(this.vertical)||this.vertical.destroy();sf.base.isNullOrUndefined(this.diagonalDown)||this.diagonalDown.destroy();sf.base.isNullOrUndefined(this.diagonalUp)||this.diagonalUp.destroy();this.topIn=void 0;this.bottomIn=void 0;this.leftIn=void 0;this.rightIn=void 0;this.horizontalIn=void 0;this.verticalIn=void 0;this.diagonalDownIn=void 0;this.diagonalUpIn=void 0;this.lineWidthIn=void 0;this.valueIn=void 0},n.prototype.cloneFormat=function(){var t=new n(void 0);return t.top=sf.base.isNullOrUndefined(this.top)?void 0:this.top.cloneFormat(),t.bottom=sf.base.isNullOrUndefined(this.bottom)?void 0:this.bottom.cloneFormat(),t.left=sf.base.isNullOrUndefined(this.left)?void 0:this.left.cloneFormat(),t.right=sf.base.isNullOrUndefined(this.right)?void 0:this.right.cloneFormat(),t.horizontal=sf.base.isNullOrUndefined(this.horizontal)?void 0:this.horizontal.cloneFormat(),t.vertical=sf.base.isNullOrUndefined(this.vertical)?void 0:this.vertical.cloneFormat(),t.diagonalUp=sf.base.isNullOrUndefined(this.diagonalUp)?void 0:this.diagonalUp.cloneFormat(),t.diagonalDown=sf.base.isNullOrUndefined(this.diagonalDown)?void 0:this.diagonalDown.cloneFormat(),t},n.prototype.copyFormat=function(n){!sf.base.isNullOrUndefined(n.left)&&_instanceof(n.left,ft)&&(this.left=new ft(this),this.left.copyFormat(n.left));!sf.base.isNullOrUndefined(n.right)&&_instanceof(n.right,ft)&&(this.right=new ft(this),this.right.copyFormat(n.right));!sf.base.isNullOrUndefined(n.top)&&_instanceof(n.top,ft)&&(this.top=new ft(this),this.top.copyFormat(n.top));!sf.base.isNullOrUndefined(n.bottom)&&_instanceof(n.bottom,ft)&&(this.bottom=new ft(this),this.bottom.copyFormat(n.bottom));!sf.base.isNullOrUndefined(n.horizontal)&&_instanceof(n.horizontal,ft)&&(this.horizontal=new ft(this),this.horizontal.copyFormat(n.horizontal));!sf.base.isNullOrUndefined(n.vertical)&&_instanceof(n.vertical,ft)&&(this.vertical=new ft(this),this.vertical.copyFormat(n.vertical));!sf.base.isNullOrUndefined(n.diagonalDown)&&_instanceof(n.diagonalDown,ft)&&(this.diagonalDown=new ft(this),this.diagonalDown.copyFormat(n.diagonalDown));!sf.base.isNullOrUndefined(n.diagonalUp)&&_instanceof(n.diagonalUp,ft)&&(this.diagonalUp=new ft(this),this.diagonalUp.copyFormat(n.diagonalUp))},n}(),ti=function(){function n(n){this.uniqueRowFormat=void 0;this.borders=new ni(this);this.ownerBase=void 0;this.beforeWidth=0;this.afterWidth=0;this.revisions=[];this.removedIds=[];this.ownerBase=n}return Object.defineProperty(n.prototype,"gridBefore",{get:function(){return this.getPropertyValue("gridBefore")},set:function(n){this.setPropertyValue("gridBefore",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"gridBeforeWidth",{get:function(){return this.getPropertyValue("gridBeforeWidth")},set:function(n){this.setPropertyValue("gridBeforeWidth",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"gridBeforeWidthType",{get:function(){return this.getPropertyValue("gridBeforeWidthType")},set:function(n){this.setPropertyValue("gridBeforeWidthType",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"gridAfter",{get:function(){return this.getPropertyValue("gridAfter")},set:function(n){this.setPropertyValue("gridAfter",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"gridAfterWidth",{get:function(){return this.getPropertyValue("gridAfterWidth")},set:function(n){this.setPropertyValue("gridAfterWidth",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"gridAfterWidthType",{get:function(){return this.getPropertyValue("gridAfterWidthType")},set:function(n){this.setPropertyValue("gridAfterWidthType",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"allowBreakAcrossPages",{get:function(){return this.getPropertyValue("allowBreakAcrossPages")},set:function(n){this.setPropertyValue("allowBreakAcrossPages",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isHeader",{get:function(){return this.getPropertyValue("isHeader")},set:function(n){this.setPropertyValue("isHeader",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(n){this.setPropertyValue("rightMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.getPropertyValue("height")},set:function(n){0!==n||"AtLeast"!==this.heightType&&"Exactly"!==this.heightType?"Auto"===this.heightType&&(n=0):n=1;this.setPropertyValue("height",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"heightType",{get:function(){return this.getPropertyValue("heightType")},set:function(n){this.height="AtLeast"===n||"Exactly"===n?1:0;this.setPropertyValue("heightType",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(n){this.setPropertyValue("bottomMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(n){this.setPropertyValue("leftIndent",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(n){this.setPropertyValue("topMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(n){this.setPropertyValue("leftMargin",n)},enumerable:!0,configurable:!0}),n.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=y.getPropertyType(n.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueRowFormat)&&this.uniqueRowFormat.propertiesHash.containsKey(i))return this.uniqueRowFormat.propertiesHash.get(i)}return n.getPropertyDefaultValue(t)},n.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=n.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueRowFormat))this.initializeUniqueRowFormat(t,i);else{var r=y.getPropertyType(this.uniqueRowFormat.uniqueFormatType,t);if(this.uniqueRowFormat.propertiesHash.containsKey(r)&&this.uniqueRowFormat.propertiesHash.get(r)===i)return;this.uniqueRowFormat=n.uniqueRowFormats.updateUniqueFormat(this.uniqueRowFormat,t,i)}},n.prototype.initializeUniqueRowFormat=function(t,i){var r=new h;this.addUniqueRowFormat("allowBreakAcrossPages",t,i,r);this.addUniqueRowFormat("isHeader",t,i,r);this.addUniqueRowFormat("height",t,i,r);this.addUniqueRowFormat("heightType",t,i,r);this.addUniqueRowFormat("gridBefore",t,i,r);this.addUniqueRowFormat("gridBeforeWidth",t,i,r);this.addUniqueRowFormat("gridBeforeWidthType",t,i,r);this.addUniqueRowFormat("gridAfter",t,i,r);this.addUniqueRowFormat("gridAfterWidth",t,i,r);this.addUniqueRowFormat("gridgridAfterWidth",t,i,r);this.addUniqueRowFormat("gridBeforeWidthType",t,i,r);this.addUniqueRowFormat("leftMargin",t,i,r);this.addUniqueRowFormat("rightMargin",t,i,r);this.addUniqueRowFormat("topMargin",t,i,r);this.addUniqueRowFormat("bottomMargin",t,i,r);this.addUniqueRowFormat("leftIndent",t,i,r);this.uniqueRowFormat=n.uniqueRowFormats.addUniqueFormat(r,n.uniqueFormatType)},n.prototype.addUniqueRowFormat=function(t,i,r,u){var f=y.getPropertyType(n.uniqueFormatType,t);t===i&&u.add(f,r)},n.getPropertyDefaultValue=function(n){var t=void 0;switch(n){case"allowBreakAcrossPages":t=!0;break;case"isHeader":t=!1;break;case"height":t=0;break;case"heightType":t="Auto";break;case"gridBefore":case"gridBeforeWidth":t=0;break;case"gridBeforeWidthType":t="Point";break;case"gridAfter":case"gridAfterWidth":t=0;break;case"gridAfterWidthType":t="Point";break;case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0;break;case"leftIndent":t=0}return t},n.prototype.containsMargins=function(){return!(sf.base.isNullOrUndefined(this.leftMargin)&&sf.base.isNullOrUndefined(this.rightMargin)&&sf.base.isNullOrUndefined(this.bottomMargin)&&sf.base.isNullOrUndefined(this.topMargin))},n.prototype.cloneFormat=function(){var t=new n;return t.allowBreakAcrossPages=this.allowBreakAcrossPages,t.heightType=this.heightType,t.height=this.height,t.isHeader=this.isHeader,t.gridBefore=this.gridBefore,t.gridBeforeWidth=this.gridBeforeWidth,t.gridBeforeWidthType=this.gridBeforeWidthType,t.gridAfter=this.gridAfter,t.gridAfterWidth=this.gridAfterWidth,t.gridAfterWidthType=this.gridAfterWidthType,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.leftIndent=this.leftIndent,t.removedIds=this.revisions.length>0?ii.cloneRevisions(this.revisions):this.removedIds.slice(),t},n.prototype.hasValue=function(n){if(!sf.base.isNullOrUndefined(this.uniqueRowFormat)){var t=y.getPropertyType(this.uniqueRowFormat.uniqueFormatType,n);return this.uniqueRowFormat.propertiesHash.containsKey(t)}return!1},n.prototype.copyFormat=function(n){sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(n.uniqueRowFormat)||(this.allowBreakAcrossPages=n.allowBreakAcrossPages,this.isHeader=n.isHeader,this.heightType=n.heightType,this.height=n.height,this.gridBefore=n.gridBefore,this.gridBeforeWidth=n.gridBeforeWidth,this.gridBeforeWidthType=n.gridBeforeWidthType,this.gridAfter=n.gridAfter,this.gridAfterWidth=n.gridAfterWidth,this.gridAfterWidthType=n.gridAfterWidthType,this.leftMargin=n.leftMargin,this.topMargin=n.topMargin,this.rightMargin=n.rightMargin,this.bottomMargin=n.bottomMargin,this.leftIndent=n.leftIndent),sf.base.isNullOrUndefined(n.borders)||(this.borders=new ni(this),this.borders.ownerBase=n,this.borders.copyFormat(n.borders)),this.removedIds=n.revisions.length>0?ii.cloneRevisions(n.revisions):n.removedIds.slice())},n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.borders)||this.borders.destroy();sf.base.isNullOrUndefined(this.uniqueRowFormat)||n.uniqueRowFormats.remove(this.uniqueRowFormat);this.beforeWidth=void 0;this.afterWidth=void 0;this.borders=void 0;this.uniqueRowFormat=void 0},n.clear=function(){this.uniqueRowFormats.clear()},n.uniqueRowFormats=new ei,n.uniqueFormatType=6,n}(),ii=function(){function n(n,t,i){this.author=null;this.date=null;this.range=[];this.revisionID="";this.isContentRemoved=!1;this.isTableRevision=!1;this.canSkipTableItems=!1;this.skipUnLinkElement=!1;this.author=t;this.date=i;this.owner=n}return n.prototype.handleAcceptReject=function(n){var r,i,o,u;this.owner.selection.selectRevision(this);var t=this.owner.selection,f=t.start,e=t.end;if(t.start.isExistBefore(t.end)||(f=t.end,e=t.start),r=t.getParagraphInfo(f),this.owner.editor.initHistory(n?"Accept Change":"Reject Change"),"Deletion"===this.revisionType?(r=t.getParagraphInfo(this.owner.selection.start),t.editPosition=this.owner.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())):t.editPosition=this.owner.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),this.owner.editor.updateInsertPosition(),this.isContentRemoved=!1,this.canSkipTableItems=!1,this.skipUnLinkElement=!1,"Insertion"===this.revisionType||"Deletion"===this.revisionType||"MoveFrom"===this.revisionType||"MoveTo"===this.revisionType)for(i=0;this.range.length>0&&(_instanceof(this.range[i],tt)||_instanceof(this.range[i],p)||_instanceof(this.range[i],ti));)this.unlinkRangeItem(this.range[i],this,n)?i++:i=0;(this.isTableRevision=!1,this.isContentRemoved)?(o=t.getTextPosBasedOnLogicalIndex(t.editPosition),this.owner.selection.selectContent(o,!0),this.owner.editor.updateEndPosition()):(t.selectRange(f,e),this.owner.editor.updateHistoryPosition(e,!1));(this.owner.editorHistory&&"BackSpace"!==this.owner.editorHistory.currentBaseHistoryInfo.action&&this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.reverse(),this.owner.editorHistory)&&(this.owner.trackChangesPane.isTrackingPageBreak&&(this.owner.editorHistory.currentBaseHistoryInfo.action="TrackingPageBreak"),u=this.owner.editorHistory,u.currentHistoryInfo&&("Accept All"===u.currentHistoryInfo.action||"Reject All"===u.currentHistoryInfo.action)&&this.owner.documentHelper.blockToShift&&this.owner.documentHelper.layout.shiftLayoutedItems(!1),u.updateHistory());this.owner.editor.reLayout(this.owner.selection)},n.prototype.accept=function(){this.handleAcceptReject(!0)},n.prototype.reject=function(){this.handleAcceptReject(!1)},n.prototype.unlinkRangeItem=function(n,t,i){var r,e,u,f,o,s;if(this.isTableRevision)return this.removeRangeRevisionForItem(n),0===t.range.length&&this.owner.revisions.remove(t),!1;if(r=!sf.base.isNullOrUndefined(i)&&("MoveFrom"===t.revisionType||"Deletion"===t.revisionType)&&i||("Insertion"===t.revisionType||"MoveTo"===t.revisionType)&&!i,this.owner.selection.isTOC()){if(r)this.owner.editor.deleteSelectedContents(this.owner.selection,!0),0===t.range.length&&this.owner.revisions.remove(t),this.isContentRemoved=!0,this.owner.editorHistory.currentBaseHistoryInfo.action="BackSpace";else{for(;this.range.length>0;)e=this.range[0],this.removeRangeRevisionForItem(e),0===t.range.length&&this.owner.revisions.remove(t);this.owner.editor.addRemovedNodes(this.revisionID);this.owner.editorHistory.currentBaseHistoryInfo.action="AcceptTOC"}return!1}if(_instanceof(n,tt)&&!this.canSkipTableItems)if(r){if(this.skipeElementRemoval(n))return this.skipUnLinkElement=!0,!0;this.owner.editor.addRemovedNodes(n.clone())}else this.owner.editorHistory.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID();else this.canSkipTableItems||!_instanceof(n,p)||r?_instanceof(n,ti)&&!r&&(this.isTableRevision=!0,u=n.ownerBase.ownerTable,f=n.ownerBase,this.owner.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack",this.owner.editor.cloneTableToHistoryInfo(u)):(this.owner.editorHistory.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID());if(r=r&&!this.canSkipTableItems,_instanceof(n,tt)&&r)o=n.line.paragraph,this.removeRevisionItemsFromRange(n),this.removeItem(n),this.isContentRemoved=!0,this.owner.documentHelper.layout.reLayoutParagraph(o,0,0);else if(_instanceof(n,p)&&r){if(this.isContentRemoved=!0,this.skipUnLinkElement=!1,this.removeRevisionItemsFromRange(n),1===t.range.length)this.owner.editor.deleteSelectedContents(this.owner.selection,!0);else for(this.owner.editor.deleteSelectedContents(this.owner.selection,!0),s=t.range.indexOf(n),t.range.splice(s,1);this.range.length>0;)this.removeRangeRevisionForItem(this.range[0]);this.owner.editorHistory.currentBaseHistoryInfo.action="BackSpace"}else _instanceof(n,ti)&&r&&(u=n.ownerBase.ownerTable,f=n.ownerBase,this.removeRevisionItemsFromRange(n),this.owner.editorHistory.currentBaseHistoryInfo.action="DeleteCells",this.owner.editor.cloneTableToHistoryInfo(u),this.owner.editor.removeDeletedCellRevision(f),this.isContentRemoved=!0,u.removeChild(u.childWidgets.indexOf(f)),this.canSkipTableItems=!0,f.destroy(),0===u.childWidgets.length?(this.owner.selection.editPosition=this.owner.selection.getHierarchicalIndex(u,"0"),this.owner.editor.removeBlock(u),u.destroy()):this.owner.editor.updateTable(u));return _instanceof(n,ti)&&r||this.skipUnLinkElement||this.removeRangeRevisionForItem(n),0===t.range.length&&this.owner.revisions.remove(t),!1},n.prototype.updateRevisionID=function(){for(this.owner.editor.addRemovedNodes(this.revisionID);this.range.length>0;)this.removeRangeRevisionForItem(this.range[0])},n.prototype.removeRevisionItemsFromRange=function(n){var t,i,r;if(n.revisions.length>0)for(t=0;t<n.revisions.length;t++)i=n.revisions[t],this.revisionID!==i.revisionID&&(r=i.range.indexOf(n),n.revisions[t].range.splice(r,1)),0===i.range.length&&this.owner.revisions.remove(i)},n.prototype.removeRangeRevisionForItem=function(n){var t=n.revisions.indexOf(this),i;t>=0&&(n.revisions.splice(t,1),i=this.range.indexOf(n),this.range.splice(i,1))},n.prototype.skipeElementRemoval=function(n){var i=n.paragraph,t;if(i.characterFormat.revisions.length>0)for(t=0;t<i.characterFormat.revisions.length;t++)if(i.characterFormat.revisions[t].range.indexOf(n)>=0)return!0;return!1},n.prototype.removeRevisionFromRow=function(n){var t,i;for(this.owner.editor.unlinkRangeFromRevision(n.rowFormat),t=0;t<n.childWidgets.length;t++)i=n.childWidgets[t],this.owner.editor.removeRevisionForCell(i,!1)},n.prototype.removeItem=function(n){var i=n.line.paragraph,t;this.owner.editor.unLinkFieldCharacter(n);t=n.line.children.indexOf(n);n.line.children.splice(t,1);this.owner.editor.removeEmptyLine(i)},n.prototype.canSkipCloning=function(){return!sf.base.isNullOrUndefined(this.owner)&&this.owner.editorHistory&&this.owner.editorHistory.currentBaseHistoryInfo&&"DeleteCells"===this.owner.editorHistory.currentBaseHistoryInfo.action?!0:!1},n.prototype.clone=function(){if(this.canSkipCloning())return this;var t=new n(void 0,this.author,this.date);return t.revisionID=this.revisionID,t.revisionType=this.revisionType,t},n.cloneRevisions=function(n){for(var i=[],t=0;t<n.length;t++)i.push(n[t].revisionID);return i},n}(),tf=function(){function n(n){this.changes=[];this.owner=n}return n.prototype.get=function(n){if(n>=this.changes.length||n<0)throw new ReferenceError("Provided index is not within the range");return this.changes[n]},Object.defineProperty(n.prototype,"length",{get:function(){return this.changes.length},enumerable:!0,configurable:!0}),n.prototype.remove=function(n){sf.base.isNullOrUndefined(n)||this.changes.indexOf(n)<0||this.changes.splice(this.changes.indexOf(n),1)},n.prototype.acceptAll=function(){this.owner.isReadOnly||this.handleRevisionCollection(!0)},n.prototype.rejectAll=function(){this.owner.isReadOnly||this.handleRevisionCollection(!1)},n.prototype.handleRevisionCollection=function(n,t){var i=this.owner.selection,u=i.start,f=i.end,r,e;for(i.start.isExistBefore(i.end)||(u=i.end,f=i.start),u=u.clone(),f=f.clone(),n?this.owner.editor.initComplexHistory("Accept All"):this.owner.editor.initComplexHistory("Reject All"),r=t||this.changes;r.length>0;)n?r[0].accept():r[0].reject(),t&&r.splice(0,1);e=i.getTextPosBasedOnLogicalIndex(i.editPosition);this.owner.selection.selectContent(e,!0);this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory();this.owner.editor.reLayout(this.owner.selection,!1)},n.prototype.destroy=function(){this.changes=[]},n}(),p=function(){function n(n){this.uniqueCharacterFormat=void 0;this.ownerBase=void 0;this.baseCharStyle=void 0;this.removedIds=[];this.revisions=[];this.ownerBase=n}return Object.defineProperty(n.prototype,"bold",{get:function(){return this.getPropertyValue("bold")},set:function(n){this.setPropertyValue("bold",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"italic",{get:function(){return this.getPropertyValue("italic")},set:function(n){this.setPropertyValue("italic",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontSize",{get:function(){return this.getPropertyValue("fontSize")},set:function(n){this.setPropertyValue("fontSize",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this.getPropertyValue("fontFamily")},set:function(n){this.setPropertyValue("fontFamily",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"underline",{get:function(){return this.getPropertyValue("underline")},set:function(n){this.setPropertyValue("underline",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"strikethrough",{get:function(){return this.getPropertyValue("strikethrough")},set:function(n){this.setPropertyValue("strikethrough",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"baselineAlignment",{get:function(){return this.getPropertyValue("baselineAlignment")},set:function(n){this.setPropertyValue("baselineAlignment",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"highlightColor",{get:function(){return this.getPropertyValue("highlightColor")},set:function(n){this.setPropertyValue("highlightColor",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontColor",{get:function(){return this.getPropertyValue("fontColor")},set:function(n){this.setPropertyValue("fontColor",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(n){this.setPropertyValue("bidi",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bdo",{get:function(){return this.getPropertyValue("bdo")},set:function(n){this.setPropertyValue("bdo",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"boldBidi",{get:function(){return this.getPropertyValue("boldBidi")},set:function(n){this.setPropertyValue("boldBidi",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"italicBidi",{get:function(){return this.getPropertyValue("italicBidi")},set:function(n){this.setPropertyValue("italicBidi",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontSizeBidi",{get:function(){return this.getPropertyValue("fontSizeBidi")},set:function(n){this.setPropertyValue("fontSizeBidi",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontFamilyBidi",{get:function(){return this.getPropertyValue("fontFamilyBidi")},set:function(n){this.setPropertyValue("fontFamilyBidi",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"allCaps",{get:function(){return this.getPropertyValue("allCaps")},set:function(n){this.setPropertyValue("allCaps",n)},enumerable:!0,configurable:!0}),n.prototype.getPropertyValue=function(t){var u,f,c,e,l,r,o,s,h;if(this.hasValue(t)){if(u=y.getPropertyType(n.uniqueFormatType,t),!sf.base.isNullOrUndefined(this.uniqueCharacterFormat)&&this.uniqueCharacterFormat.propertiesHash.containsKey(u))return this.uniqueCharacterFormat.propertiesHash.get(u)}else{if(f=this.checkCharacterStyle(t),!sf.base.isNullOrUndefined(f))return f;if(!sf.base.isNullOrUndefined(this.baseCharStyle)&&(c=this.ownerBase.paragraph,e=this.ownerBase.line,!sf.base.isNullOrUndefined(c)&&!sf.base.isNullOrUndefined(e)))for(l=e.children.length,r=0;r<l;r++)o=this.ownerBase.line.children[r],_instanceof(o,i)&&(s=o.text,s.startsWith("HYPERLINK")&&-1!==s.indexOf("_Toc")&&(this.baseCharStyle=this.ownerBase.paragraph.paragraphFormat.baseStyle));if(h=this.checkBaseStyle(t),!sf.base.isNullOrUndefined(h))return h}return this.getDefaultValue(t)},n.prototype.getDefaultValue=function(t){var r=y.getPropertyType(n.uniqueFormatType,t),i=this.documentCharacterFormat();return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.uniqueCharacterFormat)||!i.uniqueCharacterFormat.propertiesHash.containsKey(r)?n.getPropertyDefaultValue(t):i.uniqueCharacterFormat.propertiesHash.get(r)},n.prototype.documentCharacterFormat=function(){var n;return sf.base.isNullOrUndefined(this.ownerBase)||(sf.base.isNullOrUndefined(this.ownerBase.paragraph)||sf.base.isNullOrUndefined(this.ownerBase.paragraph.bodyWidget)?sf.base.isNullOrUndefined(this.ownerBase.bodyWidget)||(n=this.ownerBase.bodyWidget.page.documentHelper.characterFormat):n=this.ownerBase.paragraph.bodyWidget.page.documentHelper.characterFormat),n},n.prototype.checkBaseStyle=function(t){var i,r;for(sf.base.isNullOrUndefined(this.ownerBase)||(sf.base.isNullOrUndefined(this.ownerBase.paragraph)?_instanceof(this.ownerBase,u)&&!sf.base.isNullOrUndefined(this.ownerBase.paragraphFormat)?i=this.ownerBase.paragraphFormat.baseStyle:sf.base.isNullOrUndefined(_instanceof(this.ownerBase,fi))||(i=this.ownerBase.basedOn):i=this.ownerBase.paragraph.paragraphFormat.baseStyle);!sf.base.isNullOrUndefined(i)&&!i.characterFormat.hasValue(t);)i=i.basedOn;if(!sf.base.isNullOrUndefined(i))return r=y.getPropertyType(n.uniqueFormatType,t),i.characterFormat.uniqueCharacterFormat.propertiesHash.get(r)},n.prototype.checkCharacterStyle=function(t){var i=this.baseCharStyle,r;if(!sf.base.isNullOrUndefined(i))for(;!sf.base.isNullOrUndefined(i)&&"Default Paragraph Font"!==i.name;){if(i.characterFormat.hasValue(t))return r=y.getPropertyType(n.uniqueFormatType,t),i.characterFormat.uniqueCharacterFormat.propertiesHash.get(r);i=i.basedOn}},n.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=n.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueCharacterFormat))this.initializeUniqueCharacterFormat(t,i);else{var r=y.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,t);if(this.uniqueCharacterFormat.propertiesHash.containsKey(r)&&this.uniqueCharacterFormat.propertiesHash.get(r)===i)return;this.uniqueCharacterFormat=n.uniqueCharacterFormats.updateUniqueFormat(this.uniqueCharacterFormat,t,i)}},n.prototype.initializeUniqueCharacterFormat=function(t,i){var r=new h;this.addUniqueCharacterFormat("fontColor",t,i,r);this.addUniqueCharacterFormat("fontFamily",t,i,r);this.addUniqueCharacterFormat("fontSize",t,i,r);this.addUniqueCharacterFormat("bold",t,i,r);this.addUniqueCharacterFormat("italic",t,i,r);this.addUniqueCharacterFormat("underline",t,i,r);this.addUniqueCharacterFormat("strikethrough",t,i,r);this.addUniqueCharacterFormat("baselineAlignment",t,i,r);this.addUniqueCharacterFormat("highlightColor",t,i,r);this.addUniqueCharacterFormat("styleName",t,i,r);this.addUniqueCharacterFormat("bidi",t,i,r);this.addUniqueCharacterFormat("bdo",t,i,r);this.addUniqueCharacterFormat("fontFamilyBidi",t,i,r);this.addUniqueCharacterFormat("fontSizeBidi",t,i,r);this.addUniqueCharacterFormat("boldBidi",t,i,r);this.addUniqueCharacterFormat("italicBidi",t,i,r);this.addUniqueCharacterFormat("allCaps",t,i,r);this.uniqueCharacterFormat=n.uniqueCharacterFormats.addUniqueFormat(r,n.uniqueFormatType)},n.prototype.addUniqueCharacterFormat=function(t,i,r,u){var f=y.getPropertyType(n.uniqueFormatType,t);t===i&&u.add(f,r)},n.getPropertyDefaultValue=function(n){var t=void 0;switch(n){case"bold":case"italic":t=!1;break;case"fontSize":t=11;break;case"underline":case"strikethrough":t="None";break;case"baselineAlignment":t="Normal";break;case"highlightColor":t="NoColor";break;case"fontColor":t="#00000000";break;case"fontFamily":t="Calibri";break;case"styleName":t="Default Paragraph Font";break;case"bidi":t=!1;break;case"bdo":t="None";break;case"boldBidi":case"italicBidi":t=!1;break;case"fontSizeBidi":t=11;break;case"fontFamilyBidi":t="Calibri";break;case"allCaps":t=!1}return t},n.prototype.isEqualFormat=function(n){return this.fontSize===n.fontSize&&this.fontFamily===n.fontFamily&&this.bold===n.bold&&this.italic===n.italic&&this.baselineAlignment===n.baselineAlignment&&this.underline===n.underline&&this.fontColor===n.fontColor&&this.strikethrough===n.strikethrough&&this.highlightColor===n.highlightColor&&this.bidi===n.bidi&&this.bdo===n.bdo&&this.allCaps===n.allCaps},n.prototype.isSameFormat=function(n){return this.baseCharStyle===n.baseCharStyle&&this.uniqueCharacterFormat===n.uniqueCharacterFormat},n.prototype.cloneFormat=function(){var t=new n(void 0);return t.uniqueCharacterFormat=this.uniqueCharacterFormat,t.baseCharStyle=this.baseCharStyle,t.removedIds=this.revisions.length>0?ii.cloneRevisions(this.revisions):this.removedIds.slice(),t},n.prototype.hasValue=function(n){if(!sf.base.isNullOrUndefined(this.uniqueCharacterFormat)&&!sf.base.isNullOrUndefined(this.uniqueCharacterFormat.propertiesHash)){var t=y.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,n);return this.uniqueCharacterFormat.propertiesHash.containsKey(t)}return!1},n.prototype.clearFormat=function(){sf.base.isNullOrUndefined(this.uniqueCharacterFormat)||0!==this.uniqueCharacterFormat.referenceCount||n.uniqueCharacterFormats.remove(this.uniqueCharacterFormat);this.uniqueCharacterFormat=void 0;this.baseCharStyle=void 0},n.prototype.destroy=function(){this.clearFormat()},n.prototype.copyFormat=function(n){sf.base.isNullOrUndefined(n)||(!sf.base.isNullOrUndefined(n.uniqueCharacterFormat)&&n.uniqueCharacterFormat.propertiesHash&&this.updateUniqueCharacterFormat(n),sf.base.isNullOrUndefined(n.baseCharStyle)||(this.baseCharStyle=n.baseCharStyle),this.removedIds=n.revisions.length>0?ii.cloneRevisions(n.revisions):n.removedIds.slice())},n.prototype.updateUniqueCharacterFormat=function(t){var i=void 0;this.uniqueCharacterFormat&&(i=this.uniqueCharacterFormat.mergeProperties(t.uniqueCharacterFormat),0===this.uniqueCharacterFormat.referenceCount&&(n.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0));this.uniqueCharacterFormat=new y(n.uniqueFormatType);sf.base.isNullOrUndefined(i)&&(i=this.uniqueCharacterFormat.mergeProperties(t.uniqueCharacterFormat));this.uniqueCharacterFormat=n.uniqueCharacterFormats.addUniqueFormat(i,n.uniqueFormatType)},n.clear=function(){this.uniqueCharacterFormats.clear()},n.prototype.applyStyle=function(n){this.baseCharStyle=n},n.prototype.getValue=function(n){if(this.hasValue(n))return this.getPropertyValue(n)},n.prototype.mergeFormat=function(n){sf.base.isNullOrUndefined(this.getValue("bold"))&&(this.bold=n.getValue("bold"));sf.base.isNullOrUndefined(this.getValue("italic"))&&(this.italic=n.getValue("italic"));sf.base.isNullOrUndefined(this.getValue("fontSize"))&&(this.fontSize=n.getValue("fontSize"));sf.base.isNullOrUndefined(this.getValue("fontFamily"))&&(this.fontFamily=n.getValue("fontFamily"));sf.base.isNullOrUndefined(this.getValue("underline"))&&(this.underline=n.getValue("underline"));sf.base.isNullOrUndefined(this.getValue("strikethrough"))&&(this.strikethrough=n.getValue("strikethrough"));sf.base.isNullOrUndefined(this.getValue("baselineAlignment"))&&(this.baselineAlignment=n.getValue("baselineAlignment"));sf.base.isNullOrUndefined(this.getValue("highlightColor"))&&(this.highlightColor=n.getValue("highlightColor"));sf.base.isNullOrUndefined(this.getValue("fontColor"))&&(this.fontColor=n.getValue("fontColor"));sf.base.isNullOrUndefined(this.getValue("bidi"))&&(this.bidi=n.getValue("bidi"));sf.base.isNullOrUndefined(this.getValue("bdo"))&&(this.bdo=n.getValue("bdo"));sf.base.isNullOrUndefined(this.getValue("allCaps"))&&(this.allCaps=n.getValue("allCaps"))},n.uniqueCharacterFormats=new ei,n.uniqueFormatType=2,n}(),li=function(){function n(n){this.uniqueListLevel=void 0;this.paragraphFormat=void 0;this.characterFormat=void 0;this.ownerBase=n;this.characterFormat=new p(void 0);this.paragraphFormat=new ut(void 0)}return Object.defineProperty(n.prototype,"listLevelPattern",{get:function(){return this.getPropertyValue("listLevelPattern")},set:function(n){this.setPropertyValue("listLevelPattern",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"followCharacter",{get:function(){return this.getPropertyValue("followCharacter")},set:function(n){this.setPropertyValue("followCharacter",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"startAt",{get:function(){return this.getPropertyValue("startAt")},set:function(n){this.setPropertyValue("startAt",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"numberFormat",{get:function(){return this.getPropertyValue("numberFormat")},set:function(n){this.setPropertyValue("numberFormat",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"restartLevel",{get:function(){return this.getPropertyValue("restartLevel")},set:function(n){this.setPropertyValue("restartLevel",n)},enumerable:!0,configurable:!0}),n.prototype.getPropertyValue=function(t){var i=y.getPropertyType(n.uniqueFormatType,t);return!sf.base.isNullOrUndefined(this.uniqueListLevel)&&this.uniqueListLevel.propertiesHash.containsKey(i)?this.uniqueListLevel.propertiesHash.get(i):n.getPropertyDefaultValue(t)},n.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=n.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueListLevel))this.initializeUniqueWListLevel(t,i);else{var r=y.getPropertyType(this.uniqueListLevel.uniqueFormatType,t);if(this.uniqueListLevel.propertiesHash.containsKey(r)&&this.uniqueListLevel.propertiesHash.get(r)===i)return;this.uniqueListLevel=n.uniqueListLevels.updateUniqueFormat(this.uniqueListLevel,t,i)}},n.prototype.initializeUniqueWListLevel=function(t,i){var r=new h;this.addUniqueWListLevel("listLevelPattern",t,i,r);this.addUniqueWListLevel("startAt",t,i,r);this.addUniqueWListLevel("followCharacter",t,i,r);this.addUniqueWListLevel("numberFormat",t,i,r);this.addUniqueWListLevel("restartLevel",t,i,r);this.uniqueListLevel=n.uniqueListLevels.addUniqueFormat(r,n.uniqueFormatType)},n.prototype.addUniqueWListLevel=function(t,i,r,u){var f;f=y.getPropertyType(n.uniqueFormatType,t);t===i?u.add(f,r):u.add(f,n.getPropertyDefaultValue(t))},n.getPropertyDefaultValue=function(n){var t=void 0;switch(n){case"listLevelPattern":t="Arabic";break;case"startAt":t=0;break;case"followCharacter":t="Tab";break;case"numberFormat":t="";break;case"restartLevel":t=0}return t},n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.characterFormat)||this.characterFormat.destroy();sf.base.isNullOrUndefined(this.paragraphFormat)||this.paragraphFormat.destroy();sf.base.isNullOrUndefined(this.uniqueListLevel)||n.uniqueListLevels.remove(this.uniqueListLevel);this.uniqueListLevel=void 0;this.characterFormat=void 0;this.paragraphFormat=void 0},n.clear=function(){this.uniqueListLevels.clear()},n.prototype.clone=function(t){var i=new n(t);return i.paragraphFormat=this.paragraphFormat.cloneFormat(),i.characterFormat=this.characterFormat.cloneFormat(),this.uniqueListLevel&&(i.uniqueListLevel=this.uniqueListLevel,i.uniqueListLevel.referenceCount++),i},n.dotBullet="",n.squareBullet="",n.arrowBullet="",n.circleBullet=" ",n.uniqueListLevels=new ei,n.uniqueFormatType=9,n}(),dr=function(){function n(n){this.islayoutFootnote=!1;this.allowLayout=!0;this.footHeight=0;this.footnoteHeight=0;this.isTableFootNote=!1;this.isRelayout=!1;this.isRelayoutneed=!1;this.isOverlapFloatTable=!1;this.isInitialLoad=!0;this.fieldBegin=void 0;this.maxTextHeight=0;this.maxBaseline=0;this.maxTextBaseline=0;this.isFieldCode=!1;this.isRtlFieldCode=!1;this.isRTLLayout=!1;this.currentCell=void 0;this.isFootnoteContentChanged=!1;this.isEndnoteContentChanged=!1;this.keepWithNext=!1;this.isLayoutWhole=!1;this.isBidiReLayout=!1;this.defaultTabWidthPixel=48;this.isRelayoutFootnote=!1;this.isRelayoutOverlap=!1;this.isWrapText=!1;this.isYPositionUpdated=!1;this.isXPositionUpdated=!1;this.hasFloatingElement=!1;this.isFootNoteLayoutStart=!1;this.wrapPosition=[];this.shiftedFloatingItemsFromTable=[];this.documentHelper=n}return n.prototype.isSameStyle=function(n,t){var i=void 0;return t?_instanceof(n.nextWidget,u)&&(i=n.nextWidget):_instanceof(n.previousWidget,u)&&(i=n.previousWidget),!sf.base.isNullOrUndefined(i)&&n.paragraphFormat.baseStyle===i.paragraphFormat.baseStyle&&n.paragraphFormat.contextualSpacing},Object.defineProperty(n.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),n.prototype.layout=function(){},n.prototype.destroy=function(){this.documentHelper=void 0;this.value=void 0;this.allowLayout=void 0;this.isInitialLoad=void 0;this.fieldBegin=void 0;this.maxTextHeight=void 0;this.maxBaseline=void 0;this.maxTextBaseline=void 0;this.isFieldCode=void 0;this.footnoteHeight=void 0},n.prototype.layoutItems=function(n,t){for(var o,u,h,f,e,s,i=this,r=0;r<n.length;r++){if(u=n[r],h=this.documentHelper.pages[this.documentHelper.pages.length-1],r>0&&n[r-1].lastChild.isEndsWithPageBreak&&0===h.bodyWidgets[0].childWidgets.length&&this.documentHelper.pages.splice(this.documentHelper.pages.length-1,1),o=this.viewer.createNewPage(u),this.addBodyWidget(this.viewer.clientActiveArea,u),this.documentHelper.pages.length>1){for(f=0,e=0;e<this.documentHelper.pages.length;e++){if(s=this.documentHelper.pages[e],s.sectionIndex>u.index||s===o)break;f++}f<this.documentHelper.pages.length-1&&this.documentHelper.insertPage(f,o)}this.layoutSection(u,0)}t||this.layoutComments(this.documentHelper.comments);this.updateFieldElements();"Pages"===this.documentHelper.owner.layoutType&&this.layoutEndNoteElement();setTimeout(function(){i.documentHelper&&(i.documentHelper.isScrollHandler=!0,i.documentHelper.owner.isSpellCheck&&i.documentHelper.owner.spellChecker.enableOptimizedSpellCheck&&(i.documentHelper.triggerElementsOnLoading=!0),i.documentHelper.clearContent(),i.viewer.updateScrollBars(),sf.base.isNullOrUndefined(i.documentHelper.owner.selection)||i.documentHelper.owner.selection.updateCaretPosition(),i.documentHelper.isScrollHandler=!1,i.isInitialLoad=!1)},50)},n.prototype.layoutComments=function(n){sf.base.isNullOrUndefined(n)},n.prototype.layoutSection=function(n,t){var u,r,i=n.firstChild;do _instanceof(i,f)&&"Auto"===i.tableFormat.preferredWidthType&&!i.tableFormat.allowAutoFit&&i.calculateGrid(),this.viewer.updateClientAreaForBlock(i,!0),u=this.layoutBlock(i,t),t=0,this.viewer.updateClientAreaForBlock(i,!1),r&&sf.base.isNullOrUndefined(r.nextWidget)&&r.bodyWidget&&r.bodyWidget.page.footnoteWidget&&this.layoutfootNote(r.bodyWidget.page.footnoteWidget),r=i,i=u,sf.base.isNullOrUndefined(i)&&r.bodyWidget.page.footnoteWidget&&this.layoutfootNote(r.bodyWidget.page.footnoteWidget);while(i)},n.prototype.layoutHeaderFooter=function(n,t,i){var f=t.getCurrentPageHeaderFooter(n,!0),r,u;f&&(r=f.clone(),r.page=i,this.updateRevisionsToHeaderFooter(r,i),t.updateHFClientArea(n.sectionFormat,!0),i.headerWidget=this.layoutHeaderFooterItems(t,r),this.updateHeaderFooterToParent(r));(f=t.getCurrentPageHeaderFooter(n,!1))&&(u=f.clone(),u.page=i,t.updateHFClientArea(n.sectionFormat,!1),this.updateRevisionsToHeaderFooter(u,i),i.footerWidget=this.layoutHeaderFooterItems(t,u),this.updateHeaderFooterToParent(u))},n.prototype.updateHeaderFooterToParent=function(n){var u=n.page.sectionIndex,e=this.viewer.getHeaderFooter(n.headerFooterType),t=n.clone(),i,r;for(this.documentHelper.headersFooters[u][e]=t,i=0;i<t.childWidgets.length;i++)r=t.childWidgets[i],_instanceof(r,f)&&this.clearTableWidget(r,!1,!0);return t},n.prototype.updateRevisionsToHeaderFooter=function(n,t){var e=n.childWidgets,u,s,o,i,r,h,f,c;if(_instanceof(n,ct)&&e.length>0)for(u=0;u<e.length;u++)if(e[u].childWidgets.length>0)for(s=e[u].childWidgets,o=0;o<s.length;o++)if(i=s[o].children,i)for(r=0;r<i.length;r++)if(i[r].removedIds.length>0)for(h=i[r].removedIds,f=0;f<h.length;f++)c=this.documentHelper.revisionsInternal.get(h[f]),i[r].revisions[f]=c,this.updateRevisionRange(c,t)},n.prototype.updateRevisionRange=function(n,t){for(var r,i=0;i<n.range.length;i++)r=n.range[i],r.line.paragraph.bodyWidget.page||(r.line.paragraph.bodyWidget.page=t)},n.prototype.linkFieldInHeaderFooter=function(n){var t=n.firstChild;do _instanceof(t,u)?this.linkFieldInParagraph(t):this.linkFieldInTable(t);while(t=t.nextWidget)},n.prototype.linkFieldInParagraph=function(n){for(var o,e,t,i,f=0;f<n.childWidgets.length;f++)for(o=n.childWidgets[f],e=0;e<o.children.length;e++)if(t=o.children[e],_instanceof(t,r)&&(0!==t.fieldType||0===t.fieldType&&-1===this.documentHelper.fields.indexOf(t))&&t.linkFieldCharacter(this.documentHelper),_instanceof(t,ci)&&t.fieldBegin!==t.previousElement.fieldBegin&&(t.fieldBegin=t.previousElement.fieldBegin),_instanceof(t,nt)){i=t.textFrame.firstChild;do _instanceof(i,u)?this.linkFieldInParagraph(i):this.linkFieldInTable(i);while(i=i.nextWidget)}},n.prototype.linkFieldInTable=function(n){for(var e,i,o,r,f,t=0;t<n.childWidgets.length;t++)for(e=n.childWidgets[t],i=0;i<e.childWidgets.length;i++)for(o=e.childWidgets[i],r=0;r<o.childWidgets.length;r++)f=o.childWidgets[r],_instanceof(f,u)?this.linkFieldInParagraph(f):this.linkFieldInTable(f)},n.prototype.layoutHeaderFooterItems=function(n,t){var r,s,e,i,o;for((this.viewer.updateClientAreaLocation(t,n.clientActiveArea),0===t.childWidgets.length)&&(r=new u,s=new k(r),r.childWidgets.push(s),t.childWidgets.push(r),r.containerWidget=t),this.linkFieldInHeaderFooter(t),e=0;e<t.childWidgets.length;e++)i=t.childWidgets[e],!_instanceof(i,f)||"Auto"!==i.tableFormat.preferredWidthType||i.tableFormat.allowAutoFit||i.isGridUpdated||i.calculateGrid(),n.updateClientAreaForBlock(i,!0),this.layoutBlock(i,0),n.updateClientAreaForBlock(i,!1);return o=t.headerFooterType,"OddFooter"!==o&&"EvenFooter"!==o&&"FirstPageFooter"!==o||this.shiftChildLocation(n.clientArea.y-n.clientActiveArea.y,t),t},n.prototype.shiftChildLocation=function(n,t){var s=t.y+n,c=t.page.boundingRectangle.height-t.page.boundingRectangle.height/100*40,f,r,i,h,e,o;for(n=(s=Math.max(s,c))-t.y,f=t.y=s,r=0;r<t.childWidgets.length;r++)if(i=t.childWidgets[r],_instanceof(i,u))for(h=i.childWidgets[0],i.x=i.x,i.y=0===r?i.y+n:f,f+=i.height,e=0;e<h.children.length;e++)o=h.children[e],_instanceof(o,nt)&&(o.y=i.y+o.verticalPosition);else this.shiftChildLocationForTableWidget(i,n),f+=i.height},n.prototype.shiftChildLocationForTableWidget=function(n,t){var i,r;for(n.y=n.y+t,i=0;i<n.childWidgets.length;i++)r=n.childWidgets[i],_instanceof(r,a)&&this.shiftChildLocationForTableRowWidget(r,t)},n.prototype.shiftChildLocationForTableRowWidget=function(n,t){n.y=n.y+t;for(var i=0;i<n.childWidgets.length;i++)this.shiftChildLocationForTableCellWidget(n.childWidgets[i],t)},n.prototype.shiftChildLocationForTableCellWidget=function(n,t){n.y=n.y+t;for(var i=0;i<n.childWidgets.length;i++)_instanceof(n.childWidgets[i],u)?(n.childWidgets[i].x=n.childWidgets[i].x,n.childWidgets[i].y=n.childWidgets[i].y+t):this.shiftChildLocationForTableWidget(n.childWidgets[i],t)},n.prototype.layoutBlock=function(n,t){var i,r;return _instanceof(n,u)?(i=this.layoutParagraph(n,t),r=this.checkAndRelayoutPreviousOverlappingBlock(i.getSplitWidgets()[0]),r&&(i=r)):(n.calculateGrid(),n.isGridUpdated=!1,n.buildTableColumns(),n.isGridUpdated=!0,i=this.layoutTable(n,t),this.checkAndRelayoutPreviousOverlappingBlock(n),this.updateTableYPositionBasedonTextWrap(i)),i.nextRenderedWidget},n.prototype.updateTableYPositionBasedonTextWrap=function(n){var t=this,i,r;sf.base.isNullOrUndefined(n.bodyWidget)||(i=n.y,r=new b(n.x,n.y,n.width,n.height),n.bodyWidget.floatingElements.forEach(function(u){var f,e;_instanceof(u,nt)&&!u.paragraph.isInsideTable&&(f=new b(u.x,u.y,u.width,u.height),("TopAndBottom"===u.textWrappingStyle||"Square"===u.textWrappingStyle)&&r.isIntersecting(f)&&(n.y=u.y+u.height+u.distanceBottom,t.updateChildLocationForTable(n.y,n),e=n.y-i,t.viewer.cutFromTop(t.viewer.clientActiveArea.y+e)))}))},n.prototype.checkAndRelayoutPreviousOverlappingBlock=function(n){var t,f,i,o,s,e,r,h,c;if(!(_instanceof(n.containerWidget,et)||this.isRelayoutOverlap)){if(t=n.previousWidget,_instanceof(n,u)){if(n.floatingElements.length>0){for(f=0;f<n.floatingElements.length;f++)if(i=n.floatingElements[f],"InFrontOfText"!==i.textWrappingStyle&&"Behind"!==i.textWrappingStyle){for(o=new b(i.x,i.y,i.width,i.height);t;)_instanceof(t,u)&&(s=new b(t.x,t.y,t.width,t.height),o.isIntersecting(s)&&this.startOverlapWidget!==t&&(this.startOverlapWidget=t,this.endOverlapWidget=n)),t=t.previousWidget;t=n.previousWidget}}else if(e=n.getSplitWidgets(),e)return e[e.length-1]}else{if(r=n,!r.wrapTextAround)return r;for(h=new b(r.x,r.y,r.getTableCellWidth(),r.height);t;)_instanceof(t,u)&&(c=new b(t.x,t.y,t.width,t.height),h.isIntersecting(c)&&this.startOverlapWidget!==t&&(this.startOverlapWidget=t,this.endOverlapWidget=n)),t=t.previousWidget;t=n.previousWidget}this.startOverlapWidget&&(this.isRelayoutOverlap=!0,this.layoutStartEndBlocks(this.startOverlapWidget,n),this.isRelayoutOverlap=!1);this.startOverlapWidget=void 0;this.endOverlapWidget=void 0}return n},n.prototype.addParagraphWidget=function(n,t){if(!t.isEmpty()||sf.base.isNullOrUndefined(t.paragraphFormat)||"Center"!==t.paragraphFormat.textAlignment&&"Right"!==t.paragraphFormat.textAlignment||-1!==t.paragraphFormat.listFormat.listId)t.width=n.width,t.x=n.x,t.y=n.y;else{var i=this.documentHelper.textHelper.getParagraphMarkWidth(t.characterFormat),r=n.x;r+="Center"===t.paragraphFormat.textAlignment?(n.width-i)/2:n.width-i;t.width=i;t.x=r;t.y=n.y}return t},n.prototype.addLineWidget=function(n){var t=void 0;return(t=new k(n)).width=n.width,n.childWidgets.push(t),t.paragraph=n,t},n.prototype.isFirstElementWithPageBreak=function(n){var u=!1,r,t;if(_instanceof(this.viewer,rt)&&(r=n.childWidgets[0],r))for(t=r.children[0];t;){if(!(_instanceof(t,e)&&t.name.indexOf("_")>=0)){_instanceof(t,i)&&"\f"===t.text&&(u=!0);break}t=t.nextElement}return u},n.prototype.layoutfootNote=function(n){var r,u,t,i;if("Pages"===this.documentHelper.owner.layoutType){for(r=this.viewer.clientActiveArea,u=this.viewer.clientArea,"Footnote"===n.footNoteType&&this.viewer.updateFootnoteClientArea(n.sectionFormat,n),t=void 0,this.isRelayoutFootnote=!1,this.viewer.clientActiveArea.y=this.viewer.clientActiveArea.y-n.page.footerWidget.height+n.page.bodyWidgets[0].sectionFormat.footerDistance,i=0;i<n.childWidgets.length;i++)(t=n.childWidgets[i]).index=i,t.containerWidget=n,this.viewer.updateClientAreaForBlock(t,!0),this.layoutBlock(t,0),0===i&&(n.y=t.y),this.viewer.updateClientAreaForBlock(t,!1);this.viewer.clientActiveArea=r;this.viewer.clientArea=u;_instanceof(n.page.bodyWidgets[0].lastChild,f)&&n.page.bodyWidgets[0].lastChild.y+n.page.bodyWidgets[0].lastChild.height>n.y&&this.reLayoutTable(n.page.bodyWidgets[0].lastChild,!0)}return n},n.prototype.layoutParagraph=function(n,i){var u,r,f;if(this.addParagraphWidget(this.viewer.clientActiveArea,n),u=!0,this.isFirstElementWithPageBreak(n)||(this.layoutListItems(n),u=!1),n.isEmpty())this.layoutEmptyLineWidget(n,!0);else for(r=i<n.childWidgets.length?n.childWidgets[i]:void 0,this.isRelayoutOverlap||_instanceof(n.containerWidget,et)||this.layoutFloatElements(n);_instanceof(r,k);)(n!==r.paragraph&&0===r.indexInOwner&&u&&this.layoutListItems(r.paragraph),r.isFirstLine()&&sf.base.isNullOrUndefined(this.fieldBegin)&&!sf.base.isNullOrUndefined(n.paragraphFormat))&&(f=-t.convertPointToPixel(n.paragraphFormat.firstLineIndent),this.viewer.updateClientWidth(f)),r.marginTop=0,n=(r=this.layoutLine(r,0)).paragraph,r=r.nextLine;return this.updateWidgetToPage(this.viewer,n),n.isLayouted=!0,n},n.prototype.clearLineMeasures=function(){this.maxBaseline=0;this.maxTextBaseline=0;this.maxTextHeight=0},n.prototype.layoutFloatElements=function(n){var t=this;n.floatingElements.forEach(function(n){_instanceof(n,lt)&&(t.isRelayoutOverlap||t.layoutShape(n))})},n.prototype.layoutShape=function(n){var e,r,s,h,c,o,u,i;if("Inline"!==n.textWrappingStyle?(e=this.getFloatingItemPoints(n),n.x=e.x,n.y=e.y,r=n.paragraph.bodyWidget,-1===r.floatingElements.indexOf(n)&&(r.floatingElements.push(n),r.floatingElements.sort(function(n,t){return n.y-t.y})),-1===n.paragraph.floatingElements.indexOf(n)&&n.paragraph.floatingElements.push(n)):0===n.width&&0!==n.widthScale&&(s=t.convertPointToPixel(n.line.paragraph.getContainerWidth()),n.width=s/100*n.widthScale),h=this.viewer.clientArea,c=this.viewer.clientActiveArea,_instanceof(n,nt))for(o=n.textFrame.childWidgets,this.viewer.updateClientAreaForTextBoxShape(n,!0),u=0;u<o.length;u++)i=o[u],this.viewer.updateClientAreaForBlock(i,!0),_instanceof(i,f)&&this.clearTableWidget(i,!0,!0),this.layoutBlock(i,0),this.viewer.updateClientAreaForBlock(i,!1);this.viewer.clientActiveArea=c;this.viewer.clientArea=h},n.prototype.moveElementFromNextLine=function(n){for(var i,t=n.nextLine;_instanceof(t,k);){if(t.children.length>0){i=t.children.splice(0,1)[0];n.children.push(i);i.line=n;break}1===t.paragraph.childWidgets.length?t.paragraph.destroy():t.paragraph.childWidgets.splice(t.paragraph.childWidgets.indexOf(t),1);t=n.nextLine}},n.prototype.layoutLine=function(n,t){var u=n.paragraph,r,f,e;for(0===n.children.length&&this.moveElementFromNextLine(n),r=n.children[t],this.clearLineMeasures(),n.marginTop=0;_instanceof(r,tt);)(r.padding.left=0,this.layoutElement(r,u),n=r.line,_instanceof(r,i))&&(f=r,!sf.base.isNullOrUndefined(f.errorCollection)&&f.errorCollection.length>0&&(f.ischangeDetected=!0)),this.isRTLLayout?(r=void 0,this.isRTLLayout=!1):this.hasFloatingElement?(this.hasFloatingElement=!1,e=u.childWidgets.indexOf(r.line),e>0&&u.bodyWidget.floatingElements.length>0&&_instanceof(r,i)&&!_instanceof(u.containerWidget,s)&&(r=u.childWidgets[e].children[0])):r=r.nextElement;return n},n.prototype.layoutElement=function(n,t){var u=n.line,f="",b=n.indexInOwner,h,k,c,s,a,y,d,l,p;if(_instanceof(n,r))return 0===n.fieldType&&(-1===this.documentHelper.fields.indexOf(n)&&this.documentHelper.fields.push(n),sf.base.isNullOrUndefined(n.formFieldData)||-1!==this.documentHelper.formFields.indexOf(n)||this.documentHelper.formFields.push(n)),this.layoutFieldCharacters(n),void(n.line.isLastLine()&&sf.base.isNullOrUndefined(n.nextNode)&&!this.isFieldCode?(2!==n.fieldType&&sf.base.isNullOrUndefined(n.fieldSeparator)&&this.layoutEmptyLineWidget(t,!1,n.line),this.moveToNextLine(u)):sf.base.isNullOrUndefined(n.nextElement)&&this.viewer.clientActiveArea.width>0&&!n.line.isLastLine()?(this.moveElementFromNextLine(u),n.line.isLastLine()&&sf.base.isNullOrUndefined(n.nextNode)&&!this.isFieldCode&&(2!==n.fieldType&&sf.base.isNullOrUndefined(n.fieldSeparator)&&this.layoutEmptyLineWidget(t,!1,n.line),this.moveToNextLine(u))):sf.base.isNullOrUndefined(n.nextElement)&&0===this.viewer.clientActiveArea.width&&(this.moveToNextLine(u),u.paragraph.lastChild===u&&!sf.base.isNullOrUndefined(u.nextLine)&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(u)));if(_instanceof(n,o)||this.isFieldCode||_instanceof(n,e)||_instanceof(n,ot)||_instanceof(n,ht)||_instanceof(n,w)||_instanceof(n,lt)&&"Inline"!==n.textWrappingStyle){if(_instanceof(n,e)&&(0!==n.bookmarkType||this.documentHelper.bookmarks.containsKey(n.name)?1===n.bookmarkType&&this.documentHelper.bookmarks.containsKey(n.name)?(h=this.documentHelper.bookmarks.get(n.name),(sf.base.isNullOrUndefined(h.reference)||sf.base.isNullOrUndefined(h.reference.paragraph.bodyWidget))&&(h.reference=n,n.reference=h)):0===n.bookmarkType&&this.documentHelper.bookmarks.containsKey(n.name)&&sf.base.isNullOrUndefined(n.reference)&&this.documentHelper.bookmarks.remove(n.name):this.documentHelper.bookmarks.add(n.name,n)),_instanceof(n,w)&&-1===this.documentHelper.contentControlCollection.indexOf(n))if(0===n.type)this.documentHelper.contentControlCollection.push(n);else if(1===n.type)for(k=n.paragraph.bodyWidget.page,c=0;c<this.documentHelper.contentControlCollection.length;c++)s=this.documentHelper.contentControlCollection[c],a=s.line.paragraph.isInHeaderFooter,a&&n.contentControlProperties===s.contentControlProperties&&k===s.line.paragraph.bodyWidget.page?(n.reference=s,s.reference=n):a||n.contentControlProperties!==s.contentControlProperties||(n.reference=s,s.reference=n);return sf.base.isNullOrUndefined(n.nextElement)&&this.viewer.clientActiveArea.width>0&&!n.line.isLastLine()&&this.moveElementFromNextLine(u),void(n.line.isLastLine()&&sf.base.isNullOrUndefined(n.nextElement)&&(this.hasValidElement(u.paragraph)?this.moveToNextLine(u):this.layoutEmptyLineWidget(u.paragraph,!1,u,!1)))}if(y=n.width,_instanceof(n,ci)&&!this.isTocField(n.fieldBegin)?""!==(f=this.documentHelper.getFieldResult(n.fieldBegin,n.paragraph.bodyWidget.page))?n.text=f:f=n.text:_instanceof(n,yt)?""!==(f=this.startAt(n,f))&&(n.text=f):_instanceof(n,i)&&((this.checkAndSplitTabOrLineBreakCharacter(n.text,n),n.text.length>1&&n.line.paragraph.bidi)&&(d=this.splitTextByConsecutiveLtrAndRtl(n),this.updateSplittedText(n,d)),f=n.text),_instanceof(n,i)&&(y=this.documentHelper.textHelper.getTextSize(n,n.characterFormat),"\t"===n.text&&(n.width=this.getTabWidth(t,this.viewer,b,u,n))),sf.base.isNullOrUndefined(t.containerWidget)||!(t.bodyWidget.floatingElements.length>0)||_instanceof(n,nt)||_instanceof(t.containerWidget,et)||this.adjustPosition(n,n.line.paragraph.bodyWidget),_instanceof(this.viewer,rt)&&(_instanceof(n,nt)&&"Inline"===n.textWrappingStyle||!_instanceof(n,nt))&&this.viewer.clientActiveArea.height<n.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(!(_instanceof(n,i)&&"\f"!==n.text)&&_instanceof(n,i)||this.moveToNextPage(this.viewer,u),_instanceof(n,ci)&&this.updateFieldText(n),!n.previousElement||!(_instanceof(n.previousElement,nt)&&"Inline"===n.previousElement.textWrappingStyle)&&_instanceof(n.previousElement,nt)||this.cutClientWidth(n.previousElement)),_instanceof(n,nt)&&"Inline"===n.textWrappingStyle&&this.layoutShape(n),_instanceof(n,yt)&&(!n.isLayout||this.isLayoutWhole)&&"Pages"===this.documentHelper.owner.layoutType&&this.layoutFootEndNoteElement(n),_instanceof(n,v)&&(0!==n.top&&!sf.base.isNullOrUndefined(n.top)||0!==n.bottom&&!sf.base.isNullOrUndefined(n.bottom)||0!==n.left&&!sf.base.isNullOrUndefined(n.left)||0!==n.right&&!sf.base.isNullOrUndefined(n.right))&&this.cropPosition(n),parseFloat(y.toFixed(4))<=parseFloat(this.viewer.clientActiveArea.width.toFixed(4))||!this.viewer.textWrap)this.addElementToLine(t,n),sf.base.isNullOrUndefined(n.nextElement)&&this.viewer.clientActiveArea.width>0&&!n.line.isLastLine()?this.moveElementFromNextLine(u):!n.line.isLastLine()&&sf.base.isNullOrUndefined(n.nextElement)&&0===this.viewer.clientActiveArea.width&&(this.moveToNextLine(u),u.paragraph.lastChild===u&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(u));else if(_instanceof(n,i)){if("\t"===n.text)l=n.line,this.addSplittedLineWidget(l,l.children.indexOf(n)-1),this.moveToNextLine(l),n.width=this.getTabWidth(t,this.viewer,b,n.line,n),this.addElementToLine(t,n);else do u=n.line,this.splitTextForClientArea(u,n,n.text,n.width,n.characterFormat),this.checkLineWidgetWithClientArea(u,n),_instanceof(n,ci)&&this.updateFieldText(n);while(n.line!==u&&this.cutClientWidth(n))}else do u=n.line,this.splitElementForClientArea(t,n),this.checkLineWidgetWithClientArea(u,n),_instanceof(n,ci)&&this.updateFieldText(n);while(n.line!==u&&this.cutClientWidth(n));if(("\v"===f||"\f"===f)&&(p=u.children.indexOf(n),p>-1&&this.addSplittedLineWidget(u,p)),n.line.isLastLine()&&sf.base.isNullOrUndefined(n.nextElement)||"\v"===f||"\f"===f){if(this.isXPositionUpdated)return void(this.isXPositionUpdated=!1);this.moveToNextLine(n.line);"\v"===f&&sf.base.isNullOrUndefined(n.nextNode)?this.layoutEmptyLineWidget(t,!0,u,!0):"\f"===f&&_instanceof(this.viewer,rt)&&(sf.base.isNullOrUndefined(n.nextNode)?this.moveToNextPage(this.viewer,n.line,!0):sf.base.isNullOrUndefined(n.line.nextLine)||this.moveToNextPage(this.viewer,n.line.nextLine,!1))}this.isXPositionUpdated=!1},n.prototype.adjustPosition=function(n){var t=this.viewer.clientActiveArea,f=this.viewer.clientActiveArea.x,i=this.viewer.clientActiveArea.y,e=this.viewer.clientActiveArea.width,o=this.adjustClientAreaBasedOnTextWrap(n,new b(t.x,t.y,t.width,t.height)),r,u;this.viewer.clientActiveArea.width=o.width;r=this.viewer.clientActiveArea.x-f;(n.padding.left=r,e!==this.viewer.clientActiveArea.width)&&(u=new nf(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.width),this.updateWrapPosition(u));0===this.viewer.clientActiveArea.width&&(this.isWrapText=!1);this.isYPositionUpdated&&(n.line.isFirstLine()?n.line.paragraph.y+=this.viewer.clientActiveArea.y-i:n.line.marginTop+=this.viewer.clientActiveArea.y-i,this.isYPositionUpdated=!1)},n.prototype.updateWrapPosition=function(n){for(var i,t=0;t<this.wrapPosition.length;t++)if(i=this.wrapPosition[t],!(Math.abs(i.right-n.right)>1))return;this.wrapPosition.push(n)},n.prototype.isFirstitemInPage=function(n,t){return!n.line.paragraph.isInHeaderFooter&&Math.round(t)===this.viewer.clientArea.y},n.prototype.isTextFitBelow=function(){return!1},n.prototype.isNeedToWrapForSquareTightAndThrough=function(n,t,i,r,u,f,e,o,s,h,c,l,a){return n.floatingElements.length>0&&i!==o&&r!==o&&"Inline"!==u&&"Behind"!==u&&"TopAndBottom"!==u&&"InFrontOfText"!==u&&(Math.round(c.y+a)>Math.round(f.y)||this.isTextFitBelow(f,c.y+a,s))&&Math.round(c.y)<Math.round(f.y+f.height)&&!(e&&(h||_instanceof(t,v)&&"Inline"!==t.textWrappingStyle&&t.allowOverlap))},n.prototype.isNeedToWrapForSquareTightAndThroughForTable=function(n,t,i,r,u,f,e,o,s,h,c,l,a){return n.floatingElements.length>0&&i!==o&&r!==o&&"Inline"!==u&&"Behind"!==u&&"TopAndBottom"!==u&&"InFrontOfText"!==u&&Math.round(c.y+a)>=Math.round(f.y)&&Math.round(c.y)<Math.round(f.y+f.height)&&!(e&&h)},n.prototype.isNeedToWrapLeafWidget=function(n,t){return n.bodyWidget.floatingElements.length>0&&(!n.isInHeaderFooter||n.associatedCell)&&!_instanceof(t,v)},n.prototype.getMinWidth=function(n,t,i,r){var f=n.text,e=f.split(" "),o,u,s;return""!==f&&""===f.trim()&&n&&n.line.paragraph&&n.previousNode&&n.nextNode&&n.line.paragraph.isEmpty&&(e=[""]),o=this.documentHelper.textHelper.measureText(e[0],n.characterFormat).Width,u=this.getNextSibling(n),1===e.length&&u&&(s=u.text,o+=this.getNextTextRangeWidth(u,s,t,i,r)),o},n.prototype.getNextTextRangeWidth=function(n,t,i,r,u){for(var f=n,e=new b(0,0,0,0),o=this.isNextSibligSizeNeedToBeMeasure(e,n,u,i,r);o&&this.isLeafWidgetNextSiblingIsTextRange(f)&&i+e.width<u.width&&(f=this.getNextSibling(f),this.isNextSibligSizeNeedToBeMeasure(e,f,u,i,r));)f.text;return e.width},n.prototype.isLeafWidgetNextSiblingIsTextRange=function(n){var t=this.getNextSibling(n);return!!(t&&_instanceof(t,i))},n.prototype.isNextSibligSizeNeedToBeMeasure=function(n,t,i,r){var u=null,f=t,e,o;if(f){if(-1!==(u=f.text).indexOf(" ")||-1!==u.indexOf("-")||-1!==u.indexOf("_")&&r+n.width+this.documentHelper.textHelper.measureText(u.split("-")[0],f.characterFormat).Width<i.width||"\t"===f.text)return e=f.width,u!==u.split(" ")[0]&&(e=this.documentHelper.textHelper.measureText(u.split(" ")[0],f.characterFormat).Width),r+n.width+e>i.width&&u.indexOf("-")&&u!==u.split("-")[0]+"-"&&(e=this.documentHelper.textHelper.measureText(u.split("-")[0]+"-",f.characterFormat).Width),n.width+=e,!1;f.text.length>0&&(o=this.documentHelper.textHelper.measureText(f.text,f.characterFormat),n.height+=o.Height,n.width+=o.Width)}return!0},n.prototype.isNeedDoIntermediateWrapping=function(n,t,r,u,f,e,o,s,h){return n>h&&((Math.round(r.width)<=Math.round(s)||r.width<u&&o.paragraph.isInsideTable)&&"Left"!==t&&"Largest"!==t||"Right"===t||r.width<n&&"Largest"===t)||(Math.round(e.x-f.x+f.leftIndent)<h||_instanceof(o,i)&&this.isFloatingItemOnLeft(r,s,e))&&("Left"!==t||n<h)},n.prototype.isFloatingItemOnLeft=function(){return!1},n.prototype.getNextSibling=function(n){n.line.paragraph;for(var t=n.nextNode,u=!1;t;){if(_instanceof(t,r)||_instanceof(t,e)||u||_instanceof(t,o))_instanceof(t,r)&&(0===t.fieldType?u=!0:2===t.fieldType&&(u=!1));else if(_instanceof(t,i))break;t=t.nextNode}return t},n.prototype.adjustClientAreaBasedOnTextWrap=function(n,i){var o=n.line.paragraph,a=o.bodyWidget,ct=this.viewer,yt=i.y,v,g,r,it,k,ht,s,e,tt,l,d;if(this.isFirstitemInPage(n,yt),sf.base.isNullOrUndefined(o.previousWidget),this.isNeedToWrapLeafWidget(o,n))for(v=ct.clientArea,a.floatingElements.sort(function(n,t){return n.y-t.y}),a.floatingElements.sort(function(n,t){return n.x-t.x}),g=0;g<a.floatingElements.length;g++)if(r=a.floatingElements[g],it=!1,it=_instanceof(r,lt)?r.allowOverlap:r.positioning.allowOverlap,(!(o.isInsideTable&&_instanceof(r,f))||r.isInsideTable)&&!(this.isRelayout&&!this.isRelayoutOverlap&&this.viewer.documentHelper.selection.isExistAfter(_instanceof(r,f)?r:r.line.paragraph,n.line.paragraph)||this.isRelayout&&this.isRelayoutOverlap&&this.viewer.documentHelper.selection.isExistAfter(_instanceof(r,f)?r:r.line.paragraph,this.endOverlapWidget))){r.x;var rt=0,ut=0,at=0,vt=0,ft=0;_instanceof(r,lt)?(rt=r.distanceLeft,ut=r.distanceTop,at=r.distanceRight,vt=r.distanceBottom,ft=r.width):ft=r.getTableCellWidth();var u=new b(r.x-rt,r.y-ut,ft+rt+at,r.height+ut+vt),y=_instanceof(r,f)?"Square":r.textWrappingStyle,h=_instanceof(r,f)?"Both":r.textWrappingType;if(ct.clientArea.y,r.height,!(v.x>u.right+18||v.right<u.x-18)&&this.isNeedToWrapForSquareTightAndThrough(a,n,-1,-1,y,u,it,1,r,!1,i,n.width,n.height)){var et=0,ot=0,p=0,c=t.convertPointToPixel(n.paragraph.paragraphFormat.firstLineIndent),nt=t.convertPointToPixel(o.paragraphFormat.leftIndent);c=0===n.indexInOwner&&n.line.isFirstLine()&&c>0?c:0;var st=n,pt=_instanceof(r,f)?r.containerWidget:r.line.paragraph.containerWidget,w=!1;n.line.paragraph&&(i.x>=u.x&&"Left"!==h&&(et=o.paragraphFormat.rightIndent),i.x<u.x&&"Right"!==h&&(ot=nt),k=o.paragraphFormat.listFormat,ht=this.getListLevel(k.list,k.listLevelNumber),i.x===v.x+nt&&k&&k.baseStyle&&ht&&0!==ht.paragraphFormat.leftIndent&&(p=nt,w=!0));i.x>=u.x&&i.x<u.right&&"Left"!==h?(i.width=i.width-(u.right-i.x)-et,this.isWrapText=!0,Math.round(i.width)<18||i.width<n.width&&"\t"===n.text||u.x<o.x+nt?(i.width=this.viewer.clientArea.right-u.right-(w?p:0),s=0,(s=st?this.getMinWidth(n,n.width,n.height,i):n.width,Math.round(i.width)<18||i.width<s)?(u.x-(o.x+o.leftIndent)>18&&this.viewer.clientArea.right-u.right>18?i.width=0:(e=0,this.isYPositionUpdated=!0,i.width=this.viewer.clientArea.width,i.height-=u.bottom+e-i.y,i.y=u.bottom+e),this.viewer.updateClientAreaForTextWrap(i),this.isWrapText=!1):(tt=i.x,(i.x=u.right+(w?p:0)+c,i.width-=c,"Square"===y&&i.width<0&&n.width>0)&&(e=0,this.isYPositionUpdated=!0,i.width=this.viewer.clientArea.width,i.height-=u.bottom+e-i.y,i.y=u.bottom+e,i.x=tt),this.viewer.updateClientAreaForTextWrap(i))):(tt=i.x,(i.x=u.right+(w?p:0)+c,i.width=this.viewer.clientArea.right-u.right-(w?p:0)-c,"Square"===y&&i.width<0&&n.width>0)&&(e=0,this.isYPositionUpdated=!0,i.width=this.viewer.clientArea.width,i.height-=u.bottom+e-i.y,i.y=u.bottom+e,i.x=tt),this.isWrapText=!0,this.viewer.updateClientAreaForTextWrap(i))):u.x>=i.x&&i.right>u.x&&(i.width=u.x-i.x-et,l=this.viewer.clientArea.right-u.right,l=l>0?l:0,this.isWrapText=!0,s=0,(s=st?this.getMinWidth(st,n.width,n.height,i):n.width,this.isNeedDoIntermediateWrapping(l,h,i,n.width,n.paragraph,u,n,s,18))?(i.width=l,this.isWrapText=!0,(i.x+s>u.x||"Right"===h)&&(i.x=u.right,(i.width>s||"Right"===h)&&this.viewer.updateClientAreaForTextWrap(i)),i.width<18&&!(s<l&&"Tight"===y)||i.width<s&&Math.round(i.right)===Math.round(this.viewer.clientArea.right)&&"Both"===h)&&(d=u,Math.round(i.x)===Math.round(a.sectionFormat.leftMargin+o.paragraphFormat.leftIndent)?(e=0,i.y=d.bottom+e,this.isYPositionUpdated=!0,i.width=this.viewer.clientArea.width,i.height=i.height-(d.height+e),this.viewer.updateClientAreaForTextWrap(i),this.isWrapText=!1):Math.round(i.right)>=Math.round(this.viewer.clientArea.right)&&"Both"===h?(e=0,i.y=d.bottom+e,i.width=this.viewer.clientArea.width,i.height=i.height-(d.height+e),i.x=this.viewer.clientArea.x+ot,this.viewer.updateClientAreaForTextWrap(i),this.isYPositionUpdated=!0,this.isWrapText=!1):(i.width=0,this.viewer.updateClientAreaForTextWrap(i))):(n.line.isFirstLine()&&0===n.indexInOwner&&"Square"===y&&Math.round(i.width)<=Math.round(s)&&o.containerWidget===pt?(i.x=v.x,i.y=u.bottom,i.width=v.width,i.height-=u.bottom-i.y,this.isYPositionUpdated=!0):Math.round(i.width)<=Math.round(s)&&Math.round(i.x-ot)!==Math.round(this.viewer.clientArea.x)&&(i.width=0),this.viewer.updateClientAreaForTextWrap(i)));"Both"!==h&&(this.isWrapText=!1)}}return i},n.prototype.adjustClientAreaBasedOnTextWrapForTable=function(n,t){var u,y,l,h,i,a,k,e,c;if(sf.base.isNullOrUndefined(n.containerWidget)||sf.base.isNullOrUndefined(n.bodyWidget))return t;if(u=n.bodyWidget,y=this.viewer,t.y,sf.base.isNullOrUndefined(n.previousWidget),u.floatingElements.length>0)for(l=y.clientActiveArea,u.floatingElements.sort(function(n,t){return n.y-t.y}),u.floatingElements.sort(function(n,t){return n.x-t.x}),h=0;h<u.floatingElements.length;h++)if(i=u.floatingElements[h],a=!1,a=_instanceof(i,lt)?i.allowOverlap:i.positioning.allowOverlap,!(n.isInsideTable&&_instanceof(i,f))||i.isInsideTable){var o=n.getTableCellWidth(),s=_instanceof(i,lt),p=s?i.distanceLeft:i.positioning.distanceLeft,w=s?i.distanceTop:i.positioning.distanceTop,d=s?i.distanceRight:i.positioning.distanceRight,g=s?i.distanceBottom:i.positioning.distanceBottom,nt=s?i.width:i.getTableCellWidth(),r=new b(i.x-p,i.y-w,nt+p+d,i.height+w+g),v=_instanceof(i,f)?"Square":i.textWrappingStyle,tt=_instanceof(i,f)?"Both":i.textWrappingType;!(l.x>r.right+18||l.right<r.x-18)&&this.isNeedToWrapForSquareTightAndThroughForTable(u,n,-1,-1,v,r,a,1,i,!1,t,o,n.height)&&t.x>=r.x&&t.x<r.right&&"Left"!==tt&&(t.width=t.width-(r.right-t.x),this.isWrapText=!0,Math.round(t.width)<18||t.width<o||r.x<n.x?(t.width=this.viewer.clientArea.right-r.right,k=o,Math.round(t.width)<18||t.width<k?(r.x-n.x>18&&this.viewer.clientArea.right-r.right>18?t.width=0:(e=0,this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=r.bottom+e-t.y,t.y=r.bottom+e),this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1):(c=t.x,(t.x=r.right,"Square"===v&&t.width<0&&o>0)&&(this.isYPositionUpdated=!0,t.height-=r.bottom+0-t.y,t.width=this.viewer.clientArea.width,t.y=r.bottom+0,t.x=c),this.viewer.updateClientAreaForTextWrap(t))):(c=t.x,(t.x=r.right+n.firstChild.firstChild.leftMargin,t.width=this.viewer.clientArea.right-r.right,"Square"===v&&t.width<0&&o>0)&&(e=0,this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=r.bottom+e-t.y,t.y=r.bottom+e,t.x=c),this.viewer.updateClientAreaForTextWrap(t)))}return t},n.prototype.startAt=function(n,t){return"Footnote"===n.footnoteType?(this.startat=n.paragraph.bodyWidget.sectionFormat.initialFootNoteNumber,t=this.getFootEndNote(n.paragraph.bodyWidget.sectionFormat.footNoteNumberFormat,this.documentHelper.footnoteCollection.indexOf(n)+this.startat)):(this.startat=n.paragraph.bodyWidget.sectionFormat.initialEndNoteNumber,t=this.getFootEndNote(n.paragraph.bodyWidget.sectionFormat.endnoteNumberFormat,this.documentHelper.endnoteCollection.indexOf(n)+this.startat)),t},n.prototype.layoutFootEndNoteElement=function(n){var r,c,a,s,h,v,e,d,l,i;this.isFootnoteContentChanged=!0;this.documentHelper.footnoteCollection.length;a=this.documentHelper.footnoteCollection.indexOf(n);s=1;this.islayoutFootnote=!0;var g=new b(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),y=new b(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.width,this.viewer.clientActiveArea.height),t=n.paragraph.bodyWidget,w=!1,o=0;if(t.page.footnoteWidget)for(h=0;h<t.page.footnoteWidget.childWidgets.length;h++)if(s=t.page.footnoteWidget.childWidgets.length,v=this.documentHelper.footnoteCollection.indexOf(t.page.footnoteWidget.childWidgets[h].footNoteReference),v>a&&v-a==1){s=h;break}if(n.isLayout=!0,"Footnote"===n.footnoteType){for(t.page.footnoteWidget&&_instanceof(t.page.footnoteWidget,it)?r=t.page.footnoteWidget:(w=!0,(r=new it).footNoteType="Footnote",r.page=t.page,e=new u,e.characterFormat=new p,e.paragraphFormat=new ut,e.index=0,d=new k(e),e.childWidgets.push(d),r.childWidgets.push(e),o=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat).Height),this.isFootNoteLayoutStart=!0,l=0;l<n.blocks.length;l++)i=n.blocks[l],i.containerWidget=this.isLayoutWhole?void 0:r,this.viewer.updateClientAreaForBlock(i,!0),_instanceof(i,f)&&this.clearTableWidget(i,!0,!0),this.layoutBlock(i,0),o+=i.height,i.y=0,this.viewer.updateClientAreaForBlock(i,!1);this.isFootNoteLayoutStart=!1;c=!1;o<=y.height&&(n.blocks.forEach(function(n){r.childWidgets.splice(s,0,n);s++}),w&&(t.page.footnoteWidget=r),r.height+=o,c=!0);this.viewer.clientActiveArea=y;c&&(this.viewer.clientActiveArea.height-=o,this.footnoteHeight+=o);this.viewer.clientArea=g}return c},n.prototype.layoutEndNoteElement=function(){var c=this.documentHelper.pages.length,t,s,r,h;if(this.documentHelper.endnoteCollection.length>0){for(var f=void 0,n=void 0,o=void 0,i=this.documentHelper.pages[c-1].bodyWidgets[0],e=0;e<this.documentHelper.endnoteCollection.length;e++){for((f=this.documentHelper.endnoteCollection[e],_instanceof(i.page.endnoteWidget,it)&&"Endnote"===i.page.endnoteWidget.footNoteType)?n=i.page.endnoteWidget:(o=!0,(n=new it).footNoteType="Endnote",n.page=i.page,t=new u,t.characterFormat=new p,t.paragraphFormat=new ut,t.index=0,s=new k(t),t.childWidgets.push(s),n.childWidgets.push(t)),r=0;r<f.blocks.length;r++)h=f.blocks[r],n.childWidgets.push(h);o&&(i.page.endnoteWidget=n);n.height+=0}this.layoutfootNote(n)}},n.prototype.hasValidElement=function(n){var u=n.firstChild,t;if(u&&!sf.base.isNullOrUndefined(this.documentHelper.selection))for(t=u.children[0];t;){if(_instanceof(t,r)&&(t=this.documentHelper.selection.getNextValidElementForField(t),!sf.base.isNullOrUndefined(t)&&!t.line.paragraph.equals(n)))return!1;if(_instanceof(t,i)||_instanceof(t,v))return!0;sf.base.isNullOrUndefined(t)||(t=t.nextNode)}return!1},n.prototype.updateFieldText=function(n){var t=this.documentHelper.getFieldResult(n.fieldBegin,n.paragraph.bodyWidget.page);""!==t&&(n.text=t,this.documentHelper.textHelper.getTextSize(n,n.characterFormat))},n.prototype.checkLineWidgetWithClientArea=function(n,i){if(n!==i.line||i.line===n&&sf.base.isNullOrUndefined(i.nextElement)&&!i.line.isLastLine()){if(this.moveToNextLine(n),"Word2013"!==this.documentHelper.compatibilityMode&&this.isOverlapFloatTable){var r=void 0;_instanceof(i.line.paragraph.previousRenderedWidget,f)&&i.line.paragraph.previousRenderedWidget.wrapTextAround&&(r=i.line.paragraph.previousRenderedWidget,this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-t.convertPointToPixel(r.firstChild.firstChild.leftMargin));this.viewer.clientActiveArea.x+=n.paragraph.leftIndent;this.isOverlapFloatTable=!1}n!==i.line&&(this.isRTLLayout=!1)}i.line!==n&&_instanceof(this.viewer,rt)&&this.viewer.clientActiveArea.height<i.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y?this.moveToNextPage(this.viewer,i.line):i.line===n&&sf.base.isNullOrUndefined(i.nextElement)&&n.paragraph.lastChild===n&&!n.isLastLine()&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(n)},n.prototype.checkAndSplitTabOrLineBreakCharacter=function(n,i){var u=t.indexOfAny(n,["\t","\v","\f"]),r;u>-1&&(r=n[u],("\t"===r&&"\t"!==n||"\v"===r&&"\v"!==n||"\f"===r&&"\f"!==n)&&this.splitByLineBreakOrTab(this.viewer,i,u,r))},n.prototype.splitTextByConsecutiveLtrAndRtl=function(n){for(var s,v,r,y,f=n.text,i=[],p=!1,u=[],o=-1,e="",l="",h="",a="",c=n.characterFormat.bidi,t=0;t<f.length;t++)s=0,v=!1,c&&/^[0-9]+$/.test(f[t])?(a+=f[t],s=4):this.documentHelper.textHelper.containsSpecialCharAlone(f.charAt(t))?(s=2,(v=c||" "===f.charAt(t)&&""===h)&&(h+=f[t])):this.documentHelper.textHelper.isRTLText(f.charAt(t))?(p=!0,l+=f[t],s=1):e+=f[t],""!==a&&4!==s&&(i.push(a),u.push("Number"),a=""),""!==l&&1!==s&&(i.push(l),u.push("RTL"),l=""),""!==e&&0!==s&&(i.push(e),o=i.length-1,u.push("LTR"),e=""),""===h||2===s&&!v||(i.push(h),u.push("WordSplit"),h="");if(""!==a?(i.push(a),u.push("Number")):""!==l?(i.push(l),u.push("RTL")):""!==e?(i.push(e),o=i.length-1,u.push("LTR")):""!==h&&(i.push(h),u.push("WordSplit")),p)for(t=1;t<i.length;t++)"WordSplit"===u[t+0]&&1===i[t].length&&t+0+1<u.length&&"WordSplit"!==u[t+0-1]&&("Number"!==u[t+0-1]||this.isNumberNonReversingCharacter(i[t],c))&&u[t+0-1]===u[t+0+1]&&(i[t-1]=i[t-1]+i[t]+i[t+1],i.splice(t,1),i.splice(t,1),u.splice(t+0,1),u.splice(t+0,1),t--);else if(-1!==o)if(c){for(t=1;t<o;t++)if("WordSplit"===u[t+0]&&t<o&&"LTR"===u[t+0-1]){for(e="",r=t+1;r<=o;r++)e+=i[r],i.splice(r,1),u.splice(r+0),r--,o--;i[t-1]=i[t-1]+i[t]+e;i.splice(t,1);u.splice(t+0);t--;o--}}else(i=[]).push(f);else c||(i=[]).push(f);if(c)for(r=1;r<i.length;r++)y=u[r+0],"WordSplit"===y&&1===i[r].length&&r+0+1<u.length&&"WordSplit"!==u[r+0-1]&&("Number"!==u[r+0-1]||this.isNumberNonReversingCharacter(i[r],c))&&u[r+0-1]===u[r+0+1]?(i[r-1]=i[r-1]+i[r]+i[r+1],i.splice(r,1),i.splice(r,1),u.splice(r+0,1),u.splice(r+0),r--):"LTR"!==y||"Number"!==u[r+0-1]&&"LTR"!==u[r+0-1]||(i[r-1]=i[r-1]+i[r],u[r+0-1]="LTR",i.splice(r,1),u.splice(r+0,1),r--);return i},n.prototype.isNumberNonReversingCharacter=function(n,t){return!(-1===",.:".indexOf(n[0])||"."===n[0]&&t)},n.prototype.updateSplittedText=function(n,t){var f="",e=n.line.children.indexOf(n),u,r;if(t.length>1)for(u=0;u<t.length;u++)(f=t[u],u>0)?(r=new i,r.line=n.line,r.characterFormat.copyFormat(n.characterFormat),n.line.children.splice(e+u,0,r),n.revisions.length>0&&(this.updateRevisionForSpittedElement(n,r,!0),r.isMarkedForRevision=n.isMarkedForRevision),r.text=f):n.text=f},n.prototype.moveFromNextPage=function(n){var t=n.nextLine,i;t&&-1===n.paragraph.childWidgets.indexOf(t)&&(i=t.paragraph,t.paragraph.childWidgets.splice(t.indexInOwner,1),n.paragraph.childWidgets.push(t),t.paragraph=n.paragraph,0===i.childWidgets.length&&i.destroy())},n.prototype.cutClientWidth=function(n){var t,r,u,f,e,o;for(this.clearLineMeasures(),t=n.line,t.marginTop=0,r=0,u=0;u<t.children.length;u++)if(f=t.children[u],r+=f.width,n===f)break;return e=this.viewer.clientActiveArea.width-r<0,o=n.line.paragraph.bodyWidget,o&&o.floatingElements.length>0?(this.hasFloatingElement=!0,this.isXPositionUpdated=!0,!1):(e?n.previousElement&&this.cutClientWidth(n.previousElement):(this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+r),"Justify"===n.line.paragraph.paragraphFormat.textAlignment&&_instanceof(n,i)&&this.splitTextElementWordByWord(n),sf.base.isNullOrUndefined(n.nextElement)&&this.viewer.clientActiveArea.width>0&&!n.line.isLastLine()&&this.moveElementFromNextLine(t)),e)},n.prototype.layoutFieldCharacters=function(n){if(0===n.fieldType)!sf.base.isNullOrUndefined(n.formFieldData)&&this.isInitialLoad&&this.checkAndUpdateFieldData(n),this.isFieldCode||sf.base.isNullOrUndefined(n.fieldEnd)&&!n.hasFieldEnd||(this.documentHelper.fieldStacks.push(n),this.isFieldCode=!0,n.hasFieldEnd=!0);else if(this.documentHelper.fieldStacks.length>0){var t;2===n.fieldType?(t=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]).fieldSeparator!==n||sf.base.isNullOrUndefined(t.fieldEnd)&&!t.hasFieldEnd||(this.isFieldCode=!1):n===(t=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]).fieldEnd&&(this.documentHelper.fieldStacks.pop(),this.isFieldCode=!1)}},n.prototype.checkAndUpdateFieldData=function(n){var u,s,t,f,o,e;n.hasFieldEnd&&!sf.base.isNullOrUndefined(n.fieldEnd)&&(sf.base.isNullOrUndefined(n.fieldSeparator)&&(u=new r(2),u.fieldBegin=n,u.fieldEnd=n.fieldEnd,u.line=n.line,n.line.children.splice(n.fieldEnd.indexInOwner,0,u),n.fieldSeparator=u,n.fieldEnd.fieldSeparator=u),s=n.fieldEnd.previousNode,_instanceof(s,r)&&2===s.fieldType&&(t=n.formFieldData,_instanceof(t,bt)?(f=new i,f.line=n.line,o=n.line.children.indexOf(n.fieldEnd),n.line.children.splice(o,0,f),f.characterFormat.copyFormat(n.characterFormat),f.text=t.checked?String.fromCharCode(9745):String.fromCharCode(9744),f.characterFormat.fontSize="Auto"!==t.sizeType?1.2*t.size:1.2*f.characterFormat.fontSize):_instanceof(t,kt)&&(e=new i,e.characterFormat.copyFormat(n.characterFormat),e.line=n.line,e.text=t.dropdownItems.length>0?t.dropdownItems[t.selectedIndex]:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),o=n.line.children.indexOf(n.fieldEnd),n.line.children.splice(o,0,e))))},n.prototype.layoutEmptyLineWidget=function(n,r,u,e){var p=n.paragraphFormat,g=0,it=0,s,c,b,nt,h,v,w,y,d;if(e=!sf.base.isNullOrUndefined(e)&&e,c=this.documentHelper.textHelper.getParagraphMarkSize(n.characterFormat).Height,b=this.getBeforeSpacing(n),n.childWidgets.length>0&&!e){if((s=n.childWidgets[0]).children.length>0){!this.isBidiReLayout&&(p.bidi||this.isContainsRtl(s))&&(this.reArrangeElementsForRtl(s,p.bidi),this.isRTLLayout=!0);var st=s.isFirstLine(),ut=s.isLastLine(),ft=0;(st&&(b=this.getBeforeSpacing(n),ft=t.convertPointToPixel(p.firstLineIndent)),"Left"!==(y=p.textAlignment)&&this.viewer.textWrap&&("Justify"!==y||!ut||"Justify"===y&&p.bidi))&&(nt=this.getSubWidth(s,"Justify"===y,it,ft,ut),g=nt[0].subWidth,it=nt[0].spaceCount)}}else s=r?this.addLineWidget(n):u;!sf.base.isNullOrUndefined(n.containerWidget)&&n.bodyWidget.floatingElements.length>0&&!_instanceof(n.containerWidget,et)&&(h=new i,h.line=s,s.children.push(h),h.text="",h.characterFormat=n.characterFormat,h.width=this.documentHelper.textHelper.getTextSize(h,h.characterFormat),this.adjustPosition(h,n.bodyWidget),n.x+=h.padding.left,s.children.splice(h.indexInOwner,1));_instanceof(this.viewer,rt)&&this.viewer.clientActiveArea.height<b+c&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&this.moveToNextPage(this.viewer,s);v=this.getLineSpacing(n,c);!isNaN(this.maxTextHeight)&&c<this.maxTextHeight&&(c=this.maxTextHeight);var l=0,a=0,tt=0,k=c,ot=n.paragraphFormat.lineSpacingType;for("Multiple"===ot?v>c?a+=v-c:l+=v-c:("Exactly"===ot||v>l+k+a)&&(l+=v-(l+k+a)),l+=b,a+=t.convertPointToPixel(this.getAfterSpacing(n)),w=0;w<s.children.length;w++)d=s.children[w],0===w&&_instanceof(d,o)&&("Right"===(y=n.paragraphFormat.textAlignment)?tt=g:"Center"===y&&(tt=g/2),d.margin=new hi(tt,l,0,a),d.line=s,s.height=l+k+a);s.height=l+k+a;!(sf.base.isNullOrUndefined(n.nextRenderedWidget)&&n.isInsideTable&&_instanceof(n.previousRenderedWidget,f)&&n.isEmpty())||n.childWidgets[0].children.length>0&&_instanceof(n.childWidgets[0].children[0],o)&&0!==n.childWidgets[0].children.length||(s.height=0);this.viewer.cutFromTop(this.viewer.clientActiveArea.y+s.height)},n.prototype.layoutListItems=function(n){this.isFieldCode||(!sf.base.isNullOrUndefined(n.paragraphFormat)&&!sf.base.isNullOrUndefined(n.paragraphFormat.listFormat)&&!sf.base.isNullOrUndefined(this.documentHelper.getListById(n.paragraphFormat.listFormat.listId))&&n.paragraphFormat.listFormat.listLevelNumber>=0&&n.paragraphFormat.listFormat.listLevelNumber<9?(this.clearListElementBox(n),this.layoutList(n,this.documentHelper)):n.paragraphFormat.listFormat&&-1===n.paragraphFormat.listFormat.listId&&this.clearListElementBox(n))},n.prototype.layoutList=function(n,i){var l=i.getListById(n.paragraphFormat.listFormat.listId),f,u,s,r,e,h,c;if(this.viewer.updateClientWidth(-t.convertPointToPixel(n.paragraphFormat.firstLineIndent)),f=this.getListLevel(l,n.paragraphFormat.listFormat.listLevelNumber),u=n.childWidgets[0],sf.base.isNullOrUndefined(u)&&(u=new k(n),n.childWidgets.push(u)),r=new o(f,!1),(r.line=u,r.text="Bullet"===f.listLevelPattern?f.numberFormat:this.getListNumber(n.paragraphFormat.listFormat),this.documentHelper.isIosDevice)&&(e=r.text,(e=""===e?"":" "===e?"":e)!==r.text&&(r.text=e)),(i.textHelper.updateTextSize(r,n),_instanceof(this.viewer,rt)&&this.viewer.clientActiveArea.height<r.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(s=!0),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+r.width),u.children.splice(0,0,r),"None"!==f.followCharacter)&&((r=new o(f,!0),"Tab"===f.followCharacter)?(r.text="\t",h=u.children.indexOf(r),c=this.getTabWidth(n,this.viewer,h,u,r),i.textHelper.updateTextSize(r,n),r.width=c):(r.text=" ",i.textHelper.updateTextSize(r,n)),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+r.width),u.children.splice(1,0,r),r.line=u),s)return this.moveToNextPage(this.viewer,u),this.cutClientWidth(r),this.hasFloatingElement=!1,void(this.isXPositionUpdated=!1);"None"!==f.followCharacter&&this.viewer.updateClientWidth(t.convertPointToPixel(n.paragraphFormat.firstLineIndent))},n.prototype.addBodyWidget=function(n,t){var i;return(i=t||new c).width=n.width,i.x=n.x,i.y=n.y,i},n.prototype.addListLevels=function(n){for(var t,r,i=n.levels.length;i<9;i++)t=new li(n),r=i%3,"Bullet"===n.levels[0].listLevelPattern?(t.listLevelPattern="Bullet",t.numberFormat=0===r?"":1===r?" ":"",t.characterFormat.fontFamily=""===t.numberFormat?"Wingdings":"Symbol"):(t.listLevelPattern=this.getListLevelPattern(r),t.numberFormat="%"+(i+1).toString()+".",t.startAt=1,t.restartLevel=i),t.paragraphFormat=new ut(void 0),t.paragraphFormat.leftIndent=48*(i+1),t.paragraphFormat.firstLineIndent=-24,n.levels.push(t)},n.prototype.addSplittedLineWidget=function(n,t,i){var r,e,o;if(this.isWrapText)sf.base.isNullOrUndefined(i)||(n.children.splice(t+1,0,i),i.line=n);else{var u=n.paragraph,f=[],s=u.childWidgets.indexOf(n);for(sf.base.isNullOrUndefined(i)||f.push(i),r=void 0,e=t+1;e<n.children.length;e++)f.push(n.children[e]);if(f.length>0){for(r=s===u.childWidgets.length-1?new k(u):u.childWidgets[s+1],o=0;o<f.length;o++)f[o].line=r;n.children.splice(t+1,n.children.length-1);r.children=f.concat(r.children);-1===u.childWidgets.indexOf(r)&&u.childWidgets.splice(s+1,0,r)}}},n.prototype.addElementToLine=function(n,t){_instanceof(t,lt)&&"Inline"!==t.textWrappingStyle||(this.isWrapText&&(this.isWrapText=!1,this.viewer.clientActiveArea.width=this.viewer.clientArea.right-this.viewer.clientActiveArea.x),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+t.width));"Justify"===n.paragraphFormat.textAlignment&&_instanceof(t,i)&&this.splitTextElementWordByWord(t)},n.prototype.splitElementForClientArea=function(n,t){if(t.line.children.length>0){var r=t.previousElement,i=t.indexInOwner;t.line.children.length>1&&r&&this.viewer.clientActiveArea.x!==this.viewer.clientArea.x&&(i-=1);this.addSplittedLineWidget(t.line,i)}},n.prototype.splitByWord=function(n,r,u,f,e,o){var h=this.getSplitIndexByWord(this.viewer.clientActiveArea.width,f,e,o),c,s;h>0&&h<u.length&&(c=n.children.indexOf(u),s=new i,(f=f.substring(h),s.text=f," "===f[0])&&(h+=f.length-(f=t.trimStart(f)).length),s.characterFormat.copyFormat(u.characterFormat),s.width=this.documentHelper.textHelper.getWidth(s.text,o),s.trimEndWidth=s.width,u.text=u.text.substr(0,h),u.width-=s.width,u.trimEndWidth=u.width,u.revisions.length>0&&(this.updateRevisionForSpittedElement(u,s,!0),s.isMarkedForRevision=u.isMarkedForRevision),s.height=u.height,s.baselineOffset=u.baselineOffset,this.splitErrorCollection(u,s),this.addSplittedLineWidget(n,c,s),this.addElementToLine(r,u),0===u.width&&n.children.splice(c,1))},n.prototype.splitErrorCollection=function(n,t){var i,e,r;if(n.errorCollection.length>0){for(var u=[],o=n.ignoreOnceItems,f=0;f<n.errorCollection.length;f++)u.push(n.errorCollection[f]);for(i=0;i<n.errorCollection.length;i++)e=n.text.indexOf(n.errorCollection[i].text),r=n.errorCollection[i],e<0?(u.splice(0,1),t.errorCollection.push(r)):t.text.indexOf(r.text)>0&&t.errorCollection.push(r);t.ignoreOnceItems=o;n.ignoreOnceItems=[];n.errorCollection=u}},n.prototype.splitByCharacter=function(n,t,r,u,f){var h=n.paragraph,o=this.getTextSplitIndexByCharacter(this.viewer.clientArea.width,this.viewer.clientActiveArea.width,r,u,f),c=0,s,e;(o<t.length&&(c=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(r.substring(0,o),f),r=r.substring(o)),c>this.viewer.clientActiveArea.width&&t.indexInOwner>0)?this.addSplittedLineWidget(n,t.indexInOwner-1):(s=n.children.indexOf(t),o<t.length?(e=new i,e.text=r,e.errorCollection=t.errorCollection,t.text=t.text.substr(0,o),e.characterFormat.copyFormat(t.characterFormat),e.width=this.documentHelper.textHelper.getWidth(e.text,f),e.trimEndWidth=e.width,t.width-=e.width,t.trimEndWidth=t.width,e.height=t.height,e.baselineOffset=t.baselineOffset,n.children.splice(t.indexInOwner+1,0,e),t.revisions.length>0&&(this.updateRevisionForSpittedElement(t,e,o>0),e.isMarkedForRevision=t.isMarkedForRevision),this.addElementToLine(h,t),this.addSplittedLineWidget(n,s),0===t.width&&n.children.splice(s,1)):(this.addSplittedLineWidget(n,s),this.addElementToLine(h,t)))},n.prototype.updateRevisionForSpittedElement=function(n,t,i,r){var e,u,f;if(n.revisions.length>0)for(e=0;e<n.revisions.length;e++)u=n.revisions[e],i?(t.revisions.push(u),f=u.range.length-1,_instanceof(u.range[f],p)?u.range.splice(f-1,0,t):(f=u.range.indexOf(n))<0?u.range.push(t):r?u.range.splice(f,0,t):u.range.splice(f+1,0,t)):(u.range.splice(u.range.length-1,1),u.range.push(t),t.revisions.push(u))},n.prototype.splitTextElementWordByWord=function(n){var e=n.line,o=e.children.indexOf(n),c=o,l=n.padding.left,s,u,f,r,h;if(n.padding.left=0,u=n.text,u.trim().indexOf(" ")>=0){for(e.children.splice(o,1),s=n.characterFormat,f=n.length-t.trimStart(u).length;f<n.length&&0!==(f=this.getTextIndexAfterSpace(u,f))&&f!==n.length;)f<n.length&&(r=new i,h=u.substring(0,f)," "===(u=u.substring(f)).substring(0,1)&&(f+=u.length-t.trimStart(u).length),r.text=h,r.characterFormat.copyFormat(n.characterFormat),r.line=e,r.width=this.documentHelper.textHelper.getWidth(r.text,s),r.trimEndWidth=r.width,r.height=n.height,r.baselineOffset=n.baselineOffset,e.children.splice(o,0,r),n.revisions.length>0&&(this.updateRevisionForSpittedElement(n,r,f>0,!0),r.isMarkedForRevision=n.isMarkedForRevision),n.text=u,n.width-=r.width,n.trimEndWidth=n.width,0===n.width&&-1!==e.children.indexOf(n)&&e.children.splice(e.children.indexOf(n),1),f=0,o++);n.text=u;e.children.splice(o,0,n)}e.children[c].padding.left=l},n.prototype.splitTextForClientArea=function(n,i,r,u,f){var s=n.paragraph,h=!0,e=-1,o;if(" "!==r.substring(0,1)){if(o=u,(e=t.trimEnd(r).indexOf(" ")+1)>0&&(o=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(r.slice(0,e),f)),this.viewer.clientActiveArea.width<o&&(h=this.checkPreviousElement(n,n.children.indexOf(i),f)))return}else e=1;u<=this.viewer.clientActiveArea.width?this.addElementToLine(s,i):h&&(e>0||-1!==r.indexOf(" "))?this.splitByWord(n,s,i,r,u,f):this.splitByCharacter(n,i,r,u,f)},n.prototype.splitByLineBreakOrTab=function(n,t,r,u){var s=t.line.children.indexOf(t),f=t.text,h=f.substring(r),e="\t"===u?new oi:new i,o;(e.line=t.line,e.characterFormat.copyFormat(t.characterFormat),t.line.children.splice(s+1,0,e),r>0&&1===h.length)?(e.text=f.substring(r),t.text=f.substring(0,r)):r>0?(e.text=u,o=new i,o.line=t.line,o.text=f.substring(r+1),o.characterFormat.copyFormat(t.characterFormat),t.line.children.splice(s+2,0,o),t.text=f.substring(0,r)):""!==h&&(e.text=f.substring(r+1),t.text=u)},n.prototype.moveToNextLine=function(n){var u=n.paragraph,e=u.paragraphFormat,ct=n.isFirstLine(),b=n.isLastLine(),c=0,l=0,ut=0,ft=0,o=0,et=0,d,g,k,it,p,w,rt;this.updateLineWidget(n);l=(c=this.maxTextHeight)-this.maxTextBaseline;d=0;(u.bodyWidget&&(d=this.documentHelper.pages.indexOf(u.bodyWidget.page)),ct&&(ft=this.getBeforeSpacing(u),et=t.convertPointToPixel(e.firstLineIndent)),b&&(ut=t.convertPointToPixel(this.getAfterSpacing(u))),this.isBidiReLayout||!e.bidi&&!this.isContainsRtl(n)||(this.reArrangeElementsForRtl(n,e.bidi),this.isRTLLayout=!0),isNaN(this.maxTextHeight))?(g=this.documentHelper.textHelper.measureText("a",u.characterFormat),l=(c=g.Height)-g.BaselineOffset):l=(c=this.maxTextHeight)-this.maxTextBaseline;o=this.getLineSpacing(u,c);"Exactly"===e.lineSpacingType&&o<l+this.maxBaseline&&(o=l+this.maxBaseline);var a,s=0,v=0,r=e.textAlignment;"Left"!==r&&this.viewer.textWrap&&("Justify"!==r||!b||"Justify"===r&&e.bidi)&&(s=(a=this.getSubWidth(n,"Justify"===r,v,et,b))[0].subWidth,v=a[0].spaceCount);for(var ot=!1,nt=0,st=e.lineSpacingType,ht=!1,y=0;y<n.children.length;y++){var f=0,h=0,tt=0,i=n.children[y];!sf.base.isNullOrUndefined(a)&&ht&&i.padding.left>0&&a.length>nt+1&&(k=s,"Justify"===r?k=s*a[nt].spaceCount:"Center"===r&&(k=s/2),i.padding.left=i.padding.left-k,it=a[++nt],s=it.subWidth,v=it.spaceCount);_instanceof(i,lt)&&"Inline"!==i.textWrappingStyle||(ht=!0,p=this.alignLineElements(i,f,h,l,ot,s,r,v,y===n.children.length-1),f=p.topMargin,h=p.bottomMargin,ot=p.addSubWidth,v=p.whiteSpaceCount,"Multiple"===st?o>c?h+=o-c:f+=o-c:("Exactly"===st||o>f+i.height+h)&&(f+=o-(f+i.height+h)),f+=d>0&&u===u.bodyWidget.childWidgets[0]?0:ft,h+=ut,(0===y||!(_instanceof(i,lt)&&"Inline"!==i.textWrappingStyle)&&_instanceof(i.previousElement,lt)&&"Inline"!==i.previousElement.textWrappingStyle||i.padding.left>0)&&(n.height=f+i.height+h,"Right"===r||"Justify"===r&&e.bidi&&b?tt=s:"Center"===r&&(tt=s/2)),i.margin=new hi(tt,f,0,h),i.line=n)}(this.checkInbetweenShapeOverlap(n),n.isLastLine()&&0===n.indexInOwner&&n.paragraph.paragraphFormat.widowControl)&&(w=n.paragraph.previousSplitWidget,sf.base.isNullOrUndefined(w)||(rt=w.childWidgets.length-1,2===w.childWidgets.length&&(rt=0),this.splitParagraph(w,rt,n.paragraph),this.updateClientAreaForNextBlock(n,n.paragraph)));this.viewer.cutFromTop(this.viewer.clientActiveArea.y+n.height);this.wrapPosition=[]},n.prototype.checkInbetweenShapeOverlap=function(n){var i=this,t,r,u;!_instanceof(n.paragraph.containerWidget,et)&&n.paragraph.bodyWidget&&(r=this.getLineY(n),u=n.paragraph.isInsideTable,n.paragraph.bodyWidget.floatingElements.sort(function(n,t){return n.y-t.y}),n.paragraph.bodyWidget.floatingElements.forEach(function(f){var o,s,e;u&&f.line&&!f.line.paragraph.isInsideTable||sf.base.isNullOrUndefined(f.line)||(o=new b(n.paragraph.x,i.viewer.clientActiveArea.y,n.paragraph.width,n.height),s=new b(f.x,f.y-f.distanceTop,f.width,f.height),f.line&&i.isRelayout&&!i.isRelayoutOverlap&&i.viewer.documentHelper.selection.isExistAfter(f.line.paragraph,n.paragraph)||i.isRelayout&&i.isRelayoutOverlap&&i.viewer.documentHelper.selection.isExistAfter(f.line.paragraph,i.endOverlapWidget)||(e="TopAndBottom"===f.textWrappingStyle,(t&&e&&t.y+t.height+t.distanceBottom+n.height>f.y-f.distanceTop&&t.y-t.distanceTop<f.y-f.distanceTop&&f.y+f.height+f.distanceBottom>t.y+t.height+t.distanceBottom||e&&!t&&o.isIntersecting(s))&&(t=f,n.marginTop=f.y+f.height+f.distanceBottom-r)))}),t?this.viewer.cutFromTop(t.y+t.height+t.distanceBottom):this.isRelayoutOverlap&&(n.marginTop=0))},n.prototype.getLineY=function(n){var i=n.paragraph,r=i.y,t;if(!i.isEmpty())for(t=i.firstChild;t!==n;)r=r+t.height+t.marginTop,t=t.nextLine;return r},n.prototype.updateLineWidget=function(n){for(var t,r=0;r<n.children.length;r++)t=n.children[r],_instanceof(t,lt)&&"Inline"!==t.textWrappingStyle||(_instanceof(t,i)||_instanceof(t,o)?(this.maxTextHeight<t.height&&(this.maxTextHeight=t.height,this.maxTextBaseline=t.baselineOffset),this.maxBaseline<this.maxTextBaseline&&(this.maxBaseline=this.maxTextBaseline)):this.maxBaseline<t.height&&(this.maxBaseline=t.height))},n.prototype.moveToNextPage=function(n,i,r){var h,y,l,c,rt,w,b,ut,s,ot,k,v,ft,d,p;if(!this.isFootNoteLayoutStart){this.isRelayoutOverlap&&this.endOverlapWidget!==i.paragraph&&(i=this.endOverlapWidget.childWidgets[0]);var et,e=i.paragraph,g=!1,tt=!1;if(e&&!_instanceof(e.containerWidget,it)){if(h=0,_instanceof(e,it))return;if(sf.base.isNullOrUndefined(i)||(0!==(h=e.childWidgets.indexOf(i))&&(e.paragraphFormat.keepLinesTogether&&!sf.base.isNullOrUndefined(e.previousWidget)||1==h&&e.paragraphFormat.widowControl&&!sf.base.isNullOrUndefined(e.previousWidget))&&(h=0,g=!0),(h>0||r)&&(e.height=n.clientActiveArea.y-e.y),0!==h||e.isEndsWithPageBreak)||(y=this.alignBlockElement(e),sf.base.isNullOrUndefined(y.node)||(e=et=_instanceof(y.node,a)?this.splitRow(y.node):y.node,h=_instanceof(et,f)?0:parseInt(y.position.index,10),g=!1,tt=!0)),sf.base.isNullOrUndefined(e.bodyWidget)||_instanceof(e.bodyWidget,it)||void 0===e.bodyWidget.page.footnoteWidget||this.layoutfootNote(e.bodyWidget.page.footnoteWidget),l=this.moveBlocksToNextPage(e),this.viewer.updateClientArea(l.sectionFormat,l.page),this.viewer.updateClientAreaForBlock(e,!0),h>0){if(i.isLastLine()&&r)return;for(c=void 0,c=_instanceof(l.firstChild,u)&&l.firstChild.equals(e)?l.firstChild:new u,(c=this.addParagraphWidget(this.viewer.clientActiveArea,c)).index=e.index,rt=0,w=h;w<e.childWidgets.length;w++)b=e.childWidgets[w],b.paragraph=c,c.childWidgets.splice(rt,0,b),b.paragraph=c,rt++;c.paragraphFormat=e.paragraphFormat;c.characterFormat=e.characterFormat;e.childWidgets.splice(h);e=c}else r||e.containerWidget.removeChild(e.indexInOwner);if(!r){if(-1===l.childWidgets.indexOf(e)&&l.childWidgets.splice(0,0,e),e.containerWidget=l,this.viewer.updateClientAreaLocation(e,this.viewer.clientActiveArea),g||tt){if(i.paragraph!==e&&(_instanceof(e,f)&&this.clearTableWidget(e,!0,!0,!1),this.layoutBlock(e,0),n.updateClientAreaForBlock(e,!1)),ut=i.paragraph,tt&&(s=e.nextWidget,!sf.base.isNullOrUndefined(s)))do{if(n.updateClientAreaForBlock(s,!0),s===ut){this.viewer.updateClientAreaLocation(s,this.viewer.clientActiveArea);break}_instanceof(s,f)&&this.clearTableWidget(s,!0,!0,!1);this.layoutBlock(s,0);n.updateClientAreaForBlock(s,!1);s=s.nextWidget}while(s);this.updateClientAreaForNextBlock(i,ut)}0!==i.indexInOwner||_instanceof(i.children[0],o)||(ot=-t.convertPointToPixel(i.paragraph.paragraphFormat.firstLineIndent),this.viewer.updateClientWidth(ot))}}if(_instanceof(e,u)&&e.floatingElements.length>0)for(k=0;k<e.floatingElements.length;k++)v=e.floatingElements[k],ft=this.getFloatingItemPoints(v),v.y=ft.y,v.x=ft.x,_instanceof(v,nt)&&this.updateChildLocationForCellOrShape(v.y,v);if(this.isRelayoutOverlap&&this.endOverlapWidget){for(d=this.endOverlapWidget.previousRenderedWidget,p=i.paragraph;p;)p.floatingElements.forEach(function(n){-1!==d.bodyWidget.floatingElements.indexOf(n)&&(d.bodyWidget.floatingElements.splice(d.bodyWidget.floatingElements.indexOf(n),1),i.paragraph.bodyWidget.floatingElements.push(n))}),p=p!==this.endOverlapWidget?p.nextWidget:void 0;this.layoutStartEndBlocks(this.startOverlapWidget,this.endOverlapWidget);this.startOverlapWidget=void 0;this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-this.endOverlapWidget.y;this.viewer.clientActiveArea.y=this.endOverlapWidget.y}}},n.prototype.alignBlockElement=function(n){var r,i,t,f;if(_instanceof(n,u)&&n.isEndsWithPageBreak)return{node:void 0,position:{index:""}};for(i=0,t=this.getPreviousBlock(n);t;){if(_instanceof(t,u)){if(!t.paragraphFormat.keepWithNext||t.isEndsWithPageBreak)break;if(r=t,t.paragraphFormat.keepLinesTogether)sf.base.isNullOrUndefined(this.getPreviousBlock(t))?r=void 0:i=0;else if(sf.base.isNullOrUndefined(this.getPreviousBlock(t))&&1===t.childWidgets.length)r=void 0;else if(t.paragraphFormat.widowControl){if((1==(i=t.lastChild.indexInOwner-1)||i<0)&&(i=0),0!==i)break}else i=t.lastChild.indexInOwner}else if(_instanceof(t,a)){if(f=this.documentHelper.selection.getFirstParagraphInCell(t.childWidgets[0]),!f.paragraphFormat.keepWithNext)break;f.paragraphFormat.keepWithNext&&(sf.base.isNullOrUndefined(this.getPreviousBlock(t))?r=void 0:i=(r=t).indexInOwner)}t=this.getPreviousBlock(t)}return{node:r,position:{index:i.toString()}}},n.prototype.getPreviousBlock=function(n){var t;return _instanceof(n,u)?t=n.previousWidget:_instanceof(n,a)&&(t=n.previousWidget,sf.base.isNullOrUndefined(t)&&(t=n.ownerTable.previousWidget)),_instanceof(t,f)&&(t=t.lastChild),t},n.prototype.splitRow=function(n){var t=n.ownerTable,i,u,r;if(0===n.indexInOwner)return t;for(i=this.createTableWidget(t),u=n.indexInOwner;u<t.childWidgets.length;)r=t.childWidgets.splice(u,1)[0],i.childWidgets.push(r),r.containerWidget=i,t.height-=r.height,i.height+=r.height;return t.containerWidget.childWidgets.splice(t.indexInOwner+1,0,i),i.containerWidget=t.containerWidget,i},n.prototype.splitParagraph=function(n,t,i){var f,s,o,e,r;if(0===t&&sf.base.isNullOrUndefined(i))return n;for(f=!1,sf.base.isNullOrUndefined(i)?((i=new u).containerWidget=n.containerWidget,n.containerWidget.childWidgets.splice(n.indexInOwner+1,0,i),i.paragraphFormat=n.paragraphFormat,i.characterFormat=n.characterFormat,i.index=n.index):0===t&&(f=!0,s=n,n=i,i=s),o=0,e=t;e<n.childWidgets.length;e++)r=n.childWidgets[e],r.paragraph=i,f?i.childWidgets.push(r):i.childWidgets.splice(o,0,r),i.height+=r.height,n.height-=r.height,r.paragraph=i,o++;return f?(i.containerWidget.childWidgets.splice(i.indexInOwner,1),i.y=n.y,i.x=n.x,i.containerWidget=n.containerWidget,n.containerWidget.childWidgets.unshift(i)):n.childWidgets.splice(t),(0===n.childWidgets.length||f)&&n.containerWidget.childWidgets.splice(n.indexInOwner,1),i},n.prototype.updateClientPositionForBlock=function(n,t){var i=_instanceof(n,a)?n.ownerTable:n,e=!1,r;do{if(this.viewer.updateClientAreaForBlock(i,!0),_instanceof(i,u)){if(_instanceof(t,u)&&t.equals(i)){e=!0;break}this.addParagraphWidget(this.viewer.clientActiveArea,i);this.viewer.cutFromTop(this.viewer.clientActiveArea.y+i.height);this.viewer.updateClientAreaForBlock(i,!1)}else if(_instanceof(i,f))if(this.addTableWidget(this.viewer.clientActiveArea,[i]),r=i.firstChild,_instanceof(t,a)&&i.equals(t.ownerTable)&&!sf.base.isNullOrUndefined(r)){do{if(r.equals(t)){e=!0;break}this.addTableRowWidget(this.viewer.clientActiveArea,[r]);this.updateChildLocationForRow(this.viewer.clientActiveArea.y,r);this.viewer.cutFromTop(this.viewer.clientActiveArea.y+r.height);i.height+=r.height;r=r.nextWidget}while(r)}else this.updateChildLocationForTable(i.y,i),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+i.height),this.viewer.updateClientAreaForBlock(i,!1);i=i.nextWidget}while(i&&!e)},n.prototype.updateClientAreaForNextBlock=function(n,t){for(var r,i=0;i<t.childWidgets.length;i++){if(r=t.childWidgets[i],n===r)break;this.viewer.cutFromTop(this.viewer.clientActiveArea.y+r.height)}},n.prototype.layoutStartEndBlocks=function(n,t){var i=n;for(this.isOverlapFloatTable=!0,this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-n.y,this.viewer.clientActiveArea.y=n.y;i;)this.viewer.updateClientAreaForBlock(i,!0),_instanceof(i,u)?this.layoutParagraph(i,0):(this.clearTableWidget(i,!0,!0,!0),this.layoutTable(i,0)),this.viewer.updateClientAreaForBlock(i,!1),i=i!==t?i.nextWidget:void 0},n.prototype.alignLineElements=function(n,r,u,f,e,s,h,c,l){var v,p,w,a,y;return n.width>0&&(_instanceof(n,i)||_instanceof(n,o))?(v=_instanceof(n,i)?n:void 0,p=_instanceof(n,i)?v.baselineOffset:n.baselineOffset,(r+=this.maxBaseline-p,u+=f-(n.height-p),!sf.base.isNullOrUndefined(v)&&"Justify"===h&&c>0)&&(w=v.width,a=v.text,(e||(e=(a=t.trimStart(a)).length>0),e)&&(y=a.length-t.removeSpace(a).length,l&&(y-=a.length-t.trimEnd(a).length),c<y&&(w=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(a,v.characterFormat),y=c),y>0&&(v.width=w+s*y,c-=y)))):(e=!0,r+=this.maxBaseline-n.height,u+=f),{topMargin:r,bottomMargin:u,addSubWidth:e,whiteSpaceCount:c}},n.prototype.updateWidgetToPage=function(n,i){if(i.isInsideTable){var r=i.associatedCell;if(i.height=n.clientActiveArea.y-i.y,sf.base.isNullOrUndefined(i.associatedCell)||sf.base.isNullOrUndefined(i.associatedCell.ownerRow)||sf.base.isNullOrUndefined(i.associatedCell.ownerRow.rowFormat))return;r.height="Exactly"===i.associatedCell.ownerRow.rowFormat.heightType?t.convertPointToPixel(i.associatedCell.ownerRow.rowFormat.height):[r].length<=1&&"AtLeast"===i.associatedCell.ownerRow.rowFormat.heightType?Math.max(t.convertPointToPixel(i.associatedCell.ownerRow.rowFormat.height),this.getCellContentHeight(r)):r.height+i.height;i.containerWidget=r}else(!i.isEndsWithPageBreak||_instanceof(n,at))&&(i.height=n.clientActiveArea.y-i.y);this.isRelayoutFootnote&&_instanceof(i.bodyWidget,it)&&(i.isInsideTable||(i.containerWidget.height+=i.height),this.shiftFootnoteChildLocation(i.bodyWidget,this.viewer));_instanceof(i.bodyWidget,ct)&&(i.isInsideTable||(i.containerWidget.height+=i.height),this.viewer.owner.enableHeaderAndFooter&&-1!==i.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(i.bodyWidget,this.viewer));_instanceof(n,at)&&_instanceof(i.containerWidget,c)&&(i.containerWidget.height+=i.height)},n.prototype.shiftFooterChildLocation=function(n,i){var e=n.page.bodyWidgets[0].sectionFormat.pageHeight,r,f,u;-1!==n.headerFooterType.indexOf("Footer")&&(f=n.page.bodyWidgets[0].sectionFormat.footerDistance,u=t.convertPointToPixel(e-f),n.y+n.height>u?r=u-(n.y+n.height):n.y+n.height<u&&(r=n.y+n.height-u),sf.base.isNullOrUndefined(r)||(r=u-(n.y+n.height),this.shiftChildLocation(r,n),i.clientActiveArea.y+=r))},n.prototype.shiftFootnoteChildLocation=function(n,i){var r,f=n.page.bodyWidgets[0].sectionFormat.pageHeight,e=(n.page.bodyWidgets[0].sectionFormat.footerDistance,n.page.bodyWidgets[0].sectionFormat.bottomMargin),u=t.convertPointToPixel(f-e);n.y+n.height>u?r=u-(n.y+n.height):n.y+n.height<u&&(r=n.y+n.height-u);sf.base.isNullOrUndefined(r)||(r=u-(n.y+n.height),this.shiftChildLocation(r,n),i.clientActiveArea.y+=r)},n.prototype.checkPreviousElement=function(n,t,u){var f,s,a,h,v;n.paragraph;for(var c=!1,l=0,e=t-1;e>=0;e--)if(f=n.children[e],_instanceof(f,i)&&f.width>0){if(s=f.text,l=e,s.length>0&&" "===s[s.length-1]){if(e===t-1)return this.addSplittedLineWidget(n,t-1),!0;c=!0;break}if("\t"===s)return!1;if(s.indexOf(" ")>=0){c=!0;a=s.lastIndexOf(" ")+1;h=new i;h.text=s.substr(a);h.characterFormat.copyFormat(f.characterFormat);f.revisions.length>0&&(this.updateRevisionForSpittedElement(f,h,a>0),h.isMarkedForRevision=f.isMarkedForRevision);f.text=s.substr(0,a);this.documentHelper.textHelper.getTextSize(h,u);f.width-=h.width;f.height=h.height;0===f.width&&n.children.splice(e,1);n.children.splice(e+1,0,h);break}}else if(!(_instanceof(f,o)||_instanceof(f,r)||_instanceof(f,i)&&0===f.width)){l=e;c=!0;break}if(c&&++l<n.children.length){for(v=0,e=l;e<n.children.length;e++)v+=n.children[e].width,this.addSplittedLineWidget(n,e-1),e--;this.viewer.updateClientWidth(v)}return c},n.prototype.clearListElementBox=function(n){var i,t;if(0!==n.childWidgets.length&&(i=n.childWidgets[0],!sf.base.isNullOrUndefined(i.children))){for(t=i.children.length-1;t>0&&_instanceof(i.children[t],o);t--)i.children.splice(t,1);for(t=0;t<i.children.length&&_instanceof(i.children[t],o);t++)i.children.splice(t,1),t--}},n.prototype.getListNumber=function(n,t){var i=this.documentHelper.getListById(n.listId),r=n.listLevelNumber,e=this.getListLevel(i,n.listLevelNumber),u=sf.base.isNullOrUndefined(i.levelOverrides)?void 0:i.levelOverrides[r],f;return!sf.base.isNullOrUndefined(u)&&-1===this.documentHelper.renderedLevelOverrides.indexOf(u)&&sf.base.isNullOrUndefined(u.overrideListLevel)&&(this.documentHelper.renderedLevelOverrides.push(u),this.documentHelper.renderedLists.containsKey(this.documentHelper.getAbstractListById(i.abstractListId)))&&(f=this.documentHelper.renderedLists.get(this.documentHelper.getAbstractListById(i.abstractListId)),f.containsKey(r)&&f.remove(r)),sf.base.isNullOrUndefined(t)&&this.updateListValues(i,r),this.getListText(i,r,e)},n.prototype.getListStartValue=function(n,t){var i=sf.base.isNullOrUndefined(t.levelOverrides)?void 0:t.levelOverrides[n],r;return!sf.base.isNullOrUndefined(i)&&sf.base.isNullOrUndefined(i.overrideListLevel)?i.startAt:(r=this.getListLevel(t,n),sf.base.isNullOrUndefined(r)?0:r.startAt)},n.prototype.updateListValues=function(n,t){var r,f,i,o,e,u;if(this.documentHelper.renderedLists.containsKey(this.documentHelper.getAbstractListById(n.abstractListId)))if(r=this.documentHelper.renderedLists.get(this.documentHelper.getAbstractListById(n.abstractListId)),r.containsKey(t))for(f=r.get(t),r.set(t,f+1),i=t+1;i<this.documentHelper.getAbstractListById(n.abstractListId).levels.length;)e=this.getListLevel(n,i),r.containsKey(i)&&e.restartLevel>t&&r.remove(i),i++;else{for(i=t;!r.containsKey(i-1)&&i>0;)e=this.getListLevel(n,i-1),r.add(i-1,this.getListStartValue(i-1,n)),i--;f=this.getListStartValue(t,n);r.add(t,f)}else for(o=new h,this.documentHelper.renderedLists.add(this.documentHelper.getAbstractListById(n.abstractListId),o),e=this.getListLevel(n,t),u=0;u<=t;u++)o.add(u,this.getListStartValue(u,n))},n.prototype.getListText=function(n,t,i){var r=i.numberFormat;if(this.documentHelper.renderedLists.containsKey(this.documentHelper.getAbstractListById(n.abstractListId)))for(var f=this.documentHelper.renderedLists.get(this.documentHelper.getAbstractListById(n.abstractListId)),s=f.keys,h=0;h<s.length;h++){var u=s[h],e="%"+(u+1).toString(),o=this.getListLevel(n,u);if(r.match(e)&&r.match((t+1).toString())){if(u>t)return"";r=f.containsKey(u)&&!sf.base.isNullOrUndefined(o)?r.replace(e,this.getListTextListLevel(o,f.get(u))):r.replace(e,"0")}else if(r.match(e)&&t>0)return o=this.getListLevel(n,s[t]),this.getListTextListLevel(o,f.get(t))+"."}return r},n.prototype.getAsLetter=function(n){var t=n/26,i=n%26,u,r;for(0===i&&(i=26,t--),u=String.fromCharCode(64+i),r="";t>=0;)r+=u.toString(),t--;return r},n.prototype.getListTextListLevel=function(n,t){switch(n.listLevelPattern){case"UpRoman":return this.getAsRoman(t).toUpperCase();case"LowRoman":return this.getAsRoman(t).toLowerCase();case"UpLetter":return this.getAsLetter(t).toUpperCase();case"LowLetter":return this.getAsLetter(t).toLowerCase();case"Arabic":return t.toString();case"LeadingZero":return this.getAsLeadingZero(t);case"Number":case"OrdinalText":case"Ordinal":case"FarEast":case"Special":return t.toString();default:return""}},n.prototype.getFootEndNote=function(n,t){switch(n){case"UpperCaseRoman":return this.getAsRoman(t).toUpperCase();case"LowerCaseRoman":return this.getAsRoman(t).toLowerCase();case"UpperCaseLetter":return this.getAsLetter(t).toUpperCase();case"LowerCaseLetter":return this.getAsLetter(t).toLowerCase();default:return t.toString()}},n.prototype.generateNumber=function(n,t,i){for(var r="";n>=t;)n-=t,r+=i,this.value=n;return r.toString()},n.prototype.getAsLeadingZero=function(n){return n<10?"0"+n.toString():n.toString()},n.prototype.getAsRoman=function(n){var t="";return this.value=n,t+=this.generateNumber(this.value,1e3,"M"),t+=this.generateNumber(this.value,900,"CM"),t+=this.generateNumber(this.value,500,"D"),t+=this.generateNumber(this.value,400,"CD"),t+=this.generateNumber(this.value,100,"C"),t+=this.generateNumber(this.value,90,"XC"),t+=this.generateNumber(this.value,50,"L"),t+=this.generateNumber(this.value,40,"XL"),t+=this.generateNumber(this.value,10,"X"),t+=this.generateNumber(this.value,9,"IX"),t+=this.generateNumber(this.value,5,"V"),t+=this.generateNumber(this.value,4,"IV"),(t+=this.generateNumber(this.value,1,"I")).toString()},n.prototype.getListLevel=function(n,t){var i,r;if(!sf.base.isNullOrUndefined(n)){if(i=this.documentHelper.getAbstractListById(n.abstractListId),!sf.base.isNullOrUndefined(n)&&i.levels.length<=t&&t>=0&&t<9&&this.addListLevels(i),r=void 0,!sf.base.isNullOrUndefined(n.levelOverrides)&&!sf.base.isNullOrUndefined(r=n.levelOverrides[t])&&!sf.base.isNullOrUndefined(r.overrideListLevel))return r.overrideListLevel;if(!sf.base.isNullOrUndefined(i)&&t>=0&&t<i.levels.length)return i.levels[t]}},n.prototype.getTabWidth=function(n,i,r,u,f){var k=f?this.documentHelper.textHelper.getTextSize(f,f.characterFormat):0,y=0,it=!1,h=n.paragraphFormat.getUpdatedTabs(),d=!1,ot=n.bodyWidget.sectionFormat,st=t.convertPointToPixel(ot.leftMargin),rt,l,a,p,v,c,tt,w,et;sf.base.isNullOrUndefined(n.paragraphFormat.listFormat.listLevel)||sf.base.isNullOrUndefined(n.paragraphFormat.listFormat.listLevel.paragraphFormat)||(rt=n.paragraphFormat.listFormat.listLevel.paragraphFormat,n.paragraphFormat.leftIndent!==rt.leftIndent&&(d=!0));var g=0,b=i.clientActiveArea.x,nt=t.convertPointToPixel(n.paragraphFormat.firstLineIndent),ut=t.convertPointToPixel(n.paragraphFormat.leftIndent);if(!sf.base.isNullOrUndefined(f)&&u.isFirstLine()?(g=this.viewer.clientArea.x+nt,d&&(b+=nt)):g=this.viewer.clientArea.x,b<g)return i.clientArea.x-i.clientActiveArea.x;if(_instanceof(f,o)&&u.isFirstLine()&&ut>0&&nt<0){if(i.clientArea.x-i.clientActiveArea.x>0)return i.clientArea.x-i.clientActiveArea.x;0===h.length&&n.paragraphFormat.listFormat&&(h=n.paragraphFormat.listFormat.listLevel.paragraphFormat.tabs)}var s=i.clientActiveArea.x-(i.clientArea.x-t.convertPointToPixel(n.paragraphFormat.leftIndent)),e=t.convertPointToPixel(this.documentHelper.defaultTabWidth),ft=!1;if(0===h.length&&(s>0&&e>Math.round(s)&&d||e===this.defaultTabWidthPixel&&e>Math.round(s)))return e-s;if(h.length>0)for(l=0;l<h.length;l++)if(a=h[l],p=t.convertPointToPixel(h[l].position),ft=st+p+k>i.clientArea.x,Math.floor(s+k)<=p){if(it=!0,"Left"===a.tabJustification||"List"===a.tabJustification){y=p;_instanceof(f,oi)&&(f.tabLeader=h[l].tabLeader,f.tabText="");break}v=p-s;c=this.getRightTabWidth(f.indexInOwner+1,u,n);c<v?"Right"===a.tabJustification?(e=v-c,tt=t.convertPointToPixel(n.rightIndent),w=this.viewer.clientActiveArea.width+tt-e,this.viewer.clientActiveArea.width+=tt,w<0?e+=w-c:c>w&&(e-=c-w)):e=v-c/2:e="Center"===a.tabJustification&&c/2<v?v-c/2:"Right"===a.tabJustification?0:k;y=s;_instanceof(f,oi)&&(f.tabLeader=h[l].tabLeader,f.tabText="");break}return it||(et=100*Math.round(s)%(100*Math.round(e))/100,y=((Math.round(s)-et)/Math.round(e)+1)*e),ft&&ut>0&&i.clientArea.x>b?i.clientArea.x-b:y-s>0?y-s:e},n.prototype.getRightTabWidth=function(n,t){for(var f=0,o=!1,u=t.children[n];u;){if(_instanceof(u,r)||_instanceof(u,e)||o?(_instanceof(u,r)&&(0===u.fieldType?o=!0:2===u.fieldType&&(o=!1)),u.width=0):_instanceof(u,i)&&this.documentHelper.textHelper.getTextSize(u,u.characterFormat),_instanceof(u,i)&&"\t"===u.text)return f;f+=u.width;u=u.nextNode}return f},n.prototype.getSplitIndexByWord=function(n,t,i,r){for(var u,o,f=0,e=t.length;f<e;){if(u=this.getTextIndexAfterSpace(t,f),0!==u&&u!==e||(u=e-1),o=i,(u<e-1||u===e-1&&" "===t[u-1])&&f!==u&&(o=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(t.slice(0,u),r)),!(o<=n)){0===f&&" "===t[0]&&(f=this.getTextIndexAfterSpace(t,0));break}f=u}return f},n.prototype.getTextSplitIndexByCharacter=function(n,t,i,r,u){for(var o,e=i.length,f=0;f<e;f++)if(o=r,f+1<e&&(o=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.substring(0,f+1),u)),o>t)return 0===f&&o>n?e>1&&" "===i[1]?this.getTextIndexAfterSpace(i,1):1:f;return 0},n.prototype.getSubWidth=function(n,r,u,f,e){var s=0,a=!0,h="",y,v,o,c,l;if(this.wrapPosition.length>0&&(y=this.getSubWidthBasedOnTextWrap(n,r,u,f,e),y.length>0))return y;for(v=n.children.length-1;v>=0;v--){if(o=n.children[v],o.width>0&&_instanceof(o,i))c=o.text,h=c+h,!a||""===c.trim()&&"\t"!==c?a||(s+=o.width):(s+=t.endsWith(c)?this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(c,o.characterFormat):o.width,a=!1);else{if(h="a"+h,a=!1,_instanceof(o,lt)&&"Inline"!==o.textWrappingStyle)continue;s+=o.width}s=r?s:Math.round(s)}return u=(h=h.trim()).length-t.removeSpace(h).length,l=this.viewer.clientArea.width-f-s,l<=0||0===u&&r&&!n.paragraph.paragraphFormat.bidi?(u=0,l=0):r&&(!e&&u>0?l/=u:u=0),[{subWidth:l,spaceCount:u}]},n.prototype.getSubWidthBasedOnTextWrap=function(n,r,u,f,e){for(var o,h,y,p,w=[],c=0,s="",l=this.wrapPosition.length-1,a=!0,v=n.children.length-1;v>=0;v--)if(o=n.children[v],o.width>0&&_instanceof(o,i)?(h=o.text,s=h+s,!a||""===h.trim()&&"\t"!==h?a||(c+=o.width):(c+=t.endsWith(h)?this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(h,o.characterFormat):o.width,a=!1)):(s="a"+s,a=!1,_instanceof(o,lt)&&"Inline"!==o.textWrappingStyle||(c+=o.width)),(o.padding.left>0||0===v)&&l>=0){for(y=this.wrapPosition[l--];y.width<=0&&l>=0;)y=this.wrapPosition[l--];p=this.getSubWidthInfo(n,y.width,c,s,u,r,e);sf.base.isNullOrUndefined(p)||(c=0,s="",w.unshift(p))}return w},n.prototype.getSubWidthInfo=function(n,i,r,u,f,e,o){var h,s;if(i>0)return h=i-r,f=(u=u.trim()).length-t.removeSpace(u).length,s=h,s<=0||0===f&&e&&!n.paragraph.paragraphFormat.bidi?(f=0,s=0):e&&(!o&&f>0?s/=f:f=0),{subWidth:s,spaceCount:f}},n.prototype.getBeforeSpacing=function(n){var i=0,r;return _instanceof(n.previousWidget,u)&&!this.documentHelper.dontUseHtmlParagraphAutoSpacing?(r=this.getAfterSpacing(n.previousWidget),r<n.paragraphFormat.beforeSpacing&&(i=n.paragraphFormat.beforeSpacing-r)):i=n.paragraphFormat.beforeSpacing,this.isSameStyle(n,!1)?0:t.convertPointToPixel(i)},n.prototype.getAfterSpacing=function(n){var t=n.paragraphFormat.afterSpacing;return this.isSameStyle(n,!0)?0:t},n.prototype.getLineSpacing=function(n,t,i){if(sf.base.isNullOrUndefined(n.paragraphFormat))return 0;var r=0;switch(n.paragraphFormat.lineSpacingType){case"AtLeast":case"Exactly":r=n.paragraphFormat.lineSpacing;break;default:r=n.paragraphFormat.lineSpacing;i&&(r-=1);r*=t}return r},n.prototype.isParagraphFirstLine=function(n,t){var i=n;return!(!sf.base.isNullOrUndefined(i.childWidgets)&&0!==i.childWidgets.indexOf(t))&&(!(t.children.length>0&&!sf.base.isNullOrUndefined(n.previousWidget)&&_instanceof(n.previousWidget,u))||t.paragraph.index!==n.previousWidget.index)},n.prototype.isParagraphLastLine=function(n){var u=n.line.paragraph,f=u.childWidgets[u.childWidgets.length-1],t=f.children[f.children.length-1];return n===t&&(_instanceof(t,r)||!(_instanceof(t,i)&&"\v"===t.text))},n.prototype.getTextIndexAfterSpace=function(n,t){var r=n.length,i=n.indexOf(" ",t)+1;if(0===i||i===r)return i;for(;" "===n[i]&&++i!==r;);return i},n.prototype.moveNextWidgetsToTable=function(n,t,i){var f=t.indexInOwner,e=n[n.length-1],u,r;for(i&&(f+=1),u=t.containerWidget.childWidgets.splice(f),r=0;r<u.length;r++)e.childWidgets.push(u[r]),u[r].containerWidget=e},n.prototype.addTableCellWidget=function(n,i,r,u){var f,e=0,c=0,w=r,l=0,b=u,o,h,a,v,y,p;return sf.base.isNullOrUndefined(n.cellFormat)||(n.cellFormat.containsMargins()?(c=sf.base.isNullOrUndefined(n.cellFormat.leftMargin)?t.convertPointToPixel(n.ownerTable.tableFormat.leftMargin):t.convertPointToPixel(n.cellFormat.leftMargin),l=sf.base.isNullOrUndefined(n.cellFormat.rightMargin)?t.convertPointToPixel(n.ownerTable.tableFormat.rightMargin):t.convertPointToPixel(n.cellFormat.rightMargin)):(c=0===n.columnIndex&&n.ownerRow.rowFormat.hasValue("leftMargin")?t.convertPointToPixel(n.ownerRow.rowFormat.leftMargin):t.convertPointToPixel(n.ownerTable.tableFormat.leftMargin),l=n.columnIndex===n.ownerTable.tableHolder.columns.length-1&&n.ownerRow.rowFormat.hasValue("rightMargin")?t.convertPointToPixel(n.ownerRow.rowFormat.rightMargin):t.convertPointToPixel(n.ownerTable.tableFormat.rightMargin))),n.margin=new hi(c,w,l,b),n.ownerTable.tableFormat.allowAutoFit,o=n.cellFormat.cellWidth,o>n.cellFormat.preferredWidth&&0!==n.cellFormat.preferredWidth&&"Percent"!==n.cellFormat.preferredWidthType&&"Percent"!==n.ownerTable.tableFormat.preferredWidthType&&sf.base.isNullOrUndefined(n.ownerTable.positioning)&&!n.ownerTable.isContainInsideTable&&(o=n.cellFormat.preferredWidth),n.width=t.convertPointToPixel(o),sf.base.isNullOrUndefined(n.previousWidget)||(e=n.previousWidget.columnIndex+n.previousWidget.cellFormat.columnSpan),f=sf.base.isNullOrUndefined(n.ownerTable)||sf.base.isNullOrUndefined(n.ownerTable.tableFormat)?0:t.convertPointToPixel(n.ownerTable.tableFormat.cellSpacing),h=0,e<n.columnIndex&&(h=t.convertPointToPixel(n.ownerTable.tableHolder.getPreviousSpannedCellWidth(e,n.columnIndex)),0===e&&(h-=f/2)),n.x=i.x+h+n.margin.left,n.y=i.y+n.margin.top+f,n.width=n.width-n.margin.left-n.margin.right,f>0&&(n.x+=f,n.width-=1===n.ownerTable.tableHolder.columns.length?2*f:0===n.columnIndex||n.columnIndex===n.ownerTable.tableHolder.columns.length-1?2*f-f/2:f),a=t.convertPointToPixel(s.getCellLeftBorder(n).getLineWidth()),v=t.convertPointToPixel(s.getCellRightBorder(n).getLineWidth()),n.leftBorderWidth=n.ownerTable.isBidiTable?v:a,y="None"===n.cellFormat.borders.left.lineStyle,p="None"===n.cellFormat.borders.right.lineStyle,n.x+=y?n.leftBorderWidth>0?0:n.leftBorderWidth:0,n.width-=y?n.leftBorderWidth>0?0:n.leftBorderWidth:0,n.ownerTable.isBidiTable?n.cellIndex:(n.cellIndex,n.ownerRow.childWidgets.length),(f>0||n.columnIndex===n.ownerTable.tableHolder.columns.length-1||n.columnIndex===n.containerWidget.childWidgets.length-1&&n.cellFormat.columnSpan>1)&&(n.rightBorderWidth=n.ownerTable.isBidiTable?a:v,n.ownerTable.tableFormat.allowAutoFit||(n.width-=n.rightBorderWidth)),n.margin.right+=p?0:n.rightBorderWidth,n},n.prototype.addWidgetToTable=function(n,t,i,r,u,f){var e=t[0],s=e.childWidgets.length,o=void 0,h=i.indexOf(r),c;(h>0?o=i[h-1]:_instanceof(r.previousRenderedWidget,a)&&r.previousRenderedWidget.ownerTable.equals(r.ownerTable)&&(o=r.previousRenderedWidget),sf.base.isNullOrUndefined(o))||((s=(e=o.containerWidget).childWidgets.indexOf(o)+1,Math.round(r.y)!==Math.round(o.y+o.height))&&(c=t.indexOf(e),c+1>=t.length&&this.addTableWidget(n.clientActiveArea,t,!0),s=(e=t[c+1]).childWidgets.length),h>0&&(s=0));this.updateRowHeightBySpannedCell(e,r,s);this.updateRowHeightByCellSpacing(t,r,n);r.containerWidget&&r.containerWidget!==e&&-1!==r.containerWidget.childWidgets.indexOf(r)&&r.containerWidget.childWidgets.splice(r.containerWidget.childWidgets.indexOf(r),1);-1===e.childWidgets.indexOf(r)&&e.childWidgets.splice(s,0,r);r.containerWidget=e;e.height=e.height+r.height;e.isBidiTable&&r.shiftWidgetForRtlTable(this.viewer.clientArea,e,r);_instanceof(this.viewer,rt)&&(sf.base.isNullOrUndefined(e.containerWidget)||!(e.containerWidget.childWidgets.indexOf(e)>=0)||_instanceof(e.containerWidget,ct)||(e.containerWidget.height+=r.height));this.updateHeightForRowWidget(n,!1,t,i,r,!1,u,f);n.cutFromTop(r.y+r.height)},n.prototype.updateRowHeightBySpannedCell=function(n,t,i){var e=1,r,u,f,o;if(0!==n.childWidgets.length&&0!==i){for(r=0;r<t.childWidgets.length;r++)u=t.childWidgets[r],e=sf.base.isNullOrUndefined(u)||sf.base.isNullOrUndefined(u.cellFormat)?e:u.cellFormat.rowSpan,this.updateSpannedRowCollection(e,t,u);if(!sf.base.isNullOrUndefined(t.ownerTable))for(r=0;r<t.ownerTable.spannedRowCollection.length;r++)if(t.ownerTable.spannedRowCollection.keys[r]===t.index){for(f=0;f<i;f++)o=n.childWidgets[f],this.updateRowHeight(o,t);t.ownerTable.spannedRowCollection.remove(t.ownerTable.spannedRowCollection.keys[r]);break}}else this.updateRowHeight(t,t)},n.prototype.updateRowHeight=function(n,t){for(var i,u,e=t.index,r=1,f=0;f<n.childWidgets.length;f++)i=n.childWidgets[f],(r=sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.cellFormat)?r:i.cellFormat.rowSpan,this.updateSpannedRowCollection(r,t,i),e-i.rowIndex==r-1)&&(u=i.y+i.height+i.margin.bottom-t.y,("Exactly"!==t.rowFormat.heightType||"Exactly"===t.rowFormat.heightType&&t.rowFormat.height>u)&&t.height<u&&(t.height=u))},n.prototype.updateSpannedRowCollection=function(n,t){n>1&&!sf.base.isNullOrUndefined(t.ownerTable)&&(t.ownerTable.spannedRowCollection.containsKey(t.index+n-1)||t.ownerTable.spannedRowCollection.add(t.index+n-1,t.index))},n.prototype.updateRowHeightByCellSpacing=function(n,i,r){i.ownerTable.tableFormat.cellSpacing>0&&n.length>1&&i.y===r.clientArea.y&&_instanceof(r,rt)&&(i.height=i.height-t.convertPointToPixel(i.ownerTable.tableFormat.cellSpacing)/2)},n.prototype.isRowSpanEnd=function(n){for(var t,u=n.index,i=1,r=0;r<this.documentHelper.splittedCellWidgets.length;r++)if(t=this.documentHelper.splittedCellWidgets[r],i=sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.cellFormat)?i:t.cellFormat.rowSpan,u-t.rowIndex==i-1)return!0;return!1},n.prototype.isVerticalMergedCellContinue=function(n){for(var r,t=0,i=0;i<n.childWidgets.length;i++){if(r=n.childWidgets[i],t<r.columnIndex)return!0;t+=r.cellFormat.columnSpan}return t<n.ownerTable.tableHolder.columns.length},n.prototype.splitWidgets=function(n,t,i,r,u,f){if(this.isFirstLineFitForRow(t.clientArea.bottom,n)&&n.childWidgets.length>0){if(u=this.getSplittedWidgetForRow(t.clientArea.bottom,i,r,n),this.documentHelper.splittedCellWidgets.length>0||u!==n){if(f)for(var e=0;e<u.childWidgets.length;e++)u.childWidgets[e].rowIndex!==u.index&&(u.childWidgets.splice(e,1),e--);this.insertSplittedCellWidgets(t,i,u,n.index-1)}}else this.insertSplittedCellWidgets(t,i,u,n.index-1);return u},n.prototype.getSplittedWidgetForRow=function(n,t,i,r){var f=void 0,v=r.index,c,o,e,u,s,h,l;for(this.isRelayoutneed=!1,c=!1,o=0;o<r.childWidgets.length;o++)if(e=r.childWidgets[o],u=this.getSplittedWidget(n,!0,t,i,e),!sf.base.isNullOrUndefined(u)){if(u===e)return r;for(-1!==r.childWidgets.indexOf(u)&&r.childWidgets.splice(r.childWidgets.indexOf(u),1),(0===o||r.height<e.height+e.margin.top+e.margin.bottom)&&(r.height=e.height+e.margin.top+e.margin.bottom),sf.base.isNullOrUndefined(f)&&((f=new a).containerWidget=r.containerWidget,f.index=r.index,f.rowFormat=r.rowFormat,this.updateWidgetLocation(r,f),i.push(f)),s=1,s=sf.base.isNullOrUndefined(u)||sf.base.isNullOrUndefined(u.cellFormat)?s:u.cellFormat.rowSpan,v-u.rowIndex==s-1&&f.height<u.height+u.margin.top+u.margin.bottom?f.height=u.height+u.margin.top+u.margin.bottom:("Exactly"===r.rowFormat.heightType||"AtLeast"===r.rowFormat.heightType&&f.height<r.rowFormat.height)&&(f.height=r.rowFormat.height),f.childWidgets.push(u),u.containerWidget=f,this.isRelayoutneed=!0,h=o;h>0&&!c;)l=r.childWidgets[h-1],u=this.getSplittedWidget(n,!0,t,i,l),f.childWidgets.splice(0,0,u),u.containerWidget=f,h--;c=!0}return f},n.prototype.updateWidgetsToTable=function(n,i,r){var et,kt=this.getRowHeight(r,[r]),e=this.viewer,ot=r.rowFormat.isHeader,vt=void 0,b=r.rowFormat.allowBreakAcrossPages,c=r.rowFormat.heightType,tt=0,f=r,p=!1,st,l,o,w,v,s,yt,ht,ct,d,ut,ft,h,wt,lt,g,bt,at;for(this.isTableFootNote?(this.footHeight=f.bodyWidget.page.footnoteWidget.height,this.isTableFootNote=!1):this.footHeight=0,r.ownerTable.continueHeader&&!ot&&(r.ownerTable.continueHeader=!1),st=r.ownerTable.isInsideTable,l=!1,et=sf.base.isNullOrUndefined(r.ownerTable)||sf.base.isNullOrUndefined(r.ownerTable.tableFormat)?0:t.convertPointToPixel(r.ownerTable.tableFormat.cellSpacing);tt<i.length;){if(tt=i.length,this.isRowSpanEnd(r,e)&&"Exactly"===r.rowFormat.heightType&&1===this.documentHelper.splittedCellWidgets.length&&(this.documentHelper.splittedCellWidgets=[]),r.ownerTable.isInsideTable||0===this.documentHelper.splittedCellWidgets.length&&f.y+f.height+et+this.footnoteHeight<=e.clientArea.bottom)this.isVerticalMergedCellContinue(r)&&(f.y===e.clientArea.y||f.y===this.viewer.clientArea.y+f.ownerTable.headerHeight)&&this.insertSplittedCellWidgets(e,n,f,f.index-1),this.addWidgetToTable(e,n,i,f,void 0,st),this.documentHelper.splittedCellWidgets.length>0&&sf.base.isNullOrUndefined(i[i.length-1].nextRow)&&(tt--,l=!0),st=!1;else{if((st=!1,this.documentHelper.splittedCellWidgets.length>0&&f.y+f.height+this.footHeight<=e.clientArea.bottom)&&!this.isRowSpanEnd(r,e)){this.isVerticalMergedCellContinue(r)&&(f.y===e.clientArea.y||f.y===this.viewer.clientArea.y+f.ownerTable.headerHeight)&&this.insertSplittedCellWidgets(e,n,f,f.indexInOwner-1);this.addWidgetToTable(e,n,i,f);continue}if(o=f,w=n[n.length-1],kt+f.y+this.footHeight>e.clientArea.bottom)if(!b||ot&&r.ownerTable.continueHeader||"AtLeast"===c&&t.convertPointToPixel(r.rowFormat.height)<e.clientArea.bottom){if((("AtLeast"===c&&t.convertPointToPixel(r.rowFormat.height)<e.clientActiveArea.height&&b||"Exactly"!==c&&f.y===e.clientArea.y||"Auto"===c&&b)&&(o=this.splitWidgets(f,e,n,i,o,l)),"AtLeast"===c&&r.ownerTable.spannedRowCollection.keys.length>0&&(o=this.splitWidgets(f,e,n,i,o,l)),"AtLeast"===c&&t.convertPointToPixel(r.rowFormat.height)>e.clientActiveArea.height&&b&&f.ownerTable.tableHolder.columns.length>this.getTotalColumnSpan(f)&&(o=f=this.splitWidgets(f,e,n,i,o,l)),"Exactly"===c&&f.y===e.clientArea.y&&(this.addWidgetToTable(e,n,i,f),tt++),ot&&r.ownerTable.continueHeader)&&(r.ownerTable.header=!1,r.ownerTable.continueHeader=!1,r.ownerTable.headerHeight=0,v=void 0,_instanceof(e,rt)&&(v=this.documentHelper.pages),!sf.base.isNullOrUndefined(v)))for(s=0;s<v.length;s++)v[s].repeatHeaderRowTableWidget&&(v[s].repeatHeaderRowTableWidget=!1)}else"Auto"!==c&&"AtLeast"!==c||!b?"Exactly"===c&&f.y===e.clientArea.y&&(this.addWidgetToTable(e,n,i,f),tt++):t.convertPointToPixel(r.rowFormat.height)>e.clientArea.bottom&&f.y!==e.clientArea.y||(o=this.splitWidgets(f,e,n,i,o,l));else yt=!1,this.isVerticalMergedCellContinue(r)&&(b||(yt=f.y===e.clientArea.y||f.y===this.viewer.clientArea.y+f.ownerTable.headerHeight))?yt?this.insertSplittedCellWidgets(e,n,o,f.indexInOwner-1):o=this.splitWidgets(f,e,n,i,o,l):l&&!b&&(o=this.splitWidgets(f,e,n,i,o,l));if(!sf.base.isNullOrUndefined(o)){o!==f?(this.addWidgetToTable(e,n,i,f,f.nextRow),this.updateWidgetsToPage(n,i,r.ownerTable,f.nextRow),n.indexOf(f.containerWidget)+1>=n.length&&this.addTableWidget(e.clientActiveArea,n,!0),f=o):(r.index>0&&((this.updateWidgetsToPage(n,i,r.ownerTable,r),_instanceof(r.previousRenderedWidget,a))?(ht=r.previousRenderedWidget,t.round(f.y,2)===t.round(ht.y+ht.height,2)?n.indexOf(ht.containerWidget)+1>=n.length&&this.addTableWidget(e.clientActiveArea,n,!0):this.addTableWidget(e.clientActiveArea,n,!0)):this.addTableWidget(e.clientActiveArea,n,!0)),p=!0,tt--);w=n[n.length-1];ct=void 0;ct=n.length>1?n[n.length-2].containerWidget:r.ownerTable.previousRenderedWidget.containerWidget;sf.base.isNullOrUndefined(ct)||this.documentHelper.pages.indexOf(ct.page);var y=r,pt=!1,k=(r.ownerTable.containerWidget.index,void 0),it=void 0;if(it=p&&1===n.length?n[n.length-1]:n[n.length-2],d=!0,p&&1===i.length&&(ut=this.alignBlockElement(r),sf.base.isNullOrUndefined(ut.node)||(ft=ut.node,_instanceof(ft,a)&&0===ft.indexInOwner?n.length>1&&0===n[n.length-1].childWidgets.length&&(n.pop(),(w=n[n.length-1]).height=0):_instanceof(ut.node,u)&&(it=this.splitParagraph(ut.node,parseInt(ut.position.index,10)),n.length>1&&0===n[n.length-1].childWidgets.length&&(n.pop(),w=n[n.length-1]),d=!1),_instanceof(ft,a)&&((y=ft).ownerTable.equals(r.ownerTable)||(d=!1)),pt=!0)),k=this.moveBlocksToNextPage(_instanceof(it,u)?it.previousWidget:it),h=n[n.length-1],(p&&d&&0===y.index&&h.containerWidget&&-1!==h.containerWidget.childWidgets.indexOf(h)&&h.containerWidget.childWidgets.splice(h.containerWidget.childWidgets.indexOf(h),1),d&&(-1!==k.childWidgets.indexOf(h)&&k.childWidgets.splice(k.childWidgets.indexOf(h),1),k.childWidgets.unshift(h),this.shiftFloatingItemsFromTable(h,k)),h.containerWidget=k,p&&y.index>0||i.length>1)&&(wt=p?i[i.length-1]:i[i.length-2],pt&&(wt=y),this.moveNextWidgetsToTable(n,wt,!p),y=r),(pt&&this.updateClientPositionForBlock(d?h:it,r),p=!1,y.ownerTable.header&&f.height<e.clientArea.bottom)?(_instanceof(e,rt)&&(e.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget=!0),e.updateClientAreaForBlock(y.ownerTable,!0,n),o.x=o.x,o.y=w.y+y.ownerTable.headerHeight,lt=et/2,this.updateChildLocationForRow(w.y+y.ownerTable.headerHeight-lt,o)):(e.updateClientAreaForBlock(y.ownerTable,!0,n),o.x=o.x,o.y=w.y,lt=et/2,this.updateChildLocationForRow(w.y-lt,o)),d&&this.shiftedFloatingItemsFromTable.length>0){for(s=0;s<this.shiftedFloatingItemsFromTable.length;s++)g=this.shiftedFloatingItemsFromTable[s],bt=this.getFloatingItemPoints(g),g.y=bt.y,g.x=bt.x,_instanceof(g,nt)&&this.updateChildLocationForCellOrShape(g.y,g);this.shiftedFloatingItemsFromTable=[]}}l=!1}if(ot&&(r.ownerTable.continueHeader&&(r.ownerTable.header=!0,r.ownerTable.headerHeight=kt+r.ownerTable.headerHeight),vt=this.getHeader(r.ownerTable),!sf.base.isNullOrUndefined(vt)&&r.index===vt.index)&&(at=this.getHeaderHeight(r.ownerTable,r,i),(at>r.ownerTable.headerHeight||at>r.ownerTable.headerHeight)&&(r.ownerTable.headerHeight=at),r.ownerTable.headerHeight>e.clientArea.height))for(r.ownerTable.header=!1,r.ownerTable.continueHeader=!1,r.ownerTable.headerHeight=0,v=this.documentHelper.pages,s=0;s<v.length;s++)v[s].repeatHeaderRowTableWidget&&(v[s].repeatHeaderRowTableWidget=!1);n.length>2&&r.ownerTable.header&&f.height<e.clientActiveArea.bottom&&!e.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget&&(e.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget=!0)}},n.prototype.getHeader=function(n){var r=void 0,u=!0,t,i;for(n=n.getSplitWidgets()[0],t=0;t<n.childWidgets.length;t++)if(i=n.childWidgets[t],i.rowFormat.isHeader?r=i:u=!1,!u)break;return r},n.prototype.getHeaderHeight=function(n,t,i){var f=0,r,u;if(t.ownerTable.childWidgets.length>0&&n.childWidgets[0].rowFormat.isHeader)for(r=0;r<n.childWidgets.length;r++){if(u=n.childWidgets[r],!u.rowFormat.isHeader)break;f+=this.getRowHeight(u,i)}return f},n.prototype.updateWidgetToRow=function(n){var i=n.ownerRow,r;(n.containerWidget=i,!sf.base.isNullOrUndefined(n.ownerRow)&&"Exactly"!==n.ownerRow.rowFormat.heightType&&t.convertPointToPixel(n.ownerRow.rowFormat.height)>0&&0===n.cellIndex&&(i.height=i.height+t.convertPointToPixel(n.ownerRow.rowFormat.height)),1===n.cellFormat.rowSpan)&&(r=n.height+n.margin.top+n.margin.bottom,i.height-t.convertPointToPixel(n.ownerTable.tableFormat.cellSpacing)<r&&(i.height=r+t.convertPointToPixel(n.ownerTable.tableFormat.cellSpacing)))},n.prototype.updateHeightForRowWidget=function(n,i,r,u,f,e,o,s){for(var b,y,h,k,p,l,d,v,g,w=0;w<f.childWidgets.length;w++){for(y=0,h=void 0,(b=(h=f.childWidgets[w]).cellFormat.rowSpan,y=t.convertPointToPixel(h.ownerTable.tableFormat.cellSpacing),b>1)?(k=f.containerWidget.childWidgets.indexOf(f),p=k+b-1-(f.index-h.rowIndex),!s&&(n.clientArea.bottom<h.y+h.height+h.margin.bottom||p>=k+1)&&(1===u.length||u.length>=1&&f===u[u.length-1])&&this.splitSpannedCellWidget(h,r,u,n),l=f,p>0&&(p<f.containerWidget.childWidgets.length?(d=f.containerWidget.childWidgets[p],_instanceof(d,a)&&(l=d)===o&&(l=f)):l=f.containerWidget.childWidgets[f.containerWidget.childWidgets.length-1]),h.y+h.height+h.margin.bottom<l.y+l.height?h.height=l.y+l.height-h.y-h.margin.bottom:e&&l&&0!==l.y&&0!==l.height&&h.y+h.height+h.margin.bottom>l.y+l.height&&("Exactly"!==l.rowFormat.heightType||"Exactly"===l.rowFormat.heightType&&l.rowFormat.height>h.y+h.height+h.margin.bottom-l.y?l.height=h.y+h.height+h.margin.bottom-l.y:h.height=l.y-h.y+l.height)):(y>0&&r.length>1&&f.y===n.clientArea.y&&_instanceof(n,rt)&&(y/=2),h.height=f.height-h.margin.top-h.margin.bottom-y),this.updateHeightForCellWidget(n,r,u,h),v=f.containerWidget;_instanceof(v.containerWidget,gt);)v=v.containerWidget;g=void 0;_instanceof(v,c)&&(g=v.page);(_instanceof(n,rt)&&-1!==n.visiblePages.indexOf(g)||i)&&this.updateCellVerticalPosition(h,!1,h.ownerTable.isInsideTable)}},n.prototype.updateHeightForCellWidget=function(n,t,i,r){for(var u=0;u<r.childWidgets.length;u++)_instanceof(r.childWidgets[u],f)&&this.updateHeightForTableWidget(t,i,r.childWidgets[u])},n.prototype.getRowHeight=function(n,t){var i=0,r;if("Exactly"===n.rowFormat.heightType)i=n.rowFormat.height;else{for(r=0;r<t.length;r++)_instanceof(t[r],a)&&(i=t[r].height+i);i=Math.max(i,n.rowFormat.height)}return i},n.prototype.splitSpannedCellWidget=function(n,t,i,r){var u=this.getSplittedWidget(r.clientArea.bottom,!1,t,i,n);sf.base.isNullOrUndefined(u)||this.documentHelper.splittedCellWidgets.push(u)},n.prototype.insertSplittedCellWidgets=function(n,i,r,u){var c,f,e,s,l,o,h,a;if(!sf.base.isNullOrUndefined(r)){for(f=r.x,c=t.convertPointToPixel(r.ownerTable.tableHolder.tableWidth),e=0;e<r.childWidgets.length;e++){if(s=r.childWidgets[e],Math.round(f)<Math.round(s.x-s.margin.left)){if(this.insertRowSpannedWidget(r,n,f,e)){e--;continue}if(l=r.childWidgets.length,this.insertEmptySplittedCellWidget(r,i,f,e,u),l<r.childWidgets.length){if(0===e)break;e--;continue}}if(f+=s.margin.left+s.width+s.margin.right,e===r.childWidgets.length-1&&Math.round(f)<Math.round(r.x+c)){if(this.insertRowSpannedWidget(r,n,f,e+1))continue;this.insertEmptySplittedCellWidget(r,i,f,e+1,u)}}if((sf.base.isNullOrUndefined(r.childWidgets)||0===r.childWidgets.length)&&this.documentHelper.splittedCellWidgets.length>0)for(o=0;o<this.documentHelper.splittedCellWidgets.length;o++){if(h=this.documentHelper.splittedCellWidgets[o],Math.round(f)<=Math.round(h.x-h.margin.left)){if(this.insertRowSpannedWidget(r,n,f,o)){o--;continue}if(a=r.childWidgets.length,this.insertEmptySplittedCellWidget(r,i,f,o,u),a<r.childWidgets.length){o--;continue}}if(f+=h.margin.left+h.width+h.margin.right,o===r.childWidgets.length-1&&Math.round(f)<Math.round(r.x+c)){if(this.insertRowSpannedWidget(r,n,f,o+1))continue;this.insertEmptySplittedCellWidget(r,i,f,o+1,u)}}this.documentHelper.splittedCellWidgets.length>0&&(this.documentHelper.splittedCellWidgets=[])}},n.prototype.insertRowSpannedWidget=function(n,i,r,u){var o=0,e,f;for(n.ownerTable.tableFormat.cellSpacing>0&&(o=t.convertPointToPixel(n.ownerTable.tableFormat.cellSpacing)),e=0;e<this.documentHelper.splittedCellWidgets.length;e++)if(f=this.documentHelper.splittedCellWidgets[e],Math.round(r)===Math.round(f.x-f.margin.left))return n.childWidgets.splice(u,0,f),f.containerWidget=n,f.height>n.height&&(n.height=f.height),f.y!==n.y+f.margin.top+o&&this.updateChildLocationForRow(n.y,n),this.documentHelper.splittedCellWidgets.splice(e,1),!0;return!1},n.prototype.insertEmptySplittedCellWidget=function(n,t,i,r,u){for(var o,a,s,v,h,c,y,p,e,w,l=t[t.length-1],f=t.length-1;f>=0;f--)for(a=t[f],s=a.childWidgets.length-1;s>=0;s--)if(v=a.childWidgets[s],v.index===u){o=v;break}for(o&&(l=o.ownerTable,u=o.indexInOwner),h=u;h>=0;h--)for(c=l.childWidgets[h],y=c.x,f=0;f<c.childWidgets.length;f++){if(p=1,e=c.childWidgets[f],Math.round(i)===Math.round(y)&&(p=sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.cellFormat)?p:e.cellFormat.rowSpan)>1)return w=this.createCellWidget(e),n.childWidgets.splice(r,0,w),w.containerWidget=n,void this.updateChildLocationForRow(n.y,n);y+=e.margin.left+e.width+e.margin.right}},n.prototype.getSplittedWidget=function(n,t,i,r,f){var e=void 0,s,l,c,h,a,v,o;if(f.y+f.height>n-f.margin.bottom)for(s=0;s<f.childWidgets.length;s++)if(_instanceof(f.childWidgets[s],u)){if(l=f.childWidgets[s],c=this.getSplittedWidgetForPara(n-f.margin.bottom,l),!sf.base.isNullOrUndefined(c)){if(0===s&&c===l)return f;-1!==f.childWidgets.indexOf(c)&&(f.childWidgets.splice(f.childWidgets.indexOf(c),1),s--);f.height-=c.height;sf.base.isNullOrUndefined(e)&&(e=this.createCellWidget(f));e.height+=c.height;e.childWidgets.push(c);c.containerWidget=e}}else if(h=f.childWidgets[s],a=[h],n-f.margin.bottom<h.y+h.height&&(v=h.height,o=this.getSplittedWidgetForTable(n-f.margin.bottom,a,h),sf.base.isNullOrUndefined(o)&&!h.childWidgets[0].rowFormat.allowBreakAcrossPages&&(o=h),!sf.base.isNullOrUndefined(o))){if(0===s&&o===h)return f;-1!==f.childWidgets.indexOf(o)?(f.childWidgets.splice(f.childWidgets.indexOf(o),1),s--,f.height-=o.height):f.height-=v-h.height;sf.base.isNullOrUndefined(e)&&(e=this.createCellWidget(f));e.height+=o.height;e.childWidgets.push(o);o.containerWidget=e}return sf.base.isNullOrUndefined(e)&&t&&this.isRelayoutneed&&(e=this.createCellWidget(f)),e},n.prototype.getListLevelPattern=function(n){switch(n){case 0:return"Arabic";case 1:return"LowLetter";case 2:return"LowRoman";case 3:return"UpLetter";case 4:return"UpRoman";case 5:return"Ordinal";case 6:return"Number";case 7:return"OrdinalText";case 8:return"LeadingZero";case 9:return"Bullet";case 10:return"FarEast";case 11:return"Special";default:return"None"}},n.prototype.createCellWidget=function(n){var t=new s;return t.cellFormat=n.cellFormat,t.index=n.index,t.rowIndex=n.rowIndex,t.columnIndex=n.columnIndex,t.containerWidget=n.containerWidget,this.updateWidgetLocation(n,t),t.margin=n.margin,t.leftBorderWidth=n.leftBorderWidth,t.rightBorderWidth=n.rightBorderWidth,t},n.prototype.createTableWidget=function(n){var t=new f;return n.header&&(t.header=n.header,t.headerHeight=n.headerHeight),t.index=n.index,t.tableFormat=n.tableFormat,t.tableHolder=n.tableHolder,t.isGridUpdated=n.isGridUpdated,t.wrapTextAround=n.wrapTextAround,t.positioning=n.positioning,t.isContainInsideTable=n.isContainInsideTable,t},n.prototype.getSplittedWidgetForPara=function(n,t){for(var i,e=t.y,r=void 0,o=!1,f=0;f<t.childWidgets.length;f++){if(i=t.childWidgets[f],n<e+this.footHeight+i.height){if((t.paragraphFormat.keepLinesTogether&&(0!==t.index||0===t.index&&!sf.base.isNullOrUndefined(t.associatedCell.ownerRow.previousWidget))||t.paragraphFormat.widowControl&&1===f)&&(o=!0,f=0,i=t.childWidgets[0]),0===f){if(_instanceof(i.paragraph.containerWidget,s)&&!o&&i.paragraph.containerWidget.y===t.y){e+=i.height;continue}r=t;break}-1!==t.childWidgets.indexOf(i)&&(t.childWidgets.splice(t.childWidgets.indexOf(i),1),f--);t.height-=i.height;sf.base.isNullOrUndefined(r)?((r=new u).characterFormat=t.characterFormat,r.paragraphFormat=t.paragraphFormat,r.index=t.index,this.updateWidgetLocation(t,r),r.height=i.height):r.height+=i.height;r.childWidgets.push(i);i.paragraph=r}e+=i.height}return r},n.prototype.getSplittedWidgetForTable=function(n,t,i){for(var r,o,u,s,h=i.y,f=void 0,e=0;e<i.childWidgets.length;e++){if(o=(r=i.childWidgets[e]).height,(n<h+o||!sf.base.isNullOrUndefined(f))&&(u=void 0,s=!0,sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.rowFormat)||(s=r.rowFormat.allowBreakAcrossPages),s?u=sf.base.isNullOrUndefined(f)&&this.isFirstLineFitForRow(n,r)?this.getSplittedWidgetForRow(n,t,[r],r):r:sf.base.isNullOrUndefined(i.containerWidget.containerWidget.previousWidget)&&this.isFirstLineFitForRow(n,r)||i.isInsideTable&&!i.containerWidget.containerWidget.rowFormat.allowBreakAcrossPages?u=this.getSplittedWidgetForRow(n,t,[r],r):sf.base.isNullOrUndefined(i.containerWidget.containerWidget.previousWidget)||(u=r),!sf.base.isNullOrUndefined(u))){if(0===e&&u===r)return i;-1!==i.childWidgets.indexOf(u)?(i.childWidgets.splice(i.childWidgets.indexOf(u),1),e--,i.height-=u.height):i.height-=o-r.height;sf.base.isNullOrUndefined(f)?(f=this.createTableWidget(i),this.updateWidgetLocation(i,f),f.height=u.height):f.height+=u.height;f.childWidgets.push(u);u.containerWidget=f}h+=r.height}return f},n.prototype.isFirstLineFitForPara=function(n,t){var e=t.childWidgets[0],r=e.height,i,u;if(t.paragraphFormat.keepLinesTogether&&(r=t.height),i=e.paragraph.containerWidget,this.documentHelper.isFirstLineFitInShiftWidgets){if(this.viewer.clientActiveArea.y===this.viewer.clientArea.y&&t.y+r+this.footHeight>=n)return!0}else if(i.ownerTable.isInsideTable){if(u=void 0,_instanceof(i.containerWidget,a)&&_instanceof(i.containerWidget.containerWidget,f)&&_instanceof(i.containerWidget.containerWidget.containerWidget,s)&&(u=i.containerWidget.containerWidget.containerWidget),!sf.base.isNullOrUndefined(u)&&i.containerWidget.y===u.y&&t.y+r+this.footHeight>=n)return!0}else if(i.containerWidget.y===this.viewer.clientArea.y&&t.y+r+this.footHeight>=n)return!0;return t.y+r+this.footHeight<=n},n.prototype.isFirstLineFitForTable=function(n,t){var i,r=!1;return i=t.childWidgets[0],sf.base.isNullOrUndefined(i)||(r=this.isFirstLineFitForRow(n,i)),r},n.prototype.isFirstLineFitForRow=function(n,t){for(var r,i=0;i<t.childWidgets.length;i++)if(r=t.childWidgets[i],!this.isFirstLineFitForCell(n,r))return!1;return!0},n.prototype.isFirstLineFitForCell=function(n,t){var i,r;return 0===t.childWidgets.length?!0:_instanceof(t.childWidgets[0],u)?(i=t.childWidgets[0],this.isFirstLineFitForPara(n-t.margin.bottom,i)):(r=t.childWidgets[0],this.isFirstLineFitForTable(n-t.margin.bottom,r))},n.prototype.updateWidgetLocation=function(n,t){t.x=n.x;t.y=n.y;t.width=n.width},n.prototype.updateChildLocationForTable=function(n,t){for(var r,i=0;i<t.childWidgets.length;i++)r=t.childWidgets[i],r.y=n,this.updateChildLocationForRow(n,r),n+=r.height},n.prototype.updateChildLocationForRow=function(n,i){var f=0,u,r;for(i.ownerTable.tableFormat.cellSpacing>0&&(f=t.convertPointToPixel(i.ownerTable.tableFormat.cellSpacing)),u=0;u<i.childWidgets.length;u++)r=i.childWidgets[u],r.index=r.cellIndex,r.y=n+r.margin.top+f,this.updateChildLocationForCellOrShape(r.y,r)},n.prototype.updateChildLocationForCellOrShape=function(n,t){var r=t,i,e,s,h,o;for(_instanceof(t,nt)&&(r=t.textFrame),i=0;i<r.childWidgets.length;i++){if(r.childWidgets[i].x=r.childWidgets[i].x,r.childWidgets[i].y=n,_instanceof(r.childWidgets[i],f)&&this.updateChildLocationForTable(n,r.childWidgets[i]),_instanceof(r.childWidgets[i],u))for(e=r.childWidgets[i],s=0;s<e.childWidgets.length;s++)for(h=e.childWidgets[0],o=0;o<h.children.length;o++)if(_instanceof(h.children[o],yt)){if(!sf.base.isNullOrUndefined(e.bodyWidget.page.footnoteWidget))return;e.bodyWidget.previousRenderedWidget;var c=e.bodyWidget.previousRenderedWidget,l=e.bodyWidget,a=this.getFootNoteWidgetsOf(e);this.moveFootNotesToPage(a,c,l);this.layoutfootNote(e.bodyWidget.page.footnoteWidget)}n+=r.childWidgets[i].height}},n.prototype.updateCellVerticalPosition=function(n,t,i){var r=n.ownerTable.containerWidget,u;(_instanceof(r,ri)||_instanceof(r,et)||i)&&(u=this.getDisplacement(n,t),this.updateCellContentVerticalPosition(n,u,t))},n.prototype.updateCellContentVerticalPosition=function(n,t,i){var f,r,e;if(0!==t)for(f=n.y+t,r=0;r<n.childWidgets.length;r++)_instanceof(n.childWidgets[r],u)?(e=n.childWidgets[r],e.y=f,this.updateShapeInsideCell(e,t)):f=this.updateTableWidgetLocation(n.childWidgets[r],f,i),f+=n.childWidgets[r].height},n.prototype.updateShapeInsideCell=function(n,t){for(var i,r=0;r<n.floatingElements.length;r++)i=n.floatingElements[r],i.y+=t,_instanceof(i,nt)&&this.updateChildLocationForCellOrShape(i.y,i)},n.prototype.updateTableWidgetLocation=function(n,t,i){var u,r,f,e;for(n.y=t+=n.topBorderWidth,u=0;u<n.childWidgets.length;u++){for(r=n.childWidgets[u],r.y=t,f=0;f<r.childWidgets.length;f++)e=r.childWidgets[f],e.y=t+e.margin.top+0,this.updateCellVerticalPosition(e,i,!0);t+=r.height}return t},n.prototype.getDisplacement=function(n,t){var r=0,f=n.containerWidget,e=n.margin.top+n.margin.bottom,u,i;return r=!sf.base.isNullOrUndefined(n.cellFormat)&&n.cellFormat.rowSpan>1?n.height:(sf.base.isNullOrUndefined(f)?0:f.height)-e,u=this.getCellContentHeight(n,!0),i=0,r>u&&(i=r-u,"Center"===n.cellFormat.verticalAlignment?i/=2:("Top"===n.cellFormat.verticalAlignment||t)&&(i=0)),i},n.prototype.getCellContentHeight=function(n,t){var c,e,i;if(sf.base.isNullOrUndefined(n.childWidgets))return 0;for(var f=0,l=n.y,a=0,o=0,s=!1,h=!1,r=0;r<n.childWidgets.length;r++)if(_instanceof(n.childWidgets[r],u))for(c=n.childWidgets[r],f+=n.childWidgets[r].height,e=0;e<c.floatingElements.length;e++)s=!0,i=c.floatingElements[e],n.y+n.containerWidget.height>i.y+i.height&&i.y+i.height>o?(a=Math.abs(l-(i.y+i.height)),o=i.y+i.height,h=!1):h=!0;else f+=n.childWidgets[r].height;return l+f>o&&(s=!1),t&&s?a:t&&h?n.ownerRow.height:f},n.prototype.getTableLeftBorder=function(n){if(sf.base.isNullOrUndefined(n.left)){var t=new ft(n);return t.lineStyle="Single",t.lineWidth=.66,t}return n.left},n.prototype.getTableRightBorder=function(n){if(sf.base.isNullOrUndefined(n.right)){var t=new ft(n);return t.lineStyle="Single",t.lineWidth=.66,t}return n.right},n.prototype.getTableTopBorder=function(n){if(sf.base.isNullOrUndefined(n.top)){var t=new ft(n);return t.lineStyle="Single",t.lineWidth=.66,t}return n.top},n.prototype.getTableBottomBorder=function(n){if(sf.base.isNullOrUndefined(n.bottom)){var t=new ft(n);return t.lineStyle="Single",t.lineWidth=.66,t}return n.bottom},n.prototype.getCellDiagonalUpBorder=function(n){return n.cellFormat.borders.diagonalUp},n.prototype.getCellDiagonalDownBorder=function(n){return n.cellFormat.borders.diagonalDown},n.prototype.getTableWidth=function(n){for(var o,i=0,r=0;r<n.childWidgets.length;r++){for(var e=n.childWidgets[r],u=0,f=0;f<e.childWidgets.length;f++)o=e.childWidgets[f],u+=t.convertPointToPixel(o.cellFormat.cellWidth);i<u&&(i=u)}return i},n.prototype.layoutNextItemsBlock=function(n,i,r){var v=n.bodyWidget.sectionIndex,e=n,c=e.getSplitWidgets(),s=c[c.length-1].nextRenderedWidget,l,o,a,h;for((sf.base.isNullOrUndefined(s)||this.documentHelper.blockToShift===e)&&(this.documentHelper.blockToShift=void 0),l=!0;_instanceof(s,wt)&&s.bodyWidget.sectionIndex===v&&(sf.base.isNullOrUndefined(r)||!r||s.isLayouted||!this.isInitialLoad);){if(a=e.getSplitWidgets(),o=a[a.length-1],e=s,this.documentHelper.blockToShift===e&&(this.documentHelper.blockToShift=void 0),l=!1,h=e.getSplitWidgets()[0],0===this.documentHelper.fieldStacks.length&&!sf.base.isNullOrUndefined(h)&&o.containerWidget===h.containerWidget&&t.round(h.y,2)===t.round(o.y+o.height,2)){sf.base.isNullOrUndefined(this.documentHelper.blockToShift)?h.bodyWidget&&h.bodyWidget.floatingElements.length>0&&(this.documentHelper.blockToShift=e):this.documentHelper.blockToShift=e;break}if(l=!0,i.owner.isShiftingEnabled&&0===this.documentHelper.fieldStacks.length){this.documentHelper.blockToShift=e;break}!sf.base.isNullOrUndefined(this.viewer.owner.editorModule)&&this.viewer.owner.editorModule.isInsertingTOC||(e=e.combineWidget(this.viewer),o.containerWidget!==e.containerWidget&&(!_instanceof(o,u)||_instanceof(o,u)&&!o.isEndsWithPageBreak)&&this.updateContainerWidget(e,o.containerWidget,o.indexInOwner+1,!1),_instanceof(e,f)&&(this.clearTableWidget(e,!0,!0),e.isGridUpdated=!1),i.updateClientAreaForBlock(e,!0),_instanceof(this.viewer,at)&&(e.containerWidget.height-=e.height),this.documentHelper.layout.layoutBlock(e,0),i.updateClientAreaForBlock(e,!1));c=s.getSplitWidgets();s=c[c.length-1].nextRenderedWidget}i.owner.isShiftingEnabled&&this.documentHelper.blockToShift===e||this.viewer.owner.editorModule.updateListItemsTillEnd(e,l)},n.prototype.updateClientAreaForLine=function(n){n.marginTop=0;var t=this.documentHelper.selection.getTop(n),i=this.viewer.clientArea.x;this.viewer.cutFromTop(t);this.viewer.cutFromLeft(i)},n.prototype.getParentTable=function(n){for(var t=n;t.containerWidget;){if(_instanceof(t.containerWidget,ri)||_instanceof(t.containerWidget,et))return t;t=t.containerWidget}},n.prototype.reLayoutParagraph=function(n,t,i,r,u){if(_instanceof(n.containerWidget,et)&&"Inline"===n.containerWidget.containerShape.textWrappingStyle&&(t=n.containerWidget.containerShape.line.indexInOwner,n=n.containerWidget.containerShape.paragraph),this.isRelayout=!0,r=!sf.base.isNullOrUndefined(r)&&r,this.isRelayout=!0,this.documentHelper.blockToShift===n?(this.layoutBodyWidgetCollection(n.index,n.containerWidget,n,!1),this.isBidiReLayout=!0):this.isBidiReLayout&&(this.isBidiReLayout=!1),n.isInsideTable){if(this.isBidiReLayout=!0,this.reLayoutTable(n),this.isFootnoteContentChanged&&!sf.base.isNullOrUndefined(n.bodyWidget)&&!sf.base.isNullOrUndefined(n.bodyWidget.page.footnoteWidget)){var f=n.bodyWidget.page.footnoteWidget;this.layoutfootNote(f)}this.isBidiReLayout=!1}else this.reLayoutLine(n,t,r,u);_instanceof(n.bodyWidget,ct)&&-1!==n.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(n.bodyWidget,this.viewer)},n.prototype.getParentRow=function(n){for(var t=n;null!==t.ownerTable&&t.ownerTable.isInsideTable;)t=t.ownerTable.associatedCell;return t.ownerRow},n.prototype.reLayoutRow=function(n){var r,t,i,s,f,o,e,h;if(_instanceof(n,u)&&(n=n.associatedCell),r=this.getParentRow(n).getSplitWidgets()[0],sf.base.isNullOrUndefined(r)||r.ownerTable.tableFormat.allowAutoFit)this.currentCell=n,this.reLayoutTable(n),this.currentCell=void 0;else{for(t=r.ownerTable.getSplitWidgets()[0].combineWidget(this.viewer),i=r;this.isVerticalMergedCellContinue(i);){if(s=i.previousWidget,sf.base.isNullOrUndefined(s))break;i=s}f=t.containerWidget;_instanceof(this.viewer,at)&&(f.height-=t.height);!this.viewer.owner.enableHeaderAndFooter&&!n.isInHeaderFooter||_instanceof(f,et)?_instanceof(f,et)?this.viewer.updateClientAreaForTextBoxShape(f.containerShape,!0):this.viewer.updateClientArea(f.sectionFormat,f.page):(n.bodyWidget.isEmpty=!1,f.height-=t.height,this.viewer.updateHeaderFooterClientAreaWithTop(t.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(t),f.page));o=new b(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height);e=new b(o.x,o.y,o.width,o.height);this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&(h=this.documentHelper.selection.getFirstParagraphInFirstCell(t),this.viewer.owner.editorModule.updateWholeListItems(h));this.viewer.updateClientAreaForBlock(t,!0);this.viewer.cutFromTop(i.y);this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY;t.height=0;do{if(this.clearRowWidget(r,!0,!0,!0),this.layoutRow([t],r,!0),i===r)break;i=i.nextRow}while(i&&i!==r);this.updateChildLocationForTable(t.y,t);this.viewer.clientArea=e;this.viewer.clientActiveArea=new b(e.x,e.y,e.width,e.height);this.viewer.updateClientAreaForBlock(t,!0);t.x-=t.leftBorderWidth;t.y-=t.topBorderWidth;this.viewer.cutFromTop(t.y);this.shiftTableWidget(t,this.viewer,!0);this.layoutNextItemsBlock(t,this.viewer)}},n.prototype.reLayoutTable=function(n,t){var u=this.getParentTable(n),i=u.combineWidget(this.viewer),r=i.containerWidget,f,e;(_instanceof(this.viewer,at)&&(r.height-=i.height),!this.viewer.owner.enableHeaderAndFooter&&!n.isInHeaderFooter||_instanceof(r,et)?_instanceof(r,et)?this.viewer.updateClientAreaForTextBoxShape(r.containerShape,!0):this.viewer.updateClientArea(r.sectionFormat,r.page):(n.bodyWidget.isEmpty=!1,r.height-=i.height,this.viewer.updateHeaderFooterClientAreaWithTop(u.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(u),r.page)),this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule)&&(f=this.documentHelper.selection.getFirstParagraphInFirstCell(i),this.viewer.owner.editorModule.updateWholeListItems(f));this.viewer.updateClientAreaForBlock(i,!0);i.x-=i.leftBorderWidth;i.y-=i.topBorderWidth;e=this.getYPosition(i);this.viewer.cutFromTop(e);this.clearTableWidget(i,!0,!0,!0);this.isBidiReLayout=!0;this.layoutBlock(i,0);this.viewer.updateClientAreaForBlock(i,!1);this.layoutNextItemsBlock(i,this.viewer,t)},n.prototype.getYPosition=function(n){if(n.wrapTextAround){for(var t=n.previousWidget;t;){if(_instanceof(t,u))return t.y+t.height;if(_instanceof(t,f)){if(!t.wrapTextAround)return t.y+t.height;t=t.previousWidget}}return this.viewer.clientActiveArea.y}return n.y},n.prototype.clearTableWidget=function(n,t,i,r){var u,f;for(n.height=0,r&&(n.isGridUpdated=!1),t&&(n.y=0,n.x=0),u=0;u<n.childWidgets.length;u++)f=n.childWidgets[u],this.clearRowWidget(f,t,i,r)},n.prototype.clearRowWidget=function(n,t,i,r){var u,f;for(n.height=0,t&&(n.y=0,n.x=0),u=0;u<n.childWidgets.length;u++)f=n.childWidgets[u],this.clearCellWidget(f,t,i,r)},n.prototype.clearCellWidget=function(n,t,i,r){var f,e;for(n.height=0,t&&(n.y=0,n.x=0),f=0;f<n.childWidgets.length;f++)e=n.childWidgets[f],_instanceof(e,u)?i&&(e.height=0):this.clearTableWidget(e,t,i,r)},n.prototype.layoutBodyWidgetCollection=function(n,t,i,r,e){var o,h,c,a;if(!sf.base.isNullOrUndefined(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled)if(_instanceof(t,ri)||_instanceof(t,et)){if(o=this.checkAndGetBlock(t,n),sf.base.isNullOrUndefined(o))return;if(_instanceof(this.viewer,at)&&(o.containerWidget.height-=o.height),_instanceof(t,ct)?(t.isEmpty=!1,this.viewer.updateHeaderFooterClientAreaWithTop(t.sectionFormat,-1!==t.headerFooterType.indexOf("Header"),t.page),o.containerWidget.height-=o.height):_instanceof(t,et)?this.viewer.updateClientAreaForTextBoxShape(t.containerShape,!0):_instanceof(t,it)?"Footnote"===t.footNoteType&&(this.isRelayoutFootnote=!0,this.viewer.updateClientArea(t.sectionFormat,t.page,!0),this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY,o.containerWidget.height-=o.height,this.viewer.clientActiveArea.y=o.containerWidget.y):(sf.base.isNullOrUndefined(t.page.footnoteWidget)||t.page.footnoteWidget.footNoteType,this.viewer.updateClientArea(t.sectionFormat,t.page,!0)),n>0)if(h=o.getSplitWidgets()[0].previousRenderedWidget,_instanceof(h,u)&&(!_instanceof(h,u)||h.isEndsWithPageBreak))_instanceof(h,u)&&h.isEndsWithPageBreak&&h.containerWidget===o.containerWidget&&this.moveBlocksToNextPage(h);else if(this.viewer.cutFromTop(h.y+h.height),sf.base.isNullOrUndefined(e)&&o.containerWidget!==h.containerWidget){var v=o.containerWidget,l=h.containerWidget,y=this.getFootNoteWidgetsOf(o);this.updateContainerWidget(o,l,h.indexInOwner+1,!1);this.moveFootNotesToPage(y,v,l)}c=void 0;_instanceof(o=o.combineWidget(this.viewer),f)?(this.clearTableWidget(o,!0,!0),o.isGridUpdated=!1,c=this.documentHelper.selection.getFirstParagraphInFirstCell(o)):c=o;this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(c);this.viewer.updateClientAreaForBlock(o,!0);this.documentHelper.layout.layoutBlock(o,0);this.viewer.updateClientAreaForBlock(o,!1);r?this.shiftNextWidgets(o):this.layoutNextItemsBlock(o,this.viewer)}else _instanceof(t,s)&&(a=this.documentHelper.layout.getParentTable(t.ownerTable).getSplitWidgets()[0],this.reLayoutTable(t.ownerTable),this.layoutNextItemsBlock(a,this.viewer));this.isRelayoutFootnote=!1},n.prototype.checkAndGetBlock=function(n,t){var u,i,r;if(_instanceof(n,et))return n.childWidgets[t];for(u=n.index;n&&n.index===u;){if(n.childWidgets.length>0&&n.firstChild.index<=t&&n.lastChild.index>=t)for(i=0;i<n.childWidgets.length;i++)if(r=n.childWidgets[i],r.index===t)return r;if(!_instanceof(n,c))break;n=n.nextRenderedWidget}},n.prototype.layoutTable=function(n,i){var h,c,r,e,l,a,s,f,u,o;for(n.isBidiTable=n.bidi,n.isGridUpdated||(n.buildTableColumns(),n.isGridUpdated=!0),"Word2013"!==this.documentHelper.compatibilityMode&&(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-t.convertPointToPixel(n.firstChild.firstChild.leftMargin)),r=[n],this.addTableWidget(this.viewer.clientActiveArea,r),this.viewer.updateClientAreaTopOrLeft(n,!0),e=0,n.wrapTextAround?(h=this.viewer.clientActiveArea.clone(),c=this.viewer.clientArea.clone(),this.updateTableFloatPoints(n),l=this.viewer.clientActiveArea.clone(),a=this.adjustClientAreaBasedOnTextWrapForTable(n,this.viewer.clientActiveArea),l.x!==a.x&&(n.x=this.viewer.clientActiveArea.x)):(this.adjustClientAreaBasedOnTextWrapForTable(n,this.viewer.clientActiveArea),this.isWrapText&&(e=this.viewer.clientActiveArea.x-this.viewer.clientArea.x,this.isWrapText=!1,n.x=this.viewer.clientActiveArea.x)),s=n.childWidgets[0].rowFormat.isHeader,n.childWidgets.length>0&&(n.header=s,n.continueHeader=s,n.headerHeight=0),f=n.childWidgets[i];f;)f=(f=this.layoutRow(r,f)).nextRow;if(_instanceof(this.documentHelper.viewer,rt)&&n.wrapTextAround&&("Bottom"===n.positioning.verticalAlignment||"Center"===n.positioning.verticalAlignment||"Outside"===n.positioning.verticalAlignment)&&(this.updateTableFloatPoints(n),this.updateChildLocationForTable(n.y,n)),this.updateWidgetsToPage(r,[],n),e>0&&(this.viewer.clientArea.x=this.viewer.clientArea.x-e),n.wrapTextAround&&!n.isInsideTable&&n.bodyWidget)if(1==r.length)-1===n.bodyWidget.floatingElements.indexOf(n)&&n.bodyWidget.floatingElements.push(n),!sf.base.isNullOrUndefined(n.previousWidget)||n.isInHeaderFooter?(this.viewer.clientActiveArea=h.clone(),this.viewer.clientArea=c.clone()):this.viewer.updateClientArea(n.bodyWidget.sectionFormat,n.bodyWidget.page);else for(this.documentHelper.tableLefts.pop(),this.viewer.updateClientArea(n.bodyWidget.sectionFormat,n.bodyWidget.page),u=0;u<r.length;u++)o=r[u].bodyWidget,sf.base.isNullOrUndefined(o)||-1!==o.floatingElements.indexOf(r[u])||o.floatingElements.push(r[u]);return r[r.length-1].isLayouted=!0,"Word2013"!==this.documentHelper.compatibilityMode&&(this.viewer.clientArea.x=this.viewer.clientArea.x+t.convertPointToPixel(n.firstChild.firstChild.leftMargin)),r[r.length-1]},n.prototype.addTableWidget=function(n,i,r){var u=i[i.length-1];return r&&(u=this.createTableWidget(u),i.push(u)),u.width=n.width,u.x=n.x,u.y=n.y,u.tableFormat.cellSpacing>0&&(u.height=u.height+t.convertPointToPixel(u.tableFormat.cellSpacing),u.isBidiTable?(u.leftBorderWidth=t.convertPointToPixel(this.getTableRightBorder(u.tableFormat.borders).getLineWidth()),u.rightBorderWidth=t.convertPointToPixel(this.getTableLeftBorder(u.tableFormat.borders).getLineWidth())):(u.leftBorderWidth=t.convertPointToPixel(this.getTableLeftBorder(u.tableFormat.borders).getLineWidth()),u.rightBorderWidth=t.convertPointToPixel(this.getTableRightBorder(u.tableFormat.borders).getLineWidth())),u.topBorderWidth=t.convertPointToPixel(this.getTableTopBorder(u.tableFormat.borders).getLineWidth()),u.bottomBorderWidth=t.convertPointToPixel(this.getTableBottomBorder(u.tableFormat.borders).getLineWidth()),u.x+=u.leftBorderWidth,u.y+=u.topBorderWidth,u.width-=u.leftBorderWidth,u.width-=u.rightBorderWidth,u.height+=u.bottomBorderWidth),u},n.prototype.updateWidgetsToPage=function(n,i,r,u){var o=this.viewer,f=n[n.length-1],e;if(!r.isInsideTable){for(e=0;e<n.length;e++)this.updateHeightForTableWidget(n,i,n[e],u);f.childWidgets.length>0&&f.y!==f.childWidgets[0].y&&(f.y=f.childWidgets[0].y)}r.tableFormat.cellSpacing>0&&(f.y+f.height+t.convertPointToPixel(r.tableFormat.cellSpacing)>o.clientArea.bottom&&_instanceof(o,at)&&(f.height=f.height-t.convertPointToPixel(r.tableFormat.cellSpacing)/2),o.cutFromTop(f.y+f.height));_instanceof(this.viewer,at)&&(r.containerWidget.height+=r.height);_instanceof(r.bodyWidget,ct)&&(r.containerWidget.height+=r.height,this.viewer.owner.enableHeaderAndFooter&&-1!==r.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(r.bodyWidget,this.viewer))},n.prototype.updateHeightForTableWidget=function(n,t,i,r){for(var f,u=0;u<i.childWidgets.length;u++){if(f=i.childWidgets[u],f===r)break;this.updateHeightForRowWidget(this.viewer,!0,n,t,f,!0,r)}},n.prototype.layoutRow=function(n,t,i){var u=this.viewer,o=[t],e,r;this.addTableRowWidget(u.clientActiveArea,o);u.updateClientAreaForRow(t,!0);for(var s=this.getMaxTopCellMargin(t),h=this.getMaxBottomCellMargin(t),f=0;f<t.childWidgets.length;f++)e=t.childWidgets[f],this.layoutCell(e,s+t.topBorderWidth,h+t.bottomBorderWidth);return u.updateClientAreaForRow(t,!1),r=[t],i||this.updateWidgetsToTable(n,r,t),r[r.length-1]},n.prototype.getAdjacentRowCell=function(n,i,r,u){var c=[],f=n.ownerRow.ownerTable.childWidgets[u],o=!1,s;if(f)for(f.childWidgets[0].x>n.x&&0!==u&&(f=n.ownerRow.ownerTable.childWidgets[u-1],o=!0),s=0;s<f.childWidgets.length;s++){var e=f.childWidgets[s],l=e.x-e.margin.left,h=e.x+e.width+e.margin.right;if((t.round(h,2)>t.round(i,2)&&t.round(h,2)<=t.round(r,2)||t.round(l,2)>=t.round(i,2)&&t.round(l,2)<t.round(r,2)||t.round(l,2)<=t.round(i,2)&&t.round(h,2)>=t.round(r,2))&&-1===c.indexOf(e)&&c.push(e),t.round(h,2)>=t.round(r,2)){if(!o)break;f=n.ownerRow.ownerTable.childWidgets[u];o=!1}s===f.childWidgets.length-1&&o&&(f=n.ownerRow.ownerTable.childWidgets[u],o=!1)}return c},n.prototype.addTableRowWidget=function(n,i){var r=i[i.length-1],f,e,h,o,u,c,l,a;if(0===r.rowFormat.beforeWidth&&0===r.rowFormat.gridBeforeWidth||this.documentHelper.alignTablesRowByRow&&"Left"!==r.ownerTable.tableFormat.tableAlignment?r.x=n.x:r.x+=0!==r.rowFormat.beforeWidth?r.rowFormat.beforeWidth:r.rowFormat.gridBeforeWidth,r.y=n.y,r.width=n.width,f=0,!sf.base.isNullOrUndefined(r.ownerTable)&&!sf.base.isNullOrUndefined(r.ownerTable.tableFormat)&&r.ownerTable.tableFormat.cellSpacing>0){for(r.height=r.height+t.convertPointToPixel(r.ownerTable.tableFormat.cellSpacing),e=0;e<r.childWidgets.length;e++)sf.base.isNullOrUndefined(r.childWidgets[e].cellFormat)||sf.base.isNullOrUndefined(r.childWidgets[e].cellFormat.borders)||(h=s.getCellBottomBorder(r.childWidgets[e]).getLineWidth(),h>f&&(f=h));if(r.bottomBorderWidth=t.convertPointToPixel(f),r.index>0&&!sf.base.isNullOrUndefined(r.previousWidget)){for(o=r.previousWidget,f=0,u=0;u<o.childWidgets.length;u++)sf.base.isNullOrUndefined(o.childWidgets[u].cellFormat)||sf.base.isNullOrUndefined(o.childWidgets[u].cellFormat.borders)||(c=s.getCellBottomBorder(o.childWidgets[u]).getLineWidth(),c>f&&(f=c));r.topBorderWidth=t.convertPointToPixel(f)}}if(!sf.base.isNullOrUndefined(r.childWidgets))for(u=0;u<r.childWidgets.length;u++)sf.base.isNullOrUndefined(r.childWidgets[u].cellFormat)||sf.base.isNullOrUndefined(r.childWidgets[u].cellFormat.borders)||(l=s.getCellTopBorder(r.childWidgets[u]).getLineWidth(),l>f&&(f=l));if(r.topBorderWidth=t.convertPointToPixel(f),!sf.base.isNullOrUndefined(r.ownerTable)&&!sf.base.isNullOrUndefined(r.ownerTable.tableFormat)&&r.ownerTable.tableFormat.cellSpacing<=0&&r.rowIndex===r.ownerTable.childWidgets.length-1){for(u=0;u<r.childWidgets.length;u++)sf.base.isNullOrUndefined(r.childWidgets[u].cellFormat)||sf.base.isNullOrUndefined(r.childWidgets[u].cellFormat.borders)||(a=s.getCellBottomBorder(r.childWidgets[u]).getLineWidth(),a>f&&(f=a));r.bottomBorderWidth=t.convertPointToPixel(f)}return r},n.prototype.getMaxTopCellMargin=function(n){var i,r,u,f;if(sf.base.isNullOrUndefined(n.childWidgets))return 0;for(i=0,r=0;r<n.childWidgets.length;r++)u=n.childWidgets[r],f=0,(f=u.cellFormat.hasValue("topMargin")?t.convertPointToPixel(u.cellFormat.topMargin):n.rowFormat.hasValue("topMargin")?t.convertPointToPixel(n.rowFormat.topMargin):t.convertPointToPixel(n.ownerTable.tableFormat.topMargin))>i&&(i=f);return i},n.prototype.getMaxBottomCellMargin=function(n){var i,r,u,f;if(sf.base.isNullOrUndefined(n.childWidgets))return 0;for(i=0,r=0;r<n.childWidgets.length;r++)u=n.childWidgets[r],f=0,(f=u.cellFormat.hasValue("bottomMargin")?t.convertPointToPixel(u.cellFormat.bottomMargin):n.rowFormat.hasValue("bottomMargin")?t.convertPointToPixel(n.rowFormat.bottomMargin):t.convertPointToPixel(n.ownerTable.tableFormat.bottomMargin))>i&&(i=f);return i},n.prototype.layoutCell=function(n,t,i){var e=this.viewer,f,l,s,r,o,c,h;for((this.addTableCellWidget(n,e.clientActiveArea,t,i),this.updateTopBorders(n),e.updateClientAreaForCell(n,!0),0===n.childWidgets.length)&&(f=new u,f.characterFormat=new p,f.paragraphFormat=new ut,f.index=0,l=new k(f),f.childWidgets.push(l),n.childWidgets.push(f)),s=0;s<n.childWidgets.length;s++)for(r=n.childWidgets[s],e.updateClientAreaForBlock(r,!0),r.containerWidget=n,this.layoutBlock(r,0),e.updateClientAreaForBlock(r,!1),o=0;o<r.childWidgets.length;o++)if(_instanceof(r.childWidgets[o],k))for(c=r.childWidgets[o],h=0;h<c.children.length;h++){if(_instanceof(c.children[h],yt)&&!sf.base.isNullOrUndefined(n.bodyWidget.page.footnoteWidget)){this.footHeight=n.bodyWidget.page.footnoteWidget.height;this.isTableFootNote=!0;break}this.footHeight=0}this.updateWidgetToRow(n);e.updateClientAreaForCell(n,!1)},n.prototype.updateTopBorders=function(n){var i,s,r,c,e,o,l;if(n.updatedTopBorders=[],0===n.ownerTable.tableFormat.cellSpacing){i=n.cellFormat.borders.top;(!i.isBorderDefined||i.isBorderDefined&&"None"===i.lineStyle&&0===i.lineWidth&&i.hasValue("color"))&&(i=n.ownerRow.rowFormat.borders.horizontal);i.isBorderDefined||(i=n.ownerRow.ownerTable.tableFormat.borders.horizontal);for(var u=n.x-n.margin.left,f=n.x+n.width+n.margin.right,a=this.getAdjacentRowCell(n,u,f,n.ownerRow.indexInOwner-1),h=0;h<a.length;h++)s=a[h],r=s.cellFormat.borders.bottom,(!r.isBorderDefined||r.isBorderDefined&&"None"===r.lineStyle&&0===r.lineWidth&&r.hasValue("color"))&&(r=s.ownerRow.rowFormat.borders.horizontal),r.isBorderDefined||(r=s.ownerRow.ownerTable.tableFormat.borders.horizontal),c=void 0,c="None"===i.lineStyle||"Cleared"===i.lineStyle?r:"Cleared"===r.lineStyle||"None"===r.lineStyle?i:n.getBorderBasedOnPriority(i,r),e=s.x-s.margin.left,o=s.x+s.width+s.margin.right,(0===h&&u<e&&n.updatedTopBorders.push({border:i,width:e-u}),c)&&(l=0,(l=t.round(o,2)===t.round(f,2)&&t.round(e,2)===t.round(u,2)?f-u:t.round(e,2)>=t.round(u,2)&&t.round(o,2)>=t.round(f,2)?f-e:t.round(e,2)>=t.round(u,2)&&t.round(o,2)<=t.round(f,2)?o-e:t.round(e,2)<=t.round(u,2)&&t.round(o,2)<=t.round(f,2)?o-u:(t.round(e,2)<=t.round(u,2)&&(t.round(o,2),t.round(f,2)),f-u))<0&&(l=0),n.updatedTopBorders.push({border:c,width:l})),h===a.length-1&&f>o&&n.updatedTopBorders.push({border:i,width:f-o})}},n.prototype.shiftLayoutedItems=function(){var n,c,h,i,r;if(sf.base.isNullOrUndefined(this.documentHelper.blockToShift)||sf.base.isNullOrUndefined(this.documentHelper.blockToShift.containerWidget))this.documentHelper.blockToShift=void 0;else{n=this.documentHelper.blockToShift;c=n.bodyWidget.index;this.reLayoutOrShiftWidgets(n,this.viewer);for(var s=!0,e=n.getSplitWidgets(),o=e[e.length-1].nextRenderedWidget;_instanceof(o,wt)&&o.bodyWidget.index===c;){if(i=n.getSplitWidgets(),h=i[i.length-1],s=!1,r=void 0,i=(n=o).getSplitWidgets(),(_instanceof(n,u)||_instanceof(n,f))&&(r=i[0]),h.containerWidget===r.containerWidget&&t.round(r.y,2)===t.round(this.viewer.clientActiveArea.y,2)&&sf.base.isNullOrUndefined(r.nextWidget))break;sf.base.isNullOrUndefined(h.floatingElements);s=!0;this.reLayoutOrShiftWidgets(n,this.viewer);o=(e=n.getSplitWidgets())[e.length-1].nextRenderedWidget}this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateListItemsTillEnd(n,s);this.documentHelper.blockToShift=void 0;this.viewer;this.documentHelper.removeEmptyPages();this.updateFieldElements();this.viewer.updateScrollBars()}},n.prototype.updateFieldElements=function(){for(var n,u,t,f,i,e,o,r=0;r<this.documentHelper.fields.length;r++)n=this.documentHelper.fields[r],sf.base.isNullOrUndefined(this.documentHelper.selection)||(u=this.documentHelper.selection.getFieldCode(n),sf.base.isNullOrUndefined(u)||!(u.toLowerCase().match("numpages")||u.toLowerCase().match("sectionpages"))||sf.base.isNullOrUndefined(n.fieldSeparator)||(t=n.fieldSeparator.nextNode,sf.base.isNullOrUndefined(t)||(f=t.text,t.text=this.documentHelper.pages.length.toString(),i=n.line.paragraph,sf.base.isNullOrUndefined(i.bodyWidget)||sf.base.isNullOrUndefined(i.bodyWidget.page)||f===t.text||(e=i.childWidgets.indexOf(n.line),o=n.line.children.indexOf(t),this.reLayoutParagraph(i,e,o)))))},n.prototype.reLayoutOrShiftWidgets=function(n,t){var i=n,o,e,r;if(this.isNeedToRelayout(n.bodyWidget)?(this.updateContainerForTable(i,t),_instanceof(i,f)&&(i=i.combineWidget(this.viewer),this.clearTableWidget(i,!0,!0,!0)),t.updateClientAreaForBlock(i,!0),this.layoutBlock(i,0),t.updateClientAreaForBlock(i,!1)):this.shiftWidgetsBlock(i,t),this.documentHelper.pages.indexOf(i.bodyWidget.page)>0&&i===i.bodyWidget.childWidgets[0]&&_instanceof(i,u))for(o=i.bodyWidget.childWidgets[0].childWidgets[0].children,e=0;e<o.length;e++)r=o[e],r.margin.top>0&&r.margin.top===this.getBeforeSpacing(r.paragraph)&&(r.margin.top-=this.getBeforeSpacing(r.paragraph));this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateRenderedListItems(i);!this.isRelayoutFootnote&&i.bodyWidget.page.footnoteWidget&&this.layoutfootNote(i.bodyWidget.page.footnoteWidget);_instanceof(i.bodyWidget,it)||this.isRelayoutFootnote||!i.bodyWidget.page.endnoteWidget||this.layoutfootNote(i.bodyWidget.page.endnoteWidget)},n.prototype.isNeedToRelayout=function(n){for(var t,i=0;i<n.floatingElements.length;i++)return t=n.floatingElements[i],_instanceof(t,f)||_instanceof(t,lt)&&("Square"===t.textWrappingStyle||"TopAndBottom"===t.textWrappingStyle);return!1},n.prototype.shiftWidgetsBlock=function(n,t){_instanceof(n,u)?this.shiftWidgetsForPara(n,t):_instanceof(n,f)&&this.shiftWidgetsForTable(n,t)},n.prototype.shiftWidgetsForPara=function(n,t){var i,o,s,f,h,v,a,y,w;if(!(n.height>t.clientArea.height+t.clientArea.y))for(var p=this.getBodyWidgetOfPreviousBlock(n,0),r=p.bodyWidget,l=p.index,e=void 0,c=0;c<n.getSplitWidgets().length;c++){if(i=n.getSplitWidgets()[c],!sf.base.isNullOrUndefined(e)){if(o=!!e.lastChild&&e.lastChild.isEndsWithPageBreak,this.shiftToPreviousWidget(i,t,e,o),(sf.base.isNullOrUndefined(i.childWidgets)||0===i.childWidgets.length)&&!o){c--;continue}e=void 0;r!==i.containerWidget&&(r=i.containerWidget,o&&t.updateClientAreaByWidget(i))}if(s=this.getFootNoteWidgetsOf(i),this.isFitInClientArea(i,t,s)){if(this.keepWithNext&&(this.updateClientPositionForBlock(i.containerWidget.firstChild,i),this.keepWithNext=!1),e=i,i.y=t.clientActiveArea.y,i.floatingElements.length>0)for(f=0;f<i.floatingElements.length;f++)h=i.floatingElements[f],v=this.getFloatingItemPoints(h),h.y=v.y,h.x=v.x,_instanceof(h,nt)&&this.updateChildLocationForCellOrShape(h.y,h);if(t.cutFromTop(t.clientActiveArea.y+i.height),!sf.base.isNullOrUndefined(r)&&r!==i.containerWidget&&(l++,r.lastChild.isEndsWithPageBreak||this.updateContainerWidget(i,r,l,!0),s.length>0&&r.page.footnoteWidget))for(f=0;f<s.length;f++)r.page.footnoteWidget.childWidgets.push(s[f]),r.page.footnoteWidget.height+=s[f].height;i.isEndsWithPageBreak&&_instanceof(this.viewer,rt)&&(a=this.createOrGetNextBodyWidget(r,this.viewer),a=this.moveBlocksToNextPage(i),t.updateClientArea(a.sectionFormat,a.page))}else y=i.previousRenderedWidget,o=!1,_instanceof(y,u)&&y.isEndsWithPageBreak&&_instanceof(this.viewer,rt)&&(o=!0),w=this.splitWidget(i,t,r,l+1,o,s),e=void 0,r!==i.containerWidget&&(r=i.containerWidget,c--),l=r.childWidgets.indexOf(i),w&&(r=n.getSplitWidgets()[c+1].containerWidget)}},n.prototype.getFootNotesOfBlock=function(n){var i=[],t;if(n.childWidgets.length>0)for(t=0;t<this.documentHelper.footnoteCollection.length;t++)this.documentHelper.footnoteCollection[t].line.paragraph===n&&i.push(this.documentHelper.footnoteCollection[t]);return i},n.prototype.getFootNotesWidgetsInLine=function(n){for(var r,i=[],t=0;t<n.children.length;t++)r=n.children[t],_instanceof(r,yt)&&i.push(r);return this.getFootNoteWidgetsBy(n.paragraph,i)},n.prototype.getFootNoteWidgetsBy=function(n,t){var u=[],i,r;if(n.bodyWidget.page.footnoteWidget)for(i=0;i<n.bodyWidget.page.footnoteWidget.childWidgets.length;i++)for(r=0;r<t.length;r++)n.bodyWidget.page.footnoteWidget.childWidgets[i].footNoteReference===t[r]&&u.push(n.bodyWidget.page.footnoteWidget.childWidgets[i]);if(!sf.base.isNullOrUndefined(n.previousRenderedWidget)&&n.previousRenderedWidget.bodyWidget.page.footnoteWidget)for(i=0;i<n.previousRenderedWidget.bodyWidget.page.footnoteWidget.childWidgets.length;i++)for(r=0;r<t.length;r++)n.previousRenderedWidget.bodyWidget.page.footnoteWidget.childWidgets[i].footNoteReference===t[r]&&u.push(n.previousRenderedWidget.bodyWidget.page.footnoteWidget.childWidgets[i]);else if(!sf.base.isNullOrUndefined(n.bodyWidget.previousRenderedWidget)&&n.bodyWidget.previousRenderedWidget.page.footnoteWidget)for(i=0;i<n.bodyWidget.previousRenderedWidget.page.footnoteWidget.childWidgets.length;i++)for(r=0;r<t.length;r++)n.bodyWidget.previousRenderedWidget.page.footnoteWidget.childWidgets[i].footNoteReference===t[r]&&u.push(n.bodyWidget.previousRenderedWidget.page.footnoteWidget.childWidgets[i]);return u},n.prototype.getFootNoteWidgetsOf=function(n){var t=this.getFootNotesOfBlock(n),i=[];return t.length>0&&(i=this.getFootNoteWidgetsBy(n,t)),i},n.prototype.getFootNodeWidgetsToShiftToPage=function(n){for(var i,t,u,f=n.getSplitWidgets(),e=[],o=n.containerWidget,r=0;r<f.length;r++)for(i=this.getFootNoteWidgetsOf(f[r]),t=0;t<i.length;t++)o!==(u=i[t].containerWidget)&&e.push(i[t]);return{footNoteWidgets:e,fromBodyWidget:u,toBodyWidget:o}},n.prototype.shiftTableWidget=function(n,t,i){var r,u;for(void 0===i&&(i=!1),r=[n],this.addTableWidget(this.viewer.clientActiveArea,r),this.viewer.updateClientAreaTopOrLeft(n,!0),u=n.childWidgets[0];u;)u=(u=this.shiftRowWidget(r,u,i)).nextRow;return this.updateWidgetsToPage(r,[],n),r[r.length-1]},n.prototype.shiftRowWidget=function(n,t,i){var u,r,f,e;for(void 0===i&&(i=!1),u=this.viewer,i&&(t.height=0),r=[t],this.addTableRowWidget(u.clientActiveArea,r),u.updateClientAreaForRow(t,!0),f=0;f<t.childWidgets.length;f++)e=t.childWidgets[f],i&&(e.height=0),this.shiftCellWidget(e,this.getMaxTopCellMargin(t)+t.topBorderWidth,this.getMaxBottomCellMargin(t)+t.bottomBorderWidth,i);return u.updateClientAreaForRow(t,!1),this.updateWidgetsToTable(n,r,t),r[r.length-1]},n.prototype.shiftCellWidget=function(n,t,i,r){var f,o,e;for(sf.base.isNullOrUndefined(r)&&(r=!1),f=this.viewer,this.addTableCellWidget(n,f.clientActiveArea,t,i),f.updateClientAreaForCell(n,!0),o=0;o<n.childWidgets.length;o++)e=n.childWidgets[o],f.updateClientAreaForBlock(e,!0),_instanceof(e,u)?this.shiftParagraphWidget(e):this.shiftTableWidget(e,f,r),f.updateClientAreaForBlock(e,!1);this.updateWidgetToRow(n);f.updateClientAreaForCell(n,!1)},n.prototype.shiftParagraphWidget=function(n){this.addParagraphWidget(this.viewer.clientActiveArea,n);this.viewer.cutFromTop(this.viewer.clientActiveArea.y+n.height);sf.base.isNullOrUndefined(n.floatingElements);this.updateWidgetToPage(this.viewer,n)},n.prototype.updateContainerForTable=function(n,t){var r=this.getBodyWidgetOfPreviousBlock(n,0),i=r.bodyWidget,u=r.index,f=i.lastChild.lastChild.isEndsWithPageBreak;i!==n.containerWidget&&(f?t.updateClientArea(n.bodyWidget.sectionFormat,n.bodyWidget.page):this.updateContainerWidget(n,i,u+1,!0));(n.isInHeaderFooter||_instanceof(this.viewer,at))&&(n.containerWidget.height-=n.height)},n.prototype.shiftWidgetsForTable=function(n,i){var u,r;this.updateContainerForTable(n,i);this.viewer.updateClientAreaForBlock(n,!0);u=this.viewer.clientArea.x;"Word2013"!==this.documentHelper.compatibilityMode&&(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-t.convertPointToPixel(n.firstChild.firstChild.leftMargin));this.updateVerticalPositionToTop(n,!0);r=n.combineWidget(this.viewer);this.documentHelper.layout.updateChildLocationForTable(r.y,r);this.clearTableWidget(r,!0,!1);this.shiftTableWidget(r,this.viewer);this.updateVerticalPositionToTop(n,!1);"Word2013"!==this.documentHelper.compatibilityMode&&(this.viewer.clientArea.x=u);this.viewer.updateClientAreaForBlock(n,!1)},n.prototype.updateVerticalPositionToTop=function(n,t){for(var f,r,e,u,o,i=0;i<n.getSplitWidgets().length;i++)for(f=n.getSplitWidgets()[i],r=0;r<f.childWidgets.length;r++)for(e=f.childWidgets[r],u=0;u<e.childWidgets.length;u++)o=e.childWidgets[u],this.documentHelper.layout.updateCellVerticalPosition(o,t,!1)},n.prototype.splitWidget=function(n,t,i,r,f,e){var d=n.childWidgets[0],l=n.paragraphFormat.keepLinesTogether&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y?n.height:this.getMaxElementHeight(d),y=n.getSplitWidgets(),o=n.containerWidget,p,c,s,w,g,k,v,h;if(l=this.getMaximumLineHeightToSplit(n,l,t),p=this.getFootNotesWidgetsInLine(d),sf.base.isNullOrUndefined(n.previousWidget)&&p.length>0){for(c=0;c<p.length;c++)l+=p[c].height;l+=n.bodyWidget.page.footnoteWidget.childWidgets[0].height}if(t.clientActiveArea.height>=l&&!f){for(s=void 0,w=y.indexOf(n),(w<y.length-1?o=(s=y[w+1]).containerWidget:((s=new u).index=n.index,s.characterFormat=n.characterFormat,s.paragraphFormat=n.paragraphFormat,s.width=n.width,s.x=n.x,s.y=n.y,y.push(s)),i!==n.containerWidget)&&(g=n.containerWidget,-1===n.childWidgets.indexOf(this.documentHelper.selection.start.currentWidget)&&-1===n.childWidgets.indexOf(this.documentHelper.selection.end.currentWidget)||(this.updateContainerWidget(n,i,r,!0),this.moveFootNotesToPage(e,g,i))),c=n.childWidgets.length-1;c>0;c--){if(k=n.childWidgets[c],this.isFitInClientArea(n,t,void 0)){1===s.childWidgets.length&&this.updateParagraphWidgetInternal(k,s,0);break}this.updateParagraphWidgetInternal(k,s,0)}if(sf.base.isNullOrUndefined(s.containerWidget)&&s.childWidgets.length>0){var nt=t.clientActiveArea.y,tt=new b(t.clientArea.x,t.clientArea.y,t.clientArea.width,t.clientArea.height),it=new b(t.clientActiveArea.x,t.clientActiveArea.y,t.clientActiveArea.width,t.clientActiveArea.height);if((o=this.moveBlocksToNextPage(n)).childWidgets.splice(0,0,s),o.height+=s.height,s.containerWidget=o,o!=i&&(e=this.getFootNoteWidgetsOf(s),this.moveFootNotesToPage(e,i,o)),1===o.childWidgets.length&&_instanceof(o.firstChild,u)&&o.firstChild.equals(n))return n.y=nt,!0;t.clientArea=tt;t.clientActiveArea=it}}else(o=this.createOrGetNextBodyWidget(i,this.viewer),n.containerWidget!==o)?(v=n,h=this.alignBlockElement(n),sf.base.isNullOrUndefined(h.node)||(n=v=_instanceof(h.node,a)?this.splitRow(h.node):this.splitParagraph(h.node,parseInt(h.position.index,10)),this.keepWithNext=!0),o=this.moveBlocksToNextPage(n),this.updateContainerWidget(n,o,0,!0),sf.base.isNullOrUndefined(i.page.footnoteWidget)||this.moveFootNotesToPage(e,i,o)):!sf.base.isNullOrUndefined(i)&&sf.base.isNullOrUndefined(n.previousWidget)&&(this.updateContainerWidget(n,i,i.childWidgets.length,!1),v=n,h=this.alignBlockElement(n),sf.base.isNullOrUndefined(h.node)?this.updateContainerWidget(n,o,0,!0):(v=_instanceof(h.node,a)?this.splitRow(h.node):this.splitParagraph(h.node,parseInt(h.position.index,10)),this.keepWithNext=!0,o=this.moveBlocksToNextPage(v.previousWidget),this.updateClientPositionForBlock(n.previousWidget,n)));return i===n.containerWidget?(n.y=t.clientActiveArea.y,t.cutFromTop(t.clientActiveArea.y+n.height)):t.updateClientArea(o.sectionFormat,o.page),!1},n.prototype.getMaximumLineHeightToSplit=function(n,t,i){var f,r,u,e;if(i.clientActiveArea.height>=t&&!n.paragraphFormat.keepLinesTogether&&n.paragraphFormat.widowControl&&!sf.base.isNullOrUndefined(n.previousWidget)&&sf.base.isNullOrUndefined(n.previousSplitWidget))for(f=n.height,r=n.childWidgets.length-1;r>=0;r--){if(u=n.childWidgets[r],e=this.getMaxElementHeight(u),u.height>e&&(f-=u.height-e),i.clientActiveArea.height>=f){0===r&&(t=n.height);break}f-=u.height}return t},n.prototype.moveFootNotesToPage=function(n,t,i){if(n.length>0){for(var f=-1,r=void 0,e=1,u=0;u<n.length;u++)(r=n[u],(f=t.page.footnoteWidget.childWidgets.indexOf(r))>=0)&&((void 0===i.page.footnoteWidget&&this.addEmptyFootNoteToBody(i),t.page.footnoteWidget.childWidgets.splice(f,1),i.page.footnoteWidget.childWidgets.indexOf(r)<0)&&(i.page.footnoteWidget.childWidgets.push(r),1===i.page.footnoteWidget.childWidgets.length?(i.page.footnoteWidget.childWidgets.push(r),e++):i.page.footnoteWidget.childWidgets.splice(e++,0,r),i.page.footnoteWidget.height+=r.height),t.page.footnoteWidget.height-=r.height);t.page.footnoteWidget&&1===t.page.footnoteWidget.childWidgets.length&&(t.page.footnoteWidget=void 0)}},n.prototype.addEmptyFootNoteToBody=function(n){var i=new it,t,r;i.footNoteType="Footnote";i.page=n.page;t=new u;t.characterFormat=new p;t.paragraphFormat=new ut;t.index=0;r=new k(t);t.childWidgets.push(r);i.childWidgets.push(t);i.height=this.documentHelper.textHelper.getParagraphMarkSize(t.characterFormat).Height;n.page.footnoteWidget=i},n.prototype.getMaxElementHeight=function(n){var i=0,r,t;if(0===n.children.length||1===n.children.length&&_instanceof(n.children[0],o)||2===n.children.length&&_instanceof(n.children[0],o)&&_instanceof(n.children[1],o))(i=this.documentHelper.selection.getParagraphMarkSize(n.paragraph,0,0).height,i+=0,n.children.length>0)&&i<(t=n.children[0]).margin.top+t.height&&(i=t.margin.top+t.height);else for(r=0;r<n.children.length;r++)i<(t=n.children[r]).margin.top+t.height&&(i=t.margin.top+t.height);return i},n.prototype.createOrGetNextBodyWidget=function(n,t){var i,f=void 0,e,r,u;return i=this.documentHelper.pages.indexOf(n.page),r=void 0,(e=n.index,i===this.documentHelper.pages.length-1||this.documentHelper.pages[i+1].sectionIndex!==e)?(u=new c,u.sectionFormat=n.sectionFormat,u.index=n.index,r=t.createNewPage(u),this.documentHelper.pages[i+1].sectionIndex!==e&&this.documentHelper.insertPage(i+1,r),f=r.bodyWidgets[0]):f=(r=this.documentHelper.pages[i+1]).bodyWidgets[0],f},n.prototype.isFitInClientArea=function(n,t,i){var u=n.childWidgets[n.childWidgets.length-1],e=n.height,o=this.getMaxElementHeight(u),f,r;if(u.height>o&&(e-=u.height-o),f=0,!sf.base.isNullOrUndefined(i)&&i.length>0)for(r=0;r<i.length;r++)f+=i[r].height;return t.clientActiveArea.height>=e+f},n.prototype.isLineInFootNote=function(n,t){for(var i=0;i<t.length;i++)if(t[i].line===n)return!0;return!1},n.prototype.shiftToPreviousWidget=function(n,t,i,r){var s=n.containerWidget,c=i.containerWidget,f=[],u=[],h,e,a,l,o;for(c!==s&&(f=this.getFootNotesOfBlock(n)),h=0;h<n.childWidgets.length;h++){if(e=n.childWidgets[h],a=this.getMaxElementHeight(e),!(t.clientActiveArea.height>=a)||r){l=i.containerWidget;o=this.createOrGetNextBodyWidget(l,t);n.containerWidget!==o&&(o=this.moveBlocksToNextPage(n));l!==o&&((f=this.getFootNotesOfBlock(n)).length>0&&(u=u.concat(this.getFootNoteWidgetsBy(n,f)),c=o),this.updateContainerWidget(n,o,0,!0));t.updateClientArea(s.sectionFormat,s.page);break}if(f.length>0&&this.isLineInFootNote(e,f)&&(u=u.concat(this.getFootNoteWidgetsBy(e.paragraph,f))),this.updateParagraphWidgetInternal(e,i,i.childWidgets.length),h--,t.cutFromTop(t.clientActiveArea.y+e.height),sf.base.isNullOrUndefined(n.childWidgets))break}!sf.base.isNullOrUndefined(u)&&u.length>0&&s!=c&&this.moveFootNotesToPage(u,s,c)},n.prototype.updateParagraphWidgetInternal=function(n,t,i){sf.base.isNullOrUndefined(n.paragraph)||(n.paragraph.childWidgets.splice(n.paragraph.childWidgets.indexOf(n),1),n.paragraph.height-=n.height,sf.base.isNullOrUndefined(n.paragraph.containerWidget)||(n.paragraph.containerWidget.height-=n.height),(sf.base.isNullOrUndefined(n.paragraph.childWidgets)||0===n.paragraph.childWidgets.length)&&n.paragraph.destroyInternal(this.viewer));t.childWidgets.splice(i,0,n);n.paragraph=t;t.height+=n.height;sf.base.isNullOrUndefined(t.containerWidget)||(t.containerWidget.height+=n.height)},n.prototype.shiftNextWidgets=function(n){for(var t=n;_instanceof(t.nextWidget,wt);)t=t.nextWidget,this.reLayoutOrShiftWidgets(t,this.viewer)},n.prototype.updateContainerWidget=function(n,t,i,r){var e,o,s;if(!sf.base.isNullOrUndefined(n.containerWidget)&&(n.containerWidget.childWidgets.splice(n.containerWidget.childWidgets.indexOf(n),1),n.containerWidget.height-=t.height,(sf.base.isNullOrUndefined(n.containerWidget.childWidgets)||0===n.containerWidget.childWidgets.length)&&_instanceof(n.containerWidget,c)&&n.containerWidget!==t&&r)&&(e=n.containerWidget.page,this.documentHelper.pages[this.documentHelper.pages.length-1]===e&&-1!==this.viewer.visiblePages.indexOf(e)&&this.documentHelper.scrollToBottom(),(sf.base.isNullOrUndefined(e.nextPage)||e.nextPage.bodyWidgets[0].index!==n.containerWidget.index)&&n.containerWidget.destroyInternal(this.viewer)),t.childWidgets.splice(i,0,n),_instanceof(n,u)&&!sf.base.isNullOrUndefined(n.floatingElements))for(o=0;o<n.floatingElements.length;o++)s=n.floatingElements[o],"Inline"!==s.textWrappingStyle&&(t.floatingElements.push(s),n.bodyWidget.floatingElements.splice(n.bodyWidget.floatingElements.indexOf(s),1),t.floatingElements.sort(function(n,t){return n.y-t.y}));_instanceof(n,f)&&n.wrapTextAround&&-1!==n.bodyWidget.floatingElements.indexOf(n)&&n.bodyWidget.floatingElements.splice(n.bodyWidget.floatingElements.indexOf(n),1);t.height+=t.height;n.containerWidget=t},n.prototype.getBodyWidgetOfPreviousBlock=function(n,t){var r=void 0,i=n.previousRenderedWidget;return r=i&&i.containerWidget.equals(n.containerWidget)?i.containerWidget:n.containerWidget,t=i&&i.containerWidget.equals(n.containerWidget)?r.childWidgets.indexOf(i):n.containerWidget.childWidgets.indexOf(n),{bodyWidget:r,index:t}},n.prototype.moveBlocksToNextPage=function(n){var i=n.bodyWidget,s=i.page.index+1,e=void 0,r=void 0,h=!1,t,c,o;for(this.documentHelper.pages.length>s&&(0!==(e=this.documentHelper.pages[s]).bodyWidgets.length&&i.equals(e.bodyWidgets[0])?(r=e.bodyWidgets[0],this.viewer.updateClientArea(r.sectionFormat,r.page)):(e=void 0,h=!0)),sf.base.isNullOrUndefined(e)&&(r=this.createSplitBody(i),e=this.viewer.createNewPage(r,s),h&&this.documentHelper.insertPage(s,e),this.clearLineMeasures());;){if(t=void 0,t=_instanceof(i.lastChild,it)?i.lastChild.previousWidget:i.lastChild,c=this.getFootNoteWidgetsOf(t),this.moveFootNotesToPage(c,i,r),_instanceof(t,f)&&-1!==i.floatingElements.indexOf(t)&&i.floatingElements.splice(i.floatingElements.indexOf(t),1),_instanceof(t,u)&&t.floatingElements.length>0)for(o=0;o<t.floatingElements.length;o++)-1!==i.floatingElements.indexOf(t.floatingElements[o])&&i.floatingElements.splice(i.floatingElements.indexOf(t.floatingElements[o]),1),r.floatingElements.push(t.floatingElements[o]);if(n===t)break;i.childWidgets.splice(i.childWidgets.indexOf(t),1);r.childWidgets.splice(0,0,t);t.containerWidget=r;r.height+=t.height}return r},n.prototype.createSplitBody=function(n){var t=this.addBodyWidget(this.viewer.clientActiveArea);return t.sectionFormat=n.sectionFormat,t.index=n.index,t},n.prototype.reLayoutLine=function(n,i,r,f){var c,l,e,o,v,y,p,s,a,b,h;if(this.isFootnoteContentChanged=!1,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(n),c=n.paragraphFormat.listFormat&&-1!==n.paragraphFormat.listFormat.listId?n.getSplitWidgets()[0].firstChild:n.childWidgets[i],!this.isBidiReLayout&&(n.paragraphFormat.bidi||this.isContainsRtl(c)))for(l=i<=0?0:i-1;l<n.childWidgets.length;l++)(!r&&(n.paragraphFormat.bidi&&this.isContainsRtl(c)||f)||l!==i)&&this.reArrangeElementsForRtl(n.childWidgets[l],n.paragraphFormat.bidi);if(e=c.previousLine,sf.base.isNullOrUndefined(e)&&(e=c),e.paragraph,o=n.containerWidget,o.height-=n.height,!this.viewer.owner.enableHeaderAndFooter&&!n.isInHeaderFooter||_instanceof(o,et)?_instanceof(o,et)?this.viewer.updateClientAreaForTextBoxShape(o.containerShape,!0):this.viewer.updateClientArea(o.sectionFormat,o.page,!0):(n.bodyWidget.isEmpty=!1,this.viewer.updateHeaderFooterClientAreaWithTop(n.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(n),o.page)),this.viewer.updateClientAreaForBlock(n,!0),_instanceof(n.containerWidget,it))return this.isRelayoutFootnote=!1,v=n.height,y=n.y,this.layoutParagraph(n,0),this.viewer.updateClientAreaForBlock(n,!1),n.containerWidget.height+=v,n.y=0,"Footnote"===n.containerWidget.footNoteType&&this.viewer.updateFootnoteClientArea(n.containerWidget.sectionFormat,n.containerWidget),this.viewer.cutFromTop(y),void this.layoutParagraph(n,0);if(e.paragraph.isEmpty())this.viewer.cutFromTop(n.y),this.layoutParagraph(n,0);else{(this.updateClientAreaForLine(e),this.layoutListItems(e.paragraph),e.isFirstLine()&&!sf.base.isNullOrUndefined(n.paragraphFormat))&&(p=-t.convertPointToPixel(n.paragraphFormat.firstLineIndent),this.viewer.updateClientWidth(p));do n=(e=this.layoutLine(e,0)).paragraph,e=e.nextLine;while(e);this.updateWidgetToPage(this.viewer,n);this.viewer.updateClientAreaForBlock(n,!1)}if(this.layoutNextItemsBlock(n,this.viewer),s=n.getSplitWidgets()[0].previousRenderedWidget,!sf.base.isNullOrUndefined(s)&&(!_instanceof(s,u)||_instanceof(s,u)&&!s.isEndsWithPageBreak)&&(this.viewer.cutFromTop(n.y+n.height),n.containerWidget!==s.containerWidget&&!sf.base.isNullOrUndefined(s.containerWidget))){var k=n.containerWidget,w=s.containerWidget,d=this.getFootNoteWidgetsOf(n);sf.base.isNullOrUndefined(w.page.footnoteWidget)||this.moveFootNotesToPage(d,w,k)}b=this.documentHelper.pages.length;h=this.documentHelper.pages[b-1].bodyWidgets[0];this.isFootnoteContentChanged&&!sf.base.isNullOrUndefined(n.bodyWidget.page.footnoteWidget)&&(a=n.bodyWidget.page.footnoteWidget,this.layoutfootNote(a));this.isEndnoteContentChanged&&!sf.base.isNullOrUndefined(h.page.endnoteWidget)&&(a=h.page.endnoteWidget,this.viewer.cutFromTop(h.childWidgets[h.childWidgets.length-1].y+h.childWidgets[h.childWidgets.length-1].height),this.layoutfootNote(a))},n.prototype.isContainsRtl=function(n){for(var r=!1,t=0;t<n.children.length&&!(_instanceof(n.children[t],i)&&(r=n.children[t].characterFormat.bidi||"RTL"===n.children[t].characterFormat.bdo||this.documentHelper.textHelper.isRTLText(n.children[t].text)));t++);return r},n.prototype.reArrangeElementsForRtl=function(n,u){var f,y,b,g,w,k;if(0!==n.children.length){for(var c=!1,l=-1,h=[],a=0;a<n.children.length;a++){f=n.children[a];y=void 0;f.characterFormat&&(y=f.characterFormat);var p=!1,s="",d=!1;if(_instanceof(f,e))u?(c||0===f.bookmarkType&&f.nextElement&&_instanceof(f.nextElement.nextElement,i)&&this.documentHelper.textHelper.isRTLText(f.nextElement.nextElement.text)||1===f.bookmarkType&&_instanceof(f.nextElement,i)&&this.documentHelper.textHelper.isRTLText(f.nextElement.text)?h.splice(0,0,f):h.splice(c?l:l+1,0,f),l=h.indexOf(f)):h.push(f);else{if(_instanceof(f,i)){if(s=f.text,(d=this.documentHelper.textHelper.containsSpecialCharAlone(s.trim()))&&y.bidi&&u){for(s=t.reverseString(s),b=0;b<s.length;b++)g=this.documentHelper.textHelper.inverseCharacter(s.charAt(b)),s=s.replace(s.charAt(b),g);f.text=s}if(w=f.nextElement,_instanceof(f,i)&&this.documentHelper.textHelper.containsNumberAlone(f.text.trim())){for(;_instanceof(w,i)&&""!==w.text.trim()&&(this.documentHelper.textHelper.containsNumberAlone(w.text.trim())||this.documentHelper.textHelper.containsSpecialCharAlone(w.text.trim()));)f.text=f.text+w.text,f.line.children.splice(f.line.children.indexOf(w),1),w=f.nextElement;f.width=this.documentHelper.textHelper.getTextSize(f,f.characterFormat)}}(p=_instanceof(f,o)?u:this.documentHelper.textHelper.isRTLText(s)||y.bidi||"RTL"===y.bdo,(_instanceof(f,r)||this.isRtlFieldCode)&&(0===f.fieldType?this.isRtlFieldCode=!0:1===f.fieldType&&(this.isRtlFieldCode=!1),p=!1),p||sf.base.isNullOrUndefined(s)||""===s||(""===s||""!==s.trim())&&!d)||(k=n.children,y.bidi?c?p=!0:a+1<n.children.length&&_instanceof(n.children[a+1],i)&&(s=k[a+1].text,p=this.documentHelper.textHelper.isRTLText(s)||k[a+1].characterFormat.bidi||"RTL"===k[a+1].characterFormat.bdo):c&&(p=!0));f.isRightToLeft=p;p&&"LTR"!==y.bdo?c?h.splice(l,0,f):(u?h.splice(0,0,f):h.push(f),c=!0,l=h.indexOf(f)):c&&_instanceof(f,v)?y.bidi?h.splice(l+1,0,f):h.splice(l,0,f):(u?(c?h.splice(0,0,f):h.splice(l+1,0,f),l=h.indexOf(f)):h.push(f),c=!1)}}n.children=[];n.children=h}},n.prototype.shiftLayoutFloatingItems=function(n){for(var e,i,r=0;r<n.floatingElements.length;r++){var t=n.floatingElements[r],o=this.getFloatingItemPoints(t),s=o.y-t.y;if(t.x=o.x,t.y=o.y,_instanceof(t,nt))for(e=0;e<t.textFrame.childWidgets.length;e++)i=t.textFrame.childWidgets[e],_instanceof(i,u)?i.y=i.y+s:_instanceof(i,f)&&this.shiftChildLocationForTableWidget(i,s)}},n.prototype.getFloatingItemPoints=function(n){var i=n.line.paragraph,y=i.bodyWidget.sectionFormat,u=0,r=0;if(i){var p=t.convertPointToPixel(y.leftMargin),it=t.convertPointToPixel(y.rightMargin),f=t.convertPointToPixel(y.topMargin),c=y.bottomMargin>0?t.convertPointToPixel(y.bottomMargin):48,g=t.convertPointToPixel(y.headerDistance),ot=t.convertPointToPixel(y.footerDistance),k=t.convertPointToPixel(y.pageWidth),o=t.convertPointToPixel(y.pageHeight),rt=k-(p+it),ut=o-f-c;f=i.isInHeaderFooter&&y.topMargin<=0?Math.abs(f)>0?Math.abs(f):t.convertPointToPixel(y.headerDistance)+i.height:f>0?f:48;!i.isInHeaderFooter&&f<this.viewer.clientArea.y&&(f=this.viewer.clientArea.y);var w="InFrontOfText",tt=!1,a=n.verticalOrigin,ft=n.horizontalOrigin,l=n.horizontalAlignment,b=n.verticalAlignment,st=n.verticalRelativePercent,e=(n.horizontalRelativePercent,n.height),h=n.width,v=n.verticalPosition,s=n.horizontalPosition,ht=n.layoutInCell,et=void 0;if(_instanceof(n,nt)&&(et=n.autoShapeType),i.isInsideTable&&ht)tt=!0,r=this.getVerticalPosition(n,v,a,w),u=this.getHorizontalPosition(n.width,n,l,ft,s,w,i.associatedCell.cellFormat.cellWidth);else if(_instanceof(this.documentHelper.viewer,at)){switch(a){case"Line":r=this.documentHelper.selection.getTop(n.line);break;default:r=this.viewer.clientActiveArea.y}switch(ft){case"Character":u=this.viewer.clientActiveArea.x;break;default:switch(l){case"Center":u=this.viewer.clientArea.width/2-n.width/2;break;default:u=this.viewer.clientArea.x}}}else{switch(a){case"Page":case"TopMargin":switch(r=v,b){case"Top":r=v;break;case"Center":r="TopMargin"===a?(f-e)/2:(o-e)/2;break;case"Outside":case"Bottom":r="Page"===a&&"Bottom"===b?o-e:"TopMargin"===a?f-e:(i.bodyWidget.page.index+1)%2!=0?o-e-ot/2:g/2;break;case"Inside":"Page"===a?r=(i.bodyWidget.page.index+1)%2==0?o-e-ot/2:g/2:(i.bodyWidget.page.index+1)%2==0&&(r=(f-e)/2-g);break;case"None":r=Math.abs(st)<=1e3?o*(st/100):v}break;case"Line":switch(r=v,b){case"Inside":case"Top":r=this.viewer.clientActiveArea.y;break;case"Center":r=this.viewer.clientActiveArea.y-e/2;break;case"Outside":case"Bottom":r=this.viewer.clientActiveArea.y-e;break;case"None":r=Math.round(i.y)+v}break;case"BottomMargin":switch(r=v,b){case"Inside":case"Top":r=o-c;break;case"Center":r=o-c+(c-e)/2;break;case"Outside":case"Bottom":r=i.bodyWidget.page.index+1!==0&&"Outside"===b?o-c:o-e;break;case"None":r=o-c+v}break;case"InsideMargin":case"OutsideMargin":switch(r=v,b){case"Inside":r="InsideMargin"===a?"InsideMargin"===a&&i.bodyWidget.page.index+1===0?o-e:0:(i.bodyWidget.page.index+1)%2!=0?o-c:f-e;break;case"Top":r="InsideMargin"===a?(i.bodyWidget.page.index+1)%2==0?o-c:0:(i.bodyWidget.page.index+1)%2!=0?o-c:0;break;case"Center":r="OutsideMargin"===a?(i.bodyWidget.page.index+1)%2!=0?o-c+(c-e)/2:(f-e)/2:(i.bodyWidget.page.index+1)%2==0?o-c+(c-e)/2:(f-e)/2;break;case"Outside":r="InsideMargin"===a?(i.bodyWidget.page.index+1)%2==0?o-c:f-e:(i.bodyWidget.page.index+1)%2!=0?f-e:o-c;break;case"Bottom":r="OutsideMargin"===a?i.bodyWidget.page.index+1!==0?o-e:f-e:(i.bodyWidget.page.index+1)%2==0?o-e:f-e}break;case"Paragraph":r=Math.round(i.y)+0+v;break;case"Margin":switch(r=i.isInHeaderFooter&&g>f?g+i.height+v:f+v,b){case"Top":r=f;break;case"Center":r=f+(ut-e)/2;break;case"Outside":case"Bottom":r=(i.bodyWidget.page.index+1)%2!=0?f+ut-e:f;break;case"Inside":r=(i.bodyWidget.page.index+1)%2==0?f+ut-e:f}break;default:r=this.viewer.clientArea.y-v}switch(ft){case"Page":switch(u=s,l){case"Center":u=tt?(i.associatedCell.cellFormat.cellWidth-h)/2:(k-h)/2;break;case"Left":u=0;break;case"Outside":case"Right":u=tt?i.associatedCell.cellFormat.cellWidth-h:k-h;break;case"None":u=tt?i.associatedCell.x+s:s}u<0&&tt&&(u=i.associatedCell.x);break;case"Column":switch(u=this.viewer.clientActiveArea.x<i.x?i.x+s:"StraightConnector"===et||"Rectangle"===et?s+t.convertPointToPixel(y.leftMargin):i.x+s,l){case"Center":u=this.viewer.clientActiveArea.x+(this.viewer.clientActiveArea.width-h)/2;break;case"Left":u=this.viewer.clientActiveArea.x;break;case"Right":u=this.viewer.clientActiveArea.x+this.viewer.clientActiveArea.width-h}break;case"Margin":if(i.bodyWidget)switch(u=p+s,l){case"Center":u=p+(rt-h)/2;break;case"Left":u=p;break;case"Outside":(i.bodyWidget.page.index+1)%2!=0&&(u=p+rt-h);break;case"Right":u=p+rt-h;break;case"Inside":(i.bodyWidget.page.index+1)%2==0&&(u=p+rt-h)}else u=this.viewer.clientArea.x+s;break;case"Character":u="Right"===l||"Center"===l?this.getLeftMarginHorizPosition(p,l,s,h,w):this.viewer.clientArea.x+s;break;case"LeftMargin":u=this.getLeftMarginHorizPosition(p,l,s,h,w);break;case"RightMargin":u=this.getRightMarginHorizPosition(k,it,l,s,h,w);break;case"InsideMargin":u=(i.bodyWidget.page.index+1)%2==0?this.getRightMarginHorizPosition(k,it,l,s,h,w):this.getLeftMarginHorizPosition(p,l,s,h,w);break;case"OutsideMargin":u=(i.bodyWidget.page.index+1)%2==0?this.getLeftMarginHorizPosition(p,l,s,h,w):this.getRightMarginHorizPosition(k,it,l,s,h,w);break;default:u=this.viewer.clientArea.x+s}}}return new d(u,r)},n.prototype.getLeftMarginHorizPosition=function(n,t,i,r,u){var f=i;switch(t){case"Center":f=(n-r)/2;break;case"Left":f=0;break;case"Right":f=n-r}return f<0&&"InFrontOfText"!==u&&"Behind"!==u&&(f=0),f},n.prototype.getRightMarginHorizPosition=function(n,t,i,r,u,f){var o=n-t,e=o+r;switch(i){case"Center":e=o+(t-u)/2;break;case"Left":e=o;break;case"Right":e=n-u}return(e<0||e+u>n)&&"InFrontOfText"!==f&&"Behind"!==f&&(e=n-u),e},n.prototype.getVerticalPosition=function(n,t,i){var u=n.line.paragraph,r=0,f=u.associatedCell.y;switch(i){case"Page":case"Margin":case"TopMargin":case"InsideMargin":case"BottomMargin":case"OutsideMargin":r=f+t;break;case"Line":case"Paragraph":r=u.y+t+0;break;default:r=this.viewer.clientActiveArea.y+t}return r},n.prototype.getHorizontalPosition=function(n,t,i,r,u,f,e){var o=0,h=t.line.paragraph.associatedCell,l=e-h.leftMargin-h.rightMargin,a=h.cellFormat.cellWidth,s=h.x,c=s-h.leftMargin;switch(r){case"Page":switch(o=u,i){case"Center":o=c+(l-n)/2;break;case"Left":o=c;break;case"Right":o=c+(l-n);break;case"None":o=c+u}break;case"Column":case"Margin":switch(i){case"Center":o=s+(a-n)/2;break;case"Left":o=s;break;case"Right":o=s+(a-n);break;case"None":o=s+u}break;default:o=s+u}return o},n.prototype.updateTableFloatPoints=function(n){var r,e;if(n.wrapTextAround){var u=n.getTableCellWidth(),i=n.positioning,f=n.bodyWidget.sectionFormat;_instanceof(this.documentHelper.viewer,at)?"Margin"!==i.horizontalOrigin&&"Page"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||(this.viewer.clientActiveArea.x="Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientArea.width-u:this.viewer.clientArea.x):_instanceof(n.containerWidget,et)||n.isInsideTable?n.isInsideTable&&(r=n.containerWidget,e=r.cellFormat,"Page"===i.verticalOrigin?(this.viewer.clientActiveArea.y=r.y,this.viewer.clientActiveArea.y+=t.convertPointToPixel(i.verticalPosition)):"Margin"===i.verticalOrigin?(this.viewer.clientActiveArea.y=r.y,this.viewer.clientActiveArea.y+=r.topMargin,this.viewer.clientActiveArea.y+=t.convertPointToPixel(i.verticalPosition)):this.viewer.clientActiveArea.y+=t.convertPointToPixel(i.verticalPosition),"Page"===i.horizontalOrigin?"Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=r.x:"Right"!==i.horizontalAlignment&&"Outside"!==i.horizontalAlignment||(this.viewer.clientActiveArea.x=r.x+e.preferredWidth-u):"Margin"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||("Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=r.x+r.leftMargin:"Right"!==i.horizontalAlignment&&"Outside"!==i.horizontalAlignment||(this.viewer.clientActiveArea.x=r.x+e.preferredWidth-(u+r.rightMargin))),Math.round(i.horizontalPosition)>0&&(this.viewer.clientActiveArea.x=r.x,"Margin"===i.horizontalOrigin&&(this.viewer.clientActiveArea.x+=r.leftMargin),this.viewer.clientActiveArea.x+=t.convertPointToPixel(i.horizontalPosition)),"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=e.preferredWidth/2-u/2)):("Page"===i.verticalOrigin?"Top"===i.verticalAlignment||"Inside"===i.verticalAlignment?this.viewer.clientActiveArea.y=0:sf.base.isNullOrUndefined(i.verticalAlignment)&&(this.viewer.clientActiveArea.y=t.convertPointToPixel(i.verticalPosition)):"Margin"===i.verticalOrigin?"Top"===i.verticalAlignment||"Inside"===i.verticalAlignment?this.viewer.clientActiveArea.y=t.convertPointToPixel(f.topMargin):sf.base.isNullOrUndefined(i.verticalAlignment)&&(this.viewer.clientActiveArea.y=t.convertPointToPixel(f.topMargin)+t.convertPointToPixel(i.verticalPosition)):"Paragraph"===i.verticalOrigin&&sf.base.isNullOrUndefined(i.verticalAlignment)&&(this.viewer.clientActiveArea.y+=t.convertPointToPixel(i.verticalPosition)),"Page"===i.horizontalOrigin?"Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=0:("Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment)&&(this.viewer.clientActiveArea.x=t.convertPointToPixel(f.pageWidth)-u):"Margin"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||("Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=t.convertPointToPixel(f.leftMargin):("Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment)&&(this.viewer.clientActiveArea.x=t.convertPointToPixel(f.pageWidth)-(t.convertPointToPixel(f.rightMargin)+u))),Math.round(i.horizontalPosition)>0&&(this.viewer.clientActiveArea.x+=t.convertPointToPixel(i.horizontalPosition)),"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=t.convertPointToPixel(f.pageWidth)/2-u/2))}n.x=this.viewer.clientActiveArea.x;n.y=this.viewer.clientActiveArea.y},n.prototype.cropPosition=function(n){var i=0,r=0,t=n;t.isCrop=!0;0!==t.left&&(t.x=t.left*t.cropWidthScale/100);0!==t.top&&(t.y=t.top*t.cropHeightScale/100);0!==t.right&&(i=t.right*t.cropWidthScale/100);0!==t.bottom&&(r=t.bottom*t.cropHeightScale/100);t.cropWidth=t.cropWidthScale-(t.x+i);t.cropHeight=t.cropHeightScale-(t.y+r)},n.prototype.isTocField=function(n){if(_instanceof(n,r)){var t=n.nextNode;if(_instanceof(n,r)&&0===n.fieldType&&_instanceof(t,i)&&-1!==t.text.trim().toLowerCase().indexOf("toc"))return!0}return!1},n.prototype.getTotalColumnSpan=function(n){for(var i=n,r=0,t=0;t<i.childWidgets.length;t++)r+=i.childWidgets[t].cellFormat.columnSpan;return r},n.prototype.shiftFloatingItemsFromTable=function(n,t){var i,r;if(_instanceof(n.containerWidget,c))for(i=0;i<n.containerWidget.floatingElements.length;i++)r=n.containerWidget.floatingElements[i],_instanceof(r.paragraph.containerWidget,s)&&r.paragraph.containerWidget.ownerTable.containerWidget.ownerTable==n&&(t.floatingElements.push(n.containerWidget.floatingElements[i]),n.containerWidget.floatingElements.splice(n.containerWidget.floatingElements.indexOf(n.containerWidget.floatingElements[i]),1),this.shiftedFloatingItemsFromTable.push(r),i--)},n}(),rf=function(){function n(n){this.isPrinting=!1;this.pageLeft=0;this.pageTop=0;this.pageIndex=-1;this.isFieldCode=!1;this.leftPosition=0;this.topPosition=0;this.height=0;this.documentHelper=n}return Object.defineProperty(n.prototype,"pageCanvas",{get:function(){return this.isPrinting?(sf.base.isNullOrUndefined(this.pageCanvasIn)&&(this.pageCanvasIn=document.createElement("canvas"),this.pageCanvasIn.getContext("2d").save()),this.pageCanvasIn):sf.base.isNullOrUndefined(this.viewer)?void 0:this.documentHelper.containerCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"spellChecker",{get:function(){return this.documentHelper.owner.spellChecker},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionCanvas",{get:function(){if(!sf.base.isNullOrUndefined(this.viewer))return this.documentHelper.selectionCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageContext",{get:function(){return this.pageCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),n.prototype.renderWidgets=function(n,i,r,u,f){var o,e;if(!sf.base.isNullOrUndefined(this.pageCanvas)&&!sf.base.isNullOrUndefined(n)){for((this.pageContext.fillStyle=t.getColor(this.documentHelper.backgroundColor),this.pageContext.beginPath(),_instanceof(this.viewer,at))?(f=f>this.documentHelper.visibleBounds.height?f:this.documentHelper.visibleBounds.height,o=r,0===n.index&&(o=r-this.viewer.padding.top),this.pageContext.fillRect(i-this.viewer.padding.left,o,u+this.viewer.padding.left,f+this.viewer.padding.top)):this.pageContext.fillRect(i,r,u,f),this.pageContext.closePath(),_instanceof(this.viewer,rt)&&(this.pageContext.strokeStyle=this.documentHelper.owner.pageOutline,this.pageContext.strokeRect(i,r,u,f)),this.pageLeft=i,this.pageTop=r,this.pageIndex=n.index,this.isPrinting?this.setPageSize(n):(this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(i,r,u,f),this.pageContext.clip()),this.height=f,n.headerWidget&&this.renderHFWidgets(n,n.headerWidget,u,!0),n.footerWidget&&this.renderHFWidgets(n,n.footerWidget,u,!1),e=0;e<n.bodyWidgets.length;e++)this.render(n,n.bodyWidgets[e]),n.footnoteWidget&&"Pages"===this.documentHelper.owner.layoutType&&this.renderfootNoteWidget(n,n.footnoteWidget);n.endnoteWidget&&"Pages"===this.documentHelper.owner.layoutType&&this.renderfootNoteWidget(n,n.endnoteWidget);this.documentHelper.owner.enableHeaderAndFooter&&!this.isPrinting&&this.renderHeaderSeparator(n,this.pageLeft,this.pageTop,n.headerWidget);this.pageLeft=0;this.pageTop=0;this.pageContext.restore()}},n.prototype.setPageSize=function(n){this.pageContext.clearRect(0,0,this.pageCanvas.width,this.pageCanvas.height);this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height);this.pageContext.restore();this.selectionContext.restore();var i=n.boundingRectangle.width,r=n.boundingRectangle.height,t=Math.max(window.devicePixelRatio,this.documentHelper.owner.documentEditorSettings.printDevicePixelRatio);this.pageCanvas.width===i*t&&this.pageCanvas.height===r*t||(this.pageCanvas.height=r*t,this.pageCanvas.width=i*t,this.pageCanvas.style.height=r+"px",this.pageCanvas.style.width=i+"px",this.pageContext.globalAlpha=1,this.pageContext.scale(t,t))},n.prototype.renderHFWidgets=function(n,i,r,u){var a,s,v,f,h;this.isPrinting||(this.pageContext.globalAlpha=this.documentHelper.owner.enableHeaderAndFooter?1:.65);var c=!1,e=0,l=0,o=n.boundingRectangle.height/100*40;for(u?(a=t.convertPointToPixel(n.bodyWidgets[0].sectionFormat.topMargin),Math.max(i.y+i.height,a)>o&&(c=!0,this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.pageLeft,this.pageTop,r,this.getScaledValue(o)),this.pageContext.clip())):(s=t.convertPointToPixel(n.bodyWidgets[0].sectionFormat.footerDistance),v=n.boundingRectangle.height-Math.max(n.footerWidget.height+s,t.convertPointToPixel(n.footerWidget.sectionFormat.bottomMargin)),e=Math.max(n.boundingRectangle.height-o,v),l=n.boundingRectangle.height-s),this.renderFloatingItems(n,i.floatingElements,"Behind"),f=0;f<i.childWidgets.length;f++)h=i.childWidgets[f],u||(e+=h.height),(u||!u&&this.getScaledValue(Math.round(e))<=this.getScaledValue(Math.round(l)))&&this.renderWidget(n,h);this.renderFloatingItems(n,i.floatingElements,"InFrontOfText");c&&this.pageContext.restore();this.isPrinting||(this.pageContext.globalAlpha=this.documentHelper.owner.enableHeaderAndFooter?.65:1)},n.prototype.renderHeaderSeparator=function(n,i,r,u){var v=t.convertPointToPixel(n.bodyWidgets[0].sectionFormat.topMargin),s=this.getScaledValue(Math.max(u.y+u.height,v)),l=this.getScaledValue(n.boundingRectangle.width),f=this.pageContext,c,e,h,a,o;f.save();f.globalAlpha=.65;c=this.getScaledValue(n.boundingRectangle.height)/100*40;s=Math.min(s,c);this.renderDashLine(f,i,r+s,l,"#000000",!1);e=this.getHeaderFooterType(n,!0);f.font="9pt Arial";h=f.measureText(e).width;(this.renderHeaderFooterMark(f,i+5,r+s,h+10,20),this.renderHeaderFooterMarkText(f,e,i+10,s+r+15),n.footerWidget)&&(a=t.convertPointToPixel(n.bodyWidgets[0].sectionFormat.footerDistance),o=this.getScaledValue(n.boundingRectangle.height)-this.getScaledValue(Math.max(n.footerWidget.height+a,t.convertPointToPixel(n.footerWidget.sectionFormat.bottomMargin))),o=Math.max(this.getScaledValue(n.boundingRectangle.height)-c,o),this.renderDashLine(f,i,r+o,l,"#000000",!1),e=this.getHeaderFooterType(n,!1),h=f.measureText(e).width,this.renderHeaderFooterMark(f,i+5,r+o-20,h+10,20),this.renderHeaderFooterMarkText(f,e,i+10,r+o-5),f.restore())},n.prototype.getHeaderFooterType=function(n,t){var i;return i=t?"Header":"Footer",n.bodyWidgets[0].sectionFormat.differentFirstPage&&(sf.base.isNullOrUndefined(n.previousPage)||n.sectionIndex!==n.previousPage.sectionIndex)?i=t?"First Page Header":"First Page Footer":n.bodyWidgets[0].sectionFormat.differentOddAndEvenPages&&(i=(this.documentHelper.pages.indexOf(n)+1)%2==0?t?"Even Page Header":"Even Page Footer":t?"Odd Page Header":"Odd Page Footer"),i},n.prototype.renderDashLine=function(n,t,i,r,u,f){n.beginPath();n.strokeStyle=u;n.lineWidth=1;f?n.setLineDash([3,2]):n.setLineDash([6,4]);n.moveTo(t,i);n.lineTo(t+r,i);n.stroke();n.setLineDash([]);n.closePath()},n.prototype.renderSolidLine=function(n,t,i,r,u){n.beginPath();n.strokeStyle=u;n.lineWidth=.5;n.moveTo(t,i);n.lineTo(t+r,i);n.stroke();n.closePath()},n.prototype.renderHeaderFooterMark=function(n,t,i,r,u){n.beginPath();n.fillStyle="lightgray";n.fillRect(t,i,r,u);n.strokeStyle="black";n.strokeRect(t,i,r,u);n.closePath()},n.prototype.renderHeaderFooterMarkText=function(n,t,i,r){n.beginPath();n.fillStyle="#000000";n.textBaseline="alphabetic";n.fillText(t,i,r);n.closePath()},n.prototype.render=function(n,t){var i,r;for(this.isFieldCode&&(this.isFieldCode=!1),this.renderFloatingItems(n,n.bodyWidgets[0].floatingElements,"Behind"),i=0;i<t.childWidgets.length;i++)r=t.childWidgets[i],0===i&&_instanceof(t.childWidgets[0],f)&&t.childWidgets[0].childWidgets.length>0&&(t.childWidgets[0].childWidgets[0].rowFormat.isHeader||n.repeatHeaderRowTableWidget)&&this.renderHeader(n,r,this.documentHelper.layout.getHeader(t.childWidgets[0])),this.renderWidget(n,r);this.renderFloatingItems(n,n.bodyWidgets[0].floatingElements,"InFrontOfText")},n.prototype.renderFloatingItems=function(n,t,i){var u,r,e,o;if(!sf.base.isNullOrUndefined(t)&&t.length>0)for(t.sort(function(n,t){return _instanceof(n,f)||_instanceof(t,f)?0:n.zOrderPosition-t.zOrderPosition}),u=0;u<t.length;u++)_instanceof(t[u],f)||(r=t[u],"Behind"===i&&"Behind"!==r.textWrappingStyle||"Behind"!==i&&"Behind"===r.textWrappingStyle||(_instanceof(r,v)?this.renderImageElementBox(r,r.x,r.y,0):_instanceof(r,nt)&&(e=this.getScaledValue(r.x,1),o=this.getScaledValue(r.y,2),this.renderShapeElementBox(r,e,o,n))))},n.prototype.renderShapeElementBox=function(n,i,r,u){var e=0===n.height,h=n.autoShapeType,o=n.textFrame.childWidgets,s,f;for(this.pageContext.beginPath(),n.fillFormat&&n.fillFormat.color&&n.fillFormat.fill&&(this.pageContext.fillStyle=n.fillFormat.color,this.pageContext.fillRect(i,r,this.getScaledValue(n.width),this.getScaledValue(n.height))),sf.base.isNullOrUndefined(h)||(n.lineFormat.line&&"None"!==n.lineFormat.lineFormatType||!sf.base.isNullOrUndefined(n.lineFormat.lineFormatType)&&"None"!==n.lineFormat.lineFormatType)&&(this.pageContext.lineWidth=n.lineFormat.weight,this.pageContext.strokeStyle=t.getColor(n.lineFormat.color),this.pageContext.strokeRect(i,r,this.getScaledValue(n.width),this.getScaledValue(n.height))),this.pageContext.closePath(),s=!1,0!=n.width&&0!=n.height&&(s=!0,this.clipRect(n.x,n.y,this.getScaledValue(n.width),this.getScaledValue(n.height))),f=0;f<o.length;f++)this.renderWidget(u,o[f]),e&&"StraightConnector"!==h&&(n.height+=o[f].height);e&&(e=!1);s&&this.pageContext.restore()},n.prototype.renderWidget=function(n,t){_instanceof(t,u)?this.renderParagraphWidget(n,t):this.renderTableWidget(n,t)},n.prototype.renderHeader=function(n,t,i){var o,r,s,f;if(!sf.base.isNullOrUndefined(i)){n.viewer.updateClientArea(n.bodyWidgets[0].sectionFormat,n);for(var u=n.viewer.clientArea.y,h=i.ownerTable.getSplitWidgets()[0],e=0;e<=i.rowIndex;e++){if(0===h.childWidgets.length)return;for(o=h.childWidgets[e],r=o.clone(),r.containerWidget=o.containerWidget,n.viewer.updateClientAreaLocation(r,new b(n.viewer.clientArea.x,u,r.width,r.height)),n.documentHelper.layout.updateChildLocationForRow(u,r),s=void 0,f=0;f<r.childWidgets.length;f++)s=r.childWidgets[f],this.renderTableCellWidget(n,s);u+=r.height}t.y!==u&&n.documentHelper.layout.updateChildLocationForTable(u,t)}},n.prototype.renderParagraphWidget=function(n,t){for(var i,r=t.y,f=t.x,u=0;u<t.childWidgets.length;u++)i=t.childWidgets[u],r+=i.marginTop,this.renderLine(i,n,f,r),r+=i.height},n.prototype.renderfootNoteWidget=function(n,t){for(var r,f,u=0;u<t.childWidgets.length;u++)r=t.childWidgets[u],0!==u?(!sf.base.isNullOrUndefined(r.footNoteReference)&&_instanceof(r.childWidgets[0].children[0],i)&&(u<2||u>1&&r.footNoteReference!==t.childWidgets[u-1].footNoteReference)&&(r.childWidgets[0].children[0].text=r.childWidgets[0].children[0].text.replace(r.childWidgets[0].children[0].text,r.footNoteReference.text)),this.renderWidget(n,r)):(f=this.pageContext,this.renderSolidLine(f,this.getScaledValue(r.x,1),this.getScaledValue(r.y+r.height/2,2),300*this.documentHelper.zoomFactor,"#000000"))},n.prototype.renderTableWidget=function(n,t){var i,r;if(!this.isFieldCode)for(i=0;i<t.childWidgets.length;i++)r=t.childWidgets[i],this.renderTableRowWidget(n,r),t.tableFormat.cellSpacing>0&&this.renderTableOutline(t)},n.prototype.renderTableRowWidget=function(n,t){for(var r,i=0;i<t.childWidgets.length;i++)r=t.childWidgets[i],this.renderTableCellWidget(n,r)},n.prototype.renderTableCellWidget=function(n,t){var i,r,u;if(this.isPrinting||!(this.getScaledValue(t.y,2)+t.height*this.documentHelper.zoomFactor<0||this.getScaledValue(t.y,2)>this.documentHelper.visibleBounds.height))for(!this.isPrinting&&n.documentHelper.owner.selection&&n.documentHelper.owner.selection.selectedWidgets.length>0&&n.documentHelper.owner.selection.addSelectionHighlightTable(this.selectionContext,t),this.renderTableCellOutline(n.documentHelper,t),i=0;i<t.childWidgets.length;i++)r=t.childWidgets[i],u=t.width+t.margin.left+t.margin.right-t.leftBorderWidth,this.isPrinting||this.clipRect(t.x-t.margin.left,t.y,this.getScaledValue(u),this.getScaledValue(this.height)),this.renderWidget(n,r),this.pageContext.restore()},n.prototype.renderLine=function(n,u,f,e){var w,c,h,l,k,d,b,s,a,y,p,ut,ft;if(!this.isPrinting&&u.documentHelper.owner.selection&&!this.documentHelper.isScrollToSpellCheck&&u.documentHelper.owner.selection.selectedWidgets.length>0&&u.documentHelper.owner.selection.addSelectionHighlight(this.selectionContext,n,e),w=n.paragraph.paragraphFormat,n.isFirstLine()&&!w.bidi&&(f+=t.convertPointToPixel(w.firstLineIndent)),this.documentHelper&&this.documentHelper.selection&&!sf.base.isNullOrUndefined(this.documentHelper.selection.formFieldHighlighters)&&this.documentHelper.selection.formFieldHighlighters.containsKey(n)&&this.documentHelper.owner.documentEditorSettings&&this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading)for(c=u.documentHelper.selection.formFieldHighlighters.get(n),h=0;h<c.length;h++)this.pageContext.fillStyle=this.documentHelper.owner.documentEditorSettings.formFieldSettings.shadingColor,l=n.height,n.isLastLine()&&(l-=t.convertPointToPixel(this.documentHelper.layout.getAfterSpacing(n.paragraph)),n.paragraph.paragraphFormat.lineSpacing>1)&&(k=this.getFormfieldInLine(n),d=this.documentHelper.textHelper.getHeight(k.characterFormat).Height,l-=t.convertPointToPixel(this.documentHelper.layout.getLineSpacing(n.paragraph,d,!0))),this.pageContext.fillRect(this.getScaledValue(c[h].left,1),this.getScaledValue(e,2),this.getScaledValue(c[h].width),this.getScaledValue(l));if(this.documentHelper.owner.searchModule&&!sf.base.isNullOrUndefined(u.documentHelper.owner.searchModule.searchHighlighters)&&u.documentHelper.owner.searchModule.searchHighlighters.containsKey(n))for(c=u.documentHelper.owner.searchModule.searchHighlighters.get(n),h=0;h<c.length;h++)this.pageContext.fillStyle=this.viewer.owner.documentEditorSettings.searchHighlightColor,this.pageContext.fillRect(this.getScaledValue(c[h].left,1),this.getScaledValue(e,2),this.getScaledValue(c[h].width),this.getScaledValue(n.height));if(u.documentHelper.selection&&!sf.base.isNullOrUndefined(u.documentHelper.selection.editRegionHighlighters)&&u.documentHelper.selection.editRegionHighlighters.containsKey(n))for(c=u.documentHelper.selection.editRegionHighlighters.get(n),h=0;h<c.length;h++)this.pageContext.fillStyle=""!==c[h].color?c[h].color:"#add8e6",this.pageContext.fillRect(this.getScaledValue(c[h].left,1),this.getScaledValue(e,2),this.getScaledValue(c[h].width),this.getScaledValue(n.height));for(b=!1,h=0;h<n.children.length;h++)if(s=n.children[h],!(_instanceof(s,lt)&&"Inline"!==s.textWrappingStyle)){if((_instanceof(s,g)||_instanceof(s,ht))&&(a=0,_instanceof(this.viewer,rt)&&(a=this.viewer.pageGap),y="display:block;position:absolute;",_instanceof(s,g)&&0===s.commentType&&this.documentHelper.owner.selectionModule))if(this.documentHelper.owner.enableComment&&!b){b=!0;s.renderCommentMark();var tt=t.convertPointToPixel(u.bodyWidgets[0].sectionFormat.rightMargin),et=t.convertPointToPixel(u.bodyWidgets[0].sectionFormat.pageWidth),it=u.boundingRectangle.x+this.getScaledValue(et-tt+tt/4)+"px;";_instanceof(this.viewer,at)&&(it=u.boundingRectangle.width-2*this.viewer.padding.right-2*this.viewer.padding.left+"px;");y=y+"left:"+it+"top:"+(this.getScaledValue(e-10+(u.boundingRectangle.y-a*(u.index+1)))+a*(u.index+1)+"px;");s.commentMark.setAttribute("style",y)}else s.commentMark&&s.commentMark.setAttribute("style","display:none");_instanceof(s,r)||this.isFieldCode||0===s.width&&0===s.height?(this.isFieldCode&&(s.width=0),f+=s.width+s.margin.left,this.toSkipFieldCode(s)):(p=this.getUnderlineYPosition(n),!this.isPrinting&&(this.getScaledValue(e+s.margin.top,2)+s.height*this.documentHelper.zoomFactor<0||this.getScaledValue(e+s.margin.top,2)>this.documentHelper.visibleBounds.height)?(f+=s.width+s.margin.left,_instanceof(s,i)&&(s.canTrigger=!0,s.isVisible=!1,s.isSpellChecked&&!s.line.paragraph.isChangeDetected||(s.ischangeDetected=!0))):(_instanceof(s,o)?this.renderListTextElementBox(s,f,e,p):_instanceof(s,v)?this.renderImageElementBox(s,f,e,p):_instanceof(s,nt)?(ut=this.getScaledValue(f,1),ft=this.getScaledValue(e,2),this.renderShapeElementBox(s,ut,ft,u)):(s.isVisible=!0,f+=s.padding.left,this.renderTextElementBox(s,f,e,p)),f+=s.width+s.margin.left))}},n.prototype.toSkipFieldCode=function(n){_instanceof(n,r)&&(0===n.fieldType?sf.base.isNullOrUndefined(n.fieldEnd)&&!n.hasFieldEnd||(this.isFieldCode=!0):2!==n.fieldType&&1!==n.fieldType||(this.isFieldCode=!1))},n.prototype.getUnderlineYPosition=function(n){for(var i=0,u=0,t=0;t<n.children.length;t++)_instanceof(n.children[t],r)||0===n.children[t].width&&0===n.children[t].height||_instanceof(n.children[t],nt)||i<n.children[t].height+n.children[t].margin.top&&(i=n.children[t].margin.top+n.children[t].height,u=_instanceof(n.children[t],v)?.9:n.children[t].height/20);return i-2*u},n.prototype.renderListTextElementBox=function(n,i,r,u){var h=n.margin.top,w=n.margin.left,f=n.listLevel.characterFormat,e=n.line.paragraph.characterFormat,c=f.hasValue("fontColor")?f.fontColor:e.fontColor,b,k,v,o,l,d,a,y,s,p,g;this.pageContext.textBaseline="alphabetic";v=f.hasValue("fontFamily")?f.fontFamily:e.fontFamily;this.documentHelper.isIosDevice&&(""===n.text||""===n.text)&&(v="");o=f.hasValue("fontSize")?f.fontSize:e.fontSize;l=f.hasValue("baselineAlignment")?f.baselineAlignment:e.baselineAlignment;b=f.hasValue("bold")?f.bold?"bold":"":e.bold?"bold":"";k=f.hasValue("italic")?f.italic?"italic":"":e.italic?"italic":"";o=0===o?.5:o/("Normal"===l?1:1.5);o=this.isPrinting?o:o*this.documentHelper.zoomFactor;d=f.hasValue("strikethrough")?f.strikethrough:e.strikethrough;a=f.hasValue("highlightColor")?f.highlightColor:e.highlightColor;"NoColor"!==a&&(this.pageContext.fillStyle="#"!==a.substring(0,1)?t.getHighlightColorCode(a):t.getColor(a),this.pageContext.fillRect(this.getScaledValue(i+w,1),this.getScaledValue(r+h,2),this.getScaledValue(n.width),this.getScaledValue(n.height)));this.pageContext.font=b+" "+k+" "+o+"pt "+v;"Subscript"===l&&(h+=n.height-n.height/1.5);y=n.baselineOffset;h="Normal"===f.baselineAlignment?h+y:h+y/1.5;s=n.text;"\t"===s||" "===s||!(f.bidi||n.line.paragraph.paragraphFormat.bidi)||(p=s.indexOf("."),s=s.substr(p)+s.substring(0,p));"empty"===c||"#00000000"===c?(g=this.getBackgroundColorHeirachy(n),this.pageContext.fillStyle=this.getDefaultFontColor(g)):this.pageContext.fillStyle=t.getColor(c);this.pageContext.fillText(s,this.getScaledValue(i+w,1),this.getScaledValue(r+h,2),this.getScaledValue(n.width));"None"===f.underline||sf.base.isNullOrUndefined(f.underline)||this.renderUnderline(n,i,r,u,c,f.underline,l);"None"!==d&&this.renderStrikeThrough(n,i,r,f.strikethrough,c,l)},n.prototype.getDefaultFontColor=function(n){return t.isVeryDark(n)?"#FFFFFF":"#000000"},n.prototype.renderTextElementBox=function(n,i,u,f){var d=!1,o=n.line.paragraph.containerWidget,a,g,tt,e,w,l,it,rt,p,nt,ut,ft,c,v,et,b,k,y,ot,h;if(_instanceof(o,s)&&(d="Exactly"===o.ownerRow.rowFormat.heightType),a=n.margin.top,g=n.margin.left,d&&_instanceof(o,s)&&(tt=o.width+o.margin.left+o.margin.right-o.leftBorderWidth,this.clipRect(o.x-o.margin.left,o.y,this.getScaledValue(tt),this.getScaledValue(o.height))),e=n.characterFormat,"NoColor"!==e.highlightColor&&(this.pageContext.fillStyle="#"!==e.highlightColor.substring(0,1)?t.getHighlightColorCode(e.highlightColor):t.getColor(e.highlightColor),this.pageContext.fillRect(this.getScaledValue(i+g,1),this.getScaledValue(u+a,2),this.getScaledValue(n.width),this.getScaledValue(n.height))),w=this.checkRevisionType(n),l=w.length>0?this.getRevisionColor(w):e.fontColor,this.pageContext.textBaseline="alphabetic",p=11,it=e.bold?"bold":"",rt=e.italic?"italic":"",p=0===e.fontSize?.5:e.fontSize/("Normal"===e.baselineAlignment?1:1.5),p=this.isPrinting?p:p*this.documentHelper.zoomFactor,this.pageContext.font=it+" "+rt+" "+p+"pt "+e.fontFamily,"Subscript"===e.baselineAlignment&&(a+=n.height-n.height/1.5),nt=n.baselineOffset,(a="Normal"===e.baselineAlignment?a+nt:a+nt/1.5,"empty"===l||"#00000000"===l)?(ut=this.getBackgroundColorHeirachy(n),this.pageContext.fillStyle=this.getDefaultFontColor(ut)):this.pageContext.fillStyle=t.getColor(l),ft=this.getScaledValue(n.width),c=n.text,_instanceof(n,oi)&&(v=n,""!==v.tabText||sf.base.isNullOrUndefined(v.tabLeader)||"None"===v.tabLeader?""!==v.tabText&&(c=v.tabText):(c=this.getTabLeader(n),v.tabText=c)),et=e.bidi||this.documentHelper.textHelper.isRTLText(n.text),c=this.documentHelper.textHelper.setText(c,et,e.bdo,!0),e.allCaps&&(c=c.toUpperCase()),this.pageContext.fillText(c,this.getScaledValue(i+g,1),this.getScaledValue(u+a,2),ft),this.documentHelper.owner.isSpellCheck&&!this.spellChecker.removeUnderline&&(this.documentHelper.triggerSpellCheck||n.canTrigger)&&" "!==n.text&&!this.documentHelper.isScrollHandler&&(sf.base.isNullOrUndefined(n.previousNode)||!_instanceof(n.previousNode,r)))if(n.canTrigger=!0,this.leftPosition=this.pageLeft,this.topPosition=this.pageTop,b=this.spellChecker.checktextElementHasErrors(n.text,n,i),b.errorFound)for(l="#FF0000",k=0;k<b.elements.length;k++)y=b.elements[k],-1===n.ignoreOnceItems.indexOf(this.spellChecker.manageSpecialCharacters(y.text,void 0,!0))&&(ot=_instanceof(o,s)?o.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor,this.renderWavyLine(y,sf.base.isNullOrUndefined(y.start)?i:y.start.location.x,sf.base.isNullOrUndefined(y.start)?u:y.start.location.y-n.margin.top,f,l,"Single",e.baselineAlignment,ot));else(n.ischangeDetected||this.documentHelper.triggerElementsOnLoading)&&(n.ischangeDetected=!1,this.handleChangeDetectedElements(n,f,i,u,e.baselineAlignment));h=this.getRevisionType(w,!0);("None"===e.underline||sf.base.isNullOrUndefined(e.underline))&&(sf.base.isNullOrUndefined(h)||"Insertion"!==h.type&&"MoveTo"!==h.type)||this.renderUnderline(n,i,u,f,l,e.underline,e.baselineAlignment,h);h=this.getRevisionType(w,!1);("None"===e.strikethrough||sf.base.isNullOrUndefined(e.strikethrough))&&(sf.base.isNullOrUndefined(h)||"Deletion"!==h.type&&"MoveFrom"!==h.type)||this.renderStrikeThrough(n,i,u,e.strikethrough,l,e.baselineAlignment,h);d&&this.pageContext.restore()},n.prototype.getBackgroundColorHeirachy=function(n){var t,i;return n.paragraph.isInsideTable&&((i=n.paragraph.containerWidget,"empty"!==(t=i.cellFormat.shading.backgroundColor)&&"#00000000"!==t)||"empty"!==(t=i.ownerTable.tableFormat.shading.backgroundColor)&&"#00000000"!==t)?t:this.documentHelper.backgroundColor},n.prototype.handleChangeDetectedElements=function(n,t,i,r,u){var a=this,s=n.text.trim(),h=this.pageIndex,o,c,e,l,f,y;if("\v"!==n.text&&!this.spellChecker.checkElementCanBeCombined(n,t,h,!0))if(o=s.split(/[\s]+/),c=n.line.getOffset(n,0),o.length>1)for(e=0;e<o.length;e++)l=o[e],f=this.spellChecker.manageSpecialCharacters(l,void 0,!0),-1===this.spellChecker.ignoreAllItems.indexOf(f)&&-1===n.ignoreOnceItems.indexOf(f)&&(this.handleUnorderedElements(f,n,t,e,c,e===o.length-1,h),c+=l.length+1);else if(f=this.spellChecker.manageSpecialCharacters(s,void 0,!0),s.length>0&&-1===this.spellChecker.ignoreAllItems.indexOf(f)&&-1===n.ignoreOnceItems.indexOf(f)){var p=n.indexInOwner,w=n.line.paragraph.indexInOwner,v=this.spellChecker.checkSpellingInPageInfo(f);v.isElementPresent&&this.spellChecker.enableOptimizedSpellCheck?(y=JSON.parse('{"HasSpellingError":'+v.hasSpellError+"}"),this.spellChecker.handleWordByWordSpellCheck(y,n,i,r,t,u,!0)):this.documentHelper.owner.editor.triggerPageSpellCheck||this.spellChecker.callSpellChecker(this.spellChecker.languageID,s,!0,this.spellChecker.allowSpellCheckAndSuggestion).then(function(f){var e=JSON.parse(f),o=(h===a.pageIndex||n.isVisible)&&p===n.indexInOwner&&w===n.line.paragraph.indexInOwner;a.spellChecker.handleWordByWordSpellCheck(e,n,i,r,t,u,o)})}},n.prototype.handleUnorderedElements=function(n,t,i,r,u,f){var s=this,h=t.indexInOwner,c=t.line.paragraph.indexInOwner,e,o;n.length>0&&(e=this.spellChecker.checkSpellingInPageInfo(n),e.isElementPresent&&this.spellChecker.enableOptimizedSpellCheck?(o=JSON.parse('{"HasSpellingError":'+e.hasSpellError+"}"),this.spellChecker.handleSplitWordSpellCheck(o,n,t,!0,i,r,u,f)):this.documentHelper.owner.editor.triggerPageSpellCheck||this.spellChecker.callSpellChecker(this.spellChecker.languageID,n,!0,this.spellChecker.allowSpellCheckAndSuggestion).then(function(e){var o=JSON.parse(e),l=t.isVisible&&h===t.indexInOwner&&c===t.line.paragraph.indexInOwner;s.spellChecker.handleSplitWordSpellCheck(o,n,t,l,i,r,u,f)}))},n.prototype.renderWavyLine=function(n,t,i,r,u,f,e,s){if(n.text.length>1){var c=n.height/("Normal"===e?1:1.5),y=n.margin.top,h=0;"Subscript"===e||_instanceof(n,o)?(h=c-c/10+i,h+=(y+=n.height-c)>0?y:0):h=r+i;var l=this.spellChecker.getSpecialCharactersInfo(n.text,n.characterFormat),a=this.spellChecker.getWhiteSpaceCharacterInfo(n.text,n.characterFormat),v=(t+l.beginningWidth+(a.isBeginning?a.width:0)+n.margin.left)*this.documentHelper.zoomFactor+this.leftPosition,p=h*this.documentHelper.zoomFactor+this.topPosition,w=v+this.getScaledValue(n.width-(l.beginningWidth+l.endWidth)-a.width),b=new d(v,p),k=new d(w,p);this.drawWavy(b,k,.5*(w-v),1,.7,u,n.height,s)}},n.prototype.drawWavy=function(n,t,i,r,u,f,e,o){this.pageContext.save();this.pageContext.fillStyle=sf.base.isNullOrUndefined(o)?this.documentHelper.backgroundColor:o;this.pageContext.fillRect(n.x,n.y-r,t.x-n.x,3*r);this.pageContext.restore();this.pageContext.lineWidth=1;this.pageContext.lineCap="round";this.pageContext.strokeStyle=f;this.pageContext.beginPath();for(var c=0,l=0,a=n.x,v=n.y,y=t.x,p=t.y,s=0,w=0,h=Math.atan2(p-v,y-a),b=Math.sqrt((a-y)*(a-y)+(v-p)*(v-p)),k=1*r,d=Math.PI*i;s<=b;s+=u)w=Math.sin(s/b*d)*k,c=n.x+Math.cos(h)*s+Math.cos(h-Math.PI/2)*w,l=n.y+Math.sin(h)*s+Math.sin(h-Math.PI/2)*w,s>0?this.pageContext.lineTo(c,l):this.pageContext.moveTo(c,l);this.pageContext.stroke();this.pageContext.restore()},n.prototype.getTabLeader=function(n){var r,u=this.getTabLeaderString(n.tabLeader),t=u,f,i;for(r=this.documentHelper.textHelper.getWidth(t,n.characterFormat),f=Math.floor(n.width/r),i=0;i<=f;i++)t+=u;return t.slice(0,-1)},n.prototype.getTabLeaderString=function(n){var t="";switch(n){case"Dot":t=".";break;case"Hyphen":t="-";break;case"Underscore":t="_"}return t},n.prototype.clipRect=function(n,t,i,r){this.pageContext.beginPath();this.pageContext.save();this.pageContext.rect(this.getScaledValue(n,1),this.getScaledValue(t,2),i,r);this.pageContext.clip()},n.prototype.renderUnderline=function(n,r,u,f,e,s,h,c){var a=n.height/("Normal"===h?1:1.5),b=n.margin.top,y=a/20,l=0,k=a/20,p,w;for("Subscript"===h||_instanceof(n,o)?(l=a-2*y+u,l+=(b+=n.height-a)>0?b:0):l=f+u,p=0,sf.base.isNullOrUndefined(c)||(s="MoveTo"===c.type?"Double":"Single"),"Double"===s&&(l-=k),_instanceof(n,v)&&(y=.9);p<("Double"===s?2:1);)p++,w=n.width,_instanceof(n,i)&&!_instanceof(n,oi)&&sf.base.isNullOrUndefined(n.nextNode)&&(w=this.documentHelper.textHelper.getWidth(t.trimEnd(n.text),n.characterFormat)),this.pageContext.fillRect(this.getScaledValue(r+n.margin.left,1),this.getScaledValue(l,2),this.getScaledValue(w),this.getScaledValue(y)),l+=2*k},n.prototype.renderStrikeThrough=function(n,t,i,r,u,f,e){var s=n.height/("Normal"===f?1:1.5),h=n.margin.top;"Subscript"===f&&(h+=n.height-s);i+=h>0?h:0;var o=s/20,c=s/2+.5*o,l=0;for(sf.base.isNullOrUndefined(e)||(r="Deletion"===e.type?"SingleStrike":"DoubleStrike"),_instanceof(n,v)&&(o=.9),"DoubleStrike"===r&&(c-=o);l<("DoubleStrike"===r?2:1);)l++,this.pageContext.fillRect(this.getScaledValue(t+n.margin.left,1),this.getScaledValue(c+i,2),this.getScaledValue(n.width),this.getScaledValue(o)),c+=2*o},n.prototype.renderImageElementBox=function(n,i,r){var o=n.margin.top,h=n.margin.left,c=this.checkRevisionType(n),l=c.length>0?this.getRevisionColor(c):"black",v,w,e,b;this.pageContext.textBaseline="top";var y=0,a=!1,f=n.line.paragraph.containerWidget,p=!1;if((_instanceof(f,s)&&(p="Exactly"===f.ownerRow.rowFormat.heightType),"Inline"===n.textWrappingStyle)&&(o<0||n.line.paragraph.width<n.width?_instanceof(f,s)&&(v=0,_instanceof(f.childWidgets[0],u)&&(v=f.childWidgets[0].paragraphFormat.leftIndent),y=f.width+f.margin.left-f.leftBorderWidth-v,a=!0,this.clipRect(i+h,r+o,this.getScaledValue(y),this.getScaledValue(f.height))):p&&(w=f.width+f.margin.left-f.leftBorderWidth,a=!0,this.clipRect(f.x,f.y,this.getScaledValue(w),this.getScaledValue(f.height)))),n.isMetaFile&&!sf.base.isNullOrUndefined(n.metaFileImageString))this.pageContext.drawImage(n.element,this.getScaledValue(i+h,1),this.getScaledValue(r+o,2),this.getScaledValue(n.width),this.getScaledValue(n.height));else try{n.isCrop?this.pageContext.drawImage(n.element,this.getScaledValue(n.x),this.getScaledValue(n.y),n.cropWidth,n.cropHeight,this.getScaledValue(i+h,1),this.getScaledValue(r+o,2),this.getScaledValue(n.width),this.getScaledValue(n.height)):this.pageContext.drawImage(n.element,this.getScaledValue(i+h,1),this.getScaledValue(r+o,2),this.getScaledValue(n.width),this.getScaledValue(n.height))}catch(r){n.imageString="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC";this.pageContext.drawImage(n.element,this.getScaledValue(i+h,1),this.getScaledValue(r+o,2),this.getScaledValue(n.width),this.getScaledValue(n.height))}this.pageContext.fillStyle=t.getColor(l);e=this.getRevisionType(c,!1);(sf.base.isNullOrUndefined(e)||"Deletion"!==e.type&&"MoveFrom"!==e.type||this.renderStrikeThrough(n,i,r,"SingleStrike",l,"Normal",e),e=this.getRevisionType(c,!0),sf.base.isNullOrUndefined(e)||"Insertion"!==e.type&&"MoveTo"!==e.type)||(b=this.getUnderlineYPosition(n.line),this.renderUnderline(n,i,r,b,l,"Single","Normal"));a&&this.pageContext.restore()},n.prototype.renderTableOutline=function(n){var f=new dr(this.documentHelper),u=n,r,i;n.width=this.documentHelper.layout.getTableWidth(u);r=u.isBidiTable?f.getTableRightBorder(u.tableFormat.borders):f.getTableLeftBorder(u.tableFormat.borders);i=0;i=t.convertPointToPixel(r.getLineWidth());this.renderSingleBorder(r.color,n.x-n.margin.left-i/2,n.y,n.x-n.margin.left-i/2,n.y+n.height,i);r=f.getTableTopBorder(u.tableFormat.borders);i=0;i=t.convertPointToPixel(r.getLineWidth());this.renderSingleBorder(r.color,n.x-n.margin.left-i,n.y-i/2,n.x+n.width+i+n.margin.right,n.y-i/2,i);r=u.isBidiTable?f.getTableLeftBorder(u.tableFormat.borders):f.getTableRightBorder(u.tableFormat.borders);i=0;i=t.convertPointToPixel(r.getLineWidth());this.renderSingleBorder(r.color,n.x+n.width+n.margin.right+i/2,n.y,n.x+n.width+n.margin.right+i/2,n.y+n.height,i);r=f.getTableBottomBorder(u.tableFormat.borders);i=0;i=t.convertPointToPixel(r.getLineWidth());this.renderSingleBorder(r.color,n.x-n.margin.left-i,n.y+n.height-i/2,n.x+n.width+i+n.margin.right,n.y+n.height-i/2,i)},n.prototype.renderTableCellOutline=function(n,i){var h,rt,ct=n.layout,r=i,v=0,c=0,lt=0,p=i.ownerTable.isBidiTable,o,e,d,g,nt,b,l,tt,et,it,ht,wt;if(r.cellFormat.borders,_instanceof(i.containerWidget,a)&&(c=i.margin.bottom-i.containerWidget.bottomBorderWidth,v=i.margin.top-i.containerWidget.topBorderWidth),h=i.margin.left-i.leftBorderWidth,rt=i.margin.right-i.rightBorderWidth,lt=sf.base.isNullOrUndefined(r.ownerRow)||"Exactly"!==r.ownerRow.rowFormat.heightType?!sf.base.isNullOrUndefined(r.ownerRow)&&[r.ownerRow].length<=1?Math.max(t.convertPointToPixel(r.ownerRow.rowFormat.height),i.height)+v+c:i.height+v+c:t.convertPointToPixel(r.ownerRow.rowFormat.height)+v+c,o=p?s.getCellRightBorder(r):s.getCellLeftBorder(r),e=0,e=t.convertPointToPixel(o.getLineWidth()),this.renderCellBackground(lt,i,h,e),d=e,0===r.index||1===r.cellFormat.rowSpan||r.cellFormat.rowSpan>1&&0===r.columnIndex)this.renderSingleBorder(o.color,i.x-h-e,i.y-v,i.x-h-e,i.y+i.height+c,e);else for(g=0;g<r.ownerTable.childWidgets.length;g++){for(var w=r.ownerTable.childWidgets[g],u=void 0,y=0;y<w.childWidgets.length;y++){if(nt=w.childWidgets[y],nt.columnIndex+nt.cellFormat.columnSpan-1==r.columnIndex-1){u=nt;break}if(w.childWidgets[y].columnIndex>=r.columnIndex&&w.childWidgets[y].previousWidget){u=w.childWidgets[y].previousWidget;break}}if(u&&u.columnIndex+u.cellFormat.columnSpan-1==r.columnIndex-1){if(b=p?s.getCellLeftBorder(u):s.getCellRightBorder(u),l=b.lineWidth,u.y+u.height<r.y)continue;if(u.y<r.y&&u.y+u.height>r.y)this.renderSingleBorder(b.color,r.x-h-l,r.y-v,r.x-h-l,u.y+u.height+u.margin.bottom,l);else if(u.y===r.y||u.y>r.y&&u.y+u.height<r.y+r.height)this.renderSingleBorder(b.color,r.x-h-l,u.y-u.margin.top,r.x-h-l,u.y+u.height+u.margin.bottom,l);else if(u.y<r.y+r.height&&u.y+u.height>=r.y+r.height)this.renderSingleBorder(b.color,r.x-h-l,u.y-u.margin.top,r.x-h-l,u.y+r.height+c,l);else if(u.y>r.y+r.height)break}}if(r.updatedTopBorders&&r.updatedTopBorders.length>1)for(var ut=i.x-i.margin.left-d/2,at=i.y-i.margin.top,ft=0;ft<r.updatedTopBorders.length;ft++)tt=r.updatedTopBorders[ft],"None"!==(o=tt.border).lineStyle&&o.lineWidth<s.getCellTopBorder(r).lineWidth&&(o.lineWidth=s.getCellTopBorder(r).lineWidth),sf.base.isNullOrUndefined(o)||(e=t.convertPointToPixel(o.getLineWidth()),this.renderSingleBorder(o.color,ut,at+e/2,ut+tt.width,at+e/2,e),ut+=tt.width);else o=s.getCellTopBorder(r),e=t.convertPointToPixel(o.getLineWidth()),this.renderSingleBorder(o.color,i.x-i.margin.left-d/2,i.y-i.margin.top+e/2,i.x+i.width+i.margin.right+0,i.y-i.margin.top+e/2,e);et=!1;et=p?0===r.cellIndex:r.cellIndex===r.ownerRow.childWidgets.length-1;for(var vt=r.containerWidget.getPreviousRowSpannedCells(),yt=!1,ot=0;ot<vt.length;ot++)if(it=vt[ot],r.rowIndex<it.rowIndex+it.cellFormat.rowSpan&&r.columnIndex<it.columnIndex){yt=!0;break}(r.ownerTable.tableFormat.cellSpacing>0||et)&&(p||r.columnIndex+r.cellFormat.columnSpan===r.ownerTable.tableHolder.columns.length||!yt)&&(o=p?s.getCellLeftBorder(r):s.getCellRightBorder(r),e=t.convertPointToPixel(o.getLineWidth()),this.renderSingleBorder(o.color,i.x+i.width+i.margin.right-e/2,i.y-v,i.x+i.width+i.margin.right-e/2,i.y+i.height+c,e));var k=r.ownerRow.nextWidget,pt=!1,st=void 0;sf.base.isNullOrUndefined(k)||(k.lastChild&&(ht=k.lastChild,st=ht.columnIndex+ht.cellFormat.columnSpan),_instanceof(wt=k,a)&&_instanceof(i.containerWidget,a)&&_instanceof(i.containerWidget.containerWidget,f)&&(pt=-1!==i.containerWidget.containerWidget.childWidgets.indexOf(wt)));(r.ownerTable.tableFormat.cellSpacing>0||r.ownerRow.rowIndex===r.ownerTable.childWidgets.length-1||r.cellFormat.rowSpan>1&&r.ownerRow.rowIndex+r.cellFormat.rowSpan>=r.ownerTable.childWidgets.length||!pt||st&&k.childWidgets.length<r.ownerRow.childWidgets.length&&st<r.columnIndex+r.cellFormat.columnSpan)&&(o=r.cellFormat.rowSpan>1&&r.ownerRow.rowIndex+r.cellFormat.rowSpan===r.ownerTable.childWidgets.length?r.getBorderBasedOnPriority(r.getBorderBasedOnPriority(r.cellFormat.borders.bottom,r.ownerRow.rowFormat.borders.bottom),r.ownerTable.tableFormat.borders.bottom):s.getCellBottomBorder(r),"Cleared"!==r.cellFormat.borders.top.lineStyle||"None"!==r.cellFormat.borders.bottom.lineStyle||sf.base.isNullOrUndefined(r.nextWidget)||(o=r.cellFormat.borders.bottom),e=t.convertPointToPixel(o.getLineWidth()),this.renderSingleBorder(o.color,i.x-i.margin.left-d/2,i.y+i.height+c+e/2,i.x+i.width+i.margin.right,i.y+i.height+c+e/2,e));o=ct.getCellDiagonalUpBorder(r);(e=t.convertPointToPixel(o.getLineWidth()))>0&&this.renderSingleBorder(o.color,i.x-h,i.y+i.height+c,i.x+i.width+rt,i.y-v,e);o=ct.getCellDiagonalDownBorder(r);(e=t.convertPointToPixel(o.getLineWidth()))>0&&this.renderSingleBorder(o.color,i.x-h,i.y-v,i.x+i.width+rt,i.y+i.height+c,e)},n.prototype.renderCellBackground=function(n,i,r,u){var f=i.cellFormat,e="#ffffff"===f.shading.backgroundColor?i.ownerTable.tableFormat.shading.backgroundColor:f.shading.backgroundColor,o=i.x-r-u,c=i.topMargin?t.convertPointToPixel(i.topMargin):0,s=i.y-c,h=i.width+r+i.margin.right-u;i.ownerRow.rowFormat.revisions.length>0&&(e="Insertion"===i.ownerRow.rowFormat.revisions[i.ownerRow.rowFormat.revisions.length-1].revisionType?"#e1f2fa":"#fce6f4");this.pageContext.beginPath();"empty"!==e&&(this.pageContext.fillStyle=t.getColor(e),this.pageContext.fillRect(this.getScaledValue(o,1),this.getScaledValue(s,2),this.getScaledValue(h),this.getScaledValue(n)),this.pageContext.closePath());f.shading.hasValue("foregroundColor")&&"TextureNone"!==f.shading.textureStyle&&(this.pageContext.beginPath(),"empty"!==f.shading.foregroundColor&&(this.pageContext.fillStyle=t.getColor(f.shading.foregroundColor),this.pageContext.fillRect(this.getScaledValue(o,1),this.getScaledValue(s,2),this.getScaledValue(h),this.getScaledValue(n)),this.pageContext.closePath()))},n.prototype.renderSingleBorder=function(n,i,r,u,f,e){this.pageContext.beginPath();this.pageContext.moveTo(this.getScaledValue(i,1),this.getScaledValue(r,2));this.pageContext.lineTo(this.getScaledValue(u,1),this.getScaledValue(f,2));this.pageContext.lineWidth=this.getScaledValue(e);this.pageContext.strokeStyle=t.getColor(n);e>0&&this.pageContext.stroke();this.pageContext.closePath()},n.prototype.getScaledValue=function(n,t){return this.isPrinting?n:(sf.base.isNullOrUndefined(t)&&(t=0),n*this.documentHelper.zoomFactor+(1===t?this.pageLeft:2===t?this.pageTop:0))},n.prototype.checkRevisionType=function(n){for(var i,u,r=[],f=n.revisions.length,t=0;t<f;t++)i=n.revisions[t],u=this.documentHelper.authors.get(i.author),r.push({type:i.revisionType,color:u});return r},n.prototype.getRevisionColor=function(n){if(1===n.length)return n[0].color;for(var t=0;t<n.length;t++)if("Deletion"===n[t].type||"MoveFrom"===n[t].type)return n[t].color},n.prototype.getRevisionType=function(n,i){var r,u;if(0!==n.length)for(r=0;r<n.length;r++)if((u=void 0,i&&("Insertion"===n[r].type||"MoveTo"===n[r].type))||!i&&("Deletion"===n[r].type||"MoveFrom"===n[r].type))return u=n[r],this.pageContext.fillStyle=t.getColor(u.color),n.splice(r,1),u},n.prototype.getFormfieldInLine=function(n){for(var t=0;t<n.children.length;t++)if(_instanceof(n.children[t],r)&&!sf.base.isNullOrUndefined(n.children[t].formFieldData))return n.children[t]},n.prototype.destroy=function(){this.documentHelper=void 0;sf.base.isNullOrUndefined(this.pageCanvasIn)||(this.pageCanvasIn.innerHTML="");this.pageCanvasIn=void 0},n}(),uf=function(){function n(n){this.paragraphMarkInfo={};this.documentHelper=n;sf.base.isNullOrUndefined(n)||(this.context=n.containerContext)}return Object.defineProperty(n.prototype,"paragraphMark",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineBreakMark",{get:function(){return""},enumerable:!0,configurable:!0}),n.prototype.getEnSpaceCharacter=function(){return String.fromCharCode(8194)},n.prototype.repeatChar=function(n,t){for(var i="",r=0;r<t;r++)i+=n;return i},n.prototype.getParagraphMarkWidth=function(n){return this.getParagraphMarkSize(n).Width},n.prototype.getParagraphMarkSize=function(n){var t=this.getFormatText(n);if(this.paragraphMarkInfo[t])return this.paragraphMarkInfo[t];var r=this.getWidth(this.paragraphMark,n),i=this.getHeight(n),u={Width:r,Height:i.Height,BaselineOffset:i.BaselineOffset};return this.paragraphMarkInfo[t]=u},n.prototype.getTextSize=function(n,i){var r=0,f=i.bidi||this.isRTLText(n.text),e=this.setText(n.text,f,i.bdo),u;return r=this.getWidth(e,i),n.width=r,u=this.getHeight(i),n.height=u.Height,n.baselineOffset=u.BaselineOffset," "===n.text[n.text.length-1]&&(r=this.getWidth(t.trimEnd(n.text),i)),n.trimEndWidth=r,r},n.prototype.getHeight=function(n){var t=this.getFormatText(n),i;return sf.base.isNullOrUndefined(this.documentHelper.heightInfoCollection[t])?(i=this.documentHelper.owner.textMeasureHelper.getHeightInternal(n),this.documentHelper.heightInfoCollection[t]=i,i):this.documentHelper.heightInfoCollection[t]},n.prototype.getFormatText=function(n){var t=n.fontFamily.toLocaleLowerCase();return t+=";"+n.fontSize,n.bold&&(t+=";bold"),n.italic&&(t+=";italic"),t},n.prototype.getHeightInternal=function(n){var u,f,i=document.createElement("span"),t,r,e;return i.innerText="m",this.applyStyle(i,n),t=document.createElement("div"),t.setAttribute("style","display:inline-block;position:absolute;"),r=document.createElement("div"),r.setAttribute("style","display:inline-block;width: 1px; height: 0px;vertical-align: baseline;"),t.appendChild(i),t.appendChild(r),document.body.appendChild(t),u=i.offsetHeight,e=i.offsetTop,f=r.offsetTop-e,document.body.removeChild(t),{Height:u,BaselineOffset:f}},n.prototype.measureTextExcludingSpaceAtEnd=function(n,i){return this.getWidth(t.trimEnd(n),i)},n.prototype.getWidth=function(n,t){n.match("\v")&&n.replace("\v",this.lineBreakMark);var r,u,f,i=t.fontSize;return r=t.bold?"bold":"",u=t.italic?"italic":"",f=t.fontFamily,i=0===i?.5:i/("Normal"===t.baselineAlignment?1:1.5),this.context.font=r+" "+u+" "+i+"pt "+f,t.allCaps&&(n=n.toUpperCase()),this.context.measureText(n).width},n.prototype.setText=function(n,i,r,u){var f,e;return(sf.base.isNullOrUndefined(u)&&(u=!1),0===n.length)?"":(f=i,!f&&"RTL"===r||f&&"LTR"===r?n=t.reverseString(n):u&&f&&t.endsWith(n)&&(e=n.length-t.trimEnd(n).length,n=t.addSpace(e)+t.trimEnd(n)),n)},n.prototype.applyStyle=function(n,t){var i,r;sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(t)||(i="white-space:nowrap;",""!==t.fontFamily&&(i+="font-family:"+t.fontFamily+";"),r=t.fontSize,r<=.5&&(r=.5),i+="font-size:"+r.toString()+"pt;",t.bold&&(i+="font-weight:bold;"),t.italic&&(i+="font-style:italic;"),n.setAttribute("style",i))},n.prototype.measureText=function(n,t){var r=this.getWidth(n,t),i=this.getHeight(t);return{Width:r,Height:i.Height,BaselineOffset:i.BaselineOffset}},n.prototype.updateTextSize=function(n,t){var r=new p(void 0),i=n.listLevel.characterFormat,u=t.characterFormat,e,o,s,h,c,f;r.fontSize=i.hasValue("fontSize")?i.fontSize:u.fontSize;r.fontFamily=i.hasValue("fontFamily")?i.fontFamily:u.fontFamily;s="Normal"===i.baselineAlignment?u.baselineAlignment:i.baselineAlignment;e=i.hasValue("bold")?i.bold?"bold":"":u.bold?"bold":"";o=i.hasValue("italic")?i.italic?"italic":"":u.italic?"italic":"";r.baselineAlignment=s;e&&(r.bold=!0);o&&(r.italic=!0);h=r.bidi||this.isRTLText(n.text);c=this.setText(n.text,h,r.bdo);n.width=this.getWidth(c,r);f=this.getHeight(r);n.height=f.Height;n.baselineOffset=f.BaselineOffset},n.prototype.containsSpecialCharAlone=function(n){for(var t=0;t<n.length;t++)if(-1==="*|.:[]{}-`;()@&$#%!~? '".indexOf(n.charAt(t)))return!1;return!0},n.prototype.containsNumberAlone=function(n){if(""===n)return!1;for(var t=0;t<n.length;t++)if(-1==="0123456789".indexOf(n.charAt(t)))return!1;return!0},n.prototype.inverseCharacter=function(n){switch(n){case"(":return")";case")":return"(";case"<":return">";case">":return"<";case"{":return"}";case"}":return"{";case"[":return"]";case"]":return"[";default:return n}},n.prototype.containsSpecialChar=function(n){for(var t=0;t<n.length;t++)if(-1!=="*|.:[]{}-`;()@&$#%!~? ".indexOf(n.charAt(t)))return!0;return!1},n.prototype.isRTLText=function(n){var r=!1,i,t;if(!sf.base.isNullOrUndefined(n))for(i=0;i<n.length;i++)if(t=n[i],t>=""&&t<=""||t>=""&&t<=""||t>=""&&t<=""||t>=""&&t<=""||t>=""&&t<=""||t>=""&&t<=""||t>=""&&t<=""||t>=""&&t<=""||t>=""&&t<=""||t>=""&&t<=""||t>=""&&t<=""||t>=""&&t<=""||t>=""&&t<=""){r=!0;break}return r},n.prototype.getRtlLanguage=function(n){return sf.base.isNullOrUndefined(n)||""===n?{isRtl:!1,id:0}:n>=""&&n<=""?{isRtl:!0,id:1}:n>=""&&n<=""||n>=""&&n<=""||n>=""&&n<=""||n>=""&&n<=""||n>=""&&n<=""?{isRtl:!0,id:2}:n>=""&&n<=""?{isRtl:!0,id:3}:n>=""&&n<=""?{isRtl:!0,id:4}:n>=""&&n<=""?{isRtl:!0,id:5}:n>=""&&n<=""?{isRtl:!0,id:6}:n>=""&&n<=""?{isRtl:!0,id:7}:n>=""&&n<=""?{isRtl:!0,id:8}:n>=""&&n<=""?{isRtl:!0,id:9}:{isRtl:!1,id:0}},n.prototype.destroy=function(){this.documentHelper=void 0;this.context=void 0;this.paragraphMarkInfo={};this.paragraphMarkInfo=void 0},n}(),ff=function(){function n(n){var t=this;this.onMouseWheelInternal=function(n){if(!0===n.ctrlKey&&(n.preventDefault(),n.pageX-t.documentHelper.viewerContainer.offsetLeft<t.documentHelper.pageContainer.offsetWidth)){var r=navigator.userAgent.match("Firefox")?n.detail<0:sf.base.Browser.isIE?n.wheelDelta>0:n.deltaY<0,i=t.documentHelper.zoomFactor;r?i<=4.9?i+=.1:i=5:i>=.2?i-=.1:i=.1;t.documentHelper.zoomFactor=i}};this.documentHelper=n}return n.prototype.setZoomFactor=function(){this.onZoomFactorChanged();sf.base.isNullOrUndefined(this.documentHelper.selection)||this.documentHelper.selection.updateCaretPosition();this.documentHelper.updateTouchMarkPosition();sf.base.isNullOrUndefined(this.documentHelper.owner.imageResizerModule)||this.documentHelper.owner.imageResizerModule.updateImageResizerPosition();this.documentHelper.owner.fireZoomFactorChange()},Object.defineProperty(n.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),n.prototype.onZoomFactorChanged=function(){this.documentHelper.zoomFactor>5?this.documentHelper.zoomFactor=5:this.documentHelper.zoomFactor<.1&&(this.documentHelper.zoomFactor=.1);this.zoom()},n.prototype.zoom=function(){var n=this.viewer;this.documentHelper.clearContent();n.handleZoom();this.documentHelper.updateFocus()},n}(),bi=function(){function n(){this.mode=!0}return n.prototype.send=function(n){var t=this;this.xmlHttpRequest=new XMLHttpRequest;this.xmlHttpRequest.onreadystatechange=function(){t.stateChange(t)};this.xmlHttpRequest.onerror=function(){t.error(t)};this.mode?this.sendRequest(n):setTimeout(function(){t.sendRequest(n)})},n.prototype.sendRequest=function(n){this.xmlHttpRequest.open("POST",this.url,!0);this.contentType&&this.xmlHttpRequest.setRequestHeader("Content-Type",this.contentType);this.setCustomAjaxHeaders();this.responseType&&(this.xmlHttpRequest.responseType=this.responseType);var t=_instanceof(n,FormData)?n:JSON.stringify(n);this.xmlHttpRequest.send(t)},n.prototype.stateChange=function(n){if(4===n.xmlHttpRequest.readyState&&200===n.xmlHttpRequest.status){var t={name:"onSuccess",data:this.responseType?n.xmlHttpRequest.response:n.xmlHttpRequest.responseText,readyState:n.xmlHttpRequest.readyState,status:n.xmlHttpRequest.status};n.successHandler(t)}else 4===n.xmlHttpRequest.readyState&&200!==n.xmlHttpRequest.status&&(t={name:"onFailure",status:n.xmlHttpRequest.status,statusText:n.xmlHttpRequest.statusText,url:n.url},n.failureHandler(t))},n.prototype.error=function(n){var t={name:"onError",status:this.xmlHttpRequest.status,statusText:this.xmlHttpRequest.statusText};n.errorHandler(t)},n.prototype.successHandler=function(n){return this.onSuccess&&this.onSuccess(n),n},n.prototype.failureHandler=function(n){return this.onFailure&&this.onFailure(n),n},n.prototype.errorHandler=function(n){return this.onError&&this.onError(n),n},n.prototype.setCustomAjaxHeaders=function(){for(var i,n=0;n<this.customHeaders.length;n++)for(var r=this.customHeaders[n],t=0,u=Object.keys(r);t<u.length;t++)i=u[t],this.xmlHttpRequest.setRequestHeader(i,r[i])},n}(),ef=function(){function n(n){this.users=[];this.enableButtons=!0;this.sortedRevisions=[];this.noChangesVisibleInternal=!0;this.isTrackingPageBreak=!1;this.owner=n;this.selectedUser="All";this.selectedType="All"}return Object.defineProperty(n.prototype,"setNoChangesVisibility",{get:function(){return this.noChangesVisibleInternal},set:function(n){this.noChangeDivElement.style.display=n?"block":"none";this.noChangesVisibleInternal=n;this.enableDisableToolbarItem(!n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentSelectedRevision",{get:function(){return this.currentSelectedRevisionInternal},set:function(n){if(!sf.base.isNullOrUndefined(this.changesInfoDiv)){var t=sf.base.select(".e-de-trckchanges-inner-select",this.changesInfoDiv);sf.base.isNullOrUndefined(n)?sf.base.isNullOrUndefined(t)||t.classList.remove("e-de-trckchanges-inner-select"):(n!==this.currentSelectedRevisionInternal||sf.base.isNullOrUndefined(t))&&(t&&t.classList.remove("e-de-trckchanges-inner-select"),this.changes.length>0&&this.changes.containsKey(n))&&this.changes.get(n).singleInnerDiv.classList.add("e-de-trckchanges-inner-select");this.currentSelectedRevisionInternal=n;t=sf.base.select(".e-de-trckchanges-inner-select",this.changesInfoDiv);sf.base.isNullOrUndefined(t)||t.parentElement.scrollIntoView({block:"nearest"})}},enumerable:!0,configurable:!0}),n.prototype.initTrackChangePane=function(){this.changes=new h;this.changesInfoDiv=this.owner.element.getElementsByClassName("e-de-tc-pane-revision")[0];this.changesInfoDiv||(this.changesInfoDiv=sf.base.createElement("div",{id:"e-de-tc-pane-revision",styles:"overflow:auto"}));this.noChangeDivElement=sf.base.createElement("div",{styles:"display:none;",className:"e-de-tc-no-chng"});this.noChangeDivElement.textContent="No changes";this.changesInfoDiv.appendChild(this.noChangeDivElement);this.updateTrackChanges()},n.prototype.enableDisableToolbarItem=function(){},n.prototype.getSpanView=function(n,t){return(0===t?'<span class="e-de-track-span-user">':'<span class="e-de-track-span-view">')+n+"<\/span>"},n.prototype.onSelection=function(n){this.currentSelectedRevision=n},n.prototype.onUserSelect=function(n){this.selectedUser=n;this.sortCollectionToDisplay()},n.prototype.onMenuSelect=function(n){var t=this;"Accept all"===n?setTimeout(function(){t.owner.revisionsInternal.handleRevisionCollection(!0,t.sortedRevisions)}):"Reject all"===n&&setTimeout(function(){t.owner.revisionsInternal.handleRevisionCollection(!1,t.sortedRevisions)});this.updateUsers()},n.prototype.onTypeSelect=function(n){this.selectedType=n;this.sortCollectionToDisplay()},n.prototype.updateMenuOptions=function(){"All"!==this.selectedType&&this.selectedType},n.prototype.sortCollectionToDisplay=function(){var i=!1,r,t,n;for(this.sortedRevisions=[],this.updateMenuOptions(),r=0;r<this.changes.length;r++)t=this.changes.get(this.revisions[r]),n=t.outerSingleDiv,"All"===this.selectedUser&&"All"===this.selectedType?(n.style.display="block",i=!0):"All"===this.selectedUser&&"All"!==this.selectedType?t.revisionType===this.selectedType?(n.style.display="block",i=!0):n.style.display="none":"All"!==this.selectedUser&&"All"===this.selectedType?t.user===this.selectedUser?(n.style.display="block",i=!0):n.style.display="none":t.user===this.selectedUser&&t.revisionType===this.selectedType?(n.style.display="block",i=!0):n.style.display="none","block"===n.style.display&&this.sortedRevisions.push(this.revisions[r]);this.setNoChangesVisibility=!i},n.prototype.enableDisableButton=function(n){this.enableButtons=n;this.updateTrackChanges()},n.prototype.updateTrackChanges=function(n){var t,i;if(n||sf.base.isNullOrUndefined(n)){if(sf.base.isNullOrUndefined(this.changesInfoDiv))return;for(this.removeAllChanges(),t=0;t<this.owner.revisions.changes.length;t++)i=this.owner.revisions.changes[t],this.addChanges(i);this.sortCollectionToDisplay();this.updateUsers();this.currentSelectedRevision=this.currentSelectedRevisionInternal;this.updateHeight();this.owner.resize()}else this.currentSelectedRevision=void 0},n.prototype.updateUsers=function(){this.users.length>0&&(this.users=[]);for(var n=0;n<this.revisions.length;n++)-1===this.users.indexOf(this.revisions[n].author)&&this.users.push(this.revisions[n].author);this.owner.dotNetRef.invokeMethodAsync("UpdateRevisionUsers",this.users)},n.prototype.updateHeight=function(){var n=this.owner.element.getElementsByClassName("e-de-review-pane")[0],i,t;n&&(i=n.getElementsByClassName("e-tab-header")[0].getBoundingClientRect().height,t=n.getElementsByClassName("e-de-track-toolbar")[0],t&&(this.changesInfoDiv.style.height=n.clientHeight-t.clientHeight-i-2+"px"))},n.prototype.removeAllChanges=function(){if(!sf.base.isNullOrUndefined(this.changesInfoDiv)){for(;this.changesInfoDiv.childNodes.length>1;)this.changesInfoDiv.removeChild(this.changesInfoDiv.lastChild);this.revisions=[];this.changes.clear()}},n.prototype.clear=function(){this.removeAllChanges();this.selectedUser="All";this.selectedType="All";this.currentSelectedRevision=void 0},n.prototype.destroy=function(){this.removeAllChanges();this.users.length>0&&(this.users=[])},n.prototype.addChanges=function(n){if(!sf.base.isNullOrUndefined(this.changesInfoDiv)){var t=new hf(this.owner,this);this.changesInfoDiv.appendChild(t.createSingleChangesDiv(n));this.enableButtons?t.acceptButtonElement.classList.contains("e-de-overlay")&&(t.acceptButtonElement.classList.remove("e-de-overlay"),t.rejectButtonElement.classList.remove("e-de-overlay")):t.acceptButtonElement.classList.contains("e-de-overlay")||(t.acceptButtonElement.classList.add("e-de-overlay"),t.rejectButtonElement.classList.add("e-de-overlay"));this.revisions.push(n);this.changes.add(n,t)}},n.prototype.navigatePreviousChanges=function(){this.owner.selection.navigatePreviousRevision()},n.prototype.navigateNextChanges=function(){this.owner.selection.navigateNextRevision()},n}(),hf=function(){function n(n,t){this.owner=n;this.trackChangesPane=t}return n.prototype.createSingleChangesDiv=function(n){var u,o,i,s,e,f,r;this.revision=n;this.user=n.author;this.outerSingleDiv=sf.base.createElement("div",{className:"e-de-tc-outer"});this.singleInnerDiv=sf.base.createElement("div",{className:"e-de-trckchanges-inner"});this.singleInnerDiv.addEventListener("click",this.selectRevision.bind(this));this.outerSingleDiv.appendChild(this.singleInnerDiv);u=sf.base.createElement("div",{className:"e-de-track-usernme-div"});o=sf.base.createElement("div",{innerHTML:n.author,className:"e-de-track-user-nme"});sf.base.isNullOrUndefined(n.author)||(u.style.display="flex",this.owner.documentHelper.getAvatar(u,o,void 0,n));i=sf.base.createElement("div");"Insertion"===n.revisionType?(this.revisionType="Inserted",i.innerHTML="Inserted".toUpperCase(),i.classList.add("e-de-track-insert")):"Deletion"===n.revisionType?(this.revisionType="Deleted",i.innerHTML="Deleted".toUpperCase(),i.classList.add("e-de-track-delete")):"MoveFrom"===n.revisionType?(this.revisionType="MoveFrom",i.innerHTML="Move From".toUpperCase(),i.classList.add("e-de-track-delete"),i.style.whiteSpace="nowrap"):"MoveTo"===n.revisionType&&(this.revisionType="MoveTo",i.innerHTML="Move To".toUpperCase(),i.classList.add("e-de-track-insert"),i.style.whiteSpace="nowrap");u.appendChild(i);this.singleInnerDiv.appendChild(u);s=sf.base.createElement("div",{className:"e-de-track-date",innerHTML:t.getModifiedDate(n.date)});this.singleInnerDiv.appendChild(s);e=sf.base.createElement("div",{className:"e-de-track-chngs-text"});this.layoutElementText(n.range,e);this.singleInnerDiv.appendChild(e);f=sf.base.createElement("div",{styles:"display:inline-block;width:100%"});this.singleInnerDiv.appendChild(f);r=sf.base.createElement("div",{styles:"float:left;"});this.acceptButtonElement=sf.base.createElement("button",{className:"e-de-track-accept-button e-btn e-lib e-control e-outline"});this.acceptButtonElement.textContent="Accept";r.appendChild(this.acceptButtonElement);f.appendChild(r);this.acceptButtonElement.addEventListener("click",this.acceptButtonClick.bind(this));r=sf.base.createElement("div",{styles:"float:left;"});this.rejectButtonElement=sf.base.createElement("button",{className:"e-de-track-reject-button e-btn e-lib e-control e-outline"});this.rejectButtonElement.textContent="Reject";r.appendChild(this.rejectButtonElement);f.appendChild(r);this.rejectButtonElement.addEventListener("click",this.rejectButtonClick.bind(this));var h=sf.base.createElement("div",{className:"e-de-track-chngs-count",styles:"float:right;"}),c=this.owner.revisions.changes.indexOf(n)+1,l=this.owner.revisions.changes.length;return h.innerHTML="Changes "+c.toString()+" of "+l.toString(),f.appendChild(h),this.outerSingleDiv},n.prototype.selectRevision=function(){this.owner.selection.selectRevision(this.revision);this.trackChangesPane.onSelection(this.revision)},n.prototype.layoutElementText=function(n,t){var f,o,w,h,s,c,l;t.style.width="100%";for(var e="",a=!1,y=0;y<n.length;y++)if(f=n[y],_instanceof(f,r)&&1===f.fieldType)a=!1;else if(!a)if(_instanceof(f,r)&&0===f.fieldType&&(a=!0),_instanceof(f,i))e+=f.text;else if(_instanceof(f,r)&&0===f.fieldType){if(o=this.owner.selection.getFieldCode(f),o.match("TOC ")||o.match("Toc"))return e+="<Table of Content>",void t.appendChild(this.addSpan(e));o.match("HYPERLINK ")||o.match("MERGEFIELD")||o.match("FORMTEXT")||o.match("PAGE ")?e+=this.owner.editor.retrieveFieldResultantText(f.fieldEnd):f.formFieldData&&(w=this.owner.documentHelper.textHelper.repeatChar(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),5),""!==e&&(t.appendChild(this.addSpan(e)),e=""),_instanceof(f.formFieldData,vt)?t.appendChild(this.addSpan(""===f.formFieldData.defaultValue?w:f.formFieldData.defaultValue,"e-de-tc-field")):_instanceof(f.formFieldData,kt)?t.appendChild(this.addSpan(f.formFieldData.dropdownItems.length>0?f.formFieldData.dropdownItems[0]:w,"e-de-tc-field")):t.appendChild(this.addSpan(f.formFieldData.checked?String.fromCharCode(9745):String.fromCharCode(9744),"e-de-tc-field")))}else if(_instanceof(f,v))""!==e&&(t.appendChild(this.addSpan(e)),e=""),h=sf.base.createElement("img"),h.setAttribute("src",f.imageString),h.classList.add("e-de-tc-shrink-img"),t.appendChild(h);else{if(_instanceof(f,ti)){for(s=sf.base.createElement("table"),s.classList.add("e-de-track-chng-table"),s.insertRow(),c=0;c<f.ownerBase.childWidgets.length;c++)s.rows[0].insertCell(),s.rows[0].cells[c].classList.add("e-de-tc-tble-cell");return void t.appendChild(s)}_instanceof(f,p)&&(""!==e&&(t.appendChild(this.addSpan(e)),e=""),l="",_instanceof(f.ownerBase,u)&&f.ownerBase.isEndsWithPageBreak&&(l="............Page Break............"+l),t.appendChild(this.addSpan(l,"e-de-tc-pmark")),t.appendChild(sf.base.createElement("br")))}t.appendChild(this.addSpan(e))},n.prototype.addSpan=function(n,t){var i=sf.base.createElement("span");return i.textContent=n,t&&i.classList.add(t),i},n.prototype.acceptButtonClick=function(){this.trackChangesPane.changesInfoDiv.removeChild(this.outerSingleDiv);this.removeFromParentCollec();this.revision.accept()},n.prototype.rejectButtonClick=function(){this.trackChangesPane.changesInfoDiv.removeChild(this.outerSingleDiv);this.removeFromParentCollec();this.revision.reject()},n.prototype.removeFromParentCollec=function(){this.trackChangesPane.changes.remove(this.revision);this.trackChangesPane.revisions.splice(this.trackChangesPane.revisions.indexOf(this.revision),1);0===this.trackChangesPane.changes.length&&(this.trackChangesPane.setNoChangesVisibility=!0);this.trackChangesPane.updateUsers()},n}(),cf=function(){function n(n){this.langIDInternal=0;this.enableSpellCheckInternal=!0;this.uniqueSpelledWords={};this.spellSuggestionInternal=!0;this.uniqueKey="";this.removeUnderlineInternal=!1;this.uniqueWordsCountInternal=15e3;this.performOptimizedCheck=!1;this.documentHelper=n;this.errorWordCollection=new h;this.errorSuggestions=new h;this.ignoreAllItems=[];this.uniqueSpelledWords={};this.textSearchResults=new yu(this.documentHelper.owner);this.uniqueKey=this.documentHelper.owner.element.id+"_"+this.createGuid()}return n.prototype.getModuleName=function(){return"SpellChecker"},Object.defineProperty(n.prototype,"enableOptimizedSpellCheck",{get:function(){return this.performOptimizedCheck},set:function(n){this.performOptimizedCheck=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"uniqueWordsCount",{get:function(){return sf.base.isNullOrUndefined(this.uniqueWordsCountInternal)?0:this.uniqueWordsCountInternal},set:function(n){this.uniqueWordsCountInternal=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"languageID",{get:function(){return sf.base.isNullOrUndefined(this.langIDInternal)?0:this.langIDInternal},set:function(n){this.langIDInternal=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"allowSpellCheckAndSuggestion",{get:function(){return this.spellSuggestionInternal},set:function(n){this.spellSuggestionInternal=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"removeUnderline",{get:function(){return this.removeUnderlineInternal},set:function(n){this.removeUnderlineInternal=n;this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"enableSpellCheck",{get:function(){return this.enableSpellCheckInternal},set:function(n){this.enableSpellCheckInternal=n;this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),n.prototype.manageReplace=function(n,t){var i,r;if(this.documentHelper.triggerSpellCheck=!0,!sf.base.isNullOrUndefined(t)&&_instanceof(t,vi)){if(i=t.text,this.documentHelper.selection.start=t.start,this.documentHelper.selection.end=t.end,"Ignore Once"!==n)return n=this.manageSpecialCharacters(i,n),this.documentHelper.owner.editor.insertTextInternal(n,!0),this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end),void this.documentHelper.clearSelectionHighlight();this.currentContextInfo={text:i,element:t}}!sf.base.isNullOrUndefined(this.currentContextInfo)&&this.currentContextInfo.element&&"Ignore Once"!==n?(r=this.currentContextInfo.element,this.currentContextInfo.element.text,this.documentHelper.selection.start=r.start,this.documentHelper.selection.end=r.end):this.handleReplace(n);"Ignore Once"!==n&&(this.documentHelper.owner.editor.insertTextInternal(n,!0),sf.base.isNullOrUndefined(this.currentContextInfo)||this.removeErrorsFromCollection(this.currentContextInfo),this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end),this.documentHelper.clearSelectionHighlight());this.documentHelper.triggerSpellCheck=!1},n.prototype.handleReplace=function(n){var t=this.documentHelper.selection.start,e=t.offset,i=t.currentWidget.getInline(e,0,!1,!0);i.element.line.getOffset(i.element,0)+i.element.length===e&&this.retrieveExactElementInfo(i);for(var u,o=i.element.text,h=new RegExp("^[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"'\\,\\<\\.\\>\\/\\?\\`\\s]+","g"),r=[];!sf.base.isNullOrUndefined(u=h.exec(o));)r.push(u);if("Ignore Once"!==n){t.offset=e-i.index;!sf.base.isNullOrUndefined(r)&&r.length>0&&(t.offset+=r[0].toString().length);t.location=this.documentHelper.owner.selection.getPhysicalPositionInternal(t.currentWidget,t.offset,!0);(t=this.documentHelper.owner.searchModule.textSearch.getTextPosition(t.currentWidget,t.offset.toString())).setPositionParagraph(t.currentWidget,t.offset);var c=t.offset+i.element.length-t.offset,f=t.currentWidget.getOffset(i.element,c),s=t.currentWidget,l=new RegExp("[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"'\\,\\<\\.\\>\\/\\?\\s\\`]+$","g");for(r=[];!sf.base.isNullOrUndefined(u=l.exec(o));)r.push(u);!sf.base.isNullOrUndefined(r)&&r.length>0&&(f-=r[0].toString().length);this.documentHelper.selection.end=this.documentHelper.owner.searchModule.textSearch.getTextPosition(s,f.toString());this.documentHelper.selection.end.location=this.documentHelper.owner.selection.getPhysicalPositionInternal(t.currentWidget,f,!0);this.documentHelper.selection.end.setPositionParagraph(s,f);this.currentContextInfo={element:i.element,text:i.element.text}}else this.handleIgnoreOnce(i)},n.prototype.retrieveExactElementInfo=function(n){var t=n.element.nextElement;n.element=!sf.base.isNullOrUndefined(t)&&_instanceof(t,i)?n.element.nextElement:n.element},n.prototype.handleIgnoreOnce=function(n){var i=n.element,t="";t=!sf.base.isNullOrUndefined(this.currentContextInfo)&&this.currentContextInfo.element?this.currentContextInfo.element.text:i.text;t=this.manageSpecialCharacters(t,void 0,!0);-1===i.ignoreOnceItems.indexOf(t)&&i.ignoreOnceItems.push(t);this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},n.prototype.handleIgnoreAllItems=function(n){var t=sf.base.isNullOrUndefined(n)?this.retriveText():n,i=this.manageSpecialCharacters(t.text,void 0,!0);-1===this.ignoreAllItems.indexOf(i)&&(this.ignoreAllItems.push(i),this.removeErrorsFromCollection(t),this.documentHelper.triggerSpellCheck=!0,this.documentHelper.owner.editor.reLayout(this.documentHelper.selection),this.documentHelper.triggerSpellCheck=!1,this.documentHelper.clearSelectionHighlight())},n.prototype.handleAddToDictionary=function(n){var t=this,i=sf.base.isNullOrUndefined(n)?this.retriveText():n,r=this.manageSpecialCharacters(i.text,void 0,!0);this.callSpellChecker(this.languageID,r,!1,!1,!0).then(function(){t.documentHelper.triggerSpellCheck=!0;t.removeErrorsFromCollection(i);t.ignoreAllItems.push(r);t.documentHelper.owner.editor.reLayout(t.documentHelper.selection,!0);t.documentHelper.triggerSpellCheck=!1})},n.prototype.manageSpecialCharacters=function(n,t,i){var u,f,o;if(!sf.base.isNullOrUndefined(n)){sf.base.isNullOrUndefined(t)&&(t=n);for(var s=new RegExp("^[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\'\\,\\<\\.\\>\\/\\?\\`\\s]+","g"),r=[],e=void 0;!sf.base.isNullOrUndefined(e=s.exec(n));)r.push(e);if(r.length>0)for(u=0;u<r.length;u++)f=r[u],t=i?t.replace(f[0],""):f[0]+t;for(o=new RegExp("[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\'\\,\\<\\.\\>\\/\\?\\s\\`]+$","g"),r=[];!sf.base.isNullOrUndefined(e=o.exec(t));)r.push(e);if(r.length>0)for(u=0;u<r.length;u++)f=r[u],t=i?t.slice(0,f.index):t+f[0]}return t},n.prototype.removeErrorsFromCollection=function(n){if(this.errorWordCollection.containsKey(n.text)){var t=this.errorWordCollection.get(n.text);t.indexOf(n.element)>=0&&t.splice(0,1);0===t.length&&this.errorWordCollection.remove(n.text)}},n.prototype.retriveText=function(){var t,n;if(!sf.base.isNullOrUndefined(this.currentContextInfo)&&this.currentContextInfo.element)n=this.currentContextInfo.element,t=this.currentContextInfo.element.text,this.documentHelper.selection.start=n.start,this.documentHelper.selection.end=n.end;else{var i=this.documentHelper.selection.start,u=i.offset,r=i.currentWidget.getInline(u,0);n=r.element;t=r.element.text}return{text:t,element:n}},n.prototype.handleSuggestions=function(n){var i,t,r,u;if(this.spellCheckSuggestion=[],0===n.length||(n=5===n.length?this.constructInlineMenu(n):n),this.spellCheckSuggestion.push("Add to Dictionary"),i=[],this.spellCheckSuggestion.length>0)for(t=0,r=this.spellCheckSuggestion;t<r.length;t++)u=r[t],i.push({text:u,id:this.documentHelper.owner.element.id+"_contextmenu_otherSuggestions_spellcheck_"+u,iconCss:""});return i},n.prototype.checktextElementHasErrors=function(n,t){var r=!1,u=[],i;if(n=n.replace(/[\s]+/g,""),!sf.base.isNullOrUndefined(t.errorCollection)&&t.errorCollection.length>0){if(!this.documentHelper.isScrollHandler&&(t.ischangeDetected||t.paragraph.isChangeDetected))return this.updateStatusForGlobalErrors(t.errorCollection,t),t.errorCollection=[],t.ischangeDetected=!0,{errorFound:r,elements:u};for(i=0;i<t.errorCollection.length;i++)this.handleErrorCollection(t.errorCollection[i])&&(r=!0,u.push(t.errorCollection[i]))}else!this.documentHelper.isScrollHandler&&t.paragraph.isChangeDetected?t.ischangeDetected=!0:!t.ischangeDetected&&this.handleErrorCollection(t)&&(r=!0,u.push(t));return{errorFound:r,elements:u}},n.prototype.updateStatusForGlobalErrors=function(n,t){var u,f,r,i;if(n.length>0)for(u=0;u<n.length;u++)if(f=this.manageSpecialCharacters(n[u].text,void 0,!0),this.errorWordCollection.containsKey(f))for(r=this.errorWordCollection.get(f),i=0;i<r.length;i++)if(_instanceof(r[i],vi)&&r[i]===n[u]){r[i].ischangeDetected=!0;r[i].start.offset=t.line.getOffset(t.istextCombined?this.getCombinedElement(t):t,0);r[i].line=t.line;break}},n.prototype.handleErrorCollection=function(n){var i=this.errorWordCollection,t=this.manageSpecialCharacters(n.text,void 0,!0);return!!(i.containsKey(t)&&n.length>1)&&(!(this.ignoreAllItems.indexOf(t)>-1)||(i.containsKey(t)&&i.remove(t),!1))},n.prototype.constructInlineMenu=function(n){for(var t=n.length-1;t>0;t--)n.length>3&&(this.spellCheckSuggestion.push(n[t]),n.pop());return n},n.prototype.findCurretText=function(){var f,t,r=this.documentHelper.selection.start,n=r.currentWidget.getInline(this.documentHelper.selection.start.offset,0),u,i;if(!sf.base.isNullOrUndefined(n.element)){if(!sf.base.isNullOrUndefined(n.element.errorCollection)&&n.element.errorCollection.length>0){for(u=0;u<n.element.errorCollection.length;u++)if(i=n.element.errorCollection[u],i.start.location.x<=r.location.x&&i.end.location.x>=r.location.x){t=i.text;f=i;break}}else t=n.element.text;" "===t&&(t=(n=r.currentWidget.getInline(this.documentHelper.selection.start.offset+1,0)).element.text)}return{text:t,element:f}},n.prototype.addErrorCollection=function(n,t,r){if(n=this.manageSpecialCharacters(n,void 0,!0),this.errorWordCollection.containsKey(n)){var u=this.errorWordCollection.get(n);_instanceof(t,vi)?this.compareErrorTextElement(t,u)||u.push(t):_instanceof(t,i)&&(this.compareTextElement(t,u)||u.push(t))}else!sf.base.isNullOrUndefined(r)&&r.length>0&&this.errorSuggestions.add(n,r),this.errorWordCollection.add(n,[t])},n.prototype.compareErrorTextElement=function(n,t){for(var e,o,u,r=[],f=!1,i=0;i<t.length;i++)r.push(t[i]);for(e=t.length,i=0;i<e;i++)if(_instanceof(r[i],vi))if(r[i].ischangeDetected)o=this.manageSpecialCharacters(r[i].text,void 0,!0),f=!0,this.removeErrorsFromCollection({element:r[i],text:o});else if(u=r[i],n.start.offset===u.start.offset&&n.end.offset===u.end.offset)return!0;return f&&this.errorWordCollection.add(this.manageSpecialCharacters(n.text,void 0,!0),[n]),!1},n.prototype.compareTextElement=function(n,t){for(var r=0;r<t.length;r++)if(_instanceof(t[r],i)&&t[r]===n)return!0;return!1},n.prototype.handleWordByWordSpellCheck=function(n,t,i,r,u,f,e){if(n.HasSpellingError&&e){this.addErrorCollection(t.text,t,n.Suggestions);var o=_instanceof(t.line.paragraph.containerWidget,s)?t.line.paragraph.containerWidget.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor;this.documentHelper.render.renderWavyLine(t,i,r,u,"#FF0000","Single",f,o);t.isSpellChecked=!0}else t.isSpellChecked=!0},n.prototype.checkElementCanBeCombined=function(n,t,u,f,e,o,s,h){var a=sf.base.isNullOrUndefined(e)?"":e,p=!sf.base.isNullOrUndefined(h)&&h,rt=!!sf.base.isNullOrUndefined(s)||s,ut=!!sf.base.isNullOrUndefined(o)||o,w=[],b=this.documentHelper.selection.getLineWidget(n,0),tt=b.children.indexOf(n),k=n.text,c,v,d,g,nt,l;w.push(n);var ft=s?0:1,it=!1,y=!1;if("\v"!==n.text){if(rt){for(c=void 0,v=tt-ft;v>=0;v--)if(_instanceof(c=b.children[v],i)&&!y){if(0!==k.indexOf(" ")&&c.text.lastIndexOf(" ")!==c.text.length-1)it=!sf.base.isNullOrUndefined(e),a=c.text+a,k=c.text,y=!1,w.push(c),p=!0;else if(!sf.base.isNullOrUndefined(c)){c=c.nextElement;break}}else _instanceof(c,r)&&1!==c.fieldType&&(y=!0);if(d=p?c:n,this.lookThroughPreviousLine(a,k,d,t,u))return!0}if(s?a=it?a:n.text+a:a+=n.text,y=!1,g=n.text,ut){for(nt=!1,l=void 0,v=tt+1;v<b.children.length;v++)if(_instanceof(l=b.children[v],i)&&!y){if(g.lastIndexOf(" ")!==g.length-1&&0!==l.text.indexOf(" "))a+=l.text,g=l.text,y=!1,w.push(l),nt=!0,p=!0;else if(!sf.base.isNullOrUndefined(l)){l=l.previousElement;break}}else _instanceof(l,r)&&2!==l.fieldType&&(y=!0);if("\f"!==(d=nt?l:n).text&&this.lookThroughNextLine(a,k,d,t,u))return!0}}return p&&f&&!this.checkCombinedElementsBeIgnored(w,a)&&this.handleCombinedElements(n,a,t,u),p},n.prototype.lookThroughPreviousLine=function(n,t,r,u,f){var e,o,s;return!sf.base.isNullOrUndefined(r)&&0===r.indexInOwner&&!sf.base.isNullOrUndefined(r.line.previousLine)&&(e=r.line.previousLine,o=e.children.length-1,!sf.base.isNullOrUndefined(e.children[o])&&_instanceof(e.children[o],i)&&(s=e.children[o],!sf.base.isNullOrUndefined(r.text)&&0!==r.text.indexOf(" ")&&s.text.lastIndexOf(" ")!==s.text.length-1))?(n=n.length>0?n:t,this.checkElementCanBeCombined(s,u,f,!0,n,!1,!0,!0),!0):!1},n.prototype.lookThroughNextLine=function(n,t,r,u,f){var e,o;return!sf.base.isNullOrUndefined(r)&&r.indexInOwner===r.line.children.length-1&&!sf.base.isNullOrUndefined(r.line.nextLine)&&(e=r.line.nextLine,!sf.base.isNullOrUndefined(e.children[0])&&_instanceof(e.children[0],i)&&(o=e.children[0],r.text.lastIndexOf(" ")!==r.text.length-1&&0!==o.text.indexOf(" ")))?(n=n.length>0?n:t,this.checkElementCanBeCombined(o,u,f,!0,n,!0,!1,!0),!0):!1},n.prototype.handleCombinedElements=function(n,t,r,u){var e,f,o;if(n.istextCombined=!0,e=t.split(/[\s]+/),-1===this.ignoreAllItems.indexOf(t)&&_instanceof(n,i)&&-1===n.ignoreOnceItems.indexOf(t))if(e.length>1)for(f=0;f<e.length;f++)o=e[f],o=this.manageSpecialCharacters(o,void 0,!0),this.documentHelper.render.handleUnorderedElements(o,n,r,f,0,f===e.length-1,u);else t=this.manageSpecialCharacters(t,void 0,!0),this.documentHelper.render.handleUnorderedElements(t,n,r,0,0,!0,u)},n.prototype.checkArrayHasSameElement=function(n,t){for(var r,i=0;i<n.length;i++)if(r=n[i],r.start.location.x===t.start.location.x&&r.start.location.y===t.start.location.y)return!0;return!1},n.prototype.handleSplitWordSpellCheck=function(n,t,i,r,u,f,e,o){if(n.HasSpellingError&&" "!==i.text&&r){var s=this.getMatchedResultsFromElement(i,t);e=i.istextCombined?i.line.getOffset(this.getCombinedElement(i),0):e;this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(s.matches,s.textResults,s.elementInfo,0,i,!1,null,e);this.handleMatchedResults(s.textResults,i,u,f,n.Suggestions,o)}else o&&(i.isSpellChecked=!0);this.updateUniqueWords([{Text:t,HasSpellError:n.HasSpellingError}])},n.prototype.handleMatchedResults=function(n,t,i,r,u,f){var o,e,h;if(0===n.length&&f)t.isSpellChecked=!0;else for(o=0;o<n.length;o++)e=this.createErrorElementWithInfo(n.innerList[o],t),sf.base.isNullOrUndefined(t.errorCollection)||this.checkArrayHasSameElement(t.errorCollection,e)||t.errorCollection.splice(r,0,e),this.addErrorCollection(e.text,e,u),h=_instanceof(t.line.paragraph.containerWidget,s)?t.paragraph.containerWidget.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor,this.documentHelper.render.renderWavyLine(e,e.start.location.x,e.start.location.y-t.margin.top,i,"#FF0000","Single",t.characterFormat.baselineAlignment,h),f&&(t.isSpellChecked=!0)},n.prototype.callSpellChecker=function(n,t,i,r,u,f){var e=this,o=this;return new Promise(function(s,h){var c,l,a;sf.base.isNullOrUndefined(e)||(c=new XMLHttpRequest,l=e.documentHelper.owner.serviceUrl+e.documentHelper.owner.serverActionSettings.spellCheck,l=f?l+"ByPage":l,c.open("POST",l,!0),c.setRequestHeader("Content-Type","application/json"),e.setCustomHeaders(c),a={LanguageID:n,TexttoCheck:t,CheckSpelling:i,CheckSuggestion:r,AddWord:u},c.send(JSON.stringify(a)),c.onreadystatechange=function(){if(4===c.readyState)if(200===c.status||304===c.status)s(c.response);else{var n={name:"onFailure",status:c.status,statusText:c.responseText,url:l};o.documentHelper.owner.fireServiceFailure(n);h(c.response)}})})},n.prototype.setCustomHeaders=function(n){for(var r,t=0;t<this.documentHelper.owner.headers.length;t++)for(var u=this.documentHelper.owner.headers[t],i=0,f=Object.keys(u);i<f.length;i++)r=f[i],n.setRequestHeader(r,u[r])},n.prototype.checkForNextError=function(){var r,u,t,n,f,s;if(!sf.base.isNullOrUndefined(this.viewer))if(r=this.errorWordCollection,r.length>0)for(u=0;u<r.length;u++){for(t=r.get(r.keys[u]),n=0;n<t.length;n++){if(_instanceof(t[n],vi)&&!t[n].ischangeDetected)this.updateErrorElementTextBox(r.keys[u],t[n]);else if(_instanceof(t[n],i)){var e=this.getMatchedResultsFromElement(t[n]),o=e.textResults,h=t[n].ischangeDetected?t[n].start.offset:t[n].line.getOffset(t[n],0);for(this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(e.matches,o,e.elementInfo,0,t[n],!1,null,h),f=0;f<o.length;f++){s=this.createErrorElementWithInfo(o.innerList[f],t[n]);this.updateErrorElementTextBox(s.text,s);break}}break}break}else this.documentHelper.clearSelectionHighlight()},n.prototype.createErrorElementWithInfo=function(n,t){var i=new vi;return i.text=n.text,i.start=n.start,i.end=n.end,i.height=t.height,i.canTrigger=t.canTrigger,i.characterFormat.copyFormat(t.characterFormat),i.width=this.documentHelper.textHelper.getWidth(i.text,t.characterFormat),i},n.prototype.getMatchedResultsFromElement=function(n,t){var f=n.line,e=this.documentHelper.owner.searchModule.textSearch.stringToRegex(sf.base.isNullOrUndefined(t)?n.text:t,"CaseSensitive");this.textSearchResults.clearResults();for(var i,o=this.textSearchResults,r=this.documentHelper.owner.searchModule.textSearch.getElementInfo(f.children[0],0,!1),s=r.fullText,u=[],h=r.elementsWithOffset;!sf.base.isNullOrUndefined(i=e.exec(s));)u.push(i);return{matches:u,elementInfo:h,textResults:o}},n.prototype.updateErrorElementTextBox=function(n,t){var i=t;this.documentHelper.clearSelectionHighlight();this.documentHelper.selection.start=i.start;this.documentHelper.selection.end=i.end;this.documentHelper.selection.highlight(t.start.paragraph,t.start,t.end)},n.prototype.getWhiteSpaceCharacterInfo=function(n,t){var i,u=0,f=0,r;if(i=n.match(/[\s]+/),!sf.base.isNullOrUndefined(i)&&i.length>0)for(r=0;r<i.length;r++)u+=this.documentHelper.textHelper.getWidth(i[r],t),f+=i[r].length;return{width:u,wordLength:f,isBeginning:!sf.base.isNullOrUndefined(i)&&0===i.index}},n.prototype.getSpecialCharactersInfo=function(n,t){for(var i=[],f=0,e=0,u=0,i=n.match(/^[\#\@\!\~\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\:\;\"\'\,\<\.\>\/\?\`]*/),r=0;r<i.length;r++)!sf.base.isNullOrUndefined(i[r])&&i[r].length>0&&(f=this.documentHelper.textHelper.getWidth(i[r],t)),u=i.length;for(i=n.match(/[\#\@\!\~\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\:\;\"\'\,\<\.\>\/\?\`]*$/),r=0;r<i.length;r++)!sf.base.isNullOrUndefined(i[r])&&i[r].length>0&&(e=this.documentHelper.textHelper.getWidth(i[r],t)),u=i.length;return{beginningWidth:f,endWidth:e,wordLength:u}},n.prototype.getCombinedElement=function(n){for(var t=n;!sf.base.isNullOrUndefined(n)&&_instanceof(n,i)&&n.istextCombined;)t=n,n=n.previousElement;return t},n.prototype.checkCombinedElementsBeIgnored=function(n,t){t=this.manageSpecialCharacters(t,void 0,!0);for(var i=0;i<n.length;i++)if(-1!==n[i].ignoreOnceItems.indexOf(t))return!0;return!1},n.prototype.updateSplittedElementError=function(n,t){var r=n.errorCollection.length,u,i;if(r>0){for(u=[],i=0;i<r;i++)u.push(n.errorCollection[i]);for(i=0;i<r;i++)-1===n.text.indexOf(u[i].text)&&(t.ischangeDetected=!0,n.errorCollection.splice(0,1))}},n.prototype.getPageContent=function(n){var r="",i,u,t;return this.documentHelper.owner.sfdtExportModule&&(i=this.documentHelper.owner.sfdtExportModule,i.Initialize(),u=i.writePage(n),this.documentHelper.owner.textExportModule&&(t=this.documentHelper.owner.textExportModule,t.pageContent="",t.setDocument(u),t.writeInternal(),r=t.pageContent)),r},n.prototype.updateUniqueWords=function(n){if(sf.base.isNullOrUndefined(localStorage.getItem(this.uniqueKey))||(this.uniqueSpelledWords=JSON.parse(localStorage.getItem(this.uniqueKey))),this.uniqueSpelledWords=this.uniqueSpelledWords||{},n.length+Object.keys(this.uniqueSpelledWords).length<=this.uniqueWordsCount)for(var t=0;t<n.length;t++)this.checkForUniqueWords(n[t]);localStorage.setItem(this.uniqueKey,JSON.stringify(this.uniqueSpelledWords));this.uniqueSpelledWords={}},n.prototype.checkForUniqueWords=function(n){this.uniqueSpelledWords[n.Text]||(this.uniqueSpelledWords[n.Text]=n.HasSpellError)},n.prototype.clearCache=function(){sf.base.isNullOrUndefined(localStorage.getItem(this.uniqueKey))||localStorage.removeItem(this.uniqueKey)},n.prototype.createGuid=function(){var n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"===t?i:3&i|8).toString(16)})},n.prototype.checkSpellingInPageInfo=function(n){var t=JSON.parse(localStorage.getItem(this.uniqueKey));return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t[n])?{hasSpellError:!1,isElementPresent:!1}:{hasSpellError:t[n],isElementPresent:!0}},n.prototype.destroy=function(){this.errorWordCollection=void 0;this.ignoreAllItems=void 0;this.errorSuggestions=void 0;this.uniqueSpelledWords={};this.textSearchResults=void 0;sf.base.isNullOrUndefined(localStorage.getItem(this.uniqueKey))||localStorage.removeItem(this.uniqueKey)},n}(),gr=(er=function(n,t){return(er=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}er(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),lf=function(){function n(n){var t=this;this.scrollbarWidth=0;this.isWebPrinting=!1;this.isHeaderFooter=!1;this.currentPage=void 0;this.selectionStartPageIn=void 0;this.selectionEndPageIn=void 0;this.fieldStacks=[];this.showRevision=!1;this.splittedCellWidgets=[];this.tableLefts=[];this.tapCount=0;this.timer=-1;this.isTimerStarted=!1;this.isFirstLineFitInShiftWidgets=!1;this.preZoomFactor=0;this.preDifference=-1;this.fieldEndParagraph=void 0;this.fieldToLayout=void 0;this.backgroundColor="#FFFFFF";this.isMouseDown=!1;this.isMouseEntered=!1;this.scrollMoveTimer=0;this.isSelectionChangedOnMouseMoved=!1;this.isControlPressed=!1;this.isTouchInput=!1;this.isTouchMoved=!1;this.useTouchSelectionMark=!1;this.touchDownOnSelectionMark=0;this.isComposingIME=!1;this.lastComposedText="";this.isCompositionStart=!1;this.isCompositionUpdated=!1;this.isCompositionCanceled=!1;this.isCompositionEnd=!1;this.prefix="";this.suffix="";this.fields=[];this.heightInfoCollection={};this.defaultTabWidth=36;this.dontUseHtmlParagraphAutoSpacing=!1;this.alignTablesRowByRow=!1;this.compatibilityMode="Word2013";this.lists=[];this.comments=[];this.authors=new h;this.revisionsInternal=new h;this.commentUserOptionId=1;this.abstractLists=[];this.styles=new pr;this.preDefinedStyles=void 0;this.isRowOrCellResizing=!1;this.formFields=[];this.isMouseDownInFooterRegion=!1;this.pageFitTypeIn="None";this.fieldCollection=[];this.isPageField=!1;this.mouseDownOffset=new d(0,0);this.zoomFactorInternal=1;this.moveCaretPosition=0;this.isTextInput=!1;this.isScrollHandler=!1;this.triggerElementsOnLoading=!1;this.triggerSpellCheck=!1;this.restrictFormatting=!1;this.protectionType="NoProtection";this.isDocumentProtected=!1;this.hashValue="";this.saltValue="";this.userCollection=[];this.cachedPages=[];this.skipScrollToPosition=!1;this.isIosDevice=!1;this.isMobileDevice=!1;this.isFormFilling=!1;this.footnotes=new tr;this.endnotes=new tr;this.isFootnoteWidget=!1;this.onTextInput=function(n){if(!t.isComposingIME){n.preventDefault();var i=n.data;t.owner.editor.handleTextInput(i)}};this.compositionStart=function(){sf.base.Browser.isDevice||t.owner.isReadOnlyMode||(t.isComposingIME=!0,t.positionEditableTarget(),t.owner.editorHistory&&t.owner.editor.initComplexHistory("IMEInput"));t.isCompositionStart=!0};this.compositionUpdated=function(){t.isComposingIME&&!t.owner.isReadOnlyMode&&setTimeout(function(){t.owner.editor.insertIMEText(t.getEditableDivTextContent(),!0)},0);t.isCompositionUpdated=!0};this.compositionEnd=function(n){if(t.isComposingIME&&!t.owner.isReadOnlyMode){var i=t.getEditableDivTextContent();""!==i&&t.owner.editor.insertIMEText(i,!1);t.isComposingIME=!1;t.lastComposedText="";t.iframe.setAttribute("style","pointer-events:none;position:absolute;left:"+t.owner.viewer.containerLeft+"px;top:"+t.owner.viewer.containerTop+"px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden");t.editableDiv.innerHTML="";t.owner.editorHistory&&(t.owner.editorHistory.updateComplexHistory(),""===i&&(t.owner.editorHistory.undo(),t.owner.editorHistory.redoStack.pop()))}n.preventDefault();t.isCompositionUpdated=!1;t.isCompositionEnd=!0};this.onKeyPressInternal=function(n){var f=n.which||n.keyCode,r,e,u,i;t.triggerElementsOnLoading=!1;r=!(!n.ctrlKey&&!n.metaKey)||17===f;e=n.altKey?n.altKey:18===f;(sf.base.Browser.isIE&&e&&r&&(r=!1),r&&"v"===n.key||r&&"a"===n.key||(r||t.isControlPressed&&sf.base.Browser.isIE)&&"p"===n.key)?sf.base.Browser.isIE&&(t.isControlPressed=!1):(!t.owner.isReadOnlyMode||t.selection&&t.selection.isInlineFormFillMode())&&(u=n.keyCode||n.charCode,i="",u?i=String.fromCharCode(u):n.key&&(i=n.key)," "===i||"\r"===i||"\b"===i||"\x1b"===i||r?" "===i&&(t.triggerSpellCheck=!0,t.owner.editorModule.handleTextInput(" "),t.triggerSpellCheck=!1):t.owner.editorModule.handleTextInput(i),n.preventDefault())};this.onTextInputInternal=function(){t.owner.isReadOnlyMode?t.editableDiv.innerText="":t.owner.editorModule.onTextInputInternal()};this.onPaste=function(n){(!t.owner.isReadOnlyMode&&t.owner.editor.canEditContentControl||t.selection.isInlineFormFillMode())&&t.owner.editorModule.pasteInternal(n);t.editableDiv.innerText="";n.preventDefault()};this.onFocusOut=function(){sf.base.isNullOrUndefined(t.selection)||t.selection.hideCaret()};this.updateFocus=function(){!t.selection||t.isMobileDevice&&t.owner.isReadOnly||(sf.base.Browser.isDevice||sf.base.Browser.isIE||navigator.userAgent.match("Edge")||t.iframe.focus(),t.editableDiv.focus(),t.selection.showCaret())};this.scrollHandler=function(){t.scrollTimer&&clearTimeout(t.scrollTimer);t.clearContent();t.isScrollHandler=!0;sf.base.Browser.isDevice||t.isComposingIME||(t.iframe.style.top=t.owner.viewer.containerTop+"px",t.iframe.style.left=t.owner.viewer.containerLeft+"px");t.owner.viewer.updateScrollBars();var n=t.owner.viewer.containerTop+t.visibleBounds.height-(t.owner.viewer.padding.top+t.owner.viewer.padding.bottom);n>t.pageContainer.offsetHeight&&(t.viewerContainer.scrollTop=t.owner.viewer.containerTop-(n-t.pageContainer.offsetHeight));_instanceof(t.owner.viewer,rt)&&!sf.base.isNullOrUndefined(t.owner)&&t.owner.fireViewChange();t.isScrollHandler=!1;t.scrollTimer=setTimeout(function(){t.isScrollHandler||sf.base.isNullOrUndefined(t.owner)||!t.owner.isSpellCheck||(t.isScrollToSpellCheck=!0,t.owner.viewer.updateScrollBars())},200)};this.onWindowResize=function(){t.resizeTimer&&clearTimeout(t.resizeTimer);t.resizeTimer=setTimeout(function(){sf.base.isNullOrUndefined(t.owner)||sf.base.isNullOrUndefined(t.owner.element)||(t.updateViewerSize(),t.clearContent(),t.owner.viewer.updateScrollBars(),sf.base.isNullOrUndefined(t.selection)||t.selection.updateCaretPosition(),t.updateTouchMarkPosition(),t.resizeTimer&&clearTimeout(t.resizeTimer))},200)};this.onContextMenu=function(){};this.onMouseDownInternal=function(n){var u=n.target,f,r,i;if(!(!sf.base.isNullOrUndefined(u)&&u!==t.viewerContainer||t.isTouchInput||n.offsetX>t.visibleBounds.width-(t.visibleBounds.width-t.viewerContainer.clientWidth)||n.offsetY>t.visibleBounds.height-(t.visibleBounds.height-t.viewerContainer.clientHeight)||(t.isFootnoteWidget=!1,sf.base.isNullOrUndefined(t.selection)))){if((t.updateCursor(n),t.owner.hideFormFieldPopup(),t.isLeftButtonPressed(n)&&!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&!sf.base.isNullOrUndefined(t.owner.imageResizerModule.selectedResizeElement))&&(t.selection.isInShape&&(f=t.owner.selection.getCurrentTextFrame().containerShape,t.selection.selectShape(f)),t.owner.imageResizerModule.isImageResizing=!0),n.preventDefault(),t.isTouchInput||t.selection.hideCaret(),r=new d(n.offsetX,n.offsetY),i=t.owner.viewer.findFocusedPage(r,!0),t.mouseDownOffset.x=i.x,t.mouseDownOffset.y=i.y,t.isMouseDownInFooterRegion=t.selection.isCursorInsidePageRect(r,t.currentPage)&&t.selection.isCursorInFooterRegion(r,t.currentPage),t.isSelectionChangedOnMouseMoved=!1,!t.owner.isReadOnlyMode&&(t.owner.editorModule.tableResize.isInCellResizerArea(i)||t.owner.editorModule.tableResize.isInRowResizerArea(i)))return t.selection.hideCaret(),t.isMouseDown=!0,t.isSelectionChangedOnMouseMoved=!1,void(t.isLeftButtonPressed(n)&&(t.owner.editorModule.tableResize.startingPoint.x=i.x,t.owner.editorModule.tableResize.startingPoint.y=i.y,t.owner.editorModule.tableResize.handleResize(i)));if(n.ctrlKey&&(t.isControlPressed=!0),t.owner.selection.isEmpty&&(t.useTouchSelectionMark=!1),3===n.which&&!t.owner.selection.isEmpty&&t.selection.checkCursorIsInSelection(t.getLineWidget(i),i))return void n.preventDefault();t.isTouchInput=!1;t.isMouseDown=!0;t.updateFocus();t.timer=setTimeout(function(){t.tapCount++;t.tapCount>1&&(t.tapCount=1)},100)}};this.onMouseMoveInternal=function(n){var r,i,u,f;if((sf.base.isNullOrUndefined(n.target)||n.target===t.viewerContainer)&&(n.preventDefault(),!sf.base.isNullOrUndefined(t.selection))){if(!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)return void(t.owner.imageResizerModule.isImageMoveToNextPage||t.owner.imageResizerModule.handleImageResizingOnMouse(n));if(r=new d(n.offsetX,n.offsetY),i=t.owner.viewer.findFocusedPage(r,!t.owner.enableHeaderAndFooter),t.isMouseDown){if(!sf.base.isNullOrUndefined(t.currentPage))if(u=i.x,f=i.y,!t.owner.isReadOnlyMode&&t.isRowOrCellResizing){var e=t.owner.editorModule.tableResize.currentResizingTable,o=t.selection.setPositionForBlock(e,!0),s=t.selection.setPositionForBlock(e,!1);t.owner.documentHelper.isDocumentProtected&&!t.selection.checkSelectionIsAtEditRegion(o,s)||t.owner.editorModule.tableResize.handleResizing(i)}else if(t.isTouchInput||t.isSelectionChangedOnMouseMoved||t.touchDownOnSelectionMark>0||t.updateTextPositionForSelection(i,1),t.isLeftButtonPressed(n)){n.preventDefault();var h=f,c=t.owner.selection.end,l=new d(u,h);t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&!t.owner.imageResizerModule.isShapeResize||t.owner.selection.moveTextPosition(l,c);t.isSelectionChangedOnMouseMoved=!0}t.selection.checkForCursorVisibility()}t.isRowOrCellResizing||t.isSelectionChangedOnMouseMoved||t.updateCursor(n);t.isRowOrCellResizing&&t.selection.hideCaret()}};this.onMouseLeaveInternal=function(n){var i,r;n.preventDefault();i=new d(n.offsetX,n.offsetY);t.isMouseDown&&(r=t.viewerContainer.scrollTop,t.scrollMoveTimer=n.offsetY+r>r?setInterval(function(){t.scrollForwardOnSelection(i);clearInterval(t.scrollMoveTimer)},500):setInterval(function(){t.scrollBackwardOnSelection(i);clearInterval(t.scrollMoveTimer)},500),t.isMouseEntered&&(t.isMouseEntered=!1))};this.onMouseEnterInternal=function(){t.isMouseEntered||t.owner.viewer.updateScrollBars();t.isMouseEntered=!0;t.scrollMoveTimer&&clearInterval(t.scrollMoveTimer)};this.onDoubleTap=function(n){var c,a,v,u,l,h,r,y,o,p;if((sf.base.isNullOrUndefined(n.target)||n.target===t.viewerContainer)&&!sf.base.isNullOrUndefined(t.selection)){if(t.isTouchInput=!1,c=new d(n.offsetX,n.offsetY),a=t.owner.viewer.findFocusedPage(c,!0),t.selection.checkAndEnableHeaderFooter(c,t.owner.viewer.findFocusedPage(c,!0)))return;if(v=t.getLineWidget(a),u=t.selection.getHyperLinkFieldInCurrentSelection(v,a,!0),sf.base.isNullOrUndefined(u)&&(u=t.selection.getCurrentFormField()),!t.isDocumentProtected&&t.owner.enableFormField)l=t.selection.getFormFieldType(u),l&&(""!==l.toString()&&t.selection.selectField(u),t.owner.showDialog(l));else{if(!(t.isDocumentProtected&&u&&_instanceof(u.formFieldData,vt)&&"Text"===u.formFieldData.type))return void(t.tapCount=2);t.selection.selectField()}var f=t.selection.start.clone(),s=t.selection.end.clone(),e=f.currentWidget.getInline(f.offset,0).element;if("Pages"===t.owner.layoutType)if(_instanceof(e,yt))if("Footnote"===e.footnoteType){for(h=t.currentPage.footnoteWidget,r=void 0,r=1;r<=h.childWidgets.length;r++)if(y=h.childWidgets[r].footNoteReference,e.text===y.text)break;f.setPositionParagraph(h.childWidgets[r].childWidgets[0],0);s.setPositionParagraph(h.childWidgets[r].childWidgets[0],0);t.selection.selectRange(f,s)}else{if(o=t.pages[t.pages.length-1].endnoteWidget,r=void 0,!sf.base.isNullOrUndefined(o))for(r=1;r<=o.childWidgets.length;r++)if(p=o.childWidgets[r].footNoteReference,e.text===p.text)break;f.setPositionParagraph(o.childWidgets[r].childWidgets[0],0);s.setPositionParagraph(o.childWidgets[r].childWidgets[0],0);t.selection.selectRange(f,s)}else _instanceof(e,i)&&(t.selection.isinEndnote||t.selection.isinFootnote)&&t.selection.footnoteReferenceElement(f,s,e);!t.selection.isEmpty||sf.base.isNullOrUndefined(t.currentPage)||sf.base.isNullOrUndefined(t.owner.selection.start)||(t.owner.selection.selectCurrentWord(),t.selection.checkForCursorVisibility(),t.tapCount=2)}};this.onMouseUpInternal=function(n){var c,u,o,a,v,i,y,r,f,e,p,s,w,b,h;if((sf.base.isNullOrUndefined(n.target)||n.target===t.viewerContainer)&&(n.preventDefault(),t.isListTextSelected=!1,c=new d(n.offsetX,n.offsetY),u=t.owner.viewer.findFocusedPage(c,!0),!sf.base.isNullOrUndefined(t.selection))){if(o=1,sf.base.Browser.isIE?o=t.tapCount:n.detail>2&&(o=n.detail),t.isRowOrCellResizing&&t.owner.editorModule.tableResize.updateResizingHistory(u),!t.isMouseDown||t.isSelectionChangedOnMouseMoved||sf.base.isNullOrUndefined(t.currentPage)||sf.base.isNullOrUndefined(t.owner.selection.start)||t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing||(0!==t.touchDownOnSelectionMark||t.isRowOrCellResizing||(t.updateTextPositionForSelection(u,o),t.isLeftButtonPressed(n)||t.owner.fireSelectionChangeInternal(),sf.base.Browser.isIE&&2===o&&t.selection.checkAndEnableHeaderFooter(c,u)),t.selection.checkForCursorVisibility(),sf.base.isNullOrUndefined(t.currentSelectedComment)||(t.currentSelectedComment=void 0,t.owner.dotNetRef.invokeMethodAsync("SetSelectedComment",""))),a=t.isIosDevice?n.metaKey:n.ctrlKey,sf.base.isNullOrUndefined(t.currentPage)||sf.base.isNullOrUndefined(t.owner.selection.start)||!t.owner.selection.isEmpty&&!t.owner.selection.isImageSelected||!(a&&t.owner.useCtrlClickToFollowHyperlink||!t.owner.useCtrlClickToFollowHyperlink)||!0!==t.isLeftButtonPressed(n)||t.selection.navigateHyperLinkOnEvent(u,!1),t.isMouseDown&&t.isLeftButtonPressed(n)&&t.isDocumentProtected&&"FormFieldsOnly"===t.protectionType&&t.selection){if(v=t.getLineWidget(u),i=t.selection.getHyperLinkFieldInCurrentSelection(v,u,!0),sf.base.isNullOrUndefined(i)&&(i=t.selection.getCurrentFormField(!0)),i&&i.formFieldData&&i.formFieldData.enabled&&!t.selection.isInlineFormFillMode(i))if(y={fieldName:i.formFieldData.name},y.value=_instanceof(i.formFieldData,vt)?i.resultText:_instanceof(i.formFieldData,bt)?i.formFieldData.checked:i.formFieldData.selectedIndex,_instanceof(i.formFieldData,bt))t.owner.editor.toggleCheckBoxFormField(i);else{r={};_instanceof(i.formFieldData,kt)?(r.type="DropDown",r.defaultValue=i.formFieldData.dropdownItems,r.value=i.formFieldData.selectedIndex):(f=i.formFieldData,_instanceof(f,vt)&&(r.type="Text",e=i.resultText,p=new RegExp(t.owner.documentHelper.textHelper.getEnSpaceCharacter(),"gi"),(""===e.replace(p,"")&&(e=""),r.maxLength=i.formFieldData.maxLength,r.textFormType=i.formFieldData.type,r.defaultValue=i.formFieldData.defaultValue,r.value=e||"",r.textFormType="Text","Number"==f.type)?(r.textFormType="Number",r.format=f.format,r.value=parseFloat(e.replace(/,/gi,""))):"Date"==f.type&&(r.textFormType="Date",s=f.format,-1!==s.indexOf("am/pm")&&(s=s.replace(/am\/pm/gi,"a")),r.format=s,r.value=e)));var k=t.owner.selection.getLeftInternal(i.line,i,0),g=i.line.height*t.owner.documentHelper.zoomFactor,l=t.owner.selection.getTooltipPosition(i.line,k,370,100,!0);l.y=l.y+g;r.position=l;t.owner.showFormFieldPopup(r)}!i&&t.isFormFillProtectedMode&&t.selection.navigateToNextFormField()}else t.isMouseDown&&t.formFields.length>0&&((i=t.selection.getCurrentFormField(!0))&&_instanceof(i.formFieldData,vt)?t.selection.selectField():t.isLeftButtonPressed(n)&&i&&_instanceof(i.formFieldData,kt)&&(w=i.line.getOffset(i,0),b=t.selection.getPhysicalPositionInternal(i.line,w,!1),t.selection.selectInternal(i.line,i,0,b)));(!t.owner.isReadOnlyMode&&t.isSelectionInListText(u)&&t.selection.selectListText(),!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing&&(t.owner.imageResizerModule.mouseUpInternal(),t.scrollToPosition(t.owner.selection.start,t.owner.selection.end),t.owner.imageResizerModule.isImageResizing=!1),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&!sf.base.isNullOrUndefined(t.selection.caret)&&(t.selection.caret.style.display="none"),t.isMouseDown=!1,t.isFootnoteWidget=!1,t.isSelectionChangedOnMouseMoved=!1,t.isTouchInput=!1,t.useTouchSelectionMark=!0,t.isControlPressed=!1,t.updateFocus(),t.isListTextSelected&&t.selection.hideCaret(),t.owner.enableImageResizerMode)&&(h=t.owner.imageResizerModule,h.isImageResizing=!1,h.isImageMoveToNextPage=!1,h.leftValue=void 0,h.topValue=void 0);t.isMouseDownInFooterRegion=!1}};this.onTouchStartInternal=function(n){var i,f,r,u;t.selection&&((t.isTouchMoved=!1,t.isCompositionStart=!1,t.isCompositionEnd=!1,t.isCompositionUpdated=!1,t.isCompositionCanceled=!0,t.isTouchInput=!0,t.isTimerStarted?1===t.tapCount?t.tapCount=2:(t.tapCount=3,t.isTimerStarted=!1):(t.isTimerStarted=!0,t.tapCount=1),1===n.touches.length)&&(t.zoomX=n.touches[0].clientX,t.zoomY=n.touches[0].clientY,t.owner.selection.isEmpty&&(t.useTouchSelectionMark=!1),t.isMouseDown=!0,t.isSelectionChangedOnMouseMoved=!1,i=void 0,(t.isMouseDown&&(i=t.getTouchOffsetValue(n)),i=t.owner.viewer.findFocusedPage(i,!0),t.owner.enableImageResizerMode)&&(f=t.owner.imageResizerModule.getImagePointOnTouch(i),t.owner.imageResizerModule.selectedResizeElement=f.selectedElement),t.owner.enableImageResizerMode&&!sf.base.isNullOrUndefined(t.owner.imageResizerModule.selectedResizeElement)&&(t.owner.imageResizerModule.isImageResizing=!0),r=t.owner.selection.end.location.x,u=t.selection.getCaretBottom(t.owner.selection.end,t.owner.selection.isEmpty)+9,t.touchDownOnSelectionMark=(i.y<=u&&i.y>=u-20||i.y>=u&&i.y<=u+20)&&(i.x<=r&&i.x>=r-20||i.x>=r&&i.x<=r+20)?1:0,t.owner.selection.isEmpty||0!==t.touchDownOnSelectionMark||(r=t.owner.selection.start.location.x,u=t.selection.getCaretBottom(t.owner.selection.start,!1)+9,t.touchDownOnSelectionMark=(i.y<=u&&i.y>=u-20||i.y>=u&&i.y<=u+20)&&(i.x<=r&&i.x>=r-20||i.x>=r&&i.x<=r+20)?2:0)),(t.touchDownOnSelectionMark||n.touches.length>1)&&n.preventDefault(),t.longTouchTimer=setTimeout(t.onLongTouch,500,n),t.timer=setTimeout(function(){t.isTimerStarted=!1},200))};this.onLongTouch=function(n){var r,u;if(!(sf.base.isNullOrUndefined(t.owner)||sf.base.isNullOrUndefined(t.viewerContainer)||t.isTouchMoved||1!==n.touches.length)){var o=t.getTouchOffsetValue(n),i=t.owner.viewer.findFocusedPage(o,!0),f=t.selection.start,e=t.selection.end,s=!1;t.selection.isForward||(f=t.selection.end,e=t.selection.start);r=f.location;u=e.location;s=f.currentWidget!==e.currentWidget?!(i.x>=r.x&&i.x<=u.x||i.y>=r.y&&i.y<=u.y):!(i.x>=r.x&&i.x<=u.x&&i.y>=r.y&&i.y<=u.y);1===n.changedTouches.length&&s&&(t.updateSelectionOnTouch(o,i),t.isMouseDown=!1,t.touchDownOnSelectionMark=0,t.useTouchSelectionMark=!0,t.isSelectionChangedOnMouseMoved=!1);t.selection.isEmpty&&t.selection.selectCurrentWord()}};this.onTouchMoveInternal=function(n){var o,i,r,f,e,u;if(t.isTouchMoved=!0,i=n.touches,!sf.base.isNullOrUndefined(t.selection)){if(t.owner.editorModule&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)return n.preventDefault(),void(t.owner.imageResizerModule.isImageMoveToNextPage||(t.owner.imageResizerModule.handleImageResizingOnTouch(n),t.selection.caret.style.display="none"));t.isMouseDown&&(o=t.getTouchOffsetValue(n),r=t.owner.viewer.findFocusedPage(o,!0),t.touchDownOnSelectionMark>0&&(n.preventDefault(),f=r.y,e=t.owner.selection.end,f-=r.y<=26?r.y<0?0:r.y+.5:36.5,e=2===t.touchDownOnSelectionMark?t.selection.start:t.selection.end,r=new d(r.x,f),t.owner.selection.moveTextPosition(r,e),t.isSelectionChangedOnMouseMoved=!0),t.selection.checkForCursorVisibility(),t.updateTouchMarkPosition())}i.length>1&&(n.preventDefault(),t.isMouseDown=!1,t.zoomX=(i[0].clientX+i[1].clientX)/2,t.zoomY=(i[0].clientY+i[1].clientY)/2,u=Math.sqrt(Math.pow(i[0].clientX-i[1].clientX,2)+Math.pow(i[0].clientY-i[1].clientY,2)),t.preDifference>-1?u>t.preDifference?t.onPinchOutInternal(n):u<t.preDifference&&t.onPinchInInternal(n):t.zoomFactor<2?-1!==t.preDifference&&u>t.preDifference&&t.onPinchInInternal(n):-1===t.preDifference&&t.zoomFactor>2&&u>t.preDifference&&t.onPinchInInternal(n),t.preDifference=u);t.longTouchTimer&&(clearTimeout(t.longTouchTimer),t.longTouchTimer=void 0)};this.onTouchUpInternal=function(n){if(!sf.base.isNullOrUndefined(t.selection)){var i=t.getTouchOffsetValue(n),r=t.owner.viewer.findFocusedPage(i,!0);1===n.changedTouches.length&&((!t.isTouchMoved||t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)&&(t.updateSelectionOnTouch(i,r),sf.base.isNullOrUndefined(t.currentPage)||sf.base.isNullOrUndefined(t.selection.start)||t.isSelectionChangedOnMouseMoved||!(t.selection.isEmpty||t.selection.isImageField()&&(!t.owner.enableImageResizerMode||t.owner.enableImageResizerMode&&!t.owner.imageResizerModule.isImageResizing))||t.selection.navigateHyperLinkOnEvent(r,!0)),t.isMouseDown=!1,t.touchDownOnSelectionMark=0,t.useTouchSelectionMark=!0,t.isSelectionChangedOnMouseMoved=!1);t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing&&(t.owner.imageResizerModule.mouseUpInternal(),t.owner.imageResizerModule.isImageResizing=!1,t.owner.imageResizerModule.isImageMoveToNextPage=!1,t.scrollToPosition(t.owner.selection.start,t.owner.selection.end));t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&t.isTouchInput&&(t.touchStart.style.display="none",t.touchEnd.style.display="none");n.preventDefault()}t.preDifference=-1;t.isTouchInput=!1;t.longTouchTimer&&(clearTimeout(t.longTouchTimer),t.longTouchTimer=void 0);t.isTimerStarted||(t.tapCount=1);t.isListTextSelected&&t.selection.hideCaret()};this.onKeyUpInternal=function(n){sf.base.Browser.isDevice&&n.target===t.editableDiv&&window.getSelection().anchorOffset!==t.prefix.length&&t.selection.setEditableDivCaretPosition(t.editableDiv.innerText.length);(n.ctrlKey||17===n.keyCode||17===n.which)&&(t.isControlPressed=!1)};this.onKeyDownInternal=function(n){var i,u;if((sf.base.isNullOrUndefined(n.target)||n.target===t.editableDiv)&&(i=!1,u={event:n,isHandled:!1},t.owner.dotNetRef.invokeMethodAsync("KeyDown",u),!u.isHandled)){var r=n.which||n.keyCode,f=!(!n.ctrlKey&&!n.metaKey)||17===r,e=n.shiftKey?n.shiftKey:16===r,o=n.altKey?n.altKey:18===r;if(f&&!e&&!o)switch(r){case 80:n.preventDefault();t.owner.print();i=!0;break;case 83:n.preventDefault();t.owner.save(""===t.owner.documentName?"sample":t.owner.documentName,"Sfdt");i=!0}i||sf.base.isNullOrUndefined(t.selection)||t.selection.onKeyDownInternal(n,f,e,o);i&&n.preventDefault()}};this.owner=n;this.pages=[];this.lists=[];this.abstractLists=[];this.render=new rf(this);this.characterFormat=new p(this);this.paragraphFormat=new ut(this);this.renderedLists=new h;this.renderedLevelOverrides=[];this.headersFooters=[];this.styles=new pr;this.preDefinedStyles=new h;this.initalizeStyles();this.bookmarks=new h;this.editRanges=new h;this.isIosDevice=/Mac|iPad|iPod/i.test(navigator.userAgent);this.isMobileDevice=/Android|Windows Phone|webOS/i.test(navigator.userAgent);this.customXmlData=new h;this.contentControlCollection=[];this.footnoteCollection=[];this.endnoteCollection=[]}return Object.defineProperty(n.prototype,"visibleBounds",{get:function(){return this.visibleBoundsIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"containerCanvas",{get:function(){return sf.base.isNullOrUndefined(this.containerCanvasIn)&&(this.containerCanvasIn=document.createElement("canvas"),this.containerCanvasIn.getContext("2d").save()),sf.base.isNullOrUndefined(this.pageContainer)||this.containerCanvasIn.parentElement===this.pageContainer||this.pageContainer.appendChild(this.containerCanvasIn),this.containerCanvasIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionCanvas",{get:function(){return sf.base.isNullOrUndefined(this.selectionCanvasIn)&&(this.selectionCanvasIn=document.createElement("canvas"),this.selectionCanvas.getContext("2d").save()),sf.base.isNullOrUndefined(this.pageContainer)||this.selectionCanvasIn.parentElement===this.pageContainer||this.pageContainer.appendChild(this.selectionCanvasIn),this.selectionCanvasIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"containerContext",{get:function(){return this.containerCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentRenderingPage",{get:function(){if(0!==this.pages.length)return this.pages[this.pages.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"zoomFactor",{get:function(){return this.zoomFactorInternal},set:function(n){this.zoomFactorInternal!==n&&(this.preZoomFactor=this.zoomFactor,this.zoomFactorInternal=n,this.zoomModule.setZoomFactor(),this.owner.zoomFactor=n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selection",{get:function(){return this.owner.selection},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionStartPage",{get:function(){return this.selectionStartPageIn},set:function(n){this.selectionStartPageIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionEndPage",{get:function(){return this.selectionEndPageIn},set:function(n){this.selectionEndPageIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentSelectedComment",{get:function(){return this.currentSelectedCommentInternal},set:function(n){this.selection&&(this.selection.updatePreviousCommentMark(n),this.selection.hightlightCommentSelectionMark());this.currentSelectedCommentInternal=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentSelectedRevision",{get:function(){return this.currentSelectedRevisionInternal},set:function(n){this.currentSelectedRevisionInternal=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isInlineFormFillProtectedMode",{get:function(){return this.isFormFillProtectedMode&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isFormFillProtectedMode",{get:function(){return this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType},enumerable:!0,configurable:!0}),n.prototype.initalizeStyles=function(){this.preDefinedStyles.add("Normal",'{"type":"Paragraph","name":"Normal","next":"Normal"}');this.preDefinedStyles.add("Heading 1",'{"type":"Paragraph","name":"Heading 1","basedOn":"Normal","next":"Normal","link":"Heading 1 Char","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":12.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level1"}}');this.preDefinedStyles.add("Heading 2",'{"type":"Paragraph","name":"Heading 2","basedOn":"Normal","next":"Normal","link":"Heading 2 Char","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level2"}}');this.preDefinedStyles.add("Heading 3",'{"type":"Paragraph","name":"Heading 3","basedOn":"Normal","next":"Normal","link":"Heading 3 Char","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level3"}}');this.preDefinedStyles.add("Heading 4",'{"type":"Paragraph","name":"Heading 4","basedOn":"Normal","next":"Normal","link":"Heading 4 Char","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level4"}}');this.preDefinedStyles.add("Heading 5",'{"type":"Paragraph","name":"Heading 5","basedOn":"Normal","next":"Normal","link":"Heading 5 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level5"}}');this.preDefinedStyles.add("Heading 6",'{"type":"Paragraph","name":"Heading 6","basedOn":"Normal","next":"Normal","link":"Heading 6 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level6"}}');this.preDefinedStyles.add("Default Paragraph Font",'{"type":"Character","name":"Default Paragraph Font"}');this.preDefinedStyles.add("Heading 1 Char",'{"type":"Character","name":"Heading 1 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}');this.preDefinedStyles.add("Heading 2 Char",'{"type":"Character","name":"Heading 2 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}');this.preDefinedStyles.add("Heading 3 Char",'{"type":"Character","name":"Heading 3 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor": "#1F3763"}}');this.preDefinedStyles.add("Heading 4 Char",'{"type":"Character","name":"Heading 4 Char","basedOn":"Default Paragraph Font","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}');this.preDefinedStyles.add("Heading 5 Char",'{"type":"Character","name":"Heading 5 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"}}');this.preDefinedStyles.add("Heading 6 Char",'{"type":"Character","name":"Heading 6 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"}}');this.preDefinedStyles.add("Hyperlink",'{"type":"Character","name":"Hyperlink","basedOn":"Default Paragraph Font","next":"Normal","characterFormat":{"fontColor":"#0563C1","underline": "Single"}}');this.preDefinedStyles.add("Toc1",'{"type":"Paragraph","name":"Toc1","basedOn":"Normal","next":"Normal","paragraphFormat":{"afterSpacing":5.0}}');this.preDefinedStyles.add("Toc2",'{"type":"Paragraph","name":"Toc2","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :11.0,"afterSpacing":5.0}}');this.preDefinedStyles.add("Toc3",'{"type":"Paragraph","name":"Toc3","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :22.0,"afterSpacing":5.0}}');this.preDefinedStyles.add("Toc4",'{"type":"Paragraph","name":"Toc4","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :33.0,"afterSpacing":5.0}}');this.preDefinedStyles.add("Toc5",'{"type":"Paragraph","name":"Toc5","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :44.0,"afterSpacing":5.0}}');this.preDefinedStyles.add("Toc6",'{"type":"Paragraph","name":"Toc6","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :55.0,"afterSpacing":5.0}}');this.preDefinedStyles.add("Toc7",'{"type":"Paragraph","name":"Toc7","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :66.0,"afterSpacing":5.0}}');this.preDefinedStyles.add("Toc8",'{"type":"Paragraph","name":"Toc8","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :77.0,"afterSpacing":5.0}}');this.preDefinedStyles.add("Toc9",'{"type":"Paragraph","name":"Toc9","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :88.0,"afterSpacing":5.0}}')},n.prototype.clearDocumentItems=function(){var n,t;for(this.editRanges.clear(),this.headersFooters=[],this.fields=[],this.formFields=[],this.currentSelectedComment=void 0,this.currentSelectedRevision=void 0,n=0;n<this.comments.length;n++)t=this.comments[n].commentStart,t&&t.destroy();this.comments=[];this.bookmarks.clear();this.styles.clear();this.authors.clear();this.revisionsInternal.clear();this.owner.revisions.destroy();this.characterFormat.clearFormat();this.paragraphFormat.clearFormat();this.owner.trackChangesPane&&this.owner.trackChangesPane.clear();this.setDefaultCharacterValue(this.characterFormat);this.setDefaultParagraphValue(this.paragraphFormat);this.isHeaderFooter=!1;this.defaultTabWidth=36;this.isDocumentProtected=!1;this.protectionType="NoProtection";this.restrictFormatting=!1;this.hashValue="";this.saltValue="";this.userCollection=[];this.customXmlData.clear();this.contentControlCollection=[];this.endnotes.clear();this.footnotes.clear();this.footnoteCollection=[];this.endnoteCollection=[]},n.prototype.setDefaultDocumentFormat=function(){this.owner.parser.parseCharacterFormat(this.owner.characterFormat,this.characterFormat);this.owner.parser.parseParagraphFormat(this.owner.paragraphFormat,this.paragraphFormat)},n.prototype.setDefaultCharacterValue=function(n){n.bold=!1;n.italic=!1;n.fontFamily="Calibri";n.fontSize=11;n.underline="None";n.strikethrough="None";n.fontSizeBidi=11;n.fontFamilyBidi="Calibri";n.baselineAlignment="Normal";n.highlightColor="NoColor";n.fontColor="#00000000";n.allCaps=!1},n.prototype.setDefaultParagraphValue=function(n){n.leftIndent=0;n.rightIndent=0;n.firstLineIndent=0;n.textAlignment="Left";n.beforeSpacing=0;n.afterSpacing=0;n.lineSpacing=1;n.lineSpacingType="Multiple";n.bidi=!1;n.keepWithNext=!1;n.keepLinesTogether=!1;n.widowControl=!0},n.prototype.getAbstractListById=function(n){var t,i;if(!sf.base.isNullOrUndefined(this.abstractLists))for(t=0;t<this.abstractLists.length;t++)if(i=this.abstractLists[t],_instanceof(i,wi)&&i.abstractListId===n)return i},n.prototype.getListById=function(n){if(!sf.base.isNullOrUndefined(this.lists))for(var t=0;t<this.lists.length;t++)if(!sf.base.isNullOrUndefined(this.lists[t])&&this.lists[t].listId===n)return this.lists[t]},n.getListLevelNumber=function(n){return _instanceof(n.ownerBase,nr)?n.ownerBase.levelNumber:_instanceof(n.ownerBase,wi)&&!sf.base.isNullOrUndefined(n.ownerBase.levels)?n.ownerBase.levels.indexOf(n):-1},n.prototype.getBookmarks=function(n){for(var r,i=[],t=0;t<this.bookmarks.keys.length;t++)r=this.bookmarks.keys[t],(n||0!==r.indexOf("_"))&&i.push(r);return i},n.prototype.selectComment=function(n){var t=this;this.owner.selection&&setTimeout(function(){t.owner&&t.owner.selection&&t.owner.selection.selectComment(n)})},n.prototype.showComments=function(n){this.owner&&n&&this.owner.enableComment},n.prototype.showRevisions=function(n){this.owner;!n&&this.owner.showComments||(this.showRevision||this.owner.enableTrackChanges||!this.owner.showRevisions?(this.owner.dotNetRef.invokeMethodAsync("ShowRevisions",n),this.owner.enableComment,this.showRevision=!1):(this.owner.dotNetRef.invokeMethodAsync("ShowRevisions",!n),this.owner.showRevisions=!1));n&&this.owner.trackChangesPane.enableDisableButton(!this.owner.isReadOnly)},n.prototype.initializeComponents=function(){var n=this.owner.element;sf.base.isNullOrUndefined(n)||(this.optionsPaneContainer=this.owner.element.getElementsByClassName("e-documenteditor-optionspane")[0],sf.base.isNullOrUndefined(this.optionsPaneContainer)&&(this.optionsPaneContainer=sf.base.createElement("div",{className:"e-documenteditor-optionspane"}),n.appendChild(this.optionsPaneContainer)),this.restrictEditingElement=this.owner.element.getElementsByClassName("e-de-restrict-pane")[0],this.optionsPaneElement=this.owner.element.getElementsByClassName("e-de-op")[0],this.commentPaneElement=this.owner.element.getElementsByClassName("e-de-review-pane")[0],this.viewerContainer=this.owner.element.getElementsByClassName("e-de-viewercontainer")[0],sf.base.isNullOrUndefined(this.viewerContainer)&&(this.viewerContainer=sf.base.createElement("div",{id:this.owner.containerId+"_viewerContainer"}),this.optionsPaneContainer.appendChild(this.viewerContainer)),this.viewerContainer.style.cssText="position:relative;backgroundColor:#FBFBFB;overflow:auto;direction:ltr;",this.viewerContainer.tabIndex=0,this.viewerContainer.style.outline="none",this.pageContainer=sf.base.createElement("div",{id:this.owner.containerId+"_pageContainer",className:"e-de-background"}),this.viewerContainer.appendChild(this.pageContainer),this.pageContainer.style.top="0px",this.pageContainer.style.left="0px",this.pageContainer.style.position="relative",this.pageContainer.style.pointerEvents="none",sf.base.Browser.isDevice?this.createEditableDiv(n):this.createEditableIFrame(),this.owner.enableImageResizerMode&&this.owner.imageResizerModule.initializeImageResizer(),this.updateViewerSizeInternal(n),this.layout=new dr(this),this.textHelper=new uf(this),this.zoomModule=new ff(this),this.initTouchEllipse(),this.wireEvent(),this.owner.trackChangesPane=new ef(this.owner),this.owner.spellCheckerModule=new cf(this.owner.documentHelper))},n.prototype.measureScrollbarWidth=function(n){var t=document.createElement("div"),i;t.setAttribute("style","visibility:hidden;overflow:scroll");n.appendChild(t);i=document.createElement("div");t.appendChild(i);this.scrollbarWidth=t.getBoundingClientRect().width-i.getBoundingClientRect().width;t.parentNode.removeChild(t)},n.prototype.createEditableDiv=function(n){this.editableDiv=document.createElement("div");this.editableDiv.contentEditable="true";this.editableDiv.style.position="fixed";this.editableDiv.style.left="-150em";this.editableDiv.style.width="100%";this.editableDiv.style.height="100%";this.editableDiv.id=n.id+"_editableDiv";document.body.appendChild(this.editableDiv)},n.prototype.createEditableIFrame=function(){this.iframe=sf.base.createElement("iframe",{attrs:{scrolling:"no",style:"pointer-events:none;position:absolute;left:0px;top:0px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden"},className:"e-de-text-target"});this.viewerContainer.appendChild(this.iframe);this.initIframeContent()},n.prototype.initIframeContent=function(){this.iframe.contentDocument.open();this.iframe.contentDocument.write('<!DOCTYPE html><html><head><\/head><body spellcheck="false" style=background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px; ><div contenteditable="true" style=background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;><\/div><\/body><\/html>');this.iframe.contentDocument.close();this.editableDiv=this.iframe.contentDocument.body.children[0]},n.prototype.wireEvent=function(){sf.base.isNullOrUndefined(this.selection)||this.selection.initCaret();this.wireInputEvents();sf.base.isNullOrUndefined(this.iframe)||this.iframe.addEventListener("load",this.onIframeLoad.bind(this));this.viewerContainer.addEventListener("scroll",this.scrollHandler);this.viewerContainer.addEventListener("mousedown",this.onMouseDownInternal);this.viewerContainer.addEventListener("keydown",this.onKeyDownInternal);this.viewerContainer.addEventListener("mousemove",this.onMouseMoveInternal);this.viewerContainer.addEventListener("mouseleave",this.onMouseLeaveInternal);this.viewerContainer.addEventListener("mouseenter",this.onMouseEnterInternal);this.viewerContainer.addEventListener("contextmenu",this.onContextMenu);this.viewerContainer.addEventListener("dblclick",this.onDoubleTap);this.viewerContainer.addEventListener("mouseup",this.onMouseUpInternal);window.addEventListener("resize",this.onWindowResize);window.addEventListener("keyup",this.onKeyUpInternal);window.addEventListener("mouseup",this.onImageResizer.bind(this));window.addEventListener("touchend",this.onImageResizer.bind(this));this.viewerContainer.addEventListener("touchstart",this.onTouchStartInternal);this.viewerContainer.addEventListener("touchmove",this.onTouchMoveInternal);this.viewerContainer.addEventListener("touchend",this.onTouchUpInternal);navigator.userAgent.match("Firefox")&&this.viewerContainer.addEventListener("DOMMouseScroll",this.zoomModule.onMouseWheelInternal.bind(this));this.viewerContainer.addEventListener("mousewheel",this.zoomModule.onMouseWheelInternal.bind(this))},n.prototype.wireInputEvents=function(){sf.base.isNullOrUndefined(this.editableDiv)||(this.editableDiv.addEventListener("paste",this.onPaste),sf.base.Browser.isDevice?this.editableDiv.addEventListener("input",this.onTextInputInternal):(this.editableDiv.addEventListener("keypress",this.onKeyPressInternal),"chrome"===sf.base.Browser.info.name&&this.editableDiv.addEventListener("textInput",this.onTextInput)),this.editableDiv.addEventListener("blur",this.onFocusOut),this.editableDiv.addEventListener("keydown",this.onKeyDownInternal),this.editableDiv.addEventListener("compositionstart",this.compositionStart),this.editableDiv.addEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.addEventListener("compositionend",this.compositionEnd))},n.prototype.onIframeLoad=function(){sf.base.isNullOrUndefined(this.iframe)||0!==this.iframe.contentDocument.body.children.length||(this.initIframeContent(),this.wireInputEvents())},n.prototype.getEditableDivTextContent=function(){return this.editableDiv.textContent},n.prototype.updateAuthorIdentity=function(){for(var t=this.owner.revisions.changes,n=0;n<t.length;n++)this.getAuthorColor(t[n].author)},n.prototype.getAvatar=function(n,t,i,r){var f,u,s,e,o,h;(sf.base.isNullOrUndefined(i)?f=r.author:(f=i.author,u=i.initial),sf.base.isNullOrUndefined(f))||(s=sf.base.createElement("div",{className:"e-de-cmt-avatar"}),e=sf.base.createElement("div",{className:"e-de-ff-cmt-avatar"}),(e.style.backgroundColor=this.owner.documentHelper.getAuthorColor(f),""===u||sf.base.isNullOrUndefined(u))?(o=f.split(" "),h=o[0].charAt(0),o.length>1&&(h+=o[o.length-1][0]),e.innerText=h.toUpperCase()):e.innerText=u.length>2?u.substring(0,2):u,s.appendChild(e),s.appendChild(t),n.appendChild(s))},n.prototype.getAuthorColor=function(n){if(this.authors.containsKey(n))return this.authors.get(n);var t=this.owner.userColor;return n!==this.owner.currentUser&&(t=0===this.authors.length&&"#b5082e"!==t?"#b5082e":this.generateRandomColor()),this.authors.add(n,t),t},n.prototype.generateRandomColor=function(){return["#b5082e","#2e97d3","#bb00ff","#f37e43","#03a60b","#881824","#e09a2b","#50565e"][this.authors.length%8]},n.prototype.positionEditableTarget=function(){var u=this.selection.getRect(this.selection.start),f=this.selection.getSelectionPage(this.selection.start),i=f.bodyWidgets[0].sectionFormat,e=f.boundingRectangle.x+t.convertPointToPixel(i.leftMargin)*this.zoomFactor,o=u.y,s=i.pageWidth-i.leftMargin-i.rightMargin,r="left:"+e+"px;",n;r+="top:"+o+"px;";r+="width:"+t.convertPointToPixel(s)*this.zoomFactor+"px;";r+="height:250px;outline-style:none;position:absolute";this.iframe.setAttribute("style",r);n="background-color:transparent;width:100%;height:250px;padding: 0px; margin: 0px;";n+="text-indent:"+(u.x-e)+"px;";n+="color:transparent;pointer-events:none;outline-style:none;";n+="font-size:"+t.convertPointToPixel(this.selection.characterFormat.fontSize)*this.zoomFactor+"px;";n+="font-family"+this.selection.characterFormat.fontFamily+";";n+="overflow:hidden;text-decoration:none;white-space:normal;";this.editableDiv.setAttribute("style",n)},n.prototype.onImageResizer=function(n){!sf.base.isNullOrUndefined(this.owner)&&!sf.base.isNullOrUndefined(this.owner.imageResizerModule)&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.isImageResizing&&(_instanceof(n,MouseEvent)?this.onMouseUpInternal(n):_instanceof(n,TouchEvent)&&this.onTouchUpInternal(n));this.scrollMoveTimer&&(this.isMouseEntered=!0,clearInterval(this.scrollMoveTimer))},n.prototype.initDialog=function(){},n.prototype.initDialog3=function(){},n.prototype.hideDialog=function(){this.updateFocus()},n.prototype.initDialog2=function(){},n.prototype.clearContent=function(){if(this.containerContext.clearRect(0,0,this.containerCanvas.width,this.containerCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height),this.pageContainer)for(var t=this.pageContainer.getElementsByClassName("e-de-cmt-mark"),n=0;n<t.length;n++)t[n].style.display="none"},n.prototype.onDocumentChanged=function(n){this.clearContent();this.owner.editorModule&&(this.owner.editorModule.tocStyles={},this.owner.editorModule.tocBookmarkId=0);this.heightInfoCollection={};this.owner.isDocumentLoaded=!1;this.updateAuthorIdentity();for(var t=0;t<this.pages.length;t++)this.pages[t].bodyWidgets[0].destroy();this.pages=[];sf.base.isNullOrUndefined(this.renderedLists)||this.renderedLists.clear();sf.base.isNullOrUndefined(this.renderedLevelOverrides)||(this.renderedLevelOverrides=[]);sf.base.isNullOrUndefined(this.owner.editorHistory)||this.owner.editorHistory.destroy();this.owner.isDocumentLoaded=!0;this.layout.isInitialLoad=!0;this.layout.footHeight=0;this.layout.footnoteHeight=0;this.layout.layoutItems(n,!1);this.owner.selection&&(this.selection.previousSelectedFormField=void 0,this.formFields.length>0&&this.owner.selection.highlightFormFields(),this.owner.selection.editRangeCollection=[],this.owner.selection.selectRange(this.owner.documentStart,this.owner.documentStart),this.isDocumentProtected&&(this.owner.selection.isHighlightEditRegion=!0));this.owner.optionsPaneModule;this.owner.showRevisions&&this.owner.trackChangesPane.updateTrackChanges(!0);!sf.base.isNullOrUndefined(this.owner.selection)&&this.owner.selection.isViewPasteOptions&&(this.owner.selection.isViewPasteOptions=!1,this.owner.selection.showHidePasteOptions(void 0,void 0));this.owner.fireDocumentChange()},n.prototype.initTouchEllipse=function(){var n="height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5",t=" height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;box-sizing: unset;",i,r;this.touchStart=sf.base.createElement("div",{className:"e-touch-ellipse",styles:n});i=sf.base.createElement("div",{styles:t});this.touchEnd=sf.base.createElement("div",{className:"e-touch-ellipse",styles:n});this.touchStart.style.display="none";r=sf.base.createElement("div",{styles:t});this.touchStart.appendChild(i);this.touchEnd.appendChild(r);this.touchEnd.style.display="none";this.viewerContainer.appendChild(this.touchStart);this.viewerContainer.appendChild(this.touchEnd)},n.prototype.updateTouchMarkPosition=function(){if("none"!==this.touchStart.style.display&&!sf.base.isNullOrUndefined(this.selection))if(this.selection.isEmpty)this.selection.updateCaretPosition();else{var t=this.selection.getCaretBottom(this.selection.start,!1),n=this.selection.getPage(this.selection.start.paragraph),i=n.boundingRectangle.y-this.owner.viewer.pageGap*(this.pages.indexOf(n)+1)*this.zoomFactor+this.owner.viewer.pageGap*(this.pages.indexOf(n)+1);this.touchStart.style.left=n.boundingRectangle.x+(Math.round(this.selection.start.location.x)*this.zoomFactor-14)+"px";this.touchStart.style.top=i+t*this.zoomFactor+"px";this.selection.isEmpty||(t=this.selection.getCaretBottom(this.selection.end,!1),n=this.selection.getPage(this.selection.end.paragraph));this.touchEnd.style.left=n.boundingRectangle.x+(Math.round(this.selection.end.location.x)*this.zoomFactor-14)+"px";this.touchEnd.style.top=i+t*this.zoomFactor+"px"}},n.prototype.scrollForwardOnSelection=function(n){if(this.viewerContainer){this.viewerContainer.scrollTop=this.viewerContainer.scrollTop+200;var t=this.owner.viewer.findFocusedPage(n,!this.owner.enableHeaderAndFooter),i=this.owner.selection.end;this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize||this.owner.selection.moveTextPosition(t,i)}},n.prototype.scrollBackwardOnSelection=function(n){this.viewerContainer.scrollTop=this.viewerContainer.scrollTop-200;var t=this.owner.viewer.findFocusedPage(n,!this.owner.enableHeaderAndFooter),i=this.owner.selection.end;this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize||this.owner.selection.moveTextPosition(t,i)},n.prototype.isSelectionInListText=function(n){var t=this.getLineWidget(n);if(!sf.base.isNullOrUndefined(t)&&_instanceof(t.children[0],o)){var i=this.getLeftValue(t),r=t.children[0].width,u=t.children[0].height;if(this.isInsideRect(i,t.paragraph.y,r,u,n))return this.selectionLineWidget=t,!0}return!1},n.prototype.isInShapeBorder=function(n,t){var r,u,i;return!sf.base.isNullOrUndefined(n)&&(r=n.width,u=n.height,this.isInsideRect(n.x-n.margin.left,n.y-n.margin.top,r,u,t)&&(_instanceof(n,v)||_instanceof(n,nt)&&(i=n.lineFormat.weight,!this.isInsideRect(n.x+i,n.y+i+n.textFrame.marginTop,r-2*i,u-(2*i+n.textFrame.marginTop+n.textFrame.marginBottom),t))))?!0:!1},n.prototype.isInsideRect=function(n,t,i,r,u){return u.x>n&&u.x<=n+i&&u.y>t&&u.y<=t+r},n.prototype.getLeftValue=function(n){var i=n.paragraph.x,r=n.paragraph.paragraphFormat,u;return this.selection.isParagraphFirstLine(n)&&("Right"===r.textAlignment?(i-=t.convertPointToPixel(r.firstLineIndent),i-=t.convertPointToPixel(r.leftIndent)):i+=t.convertPointToPixel(r.firstLineIndent)),u=n.children[0],_instanceof(u,o)&&(i+=u.margin.left),i},n.prototype.isLeftButtonPressed=function(n){return this.isTouchInput=!1,1===(n.which||n.button)},n.prototype.updateSelectionOnTouch=function(n,t){this.zoomX=void 0;this.zoomY=void 0;!this.isMouseDown||this.isSelectionChangedOnMouseMoved||sf.base.isNullOrUndefined(this.currentPage)||sf.base.isNullOrUndefined(this.owner.selection.start)||(0===this.touchDownOnSelectionMark&&(this.updateTextPositionForSelection(new d(t.x,t.y),this.tapCount),2===this.tapCount&&this.selection.checkAndEnableHeaderFooter(n,t)),this.owner.selection.isEmpty&&this.selection.updateCaretPosition(),this.selection.checkForCursorVisibility())},n.prototype.getTouchOffsetValue=function(n){var i=this.viewerContainer.getBoundingClientRect(),t=n.touches[0],r,u;return sf.base.isNullOrUndefined(t)&&(t=n.changedTouches[0]),r=t.pageX-i.left,u=t.pageY-i.top,new d(r,u)},n.prototype.onPinchInInternal=function(){this.preZoomFactor=this.zoomFactor;var n=this.zoomFactor-.01;n<5&&n>2&&(n-=.01);n<.1&&(n=.1);this.zoomFactor=n},n.prototype.onPinchOutInternal=function(){this.preZoomFactor=this.zoomFactor;var n=this.zoomFactor+.01;n>2&&(n+=.01);n>5&&(n=5);this.zoomFactor=n},n.prototype.getPageWidth=function(n){return n.boundingRectangle.width},n.prototype.removePage=function(n){var i,u,t,r;for(this.currentPage===n&&(this.currentPage=void 0),i=this.pages.indexOf(n),(this.pages.splice(i,1),!sf.base.isNullOrUndefined(this.owner.viewer.visiblePages)&&this.owner.viewer.visiblePages.indexOf(n)>-1)&&(u=this.owner.viewer.visiblePages.indexOf(n),this.owner.viewer.visiblePages.splice(u,1)),t=0;t<this.pages.length;t++)this.pages[t].boundingRectangle.height;if(n.boundingRectangle.height,r=20,i>0&&(r+=this.pages[i-1].boundingRectangle.bottom),-1!==i)for(t=i;t<this.pages.length;t++)(n=this.pages[t]).boundingRectangle=new b(n.boundingRectangle.x,r,n.boundingRectangle.width,n.boundingRectangle.height),r=n.boundingRectangle.bottom+20,n.repeatHeaderRowTableWidget=!1},n.prototype.updateViewerSize=function(){var n=this,t=this.owner.getDocumentEditorElement();this.updateViewerSizeInternal(t);this.owner.viewer.updateScrollBars();_instanceof(this.owner.viewer,at)&&!sf.base.isNullOrUndefined(this.owner)&&!sf.base.isNullOrUndefined(t)&&(this.resizerTimer&&clearTimeout(this.resizerTimer),this.resizerTimer=setTimeout(function(){if(!sf.base.isNullOrUndefined(n.owner)){var t=void 0;t=sf.base.isNullOrUndefined(n.visibleBounds)?0:n.visibleBounds.width;sf.base.isNullOrUndefined(n.owner.viewer.preVisibleWidth)&&(n.owner.viewer.preVisibleWidth=0);sf.base.isNullOrUndefined(n.visibleBounds)||t===n.owner.viewer.preVisibleWidth||(n.owner.editorModule.layoutWholeDocument(),n.owner.viewer.preVisibleWidth=t);n.resizerTimer&&clearTimeout(n.resizerTimer)}},50));sf.base.isNullOrUndefined(this.selection)||this.selection.updateCaretPosition()},n.prototype.updateViewerSizeInternal=function(n){var r;if(!sf.base.isNullOrUndefined(n)){var t=n.getBoundingClientRect(),i=0,u=t.height>0?t.height:200;var f=void 0,e=void 0,o=void 0;(this.restrictEditingElement&&(f="none"!==this.restrictEditingElement.style.display?this.restrictEditingElement.getBoundingClientRect():void 0),this.optionsPaneElement&&(e="none"!==this.optionsPaneElement.style.display?this.optionsPaneElement.getBoundingClientRect():void 0),this.commentPaneElement&&(o="none"!==this.commentPaneElement.style.display?this.commentPaneElement.getBoundingClientRect():void 0),f||e||o)?(r=f?f.width:0,r+=e?e.width:0,r+=o?o.width:0,i=t.width-r>0?t.width-r:200):i=t.width>0?t.width:200;this.viewerContainer.style.height=u.toString()+"px";this.viewerContainer.style.width=Math.ceil(i)+"px";this.visibleBoundsIn=new b(0,0,i,u);this.containerCanvas.width=i;this.containerCanvas.height=u;this.selectionCanvas.width=i;this.selectionCanvas.height=u;this.measureScrollbarWidth(n)}},n.prototype.insertPage=function(n,t){var i,r;for(this.pages.indexOf(t)>-1&&this.pages.splice(this.pages.indexOf(t),1),this.pages.splice(n,0,t),i=20,n>0&&(i+=this.pages[n-1].boundingRectangle.bottom),r=n;r<this.pages.length;r++)(t=this.pages[r]).boundingRectangle=new b(t.boundingRectangle.x,i,t.boundingRectangle.width,t.boundingRectangle.height),i=t.boundingRectangle.bottom+20},n.prototype.updateTextPositionForSelection=function(n,t){var i=this.getLineWidget(n);if(sf.base.isNullOrUndefined(i)||this.selection.updateTextPosition(i,n),t>1){if(this.isMouseDown=!1,this.useTouchSelectionMark=!1,0===this.pages.length)return;sf.base.isNullOrUndefined(this.currentPage)||sf.base.isNullOrUndefined(this.owner.selection.start)||(t%2==0?this.owner.selection.selectCurrentWord():this.owner.selection.selectParagraph())}},n.prototype.scrollToPosition=function(n,t,i){var r,o,c,u,f,e,l,h;if(this.skipScrollToPosition||this.isWebPrinting)this.skipScrollToPosition=!1;else if(!(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizing||this.isMouseDownInFooterRegion||this.isRowOrCellResizing)&&(r=this.selection.getLineWidgetInternal(t.currentWidget,t.offset,!0),!sf.base.isNullOrUndefined(r)&&(this.selection.getTop(r),this.isMouseDown&&(o=this.selection.getLineWidgetInternal(t.currentWidget,t.offset,!1),c=this.selection.getTop(o),o!==r&&t.location.y>=c&&(r=o)),r.height,u=this.selection.getPage(r.paragraph),this.currentPage=u,f=0,e=0,this.owner.viewer,this.owner.viewer,!sf.base.isNullOrUndefined(u)))){l=u.boundingRectangle.width;(f=(this.visibleBounds.width-l*this.zoomFactor)/2)<30&&(f=30);e=u.boundingRectangle.y*this.zoomFactor+(this.pages.indexOf(u)+1)*this.owner.viewer.pageGap*(1-this.zoomFactor);var a=this.owner.viewer.containerTop,s=this.owner.viewer.containerLeft,v=this.visibleBounds.height,y=this.selection.updateCaretSize(this.owner.selection.end,!0),w=y.topMargin,p=y.height;f+=t.location.x*this.zoomFactor;a+20>(e+=(t.location.y+w)*this.zoomFactor)?this.viewerContainer.scrollTop=e-10:a+v<e+p&&(this.viewerContainer.scrollTop=e+p-v+10);i||this.selection.updateCaretToPage(n,u);h=this.viewerContainer.offsetWidth-this.viewerContainer.clientWidth;s>f?this.viewerContainer.scrollLeft=f-this.pageContainer.offsetWidth/5:s+this.visibleBounds.width<f+h&&(this.viewerContainer.scrollLeft=s+this.pageContainer.offsetWidth/100*15+h)}},n.prototype.getLineWidget=function(n){return this.getLineWidgetInternal(n,!1)},n.prototype.getLineWidgetInternal=function(n,i){var r=void 0,u,h,e,o,c,a,s;if(!sf.base.isNullOrUndefined(this.currentPage)){if(u=void 0,this.owner.enableHeaderAndFooter){var f=this.currentPage,v=f.boundingRectangle.height,y=Math.max(f.headerWidget.y+f.headerWidget.height,t.convertPointToPixel(f.bodyWidgets[0].sectionFormat.topMargin))*this.zoomFactor,l=t.convertPointToPixel(f.bodyWidgets[0].sectionFormat.footerDistance),p=f.boundingRectangle.height-Math.max(f.footerWidget.height+l,2*l);return(i?u=this.isBlockInHeader(this.selection.start.paragraph)?this.currentPage.headerWidget:this.currentPage.footerWidget:n.y<=v&&n.y>=p?u=this.currentPage.footerWidget:n.y>=0&&n.y<=y&&(u=this.currentPage.headerWidget),sf.base.isNullOrUndefined(u))?void 0:(h=this.checkFloatingItems(u,n,i),h.isShapeSelected?h.isInShapeBorder?h.element.line:this.selection.getLineWidgetBodyWidget(h.element.textFrame,n):this.selection.getLineWidgetBodyWidget(u,n))}if(e=this.checkFloatingItems(this.currentPage.bodyWidgets[0],n,i,!1),o=this.checkFloatingItems(this.currentPage.bodyWidgets[0],n,i,!0),e.isShapeSelected){if(e.isInShapeBorder)return e.element.line;_instanceof(e.element,nt)&&(r=this.selection.getLineWidgetBodyWidget(e.element.textFrame,n))}else if(i&&this.isFootnoteWidget){if(void 0!==this.selection.start.paragraph.footNoteReference&&_instanceof(this.selection.start.paragraph.containerWidget,it)&&"Footnote"===this.selection.start.paragraph.containerWidget.footNoteType)return this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget,n);if(void 0!==this.selection.start.paragraph.footNoteReference&&_instanceof(this.selection.start.paragraph.containerWidget,it)&&"Endnote"===this.selection.start.paragraph.containerWidget.footNoteType)return this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget,n)}else if(!i&&this.currentPage.footnoteWidget&&this.isInFootnoteWidget(this.currentPage.footnoteWidget,n))(r=this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget,n))&&(this.isFootnoteWidget=!0);else if(!i&&this.currentPage.endnoteWidget&&this.isInFootnoteWidget(this.currentPage.endnoteWidget,n))(r=this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget,n))&&(this.isFootnoteWidget=!0);else for(c=0;c<this.currentPage.bodyWidgets.length;c++)if(a=this.currentPage.bodyWidgets[c],r=this.selection.getLineWidgetBodyWidget(a,n),!sf.base.isNullOrUndefined(r)){this.isFootnoteWidget=!1;break}if(s=this.checkInlineShapeItems(r,n,i),s.isShapeSelected){if(s.isInShapeBorder)return s.element.line;_instanceof(s.element,nt)&&(r=this.selection.getLineWidgetBodyWidget(s.element.textFrame,n))}else if(!this.checkPointIsInLine(r,n)&&o.isShapeSelected){if(o.isInShapeBorder)return o.element.line;_instanceof(o.element,nt)&&(r=this.selection.getLineWidgetBodyWidget(o.element.textFrame,n))}}return r},n.prototype.checkInlineShapeItems=function(n,t,i){var r,f=!1,o=!1,s=this.selection.isInShape,h=i&&s,e,u;if(!sf.base.isNullOrUndefined(n)&&n.children.length>0)if(h)e=this.owner.selection.getCurrentTextFrame(),e&&(r=e.containerShape,f=!0);else{for(u=0;u<n.children.length;u++)if(_instanceof(n.children[u],nt)&&"Inline"===n.children[u].textWrappingStyle&&(r=n.children[u],t.x<r.x+r.margin.left+r.width&&t.x>r.x&&t.y<r.y+r.margin.top+r.height&&t.y>r.y)){f=!0;this.isInShapeBorder(r,t)&&(o=!0);break}i&&!s&&(f=!1)}return{element:r,caretPosition:t,isShapeSelected:f,isInShapeBorder:o}},n.prototype.checkPointIsInLine=function(n,t){if(!sf.base.isNullOrUndefined(n)&&n.children.length>0)for(var i=void 0,r=n.paragraph.x,f=this.selection.getTop(n),u=n.children.indexOf(n.children[0]);u<n.children.length;u++)if(!(_instanceof(i=n.children[u],lt)&&"Inline"!==i.textWrappingStyle)){if(t.x<r+i.margin.left+i.width+i.padding.left&&t.x>r&&t.y<f+n.height&&t.y>f)return!0;r+=i.margin.left+i.width+i.padding.left}return!1},n.prototype.isInFootnoteWidget=function(n,t){for(var i,r=0;r<n.childWidgets.length;r++)if(i=n.childWidgets[r],_instanceof(i,gt)&&i.y<=t.y&&i.y+i.height>=t.y)return!0;return!1},n.prototype.checkFloatingItems=function(n,t,i,r){var u,o=!1,h=!1,c=this.selection.isInShape,l=i&&c,s,e;if(n.floatingElements.length>0)if(this.currentPage,n.floatingElements.sort(function(n,t){return _instanceof(n,f)||_instanceof(t,f)?0:n.zOrderPosition-t.zOrderPosition}),l)s=this.owner.selection.getCurrentTextFrame(),s&&(u=s.containerShape,o=!0);else{for(e=0;e<n.floatingElements.length;e++)if(!(_instanceof(n.floatingElements[e],f)||(!sf.base.isNullOrUndefined(r)&&r?"Behind"!==n.floatingElements[e].textWrappingStyle:"Behind"===n.floatingElements[e].textWrappingStyle))&&(u=n.floatingElements[e],t.x<u.x+u.margin.left+u.width&&t.x>u.x&&t.y<u.y+u.margin.top+u.height&&t.y>u.y)){o=!0;this.isInShapeBorder(u,t)&&(h=!0);break}i&&!c&&(o=!1)}return{element:u,caretPosition:t,isShapeSelected:o,isInShapeBorder:h}},n.prototype.isBlockInHeader=function(n){for(;!_instanceof(n.containerWidget,ct);){if(!n.containerWidget)return!1;_instanceof(n=n.containerWidget,et)&&(n=n.containerShape.paragraph)}return-1!==n.containerWidget.headerFooterType.indexOf("Header")},n.prototype.clearSelectionHighlight=function(){this.isControlPressed&&this.isMouseDown;this.owner.selection.clearSelectionHighlightInSelectedWidgets()&&this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height)},n.prototype.removeEmptyPages=function(){for(var i,t=!1,n=0;n<this.pages.length;n++)i=this.pages[n],0!==i.bodyWidgets.length&&0!==i.bodyWidgets[0].childWidgets.length||(n===this.pages.length-1&&_instanceof(this.owner.viewer,rt)&&-1!==this.owner.viewer.visiblePages.indexOf(this.pages[n])&&(t=!0),this.removePage(this.pages[n]),n--);t&&this.scrollToBottom()},n.prototype.scrollToBottom=function(){if(this.selection.start.paragraph&&this.selection.start.paragraph.bodyWidget){var n=this.selection.start.paragraph.bodyWidget.page,t=this.visibleBounds.height;this.viewerContainer.scrollTop=n.boundingRectangle.bottom-t}},n.prototype.getFieldResult=function(n,t){var s,u;if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.selection)){var f=this.selection.getFieldCode(n).split("*"),r=f[0].replace(/[^\w\s]/gi,"").trim().toLowerCase(),i="";switch(f.length>1&&(i=f[1].replace(/[^\w\s]/gi,"").trim()),r=r.match("numpages")||r.match("sectionpages")||!r.match("page")?r:"page"){case"page":return t.bodyWidgets[0].sectionFormat.restartPageNumbering&&0!==t.sectionIndex?(s=t.sectionIndex,u=t.previousPage,s!==u.sectionIndex?(t.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber,this.getFieldText(i,t.currentPageNum)):(1===u.currentPageNum&&(u.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber),t.currentPageNum=u.currentPageNum+1,this.getFieldText(i,t.currentPageNum))):t.bodyWidgets[0].sectionFormat.restartPageNumbering&&0===t.sectionIndex?(t.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber+t.index,this.getFieldText(i,t.currentPageNum)):(t.currentPageNum=sf.base.isNullOrUndefined(t.previousPage)?t.index+1:t.previousPage.currentPageNum+1,t.currentPageNum=t.index+1,this.getFieldText(i,t.currentPageNum));case"numpages":return this.getFieldText(i,t.documentHelper.pages.length);case"sectionpages":for(var h=t.sectionIndex,e=0,o=0;o<t.documentHelper.pages.length;o++)if(t.documentHelper.pages[o].sectionIndex===h)e++;else if(0!==e)break;return this.getFieldText(i,e)}}return""},n.prototype.getFieldText=function(n,t){switch(n){case"ALPHABETIC":return this.layout.getAsLetter(t).toUpperCase();case"alphabetic":return this.layout.getAsLetter(t).toLowerCase();case"roman":return this.layout.getAsRoman(t).toLowerCase();case"ROMAN":return this.layout.getAsRoman(t).toUpperCase();default:return t.toString()}},n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.owner)||this.unWireEvent();this.pages=[];this.pages=void 0;this.fieldStacks=[];this.fieldStacks=void 0;this.splittedCellWidgets=[];this.splittedCellWidgets=void 0;this.fields=[];this.fields=void 0;this.layout&&this.layout.destroy();this.layout=void 0;sf.base.isNullOrUndefined(this.render)||this.render.destroy();this.render=void 0;this.dialogTarget1&&this.dialogTarget1.parentElement&&this.dialogTarget1.parentElement.removeChild(this.dialogTarget1);this.dialogTarget1=void 0;this.dialogTarget2&&this.dialogTarget2.parentElement&&this.dialogTarget2.parentElement.removeChild(this.dialogTarget2);this.dialogTarget2=void 0;this.dialogTarget3&&this.dialogTarget3.parentElement&&this.dialogTarget3.parentElement.removeChild(this.dialogTarget3);this.dialogTarget3=void 0;sf.base.isNullOrUndefined(this.touchStart)||(this.touchStart.innerHTML="");this.textHelper&&this.textHelper.destroy();this.textHelper=void 0;this.touchStart=void 0;sf.base.isNullOrUndefined(this.touchEnd)||(this.touchEnd.innerHTML="");this.touchEnd=void 0;sf.base.isNullOrUndefined(this.containerCanvasIn)||(this.containerCanvasIn.innerHTML="");this.containerCanvasIn=void 0;sf.base.isNullOrUndefined(this.selectionCanvasIn)||(this.selectionCanvasIn.innerHTML="");this.selectionCanvasIn=void 0;sf.base.isNullOrUndefined(this.editableDiv)||(this.editableDiv.innerHTML="",this.editableDiv.parentElement.removeChild(this.editableDiv));this.editableDiv=void 0;sf.base.isNullOrUndefined(this.pageContainer)||(this.pageContainer.innerHTML="");this.pageContainer=void 0;sf.base.isNullOrUndefined(this.viewerContainer)||(this.viewerContainer.innerHTML="");this.viewerContainer=void 0;this.owner=void 0;this.heightInfoCollection=void 0},n.prototype.unWireEvent=function(){this.viewerContainer.removeEventListener("scroll",this.scrollHandler);this.viewerContainer.removeEventListener("mousedown",this.onMouseDownInternal);this.viewerContainer.removeEventListener("mousemove",this.onMouseMoveInternal);sf.base.Browser.isDevice?this.editableDiv.removeEventListener("input",this.onTextInputInternal):(this.editableDiv.removeEventListener("keypress",this.onKeyPressInternal),"chrome"===sf.base.Browser.info.name&&this.editableDiv.removeEventListener("textInput",this.onTextInput));this.editableDiv.removeEventListener("paste",this.onPaste);this.viewerContainer.removeEventListener("contextmenu",this.onContextMenu);this.editableDiv.removeEventListener("blur",this.onFocusOut);this.editableDiv.removeEventListener("keydown",this.onKeyDownInternal);this.editableDiv.removeEventListener("compositionstart",this.compositionStart);this.editableDiv.removeEventListener("compositionupdate",this.compositionUpdated);this.editableDiv.removeEventListener("compositionend",this.compositionEnd);this.viewerContainer.removeEventListener("mouseup",this.onMouseUpInternal);sf.base.isNullOrUndefined(this.iframe)||this.iframe.removeEventListener("load",this.onIframeLoad);this.viewerContainer.removeEventListener("dblclick",this.onDoubleTap);window.removeEventListener("resize",this.onWindowResize);window.removeEventListener("keyup",this.onKeyUpInternal);window.removeEventListener("mouseup",this.onImageResizer.bind(this));window.removeEventListener("touchend",this.onImageResizer.bind(this))},n.prototype.updateCursor=function(n){var s,h,c,u=void 0,l=void 0,f=this.viewerContainer,b=new d(n.offsetX,n.offsetY),t=this.owner.viewer.findFocusedPage(b,!0),i=this.getLineWidget(t),o=this.owner.isReadOnlyMode?void 0:this.owner.editorModule,k=!!o&&o.tableResize.isInRowResizerArea(t),g=!!o&&o.tableResize.isInCellResizerArea(t),nt=this.selection.checkAllFloatingElements(i,t),e="",a,v,p,w;this.owner.enableImageResizerMode&&(a=this.owner.imageResizerModule.getImagePoint(t),this.owner.imageResizerModule.selectedResizeElement=a.selectedElement,e=a.resizePosition);var y=0,r=void 0,tt=this.checkPointIsInLine(i,t);sf.base.isNullOrUndefined(i)||((y=this.selection.getLineStartLeft(i),u=this.selection.getHyperLinkFieldInCurrentSelection(i,t),sf.base.isNullOrUndefined(u)&&(r=this.selection.getHyperLinkFieldInCurrentSelection(i,t,!0)),sf.base.isNullOrUndefined(u))||(v=this.selection.getFieldCode(u),0!==v.toLowerCase().indexOf("ref ")||v.match("\\h")||(u=void 0)),(s=this.selection.updateTextPositionIn(i,void 0,0,t,!0),h=this.selection.getLeft(i),c=this.selection.getTop(i),sf.base.isNullOrUndefined(u)&&!sf.base.isNullOrUndefined(r)&&this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType&&!this.isFormFilling?this.selection.setHyperlinkContentToToolTip(r,i,t.x,!0):this.selection.setHyperlinkContentToToolTip(u,i,t.x,!1),r)&&(p=_instanceof(r.formFieldData,vt)&&"Text"===r.formFieldData.type,"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode&&p&&(r=void 0)));sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(l)&&"Pages"==this.owner.layoutType&&_instanceof(l=this.selection.getFootNoteElementInCurrentSelection(i,t),yt)&&this.selection.setFootnoteContentToToolTip(l,i,t.x);w=this.isIosDevice?n.metaKey:n.ctrlKey;!sf.base.isNullOrUndefined(u)&&(w&&this.owner.useCtrlClickToFollowHyperlink||!this.owner.useCtrlClickToFollowHyperlink)||r?sf.base.isNullOrUndefined(r)?f.style.cursor="pointer":this.isFormFillProtectedMode&&(f.style.cursor="default"):(f.style.cursor=t.x>=y&&n.offsetX<this.visibleBounds.width-(this.visibleBounds.width-this.viewerContainer.clientWidth)&&n.offsetY<this.visibleBounds.height-(this.visibleBounds.height-this.viewerContainer.clientHeight)?this.selection.isEmpty?"text":this.selection.checkCursorIsInSelection(i,t)?"default":"text":"default",sf.base.isNullOrUndefined(e)||""===e?!sf.base.isNullOrUndefined(s)&&s.isImageSelected&&h<t.x&&c<t.y&&h+i.width>t.x&&c+i.height>t.y&&(f.style.cursor="move"):(!this.owner.imageResizerModule.isShapeResize||this.owner.imageResizerModule.isShapeResize&&"move"!==e)&&(f.style.cursor=e),k?f.style.cursor="row-resize":g&&(f.style.cursor="col-resize"),nt.isInShapeBorder&&!tt&&(f.style.cursor="all-scroll"))},n}(),cr=function(){function n(n){this.visiblePages=[];this.padding=new af(10,10,10,10);this.textWrap=!0;this.pageFitTypeIn="None";this.containerTop=0;this.containerLeft=0;this.owner=n}return Object.defineProperty(n.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageFitType",{get:function(){return this.pageFitTypeIn},set:function(n){this.pageFitTypeIn=n;this.onPageFitTypeChanged(this.pageFitTypeIn)},enumerable:!0,configurable:!0}),n.prototype.updateClientArea=function(n,i,r){var u=0,c=0,e,h,o,l,a;if(_instanceof(this,at))(u=(this.documentHelper.visibleBounds.width-4*this.padding.right-2*this.padding.left)/this.documentHelper.zoomFactor)<0&&(u=0),c=Number.POSITIVE_INFINITY,this.clientArea=new b(this.padding.left/this.documentHelper.zoomFactor,0,u,c),this.clientActiveArea=new b(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height);else{var f=0,v=48,y=48,s=t.convertPointToPixel(n.pageHeight),p=t.convertPointToPixel(n.bottomMargin);sf.base.isNullOrUndefined(n)||(f=t.convertPointToPixel(n.topMargin),v=t.convertPointToPixel(n.headerDistance),y=t.convertPointToPixel(n.footerDistance));e=!1;sf.base.isNullOrUndefined(i.headerWidget)||(!(e=i.headerWidget.isEmpty)||e&&this.owner.enableHeaderAndFooter)&&(f=Math.min(Math.max(v+i.headerWidget.height,f),s/100*40));h=.667+p;sf.base.isNullOrUndefined(i.footerWidget)||(e=i.footerWidget.isEmpty,o=sf.base.isNullOrUndefined(i.footnoteWidget)?0:i.footnoteWidget.height,0===o&&(l=this.owner.documentHelper.pages.indexOf(i),l>0&&(a=this.owner.documentHelper.pages[l-1].footnoteWidget,o=sf.base.isNullOrUndefined(a)?0:a.height,this.clientArea.height-=o)),(!e||e&&this.owner.enableHeaderAndFooter)&&(h=.667+Math.min(s/100*40,Math.max(y+i.footerWidget.height+o,p))));sf.base.isNullOrUndefined(n)||(u=t.convertPointToPixel(n.pageWidth-n.leftMargin-n.rightMargin),c=s-f-h);u<0&&(u=0);this.clientArea=new b(t.convertPointToPixel(n.leftMargin),f,u,s-f-h);r&&i.footnoteWidget&&(this.clientArea.height-=i.footnoteWidget.height);this.clientActiveArea=new b(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}},n.prototype.updateClientAreaTopOrLeft=function(n,t){t&&(this.clientActiveArea.y=this.clientActiveArea.y+n.topBorderWidth,this.clientActiveArea.x=this.clientActiveArea.x+n.leftBorderWidth)},n.prototype.updateClientAreaForTable=function(n){this.clientActiveArea.x=this.clientArea.x=n.x;this.clientActiveArea.width=this.clientArea.width=n.width},n.prototype.updateClientAreaForRow=function(n,t){var i=n.ownerTable;t||(this.clientActiveArea.x=this.clientArea.x=i.x,this.clientActiveArea.width=this.clientArea.width=i.width,this.clientArea=new b(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new b(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height-this.documentHelper.layout.footnoteHeight))},n.prototype.updateClientAreaForCell=function(n,i){var u=n.ownerRow,r=n;i?(this.clientActiveArea.x=this.clientArea.x=r.x,this.clientActiveArea.y=r.y,this.clientActiveArea.width=this.clientArea.width=r.width>0?r.width:0,_instanceof(this,rt)&&(this.clientActiveArea.height=Number.POSITIVE_INFINITY),this.clientArea=new b(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new b(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)):(this.clientActiveArea.x=this.clientArea.x=r.x+r.width+r.margin.right,this.clientActiveArea.width=u.x+u.width-this.clientArea.x<0?this.clientArea.width=0:this.clientArea.width=u.x+u.width-this.clientArea.x,this.clientActiveArea.y=r.y-r.margin.top-t.convertPointToPixel(n.ownerTable.tableFormat.cellSpacing),n.ownerTable.isInsideTable||(this.clientActiveArea.height=this.clientArea.bottom-u.y>0?this.clientArea.bottom-u.y:0),this.clientArea=new b(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new b(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height))},n.prototype.updateClientAreaForTextBoxShape=function(n,i){if("Inline"===n.textWrappingStyle&&(n.y=this.clientActiveArea.y,n.x=this.clientActiveArea.x),i){var r=t.convertPointToPixel(n.textFrame.marginLeft),f=t.convertPointToPixel(n.textFrame.marginRight),u=t.convertPointToPixel(n.textFrame.marginTop),e=t.convertPointToPixel(n.textFrame.marginBottom),o=n.width,s=Number.POSITIVE_INFINITY;this.clientArea=new b(n.x+r,n.y+u,o-r-f,s-u-e);this.clientActiveArea=new b(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}},n.prototype.updateClientAreaByWidgetFootNote=function(n){this.clientArea.x=n.x;this.clientArea.y=n.y;this.clientActiveArea.x=n.x;this.clientActiveArea.y=n.y},n.prototype.updateClientAreaForTextWrap=function(n){this.clientActiveArea=new b(n.x,n.y,n.width,n.height)},n.prototype.updateClientAreaByWidget=function(n){this.clientArea.x=n.x;this.clientArea.y=n.y;this.clientActiveArea.x=n.x;this.clientActiveArea.y=n.y},n.prototype.updateClientAreaLocation=function(n,t){n.x=t.x;n.y=t.y;n.width=t.width},n.prototype.updateClientAreaForBlock=function(n,i,r){var u=t.convertPointToPixel(n.leftIndent),c=t.convertPointToPixel(n.rightIndent),o=n.bidi,s=0,h,e,l;i?_instanceof(n,f)&&r?(h=r[0],this.clientActiveArea.x=this.clientArea.x=h.x,this.clientActiveArea.width=this.clientArea.width=h.width,(h=r[r.length-1]).x=this.clientActiveArea.x,h.y=this.clientActiveArea.y):(_instanceof(n,f)&&!sf.base.isNullOrUndefined(n.tableFormat)&&(n.isGridUpdated||(n.buildTableColumns(),n.isGridUpdated=!0),"Left"!==(l=this.tableAlignmentForBidi(n,o)))&&(e=0,e=0===(e=t.convertPointToPixel(n.tableHolder.getTotalWidth(0)))?0===n.tableHolder.tableWidth?n.getTableClientWidth(n.getOwnerWidth(!1)):n.tableHolder.tableWidth:e,this.owner.editor&&this.owner.editor.tableResize.currentResizingTable===n&&0===this.owner.editor.tableResize.resizerPosition&&(e=t.convertPointToPixel(n.tableHolder.tableWidth)),"Center"===l?(e=n.getTableCellWidth(),u=(this.clientArea.width-e)/2):u=this.clientArea.width-e,o&&(c=u-=t.convertPointToPixel(n.leftIndent)),n.isInsideTable,this.documentHelper.tableLefts.push(u)),s=this.clientArea.width-(u+t.convertPointToPixel(n.rightIndent)),this.clientActiveArea.x=this.clientArea.x=this.clientArea.x+(o?c:u),this.clientActiveArea.width=this.clientArea.width=s>0?s:0):(_instanceof(n,f)&&!sf.base.isNullOrUndefined(n.tableFormat)&&(l=this.tableAlignmentForBidi(n,o),n.isGridUpdated||(n.buildTableColumns(),n.isGridUpdated=!0),"Left"!==l&&this.documentHelper.tableLefts.length>0&&(u=this.documentHelper.tableLefts.pop(),o&&(c=u))),s=this.clientArea.width+u+t.convertPointToPixel(n.rightIndent),this.clientActiveArea.width=this.clientArea.width=s>0?s:0,this.clientActiveArea.x=this.clientArea.x=this.clientArea.x-(o?c:u));this.clientArea=new b(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height);this.clientActiveArea=new b(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)},n.prototype.tableAlignmentForBidi=function(n,t){var i=n.tableFormat.tableAlignment;return t&&("Left"===i?i="Right":"Right"===i&&(i="Left")),i},n.prototype.cutFromLeft=function(n){n<this.clientActiveArea.x&&(n=this.clientActiveArea.x);n>this.clientActiveArea.right&&this.textWrap&&(n=this.clientActiveArea.right);this.clientActiveArea.width=this.clientActiveArea.right>n?this.clientActiveArea.right-n:0;this.clientActiveArea.x=n},n.prototype.cutFromTop=function(n){n<this.clientActiveArea.y&&(n=this.clientActiveArea.y);n>this.clientActiveArea.bottom&&(n=this.clientActiveArea.bottom);this.clientActiveArea.height=this.clientActiveArea.bottom-n;this.clientActiveArea.x=this.clientArea.x;this.clientActiveArea.width=this.clientArea.width;this.clientActiveArea.y=n},n.prototype.updateClientWidth=function(n){this.clientActiveArea.x-=n;this.clientActiveArea.width+n>0?this.clientActiveArea.width+=n:this.clientActiveArea.width=0},n.prototype.findFocusedPage=function(n,t){var i=new d(n.x,n.y),u;for(i.x+=this.documentHelper.viewerContainer.scrollLeft,i.y+=this.documentHelper.viewerContainer.scrollTop,u=0;u<this.documentHelper.pages.length;u++){var r=this.documentHelper.pages[u],e=(r.boundingRectangle.y-this.pageGap*(u+1))*this.documentHelper.zoomFactor+this.pageGap*(u+1),s=r.boundingRectangle.height*this.documentHelper.zoomFactor+this.pageGap,f=r.boundingRectangle.x,o=void 0;if(o=_instanceof(this,rt)?(r.boundingRectangle.right-f)*this.documentHelper.zoomFactor+f:r.boundingRectangle.right+f,e<=i.y&&e+s>=i.y)return t&&(this.documentHelper.currentPage=r),i.y=(i.y-e)/this.documentHelper.zoomFactor,i.x=i.x>o?r.boundingRectangle.right:i.x<f?0:(i.x-f)/this.documentHelper.zoomFactor,i}return i},n.prototype.getPageHeightAndWidth=function(n,t){n=0;for(var i=0;i<this.documentHelper.pages.length;i++)n+=this.documentHelper.pages[i].boundingRectangle.height;for(t=0,i=0;i<this.documentHelper.pages.length;i++)t<this.documentHelper.pages[i].boundingRectangle.width&&(t=this.documentHelper.pages[i].boundingRectangle.width);return{height:n,width:t,viewerWidth:this.documentHelper.visibleBounds.width,viewerHeight:this.documentHelper.visibleBounds.height}},n.prototype.renderVisiblePages=function(){var n;if(!(sf.base.isNullOrUndefined(this.visiblePages)||this.visiblePages.length<1))for(this.documentHelper.clearContent(),n=0;n<this.visiblePages.length;n++){var t=this.visiblePages[n],i=t.boundingRectangle.width*this.documentHelper.zoomFactor,r=t.boundingRectangle.height*this.documentHelper.zoomFactor,u=t.boundingRectangle.x,f=(t.boundingRectangle.y-this.pageGap*(n+1))*this.documentHelper.zoomFactor+this.pageGap*(n+1);this.owner.viewer.renderPage(t,u,f,i,r)}},n.prototype.handleZoom=function(){var t=this.documentHelper.preZoomFactor,n=null,w=0,b=!1,v,k,i,o,d,y,r,u,s,h,p,f,g,l;if(this.documentHelper.selection&&sf.base.isNullOrUndefined(this.documentHelper.zoomX&&sf.base.isNullOrUndefined(this.documentHelper.zoomY))){var e=0,c=0,a=this.documentHelper.selection.getPage(this.documentHelper.selection.end.currentWidget.paragraph);(e=(this.documentHelper.visibleBounds.width-a.boundingRectangle.width*t)/2)<30&&(e=30);c=a.boundingRectangle.y*t+(this.documentHelper.pages.indexOf(a)+1)*this.pageGap*(1-t);v=this.documentHelper.selection.updateCaretSize(this.owner.selection.end,!0);k=v.topMargin;v.height;e+=this.documentHelper.selection.end.location.x*t;c+=(this.documentHelper.selection.end.location.y+k)*t;e>=this.containerLeft&&e<=this.documentHelper.visibleBounds.width&&c>=this.containerTop&&c<=this.containerTop+this.documentHelper.visibleBounds.height&&(b=!0)}for(i=0;i<this.documentHelper.pages.length;i++)w+=this.documentHelper.pages[i].boundingRectangle.height;for(o=0,i=0;i<this.documentHelper.pages.length;i++)o<this.documentHelper.pages[i].boundingRectangle.width&&(o=this.documentHelper.pages[i].boundingRectangle.width);if(d=w*this.documentHelper.zoomFactor+(this.documentHelper.pages.length+1)*this.pageGap*(1-this.documentHelper.zoomFactor)-this.documentHelper.visibleBounds.height,y=o*this.documentHelper.zoomFactor-this.documentHelper.visibleBounds.width,this.documentHelper.visibleBounds.width-o*this.documentHelper.zoomFactor<60&&(y+=60),d>0){if(r=this.containerTop,this.visiblePages.length>0){for(u=((n=this.visiblePages[0]).boundingRectangle.y-(n.index+1)*this.pageGap)*t+(n.index+1)*this.pageGap,s=this.documentHelper.zoomY,sf.base.isNullOrUndefined&&(s=this.documentHelper.visibleBounds.height/2),h=r+s;h>u+n.boundingRectangle.height*t;){if(p=n.index+1,p===this.documentHelper.pages.length)break;u=((n=this.documentHelper.pages[p]).boundingRectangle.y-(n.index+1)*this.pageGap)*t+(n.index+1)*this.pageGap}r=(n.boundingRectangle.y-(n.index+1)*this.pageGap)*this.documentHelper.zoomFactor+(n.index+1)*this.pageGap+(h-u<0?h-u:(h-u)*(this.documentHelper.zoomFactor/t))-s;s=this.documentHelper.visibleBounds.height/2}this.documentHelper.viewerContainer.scrollTop=r}else this.documentHelper.viewerContainer.scrollTop=0;y>0?(r=this.containerLeft,this.visiblePages.length>0&&(null===n&&(n=this.visiblePages[0]),f=this.documentHelper.zoomX,sf.base.isNullOrUndefined(f)&&(f=this.documentHelper.visibleBounds.width/2),g=n.boundingRectangle.width*t/n.boundingRectangle.width,l=r+f,r=n.boundingRectangle.x+(l-n.boundingRectangle.x<0?l-n.boundingRectangle.x:(l-n.boundingRectangle.x)*(this.documentHelper.zoomFactor/g))-f,f=this.documentHelper.visibleBounds.width/2),this.documentHelper.viewerContainer.scrollLeft=r):this.documentHelper.viewerContainer.scrollLeft=0;this.updateScrollBars();b&&this.documentHelper.scrollToPosition(this.documentHelper.selection.start,this.documentHelper.selection.end);_instanceof(this,at)&&this.owner.editorModule.layoutWholeDocument()},n.prototype.updateCanvasWidthAndHeight=function(n,t,i,r,u,f){_instanceof(this,rt)?this.documentHelper.visibleBounds.width!==this.documentHelper.viewerContainer.clientWidth?n-=this.documentHelper.visibleBounds.width-this.documentHelper.viewerContainer.clientWidth:i>t&&(n-=this.documentHelper.viewerContainer.offsetWidth-this.documentHelper.viewerContainer.clientWidth):i>t&&(n-=this.documentHelper.scrollbarWidth,r-=this.documentHelper.scrollbarWidth);r>n&&(t-=this.documentHelper.scrollbarWidth);u=r>n?r:n;f=i>t?i:t;parseInt(this.documentHelper.pageContainer.style.width.replace("px",""),10)===u&&parseInt(this.documentHelper.pageContainer.style.height.replace("px",""),10)===u||(this.documentHelper.pageContainer.style.width=u.toString()+"px",this.documentHelper.pageContainer.style.height=f.toString()+"px");var e=Math.max(1,window.devicePixelRatio||1);return this.documentHelper.containerCanvas.width===Math.floor(n*e)&&this.documentHelper.containerCanvas.height===Math.floor(t*e)||(this.documentHelper.containerCanvas.width=n*e,this.documentHelper.containerCanvas.height=t*e,this.documentHelper.containerCanvas.style.width=n+"px",this.documentHelper.containerCanvas.style.height=t+"px",this.documentHelper.containerContext.scale(e,e),this.documentHelper.selectionCanvas.width=n*e,this.documentHelper.selectionCanvas.height=t*e,this.documentHelper.selectionCanvas.style.width=n+"px",this.documentHelper.selectionCanvas.style.height=t+"px",this.documentHelper.selectionContext.scale(e,e)),{height:f,width:u,viewerWidth:n,viewerHeight:t,containerHeight:i,containerWidth:r}},n.prototype.updateScrollBarPosition=function(){this.owner.viewer.containerTop=this.documentHelper.viewerContainer.scrollTop;this.documentHelper.containerCanvas.style.position="absolute";this.documentHelper.containerCanvas.style.top=this.owner.viewer.containerTop.toString()+"px";this.documentHelper.selectionCanvas.style.position="absolute";this.documentHelper.selectionCanvas.style.top=this.owner.viewer.containerTop.toString()+"px";this.owner.viewer.containerLeft=this.documentHelper.viewerContainer.scrollLeft;this.documentHelper.containerCanvas.style.left=this.owner.viewer.containerLeft+"px";this.documentHelper.selectionCanvas.style.left=this.owner.viewer.containerLeft+"px"},n.prototype.destroy=function(){this.clientArea=void 0;this.clientActiveArea=void 0},n}(),rt=function(n){function i(t){var i=n.call(this,t)||this;return i.pageLeft=30,i.owner=t,i}return gr(i,n),Object.defineProperty(i.prototype,"pageGap",{get:function(){return this.owner.pageGap},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),i.prototype.createNewPage=function(n,t){var r=this.pageGap,i;return this.documentHelper.pages.length>0&&(r=this.documentHelper.pages[this.documentHelper.pages.length-1].boundingRectangle.bottom+this.pageGap),i=new ou(this.documentHelper),this.updatePageBoundingRectangle(n,i,r),sf.base.isNullOrUndefined(t)?this.documentHelper.pages.push(i):this.documentHelper.pages.splice(t,0,i),this.updateClientArea(n.sectionFormat,i),i.bodyWidgets.push(n),i.bodyWidgets[i.bodyWidgets.length-1].page=i,this.documentHelper.layout.layoutHeaderFooter(n,this,i),this.updateClientArea(n.sectionFormat,i),this.documentHelper.layout.footnoteHeight=0,i},i.prototype.updatePageBoundingRectangle=function(n,i,r){var f=sf.base.isNullOrUndefined(n.sectionFormat)?816:t.convertPointToPixel(n.sectionFormat.pageWidth),e=sf.base.isNullOrUndefined(n.sectionFormat)?1056:t.convertPointToPixel(n.sectionFormat.pageHeight),u=(this.documentHelper.visibleBounds.width-f*this.documentHelper.zoomFactor)/2;u<this.pageLeft&&(u=this.pageLeft);i.boundingRectangle=new b(u,r,f,e)},i.prototype.onPageFitTypeChanged=function(n){var e=this.documentHelper.visibleBounds.width,o=this.documentHelper.visibleBounds.height,r=this.visiblePages[0].bodyWidgets[0],u=t.convertPointToPixel(r.sectionFormat.pageWidth),f=t.convertPointToPixel(r.sectionFormat.pageHeight),i;switch(n){case"FitOnePage":o>0&&f>0&&(i=(this.documentHelper.visibleBounds.height-2*this.pageGap-(this.pageGap-2))/f,i===this.documentHelper.zoomFactor?sf.base.isNullOrUndefined(this.owner.selection)||sf.base.isNullOrUndefined(this.owner.selection.start)||sf.base.isNullOrUndefined(this.owner.selection.end)||this.documentHelper.scrollToPosition(this.owner.selection.start,this.owner.selection.end):this.documentHelper.zoomFactor=i);break;case"FitPageWidth":e>0&&u>0&&(this.documentHelper.zoomFactor=(this.documentHelper.visibleBounds.width-80)/u);break;default:this.documentHelper.zoomFactor=1}},i.prototype.getCurrentPageHeaderFooter=function(n,t){return this.getCurrentHeaderFooter(this.getHeaderFooterType(n,t),n.index)},i.prototype.getHeaderFooterType=function(n,t){var i,r;return i=t?"OddHeader":"OddFooter",r=n.page,n.sectionFormat.differentFirstPage&&(sf.base.isNullOrUndefined(r.previousPage)||r.sectionIndex!==r.previousPage.sectionIndex)?i=t?"FirstPageHeader":"FirstPageFooter":n.sectionFormat.differentOddAndEvenPages&&this.documentHelper.pages.length%2==0&&(i=t?"EvenHeader":"EvenFooter"),i},i.prototype.getCurrentHeaderFooter=function(n,t){var r,i,u;if(this.documentHelper.headersFooters[t]){if(r=this.getHeaderFooter(n),i=this.documentHelper.headersFooters[t][r],!i){for(u=t>0?t-1:t;!i&&-1!==u&&this.documentHelper.headersFooters[u][r];)i=this.documentHelper.headersFooters[u][r],u--;i||((i=this.createHeaderFooterWidget(n)).isEmpty=!0);this.documentHelper.headersFooters[t][r]=i}return i}if(t>0)return this.getCurrentHeaderFooter(n,t-1)},i.prototype.createHeaderFooterWidget=function(n){var i=new ct(n),t=new u;return t.childWidgets.push(new k(t)),i},i.prototype.getHeaderFooter=function(n){switch(n){case"OddHeader":return 0;case"OddFooter":return 1;case"EvenHeader":return 2;case"EvenFooter":return 3;case"FirstPageHeader":return 4;case"FirstPageFooter":return 5}},i.prototype.updateHFClientArea=function(n,i){var r=t.convertPointToPixel(n.pageWidth-n.leftMargin-n.rightMargin);r<0&&(r=0);this.clientArea=new b(t.convertPointToPixel(n.leftMargin),i?t.convertPointToPixel(n.headerDistance):t.convertPointToPixel(n.pageHeight-n.footerDistance),r,Number.POSITIVE_INFINITY);this.clientActiveArea=new b(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)},i.prototype.updateHeaderFooterClientAreaWithTop=function(n,t,i){this.updateHFClientArea(n,t);t||i.footerWidget.y<this.clientActiveArea.y&&(this.clientActiveArea.y=i.footerWidget.y,this.clientActiveArea.height=Number.POSITIVE_INFINITY)},i.prototype.updateFootnoteClientArea=function(n,i){var r=t.convertPointToPixel(n.pageWidth-n.leftMargin-n.rightMargin);this.clientArea=new b(t.convertPointToPixel(n.leftMargin),t.convertPointToPixel(n.pageHeight-n.bottomMargin)-i.height,r,i.height);this.clientActiveArea=new b(this.clientArea.x,this.clientArea.y,this.clientArea.width,i.height)},i.prototype.scrollToPage=function(n){for(var i=0,t=0;t<this.documentHelper.pages.length&&(i=this.documentHelper.pages[t].boundingRectangle.y-this.pageGap/2,t!==n);t++);this.documentHelper.viewerContainer.scrollTop=i;this.updateScrollBars()},i.prototype.updateScrollBars=function(){var i,t,r=(i=this.getPageHeightAndWidth(0,0,0,0)).width*this.documentHelper.zoomFactor+2*this.pageLeft,u=i.height*this.documentHelper.zoomFactor+(this.documentHelper.pages.length+1)*this.pageGap,n,f;for(u=(t=this.updateCanvasWidthAndHeight(i.viewerWidth,i.viewerHeight,u,r,i.width,i.height)).containerHeight,r=t.containerWidth,this.documentHelper.containerContext.globalAlpha=1,this.documentHelper.selectionContext.globalAlpha=.4,n=0;n<this.documentHelper.pages.length;n++)f=(t.width-this.documentHelper.pages[n].boundingRectangle.width*this.documentHelper.zoomFactor)/2,this.documentHelper.pages[n].boundingRectangle=f>this.pageLeft?new b(f,this.documentHelper.pages[n].boundingRectangle.y,this.documentHelper.pages[n].boundingRectangle.width,this.documentHelper.pages[n].boundingRectangle.height):new b(this.pageLeft,this.documentHelper.pages[n].boundingRectangle.y,this.documentHelper.pages[n].boundingRectangle.width,this.documentHelper.pages[n].boundingRectangle.height);this.updateScrollBarPosition(r,u,t.viewerWidth,t.viewerHeight,t.width,t.height);this.updateVisiblePages();this.documentHelper.isScrollToSpellCheck=!1},i.prototype.updateVisiblePages=function(){this.visiblePages=[];for(var u=this.documentHelper.visibleBounds.height,t=this.documentHelper.viewerContainer.scrollTop,i=0;i<this.documentHelper.pages.length;i++){var r=this.documentHelper.pages[i],n=(r.boundingRectangle.y-this.pageGap*(i+1))*this.documentHelper.zoomFactor+this.pageGap*(i+1),f=r.boundingRectangle.height*this.documentHelper.zoomFactor,e=r.boundingRectangle.x;(n>=t&&n<=t+u||n+f>=t&&n+f<=t+u||n<=t&&n+f>=t+u)&&this.addVisiblePage(r,e,n)}},i.prototype.addVisiblePage=function(n,t,i){var r=this,u=n.boundingRectangle.width*this.documentHelper.zoomFactor,f=n.boundingRectangle.height*this.documentHelper.zoomFactor,e;(this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===n&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(t,i,u,f),this.visiblePages.push(n),this.owner.isSpellCheck&&this.owner.spellChecker.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading||this.documentHelper.isScrollHandler)&&this.documentHelper.cachedPages.indexOf(n.index)<0)?(n.allowNextPageRendering=!1,this.documentHelper.cachedPages.push(n.index),e=this.owner.spellChecker.getPageContent(n),e.trim().length>0?this.owner.spellChecker.callSpellChecker(this.owner.spellChecker.languageID,e,!0,!1,!1,!0).then(function(e){var o=JSON.parse(e);r.owner.spellChecker.updateUniqueWords(o.SpellCollection);n.allowNextPageRendering=!0;r.documentHelper.triggerSpellCheck=!0;r.renderPage(n,t,i,u,f);r.documentHelper.triggerSpellCheck=!1;r.documentHelper.triggerElementsOnLoading=!1}):this.renderPage(n,t,i,u,f)):this.renderPage(n,t,i,u,f)},i.prototype.renderPage=function(n,t,i,r,u){this.documentHelper.render.renderWidgets(n,t-this.owner.viewer.containerLeft,i-this.owner.viewer.containerTop,r,u)},i}(cr),at=function(n){function i(t){var i=n.call(this,t)||this;return i.visiblePages=[],i.owner=t,i}return gr(i,n),Object.defineProperty(i.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pageGap",{get:function(){return 0},enumerable:!0,configurable:!0}),i.prototype.createNewPage=function(n){var t,i=0;return this.documentHelper.pages.length>0&&(i=this.documentHelper.pages[this.documentHelper.pages.length-1].boundingRectangle.bottom),t=new ou(this.documentHelper),t.boundingRectangle=0===this.documentHelper.pages.length?new b(10,i,this.documentHelper.visibleBounds.width,this.documentHelper.visibleBounds.height):new b(10,i-20,this.documentHelper.visibleBounds.width,this.documentHelper.visibleBounds.height),this.documentHelper.pages.push(t),this.updateClientArea(void 0,t),t.bodyWidgets.push(n),t.bodyWidgets[t.bodyWidgets.length-1].page=t,t},i.prototype.onPageFitTypeChanged=function(){this.documentHelper.zoomFactor=1},i.prototype.scrollToPage=function(){this.updateScrollBars()},i.prototype.getContentHeight=function(){for(var t,i=0,n=0;n<this.documentHelper.pages.length;n++)t=this.documentHelper.pages[n],0===n?(i+=this.padding.top,t.boundingRectangle.y=this.padding.top):t.boundingRectangle.y=this.documentHelper.pages[n-1].boundingRectangle.bottom,t.boundingRectangle.height=t.bodyWidgets[0].height,i+=t.bodyWidgets[0].height,n===this.documentHelper.pages.length-1&&(i+=this.padding.bottom);return i},i.prototype.getContentWidth=function(){for(var n,i,s,u,r=this.documentHelper.visibleBounds.width,o=r,e=0;e<this.documentHelper.pages.length;e++){for(n=this.documentHelper.pages[e],i=0;i<n.bodyWidgets[0].childWidgets.length;i++)_instanceof(n.bodyWidgets[0].childWidgets[i],f)&&(s=n.bodyWidgets[0].childWidgets[i],u=t.convertPointToPixel(s.getTableWidth())*this.documentHelper.zoomFactor+4*this.padding.left+4*this.padding.right+n.boundingRectangle.x,o<u&&(r=u,o=u));n.boundingRectangle.width=r}return r},i.prototype.updateScrollBars=function(){var n,t,i,r;n=this.getPageHeightAndWidth(0,0,0,0);i=this.getContentWidth()*this.documentHelper.zoomFactor+this.padding.left+this.padding.right;r=this.getContentHeight()*this.documentHelper.zoomFactor+this.padding.top+this.padding.bottom;t=this.updateCanvasWidthAndHeight(n.viewerWidth,n.viewerHeight,r,i,n.width,n.height);this.documentHelper.containerContext.globalAlpha=1;this.documentHelper.selectionContext.globalAlpha=.4;this.updateScrollBarPosition(i,r,t.viewerWidth,t.viewerHeight,t.width,t.height);this.updateVisiblePages();this.documentHelper.isScrollToSpellCheck=!1},i.prototype.updateVisiblePages=function(){var r,n,i;this.visiblePages=[];for(var u=this.documentHelper.visibleBounds.height,t=this.documentHelper.viewerContainer.scrollTop,f=0;f<this.documentHelper.pages.length;f++)n=(r=this.documentHelper.pages[f]).boundingRectangle.y*this.documentHelper.zoomFactor,i=r.boundingRectangle.height*this.documentHelper.zoomFactor,(n>=t&&n<=t+u||n+i>=t&&n+i<=t+u||n<=t&&n+i>=t+u)&&this.addVisiblePage(r,this.padding.left,n)},i.prototype.addVisiblePage=function(n,t,i){var r=this,u=this.getContentWidth(),f=this.getContentHeight()*this.documentHelper.zoomFactor+this.padding.top+this.padding.bottom,e;(this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===n&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(t,i,u,f),this.visiblePages.push(n),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.spellChecker.enableOptimizedSpellCheck&&(this.owner.documentHelper.triggerElementsOnLoading||this.owner.documentHelper.isScrollHandler)&&this.documentHelper.cachedPages.indexOf(n.index)<0)?(n.allowNextPageRendering=!1,this.owner.documentHelper.cachedPages.push(n.index),e=this.documentHelper.owner.spellChecker.getPageContent(n),e.trim().length>0?this.owner.spellChecker.callSpellChecker(this.owner.spellChecker.languageID,e,!0,!1,!1,!0).then(function(e){var o=JSON.parse(e);r.owner.spellChecker.updateUniqueWords(o.SpellCollection);n.allowNextPageRendering=!0;r.owner.documentHelper.triggerSpellCheck=!0;r.renderPage(n,t,i,u,f);r.owner.documentHelper.triggerSpellCheck=!1;r.owner.documentHelper.triggerElementsOnLoading=!1}):this.renderPage(n,t,i,u,f)):this.renderPage(n,t,i,u,f)},i.prototype.renderPage=function(n,t,i,r,u){this.documentHelper.render.renderWidgets(n,t-this.owner.viewer.containerLeft,i-this.owner.viewer.containerTop,r,u)},i}(cr),st=(or=function(n,t){return(or=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}or(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),b=function(){function n(n,t,i,r){this.x=n;this.y=t;this.width=i;this.height=r}return Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),n.prototype.isIntersecting=function(n){return!(n.y>this.bottom||this.y>n.bottom||n.x>this.right||this.x>n.right)},n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n}(),af=function(n,t,i,r){this.right=10;this.left=10;this.top=10;this.bottom=10;this.right=n;this.left=t;this.top=i;this.bottom=r},hi=function(){function n(n,t,i,r){this.left=n;this.top=t;this.right=i;this.bottom=r}return n.prototype.clone=function(){return new n(this.left,this.top,this.right,this.bottom)},n.prototype.destroy=function(){this.left=void 0;this.right=void 0;this.top=void 0;this.bottom=void 0},n}(),gt=function(){function n(){this.childWidgets=[];this.x=0;this.y=0;this.width=0;this.height=0;this.index=0}return Object.defineProperty(n.prototype,"indexInOwner",{get:function(){return _instanceof(this,c)&&this.page?this.page.bodyWidgets.indexOf(this):this.containerWidget&&this.containerWidget.childWidgets?this.containerWidget.childWidgets.indexOf(this):_instanceof(this,it)?0:-1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"firstChild",{get:function(){if(this.childWidgets.length>0)return this.childWidgets[0]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lastChild",{get:function(){if(this.childWidgets)return this.childWidgets.length>0?this.childWidgets[this.childWidgets.length-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"previousWidget",{get:function(){var t=this,n=this.indexInOwner;return _instanceof(t,c)?n>0?t.page.bodyWidgets[n-1]:void 0:n>0?t.containerWidget.childWidgets[n-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nextWidget",{get:function(){var n=this,t=this.indexInOwner;if(-1!==t)return _instanceof(n,c)?t<n.page.bodyWidgets.length-1?n.page.bodyWidgets[t+1]:void 0:t<n.containerWidget.childWidgets.length-1?n.containerWidget.childWidgets[t+1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"previousRenderedWidget",{get:function(){var n=this,r=this.indexInOwner,i,t;if(!(r<0)){if(_instanceof(n,c))n=r>0?n.page.bodyWidgets[r-1]:(i=n.page.previousPage)&&i.bodyWidgets.length>0?i.bodyWidgets[i.bodyWidgets.length-1]:void 0;else if(_instanceof(n,it))for(i=n.page;i.previousPage&&(n=(i=i.previousPage).footnoteWidget,sf.base.isNullOrUndefined(n)););else if(r>0)n=n.containerWidget.childWidgets[r-1];else{for(t=void 0,_instanceof(n.containerWidget,s)?t=n.containerWidget.getPreviousSplitWidget():_instanceof(n.containerWidget,a)||_instanceof(n.containerWidget,ct)||(t=n.containerWidget.previousRenderedWidget);t&&0===t.childWidgets.length&&(t=t.previousRenderedWidget,!sf.base.isNullOrUndefined(t)););n=t&&t.constructor===n.containerWidget.constructor?t.lastChild:void 0}return n}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nextRenderedWidget",{get:function(){var n=this,r=this.indexInOwner,i,t;if(!(r<0)){if(_instanceof(n,c))n=r<n.page.bodyWidgets.length-1?n.page.bodyWidgets[r+1]:n.page.allowNextPageRendering?(i=n.page.nextPage)&&i.bodyWidgets.length>0?i.bodyWidgets[0]:void 0:void 0;else if(_instanceof(n,it))for(i=n.page;i.allowNextPageRendering&&i.nextPage&&(n=(i=i.nextPage).footnoteWidget,sf.base.isNullOrUndefined(n)););else if(r<n.containerWidget.childWidgets.length-1)n=n.containerWidget.childWidgets[r+1];else{for(t=void 0,_instanceof(n.containerWidget,s)?t=n.containerWidget.getNextSplitWidget():_instanceof(n.containerWidget,a)||_instanceof(n.containerWidget,ct)||_instanceof(n.containerWidget,it)||(t=n.containerWidget.nextRenderedWidget);t&&0===t.childWidgets.length&&!_instanceof(t,s)&&(t=t.nextRenderedWidget,!sf.base.isNullOrUndefined(t)););n=t&&t.constructor===n.containerWidget.constructor?t.firstChild:void 0}return n}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"previousSplitWidget",{get:function(){if(_instanceof(this,s))return this.getPreviousSplitWidget();var n=this.previousRenderedWidget;if(_instanceof(this,c)&&_instanceof(n,c)&&this.equals(n)||_instanceof(n,wt)&&this.index===n.index&&this.equals(n))return n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nextSplitWidget",{get:function(){if(_instanceof(this,s))return this.getNextSplitWidget();var n=this.nextRenderedWidget;if(_instanceof(this,c)&&_instanceof(n,c)&&this.equals(n)||_instanceof(n,wt)&&this.index===n.index&&this.equals(n))return n},enumerable:!0,configurable:!0}),n.prototype.getPreviousSplitWidgets=function(){for(var t=[],n=this.previousSplitWidget;n;)t.unshift(n),n=n.previousSplitWidget;return t},n.prototype.getSplitWidgets=function(){for(var t=this.getPreviousSplitWidgets(),n=this;n;)t.push(n),n=n.nextSplitWidget;return t},n.prototype.combineWidget=function(n){var t=this,i=this.getSplitWidgets(),r;if(i.length>1)for(t=i.shift();i.length>0;)r=i.shift(),t.combine(r,n);return _instanceof(t,f)&&t.combineRows(n),t},n.prototype.combine=function(t,i){var r,u;t.childWidgets.length>0&&(r=this.lastChild,_instanceof(r,f)?r.combineWidget(i):(u=t.firstChild,!_instanceof(t,f)&&_instanceof(r,n)&&_instanceof(u,n)&&r.index===u.index&&r.combine(t.childWidgets.shift(),i)),this.addWidgets(t.childWidgets),t.childWidgets=[]);t.destroyInternal(i)},n.prototype.addWidgets=function(t){for(var i,r;t.length>0;)i=t.shift(),_instanceof(i,k)&&_instanceof(this,u)?(i.paragraph=this,this.height+=i.height):_instanceof(i,n)&&(r=this.lastChild,i.containerWidget=this,i.y=_instanceof(r,n)?r.y+r.height:this.y,this.height+=i.height),this.childWidgets.push(i)},n.prototype.removeChild=function(n){n>-1&&n<this.childWidgets.length&&this.childWidgets.splice(n,1)},n.prototype.destroy=function(){if(this.childWidgets)for(;this.childWidgets.length>0;){var t=this.childWidgets.pop();(_instanceof(t,k)||_instanceof(t,n))&&t.destroy()}this.childWidgets=void 0;this.containerWidget&&this.containerWidget.removeChild(this.indexInOwner);this.containerWidget=void 0;this.margin=void 0;this.x=void 0;this.y=void 0;this.width=void 0;this.height=void 0;this.index=void 0},n}(),ri=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.floatingElements=[],t.sectionFormatIn=void 0,t}return st(t,n),Object.defineProperty(t.prototype,"sectionFormat",{get:function(){return _instanceof(this,c)?this.sectionFormatIn:this.page?this.page.bodyWidgets[0].sectionFormat:void 0},set:function(n){_instanceof(this,c)&&(this.sectionFormatIn=n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sectionIndex",{get:function(){var n=0;return _instanceof(this,c)?n=this.index:this.page&&(n=this.page.bodyWidgets[0].index),n},enumerable:!0,configurable:!0}),t.prototype.getHierarchicalIndex=function(n){return n=_instanceof(this,c)?this.index+";"+n:_instanceof(this,it)?"Footnote"===this.footNoteType?"FN;"+n:"EN;"+n:-1!==this.headerFooterType.indexOf("Header")?"H;"+n:"F;"+n,sf.base.isNullOrUndefined(this.page)?n:this.page.documentHelper.pages.indexOf(this.page)+";"+n},t}(gt),c=function(n){function t(){return n.call(this)||this}return st(t,n),t.prototype.equals=function(n){return _instanceof(n,t)&&n.sectionFormat===this.sectionFormat},t.prototype.getHierarchicalIndex=function(n){return n=this.index+";"+n,sf.base.isNullOrUndefined(this.page)?n:this.page.documentHelper.pages.indexOf(this.page)+";"+n},t.prototype.getTableCellWidget=function(n){for(var t,r,u,i=0;i<this.childWidgets.length;i++)if(_instanceof(this.childWidgets[i],f)&&((t=this.childWidgets[i],r=0,t.wrapTextAround&&(r=t.getTableCellWidth()),!t.wrapTextAround&&t.y<=n.y&&t.y+t.height>=n.y)||t.wrapTextAround&&t.x<=n.x&&t.x+r>=n.x&&t.y<=n.y&&t.y+t.height>=n.y))return t.getTableCellWidget(n);return u=void 0,this.childWidgets.length>0&&(u=this.childWidgets[0].y<=n.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(n):this.childWidgets[0].getTableCellWidget(n)),u},t.prototype.destroyInternal=function(n){var t,i,r;if(this.height,!sf.base.isNullOrUndefined(this.childWidgets)){for(t=0;t<this.childWidgets.length;t++){if(i=this.childWidgets[t],i.destroyInternal(n),sf.base.isNullOrUndefined(this.childWidgets))break;t--}this.childWidgets=void 0}sf.base.isNullOrUndefined(this.page)||(r=this.indexInOwner,this.indexInOwner>-1&&(this.page.bodyWidgets.splice(r,1),0===this.page.bodyWidgets.length?this.page.destroy():_instanceof(this,ct)&&this.page.headerWidget===this?this.page.headerWidget=void 0:_instanceof(this,ct)&&this.page.footerWidget===this&&(this.page.footerWidget=void 0),this.page=void 0));this.destroy()},t.prototype.destroy=function(){this.sectionFormat=void 0;this.page=void 0;n.prototype.destroy.call(this)},t}(ri),ct=function(n){function t(t){var i=n.call(this)||this;return i.isEmpty=!1,i.headerFooterType=t,i}return st(t,n),t.prototype.getTableCellWidget=function(){},t.prototype.equals=function(n){return _instanceof(n,t)&&n.containerWidget===this.containerWidget},t.prototype.clone=function(){for(var r,n=new t(this.headerFooterType),i=0;i<this.childWidgets.length;i++)r=this.childWidgets[i].clone(),n.childWidgets.push(r),r.index=i,r.containerWidget=n;return n.isEmpty=this.isEmpty,n.x=this.x,n.y=this.y,n.height=0,n.width=0,n},t.prototype.destroyInternal=function(){this.page=void 0;n.prototype.destroy.call(this)},t}(ri),wt=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.isLayouted=!1,t.locked=!1,t.lockedBy="",t.footNoteReference=void 0,t}return st(i,n),Object.defineProperty(i.prototype,"bodyWidget",{get:function(){for(var t,n=this;n.containerWidget;){if(_instanceof(n.containerWidget,et)){if(t=n.containerWidget.containerShape.line.paragraph,t)return t.bodyWidget}else if(_instanceof(n.containerWidget,ri))return n.containerWidget;n=n.containerWidget}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"leftIndent",{get:function(){return _instanceof(this,u)&&_instanceof(this.paragraphFormat,ut)?this.paragraphFormat.leftIndent:_instanceof(this,f)&&_instanceof(this.tableFormat,pt)?this.tableFormat.leftIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rightIndent",{get:function(){return _instanceof(this,u)&&_instanceof(this.paragraphFormat,ut)?this.paragraphFormat.rightIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isInsideTable",{get:function(){return _instanceof(this.containerWidget,s)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isInHeaderFooter",{get:function(){return _instanceof(this.bodyWidget,ct)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"associatedCell",{get:function(){if(_instanceof(this.containerWidget,s))return this.containerWidget},enumerable:!0,configurable:!0}),i.prototype.isPageBreak=function(){var n=!1;return _instanceof(this,u)&&null!=this&&1===this.childWidgets.length&&1===this.firstChild.children.length&&(n=this.firstChild.children[0].isPageBreak),n},i.prototype.getHierarchicalIndex=function(n){if(n=this.containerWidget.childWidgets.indexOf(this)+";"+n,!sf.base.isNullOrUndefined(this.containerWidget)){if(_instanceof(this.containerWidget,et)||_instanceof(this.containerWidget,i))return this.containerWidget.getHierarchicalIndex(n);_instanceof(this.containerWidget,ri)&&(n=this.containerWidget.getHierarchicalIndex(n))}return n},i.prototype.getIndex=function(){return _instanceof(this,u)||_instanceof(this,f)?this.containerWidget.childWidgets.indexOf(this):_instanceof(this,a)?this.ownerTable.childWidgets.indexOf(this):_instanceof(this,s)?this.ownerRow.childWidgets.indexOf(this):0},i.prototype.getContainerWidth=function(){var n,i;return this.isInsideTable?this.associatedCell.getCellWidth(this):_instanceof(this.containerWidget,et)?(n=this.containerWidget.containerShape,t.convertPixelToPoint(n.width)-t.convertPixelToPoint(n.textFrame.marginLeft)-t.convertPixelToPoint(n.textFrame.marginRight)):(i=this.bodyWidget.sectionFormat,i.pageWidth-(i.leftMargin+i.rightMargin))},Object.defineProperty(i.prototype,"bidi",{get:function(){return _instanceof(this,u)&&_instanceof(this.paragraphFormat,ut)?this.paragraphFormat.bidi:_instanceof(this,f)&&_instanceof(this.tableFormat,pt)&&this.tableFormat.bidi},enumerable:!0,configurable:!0}),i}(gt),it=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return st(t,n),t.prototype.getMinimumAndMaximumWordWidth=function(){throw new Error("Method not implemented.");},t.prototype.getTableCellWidget=function(){},t.prototype.equals=function(n){return _instanceof(n,t)&&n.containerWidget===this.containerWidget},t.prototype.clone=function(){for(var r,n=new t,i=0;i<this.childWidgets.length;i++)r=this.childWidgets[i].clone(),n.childWidgets.push(r),r.index=i,r.containerWidget=n;return n.block=this.block,n},t.prototype.destroyInternal=function(){this.block=void 0;n.prototype.destroy.call(this)},t}(ri),u=function(n){function u(){var t=n.call(this)||this;return t.isChangeDetected=!1,t.floatingElements=[],t.paragraphFormat=new ut(t),t.characterFormat=new p(t),t}return st(u,n),Object.defineProperty(u.prototype,"isEndsWithPageBreak",{get:function(){return this.childWidgets.length>0&&this.lastChild.isEndsWithPageBreak},enumerable:!0,configurable:!0}),u.prototype.equals=function(n){return _instanceof(n,u)&&n.paragraphFormat===this.paragraphFormat},u.prototype.isContainsShapeAlone=function(){for(var r,t,i=!1,n=0;n<this.childWidgets.length;n++)for(r=this.childWidgets[n],t=0;t<r.children.length;t++){if(!_instanceof(r.children[t],nt))return!1;i=!0}return!!i},u.prototype.isEmpty=function(){var u,o,f,n;if(sf.base.isNullOrUndefined(this.childWidgets)||0===this.childWidgets.length)return!0;for(u=0;u<this.childWidgets.length;u++)for(o=this.childWidgets[u],f=0;f<o.children.length;f++)if(n=o.children[f],0!==n.length&&(_instanceof(n,i)||_instanceof(n,v)||_instanceof(n,e)||_instanceof(n,ot)||_instanceof(n,ht)||_instanceof(n,ir)||_instanceof(n,nt)||_instanceof(n,w)||_instanceof(n,r)&&t.isLinkedFieldCharacter(n)))return!1;return!0},u.prototype.getInline=function(n,u){for(var y,h,p,c,f=void 0,s=0,l=!1,w=this.getSplitWidgets(),a=0;a<w.length;a++)for(y=w[a],h=0;h<y.childWidgets.length;h++)for(p=y.childWidgets[h],c=0;c<p.children.length;c++)if(!_instanceof(f=p.children[c],o)){if((!l&&(_instanceof(f,i)||_instanceof(f,v)||_instanceof(f,nt)||_instanceof(f,e)||_instanceof(f,r)&&t.isLinkedFieldCharacter(f))||_instanceof(f,ir))&&(l=!0),l&&n<=s+f.length)return{element:f,index:u=n-s};s+=f.length}return n>s&&(u=sf.base.isNullOrUndefined(f)?n:f.length),{element:f,index:u}},u.prototype.getLength=function(){for(var r,t,u,i=0,n=0;n<this.childWidgets.length;n++)for(r=this.childWidgets[n],t=0;t<r.children.length;t++)u=r.children[t],_instanceof(u,o)||(i+=u.length);return i},u.prototype.getTableCellWidget=function(){},u.prototype.getMinimumAndMaximumWordWidth=function(n,u){var s,y,e,c,b,rt;if(n=t.convertPointToPixel(n),u=t.convertPointToPixel(u),this.childWidgets.length>0){for(var f=this.childWidgets[0].children[0],o="",a=new h,k=[];;){if(_instanceof(f,i)&&""!==f.text?(a.add(f,o.length),o+=f.text):_instanceof(f,r)&&0===f.fieldType?(s=f,sf.base.isNullOrUndefined(s.fieldEnd)||(f=sf.base.isNullOrUndefined(s.fieldSeparator)?s.fieldEnd:s.fieldSeparator)):_instanceof(f,v)&&k.push(f.width),sf.base.isNullOrUndefined(f)||sf.base.isNullOrUndefined(f.nextNode))break;f=f.nextNode}for(var et=new RegExp("\\b\\w+\\b","g"),d=[],ut=void 0;!sf.base.isNullOrUndefined(ut=et.exec(o));)d.push(ut);for(y=0;y<d.length;y++){e=d[y];c=0;o="";for(var ft="",l=0,g=e.index,nt=e.index,tt=0;tt<a.keys.length;tt++){var p=a.keys[tt],w=a.get(p),it=p.length;if(nt<=w+it&&(l=nt-w,e.index+e[0].length<=w+it?g=e.index+e[0].length-(w+l):nt+=g=it-l,ft+=o=p.text.substring(l,l+g)),""!==o&&(c+=this.bodyWidget.page.documentHelper.textHelper.getWidth(o,p.characterFormat)),ft===e[0])break}0!==c&&(0===n||c>n)&&(n=c)}b=0;k.length>0&&(b=Math.max.apply(null,k));(0===n||b>n)&&(n=b);rt=this.measureParagraph();(0===u||rt>u)&&(u=rt)}return{maximumWordWidth:t.convertPixelToPoint(u),minimumWordWidth:t.convertPixelToPoint(n)}},u.prototype.measureParagraph=function(){for(var u,t=0,n=this.childWidgets[0].children[0];;){if(_instanceof(n,i)&&""!==n.text?t+=this.bodyWidget.page.documentHelper.textHelper.getWidth(n.text,n.characterFormat):_instanceof(n,r)&&0===n.fieldType?(u=n,null!=u.fieldEnd&&(n=sf.base.isNullOrUndefined(u.fieldSeparator)?u.fieldEnd:u.fieldSeparator)):_instanceof(n,v)&&(t+=n.width),sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.nextNode))break;n=n.nextNode}return this.leftIndent>0&&(t+=this.leftIndent),this.rightIndent>0&&(t+=this.rightIndent),t},u.prototype.clone=function(){var n=new u,i,t,r,f;for(n.paragraphFormat.copyFormat(this.paragraphFormat),n.characterFormat.copyFormat(this.characterFormat),i=0;i<this.childWidgets.length;i++){for(t=this.childWidgets[i].clone(),n.childWidgets.push(t),r=0;r<t.children.length;r++)f=t.children[r],_instanceof(f,lt)&&"Inline"!==f.textWrappingStyle&&n.floatingElements.push(f);t.paragraph=n}return n.x=this.x,n.y=this.y,n.height=this.height,n.width=this.width,this.contentControlProperties&&(n.contentControlProperties=this.contentControlProperties),n},u.prototype.destroyInternal=function(){var t=this.height,n;if(!sf.base.isNullOrUndefined(this.childWidgets)){for(n=0;n<this.childWidgets.length;n++){if(this.childWidgets[n].destroy(),1===this.childWidgets.length&&sf.base.isNullOrUndefined(this.childWidgets[0].children)&&(this.childWidgets=void 0),sf.base.isNullOrUndefined(this.childWidgets))break;n--}this.childWidgets=void 0}sf.base.isNullOrUndefined(this.containerWidget)||sf.base.isNullOrUndefined(this.containerWidget.childWidgets)||-1===this.containerWidget.childWidgets.indexOf(this)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=t,this.containerWidget=void 0);this.destroy()},u.prototype.destroy=function(){this.paragraphFormat=void 0;this.characterFormat=void 0;n.prototype.destroy.call(this)},u}(wt),vf=function(){function n(){}return n.prototype.clone=function(){var t=new n;return t.allowOverlap=this.allowOverlap,t.distanceTop=this.distanceTop,t.distanceRight=this.distanceRight,t.distanceLeft=this.distanceLeft,t.distanceBottom=this.distanceBottom,t.verticalAlignment=this.verticalAlignment,t.verticalOrigin=this.verticalOrigin,t.verticalPosition=this.verticalPosition,t.horizontalAlignment=this.horizontalAlignment,t.horizontalOrigin=this.horizontalOrigin,t.horizontalPosition=this.horizontalPosition,t},n}(),f=function(n){function i(){var t=n.call(this)||this;return t.flags=0,t.leftMargin=0,t.topMargin=0,t.rightMargin=0,t.bottomMargin=0,t.isDefaultFormatUpdated=!1,t.isContainInsideTable=!1,t.margin=new hi(t.leftMargin,t.topMargin,t.rightMargin,t.bottomMargin),t.leftBorderWidth=0,t.rightBorderWidth=0,t.topBorderWidth=0,t.bottomBorderWidth=0,t.tableFormat=new pt(t),t.tableHolder=new su,t.spannedRowCollection=new h,t}return st(i,n),Object.defineProperty(i.prototype,"isGridUpdated",{get:function(){return(4&this.flags)>>2!=0},set:function(n){this.flags=251&this.flags|(n?1:0)<<2},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"continueHeader",{get:function(){return(2&this.flags)>>1!=0},set:function(n){this.flags=253&this.flags|(n?1:0)<<1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"header",{get:function(){return 0!=(1&this.flags)},set:function(n){this.flags=254&this.flags|(n?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isBidiTable",{get:function(){return(16&this.flags)>>4!=0},set:function(n){this.flags=239&this.flags|(n?1:0)<<4},enumerable:!0,configurable:!0}),i.prototype.equals=function(n){return _instanceof(n,i)&&n.tableFormat===this.tableFormat},i.prototype.combineRows=function(n){for(var i,t=0;t<this.childWidgets.length;t++)i=this.childWidgets[t],0===i.childWidgets.length?(i.destroy(),t--):i.combineCells(n)},i.prototype.contains=function(n){if(this.equals(n.ownerTable))return!0;for(;n.ownerTable.isInsideTable;){if(this.equals(n.ownerTable))return!0;n=n.ownerTable.associatedCell}return this.equals(n.ownerTable)},i.prototype.getOwnerWidth=function(){var n=this.getContainerWidth();return(n=n-this.leftIndent-this.rightIndent)>=0?n:0},i.prototype.getTableWidth=function(){for(var n=0,t=0;t<this.childWidgets.length;t++){for(var i=0,u=this.childWidgets[t],r=0;r<u.childWidgets.length;r++)i+=u.childWidgets[r].cellFormat.cellWidth;n<i&&(n=i)}return n},i.prototype.getTableCellWidth=function(){for(var n,i,r=0,u=0;u<this.childWidgets.length;u++){for(var f=0,o=this.childWidgets[u],e=0;e<o.childWidgets.length;e++)n=o.childWidgets[e],i=n.width,0===i&&((i=n.cellFormat.cellWidth)>n.cellFormat.preferredWidth&&0!==n.cellFormat.preferredWidth&&"Percent"!==n.cellFormat.preferredWidthType&&(i=n.cellFormat.preferredWidth),i=t.convertPointToPixel(i-(n.margin.left+n.margin.right))),f+=i+n.margin.left+n.margin.right;r<f&&(r=f)}return r},i.prototype.getTableClientWidth=function(n){var t=n;return"Point"===this.tableFormat.preferredWidthType&&this.tableFormat.preferredWidth>0?t=this.tableFormat.preferredWidth:"Percent"===this.tableFormat.preferredWidthType&&this.tableFormat.preferredWidth>0&&(t=t*this.tableFormat.preferredWidth/100),t},i.prototype.getCellWidth=function(n,t,i,r){var u=n;return"Percent"===t?u=n*i/100:"Point"===t?u=n:sf.base.isNullOrUndefined(r)||(u=r.getMinimumPreferredWidth()),u},i.prototype.fitCellsToClientArea=function(n){for(var t,r,i=n/this.getTableWidth(),u=0;u<this.childWidgets.length;u++)for(t=this.childWidgets[u],t.rowFormat.gridAfterWidth*=i,t.rowFormat.gridBeforeWidth*=i,r=0;r<t.childWidgets.length;r++)t.childWidgets[r].cellFormat.cellWidth*=i,t.childWidgets[r].cellFormat.preferredWidth*=i},i.prototype.getTableCellWidget=function(n){for(var i=void 0,t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t].y<=n.y&&this.childWidgets[t].y+this.childWidgets[t].height>=n.y){i=this.childWidgets[t].getTableCellWidget(n);break}return i},i.prototype.calculateGrid=function(){var r=[],n=[],k=this.getOwnerWidth(!0),s=this.getTableClientWidth(k),c,y,o,f,t,b,a,v,w;for(this.tableCellInfo=new h,c=0;c<this.childWidgets.length;c++){var u=this.childWidgets[c],p=new h,l=u.rowFormat,e=u.rowFormat.gridBefore,i=0;for(r.indexOf(i)<0&&r.push(i),i+=this.getCellWidth(l.gridBeforeWidth,l.gridBeforeWidthType,s,null),y=parseFloat(i.toFixed(2)),r.indexOf(y)<0&&r.push(y),o=0;o<u.childWidgets.length;o++){for(f=u.childWidgets[o],t=0;t<n.length;t++)n[t].columnIndex<e||(b=n[t].cellFormat.rowSpan,a=!0,n[t].columnIndex>e?(a=!1,o===u.childWidgets.length-1&&u.rowFormat.gridAfter>0&&(i+=this.getCellWidth(n[t].cellFormat.preferredWidth,n[t].cellFormat.preferredWidthType,s,null))):(i+=this.getCellWidth(n[t].cellFormat.preferredWidth,n[t].cellFormat.preferredWidthType,s,null),e=n[t].columnIndex+n[t].cellFormat.columnSpan),a||o!==u.childWidgets.length-1||(a=!0),a&&c-n[t].ownerRow.rowIndex==b-1&&(n.splice(t,1),t--));if(f.cellFormat.rowSpan>1)if(0===n.length||n[n.length-1].columnIndex<=e)n.push(f);else for(v=n.length;v>0;v--)n[v-1].columnIndex>e&&n.splice(v-1,0,f);p.containsKey(f.cellIndex)||p.add(f.cellIndex,parseFloat((i-y).toFixed(2)));e+=f.cellFormat.columnSpan;i+=this.getCellWidth(f.cellFormat.preferredWidth,f.cellFormat.preferredWidthType,s,null);w=parseFloat(i.toFixed(2));r.indexOf(w)<0&&r.push(w);o===u.childWidgets.length-1&&l.gridAfter>0&&(i+=this.getCellWidth(l.gridAfterWidth,"Point",s,null),r.indexOf(parseFloat(i.toFixed(2)))<0&&r.push(parseFloat(i.toFixed(2))),e+=l.gridAfter);this.tableCellInfo.containsKey(u.rowIndex)||this.tableCellInfo.add(u.rowIndex,p)}}r.sort(function(n,t){return n-t});this.tableHolder.columns.length>0&&r.length-1!==this.tableHolder.columns.length&&this.updateColumnSpans(r,s);this.tableCellInfo.clear();this.tableCellInfo=void 0},i.prototype.updateColumnSpans=function(n,t){for(var i,f,r,e,u=0;u<this.childWidgets.length;u++){for(i=this.childWidgets[u],i.rowFormat.gridBeforeWidth>=0&&(i.rowFormat.gridBefore=i.getGridCount(n,void 0,-1,t)),f=0;f<i.childWidgets.length;f++)r=i.childWidgets[f],e=i.getGridCount(n,r,r.getIndex(),t),e>0&&r.cellFormat.columnSpan!==e&&(r.cellFormat.columnSpan=e);i.rowFormat.gridAfterWidth>=0&&(i.rowFormat.gridAfter=i.getGridCount(n,void 0,i.childWidgets.length,t))}},i.prototype.getMinimumAndMaximumWordWidth=function(n,t){this.checkTableColumns();var i=this.tableHolder.getTotalWidth(0);return i>n&&(n=i),i>t&&(t=i),{minimumWordWidth:n,maximumWordWidth:t}},i.prototype.checkTableColumns=function(){this.isGridUpdated||((this.isAutoFit()||0===this.tableHolder.columns.length)&&this.buildTableColumns(),this.isGridUpdated=!0)},i.prototype.isAutoFit=function(){var n=this.bodyWidget;return!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.page)&&n.page.documentHelper.layout.getParentTable(this).tableFormat.allowAutoFit},i.prototype.buildTableColumns=function(){var d,y,l,r,a,u,nt,w,g,b;if(!this.isGridUpdated){this.tableHolder.resetColumns();var e,h=0,f=[],k="Auto"===this.tableFormat.preferredWidthType,v=this.tableFormat.allowAutoFit;for(h=!(!sf.base.isNullOrUndefined(this.bodyWidget.page)&&_instanceof(this.bodyWidget.page.viewer,at)&&v)||this.isInsideTable||_instanceof(this.containerWidget,et)?this.getOwnerWidth(!0):t.convertPixelToPoint(this.bodyWidget.page.viewer.clientArea.width-3*this.bodyWidget.page.viewer.padding.right),h=this.tableFormat.preferredWidth>h?this.tableFormat.preferredWidth:h,d=k&&0===this.tableFormat.preferredWidth&&!v,e=this.getTableClientWidth(h),d&&!this.isDefaultFormatUpdated&&this.splitWidthToTableCells(e,d),y=0;y<this.childWidgets.length;y++){var o=this.childWidgets[y],c=o.rowFormat,n=0,i=0,s=new yr,p=0;for(c.gridBefore>0&&(0!==o.rowFormat.beforeWidth||0!==o.rowFormat.gridBeforeWidth)&&(!this.bodyWidget.page.documentHelper.alignTablesRowByRow||"Left"===o.ownerTable.tableFormat.tableAlignment)&&(i=this.getCellWidth(c.gridBeforeWidth,o.rowFormat.gridAfterWidthType,e,null),s.minimumWidth=i,this.tableHolder.addColumns(n,n=c.gridBefore,i,s,p=i)),l=0;l<o.childWidgets.length;l++){for(r=o.childWidgets[l],0===f.length&&(r.columnIndex=n),a=0;a<f.length;a++)u=f[a],u.columnIndex<n?r.columnIndex=n:(w=!0,nt=u.cellFormat.rowSpan,u.columnIndex>n?(r.columnIndex=n,w=!1):(s=u.getCellSizeInfo(v),i=this.getCellWidth(u.cellFormat.preferredWidth,u.cellFormat.preferredWidthType,e,u),this.tableHolder.columns.length>0?(this.tableHolder.addColumns(n,n=this.tableHolder.columns.indexOf(u.ownerColumn)+u.cellFormat.columnSpan,i,s,p+=i),r.columnIndex=n):(this.tableHolder.addColumns(n,n=u.columnIndex+u.cellFormat.columnSpan,i,s,p+=i),r.columnIndex=n)),w||l!==o.childWidgets.length-1||(w=!0),w&&y-u.ownerRow.rowIndex==nt-1&&(f.splice(a,1),a--));if(r.cellFormat.rowSpan>1)if(0===f.length||f[f.length-1].columnIndex<=n)f.push(r);else{for(g=0,b=f.length;b>0;b--)f[b-1].columnIndex>n&&(g=b-1);f.splice(g,0,r)}s=r.getCellSizeInfo(v);i=this.getCellWidth(r.cellFormat.preferredWidth,r.cellFormat.preferredWidthType,e,r);this.tableHolder.addColumns(n,n+=r.cellFormat.columnSpan,i,s,p+=i);l===o.childWidgets.length-1&&c.gridAfterWidth>0&&(i=this.getCellWidth(c.gridAfterWidth,"Point",e,null),this.tableHolder.addColumns(n,n+=c.gridAfter,i,s,p+=i))}}d&&!this.isDefaultFormatUpdated&&(this.isDefaultFormatUpdated=!0);this.tableHolder.validateColumnWidths();v?this.tableHolder.autoFitColumn(h,e,k,this.isInsideTable):this.tableHolder.fitColumns(h,e,k,this.leftIndent+this.rightIndent);this.setWidthToCells(e,k)}},i.prototype.setWidthToCells=function(n){for(var u,t,f,i,r=0;r<this.childWidgets.length;r++){for(u=this.childWidgets[r],t=u.rowFormat,t.gridBefore>0&&(t.beforeWidth=this.tableHolder.getCellWidth(0,t.gridBefore,n)),f=0;f<u.childWidgets.length;f++)i=u.childWidgets[f],"Auto"!==i.cellFormat.preferredWidthType&&0!==i.cellFormat.cellWidth||(i.cellFormat.cellWidth=this.tableHolder.getCellWidth(i.columnIndex,i.cellFormat.columnSpan,n));t.gridAfter>0&&(t.afterWidth=this.tableHolder.getCellWidth(0,t.gridAfter,n))}},i.prototype.updateProperties=function(n,t,i){var u,h,f,o,c,r,s,e;if(n&&(this.tableFormat.allowAutoFit="FixedColumnWidth"!==i),this===t)if("FixedColumnWidth"===i)for(this.tableFormat.preferredWidth=0,this.tableFormat.preferredWidthType="Auto",u=0;u<this.childWidgets.length;u++)for(h=this.childWidgets[u],f=0;f<h.childWidgets.length;f++)o=h.childWidgets[f],o.cellFormat.preferredWidthType="Point",o.cellFormat.preferredWidth=o.cellFormat.cellWidth;else if("FitToWindow"===i)for(c=this.tableHolder.getTotalWidth(0),this.tableFormat.leftIndent=0,this.tableFormat.preferredWidth=100,this.tableFormat.preferredWidthType="Percent",u=0;u<this.childWidgets.length;u++)for(r=this.childWidgets[u],s=0;s<r.childWidgets.length;s++)"Percent"!==(e=r.childWidgets[s]).cellFormat.preferredWidthType&&(e.cellFormat.preferredWidthType="Percent",e.cellFormat.preferredWidth=e.cellFormat.cellWidth/c*100);else for(this.tableFormat.preferredWidth=0,this.tableFormat.preferredWidthType="Auto",u=0;u<this.childWidgets.length;u++)for((r=this.childWidgets[u]).rowFormat.beforeWidth=0,r.rowFormat.gridBefore=0,r.rowFormat.gridBeforeWidth=0,r.rowFormat.gridBeforeWidthType="Auto",r.rowFormat.afterWidth=0,r.rowFormat.gridAfter=0,r.rowFormat.gridAfterWidth=0,r.rowFormat.gridAfterWidthType="Auto",f=0;f<r.childWidgets.length;f++)(e=r.childWidgets[f]).cellFormat.preferredWidth=0,e.cellFormat.preferredWidthType="Auto";else t.updateProperties(!1,t,i)},i.prototype.getMaxRowWidth=function(n){for(var r,t=0,i=0;i<this.childWidgets.length;i++){for(var e=this.childWidgets[i],u=0,f=0;f<e.childWidgets.length;f++)r=e.childWidgets[f],u+=this.getCellWidth(r.cellFormat.preferredWidth,r.cellFormat.preferredWidthType,n,r);t<u&&(t=u)}return t},i.prototype.updateWidth=function(){var n=this.tableHolder.getTotalWidth(0),t=this.getOwnerWidth(!0),i=this.getTableClientWidth(t),r;(i<=n&&"Auto"===this.tableFormat.preferredWidthType&&(this.tableFormat.preferredWidthType="Point"),"Auto"!==this.tableFormat.preferredWidthType)&&("Point"===this.tableFormat.preferredWidthType?this.tableFormat.preferredWidth=this.getMaxRowWidth(i):(r=n/t*100,this.tableFormat.preferredWidth=r))},i.prototype.convertPointToPercent=function(n,t){var i=0;return i=n/t*100,(i=Math.round(i))<100?i:100},i.prototype.updateChildWidgetLeft=function(n){for(var i,t=0;t<this.childWidgets.length;t++)i=this.childWidgets[t],i.x=n,i.updateChildWidgetLeft(n)},i.prototype.shiftWidgetsForRtlTable=function(n,t){var s=t.x,h=n.right,e=0,r,i;for(t.tableFormat&&t.tableFormat.cellSpacing>0&&(e=t.tableFormat.cellSpacing),r=0;r<t.childWidgets.length;r++)for(var u=t.childWidgets[r],o=h-(u.x-s),f=0;f<u.childWidgets.length;f++)i=u.childWidgets[f],o-=i.width+i.margin.left+i.margin.right-i.rightBorderWidth+e,i.updateWidgetLeft(o+i.margin.left)},i.prototype.clone=function(){var n=new i,t,r;for(n.tableHolder=this.tableHolder.clone(),n.tableFormat.copyFormat(this.tableFormat),this.wrapTextAround&&(n.wrapTextAround=this.wrapTextAround,n.positioning=this.positioning.clone()),t=0;t<this.childWidgets.length;t++)r=this.childWidgets[t].clone(),n.childWidgets.push(r),r.containerWidget=n,r.index=t;return n.x=this.x,n.y=this.y,n.height=this.height,n.width=this.width,n.containerWidget=this.containerWidget,this.contentControlProperties&&(n.contentControlProperties=this.contentControlProperties),n},i.getTableOf=function(n){if(_instanceof(n,ni)){var t=a.getRowOf(n);return sf.base.isNullOrUndefined(t)?_instanceof(n.ownerBase,pt)&&_instanceof(n.ownerBase.ownerBase,i)?n.ownerBase.ownerBase:void 0:t.ownerTable}},i.prototype.fitChildToClientArea=function(){var e=this.getContainerWidth(),t,f,r,u,n;for(Math.round(e)<Math.round(this.getTableWidth())&&this.fitCellsToClientArea(e),t=0;t<this.childWidgets.length;t++)for(f=this.childWidgets[t],r=0;r<f.childWidgets.length;r++)for(u=f.childWidgets[r],n=0;n<u.childWidgets.length;n++)_instanceof(u.childWidgets[n],i)&&u.childWidgets[n].fitChildToClientArea()},i.prototype.getColumnCellsForSelection=function(n,t){for(var c,s,f=[],e=n.columnIndex,r=t.columnIndex+t.cellFormat.columnSpan,h=0;h<this.childWidgets.length;h++)for(c=this.childWidgets[h],s=0;s<c.childWidgets.length;s++){var u=c.childWidgets[s],i=u.columnIndex,o=u.cellFormat.columnSpan;i+o>e&&i+o<r||i>e&&i<r||i>e&&i<r&&i+o<r||i<e&&i+o>r?f.indexOf(u)<0&&f.push(u):i!==e&&i+o!==r||f.indexOf(u)<0&&f.push(u)}return f},i.prototype.splitWidthToTableCells=function(n,t){for(var i=0;i<this.childWidgets.length;i++)this.childWidgets[i].splitWidthToRowCells(n,t)},i.prototype.insertTableRowsInternal=function(n,t){for(var r,i=n.length-1;i>=0;i--)r=n.splice(i,1)[0],r.containerWidget=this,this.childWidgets.splice(t,0,r);this.updateRowIndex(t);this.isGridUpdated=!1;this.buildTableColumns();this.isGridUpdated=!0},i.prototype.updateRowIndex=function(n){for(var t,i,r=n;r<this.childWidgets.length;r++){for(t=this.childWidgets[r],t.index=r,i=0;i<t.childWidgets.length;i++)t.childWidgets[i].index=i,t.childWidgets[i].rowIndex=t.rowIndex;n++}},i.prototype.getCellStartOffset=function(n){var i=0,t;return n&&this.tableCellInfo&&this.tableCellInfo.containsKey(n.ownerRow.rowIndex)&&(t=this.tableCellInfo.get(n.ownerRow.rowIndex),t.containsKey(n.cellIndex)&&(i=t.get(n.cellIndex))),i},i.prototype.destroyInternal=function(n){var r=this.height,t,i;if(!sf.base.isNullOrUndefined(this.childWidgets)){for(t=0;t<this.childWidgets.length;t++){if(i=void 0,i=this.childWidgets[t],sf.base.isNullOrUndefined(i)||i.destroyInternal(n),sf.base.isNullOrUndefined(this.childWidgets))break;t--}this.childWidgets=void 0}sf.base.isNullOrUndefined(this.containerWidget)||(_instanceof(this.containerWidget,c)&&-1!==this.containerWidget.floatingElements.indexOf(this)&&this.containerWidget.floatingElements.splice(this.containerWidget.floatingElements.indexOf(this),1),sf.base.isNullOrUndefined(this.containerWidget.childWidgets)||(-1!==this.containerWidget.childWidgets.indexOf(this)&&this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=r),this.containerWidget=void 0);this.destroy()},i.prototype.destroy=function(){this.tableFormat=void 0;this.spannedRowCollection&&this.spannedRowCollection.destroy();this.spannedRowCollection=void 0;this.tableHolder=void 0;this.flags=void 0;this.leftMargin=void 0;this.topMargin=void 0;this.rightMargin=void 0;this.bottomMargin=void 0;this.headerHeight=void 0;this.description=void 0;this.title=void 0;this.isDefaultFormatUpdated=void 0;n.prototype.destroy.call(this)},i}(wt),a=function(n){function i(){var t=n.call(this)||this;return t.topBorderWidth=0,t.bottomBorderWidth=0,t.rowFormat=new ti(t),t}return st(i,n),Object.defineProperty(i.prototype,"rowIndex",{get:function(){return this.containerWidget?this.containerWidget.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ownerTable",{get:function(){if(_instanceof(this.containerWidget,f))return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nextRow",{get:function(){var n=this.indexInOwner;if(n>-1&&n<this.ownerTable.childWidgets.length-1)return this.ownerTable.childWidgets[n+1]},enumerable:!0,configurable:!0}),i.prototype.equals=function(n){return _instanceof(n,i)&&n.rowFormat===this.rowFormat},i.prototype.combineCells=function(n){for(var t,i=0;i<this.childWidgets.length;i++)t=this.childWidgets[i],(t.combineWidget(n),1===t.cellFormat.rowSpan)&&(t.height,t.margin.top,t.margin.bottom,this.height-this.ownerTable.tableFormat.cellSpacing<t.height&&(this.height=this.ownerTable.tableFormat.cellSpacing+t.height))},i.getRowOf=function(n){if(_instanceof(n,ni)){var t=s.getCellOf(n);return sf.base.isNullOrUndefined(t)?_instanceof(n.ownerBase,ti)&&_instanceof(n.ownerBase.ownerBase,i)?n.ownerBase.ownerBase:void 0:t.ownerRow}},i.prototype.getCell=function(n,t){for(var r,i=0;i<this.childWidgets.length;i++)if(r=this.childWidgets[i],r.rowIndex===n&&r.index===t)return r},i.prototype.splitWidthToRowCells=function(n,t){for(var i=this.childWidgets,u=n/i.length,r=0;r<i.length;r++)if(t&&0===i[r].cellFormat.preferredWidth)i[r].cellFormat.preferredWidth=u,this.ownerTable.isDefaultFormatUpdated=!1;else{if(t){this.ownerTable.isDefaultFormatUpdated=!0;break}i[r].cellFormat.preferredWidth=u}},i.prototype.getGridCount=function(n,t,i,r){var e=0,o=0,f=this.ownerTable,u=this.rowFormat,s;return-1===i?o=f.getCellWidth(u.gridBeforeWidth,u.gridBeforeWidthType,r,null):(e+=f.getCellWidth(u.gridBeforeWidth,u.gridBeforeWidthType,r,null),i>=0&&(e+=f.getCellStartOffset(t)),o=i<this.childWidgets.length?f.getCellWidth(t.cellFormat.preferredWidth,t.cellFormat.preferredWidthType,r,null):f.getCellWidth(u.gridAfterWidth,u.gridAfterWidthType,r,null)),s=this.getOffsetIndex(n,e),this.getOffsetIndex(n,e+o)-s},i.prototype.getOffsetIndex=function(n,t){var r,i;if(t=parseFloat(t.toFixed(2)),r=0,n.indexOf(t)>=0)r=n.indexOf(t);else{for(i=0;i<n.length;i++)if(n[i]>t)return i;r=n.length-1}return r},i.prototype.getCellOffset=function(n,t){for(var r,u=0,f=this.ownerTable,i=0;i<this.childWidgets.length;i++){if(r=this.childWidgets[i].cellFormat,i===n)break;u+=f.getCellWidth(r.preferredWidth,r.preferredWidthType,t,null)}return u},i.prototype.updateRowBySpannedCells=function(){for(var n,i=this.getPreviousRowSpannedCells(),r=this.rowIndex,t=0;t<i.length;t++)n=i[t],n.ownerRow.rowIndex+n.cellFormat.rowSpan-1>=r&&(n.cellFormat.rowSpan-=1)},i.prototype.getPreviousRowSpannedCells=function(n){for(var i,u,r=[],t=n?this:this.previousWidget;!sf.base.isNullOrUndefined(t);){for(i=0;i<t.childWidgets.length;i++)u=t.childWidgets[i],u.cellFormat.rowSpan>1&&r.splice(0,0,u);t=t.previousWidget}return r},i.prototype.getTableCellWidget=function(n){for(var i,r,t=0;t<this.childWidgets.length;t++)if((i=Math.round(this.childWidgets[t].x),i-this.childWidgets[t].margin.left-1<=n.x&&i+this.childWidgets[t].width>=n.x)||t===this.childWidgets.length-1&&this.childWidgets[t].x+this.childWidgets[t].width+1<=n.x)return this.childWidgets[t];return r=void 0,this.childWidgets.length>0&&(r=this.childWidgets[0].x<=n.x?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(n):this.childWidgets[0].getTableCellWidget(n)),r},i.prototype.getMinimumAndMaximumWordWidth=function(n,t){return{minimumWordWidth:n,maximumWordWidth:t}},i.prototype.destroyInternal=function(n){var i=this.height,t;if(!sf.base.isNullOrUndefined(this.childWidgets)){for(t=0;t<this.childWidgets.length;t++){if(this.childWidgets[t].destroyInternal(n),sf.base.isNullOrUndefined(this.childWidgets))break;t--}this.childWidgets=void 0}sf.base.isNullOrUndefined(this.containerWidget)||sf.base.isNullOrUndefined(this.containerWidget.childWidgets)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),(sf.base.isNullOrUndefined(this.containerWidget.childWidgets)||0===this.containerWidget.childWidgets.length)&&_instanceof(this.containerWidget,f)?this.containerWidget.destroyInternal(n):_instanceof(this.containerWidget.containerWidget,c)&&(this.containerWidget.containerWidget.height-=i),this.containerWidget.height-=i);this.destroy()},i.prototype.clone=function(){var n=new i,t,r;for(n.rowFormat.copyFormat(this.rowFormat),n.topBorderWidth=this.topBorderWidth,n.bottomBorderWidth=this.bottomBorderWidth,t=0;t<this.childWidgets.length;t++)r=this.childWidgets[t].clone(),n.childWidgets.push(r),r.containerWidget=n,r.index=t,r.rowIndex=this.rowIndex;return n.x=this.x,n.y=this.y,n.height=this.height,n.width=this.width,this.contentControlProperties&&(n.contentControlProperties=this.contentControlProperties),n},i.prototype.updateChildWidgetLeft=function(n){var r=0,i,t;for(this.ownerTable.tableFormat.cellSpacing>0&&(r=this.ownerTable.tableFormat.cellSpacing),i=0;i<this.childWidgets.length;i++)t=this.childWidgets[i],n+=r+t.margin.left,t.x=n,t.updateChildWidgetLeft(t.x),n+=t.width+t.margin.right},i.prototype.shiftWidgetForRtlTable=function(n,i,r){var o=i.x,s=0,e,f,u;for(null!=i.tableFormat&&i.tableFormat.cellSpacing>0&&(s=i.tableFormat.cellSpacing),e=o+t.convertPointToPixel(i.getTableWidth())-(r.x-o),f=0;f<r.childWidgets.length;f++)u=r.childWidgets[f],e-=u.width+u.margin.left+u.margin.right-u.rightBorderWidth+s,u.updateWidgetLeft(e+u.margin.left)},i.prototype.destroy=function(){this.rowFormat=void 0;this.rowFormat=void 0;this.topBorderWidth=void 0;this.bottomBorderWidth=void 0;n.prototype.destroy.call(this)},i}(wt),s=function(n){function t(){var t=n.call(this)||this;return t.rowIndex=-1,t.sizeInfoInternal=new yr,t.updatedTopBorders=[],t.margin=new hi(t.leftMargin,t.topMargin,t.rightMargin,t.bottomMargin),t.leftBorderWidth=0,t.rightBorderWidth=0,t.cellFormat=new si(t),t}return st(t,n),Object.defineProperty(t.prototype,"ownerColumn",{get:function(){return this.ownerTable.tableHolder.columns[this.columnIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.leftMargin:!sf.base.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("leftMargin")?this.ownerRow.rowFormat.leftMargin:sf.base.isNullOrUndefined(this.ownerTable)||sf.base.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.leftMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.topMargin:!sf.base.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("topMargin")?this.ownerRow.rowFormat.topMargin:sf.base.isNullOrUndefined(this.ownerTable)||sf.base.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.topMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.rightMargin:!sf.base.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("rightMargin")?this.ownerRow.rowFormat.rightMargin:sf.base.isNullOrUndefined(this.ownerTable)||sf.base.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.rightMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.bottomMargin:!sf.base.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("bottomMargin")?this.ownerRow.rowFormat.bottomMargin:sf.base.isNullOrUndefined(this.ownerTable)||sf.base.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.bottomMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellIndex",{get:function(){return this.ownerRow?this.ownerRow.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerTable",{get:function(){if(_instanceof(this.containerWidget,a))return this.containerWidget.ownerTable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerRow",{get:function(){return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sizeInfo",{get:function(){return this.sizeInfoInternal},enumerable:!0,configurable:!0}),t.prototype.equals=function(n){return _instanceof(n,t)&&n.cellFormat===this.cellFormat},t.prototype.getContainerTable=function(){for(var n=this.ownerTable;_instanceof(n,f)&&_instanceof(n.associatedCell,t);)n=n.associatedCell.getContainerTable();return n},t.prototype.getPreviousSplitWidget=function(){var n,t;if(_instanceof(this.containerWidget,a)){n=this.containerWidget;do{if(n=n.previousRenderedWidget,sf.base.isNullOrUndefined(n)||n.index<this.rowIndex)break;if(t=n.getCell(this.rowIndex,this.index),t&&this.equals(t))return t}while(n)}},t.prototype.getNextSplitWidget=function(){var i=this.cellFormat.rowSpan,n,t;if(_instanceof(this.containerWidget,a)){n=this.containerWidget;do{if(n=n.nextRenderedWidget,sf.base.isNullOrUndefined(n)||n.index>this.rowIndex+i)break;if(t=n.getCell(this.rowIndex,this.index),t&&this.equals(t))return t}while(n)}},t.prototype.getTableCellWidget=function(n){for(var i,t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t].y<=n.y&&this.childWidgets[t].y+this.childWidgets[t].height>=n.y)return this.childWidgets[t].getTableCellWidget(n);return i=void 0,this.childWidgets.length>0&&(i=this.childWidgets[0].y<=n.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(n):this.childWidgets[0].getTableCellWidget(n)),i},t.prototype.updateWidth=function(n){"Point"===this.cellFormat.preferredWidthType?this.cellFormat.preferredWidth=n:"Percent"===this.cellFormat.preferredWidthType&&(this.cellFormat.preferredWidth=this.convertPointToPercent(n));this.cellFormat.cellWidth=n},t.prototype.getCellWidth=function(n){var t=this.ownerTable,r=t?t.getTableClientWidth(t.getOwnerWidth(!0)):0,i=r,u=sf.base.isNullOrUndefined(this.leftMargin)?0:this.leftMargin,e=sf.base.isNullOrUndefined(this.rightMargin)?0:this.rightMargin;return t&&"Auto"===t.tableFormat.preferredWidthType&&t.tableFormat.allowAutoFit?i=0===this.cellFormat.preferredWidth?r:this.cellFormat.preferredWidth:"Percent"===this.cellFormat.preferredWidthType?i=this.cellFormat.preferredWidth*r/100-u-e:"Point"===this.cellFormat.preferredWidthType&&(i=_instanceof(n,f)&&"Percent"===n.tableFormat.preferredWidthType?this.cellFormat.cellWidth-u-e:this.cellFormat.preferredWidth-u-e),i},t.prototype.convertPointToPercent=function(n){var t=0,i=this.ownerTable.getOwnerWidth(!0);return t=n/this.ownerTable.getTableClientWidth(i)*100,(t=Math.round(t))<100?t:100},t.getCellLeftBorder=function(n){var t=void 0,e=n.cellFormat.borders,o=sf.base.isNullOrUndefined(n.ownerRow)?void 0:n.ownerRow.rowFormat.borders,s=sf.base.isNullOrUndefined(n.ownerTable)?void 0:n.ownerTable.tableFormat.borders,r,i,u,f;if(sf.base.isNullOrUndefined(e.left)||(t=e.left),sf.base.isNullOrUndefined(t)&&(t=n.getLeftBorderToRenderByHierarchy(t,o,s)),n.ownerTable.tableFormat.cellSpacing>0)t=n.getLeftBorderToRenderByHierarchy(t,o,s);else{if(r=void 0,sf.base.isNullOrUndefined(n.previousWidget)){if((n.cellFormat.columnSpan>1||n.columnIndex>1)&&n.ownerRow.rowIndex>0)for(i=n.ownerRow.previousWidget;!sf.base.isNullOrUndefined(i)&&i.childWidgets.length>0;){for(u=0;u<i.childWidgets.length;u++)if(f=i.childWidgets[u],f.columnIndex+f.cellFormat.columnSpan===n.columnIndex){r=i.childWidgets[u];break}if(!sf.base.isNullOrUndefined(r))break;i=i.previousWidget}}else r=n.previousWidget;t=n.getPreviousCellLeftBorder(t,r)}return sf.base.isNullOrUndefined(t)&&(t=new ft(n.cellFormat.borders)),t},t.prototype.getLeftBorderWidth=function(){var n=0;return null!==this.cellFormat&&null!==this.cellFormat.borders&&(n=t.getCellLeftBorder(this).getLineWidth()),n},t.prototype.getRightBorderWidth=function(){var n=0;return this.ownerTable,null!==this.cellFormat&&null!==this.cellFormat.borders&&(n=t.getCellRightBorder(this).getLineWidth()),n},t.prototype.getCellSpacing=function(){var n=this.ownerTable&&this.ownerTable.tableFormat?this.ownerTable.tableFormat.cellSpacing:0;return 1===this.ownerRow.childWidgets.length?2*n:0===this.cellIndex||this.cellIndex===this.ownerRow.childWidgets.length-1?n+n/2:n},t.prototype.getCellSizeInfo=function(n){var i=!0,r=void 0,u,t;return(sf.base.isNullOrUndefined(this.bodyWidget)||sf.base.isNullOrUndefined(this.bodyWidget.page)||sf.base.isNullOrUndefined(this.bodyWidget.page.documentHelper)||(r=this.bodyWidget.page.documentHelper.layout),sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.currentCell)||(i=!1,this===r.currentCell&&(i=!0)),i&&!this.sizeInfo.hasMinimumWidth&&(this.sizeInfo.minimumWidth=this.getMinimumPreferredWidth()),n&&i&&!this.sizeInfo.hasMinimumWordWidth)&&(u=this.getMinimumAndMaximumWordWidth(0,0),this.sizeInfo.minimumWordWidth=u.minimumWordWidth+this.sizeInfo.minimumWidth,this.sizeInfo.maximumWordWidth=u.maximumWordWidth+this.sizeInfo.minimumWidth),t=new yr,t.minimumWidth=this.sizeInfo.minimumWidth,t.minimumWordWidth=this.sizeInfo.minimumWordWidth,t.maximumWordWidth=this.sizeInfo.maximumWordWidth,t},t.prototype.getMinimumPreferredWidth=function(){return this.cellFormat.preferredWidth>0&&!this.ownerTable.tableFormat.allowAutoFit||this.cellFormat.preferredWidth>0&&"Auto"!==this.cellFormat.preferredWidthType?this.cellFormat.preferredWidth:0===this.cellFormat.preferredWidth&&"Auto"===this.cellFormat.preferredWidthType&&0!==this.cellFormat.cellWidth&&this.ownerTable&&"Auto"!==this.ownerTable.tableFormat.preferredWidthType?this.cellFormat.cellWidth:0===this.cellFormat.preferredWidth&&"Auto"===this.cellFormat.preferredWidthType&&0===this.cellFormat.cellWidth&&this.previousWidget&&this.previousWidget.cellFormat.preferredWidth>0?this.previousWidget.cellFormat.preferredWidth:this.leftMargin+this.rightMargin+this.getLeftBorderWidth()+this.getRightBorderWidth()+this.getCellSpacing()},t.prototype.getPreviousCellLeftBorder=function(n,t){if((sf.base.isNullOrUndefined(t)||!sf.base.isNullOrUndefined(n)&&"None"===n.lineStyle&&!n.hasNoneStyle)&&(sf.base.isNullOrUndefined(n)||_instanceof(n.ownerBase.ownerBase,pt)||(n=this.getLeftBorderToRenderByHierarchy(n,a.getRowOf(n.ownerBase).rowFormat.borders,f.getTableOf(n.ownerBase).tableFormat.borders))),sf.base.isNullOrUndefined(t))return n;var i=void 0;return sf.base.isNullOrUndefined(t.cellFormat.borders)||sf.base.isNullOrUndefined(t.cellFormat.borders.right)||"None"===t.cellFormat.borders.right.lineStyle||(i=t.cellFormat.borders.right),sf.base.isNullOrUndefined(i)||"None"===i.lineStyle?sf.base.isNullOrUndefined(n)||_instanceof(n.ownerBase.ownerBase,pt)?n:this.getLeftBorderToRenderByHierarchy(n,a.getRowOf(n.ownerBase).rowFormat.borders,f.getTableOf(n.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(i,n)},t.prototype.getBorderBasedOnPriority=function(n,t){var u,f,e,o;if(sf.base.isNullOrUndefined(n))return t;if(sf.base.isNullOrUndefined(t))return n;if(u=n.getBorderWeight(),f=t.getBorderWeight(),u===f){if(e=n.getPrecedence(),o=t.getPrecedence(),e===o){var s=this.convertHexToRGB(n.color),y=s.r,i=s.g,a=s.b,h=this.convertHexToRGB(t.color),p=h.r,r=h.g,v=h.b,c=y+a+2*i,l=p+v+2*r;return c===l&&(c=a+2*i)===(l=v+2*r)?i===r?n:i>r?t:n:c>l?t:n}return e>o?n:t}return u>f?n:t},t.prototype.getLeftBorderToRenderByHierarchy=function(n,i,r){return sf.base.isNullOrUndefined(n)||"None"===n.lineStyle&&(!n.hasNoneStyle||"None"===n.lineStyle&&0===n.lineWidth&&"#000000"===n.color)?!sf.base.isNullOrUndefined(n)&&_instanceof(n.ownerBase,ni)&&(0===t.getCellOf(n.ownerBase).columnIndex||0===t.getCellOf(n.ownerBase).cellIndex&&t.getCellOf(n.ownerBase).ownerRow.rowFormat.gridBefore>0)?0!==t.getCellOf(n.ownerBase).columnIndex&&t.getCellOf(n.ownerBase).ownerRow.rowFormat.gridBefore<1&&!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.vertical)&&"None"!==i.vertical.lineStyle?i.vertical:(sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.left)||(n=r.left),n):sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.vertical)||"None"===i.vertical.lineStyle?sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.vertical)||"None"===r.vertical.lineStyle?n:r.vertical:i.vertical:n},t.getCellRightBorder=function(n){var t=void 0,r=n.cellFormat.borders,u=sf.base.isNullOrUndefined(n.ownerRow)?void 0:n.ownerRow.rowFormat.borders,f=sf.base.isNullOrUndefined(n.ownerTable)?void 0:n.ownerTable.tableFormat.borders,i;return(sf.base.isNullOrUndefined(r.right)||(t=r.right),sf.base.isNullOrUndefined(t)&&(t=n.getRightBorderToRenderByHierarchy(t,u,f)),n.ownerTable.tableFormat.cellSpacing>0)?t=n.getRightBorderToRenderByHierarchy(t,u,f):(i=void 0,sf.base.isNullOrUndefined(n.nextWidget)||(i=n.nextWidget),t=n.getAdjacentCellRightBorder(t,i)),sf.base.isNullOrUndefined(t)&&(t=new ft(n.cellFormat.borders)),t},t.prototype.getAdjacentCellRightBorder=function(n,t){if((sf.base.isNullOrUndefined(t)||!sf.base.isNullOrUndefined(n)&&"None"===n.lineStyle&&!n.hasNoneStyle)&&(sf.base.isNullOrUndefined(n)||_instanceof(n.ownerBase.ownerBase,pt)||(n=this.getRightBorderToRenderByHierarchy(n,a.getRowOf(n.ownerBase).rowFormat.borders,f.getTableOf(n.ownerBase).tableFormat.borders))),sf.base.isNullOrUndefined(t))return n;var i=void 0;return sf.base.isNullOrUndefined(t.cellFormat.borders)||sf.base.isNullOrUndefined(t.cellFormat.borders.left)||"None"===t.cellFormat.borders.left.lineStyle||(i=t.cellFormat.borders.left),sf.base.isNullOrUndefined(i)||"None"===i.lineStyle?sf.base.isNullOrUndefined(n)||_instanceof(n.ownerBase.ownerBase,pt)?n:this.getRightBorderToRenderByHierarchy(n,a.getRowOf(n.ownerBase).rowFormat.borders,f.getTableOf(n.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(n,i)},t.prototype.getRightBorderToRenderByHierarchy=function(n,i,r){return sf.base.isNullOrUndefined(n)||"None"===n.lineStyle&&(!n.hasNoneStyle||"None"===n.lineStyle&&0===n.lineWidth&&"#000000"===n.color)?!sf.base.isNullOrUndefined(n)&&_instanceof(n.ownerBase,ni)&&t.getCellOf(n.ownerBase).cellIndex===t.getCellOf(n.ownerBase).ownerRow.childWidgets.length-1?(sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.right)||(n=r.right),n):sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.vertical)||"None"===i.vertical.lineStyle?sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.vertical)||"None"===r.vertical.lineStyle?n:r.vertical:i.vertical:n},t.getCellTopBorder=function(n){var i=void 0,e=n.cellFormat.borders,o=sf.base.isNullOrUndefined(n.ownerRow)?void 0:n.ownerRow.rowFormat.borders,s=sf.base.isNullOrUndefined(n.ownerTable)?void 0:n.ownerTable.tableFormat.borders,u,t,r,f;if(sf.base.isNullOrUndefined(e.top)||(i=e.top),sf.base.isNullOrUndefined(i)&&(i=n.getTopBorderToRenderByHierarchy(i,o,s)),n.ownerTable.tableFormat.cellSpacing>0)i=n.getTopBorderToRenderByHierarchy(i,o,s);else{for(u=void 0,t=n.ownerRow.previousWidget;!sf.base.isNullOrUndefined(t)&&t.childWidgets.length>0;){for(r=0;r<t.childWidgets.length;r++)if((f=t.childWidgets[r]).columnIndex+f.cellFormat.columnSpan-1>=n.columnIndex){u=t.childWidgets[r];break}if(!sf.base.isNullOrUndefined(u))break;if(t=t.previousWidget,sf.base.isNullOrUndefined(t)&&sf.base.isNullOrUndefined(u))if(t=n.ownerRow.previousWidget,n.columnIndex<t.childWidgets.length){for(r=0;r<t.childWidgets.length;r++)if((f=t.childWidgets[r]).columnIndex===n.columnIndex){u=t.childWidgets[r];break}}else u=n.ownerRow.previousWidget.childWidgets[n.ownerRow.previousWidget.childWidgets.length-1]}i=n.getPreviousCellTopBorder(i,u)}return sf.base.isNullOrUndefined(i)&&(i=new ft(n.cellFormat.borders)),i},t.prototype.getPreviousCellTopBorder=function(n,t){if((sf.base.isNullOrUndefined(t)||!sf.base.isNullOrUndefined(n)&&"None"===n.lineStyle&&!n.hasNoneStyle)&&(sf.base.isNullOrUndefined(n)||_instanceof(n.ownerBase.ownerBase,pt)||(n=this.getTopBorderToRenderByHierarchy(n,a.getRowOf(n.ownerBase).rowFormat.borders,f.getTableOf(n.ownerBase).tableFormat.borders))),sf.base.isNullOrUndefined(t))return n;var i=void 0;return sf.base.isNullOrUndefined(t.cellFormat.borders)||sf.base.isNullOrUndefined(t.cellFormat.borders.bottom)||"None"===t.cellFormat.borders.bottom.lineStyle||(i=t.cellFormat.borders.bottom),sf.base.isNullOrUndefined(i)||"None"===i.lineStyle?sf.base.isNullOrUndefined(n)||_instanceof(n.ownerBase.ownerBase,pt)?n:this.getTopBorderToRenderByHierarchy(n,a.getRowOf(n.ownerBase).rowFormat.borders,f.getTableOf(n.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(n,i)},t.prototype.getTopBorderToRenderByHierarchy=function(n,i,r){return sf.base.isNullOrUndefined(n)||"None"===n.lineStyle&&(!n.hasNoneStyle||"None"===n.lineStyle&&0===n.lineWidth&&"#000000"===n.color)?!sf.base.isNullOrUndefined(n)&&_instanceof(n.ownerBase,ni)&&0===t.getCellOf(n.ownerBase).ownerRow.rowIndex?(sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.top)||(n=r.top),n):sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.horizontal)||"None"===i.horizontal.lineStyle?sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.horizontal)||"None"===r.horizontal.lineStyle?n:r.horizontal:i.horizontal:n},t.getCellBottomBorder=function(n){var t=void 0,u=n.cellFormat.borders,f=sf.base.isNullOrUndefined(n.ownerRow)?void 0:n.ownerRow.rowFormat.borders,e=sf.base.isNullOrUndefined(n.ownerTable)?void 0:n.ownerTable.tableFormat.borders,r,i;return(sf.base.isNullOrUndefined(u.bottom)||(t=u.bottom),sf.base.isNullOrUndefined(t)&&(t=n.getBottomBorderToRenderByHierarchy(t,f,e)),n.ownerTable.tableFormat.cellSpacing>0)?t=n.getBottomBorderToRenderByHierarchy(t,f,e):(r=void 0,i=n.ownerRow.nextWidget,!sf.base.isNullOrUndefined(i)&&n.columnIndex<i.childWidgets.length&&(r=i.childWidgets[n.columnIndex]),t=n.getAdjacentCellBottomBorder(t,r)),sf.base.isNullOrUndefined(t)&&(t=new ft(n.cellFormat.borders)),t},t.prototype.getAdjacentCellBottomBorder=function(n,t){if((sf.base.isNullOrUndefined(t)||!sf.base.isNullOrUndefined(n)&&"None"===n.lineStyle&&!n.hasNoneStyle)&&(sf.base.isNullOrUndefined(n)||_instanceof(n.ownerBase.ownerBase,pt)||(n=this.getBottomBorderToRenderByHierarchy(n,a.getRowOf(n.ownerBase).rowFormat.borders,f.getTableOf(n.ownerBase).tableFormat.borders))),sf.base.isNullOrUndefined(t))return n;var i=void 0;return sf.base.isNullOrUndefined(t.cellFormat.borders)||sf.base.isNullOrUndefined(t.cellFormat.borders.top)||"None"===t.cellFormat.borders.top.lineStyle||(i=t.cellFormat.borders.top),sf.base.isNullOrUndefined(i)||"None"===i.lineStyle?sf.base.isNullOrUndefined(n)||_instanceof(n.ownerBase.ownerBase,pt)?n:this.getBottomBorderToRenderByHierarchy(n,a.getRowOf(n.ownerBase).rowFormat.borders,f.getTableOf(n.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(n,i)},t.prototype.getBottomBorderToRenderByHierarchy=function(n,i,r){return sf.base.isNullOrUndefined(n)||"None"===n.lineStyle&&(!n.hasNoneStyle||"None"===n.lineStyle&&0===n.lineWidth&&"#000000"===n.color)?!sf.base.isNullOrUndefined(n)&&_instanceof(n.ownerBase,ni)&&t.getCellOf(n.ownerBase).ownerRow.rowIndex+t.getCellOf(n.ownerBase).cellFormat.rowSpan===t.getCellOf(n.ownerBase).ownerTable.childWidgets.length?(sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.bottom)||(n=r.bottom),n):sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.horizontal)||"None"===i.horizontal.lineStyle?sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.horizontal)||"None"===r.horizontal.lineStyle?n:r.horizontal:i.horizontal:n},t.prototype.convertHexToRGB=function(n){if(n){n=n.replace(/[^0-9A-F]/gi,"");var t=parseInt(n,16);return{r:t>>16&255,g:t>>8&255,b:255&t}}},t.getCellOf=function(n){if(_instanceof(n,ni))return _instanceof(n.ownerBase,si)&&_instanceof(n.ownerBase.ownerBase,t)?n.ownerBase.ownerBase:void 0},t.prototype.updateWidgetLeft=function(n){this.x=n;this.updateChildWidgetLeft(n)},t.prototype.updateChildWidgetLeft=function(n){for(var t,r,i=0;i<this.childWidgets.length;i++)(this.childWidgets[i].x=n,_instanceof(this.childWidgets[i],f))&&(t=this.childWidgets[i],(t.updateChildWidgetLeft(n),t.isBidiTable)&&(r=new b(t.x,t.y,t.width,t.height),t.shiftWidgetsForRtlTable(r,t)))},t.prototype.getMinimumAndMaximumWordWidth=function(n,t){for(var r,i=0;i<this.childWidgets.length;i++)r=this.childWidgets[i].getMinimumAndMaximumWordWidth(n,t),n=r.minimumWordWidth,t=r.maximumWordWidth;return{minimumWordWidth:n,maximumWordWidth:t}},t.prototype.destroyInternal=function(n){var t,i;if(!sf.base.isNullOrUndefined(this.childWidgets)){for(t=0;t<this.childWidgets.length;t++)i=this.childWidgets[t],i.destroyInternal(n),t--;this.childWidgets=void 0}this.destroy()},t.prototype.clone=function(){var n=new t,i,r;for(n.cellFormat.copyFormat(this.cellFormat),i=0;i<this.childWidgets.length;i++)r=this.childWidgets[i].clone(),n.childWidgets.push(r),r.containerWidget=n,r.index=i;return n.leftBorderWidth=this.leftBorderWidth,n.rightBorderWidth=this.rightBorderWidth,this.margin&&(n.margin=this.margin.clone()),n.columnIndex=this.columnIndex,n.x=this.x,n.y=this.y,n.height=this.height,n.width=this.width,this.contentControlProperties&&(n.contentControlProperties=this.contentControlProperties),n},t.prototype.destroy=function(){this.cellFormat=void 0;this.rowIndex=void 0;this.columnIndex=void 0;n.prototype.destroy.call(this)},t}(wt),k=function(){function n(n){this.children=[];this.x=0;this.y=0;this.width=0;this.height=0;this.marginTop=0;this.paragraph=n}return Object.defineProperty(n.prototype,"indexInOwner",{get:function(){return this.paragraph&&this.paragraph.childWidgets?this.paragraph.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nextLine",{get:function(){var t=this.paragraph,r=this.indexInOwner,i;return r<=t.childWidgets.length-2?t.childWidgets[r+1]:t.nextSplitWidget&&(i=t.nextSplitWidget.firstChild,_instanceof(i,n)&&i.paragraph.equals(this.paragraph))?i:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"previousLine",{get:function(){var i=this.paragraph,r=this.indexInOwner,f=i.previousSplitWidget,t;return r>0?i.childWidgets[r-1]:_instanceof(f,u)&&(t=f.lastChild,_instanceof(t,n)&&t.paragraph.equals(this.paragraph))?t:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isEndsWithPageBreak",{get:function(){if(this.children.length>0){var n=this.children[this.children.length-1];if(_instanceof(n,i))return n.isPageBreak}return!1},enumerable:!0,configurable:!0}),n.prototype.isFirstLine=function(){var n=this.indexInOwner;return!!(n>-1&&(void 0===this.paragraph.previousSplitWidget||_instanceof(this.paragraph.previousSplitWidget,u)&&this.paragraph.previousSplitWidget.isEndsWithPageBreak))&&0===n},n.prototype.isLastLine=function(){var n=this.indexInOwner;return n>-1&&void 0===this.paragraph.nextSplitWidget&&n===this.paragraph.childWidgets.length-1},n.prototype.getOffset=function(n,t){var r,u;if(sf.base.isNullOrUndefined(n))return t;var i=t,f=n.line,e=(n.line.paragraph.childWidgets.indexOf(n.line),f.paragraph.bidi),s=this.paragraph.bodyWidget.page.documentHelper.layout.isContainsRtl(this);if(e||s)i=e?this.getInlineForOffset(i,!0,n).index:this.getInlineForRtlLine(i,!0,n).index;else for(r=0;r<f.children.length;r++){if(u=f.children[r],n===u)break;_instanceof(u,o)||(i+=u.length)}return i},n.prototype.getEndOffset=function(){var u=0,s=0,f,n;if(this.paragraph.bidi||this.paragraph.bodyWidget.page.documentHelper.layout.isContainsRtl(this))u=this.getInlineForOffset(u,!1,this.children[0],!0).index;else for(f=0;f<this.children.length;f++)n=this.children[f],0!==n.length&&(_instanceof(n,o)||((_instanceof(n,i)||_instanceof(n,ht)||_instanceof(n,v)||_instanceof(n,ot)||_instanceof(n,e)||_instanceof(n,w)||_instanceof(n,r)&&t.isLinkedFieldCharacter(n))&&(u=s+n.length),s+=n.length));return u},n.prototype.getInlineForOffset=function(n,u,f,s,h,c){for(var y,k=this.children[this.children.length-1],l=k,d=this.paragraph.bodyWidget.page.documentHelper,p=d.textHelper,b=!1,a=0,w=d.selection.getLineLength(this),nt=0;l;){if(!(y||_instanceof(l,oi)&&"\t"===l.text||(!_instanceof(l,i)||p.isRTLText(l.text)||(p.containsSpecialCharAlone(l.text)||/^[0-9]+$/.test(l.text))&&l.characterFormat.bidi)&&_instanceof(l,i))){for(;l.previousElement&&(_instanceof(l.previousElement,i)&&!p.isRTLText(l.previousElement.text)&&(!p.containsSpecialCharAlone(l.previousElement.text)&&!/^[0-9]+$/.test(l.previousElement.text)||!l.previousElement.characterFormat.bidi)||_instanceof(l.previousElement,r)||_instanceof(l.previousElement,e)||_instanceof(l.previousElement,g)&&!sf.base.isNullOrUndefined(l.previousElement.previousElement)&&!_instanceof(l.previousElement.previousElement,e)||_instanceof(l.previousElement,e)||_instanceof(l.previousElement,g)&&_instanceof(l.previousElement.previousElement,e)&&!sf.base.isNullOrUndefined(l.previousElement.previousElement.previousElement)||_instanceof(l,e)&&_instanceof(l.previousElement,e)&&!sf.base.isNullOrUndefined(l.previousElement.previousElement)||_instanceof(l.previousElement,o)||_instanceof(l.previousElement,ot)||_instanceof(l.previousElement,ht)||_instanceof(l.previousElement,g)||_instanceof(l.previousElement,v));)b=!0,l=l.previousElement;if(l.previousElement&&(b||_instanceof(l.previousElement,i)&&(p.isRTLText(l.previousElement.text)||(p.containsSpecialCharAlone(l.previousElement.text)||/^[0-9]+$/.test(l.previousElement.text))&&l.previousElement.characterFormat.bidi)))y=l.previousElement;else if(!l.previousElement){if(_instanceof(l,o)||_instanceof(l,g))break;y=l}_instanceof(l,o)&&y&&(l=y,y=void 0)}if(u&&!sf.base.isNullOrUndefined(f)){if(f===l)return{element:l,index:n};n+=l.length}else if(s){if((n+=l.length)===w)return{element:l,index:n};if(n>w)return{element:l,index:w}}else if(c){if(n<a+l.length&&(_instanceof(l,i)||_instanceof(l,v)||_instanceof(l,r)&&t.isLinkedFieldCharacter(l)))return{element:l,index:(n>a?n:a)+1};a+=l.length}else{if(n<=a+l.length)return{element:l,index:h?n-1===a?nt:n-1:n-a};h&&(_instanceof(l,i)||_instanceof(l,v)||_instanceof(l,r)&&t.isLinkedFieldCharacter(l))&&(nt=a+l.length);a+=l.length}if(l.previousElement&&(_instanceof(l,i)&&(p.isRTLText(l.text)||(p.containsSpecialCharAlone(l.text)||/^[0-9]+$/.test(l.text))&&l.characterFormat.bidi)||_instanceof(l,oi)&&"\t"===l.text||_instanceof(l,e)&&(_instanceof(l,e)&&_instanceof(l.previousElement,e)&&!l.previousElement.previousElement||1===l.bookmarkType&&!l.previousElement))){if((n===a+1||n>a+1)&&a===w&&!l.previousElement)break;l=l.previousElement}else if(y&&(!l.nextElement||l===k||_instanceof(l.nextElement,i)&&(p.isRTLText(l.nextElement.text)||(p.containsSpecialCharAlone(l.nextElement.text)||/^[0-9]+$/.test(l.nextElement.text))&&l.nextElement.characterFormat.bidi)||_instanceof(l.nextElement,o))){if(n===a+1&&a===w)break;l=y;y=void 0;b=!1}else{if((y===l||n===a+1)&&!l.previousElement&&a===w)break;l=l.nextElement}}return c?{element:l,index:n}:h?{element:l,index:-1}:{element:l,index:s?n:0}},n.prototype.getInlineForRtlLine=function(n,u,f){for(var h,s=this.children[0],w=this.paragraph.bodyWidget.page.documentHelper,b=w.textHelper,y=!1,l=0,c=(w.selection.getLineLength(this),-1),a=-1,p=!1;s;)if(_instanceof(s,o))s=s.nextElement;else{if(!p&&(_instanceof(s,i)||_instanceof(s,v)||_instanceof(s,e)||_instanceof(s,ot)||_instanceof(s,ht)||_instanceof(s,r)&&t.isLinkedFieldCharacter(s))&&(p=!0),!h)for(;s&&_instanceof(s,i)&&(b.isRTLText(s.text)||b.containsSpecialCharAlone(s.text));)h||(h=s),c=this.children.indexOf(s),s=s.nextElement,y=!0;if(-1!==c&&y&&(s=this.children[c]),u&&!sf.base.isNullOrUndefined(f)){if(f===s)return{element:s,index:n};n+=s.length}else{if(p&&n<=l+s.length)return{element:s,index:a=n-l};l+=s.length}if(h===s&&(h=void 0,-1!==c&&(s=this.children[c]),c=-1),h&&s.previousElement)s=s.previousElement;else{if(!s.nextElement)return n>l&&(a=sf.base.isNullOrUndefined(s)?n:s.length),{element:s,index:a};s=s.nextElement}y=!1}return{element:s,index:a}},n.prototype.getInline=function(n,u,f,s){var b,k,a,c,y;f=sf.base.isNullOrUndefined(f)?this.paragraph.bidi:f;var h=void 0,l=0,p=!1;if(0===this.children.length&&this.previousLine&&(b=this.previousLine.children[this.previousLine.children.length-1],_instanceof(b,i)&&"\v"===b.text))return{element:h=this.previousLine.children[this.previousLine.children.length-1],index:u=1};if(k=this.paragraph.bodyWidget.page.documentHelper.layout.isContainsRtl(this),f||k)f?(h=(a=this.getInlineForOffset(n)).element,u=a.index):(h=(a=this.getInlineForRtlLine(n)).element,u=a.index);else{for(c=0;c<this.children.length;c++)if(!_instanceof(h=this.children[c],o)){if(!p&&(_instanceof(h,i)||_instanceof(h,v)||_instanceof(h,nt)||_instanceof(h,w)||_instanceof(h,e)||_instanceof(h,ot)||_instanceof(h,ht)||_instanceof(h,g)||_instanceof(h,r)&&t.isLinkedFieldCharacter(h))&&(p=!0),p&&n<=l+h.length)return _instanceof(h,i)&&" "===h.text&&0===h.revisions.length&&s?(y=this.getNextTextElement(this,c+1),{element:h=sf.base.isNullOrUndefined(y)?h:y,index:u=sf.base.isNullOrUndefined(y)?n-l:0}):n===l+h.length&&_instanceof(this.children[c+1],yt)?{element:this.children[c+1],index:u}:{element:h,index:u=n-l};l+=h.length}n>l&&(u=sf.base.isNullOrUndefined(h)?n:h.length)}return{element:h,index:u}},n.prototype.getNextTextElement=function(n,t){return t<n.children.length-1&&n.children[t]?n.children[t]:null},n.prototype.getHierarchicalIndex=function(n){return n=this.paragraph.childWidgets.indexOf(this)+";"+n,_instanceof(this.paragraph,wt)?this.paragraph.getHierarchicalIndex(n):n},n.prototype.clone=function(){for(var r,t=new n(void 0),i=0;i<this.children.length;i++)r=this.children[i].clone(),t.children.push(r),r.line=t;return t.width=this.width,t.height=this.height,t},n.prototype.destroy=function(){if(!sf.base.isNullOrUndefined(this.children)){for(var n=0;n<this.children.length;n++)this.children[n].destroy();this.children=[]}this.children=void 0;this.paragraph&&this.paragraph.removeChild(this.indexInOwner);this.paragraph=void 0;this.x=void 0;this.y=void 0;this.width=void 0;this.height=void 0},n}(),tt=function(){function n(){this.x=0;this.y=0;this.width=0;this.height=0;this.margin=new hi(0,0,0,0);this.padding=new hi(0,0,0,0);this.characterFormat=void 0;this.isRightToLeft=!1;this.canTrigger=!1;this.ischangeDetected=!1;this.isVisible=!1;this.isSpellChecked=!1;this.revisions=[];this.canTrack=!1;this.removedIds=[];this.isMarkedForRevision=!1;this.characterFormat=new p(this);this.margin=new hi(0,0,0,0)}return Object.defineProperty(n.prototype,"isPageBreak",{get:function(){return _instanceof(this,i)&&"\f"===this.text},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isValidNodeForTracking",{get:function(){return!(_instanceof(this,e)||_instanceof(this,g)||_instanceof(this,ht)||_instanceof(this,ot)||_instanceof(this,w))},enumerable:!0,configurable:!0}),n.prototype.linkFieldCharacter=function(n){if(_instanceof(this,r))if(0===this.fieldType)sf.base.isNullOrUndefined(this.fieldEnd)&&(this.linkFieldTraversingForward(this.line,this,this),-1===n.fields.indexOf(this)&&n.fields.push(this),sf.base.isNullOrUndefined(this.formFieldData)||-1!==n.formFields.indexOf(this)||n.formFields.push(this));else if(2===this.fieldType){if(sf.base.isNullOrUndefined(this.fieldBegin)&&this.linkFieldTraversingBackwardSeparator(this.line,this,this),!sf.base.isNullOrUndefined(this.fieldBegin)){this.fieldBegin.fieldSeparator=this;var t=this.linkFieldTraversingForward(this.line,this.fieldBegin,this);sf.base.isNullOrUndefined(this.fieldEnd)&&t&&(this.fieldEnd=this.fieldBegin.fieldEnd);this.fieldEnd&&(this.fieldEnd.fieldSeparator=this)}}else sf.base.isNullOrUndefined(this.fieldBegin)&&this.linkFieldTraversingBackward(this.line,this,this)},n.prototype.linkFieldTraversingBackward=function(n,t,i){var s=n.children.length-1,e,f,o;for(n.children.indexOf(i)>-1&&(s=n.children.indexOf(i)-1),e=s;e>=0;e--)if(f=n.children[e],_instanceof(f,r))if(0===f.fieldType){if(sf.base.isNullOrUndefined(f.fieldEnd))return t.fieldBegin=f,sf.base.isNullOrUndefined(f.fieldEnd)&&(f.fieldEnd=t),t.fieldSeparator&&sf.base.isNullOrUndefined(t.fieldSeparator.fieldBegin)&&(t.fieldSeparator.fieldBegin=f,sf.base.isNullOrUndefined(f.fieldSeparator)&&(f.fieldSeparator=t.fieldSeparator)),!sf.base.isNullOrUndefined(t.fieldBegin)}else 2===f.fieldType&&sf.base.isNullOrUndefined(f.fieldEnd)&&(t.fieldSeparator=f,f.fieldEnd=t,sf.base.isNullOrUndefined(f.fieldBegin)||(t.fieldBegin=f.fieldBegin));return n.previousLine?this.linkFieldTraversingBackward(n.previousLine,t,this):_instanceof(n.paragraph.previousRenderedWidget,u)&&n.paragraph.previousRenderedWidget.childWidgets.length>0&&(o=n.paragraph.previousRenderedWidget,this.linkFieldTraversingBackward(o.childWidgets[o.childWidgets.length-1],t,this)),!0},n.prototype.linkFieldTraversingForward=function(n,t,i){var o=0,e,f;for(n.children.indexOf(i)>-1&&(o=n.children.indexOf(i)+1),e=o;e<n.children.length;e++)if(f=n.children[e],_instanceof(f,r)){if(1===f.fieldType)return sf.base.isNullOrUndefined(f.fieldBegin)&&(t.fieldEnd=f),t.fieldEnd&&sf.base.isNullOrUndefined(t.fieldEnd.fieldBegin)&&(t.fieldEnd.fieldBegin=t),!0;if(sf.base.isNullOrUndefined(t.fieldSeparator)){if(2!==f.fieldType||!sf.base.isNullOrUndefined(f.fieldBegin))return!1;if(t.fieldSeparator=f,t.fieldSeparator&&sf.base.isNullOrUndefined(t.fieldSeparator.fieldBegin)&&(t.fieldSeparator.fieldBegin=t),!sf.base.isNullOrUndefined(f.fieldEnd))return t.fieldEnd=f.fieldEnd,t.fieldSeparator.fieldEnd=t.fieldEnd,!0}}return n.nextLine?this.linkFieldTraversingForward(n.nextLine,t,this):_instanceof(n.paragraph.nextRenderedWidget,u)&&n.paragraph.nextRenderedWidget.childWidgets.length>0&&this.linkFieldTraversingForward(n.paragraph.nextRenderedWidget.childWidgets[0],t,this),!0},n.prototype.linkFieldTraversingBackwardSeparator=function(n,t,i){var o=n.children.length-1,e,f;for(n.children.indexOf(i)>-1&&(o=n.children.indexOf(i)-1),e=o;e>=0;e--)if(f=n.children[e],_instanceof(f,r)&&_instanceof(f,r)&&0===f.fieldType)return sf.base.isNullOrUndefined(f.fieldSeparator)&&(t.fieldBegin=f),!sf.base.isNullOrUndefined(t.fieldBegin);if(n.previousLine)this.linkFieldTraversingBackwardSeparator(n.previousLine,t,this);else{if(!(_instanceof(n.paragraph.previousRenderedWidget,u)&&n.paragraph.previousRenderedWidget.childWidgets.length>0))return!0;n=n.paragraph.previousRenderedWidget.childWidgets[n.paragraph.previousRenderedWidget.childWidgets.length-1];this.linkFieldTraversingBackwardSeparator(n,t,this)}return!0},Object.defineProperty(n.prototype,"length",{get:function(){return this.getLength()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"indexInOwner",{get:function(){return _instanceof(this.line,k)&&this.line.children?this.line.children.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"previousElement",{get:function(){var n=this.indexInOwner;if(n>0&&n<this.line.children.length)return this.line.children[n-1]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nextElement",{get:function(){var n=this.indexInOwner;if(n>-1&&n<this.line.children.length-1)return this.line.children[n+1]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nextNode",{get:function(){var n=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);return n<this.line.children.length-1?this.line.children[n+1]:t<this.line.paragraph.childWidgets.length-1?this.line.paragraph.childWidgets[t+1].children[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nextValidNodeForTracking",{get:function(){for(var n=this;!sf.base.isNullOrUndefined(n)&&(_instanceof(n,e)||_instanceof(n,g)||_instanceof(n,ht)||_instanceof(n,ot)||_instanceof(n,w));)n=n.nextNode;return n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"previousValidNodeForTracking",{get:function(){for(var n=this;!sf.base.isNullOrUndefined(n)&&(_instanceof(n,e)||_instanceof(n,g)||_instanceof(n,ht)||_instanceof(n,ot)||_instanceof(n,w));)n=n.previousNode;return n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"previousNode",{get:function(){var t=this.line.children.indexOf(this),i=this.line.paragraph.childWidgets.indexOf(this.line),n;return t>0?this.line.children[t-1]:i>0?(n=this.line.paragraph.childWidgets[i-1],n.children[n.children.length-1]):void 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paragraph",{get:function(){if(this.line)return this.line.paragraph},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){if(!sf.base.isNullOrUndefined(this.line)&&this.line.children&&this.line.children.indexOf(this)>-1){var n=this.line.children.indexOf(this);this.line.children.splice(n,1)}this.line=void 0;this.characterFormat&&this.characterFormat.destroy();this.characterFormat=void 0;this.margin&&this.margin.destroy();this.margin=void 0;this.x=void 0;this.y=void 0;this.width=void 0;this.height=void 0},n.objectCharacter=String.fromCharCode(65532),n}(),r=function(n){function t(t){var i=n.call(this)||this;return i.fieldType=0,i.fieldCodeType="",i.hasFieldEnd=!1,i.fieldBeginInternal=void 0,i.fieldSeparatorInternal=void 0,i.fieldEndInternal=void 0,i.fieldType=t,i}return st(t,n),Object.defineProperty(t.prototype,"fieldBegin",{get:function(){return this.fieldBeginInternal},set:function(n){this.fieldBeginInternal=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldSeparator",{get:function(){return this.fieldSeparatorInternal},set:function(n){this.fieldSeparatorInternal=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldEnd",{get:function(){return this.fieldEndInternal},set:function(n){this.fieldEndInternal=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resultText",{get:function(){if(!sf.base.isNullOrUndefined(this.formFieldData)&&0===this.fieldType&&!sf.base.isNullOrUndefined(this.fieldSeparator)&&!sf.base.isNullOrUndefined(this.fieldEnd)){var n=this.fieldSeparator.nextElement,t="";do if(_instanceof(n,i)&&(t+=n.text),(n=n.nextNode)===this.fieldEnd)break;while(n);return t}},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var n=new t(this.fieldType);return 0!==this.fieldType||sf.base.isNullOrUndefined(this.formFieldData)||(n.formFieldData=this.formFieldData.clone()),n.characterFormat.copyFormat(this.characterFormat),this.margin&&(n.margin=this.margin.clone()),n.width=this.width,n.height=this.height,n.removedIds=this.revisions.length>0?ii.cloneRevisions(this.revisions):this.removedIds.slice(),n.fieldCodeType=this.fieldCodeType,n},t.prototype.destroy=function(){this.fieldType=void 0;this.hasFieldEnd=void 0;this.fieldBeginInternal=void 0;this.fieldEndInternal=void 0;this.fieldSeparatorInternal=void 0;n.prototype.destroy.call(this)},t}(tt),lr=function(){this.name="";this.enabled=!0;this.helpText="";this.statusText=""},vt=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.type="Text",t.maxLength=0,t.defaultValue="",t.format="",t}return st(t,n),t.prototype.clone=function(){var n=new t;return n.type=this.type,n.name=this.name,n.enabled=this.enabled,n.helpText=this.helpText,n.statusText=this.statusText,n.maxLength=this.maxLength,n.defaultValue=this.defaultValue,n.format=this.format,n},t.prototype.getFormFieldInfo=function(){return{defaultValue:this.defaultValue,enabled:this.enabled,format:this.format,helpText:this.helpText,maxLength:this.maxLength,type:this.type}},t.prototype.copyFieldInfo=function(n){sf.base.isNullOrUndefined(n.defaultValue)||(this.defaultValue=n.defaultValue);sf.base.isNullOrUndefined(n.enabled)||(this.enabled=n.enabled);sf.base.isNullOrUndefined(n.format)||(this.format=n.format);sf.base.isNullOrUndefined(n.helpText)||(this.helpText=n.helpText);sf.base.isNullOrUndefined(n.maxLength)||(this.maxLength=n.maxLength);sf.base.isNullOrUndefined(n.type)||(this.type=n.type)},t}(lr),bt=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.sizeType="Auto",t.size=11,t.defaultValue=!1,t.checked=!1,t}return st(t,n),t.prototype.clone=function(){var n=new t;return n.name=this.name,n.enabled=this.enabled,n.helpText=this.helpText,n.statusText=this.statusText,n.sizeType=this.sizeType,n.size=this.size,n.defaultValue=this.defaultValue,n.checked=this.checked,n},t.prototype.getFormFieldInfo=function(){return{defaultValue:this.defaultValue,enabled:this.enabled,helpText:this.helpText,size:this.size,sizeType:this.sizeType}},t.prototype.copyFieldInfo=function(n){sf.base.isNullOrUndefined(n.defaultValue)||(this.defaultValue=n.defaultValue,this.checked=n.defaultValue);sf.base.isNullOrUndefined(n.enabled)||(this.enabled=n.enabled);sf.base.isNullOrUndefined(n.size)||(this.size=n.size);sf.base.isNullOrUndefined(n.helpText)||(this.helpText=n.helpText);sf.base.isNullOrUndefined(n.sizeType)||(this.sizeType=n.sizeType)},t}(lr),kt=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.dropdownItems=[],t.selectedIndex=0,t}return st(t,n),t.prototype.clone=function(){var n=new t;return n.name=this.name,n.enabled=this.enabled,n.helpText=this.helpText,n.statusText=this.statusText,n.dropdownItems=this.dropdownItems.slice(),n.selectedIndex=this.selectedIndex,n},t.prototype.getFormFieldInfo=function(){return{dropdownItems:this.dropdownItems.slice(),enabled:this.enabled,helpText:this.helpText}},t.prototype.copyFieldInfo=function(n){sf.base.isNullOrUndefined(n.dropdownItems)||(this.dropdownItems=n.dropdownItems);sf.base.isNullOrUndefined(n.enabled)||(this.enabled=n.enabled);sf.base.isNullOrUndefined(n.helpText)||(this.helpText=n.helpText)},t}(lr),i=function(n){function t(){var t=n.call(this)||this;return t.baselineOffset=0,t.text="",t.trimEndWidth=0,t.ignoreOnceItems=[],t.istextCombined=!1,t.errorCollection=[],t}return st(t,n),t.prototype.getLength=function(){return this.text?this.text.length:0},t.prototype.clone=function(){var n=new t;return n.characterFormat.copyFormat(this.characterFormat),n.text=this.text,this.margin&&(n.margin=this.margin.clone()),n.baselineOffset=this.baselineOffset,n.removedIds=this.revisions.length>0?ii.cloneRevisions(this.revisions):this.removedIds.slice(),n.width=this.width,n.height=this.height,this.contentControlProperties&&(n.contentControlProperties=this.contentControlProperties),n},t.prototype.destroy=function(){this.text=void 0;n.prototype.destroy.call(this)},t}(tt),tr=function(){function n(){this.separator=[];this.continuationNotice=[];this.continuationSeparator=[]}return n.prototype.clear=function(){this.separator=[];this.continuationSeparator=[];this.continuationNotice=[]},n.prototype.destroy=function(){this.separator=[];this.continuationSeparator=[];this.continuationNotice=[]},n}(),yt=function(n){function t(){var t=n.call(this)||this;return t.isLayout=!1,t.blocks=[],t}return st(t,n),t.prototype.clone=function(){var n=new t;return n.text=this.text,n.characterFormat.copyFormat(this.characterFormat),n.height=this.height,n.footnoteType=this.footnoteType,n.width=this.width,n.symbolCode=this.symbolCode,n.blocks=this.blocks,this.margin&&(n.margin=this.margin.clone()),n},t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.symbolCode="";this.symbolFontName="";this.customMarker=""},t}(i),vi=function(n){function t(){var t=n.call(this)||this;return t.startIn=void 0,t.endIn=void 0,t}return st(t,n),Object.defineProperty(t.prototype,"start",{get:function(){return this.startIn},set:function(n){this.startIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.endIn},set:function(n){this.endIn=n},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.start=void 0;this.end=void 0},t}(i),ci=function(n){function t(){var t=n.call(this)||this;return t.fieldText="",t}return st(t,n),Object.defineProperty(t.prototype,"text",{get:function(){return this.fieldText},set:function(n){this.fieldText=n},enumerable:!0,configurable:!0}),t.prototype.clone=function(){var n=new t;return n.characterFormat.copyFormat(this.characterFormat),n.fieldBegin=this.fieldBegin,n.text=this.text,this.margin&&(n.margin=this.margin.clone()),n.removedIds=this.revisions.length>0?ii.cloneRevisions(this.revisions):this.removedIds.slice(),n.width=this.width,n.height=this.height,n},t}(i),oi=function(n){function t(){var t=n.call(this)||this;return t.tabText="",t.tabLeader="None",t}return st(t,n),t.prototype.destroy=function(){this.tabText=void 0;this.tabLeader=void 0},t.prototype.clone=function(){var n=new t;return n.characterFormat.copyFormat(this.characterFormat),n.tabText=this.tabText,n.tabLeader=this.tabLeader,n.text=this.text,this.margin&&(n.margin=this.margin.clone()),n.width=this.width,n.height=this.height,n.removedIds=this.revisions.length>0?ii.cloneRevisions(this.revisions):this.removedIds.slice(),n},t}(i),e=function(n){function t(t){var i=n.call(this)||this;return i.bookmarkTypeIn=0,i.refereneceIn=void 0,i.nameIn="",i.bookmarkTypeIn=t,i}return st(t,n),Object.defineProperty(t.prototype,"bookmarkType",{get:function(){return this.bookmarkTypeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.nameIn},set:function(n){this.nameIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reference",{get:function(){return this.refereneceIn},set:function(n){this.refereneceIn=n},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.name=void 0;this.reference=void 0;this.bookmarkTypeIn=void 0},t.prototype.clone=function(){var n=new t(this.bookmarkType);return n.name=this.name,n.reference=this.reference,this.margin&&(n.margin=this.margin.clone()),n.width=this.width,n.height=this.height,this.contentControlProperties&&(n.contentControlProperties=this.contentControlProperties),n},t}(tt),w=function(n){function t(t){var i=n.call(this)||this;return i.contentControlWidgetType=t,i.contentControlProperties=new ar(t),i}return st(t,n),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var n=new t(this.contentControlWidgetType);return n.characterFormat.copyFormat(this.characterFormat),n.contentControlProperties=this.contentControlProperties,n.contentControlWidgetType=this.contentControlWidgetType,this.margin&&(n.margin=this.margin.clone()),n.removedIds=this.revisions.length>0?ii.cloneRevisions(this.revisions):this.removedIds.slice(),n.type=this.type,n.width=this.width,n.height=this.height,n.reference=this.reference,n},t.prototype.destroy=function(){this.contentControlProperties=void 0;this.contentControlWidgetType=void 0;n.prototype.destroy.call(this)},t}(tt),ar=function(){function n(n){this.contentControlListItems=[];this.contentControlWidgetType=n;this.characterFormat=new p}return n.prototype.destroy=function(){this.lockContentControl=void 0;this.lockContents=void 0;this.tag=void 0;this.color=void 0;this.title=void 0;this.appearance=void 0;this.type=void 0;this.hasPlaceHolderText=void 0;this.multiline=void 0;this.isTemporary=void 0;this.isChecked=void 0;this.dateCalendarType=void 0;this.dateStorageFormat=void 0;this.dateDisplayLocale=void 0;this.dateDisplayFormat=void 0},n.prototype.clone=function(){var t=new n(this.contentControlWidgetType),i;if(t.lockContentControl=this.lockContentControl,t.lockContents=this.lockContents,t.tag=this.tag,t.color=this.color,t.title=this.title,t.appearance=this.appearance,t.type=this.type,t.hasPlaceHolderText=this.hasPlaceHolderText,t.multiline=this.multiline,t.isTemporary=this.isTemporary,t.isChecked=this.isChecked,t.dateCalendarType=this.dateCalendarType,t.dateStorageFormat=this.dateStorageFormat,t.dateDisplayLocale=this.dateDisplayLocale,t.dateDisplayFormat=this.dateDisplayFormat,this.contentControlListItems.length>0)for(i=0;i<this.contentControlListItems.length;i++)t.contentControlListItems.push(this.contentControlListItems[i].clone());return this.checkedState&&(t.checkedState=this.checkedState.clone()),this.uncheckedState&&(t.uncheckedState=this.uncheckedState.clone()),this.xmlMapping&&(t.xmlMapping=this.xmlMapping.clone()),t},n}(),yf=function(){function n(){}return n.prototype.destroy=function(){this.displayText=void 0;this.value=void 0},n.prototype.clone=function(){var t=new n;return t.displayText=this.displayText,t.value=this.value,t},n}(),nu=function(){function n(){}return n.prototype.destroy=function(){this.font=void 0;this.value=void 0},n.prototype.clone=function(){var t=new n;return t.font=this.font,t.value=this.value,t},n}(),pf=function(){function n(){}return n.prototype.destroy=function(){this.isMapped=void 0;this.isWordMl=void 0;this.prefixMapping=void 0;this.xPath=void 0;this.storeItemId=void 0;this.customXmlPart=void 0},n.prototype.clone=function(){var t=new n;return t.isMapped=this.isMapped,t.isWordMl=this.isWordMl,t.prefixMapping=this.prefixMapping,t.xPath=this.xPath,t.storeItemId=this.storeItemId,this.customXmlPart&&(t.customXmlPart=this.customXmlPart.clone()),t},n}(),wf=function(){function n(){}return n.prototype.destroy=function(){this.id=void 0;this.xml=void 0},n.prototype.clone=function(){var t=new n;return t.id=this.id,t.xml=this.xml,t},n}(),lt=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.verticalPosition=0,t.horizontalPosition=0,t.textWrappingStyle="Inline",t.distanceBottom=0,t.distanceLeft=0,t.distanceRight=0,t.distanceTop=0,t}return st(t,n),t}(function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.name="",t.alternativeText="",t.title="",t}return st(t,n),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){return new nt},t}(tt)),nt=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return st(t,n),t.prototype.clone=function(){var n=new t;return n.characterFormat.copyFormat(this.characterFormat),n.x=this.x,n.y=this.y,n.width=this.width,n.height=this.height,n.shapeId=this.shapeId,n.name=this.name,n.alternativeText=this.alternativeText,n.title=this.title,n.widthScale=this.widthScale,n.heightScale=this.heightScale,n.visible=this.visible,n.verticalPosition=this.verticalPosition,n.verticalAlignment=this.verticalAlignment,n.verticalOrigin=this.verticalOrigin,n.verticalRelativePercent=this.verticalRelativePercent,n.horizontalPosition=this.horizontalPosition,n.horizontalAlignment=this.horizontalAlignment,n.horizontalRelativePercent=this.horizontalRelativePercent,n.horizontalOrigin=this.horizontalOrigin,n.zOrderPosition=this.zOrderPosition,n.allowOverlap=this.allowOverlap,n.textWrappingStyle=this.textWrappingStyle,n.textWrappingType=this.textWrappingType,n.distanceBottom=this.distanceBottom,n.distanceLeft=this.distanceLeft,n.distanceRight=this.distanceRight,n.distanceTop=this.distanceTop,n.layoutInCell=this.layoutInCell,n.lockAnchor=this.lockAnchor,n.autoShapeType=this.autoShapeType,this.lineFormat&&(n.lineFormat=this.lineFormat.clone()),this.fillFormat&&(n.fillFormat=this.fillFormat.clone()),this.textFrame&&(n.textFrame=this.textFrame.clone(),n.textFrame.containerShape=n),this.margin&&(n.margin=this.margin.clone()),n},t}(lt),et=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.marginLeft=0,t.marginRight=0,t.marginTop=0,t.marginBottom=0,t}return st(t,n),t.prototype.equals=function(){return!1},t.prototype.destroyInternal=function(){},t.prototype.getHierarchicalIndex=function(){var n=this.containerShape.line,t=n.getOffset(this.containerShape,0).toString();return n.getHierarchicalIndex(t)},t.prototype.getTableCellWidget=function(){},t.prototype.clone=function(){var n=new t,i,r;for(n.textVerticalAlignment=this.textVerticalAlignment,n.marginBottom=this.marginBottom,n.marginLeft=this.marginLeft,n.marginRight=this.marginRight,n.marginTop=this.marginTop,i=0;i<this.childWidgets.length;i++)r=this.childWidgets[i].clone(),n.childWidgets.push(r),r.index=i,r.containerWidget=n;return n},t}(gt),bf=function(){function n(){}return n.prototype.clone=function(){var t=new n;return t.lineFormatType=this.lineFormatType,t.color=this.color,t.weight=this.weight,t.dashStyle=this.dashStyle,t.line=this.line,t},n}(),kf=function(){function n(){}return n.prototype.clone=function(){var t=new n;return t.color=this.color,t.fill=this.fill,t},n}(),v=function(n){function t(t){var i=n.call(this)||this;return i.imageStr="",i.imgElement=void 0,i.isInlineImageIn=!0,i.isCrop=!1,i.left=0,i.top=0,i.right=0,i.bottom=0,i.isMetaFile=!1,i.isCompressed=!1,i.isInlineImageIn=t,i}return st(t,n),Object.defineProperty(t.prototype,"isInlineImage",{get:function(){return this.isInlineImageIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return sf.base.isNullOrUndefined(this.imgElement)&&(this.imgElement=document.createElement("img")),this.imgElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageString",{get:function(){return this.imageStr},set:function(n){this.imageStr=n;sf.base.isNullOrUndefined(n)||(this.element.src=this.imageStr)},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var n=new t(this.isInlineImage);return n.characterFormat.copyFormat(this.characterFormat),n.imageString=this.imageString,n.isMetaFile=this.isMetaFile,n.isCompressed=this.isCompressed,n.metaFileImageString=this.metaFileImageString,n.width=this.width,n.height=this.height,this.isCrop&&(n.top=this.top,n.left=this.left,n.bottom=this.bottom,n.right=this.right,n.isCrop=this.isCrop,n.cropHeightScale=this.cropHeightScale,n.cropWidthScale=this.cropWidthScale),this.margin&&(n.margin=this.margin.clone()),n.removedIds=this.revisions.length>0?ii.cloneRevisions(this.revisions):this.removedIds.slice(),n.name=this.name,n.alternativeText=this.alternativeText,n.title=this.title,n.visible=this.visible,n.widthScale=this.widthScale,n.heightScale=this.heightScale,n.verticalPosition=this.verticalPosition,n.verticalOrigin=this.verticalOrigin,n.verticalAlignment=this.verticalAlignment,n.horizontalPosition=this.horizontalPosition,n.horizontalOrigin=this.horizontalOrigin,n.horizontalAlignment=this.horizontalAlignment,n.allowOverlap=this.allowOverlap,n.textWrappingStyle=this.textWrappingStyle,n.textWrappingType=this.textWrappingType,n.layoutInCell=this.layoutInCell,n.zOrderPosition=this.zOrderPosition,n},t.prototype.destroy=function(){this.imgElement=void 0;this.imageString=void 0;this.isInlineImageIn=void 0;n.prototype.destroy.call(this)},t}(lt),o=function(n){function t(t,i){var r=n.call(this)||this;return r.baselineOffset=0,r.trimEndWidth=0,r.isFollowCharacter=!1,r.listLevel=t,r.isFollowCharacter=i,r}return st(t,n),t.prototype.getLength=function(){return this.text?this.text.length:0},t.prototype.clone=function(){var n=new t(this.listLevel,this.isFollowCharacter);return n.text=this.text,n.baselineOffset=this.baselineOffset,this.margin&&(n.margin=this.margin.clone()),n.width=this.width,n.height=this.height,n},t.prototype.destroy=function(){this.text=void 0;n.prototype.destroy.call(this)},t}(tt),ot=function(n){function t(){var t=n.call(this)||this;return t.editRangeStart=void 0,t.editRangeId=-1,t}return st(t,n),t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.editRangeStart=void 0},t.prototype.clone=function(){var n=new t;return n.editRangeStart=this.editRangeStart,n.editRangeId=this.editRangeId,n},t}(tt),ht=function(n){function t(){var t=n.call(this)||this;return t.columnFirst=-1,t.columnLast=-1,t.user="",t.group="",t.editRangeId=-1,t}return st(t,n),t.prototype.getLength=function(){return 1},t.prototype.renderLockMark=function(n,t){var r,i;sf.base.isNullOrUndefined(this.editRangeMark)&&(r=n===this.user?"you":this.user,this.editRangeMark=document.createElement("div"),this.editRangeMark.style.display="none",this.editRangeMark.classList.add("e-de-lock-mark"),i=document.createElement("span"),i.className="e-icons e-de-ctnr-lock",this.editRangeMark.appendChild(i),this.editRangeMark.title=t.getConstant("This region is locked by")+" "+r);this.line&&sf.base.isNullOrUndefined(this.editRangeMark.parentElement)&&this.line.paragraph.bodyWidget.page.documentHelper.pageContainer.appendChild(this.editRangeMark)},t.prototype.removeEditRangeMark=function(){this.editRangeMark&&(this.editRangeMark.parentElement.removeChild(this.editRangeMark),this.editRangeMark=void 0)},t.prototype.destroy=function(){this.user=void 0;this.columnFirst=void 0;this.columnLast=void 0},t.prototype.clone=function(){var n=new t;return n.columnFirst=this.columnFirst,n.columnLast=this.columnLast,n.user=this.user,n.group=this.group,n.editRangeEnd=this.editRangeEnd,n.editRangeId=this.editRangeId,n},t}(tt),ir=function(n){function t(){var t=n.call(this)||this;return t.chartTitle="",t.chartType="",t.chartElement=void 0,t.chartCategory=[],t.chartSeries=[],t.chartArea=new tu,t.chartPlotArea=new tu,t.chartTitleArea=new vr,t.chartLegend=new ne,t.chartPrimaryCategoryAxis=new eu,t.chartPrimaryValueAxis=new eu,t.chartDataTable=new fe,t}return st(t,n),t.prototype.getLength=function(){return 1},Object.defineProperty(t.prototype,"title",{get:function(){return this.chartTitle},set:function(n){this.chartTitle=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.chartType},set:function(n){this.chartType=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chartGapWidth",{get:function(){return this.gapWidth},set:function(n){this.gapWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chartOverlap",{get:function(){return this.overlap},set:function(n){this.overlap=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targetElement",{get:function(){return sf.base.isNullOrUndefined(this.div)&&(this.div=sf.base.createElement("div")),this.div},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"officeChart",{get:function(){return this.officeChartInternal},set:function(n){n&&(this.officeChartInternal=n,this.officeChartInternal.chart.loaded=this.onChartLoaded.bind(this))},enumerable:!0,configurable:!0}),t.prototype.onChartLoaded=function(){var n=this;this.officeChart.convertChartToImage(this.officeChart.chart,this.width,this.height).then(function(t){n.imageString=t})},t.prototype.clone=function(){var n=new t,i,r,u;for(n.chartTitle=this.chartTitle,n.chartType=this.chartType,n.height=this.height,n.width=this.width,n.gapWidth=this.gapWidth,n.overlap=this.overlap,i=0;i<this.chartCategory.length;i++)r=this.chartCategory[i].clone(),n.chartCategory.push(r);for(i=0;i<this.chartSeries.length;i++)u=this.chartSeries[i].clone(),n.chartSeries.push(u);return n.chartArea=this.chartArea.clone(),n.chartPlotArea=this.chartPlotArea.clone(),n.chartLegend=this.chartLegend.clone(),n.chartTitleArea=this.chartTitleArea.clone(),n.chartPrimaryCategoryAxis=this.chartPrimaryCategoryAxis.clone(),n.chartPrimaryValueAxis=this.chartPrimaryValueAxis.clone(),n.chartDataTable=this.chartDataTable.clone(),n},t.prototype.destroy=function(){n.prototype.destroy.call(this);this.officeChartInternal&&(this.officeChartInternal.chart.loaded=void 0,this.officeChartInternal.destroy(),this.officeChartInternal=void 0);this.div&&(this.div=void 0);this.chartTitle=void 0;this.chartType=void 0;this.chartArea=void 0;this.chartPlotArea=void 0;this.chartCategory=[];this.chartSeries=[];this.chartTitleArea=void 0;this.chartLegend=void 0;this.chartPrimaryCategoryAxis=void 0;this.chartPrimaryValueAxis=void 0;this.chartDataTable=void 0;this.chartElement=void 0},t}(v),tu=function(){function n(){}return Object.defineProperty(n.prototype,"chartForeColor",{get:function(){return this.foreColor},set:function(n){this.foreColor=n},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var t=new n;return t.foreColor=this.foreColor,t},n.prototype.destroy=function(){this.foreColor=void 0},n}(),df=function(){function n(){this.categoryXName="";this.chartData=[]}return Object.defineProperty(n.prototype,"xName",{get:function(){return this.categoryXName},set:function(n){this.categoryXName=n},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var i=new n,t,r;for(i.categoryXName=this.categoryXName,t=0;t<this.chartData.length;t++)r=this.chartData[t].clone(),i.chartData.push(r);return i},n.prototype.destroy=function(){this.categoryXName=void 0;this.chartData=[]},n}(),gf=function(){function n(){}return Object.defineProperty(n.prototype,"yAxisValue",{get:function(){return this.yValue},set:function(n){this.yValue=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"xAxisValue",{get:function(){return this.xValue},set:function(n){this.xValue=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bubbleSize",{get:function(){return this.size},set:function(n){this.size=n},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var t=new n;return t.yValue=this.yValue,t.xValue=this.xValue,t.size=this.size,t},n.prototype.destroy=function(){this.xValue=void 0;this.yValue=void 0;this.size=void 0},n}(),ne=function(){function n(){this.chartTitleArea=new vr}return Object.defineProperty(n.prototype,"chartLegendPostion",{get:function(){return this.legendPostion},set:function(n){this.legendPostion=n},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var t=new n;return t.legendPostion=this.legendPostion,t.chartTitleArea=this.chartTitleArea.clone(),t},n.prototype.destroy=function(){this.legendPostion=void 0;this.chartTitleArea=void 0},n}(),te=function(){function n(){this.chartDataFormat=[];this.trendLines=[];this.errorBar=new ie;this.dataLabels=new ru;this.seriesFormat=new iu}return Object.defineProperty(n.prototype,"seriesName",{get:function(){return this.name},set:function(n){this.name=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"firstSliceAngle",{get:function(){return this.sliceAngle},set:function(n){this.sliceAngle=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"doughnutHoleSize",{get:function(){return this.holeSize},set:function(n){this.holeSize=n},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var t=new n,i,r,u;for(t.name=this.name,t.sliceAngle=this.sliceAngle,t.holeSize=this.holeSize,t.errorBar=this.errorBar.clone(),t.dataLabels=this.dataLabels.clone(),t.seriesFormat=this.seriesFormat.clone(),i=0;i<this.chartDataFormat.length;i++)r=this.chartDataFormat[i].clone(),t.chartDataFormat.push(r);for(i=0;i<this.trendLines.length;i++)u=this.trendLines[i].clone(),t.trendLines.push(u);return t},n.prototype.destroy=function(){this.name=void 0;this.errorBar=void 0;this.trendLines=void 0;this.chartDataFormat=[]},n}(),ie=function(){function n(){}return Object.defineProperty(n.prototype,"errorType",{get:function(){return this.type},set:function(n){this.type=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"errorDirection",{get:function(){return this.direction},set:function(n){this.direction=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"errorEndStyle",{get:function(){return this.endStyle},set:function(n){this.endStyle=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"numberValue",{get:function(){return this.errorValue},set:function(n){this.errorValue=n},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var t=new n;return t.type=this.type,t.errorDirection=this.errorDirection,t.endStyle=this.endStyle,t.errorValue=this.errorValue,t},n.prototype.destroy=function(){this.type=void 0;this.errorDirection=void 0;this.endStyle=void 0},n}(),iu=function(){function n(){}return Object.defineProperty(n.prototype,"markerStyle",{get:function(){return this.style},set:function(n){this.style=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"markerColor",{get:function(){return this.color},set:function(n){this.color=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"numberValue",{get:function(){return this.size},set:function(n){this.size=n},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var t=new n;return t.style=this.style,t.color=this.color,t.size=this.size,t},n.prototype.destroy=function(){this.style=void 0;this.color=void 0;this.size=void 0},n}(),ru=function(){function n(){}return Object.defineProperty(n.prototype,"labelPosition",{get:function(){return this.position},set:function(n){this.position=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontName",{get:function(){return this.name},set:function(n){this.name=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontColor",{get:function(){return this.color},set:function(n){this.color=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontSize",{get:function(){return this.size},set:function(n){this.size=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLegendKey",{get:function(){return this.isLegend},set:function(n){this.isLegend=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isBubbleSize",{get:function(){return this.isBubble},set:function(n){this.isBubble=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isCategoryName",{get:function(){return this.isCategory},set:function(n){this.isCategory=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isSeriesName",{get:function(){return this.isSeries},set:function(n){this.isSeries=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isValue",{get:function(){return this.isValueEnabled},set:function(n){this.isValueEnabled=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isPercentage",{get:function(){return this.isPercentageEnabled},set:function(n){this.isPercentageEnabled=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLeaderLines",{get:function(){return this.showLeaderLines},set:function(n){this.showLeaderLines=n},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var t=new n;return t.position=this.position,t.name=this.name,t.color=this.color,t.size=this.size,t.isBubble=this.isBubble,t.isLegend=this.isLegend,t.isCategory=this.isCategory,t.isSeries=this.isSeries,t.isValueEnabled=this.isValueEnabled,t.isPercentageEnabled=this.isPercentageEnabled,t.showLeaderLines=this.showLeaderLines,t},n.prototype.destroy=function(){this.position=void 0},n}(),re=function(){function n(){}return Object.defineProperty(n.prototype,"trendLineType",{get:function(){return this.type},set:function(n){this.type=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"trendLineName",{get:function(){return this.name},set:function(n){this.name=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"interceptValue",{get:function(){return this.intercept},set:function(n){this.intercept=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"forwardValue",{get:function(){return this.forward},set:function(n){this.forward=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"backwardValue",{get:function(){return this.backward},set:function(n){this.backward=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isDisplayRSquared",{get:function(){return this.displayRSquared},set:function(n){this.displayRSquared=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isDisplayEquation",{get:function(){return this.displayEquation},set:function(n){this.displayEquation=n},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var t=new n;return t.type=this.type,t.name=this.name,t.forward=this.forward,t.backward=this.backward,t.intercept=this.intercept,t.displayEquation=this.displayEquation,t.displayRSquared=this.displayRSquared,t},n.prototype.destroy=function(){this.type=void 0;this.name=void 0;this.forward=void 0;this.backward=void 0},n}(),vr=function(){function n(){this.dataFormat=new uu;this.layout=new ue}return Object.defineProperty(n.prototype,"chartfontName",{get:function(){return this.fontName},set:function(n){this.fontName=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"chartFontSize",{get:function(){return this.fontSize},set:function(n){this.fontSize=n},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var t=new n;return t.fontName=this.fontName,t.fontSize=this.fontSize,t.dataFormat=this.dataFormat.clone(),t.layout=this.layout.clone(),t},n.prototype.destroy=function(){this.fontName=void 0;this.fontSize=void 0;this.dataFormat=void 0;this.layout=void 0},n}(),uu=function(){function n(){this.fill=new fu;this.line=new fu}return n.prototype.clone=function(){var t=new n;return t.fill=this.fill.clone(),t.line=this.line.clone(),t},n.prototype.destroy=function(){this.fill=void 0;this.line=void 0},n}(),fu=function(){function n(){}return Object.defineProperty(n.prototype,"color",{get:function(){return this.fillColor},set:function(n){this.fillColor=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rgb",{get:function(){return this.fillRGB},set:function(n){this.fillRGB=n},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var t=new n;return t.fillColor=this.fillColor,t.fillRGB=this.fillRGB,t},n.prototype.destroy=function(){this.fillColor=void 0;this.fillRGB=void 0},n}(),ue=function(){function n(){}return Object.defineProperty(n.prototype,"chartLayoutLeft",{get:function(){return this.layoutX},set:function(n){this.layoutX=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"chartLayoutTop",{get:function(){return this.layoutY},set:function(n){this.layoutY=n},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var t=new n;return t.layoutX=this.layoutX,t.layoutY=this.layoutY,t},n.prototype.destroy=function(){this.layoutX=void 0;this.layoutY=void 0},n}(),eu=function(){function n(){this.chartTitleArea=new vr}return Object.defineProperty(n.prototype,"majorTick",{get:function(){return this.majorTickMark},set:function(n){this.majorTickMark=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minorTick",{get:function(){return this.minorTickMark},set:function(n){this.minorTickMark=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"tickPosition",{get:function(){return this.tickLabelPostion},set:function(n){this.tickLabelPostion=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minorGridLines",{get:function(){return this.hasMinorGridLines},set:function(n){this.hasMinorGridLines=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"majorGridLines",{get:function(){return this.hasMajorGridLines},set:function(n){this.hasMajorGridLines=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"interval",{get:function(){return this.majorUnit},set:function(n){this.majorUnit=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"max",{get:function(){return this.maximumValue},set:function(n){this.maximumValue=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"min",{get:function(){return this.minimumValue},set:function(n){this.minimumValue=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"categoryAxisTitle",{get:function(){return this.title},set:function(n){this.title=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"categoryAxisType",{get:function(){return this.categoryType},set:function(n){this.categoryType=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"categoryNumberFormat",{get:function(){return this.numberFormat},set:function(n){this.numberFormat=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"axisFontSize",{get:function(){return this.fontSize},set:function(n){this.fontSize=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"axisFontName",{get:function(){return this.fontName},set:function(n){this.fontName=n},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var t=new n;return t.title=this.title,t.categoryType=this.categoryType,t.numberFormat=this.numberFormat,t.fontSize=this.fontSize,t.fontName=this.fontName,t.hasMajorGridLines=this.hasMajorGridLines,t.hasMinorGridLines=this.hasMinorGridLines,t.minimumValue=this.minimumValue,t.maximumValue=this.maximumValue,t.majorUnit=this.majorUnit,t.majorTickMark=this.majorTickMark,t.minorTickMark=this.minorTickMark,t.tickLabelPostion=this.tickLabelPostion,t.chartTitleArea=this.chartTitleArea.clone(),t},n.prototype.destroy=function(){this.title=void 0;this.categoryType=void 0;this.numberFormat=void 0;this.chartTitleArea=void 0;this.minimumValue=void 0;this.maximumValue=void 0;this.fontSize=void 0;this.fontName=void 0;this.majorUnit=void 0;this.majorTickMark=void 0;this.minorTickMark=void 0;this.tickLabelPostion=void 0},n}(),fe=function(){function n(){}return Object.defineProperty(n.prototype,"showSeriesKeys",{get:function(){return this.isSeriesKeys},set:function(n){this.isSeriesKeys=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasHorzBorder",{get:function(){return this.isHorzBorder},set:function(n){this.isHorzBorder=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasVertBorder",{get:function(){return this.isVertBorder},set:function(n){this.isVertBorder=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasBorders",{get:function(){return this.isBorders},set:function(n){this.isBorders=n},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var t=new n;return t.isSeriesKeys=this.isSeriesKeys,t.isHorzBorder=this.isHorzBorder,t.isVertBorder=this.isVertBorder,t.isBorders=this.isBorders,t},n.prototype.destroy=function(){this.isSeriesKeys=void 0;this.isHorzBorder=void 0;this.isVertBorder=void 0;this.isBorders=void 0},n}(),g=function(n){function t(t){var i=n.call(this)||this;return i.commentType=0,i.commentId="",i.commentType=t,i}return st(t,n),Object.defineProperty(t.prototype,"comment",{get:function(){return this.commentInternal},set:function(n){this.commentInternal=n},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var n=new t(this.commentType);return n.commentId=this.commentId,n.commentType=this.commentType,n},t.prototype.renderCommentMark=function(){if(0===this.commentType&&sf.base.isNullOrUndefined(this.commentMark)){this.commentMark=document.createElement("div");this.commentMark.style.display="none";this.commentMark.classList.add("e-de-cmt-mark");var n=document.createElement("span");n.classList.add("e-icons");n.classList.add("e-de-cmt-mark-icon");this.commentMark.appendChild(n)}this.line&&sf.base.isNullOrUndefined(this.commentMark.parentElement)&&(this.line.paragraph.bodyWidget.page.documentHelper.pageContainer.appendChild(this.commentMark),this.commentMark.addEventListener("click",this.selectComment.bind(this)))},t.prototype.selectComment=function(){var n=this.line.paragraph.bodyWidget.page.documentHelper;n.owner&&n.selectComment(this.comment)},t.prototype.removeCommentMark=function(){this.commentMark&&this.commentMark.parentElement&&(this.commentMark.removeEventListener("click",this.selectComment.bind(this)),this.commentMark.parentElement.removeChild(this.commentMark))},t.prototype.destroy=function(){this.commentMark&&this.removeCommentMark()},t}(tt),rr=function(n){function t(t){var i=n.call(this,0)||this;return i.authorIn="",i.initialIn="",i.done=!1,i.textIn="",i.isReply=!1,i.ownerComment=void 0,i.createdDate=t,i.replyComments=[],i}return st(t,n),Object.defineProperty(t.prototype,"commentStart",{get:function(){return this.commentStartIn},set:function(n){this.commentStartIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"commentEnd",{get:function(){return this.commentEndIn},set:function(n){this.commentEndIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"author",{get:function(){return this.authorIn},set:function(n){this.authorIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"initial",{get:function(){return this.initialIn},set:function(n){this.initialIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isResolved",{get:function(){return this.done},set:function(n){this.done=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"date",{get:function(){return this.createdDate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.textIn},set:function(n){this.textIn=n},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var n=new t(this.date);return n.author=this.author,n.initial=this.initial,n.commentId=this.commentId,n.replyComments=this.replyComments,n.isResolved=this.isResolved,n.text=this.text,n},t.prototype.destroy=function(){this.ownerComment=void 0},t}(g),ou=function(){function n(n){this.boundingRectangle=new b(96,96,816,1056);this.repeatHeaderRowTableWidget=!1;this.bodyWidgets=[];this.headerWidget=void 0;this.footerWidget=void 0;this.footnoteWidget=void 0;this.endnoteWidget=void 0;this.currentPageNum=1;this.allowNextPageRendering=!0;this.documentHelper=n}return Object.defineProperty(n.prototype,"index",{get:function(){return this.documentHelper?this.documentHelper.pages.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"previousPage",{get:function(){var n=this.index;if(n>0)return this.documentHelper.pages[n-1]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nextPage",{get:function(){var n=this.index;if(n<this.documentHelper.pages.length-1)return this.documentHelper.pages[n+1]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sectionIndex",{get:function(){return this.bodyWidgets.length>0?this.bodyWidgets[0].index:-1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){this.headerWidget&&(this.viewer&&this.documentHelper.owner.editor&&(this.documentHelper.owner.editor.removeFieldInWidget(this.headerWidget),this.documentHelper.owner.editor.removeFieldInWidget(this.headerWidget,!1,!0)),this.headerWidget.destroy());this.headerWidget=void 0;this.footerWidget&&(this.viewer&&this.documentHelper.owner.editor&&(this.documentHelper.owner.editor.removeFieldInWidget(this.footerWidget),this.documentHelper.owner.editor.removeFieldInWidget(this.footerWidget,!1,!0)),this.footerWidget.destroy());this.footerWidget=void 0;this.bodyWidgets=[];this.bodyWidgets=void 0;sf.base.isNullOrUndefined(this.documentHelper)||sf.base.isNullOrUndefined(this.documentHelper.pages)||this.documentHelper.removePage(this);this.documentHelper=void 0},n}(),su=function(){function n(){this.tableColumns=[];this.tableWidth=0}return Object.defineProperty(n.prototype,"columns",{get:function(){return this.tableColumns},enumerable:!0,configurable:!0}),n.prototype.resetColumns=function(){for(var n=0;n<this.tableColumns.length;n++)this.tableColumns[n].destroy();this.tableColumns=[]},n.prototype.getPreviousSpannedCellWidth=function(n,t){for(var r=0,i=n;i<t;i++)r+=this.tableColumns[i].preferredWidth;return r},n.prototype.addColumns=function(n,t,i,r,u){for(var f,e,o=this.columns.length;o<t;o++)this.columns.push(new ee);for(f=0,e=n;e<t;e++)f+=this.columns[e].preferredWidth;!(t-n>1)&&f<i&&(this.columns[t-1].preferredWidth+=i-f);r.minimumWordWidth>this.columns[t-1].minimumWordWidth&&(this.columns[t-1].minimumWordWidth=r.minimumWordWidth);r.maximumWordWidth>this.columns[t-1].maximumWordWidth&&(this.columns[t-1].maximumWordWidth=r.maximumWordWidth);r.minimumWidth>this.columns[t-1].minimumWidth&&(this.columns[t-1].minimumWidth=r.minimumWidth);u>this.columns[t-1].endOffset&&(this.columns[t-1].endOffset=u)},n.prototype.getTotalWidth=function(n){for(var t,r=0,i=0;i<this.columns.length;i++)t=this.columns[i],r+=0===n?t.preferredWidth:1===n?t.minimumWordWidth:2===n?t.maximumWordWidth:t.minimumWidth;return r},n.prototype.isFitColumns=function(n,t,i){var u=this.getTotalWidth(0),r,f,e;if(this.tableWidth=i&&t>u?u:t,u!==this.tableWidth){for(r=this.tableWidth/u,r=isNaN(r)||r===1/0?1:r,f=0;f<this.columns.length;f++)if(e=this.columns[f],r*e.preferredWidth<e.minWidth)return!1;return!0}return!0},n.prototype.autoFitColumn=function(n,t,i,r){for(var v,o,s,e,p,u,l=0,h=0,a=0,f=0;f<this.columns.length;f++)0===(u=this.columns[f]).minimumWordWidth&&0===u.maximumWordWidth&&0===u.minWidth&&(u.minimumWordWidth=u.preferredWidth,u.maximumWordWidth=u.preferredWidth,u.minWidth=u.preferredWidth),l+=u.preferredWidth>u.maximumWordWidth?u.preferredWidth:u.maximumWordWidth,h+=u.preferredWidth>u.minimumWordWidth?u.preferredWidth:u.minimumWordWidth,v=0===u.preferredWidth?u.minimumWordWidth:u.preferredWidth>u.minimumWordWidth?u.preferredWidth:u.minimumWordWidth,a+=(s=u.maximumWordWidth-v)>0?s:0;if(l<=t){for(f=0;f<this.columns.length;f++)(u=this.columns[f]).preferredWidth<u.maximumWordWidth&&(u.preferredWidth=r?u.minimumWidth+u.minimumWordWidth:u.maximumWordWidth);i||this.fitColumns(n,t,i)}else{if(!i)return void this.fitColumns(n,t,i);if(h<=t||h<=n)for(o=n>t?n:t,o-=h,f=0;f<this.columns.length;f++)0===(u=this.columns[f]).preferredWidth?u.preferredWidth=u.minimumWordWidth:(u.preferredWidth<u.minimumWordWidth&&(u.preferredWidth=u.minimumWordWidth),r)||(e=o*((s=(s=u.maximumWordWidth-u.preferredWidth)>0?s:0)/a),u.preferredWidth+=isNaN(e)?0:e);else{var w=this.getTotalWidth(1),c=this.getTotalWidth(3),y=this.getTotalWidth(0);if(c>2112)for(p=2112/this.columns.length,f=0;f<this.columns.length;f++)this.columns[f].preferredWidth=p;else if(o=0,c<n)for(o=n-c,f=0;f<this.columns.length;f++)e=o*(u=this.columns[f]).minimumWordWidth/w,e=isNaN(e)?0:e,u.preferredWidth<=u.minimumWidth||(u.preferredWidth=u.minimumWidth+e);else if(y>n)for(e=n/y,f=0;f<this.columns.length;f++)(u=this.columns[f]).preferredWidth=u.preferredWidth*e}}this.tableWidth=this.getTotalWidth(0)},n.prototype.fitColumns=function(n,t,i,r){var f,u,e,o;if(sf.base.isNullOrUndefined(r)&&(r=0),f=this.getTotalWidth(0),i&&(f-=r),this.tableWidth=i?f:t,f!==this.tableWidth)for(u=this.tableWidth/f,u=isNaN(u)||u===1/0?1:u,e=0;e<this.columns.length;e++)o=this.columns[e],o.preferredWidth=u*o.preferredWidth},n.prototype.getCellWidth=function(n,t){for(var r=0,i=0;i<t;i++)r+=this.tableColumns[i+n].preferredWidth;return r},n.prototype.validateColumnWidths=function(){for(var n=0;n<this.columns.length;n++)0===n?this.columns[n].preferredWidth!==this.columns[n].endOffset&&(this.columns[n].preferredWidth=this.columns[n].endOffset):this.columns[n-1].endOffset+this.columns[n].preferredWidth<this.columns[n].endOffset&&(this.columns[n].preferredWidth=this.columns[n].endOffset-this.columns[n-1].endOffset)},n.prototype.clone=function(){var i=new n,t;for(i.tableWidth=this.tableWidth,t=0;t<this.columns.length;t++)i.columns.push(this.columns[t].clone());return i},n.prototype.destroy=function(){if(!sf.base.isNullOrUndefined(this.tableColumns))for(var n=0;n<this.tableColumns.length;n++)this.tableColumns[n].destroy();this.tableColumns=[];this.tableColumns=void 0;this.tableWidth=void 0},n}(),ee=function(){function n(){this.preferredWidth=0;this.minWidth=0;this.maxWidth=0;this.endOffset=0;this.minimumWordWidth=0;this.maximumWordWidth=0;this.minimumWidth=0}return n.prototype.clone=function(){var t=new n;return t.preferredWidth=this.preferredWidth,t.minWidth=this.minWidth,t.maxWidth=this.maxWidth,t},n.prototype.destroy=function(){this.preferredWidth=void 0;this.minWidth=void 0;this.maxWidth=void 0},n}(),yr=function(){this.minimumWordWidth=0;this.maximumWordWidth=0;this.minimumWidth=0;this.hasMinimumWidth=!1;this.hasMinimumWordWidth=!1;this.hasMaximumWordWidth=!1},hu=function(){function n(){}return Object.defineProperty(n.prototype,"position",{get:function(){return this.positionIn},set:function(n){this.positionIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"deletePosition",{get:function(){return this.deletePositionIn},set:function(n){this.deletePositionIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"tabJustification",{get:function(){return this.justification},set:function(n){this.justification=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"tabLeader",{get:function(){return this.leader},set:function(n){this.leader=n},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){this.position=void 0;this.deletePosition=void 0;this.tabJustification=void 0;this.leader=void 0},n}(),ut=function(){function n(n){this.uniqueParagraphFormat=void 0;this.ownerBase=void 0;this.baseStyle=void 0;this.tabs=void 0;this.ownerBase=n;this.listFormat=new ai(this);this.tabs=[]}return n.prototype.getUpdatedTabs=function(){var n=[],t,i,r,e,u,f,o,s;if(!sf.base.isNullOrUndefined(this.baseStyle)){for(t=this.baseStyle,i=new h;!sf.base.isNullOrUndefined(t);){for(r=0,e=t.paragraphFormat.tabs;r<e.length;r++)u=e[r],i.containsKey(u.position)||i.add(u.position,u);t=t.basedOn}for(f=0,o=i.keys;f<o.length;f++)s=o[f],this.hasTabStop(parseFloat(s.toFixed(4)))||n.push(i.get(s));n=(n=n.concat(this.tabs.filter(function(n){return 0!==n.position&&0===n.deletePosition}))).sort(function(n,t){return n.position-t.position})}return n},n.prototype.hasTabStop=function(n){for(var t=0;t<this.tabs.length;t++)if(parseFloat(this.tabs[t].position.toFixed(4))===n||parseFloat(this.tabs[t].deletePosition.toFixed(4))===n)return!0;return!1},Object.defineProperty(n.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(n){this.setPropertyValue("leftIndent",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightIndent",{get:function(){return this.getPropertyValue("rightIndent")},set:function(n){this.setPropertyValue("rightIndent",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"firstLineIndent",{get:function(){return this.getPropertyValue("firstLineIndent")},set:function(n){this.setPropertyValue("firstLineIndent",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"beforeSpacing",{get:function(){return this.getPropertyValue("beforeSpacing")},set:function(n){this.setPropertyValue("beforeSpacing",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"afterSpacing",{get:function(){return this.getPropertyValue("afterSpacing")},set:function(n){this.setPropertyValue("afterSpacing",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineSpacing",{get:function(){return this.getPropertyValue("lineSpacing")},set:function(n){this.setPropertyValue("lineSpacing",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineSpacingType",{get:function(){return this.getPropertyValue("lineSpacingType")},set:function(n){this.setPropertyValue("lineSpacingType",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textAlignment",{get:function(){return this.getPropertyValue("textAlignment")},set:function(n){this.setPropertyValue("textAlignment",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"keepWithNext",{get:function(){return this.getPropertyValue("keepWithNext")},set:function(n){this.setPropertyValue("keepWithNext",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"keepLinesTogether",{get:function(){return this.getPropertyValue("keepLinesTogether")},set:function(n){this.setPropertyValue("keepLinesTogether",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"widowControl",{get:function(){return this.getPropertyValue("widowControl")},set:function(n){this.setPropertyValue("widowControl",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"outlineLevel",{get:function(){return this.getPropertyValue("outlineLevel")},set:function(n){this.setPropertyValue("outlineLevel",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(n){this.bidi!==n&&("Left"===this.textAlignment?this.textAlignment="Right":"Right"===this.textAlignment&&(this.textAlignment="Left"));this.setPropertyValue("bidi",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"contextualSpacing",{get:function(){return this.getPropertyValue("contextualSpacing")},set:function(n){this.setPropertyValue("contextualSpacing",n)},enumerable:!0,configurable:!0}),n.prototype.getListFormatParagraphFormat=function(t){var i=this.getListPargaraphFormat(t);if(!sf.base.isNullOrUndefined(i))return i.uniqueParagraphFormat.propertiesHash.get(y.getPropertyType(n.uniqueFormatType,t))},n.prototype.getListPargaraphFormat=function(t){if(this.listFormat.listId>-1&&this.listFormat.listLevelNumber>-1){var i=this.listFormat.listLevel,r=y.getPropertyType(n.uniqueFormatType,t);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.paragraphFormat.uniqueParagraphFormat)||!i.paragraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(r)?void 0:i.paragraphFormat}},n.prototype.getPropertyValue=function(t){var r,u,i,f,e;if(this.hasValue(t)){if(e=y.getPropertyType(n.uniqueFormatType,t),!sf.base.isNullOrUndefined(this.uniqueParagraphFormat)&&this.uniqueParagraphFormat.propertiesHash.containsKey(e))return this.uniqueParagraphFormat.propertiesHash.get(e)}else{if(r=this.getListFormatParagraphFormat(t),_instanceof(this.baseStyle,fi)){for(u=this,i=this.baseStyle;!sf.base.isNullOrUndefined(i);){if(f=void 0,this.listFormat.hasValue("listId")||(f=i.paragraphFormat.getListPargaraphFormat(t)),i.paragraphFormat.hasValue(t)){u=i.paragraphFormat;break}if(!sf.base.isNullOrUndefined(f)&&f.hasValue(t)){u=f;break}i=i.basedOn}if(!sf.base.isNullOrUndefined(i))return!sf.base.isNullOrUndefined(r)&&-1!==this.listFormat.listId&&-1===u.listFormat.listId||!sf.base.isNullOrUndefined(r)&&this.listFormat.listId!==u.listFormat.listId?r:(e=y.getPropertyType(n.uniqueFormatType,t),u.uniqueParagraphFormat.propertiesHash.get(e))}if(!sf.base.isNullOrUndefined(r))return r}return this.getDefaultValue(t)},n.prototype.getDefaultValue=function(t){var o=y.getPropertyType(n.uniqueFormatType,t),i=this.documentParagraphFormat(),f=!0,e,r;return(this.ownerBase&&_instanceof(this.ownerBase,u)&&(f=_instanceof(this.ownerBase.containerWidget,c)||_instanceof(this.ownerBase.containerWidget,s)),e=!sf.base.isNullOrUndefined(this.ownerBase)&&!sf.base.isNullOrUndefined(this.ownerBase.bodyWidget)&&this.ownerBase.bodyWidget.page&&this.ownerBase.bodyWidget.page.documentHelper.owner.editor&&this.ownerBase.bodyWidget.page.documentHelper.owner.editor.isPaste,f&&!e&&!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.uniqueParagraphFormat)&&(r=i.uniqueParagraphFormat.propertiesHash.get(o),!sf.base.isNullOrUndefined(r)))?r:n.getPropertyDefaultValue(t)},n.prototype.documentParagraphFormat=function(){var t,n;return sf.base.isNullOrUndefined(this.ownerBase)||(n=this.ownerBase.bodyWidget,sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.page)||(t=n.page.documentHelper.paragraphFormat)),t},n.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=n.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueParagraphFormat))this.initializeUniqueParagraphFormat(t,i);else{var r=y.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,t);if(this.uniqueParagraphFormat.propertiesHash.containsKey(r)&&this.uniqueParagraphFormat.propertiesHash.get(r)===i)return;this.uniqueParagraphFormat=n.uniqueParagraphFormats.updateUniqueFormat(this.uniqueParagraphFormat,t,i)}},n.prototype.initializeUniqueParagraphFormat=function(t,i){var r=new h;this.addUniqueParaFormat("leftIndent",t,i,r);this.addUniqueParaFormat("rightIndent",t,i,r);this.addUniqueParaFormat("firstLineIndent",t,i,r);this.addUniqueParaFormat("textAlignment",t,i,r);this.addUniqueParaFormat("beforeSpacing",t,i,r);this.addUniqueParaFormat("afterSpacing",t,i,r);this.addUniqueParaFormat("lineSpacing",t,i,r);this.addUniqueParaFormat("lineSpacingType",t,i,r);this.addUniqueParaFormat("outlineLevel",t,i,r);this.addUniqueParaFormat("bidi",t,i,r);this.addUniqueParaFormat("contextualSpacing",t,i,r);this.addUniqueParaFormat("keepWithNext",t,i,r);this.addUniqueParaFormat("keepLinesTogether",t,i,r);this.addUniqueParaFormat("widowControl",t,i,r);this.uniqueParagraphFormat=n.uniqueParagraphFormats.addUniqueFormat(r,n.uniqueFormatType)},n.prototype.addUniqueParaFormat=function(t,i,r,u){var f=y.getPropertyType(n.uniqueFormatType,t);t===i&&u.add(f,r)},n.getPropertyDefaultValue=function(n){var t=void 0;switch(n){case"leftIndent":case"rightIndent":case"firstLineIndent":t=0;break;case"textAlignment":t="Left";break;case"beforeSpacing":case"afterSpacing":t=0;break;case"lineSpacing":t=1;break;case"lineSpacingType":t="Multiple";break;case"styleName":t="Normal";break;case"outlineLevel":t="BodyText";break;case"bidi":case"contextualSpacing":case"keepWithNext":case"keepLinesTogether":t=!1;break;case"widowControl":t=!0}return t},n.prototype.clearFormat=function(){sf.base.isNullOrUndefined(this.listFormat)||this.listFormat.clearFormat();sf.base.isNullOrUndefined(this.uniqueParagraphFormat)||0!==this.uniqueParagraphFormat.referenceCount||n.uniqueParagraphFormats.remove(this.uniqueParagraphFormat);this.uniqueParagraphFormat=void 0;this.baseStyle=void 0},n.prototype.destroy=function(){if(this.clearFormat(),sf.base.isNullOrUndefined(this.listFormat)||this.listFormat.destroy(),this.listFormat=void 0,void 0!==this.tabs){for(var n=0;n<this.tabs.length;n++)this.tabs[n].destroy();this.tabs=void 0}},n.prototype.copyFormat=function(n){if(!sf.base.isNullOrUndefined(n)&&(sf.base.isNullOrUndefined(n.uniqueParagraphFormat)||this.updateUniqueParagraphFormat(n),sf.base.isNullOrUndefined(n.listFormat)||this.listFormat.copyFormat(n.listFormat),sf.base.isNullOrUndefined(n.baseStyle)||(this.baseStyle=n.baseStyle),!sf.base.isNullOrUndefined(n.tabs)))for(var t=0;t<n.tabs.length;t++)this.tabs[t]=n.tabs[t]},n.prototype.updateUniqueParagraphFormat=function(t){var i=void 0;this.uniqueParagraphFormat&&(i=this.uniqueParagraphFormat.mergeProperties(t.uniqueParagraphFormat),0===this.uniqueParagraphFormat.referenceCount&&(n.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0));this.uniqueParagraphFormat=new y(n.uniqueFormatType);sf.base.isNullOrUndefined(i)&&(i=this.uniqueParagraphFormat.mergeProperties(t.uniqueParagraphFormat));this.uniqueParagraphFormat=n.uniqueParagraphFormats.addUniqueFormat(i,n.uniqueFormatType)},n.prototype.cloneFormat=function(){var t=new n(void 0);return t.uniqueParagraphFormat=this.uniqueParagraphFormat,t.baseStyle=this.baseStyle,t.listFormat=sf.base.isNullOrUndefined(this.listFormat)?void 0:this.listFormat.cloneListFormat(),t},n.prototype.hasValue=function(n){if(!sf.base.isNullOrUndefined(this.uniqueParagraphFormat)&&!sf.base.isNullOrUndefined(this.uniqueParagraphFormat.propertiesHash)){var t=y.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,n);return this.uniqueParagraphFormat.propertiesHash.containsKey(t)}return!1},n.clear=function(){this.uniqueParagraphFormats.clear()},n.prototype.applyStyle=function(n){this.baseStyle=n;this.listFormat.applyStyle(this.baseStyle)},n.prototype.getValue=function(n){if(this.hasValue(n))return this.getPropertyValue(n)},n.prototype.mergeFormat=function(n,t){t=!sf.base.isNullOrUndefined(t)&&t;sf.base.isNullOrUndefined(this.getValue("leftIndent"))&&(this.leftIndent=n.getValue("leftIndent"));sf.base.isNullOrUndefined(this.getValue("rightIndent"))&&(this.rightIndent=n.getValue("rightIndent"));sf.base.isNullOrUndefined(this.getValue("firstLineIndent"))&&(this.firstLineIndent=n.getValue("firstLineIndent"));sf.base.isNullOrUndefined(this.getValue("beforeSpacing"))&&(this.beforeSpacing=n.getValue("beforeSpacing"));sf.base.isNullOrUndefined(this.getValue("afterSpacing"))&&(this.afterSpacing=n.getValue("afterSpacing"));sf.base.isNullOrUndefined(this.getValue("lineSpacing"))&&(this.lineSpacing=n.getValue("lineSpacing"));sf.base.isNullOrUndefined(this.getValue("lineSpacingType"))&&(this.lineSpacingType=n.getValue("lineSpacingType"));sf.base.isNullOrUndefined(this.getValue("textAlignment"))&&(this.textAlignment=n.getValue("textAlignment"));sf.base.isNullOrUndefined(this.getValue("outlineLevel"))&&(this.outlineLevel=n.getValue("outlineLevel"));!t&&sf.base.isNullOrUndefined(this.getValue("bidi"))&&(this.bidi=n.getValue("bidi"));sf.base.isNullOrUndefined(this.getValue("contextualSpacing"))&&(this.contextualSpacing=n.getValue("contextualSpacing"));sf.base.isNullOrUndefined(this.getValue("keepWithNext"))&&(this.keepWithNext=n.getValue("keepWithNext"));sf.base.isNullOrUndefined(this.getValue("keepLinesTogether"))&&(this.keepLinesTogether=n.getValue("keepLinesTogether"));sf.base.isNullOrUndefined(this.getValue("widowControl"))&&(this.widowControl=n.getValue("widowControl"));sf.base.isNullOrUndefined(this.listFormat)&&this.listFormat.mergeFormat(n.listFormat)},n.uniqueParagraphFormats=new ei,n.uniqueFormatType=3,n}(),cu=(sr=function(n,t){return(sr=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}sr(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),lu=function(){},fi=function(n){function t(t){var i=n.call(this)||this;return i.ownerBase=t,i.paragraphFormat=new ut(i),i.characterFormat=new p(i),i}return cu(t,n),t.prototype.destroy=function(){this.characterFormat.destroy();this.paragraphFormat.destroy()},t.prototype.copyStyle=function(n){this.name=n.name;this.ownerBase=n.ownerBase;this.type=n.type;this.next=n.next;this.basedOn=n.basedOn;this.link=n.link;this.characterFormat.copyFormat(n.characterFormat);this.paragraphFormat.copyFormat(n.paragraphFormat)},t}(lu),ur=function(n){function t(t){var i=n.call(this)||this;return i.ownerBase=t,i.characterFormat=new p(i),i}return cu(t,n),t.prototype.destroy=function(){this.characterFormat.destroy()},t.prototype.copyStyle=function(n){this.name=n.name;this.ownerBase=n.ownerBase;this.type=n.type;this.next=n.next;this.basedOn=n.basedOn;this.characterFormat.copyFormat(n.characterFormat)},t}(lu),pr=function(){function n(){this.collection=[]}return Object.defineProperty(n.prototype,"length",{get:function(){return this.collection.length},enumerable:!0,configurable:!0}),n.prototype.remove=function(n){this.collection=this.collection.filter(function(t){return t.name!==n.name})},n.prototype.push=function(n){return null!=n&&void 0!==n&&this.collection.push(n),1},n.prototype.getItem=function(n){return this.collection.length>n?this.collection[n]:null},n.prototype.indexOf=function(n){return this.collection.indexOf(n)},n.prototype.contains=function(n){var t=this.collection.indexOf(n);return t>-1&&t<this.collection.length},n.prototype.clear=function(){for(;this.collection.length>0;)this.collection.pop()},n.prototype.findByName=function(n,t){for(var u,i,r=0,f=this.collection;r<f.length;r++)i=f[r],i.name===n&&(u=i,sf.base.isNullOrUndefined(t)||i.type!==t||(u=i));return u},n.prototype.getStyleNames=function(n){return this.collection.filter(function(t){return t.type===n}).map(function(n){return n.name})},n.prototype.getStyles=function(n){for(var u=[],i=0,f=this.collection.filter(function(t){return t.type===n}).map(function(n){return n});i<f.length;i++){var e=f[i],r={},o={characterFormat:{}};t.writeCharacterFormat(o.characterFormat,!0,e.characterFormat);r.name=e.name;r.style=JSON.stringify(o);u.push(r)}return u},n}(),yi=function(){function n(n){this.uniqueShadingFormat=void 0;this.ownerBase=void 0;this.ownerBase=n}return Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this.getPropertyValue("backgroundColor")},set:function(n){this.setPropertyValue("backgroundColor",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"foregroundColor",{get:function(){return this.getPropertyValue("foregroundColor")},set:function(n){this.setPropertyValue("foregroundColor",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textureStyle",{get:function(){return this.getPropertyValue("textureStyle")},set:function(n){this.setPropertyValue("textureStyle",n)},enumerable:!0,configurable:!0}),n.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=y.getPropertyType(n.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueShadingFormat)&&this.uniqueShadingFormat.propertiesHash.containsKey(i))return this.uniqueShadingFormat.propertiesHash.get(i)}return n.getPropertyDefaultValue(t)},n.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=n.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueShadingFormat))this.initializeUniqueShading(t,i);else{var r=y.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,t);if(this.uniqueShadingFormat.propertiesHash.containsKey(r)&&this.uniqueShadingFormat.propertiesHash.get(r)===i)return;this.uniqueShadingFormat=n.uniqueShadingFormats.updateUniqueFormat(this.uniqueShadingFormat,t,i)}},n.getPropertyDefaultValue=function(n){var t=void 0;switch(n){case"backgroundColor":case"foregroundColor":t="empty";break;case"textureStyle":t="TextureNone"}return t},n.prototype.initializeUniqueShading=function(t,i){var r=new h;this.addUniqueShading("backgroundColor",t,i,r);this.addUniqueShading("foregroundColor",t,i,r);this.addUniqueShading("textureStyle",t,i,r);this.uniqueShadingFormat=n.uniqueShadingFormats.addUniqueFormat(r,n.uniqueFormatType)},n.prototype.addUniqueShading=function(t,i,r,u){var f=y.getPropertyType(n.uniqueFormatType,t);t===i?u.add(f,r):u.add(f,n.getPropertyDefaultValue(t))},n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.uniqueShadingFormat)||n.uniqueShadingFormats.remove(this.uniqueShadingFormat);this.uniqueShadingFormat=void 0},n.prototype.cloneFormat=function(){var t=new n(void 0);return t.backgroundColor=this.backgroundColor,t.foregroundColor=this.foregroundColor,t.textureStyle=this.textureStyle,t},n.prototype.copyFormat=function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.uniqueShadingFormat)||(this.backgroundColor=n.backgroundColor,this.foregroundColor=n.foregroundColor,this.textureStyle=n.textureStyle)},n.prototype.hasValue=function(n){if(!sf.base.isNullOrUndefined(this.uniqueShadingFormat)){var t=y.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,n);return this.uniqueShadingFormat.propertiesHash.containsKey(t)}return!1},n.clear=function(){this.uniqueShadingFormats.clear()},n.uniqueShadingFormats=new ei,n.uniqueFormatType=5,n}(),pt=function(){function n(n){this.uniqueTableFormat=void 0;this.borders=new ni(this);this.shading=new yi(this);this.ownerBase=void 0;this.ownerBase=n;this.assignTableMarginValue(5.4,0,5.4,0)}return Object.defineProperty(n.prototype,"allowAutoFit",{get:function(){return this.getPropertyValue("allowAutoFit")},set:function(n){this.setPropertyValue("allowAutoFit",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cellSpacing",{get:function(){return this.getPropertyValue("cellSpacing")},set:function(n){if(n<0||n>264.6)throw new RangeError("The measurement must be between 0 px and 264.6 px.");this.setPropertyValue("cellSpacing",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(n){this.setPropertyValue("bottomMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"tableAlignment",{get:function(){return this.getPropertyValue("tableAlignment")},set:function(n){this.setPropertyValue("tableAlignment",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(n){this.setPropertyValue("leftMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(n){this.setPropertyValue("topMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(n){this.setPropertyValue("rightMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(n){if(n<-1440||n>1440)throw new RangeError("The measurement must be between -1440 px and 1440 px.");this.setPropertyValue("leftIndent",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(n){this.setPropertyValue("preferredWidth",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(n){this.setPropertyValue("preferredWidthType",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(n){this.setPropertyValue("bidi",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"horizontalPositionAbs",{get:function(){return this.getPropertyValue("horizontalPositionAbs")},set:function(n){this.setPropertyValue("horizontalPositionAbs",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"horizontalPosition",{get:function(){return this.getPropertyValue("horizontalPosition")},set:function(n){this.setPropertyValue("horizontalPosition",n)},enumerable:!0,configurable:!0}),n.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=y.getPropertyType(n.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueTableFormat)&&this.uniqueTableFormat.propertiesHash.containsKey(i))return this.uniqueTableFormat.propertiesHash.get(i)}return n.getPropertyDefaultValue(t)},n.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=n.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueTableFormat))this.initializeUniqueTableFormat(t,i);else{var r=y.getPropertyType(this.uniqueTableFormat.uniqueFormatType,t);if(this.uniqueTableFormat.propertiesHash.containsKey(r)&&this.uniqueTableFormat.propertiesHash.get(r)===i)return;this.uniqueTableFormat=n.uniqueTableFormats.updateUniqueFormat(this.uniqueTableFormat,t,i)}},n.prototype.initializeUniqueTableFormat=function(t,i){var r=new h;this.addUniqueTableFormat("allowAutoFit",t,i,r);this.addUniqueTableFormat("cellSpacing",t,i,r);this.addUniqueTableFormat("leftMargin",t,i,r);this.addUniqueTableFormat("topMargin",t,i,r);this.addUniqueTableFormat("bottomMargin",t,i,r);this.addUniqueTableFormat("rightMargin",t,i,r);this.addUniqueTableFormat("leftIndent",t,i,r);this.addUniqueTableFormat("tableAlignment",t,i,r);this.addUniqueTableFormat("preferredWidth",t,i,r);this.addUniqueTableFormat("preferredWidthType",t,i,r);this.addUniqueTableFormat("bidi",t,i,r);this.addUniqueTableFormat("horizontalPositionAbs",t,i,r);this.addUniqueTableFormat("horizontalPosition",t,i,r);this.uniqueTableFormat=n.uniqueTableFormats.addUniqueFormat(r,n.uniqueFormatType)},n.prototype.addUniqueTableFormat=function(t,i,r,u){var f;f=y.getPropertyType(n.uniqueFormatType,t);t===i&&u.add(f,r)},n.getPropertyDefaultValue=function(n){var t=void 0;switch(n){case"allowAutoFit":t=!1;break;case"cellSpacing":t=0;break;case"leftMargin":t=5.4;break;case"topMargin":case"bottomMargin":t=0;break;case"rightMargin":t=5.4;break;case"leftIndent":t=0;break;case"tableAlignment":t="Left";break;case"preferredWidth":t=0;break;case"preferredWidthType":t="Point";break;case"bidi":t=!1;break;case"horizontalPositionAbs":t=null;break;case"horizontalPosition":t=0}return t},n.prototype.assignTableMarginValue=function(n,t,i,r){this.leftMargin=n;this.topMargin=t;this.rightMargin=i;this.bottomMargin=r},n.prototype.initializeTableBorders=function(){this.borders.left.lineStyle="Single";this.borders.left.lineWidth=.5;this.borders.right.lineStyle="Single";this.borders.right.lineWidth=.5;this.borders.top.lineStyle="Single";this.borders.top.lineWidth=.5;this.borders.bottom.lineStyle="Single";this.borders.bottom.lineWidth=.5;this.borders.horizontal.lineStyle="Single";this.borders.horizontal.lineWidth=.5;this.borders.vertical.lineStyle="Single";this.borders.vertical.lineWidth=.5},n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.borders)||this.borders.destroy();sf.base.isNullOrUndefined(this.shading)||this.shading.destroy();sf.base.isNullOrUndefined(this.uniqueTableFormat)||n.uniqueTableFormats.remove(this.uniqueTableFormat);this.uniqueTableFormat=void 0;this.borders=void 0;this.shading=void 0},n.prototype.cloneFormat=function(){var t=new n(void 0);return t.leftIndent=this.leftIndent,t.tableAlignment=this.tableAlignment,t.cellSpacing=this.cellSpacing,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.preferredWidth=this.preferredWidth,t.preferredWidthType=this.preferredWidthType,t.horizontalPositionAbs=this.horizontalPositionAbs,t.horizontalPosition=this.horizontalPosition,t.borders=sf.base.isNullOrUndefined(this.borders)?void 0:this.borders.cloneFormat(),t.shading=sf.base.isNullOrUndefined(this.shading)?void 0:this.shading.cloneFormat(),t.bidi=this.bidi,t.allowAutoFit=this.allowAutoFit,t},n.prototype.hasValue=function(n){if(!sf.base.isNullOrUndefined(this.uniqueTableFormat)){var t=y.getPropertyType(this.uniqueTableFormat.uniqueFormatType,n);return this.uniqueTableFormat.propertiesHash.containsKey(t)}return!1},n.prototype.copyFormat=function(n){sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(n.uniqueTableFormat)||(this.cellSpacing=n.cellSpacing,this.leftMargin=n.leftMargin,this.topMargin=n.topMargin,this.rightMargin=n.rightMargin,this.bottomMargin=n.bottomMargin,this.leftIndent=n.leftIndent,this.tableAlignment=n.tableAlignment,this.preferredWidth=n.preferredWidth,this.preferredWidthType=n.preferredWidthType,this.bidi=n.bidi,this.allowAutoFit=n.allowAutoFit,this.horizontalPosition=n.horizontalPosition,this.horizontalPositionAbs=n.horizontalPositionAbs),sf.base.isNullOrUndefined(n.borders)||(this.borders=new ni(this),this.borders.copyFormat(n.borders)),sf.base.isNullOrUndefined(n.shading)||(this.shading=new yi(this),this.shading.copyFormat(n.shading)))},n.clear=function(){this.uniqueTableFormats.clear()},n.uniqueTableFormats=new ei,n.uniqueFormatType=8,n}(),si=function(){function n(n){this.uniqueCellFormat=void 0;this.borders=new ni(this);this.shading=new yi(this);this.ownerBase=n;this.borders=new ni(this);this.shading=new yi(this)}return Object.defineProperty(n.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(n){this.setPropertyValue("leftMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(n){this.setPropertyValue("rightMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(n){this.setPropertyValue("topMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(n){this.setPropertyValue("bottomMargin",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cellWidth",{get:function(){return this.getPropertyValue("cellWidth")},set:function(n){this.setPropertyValue("cellWidth",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"columnSpan",{get:function(){return this.getPropertyValue("columnSpan")},set:function(n){this.setPropertyValue("columnSpan",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rowSpan",{get:function(){return this.getPropertyValue("rowSpan")},set:function(n){this.setPropertyValue("rowSpan",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(n){this.setPropertyValue("preferredWidth",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"verticalAlignment",{get:function(){return this.getPropertyValue("verticalAlignment")},set:function(n){this.setPropertyValue("verticalAlignment",n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(n){this.setPropertyValue("preferredWidthType",n)},enumerable:!0,configurable:!0}),n.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=y.getPropertyType(n.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueCellFormat)&&this.uniqueCellFormat.propertiesHash.containsKey(i))return this.uniqueCellFormat.propertiesHash.get(i)}return n.getPropertyDefaultValue(t)},n.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=n.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueCellFormat))this.initializeUniqueCellFormat(t,i);else{var r=y.getPropertyType(this.uniqueCellFormat.uniqueFormatType,t);if(this.uniqueCellFormat.propertiesHash.containsKey(r)&&this.uniqueCellFormat.propertiesHash.get(r)===i)return;this.uniqueCellFormat=n.uniqueCellFormats.updateUniqueFormat(this.uniqueCellFormat,t,i)}},n.prototype.initializeUniqueCellFormat=function(t,i){var r=new h;this.addUniqueCellFormat("leftMargin",t,i,r);this.addUniqueCellFormat("topMargin",t,i,r);this.addUniqueCellFormat("bottomMargin",t,i,r);this.addUniqueCellFormat("rightMargin",t,i,r);this.addUniqueCellFormat("cellWidth",t,i,r);this.addUniqueCellFormat("columnSpan",t,i,r);this.addUniqueCellFormat("rowSpan",t,i,r);this.addUniqueCellFormat("preferredWidth",t,i,r);this.addUniqueCellFormat("verticalAlignment",t,i,r);this.addUniqueCellFormat("preferredWidthType",t,i,r);this.uniqueCellFormat=n.uniqueCellFormats.addUniqueFormat(r,n.uniqueFormatType)},n.prototype.addUniqueCellFormat=function(t,i,r,u){var f=y.getPropertyType(n.uniqueFormatType,t);t===i&&u.add(f,r)},n.getPropertyDefaultValue=function(n){var t=void 0;switch(n){case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0;break;case"cellWidth":t=0;break;case"columnSpan":case"rowSpan":t=1;break;case"preferredWidth":t=0;break;case"verticalAlignment":t="Top";break;case"preferredWidthType":t="Point"}return t},n.prototype.containsMargins=function(){return!(sf.base.isNullOrUndefined(this.leftMargin)&&sf.base.isNullOrUndefined(this.rightMargin)&&sf.base.isNullOrUndefined(this.bottomMargin)&&sf.base.isNullOrUndefined(this.topMargin))},n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.borders)||this.borders.destroy();sf.base.isNullOrUndefined(this.shading)||this.shading.destroy();sf.base.isNullOrUndefined(this.uniqueCellFormat)||n.uniqueCellFormats.remove(this.uniqueCellFormat);this.uniqueCellFormat=void 0;this.borders=void 0;this.shading=void 0},n.prototype.cloneFormat=function(){var t=new n(void 0);return t.verticalAlignment=this.verticalAlignment,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.preferredWidth=this.preferredWidth,t.preferredWidthType=this.preferredWidthType,t.cellWidth=this.cellWidth,t.borders=sf.base.isNullOrUndefined(this.borders)?void 0:this.borders.cloneFormat(),t.shading=sf.base.isNullOrUndefined(this.shading)?void 0:this.shading.cloneFormat(),t},n.prototype.hasValue=function(n){if(!sf.base.isNullOrUndefined(this.uniqueCellFormat)){var t=y.getPropertyType(this.uniqueCellFormat.uniqueFormatType,n);return this.uniqueCellFormat.propertiesHash.containsKey(t)}return!1},n.prototype.copyFormat=function(n){sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(n.uniqueCellFormat)||(this.cellWidth=n.cellWidth,this.leftMargin=n.leftMargin,this.topMargin=n.topMargin,this.rightMargin=n.rightMargin,this.bottomMargin=n.bottomMargin,this.preferredWidth=n.preferredWidth,this.columnSpan=n.columnSpan,this.rowSpan=n.rowSpan,this.preferredWidthType=n.preferredWidthType,this.verticalAlignment=n.verticalAlignment),sf.base.isNullOrUndefined(n.shading)||(this.shading=new yi(this),this.shading.copyFormat(n.shading)),sf.base.isNullOrUndefined(n.borders)||(this.borders=new ni(this),this.borders.copyFormat(n.borders)))},n.clear=function(){this.uniqueCellFormats.clear()},n.uniqueCellFormats=new ei,n.uniqueFormatType=4,n}(),oe=function(){function n(n){this.documentHelper=void 0;this.commentStarts=void 0;this.commentEnds=void 0;this.commentsCollection=void 0;this.revisionCollection=void 0;this.isPageBreakInsideTable=!1;this.isParseHeader=!1;this.footnotes=void 0;this.endnotes=void 0;this.isCutPerformed=!1;this.isPaste=!1;this.documentHelper=n;this.editableRanges=new h}return Object.defineProperty(n.prototype,"isPasting",{get:function(){return this.viewer&&this.viewer.owner.isPastingContent},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),n.prototype.convertJsonToDocument=function(n){var i,t,r,u;return this.commentStarts=new h,this.commentEnds=new h,this.commentsCollection=new h,this.revisionCollection=new h,this.footnotes=new tr,this.endnotes=new tr,i=[],t=n,t=_instanceof(t,Object)?t:JSON.parse(t),r=sf.base.isNullOrUndefined(t.characterFormat)?this.viewer.owner.characterFormat:t.characterFormat,this.parseCharacterFormat(r,this.documentHelper.characterFormat),u=sf.base.isNullOrUndefined(t.paragraphFormat)?this.viewer.owner.paragraphFormat:t.paragraphFormat,this.parseParagraphFormat(u,this.documentHelper.paragraphFormat),this.parseDocumentProtection(t),sf.base.isNullOrUndefined(t.defaultTabWidth)||(this.documentHelper.defaultTabWidth=t.defaultTabWidth),sf.base.isNullOrUndefined(t.trackChanges)||(this.documentHelper.owner.showRevisions=t.trackChanges,this.documentHelper.owner.enableTrackChanges=t.trackChanges),sf.base.isNullOrUndefined(t.dontUseHTMLParagraphAutoSpacing)||(this.documentHelper.dontUseHtmlParagraphAutoSpacing=t.dontUseHTMLParagraphAutoSpacing),sf.base.isNullOrUndefined(t.alignTablesRowByRow)||(this.documentHelper.alignTablesRowByRow=t.alignTablesRowByRow),sf.base.isNullOrUndefined(t.background)||(this.documentHelper.backgroundColor=this.getColor(t.background.color)),sf.base.isNullOrUndefined(t.compatibilityMode)||(this.documentHelper.compatibilityMode=t.compatibilityMode),sf.base.isNullOrUndefined(t.abstractLists)||this.parseAbstractList(t,this.documentHelper.abstractLists),sf.base.isNullOrUndefined(t.lists)||this.parseList(t,this.documentHelper.lists),sf.base.isNullOrUndefined(t.styles)||this.parseStyles(t,this.documentHelper.styles),sf.base.isNullOrUndefined(t.comments)||this.parseComments(t,this.documentHelper.comments),sf.base.isNullOrUndefined(t.revisions)||this.parseRevisions(t,this.viewer.owner.revisionsInternal.changes),sf.base.isNullOrUndefined(t.sections)||this.parseSections(t.sections,i),sf.base.isNullOrUndefined(t.customXml)||this.parseCustomXml(t),sf.base.isNullOrUndefined(t.formFieldShading)||(this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading=t.formFieldShading),sf.base.isNullOrUndefined(t.footnotes)||this.parseFootnotes(t.footnotes,this.documentHelper.footnotes),sf.base.isNullOrUndefined(t.endnotes)||this.parseEndtnotes(t.endnotes,this.documentHelper.endnotes),i},n.prototype.parseFootnotes=function(n,t){sf.base.isNullOrUndefined(n.separator)||this.parseBody(n.separator,t.separator);sf.base.isNullOrUndefined(n.continuationNotice)||this.parseBody(n.continuationNotice,t.continuationNotice);sf.base.isNullOrUndefined(n.continuationSeparator)||this.parseBody(n.continuationSeparator,t.continuationSeparator)},n.prototype.parseEndtnotes=function(n,t){sf.base.isNullOrUndefined(n.separator)||this.parseBody(n.separator,t.separator);sf.base.isNullOrUndefined(n.continuationNotice)||this.parseBody(n.continuationNotice,t.continuationNotice);sf.base.isNullOrUndefined(n.continuationSeparator)||this.parseBody(n.continuationSeparator,t.continuationSeparator)},n.prototype.parseCustomXml=function(n){for(var i,t=0;t<n.customXml.length;t++)i=n.customXml[t],this.revisionCollection.containsKey(i.itemID)||this.documentHelper.customXmlData.add(i.itemID,i.xml)},n.prototype.parseDocumentProtection=function(n){sf.base.isNullOrUndefined(n.formatting)||(this.documentHelper.restrictFormatting=n.formatting);sf.base.isNullOrUndefined(n.enforcement)||(this.documentHelper.isDocumentProtected=n.enforcement);sf.base.isNullOrUndefined(n.protectionType)||(this.documentHelper.protectionType=n.protectionType);sf.base.isNullOrUndefined(n.hashValue)||(this.documentHelper.hashValue=n.hashValue);sf.base.isNullOrUndefined(n.saltValue)||(this.documentHelper.saltValue=n.saltValue)},n.prototype.parseStyles=function(n,t){for(var i=0;i<n.styles.length;i++)sf.base.isNullOrUndefined(this.documentHelper.styles.findByName(n.styles[i].name))&&this.parseStyle(n,n.styles[i],t)},n.prototype.parseRevisions=function(n,t){for(var i,r,e,f,u=0;u<n.revisions.length;u++)if(i=n.revisions[u],!sf.base.isNullOrUndefined(i.revisionId)&&!sf.base.isNullOrUndefined(i.revisionType)){if(r=this.parseRevision(i),e=!0,!this.documentHelper.owner.sfdtExportModule.copyWithTrackChange&&this.isPaste){if("Insertion"===i.revisionType&&this.isPaste&&this.documentHelper.owner.enableTrackChanges)continue;this.revisionCollection.containsKey(i.revisionId)||this.revisionCollection.add(i.revisionId,r)}else this.revisionCollection.add(i.revisionId,r);for(f=0;f<t.length;f++)t[f].revisionID===r.revisionID&&(e=!1);e&&t.push(r)}this.documentHelper.revisionsInternal=this.revisionCollection;this.documentHelper.owner.sfdtExportModule&&(this.documentHelper.owner.sfdtExportModule.copyWithTrackChange=!1)},n.prototype.parseRevision=function(n){if(!sf.base.isNullOrUndefined(n)){var t=new ii(this.viewer.owner,n.author,n.date);return t.revisionID=n.revisionId,t.revisionType=n.revisionType,t}},n.prototype.checkAndApplyRevision=function(n,t){var i,r,u;if(!sf.base.isNullOrUndefined(n.revisionIds)&&n.revisionIds.length>0)for(i=0;i<n.revisionIds.length;i++)r=n.revisionIds[i],this.revisionCollection.containsKey(r)&&(u=this.revisionCollection.get(r),_instanceof(t,ut)||u.range.push(t),t.revisions.push(u))},n.prototype.parseComments=function(n,t){for(var e,i,r,u=0,f=0;f<n.comments.length;f++){for(e=n.comments[f],i=void 0,i=this.parseComment(e,i);u<e.replyComments.length;)r=void 0,(r=this.parseComment(e.replyComments[u],r)).ownerComment=i,r.isReply=!0,i.replyComments.push(r),this.commentsCollection.add(r.commentId,r),u++;this.commentsCollection.add(i.commentId,i);t.push(i);u=0}},n.prototype.parseComment=function(n,t){return(t=new rr(n.date)).author=n.author,t.initial=n.initial,t.commentId=n.commentId,t.isResolved=n.done,t.text=this.parseCommentText(n.blocks),t},n.prototype.parseCommentText=function(n){for(var r,i="",t=0;t<n.length;t++)for(0!==t&&(i+="\n"),r=0;r<n[t].inlines.length;r++)i+=n[t].inlines[r].text;return i},n.prototype.parseStyle=function(n,t,i){var r,e,o,u,c,l,f,s,h;sf.base.isNullOrUndefined(t.type)||(("Paragraph"===t.type&&((r=new fi).type="Paragraph"),"Character"===t.type&&((r=new ur).type="Character"),sf.base.isNullOrUndefined(t.name)||(r.name=t.name),i.push(r),sf.base.isNullOrUndefined(t.basedOn))||(e=i.findByName(t.basedOn),sf.base.isNullOrUndefined(e)?(o=this.getStyle(t.basedOn,n),u=void 0,u=sf.base.isNullOrUndefined(o)||o.type!==r.type?"Paragraph"===r.type?JSON.parse('{"type":"Paragraph","name":"Normal","next":"Normal"}'):JSON.parse('{"type": "Character","name": "Default Paragraph Font"}'):o,this.parseStyle(n,u,i),r.basedOn=i.findByName(u.name)):e.type===r.type&&(r.basedOn=e)),sf.base.isNullOrUndefined(t.link)||(c=i.findByName(t.link),l=this.getStyle(t.link,n),u=void 0,sf.base.isNullOrUndefined(c)?(sf.base.isNullOrUndefined(l)?(f={},f.characterFormat=t.characterFormat,f.name=t.name+" Char",f.type="Character",f.basedOn="Normal"===t.basedOn?"Default Paragraph Font":t.basedOn+" Char",u=f):u=l,this.parseStyle(n,u,i),r.link=sf.base.isNullOrUndefined(i.findByName(u.name))?t.link:i.findByName(u.name)):r.link=c),(sf.base.isNullOrUndefined(t.characterFormat)||this.parseCharacterFormat(t.characterFormat,r.characterFormat),sf.base.isNullOrUndefined(t.paragraphFormat)||this.parseParagraphFormat(t.paragraphFormat,r.paragraphFormat),sf.base.isNullOrUndefined(t.next))||(t.next===t.name?r.next=r:(s=i.findByName(t.next),sf.base.isNullOrUndefined(s)||s.type!==r.type?(h=this.getStyle(t.next,n),sf.base.isNullOrUndefined(h)?r.next=r:(this.parseStyle(n,h,i),r.next=i.findByName(h.name))):r.next=s)))},n.prototype.getStyle=function(n,t){for(var i=0;i<t.styles.length;i++)if(t.styles[i].name===n)return t.styles[i]},n.prototype.parseAbstractList=function(n,t){for(var r,i,f,e,o,u=0;u<n.abstractLists.length;u++)if(r=new wi,i=n.abstractLists[u],t.push(r),!sf.base.isNullOrUndefined(i)&&(sf.base.isNullOrUndefined(i.abstractListId)||(r.abstractListId=i.abstractListId),!sf.base.isNullOrUndefined(i.levels)))for(f=0;f<i.levels.length;f++)e=i.levels[f],sf.base.isNullOrUndefined(e)||(o=this.parseListLevel(e,r),r.levels.push(o))},n.prototype.parseListLevel=function(n,t){var i=new li(t);return"Bullet"===n.listLevelPattern?(i.listLevelPattern="Bullet",i.numberFormat=sf.base.isNullOrUndefined(n.numberFormat)?"":n.numberFormat):(i.listLevelPattern=n.listLevelPattern,i.startAt=n.startAt,i.numberFormat=sf.base.isNullOrUndefined(n.numberFormat)?"":n.numberFormat,i.restartLevel=n.restartLevel>=0?n.restartLevel:n.levelNumber),i.followCharacter=n.followCharacter,this.parseCharacterFormat(n.characterFormat,i.characterFormat),this.parseParagraphFormat(n.paragraphFormat,i.paragraphFormat),i},n.prototype.parseList=function(n,t){for(var r,i,u=0;u<n.lists.length;u++)r=new pi,i=n.lists[u],sf.base.isNullOrUndefined(i.abstractListId)||(r.abstractListId=i.abstractListId,r.abstractList=this.documentHelper.getAbstractListById(i.abstractListId)),t.push(r),sf.base.isNullOrUndefined(i.listId)||(r.listId=i.listId),i.hasOwnProperty("levelOverrides")&&this.parseLevelOverride(i.levelOverrides,r)},n.prototype.parseLevelOverride=function(n,t){var u,i,r;if(!sf.base.isNullOrUndefined(n))for(u=0;u<n.length;u++)i=new nr,r=n[u],i.startAt=r.startAt,i.levelNumber=r.levelNumber,sf.base.isNullOrUndefined(r.overrideListLevel)||(i.overrideListLevel=this.parseListLevel(r.overrideListLevel,i)),t.levelOverrides.push(i)},n.prototype.parseSections=function(n,t){for(var i,r,f,u=0;u<n.length;u++){for(i=new c,i.sectionFormat=new dt(i),i.index=u,r=n[u],sf.base.isNullOrUndefined(r.sectionFormat)||this.parseSectionFormat(r.sectionFormat,i.sectionFormat),sf.base.isNullOrUndefined(r.headersFooters)&&(r.headersFooters={}),this.documentHelper.headersFooters.push(this.parseHeaderFooter(r.headersFooters,this.documentHelper.headersFooters)),this.isParseHeader=!1,this.parseTextBody(r.blocks,i,u+1<n.length),f=0;f<i.childWidgets.length;f++)i.childWidgets[f].containerWidget=i;t.push(i)}},n.prototype.parseHeaderFooter=function(n){var t,i,r,u,f,e,o;return this.isParseHeader=!0,t={},sf.base.isNullOrUndefined(n.header)||(i=new ct("OddHeader"),t[0]=i,this.parseTextBody(n.header.blocks,i)),sf.base.isNullOrUndefined(n.footer)||(r=new ct("OddFooter"),t[1]=r,this.parseTextBody(n.footer.blocks,r)),sf.base.isNullOrUndefined(n.evenHeader)||(u=new ct("EvenHeader"),t[2]=u,this.parseTextBody(n.evenHeader.blocks,u)),sf.base.isNullOrUndefined(n.evenFooter)||(f=new ct("EvenFooter"),t[3]=f,this.parseTextBody(n.evenFooter.blocks,f)),sf.base.isNullOrUndefined(n.firstPageHeader)||(e=new ct("FirstPageHeader"),t[4]=e,this.parseTextBody(n.firstPageHeader.blocks,e)),sf.base.isNullOrUndefined(n.firstPageFooter)||(o=new ct("FirstPageFooter"),t[5]=o,this.parseTextBody(n.firstPageFooter.blocks,o)),t},n.prototype.parseTextBody=function(n,t,i){this.parseBody(n,t.childWidgets,t,i)},n.prototype.addCustomStyles=function(n){if(!sf.base.isNullOrUndefined(n.styles))for(var t=0;t<n.styles.length;t++)void 0===this.documentHelper.styles.findByName(n.styles[t].name)&&this.parseStyle(n,n.styles[t],this.documentHelper.styles)},n.prototype.parseBody=function(n,t,i,r,e){var y,o,d,s,b,c,v,l,a,h,g;if(!sf.base.isNullOrUndefined(n))for(y=0;y<n.length;y++){if(o=n[y],d=!1,o.hasOwnProperty("inlines"))s=new u,(s.characterFormat=new p(s),s.paragraphFormat=new ut(s),o.inlines.length>0&&(d=this.parseParagraph(o.inlines,s,!1)),!r||o!==n[n.length-1]||d)?(this.parseCharacterFormat(o.characterFormat,s.characterFormat),this.parseParagraphFormat(o.paragraphFormat,s.paragraphFormat),b=void 0,sf.base.isNullOrUndefined(o.paragraphFormat)||sf.base.isNullOrUndefined(o.paragraphFormat.styleName)||(b=this.documentHelper.styles.findByName(o.paragraphFormat.styleName,"Paragraph"),sf.base.isNullOrUndefined(b)||s.paragraphFormat.applyStyle(b)),t.push(s)):r&&1===n.length&&t.push(s),s.index=t.length-1,s.containerWidget=i;else if(o.hasOwnProperty("rows"))this.parseTable(o,t,t.length,i);else if(o.hasOwnProperty("contentControlProperties"))for(c=new w("Block"),v=new w("Block"),this.parseContentControlProperties(o.contentControlProperties,c.contentControlProperties),v.contentControlProperties=c.contentControlProperties,c.type=0,v.type=1,this.parseBody(o.blocks,t,i,r,c.contentControlProperties),l=0;l<2;l++)a=t.length<o.blocks.length?t[0]:0===l?t[t.length-o.blocks.length]:t[t.length-1],h=void 0,_instanceof(a,u)?h=a:_instanceof(a,f)&&(h=0===l?a.firstChild.firstChild.firstChild:a.lastChild.lastChild.lastChild),sf.base.isNullOrUndefined(h)||0!==h.childWidgets.length||(g=new k(h),h.childWidgets.push(g)),0===l?(h.firstChild.children.splice(0,0,c),c.line=h.firstChild):(h.lastChild.children.push(v),v.line=h.lastChild);sf.base.isNullOrUndefined(e)||(t[t.length-1].contentControlProperties=e)}},n.prototype.parseTable=function(n,t,i,r){var o=new f,h,e,l,c,u,nt,g,y,p,v,b,d;for(o.index=i,o.tableFormat=new pt(o),sf.base.isNullOrUndefined(n.tableFormat)||this.parseTableFormat(n.tableFormat,o.tableFormat),o.title=n.title,o.description=n.description,this.parseTablePositioning(n,o),h=0;h<n.rows.length;h++){if(e=new a,e.rowFormat=new ti(e),l=n.rows[h],sf.base.isNullOrUndefined(l.contentControlProperties)||(e.contentControlProperties=new ar("Row"),this.parseContentControlProperties(l.contentControlProperties,e.contentControlProperties)),l.hasOwnProperty("rowFormat"))for(this.parseRowFormat(l.rowFormat,e.rowFormat),this.parseRowGridValues(l,e.rowFormat),this.parseRowGridValues(l.rowFormat,e.rowFormat),e.index=h,c=0;c<n.rows[h].cells.length;c++){for(u=new s,u.cellFormat=new si(u),sf.base.isNullOrUndefined(n.rows[h].cells[c].contentControlProperties)||(u.contentControlProperties=new ar("Cell"),this.parseContentControlProperties(n.rows[h].cells[c].contentControlProperties,u.contentControlProperties)),e.childWidgets.push(u),u.containerWidget=e,u.index=c,u.rowIndex=h,u.columnIndex=c,n.rows[h].cells[c].hasOwnProperty("cellFormat")&&this.parseCellFormat(n.rows[h].cells[c].cellFormat,u.cellFormat),nt=n.rows[h].cells[c].blocks,g=0;g<nt.length;g++)nt[g].hasOwnProperty("rows")&&(o.isContainInsideTable=!0);(this.isPageBreakInsideTable=!0,this.parseTextBody(n.rows[h].cells[c].blocks,u,!1),sf.base.isNullOrUndefined(u.contentControlProperties))||(y=new w("Cell"),p=new w("Cell"),(y.contentControlProperties=u.contentControlProperties,p.contentControlProperties=u.contentControlProperties,y.type=0,p.type=1,0===u.firstChild.childWidgets.length)&&(v=new k(u.firstChild),u.firstChild.childWidgets.push(v)),y.line=u.firstChild.firstChild,u.firstChild.firstChild.children.splice(0,0,y),p.line=u.lastChild.lastChild,u.lastChild.lastChild.children.push(p));sf.base.isNullOrUndefined(e.contentControlProperties)||(e.firstChild===u?(b=new w("Row"),(b.contentControlProperties=e.contentControlProperties,b.type=0,0===u.firstChild.childWidgets.length)&&(v=new k(u.firstChild),u.firstChild.childWidgets.push(v)),b.line=u.firstChild.firstChild,u.firstChild.firstChild.children.splice(0,0,b)):e.lastChild===u&&(d=new w("Row"),(d.contentControlProperties=e.contentControlProperties,d.type=1,0===u.lastChild.childWidgets.length)&&(v=new k(u.lastChild),u.lastChild.childWidgets.push(v)),d.line=u.lastChild.lastChild,u.lastChild.lastChild.children.push(d)));this.isPageBreakInsideTable=!1}o.childWidgets.push(e);e.containerWidget=o}o.containerWidget=r;t.push(o);o.isGridUpdated=!1},n.prototype.parseTablePositioning=function(n,i){i.wrapTextAround=!sf.base.isNullOrUndefined(n.wrapTextAround)&&n.wrapTextAround;i.wrapTextAround&&(i.positioning=new vf,i.positioning.allowOverlap=n.positioning.allowOverlap,i.positioning.distanceBottom=t.convertPointToPixel(n.positioning.distanceBottom),i.positioning.distanceLeft=t.convertPointToPixel(n.positioning.distanceLeft),i.positioning.distanceRight=t.convertPointToPixel(n.positioning.distanceRight),i.positioning.distanceTop=t.convertPointToPixel(n.positioning.distanceTop),sf.base.isNullOrUndefined(n.positioning.verticalAlignment)||(i.positioning.verticalAlignment=n.positioning.verticalAlignment),sf.base.isNullOrUndefined(n.positioning.verticalOrigin)||(i.positioning.verticalOrigin=n.positioning.verticalOrigin),i.positioning.verticalPosition=n.positioning.verticalPosition,sf.base.isNullOrUndefined(n.positioning.horizontalAlignment)||(i.positioning.horizontalAlignment=n.positioning.horizontalAlignment),sf.base.isNullOrUndefined(n.positioning.horizontalOrigin)||(i.positioning.horizontalOrigin=n.positioning.horizontalOrigin),i.positioning.horizontalPosition=n.positioning.horizontalPosition)},n.prototype.parseRowGridValues=function(n,t){sf.base.isNullOrUndefined(n.gridBefore)||(t.gridBefore=n.gridBefore);sf.base.isNullOrUndefined(n.gridBeforeWidth)||(t.gridBeforeWidth=n.gridBeforeWidth);sf.base.isNullOrUndefined(n.gridBeforeWidthType)||(t.gridBeforeWidthType=n.gridBeforeWidthType);sf.base.isNullOrUndefined(n.gridAfter)||(t.gridAfter=n.gridAfter);sf.base.isNullOrUndefined(n.gridAfterWidth)||(t.gridAfterWidth=n.gridAfterWidth);sf.base.isNullOrUndefined(n.gridAfterWidthType)||(t.gridAfterWidthType=n.gridAfterWidthType)},n.prototype.parseContentControlProperties=function(n,t){var i,r;if(sf.base.isNullOrUndefined(n.lockContentControl)||(t.lockContentControl=n.lockContentControl),sf.base.isNullOrUndefined(n.lockContents)||(t.lockContents=n.lockContents),sf.base.isNullOrUndefined(n.tag)||(t.tag=n.tag),sf.base.isNullOrUndefined(n.color)||(t.color=n.color),sf.base.isNullOrUndefined(n.title)||(t.title=n.title),sf.base.isNullOrUndefined(n.appearance)||(t.appearance=n.appearance),sf.base.isNullOrUndefined(n.type)||(t.type=n.type),sf.base.isNullOrUndefined(n.hasPlaceHolderText)||(t.hasPlaceHolderText=n.hasPlaceHolderText),sf.base.isNullOrUndefined(n.multiline)||(t.multiline=n.multiline),sf.base.isNullOrUndefined(n.isTemporary)||(t.isTemporary=n.isTemporary),sf.base.isNullOrUndefined(n.characterFormat)||this.parseCharacterFormat(n.characterFormat,t.characterFormat),"CheckBox"===t.type)sf.base.isNullOrUndefined(n.isChecked)||(t.isChecked=n.isChecked),sf.base.isNullOrUndefined(n.uncheckedState)||(t.uncheckedState=new nu,t.uncheckedState.font=n.uncheckedState.font,t.uncheckedState.value=n.uncheckedState.value),sf.base.isNullOrUndefined(n.checkedState)||(t.checkedState=new nu,t.checkedState.font=n.checkedState.font,t.checkedState.value=n.checkedState.value);else if("Date"===t.type)sf.base.isNullOrUndefined(n.dateCalendarType)||(t.dateCalendarType=n.dateCalendarType),sf.base.isNullOrUndefined(n.dateStorageFormat)||(t.dateStorageFormat=n.dateStorageFormat),sf.base.isNullOrUndefined(n.dateDisplayLocale)||(t.dateDisplayLocale=n.dateDisplayLocale),sf.base.isNullOrUndefined(n.dateDisplayFormat)||(t.dateDisplayFormat=n.dateDisplayFormat);else if(("ComboBox"===t.type||"DropDownList"===t.type)&&!sf.base.isNullOrUndefined(n.contentControlListItems))for(i=0;i<n.contentControlListItems.length;i++)r=new yf,r.displayText=n.contentControlListItems[i].displayText,r.value=n.contentControlListItems[i].value,t.contentControlListItems.push(r);sf.base.isNullOrUndefined(n.xmlMapping)||(t.xmlMapping=new pf,t.xmlMapping.isMapped=n.xmlMapping.isMapped,t.xmlMapping.isWordMl=n.xmlMapping.isWordMl,sf.base.isNullOrUndefined(n.xmlMapping.prefixMapping)||(t.xmlMapping.prefixMapping=n.xmlMapping.prefixMapping),t.xmlMapping.xPath=n.xmlMapping.xPath,t.xmlMapping.storeItemId=n.xmlMapping.storeItemId,sf.base.isNullOrUndefined(n.xmlMapping.customXmlPart)||(t.xmlMapping.customXmlPart=new wf,t.xmlMapping.customXmlPart.id=n.xmlMapping.customXmlPart.id,t.xmlMapping.customXmlPart.xml=n.xmlMapping.customXmlPart.xml))},n.prototype.parseParagraph=function(n,u,f,o){var vi=!1,s,it,d,y,a,ri,h,yi,pi,ft,tt,l,ui,rt,hi,fi,li,gt,ai,ei,ut,b,at,pt,c,wt,si,st,dt,ni,ti;sf.base.isNullOrUndefined(o)?o=new k(u):vi=!0;for(var lt,ht=!1,ii=this.viewer.owner.enableTrackChanges,ct=0;ct<n.length;ct++)if(s=n[ct],s.hasOwnProperty("text")){if(it=void 0,this.documentHelper.isPageField)(it=new ci).fieldBegin=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1];else if("\t"===s.text)it=new oi;else{if("\f"===s.text&&this.isPageBreakInsideTable)continue;it=new i}if(it.characterFormat=new p(it),this.parseCharacterFormat(s.characterFormat,it.characterFormat,f),this.applyCharacterStyle(s,it),it.text=s.text,this.documentHelper.owner.parser.isPaste&&!this.isCutPerformed){if(!sf.base.isNullOrUndefined(s.revisionIds))for(d=0;d<s.revisionIds.length;d++)if(this.revisionCollection.containsKey(s.revisionIds[d])){if(ii&&(lt=this.revisionCollection.get(s.revisionIds[d])),!sf.base.isNullOrUndefined(lt)&&!sf.base.isNullOrUndefined(o.children[ct-1].revisions[d])&&(!ii||ii&&"Deletion"===lt.revisionType)&&lt.revisionID===s.revisionIds[d]){s.revisionIds[d]=o.children[ct-1].revisions[d].revisionID;this.checkAndApplyRevision(s,it);continue}ii||(lt=this.documentHelper.revisionsInternal.get(s.revisionIds[d]));this.documentHelper.owner.editorModule.insertRevision(it,lt.revisionType,lt.author);s.revisionIds[d]=it.revisions[d].revisionID}}else this.checkAndApplyRevision(s,it);it.line=o;o.children.push(it);ht=!0}else if(s.hasOwnProperty("footnoteType")){for(y=new yt,y.line=o,y.footnoteType=s.footnoteType,"Footnote"===y.footnoteType?this.documentHelper.footnoteCollection.push(y):this.documentHelper.endnoteCollection.push(y),y.symbolCode=s.symbolCode,y.symbolFontName=s.symbolFontName,y.customMarker=s.customMarker,y.characterFormat=new p(y),this.parseCharacterFormat(s.characterFormat,y.characterFormat,f),this.applyCharacterStyle(s,y),this.parseBody(s.blocks,y.blocks,void 0,!1),o.children.push(y),d=0;d<y.blocks.length;d++)y.blocks[d].footNoteReference=y;ht=!0}else if(s.hasOwnProperty("chartType"))this.documentHelper.owner.editor&&(this.documentHelper.owner.editor.chartType=!0),a=new ir,a.title=s.chartTitle,a.type=s.chartType,a.chartGapWidth=s.gapWidth,a.chartOverlap=s.overlap,this.parseChartTitleArea(s.chartTitleArea,a.chartTitleArea),this.parseChartArea(s.chartArea,a.chartArea),this.parseChartArea(s.plotArea,a.chartPlotArea),this.parseChartLegend(s.chartLegend,a.chartLegend),this.parseChartData(s,a),this.parseChartCategoryAxis(s.chartPrimaryCategoryAxis,a.chartPrimaryCategoryAxis),this.parseChartCategoryAxis(s.chartPrimaryValueAxis,a.chartPrimaryValueAxis),null!=s.chartDataTable&&this.parseChartDataTable(s.chartDataTable,a.chartDataTable),a.line=o,o.children.push(a),a.height=t.convertPointToPixel(s.height),a.width=t.convertPointToPixel(s.width),ri=new sf.officechart.ChartComponent,ri.chartRender(s),a.officeChart=ri,ri.chart.appendTo(a.targetElement),ht=!0;else if(s.hasOwnProperty("imageString"))h=new v(n[ct].isInlineImage),h.isMetaFile=n[ct].isMetaFile,h.isCompressed=n[ct].isCompressed,h.metaFileImageString=n[ct].metaFileImageString,h.characterFormat=new p(h),h.line=o,this.checkAndApplyRevision(s,h),o.children.push(h),yi=t.formatClippedString(s.imageString).formatClippedString,pi=this.validateImageUrl(yi),h.imageString=pi?s.imageString:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC",h.width=t.convertPointToPixel(s.width),h.height=t.convertPointToPixel(s.height),h.top=s.top,h.left=s.left,h.bottom=s.bottom,h.right=s.right,h.cropHeightScale=s.getimageheight,h.cropWidthScale=s.getimagewidth,h.name=s.name,h.alternativeText=s.alternativeText,h.title=s.title,h.visible=s.visible,h.widthScale=s.widthScale,h.heightScale=s.heightScale,h.verticalPosition=t.convertPointToPixel(s.verticalPosition),h.verticalOrigin=s.verticalOrigin,h.verticalAlignment=s.verticalAlignment,h.horizontalPosition=t.convertPointToPixel(s.horizontalPosition),h.horizontalOrigin=s.horizontalOrigin,h.horizontalAlignment=s.horizontalAlignment,h.allowOverlap=s.allowOverlap,h.textWrappingStyle=sf.base.isNullOrUndefined(s.textWrappingStyle)?"Inline":s.textWrappingStyle,h.textWrappingType=s.textWrappingType,h.zOrderPosition=s.zOrderPosition,h.layoutInCell=s.layoutInCell,"Inline"!==h.textWrappingStyle&&u.floatingElements.push(h),this.parseCharacterFormat(s.characterFormat,h.characterFormat),ht=!0;else if(s.hasOwnProperty("hasFieldEnd")||s.hasOwnProperty("fieldType")&&0===s.fieldType)ft=new r(0),(this.parseCharacterFormat(s.characterFormat,ft.characterFormat,f),this.applyCharacterStyle(s,ft),ft.fieldCodeType=s.fieldCodeType,ft.hasFieldEnd=s.hasFieldEnd,s.hasOwnProperty("formFieldData"))&&(tt=void 0,s.formFieldData.hasOwnProperty("textInput")?((tt=new vt).type=s.formFieldData.textInput.type,tt.maxLength=s.formFieldData.textInput.maxLength,tt.defaultValue=s.formFieldData.textInput.defaultValue,tt.format=s.formFieldData.textInput.format):s.formFieldData.hasOwnProperty("checkBox")?((tt=new bt).sizeType=s.formFieldData.checkBox.sizeType,tt.size=s.formFieldData.checkBox.size,tt.defaultValue=s.formFieldData.checkBox.defaultValue,tt.checked=s.formFieldData.checkBox.checked):((tt=new kt).dropdownItems=s.formFieldData.dropDownList.dropDownItems,tt.selectedIndex=s.formFieldData.dropDownList.selectedIndex),tt.name=s.formFieldData.name,tt.enabled=s.formFieldData.enabled,tt.helpText=s.formFieldData.helpText,tt.statusText=s.formFieldData.statusText,ft.formFieldData=tt,this.documentHelper.formFields.push(ft)),this.documentHelper.fieldStacks.push(ft),this.checkAndApplyRevision(s,ft),ft.line=o,this.documentHelper.fields.push(ft),o.children.push(ft);else if(s.hasOwnProperty("fieldType"))l=void 0,2===s.fieldType?(l=new r(2),this.fieldSeparator=l,this.documentHelper.fieldStacks.length>0)&&(l.fieldBegin=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1],l.fieldBegin.fieldSeparator=l,o.children.length>=2)&&(ui=this.containsFieldBegin(o),!sf.base.isNullOrUndefined(ui)&&_instanceof(ui,i)&&ui.text.match("PAGE")&&(this.documentHelper.isPageField=!0)):1===s.fieldType&&(l=new r(1),this.parseCharacterFormat(s.characterFormat,l.characterFormat,f),this.applyCharacterStyle(s,l),this.checkAndApplyRevision(s,l),this.documentHelper.fieldStacks.length>0&&(l.fieldBegin=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1],l.fieldBegin.fieldEnd=l),!sf.base.isNullOrUndefined(l.fieldBegin)&&l.fieldBegin.fieldSeparator&&(l.fieldSeparator=l.fieldBegin.fieldSeparator,l.fieldBegin.fieldSeparator.fieldEnd=l,ht=!0),this.documentHelper.fieldStacks.splice(this.documentHelper.fieldStacks.length-1,1),this.fieldSeparator=void 0,this.documentHelper.isPageField=!1,this.documentHelper.fieldCollection.push(l.fieldBegin)),l.line=o,o.children.push(l);else if(s.hasOwnProperty("bookmarkType"))rt=void 0,((rt=new e(s.bookmarkType)).name=s.name,o.children.push(rt),rt.line=o,!this.isParseHeader||this.isPaste)&&(0===s.bookmarkType?(hi=this.isPaste&&!this.documentHelper.bookmarks.containsKey(rt.name),!this.isPaste||hi?this.documentHelper.bookmarks.add(rt.name,rt):hi||o.children.splice(o.children.indexOf(rt),1)):1===s.bookmarkType&&this.documentHelper.bookmarks.containsKey(rt.name)&&(fi=this.documentHelper.bookmarks.get(rt.name),li=this.isPaste&&sf.base.isNullOrUndefined(fi.reference),!this.isPaste||li?(fi.reference=rt,rt.reference=fi):li||o.children.splice(o.children.indexOf(rt),1))),0!==rt.name.indexOf("_")&&(ht=!0);else if(s.hasOwnProperty("editRangeId"))s.hasOwnProperty("editableRangeStart")?(gt=new ot,this.editableRanges.containsKey(s.editRangeId)&&(ai=this.editableRanges.get(s.editRangeId),gt.editRangeStart=ai,ai.editRangeEnd=gt,this.editableRanges.remove(s.editRangeId)),o.children.push(gt),gt.line=o):(ei=this.parseEditableRangeStart(s),o.children.push(ei),ei.line=o,this.editableRanges.containsKey(s.editRangeId)||this.editableRanges.add(s.editRangeId,ei)),ht=!0;else if(s.hasOwnProperty("commentId")&&!this.isPaste)ut=s.commentId,b=void 0,this.commentStarts.containsKey(ut)&&this.commentStarts.get(ut),(this.commentEnds.containsKey(ut)&&this.commentEnds.get(ut),s.hasOwnProperty("commentCharacterType"))&&(0===s.commentCharacterType?(at=new g(0),at.commentId=ut,this.commentStarts.containsKey(ut)||this.commentStarts.add(ut,at),at.line=o,o.children.push(at),b=this.commentsCollection.get(ut),sf.base.isNullOrUndefined(b)||(b.commentStart=at,at.comment=b)):(pt=new g(1),pt.commentId=ut,this.commentEnds.containsKey(ut)||this.commentEnds.add(ut,pt),pt.line=o,o.children.push(pt),b=this.commentsCollection.get(ut),sf.base.isNullOrUndefined(b)||(b.commentEnd=pt,pt.comment=b)),!sf.base.isNullOrUndefined(b)&&b.isReply&&(sf.base.isNullOrUndefined(b.ownerComment.commentStart)&&(b.ownerComment.commentStart=b.commentStart),sf.base.isNullOrUndefined(b.ownerComment.commentEnd)&&(b.ownerComment.commentEnd=b.commentEnd)));else if(s.hasOwnProperty("shapeId"))c=new nt,(c.shapeId=s.shapeId,c.name=s.name,c.alternativeText=s.alternativeText,c.title=s.title,c.visible=s.visible,c.width=t.convertPointToPixel(s.width),c.height=t.convertPointToPixel(s.height),c.widthScale=s.widthScale,c.heightScale=s.heightScale,c.verticalPosition=t.convertPointToPixel(s.verticalPosition),c.verticalOrigin=s.verticalOrigin,c.verticalAlignment=s.verticalAlignment,c.verticalRelativePercent=s.verticalRelativePercent,c.horizontalPosition=t.convertPointToPixel(s.horizontalPosition),c.horizontalOrigin=s.horizontalOrigin,c.horizontalAlignment=s.horizontalAlignment,c.horizontalRelativePercent=s.horizontalRelativePercent,c.zOrderPosition=s.zOrderPosition,c.allowOverlap=s.allowOverlap,c.textWrappingStyle=sf.base.isNullOrUndefined(s.textWrappingStyle)?"InFrontOfText":s.textWrappingStyle,c.textWrappingType=s.textWrappingType,c.distanceBottom=t.convertPointToPixel(s.distanceBottom),c.distanceLeft=t.convertPointToPixel(s.distanceLeft),c.distanceRight=t.convertPointToPixel(s.distanceRight),c.distanceTop=t.convertPointToPixel(s.distanceTop),c.layoutInCell=s.layoutInCell,c.lockAnchor=s.lockAnchor,c.autoShapeType=s.autoShapeType,s.hasOwnProperty("lineFormat"))&&(wt=new bf,wt.line=s.lineFormat.line,wt.lineFormatType=s.lineFormat.lineFormatType,wt.color=s.lineFormat.color,wt.weight=s.lineFormat.weight,wt.dashStyle=s.lineFormat.lineStyle,c.lineFormat=wt),s.hasOwnProperty("fillFormat")&&(si=new kf,si.color=s.fillFormat.color,si.fill=s.fillFormat.fill,c.fillFormat=si),s.hasOwnProperty("textFrame")&&(st=new et,st.textVerticalAlignment=s.textFrame.textVerticalAlignment,st.marginLeft=s.textFrame.leftMargin,st.marginRight=s.textFrame.rightMargin,st.marginTop=s.textFrame.topMargin,st.marginBottom=s.textFrame.bottomMargin,this.parseBody(s.textFrame.blocks,st.childWidgets,st),c.textFrame=st,st.containerShape=c),c.line=o,o.children.push(c),"Inline"!==c.textWrappingStyle&&u.floatingElements.push(c);else if(s.hasOwnProperty("contentControlProperties")){for(dt=new w("Inline"),ni=new w("Inline"),this.parseContentControlProperties(s.contentControlProperties,dt.contentControlProperties),ni.contentControlProperties=dt.contentControlProperties,dt.line=o,ni.line=o,dt.type=0,ni.type=1,o.children.push(dt),this.parseParagraph(s.inlines,u,f,o),ti=o.children[o.children.length-1];!_instanceof(ti,w);)ti.contentControlProperties=dt.contentControlProperties,ti=ti.previousElement;o.children.push(ni);ht=!0}return this.isCutPerformed=!1,vi||u.childWidgets.push(o),ht},n.prototype.applyCharacterStyle=function(n,t){if(!sf.base.isNullOrUndefined(n.characterFormat)&&!sf.base.isNullOrUndefined(n.characterFormat.styleName)){var i=this.documentHelper.styles.findByName(n.characterFormat.styleName,"Character");t.characterFormat.applyStyle(i)}},n.prototype.parseEditableRangeStart=function(n){var t=new ht;return sf.base.isNullOrUndefined(n.columnFirst)||(t.columnFirst=n.columnFirst),sf.base.isNullOrUndefined(n.columnLast)||(t.columnLast=n.columnLast),sf.base.isNullOrUndefined(n.user)||(t.user=n.user,-1===this.documentHelper.userCollection.indexOf(t.user)&&this.documentHelper.userCollection.push(t.user),this.addEditRangeCollection(t.user,t)),sf.base.isNullOrUndefined(n.group)||""===n.group||(t.group=n.group,t.group="everyone"===t.group?"Everyone":t.group,-1===this.documentHelper.userCollection.indexOf(t.group)&&this.documentHelper.userCollection.push(t.group),this.addEditRangeCollection(t.group,t)),t},n.prototype.addEditRangeCollection=function(n,t){if(this.documentHelper.editRanges.containsKey(n))this.documentHelper.editRanges.get(n).push(t);else{var i=[];i.push(t);this.documentHelper.editRanges.add(n,i)}},n.prototype.parseChartTitleArea=function(n,t){t.chartfontName=n.fontName;t.chartFontSize=n.fontSize;this.parseChartDataFormat(n.dataFormat,t.dataFormat);this.parseChartLayout(n.layout,t.layout)},n.prototype.parseChartDataFormat=function(n,t){t.fill.color=n.fill.foreColor;t.fill.rgb=n.fill.rgb;t.line.color=n.line.color;t.line.rgb=n.line.rgb},n.prototype.parseChartLayout=function(n,t){t.chartLayoutLeft=n.layoutX;t.chartLayoutTop=n.layoutY},n.prototype.parseChartLegend=function(n,t){t.chartLegendPostion=n.position;this.parseChartTitleArea(n.chartTitleArea,t.chartTitleArea)},n.prototype.parseChartCategoryAxis=function(n,t){t.categoryAxisType=n.categoryType;t.categoryNumberFormat=n.numberFormat;t.interval=n.majorUnit;t.axisFontSize=n.fontSize;t.axisFontName=n.fontName;t.max=n.maximumValue;t.min=n.minimumValue;t.majorGridLines=n.hasMajorGridLines;t.minorGridLines=n.hasMinorGridLines;t.majorTick=n.majorTickMark;t.minorTick=n.minorTickMark;t.tickPosition=n.tickLabelPosition;t.categoryAxisTitle=n.chartTitle;null!=n.chartTitle&&this.parseChartTitleArea(n.chartTitleArea,t.chartTitleArea)},n.prototype.parseChartDataTable=function(n,t){t.showSeriesKeys=n.showSeriesKeys;t.hasHorzBorder=n.hasHorzBorder;t.hasVertBorder=n.hasVertBorder;t.hasBorders=n.hasBorders},n.prototype.parseChartArea=function(n,t){t.chartForeColor=n.foreColor},n.prototype.parseChartData=function(n,t){for(var u,i,f,e,o,r=0;r<n.chartCategory.length;r++){for(u=new df,i=n.chartCategory[r],i.hasOwnProperty("categoryXName")&&(u.xName=i.categoryXName),f=0;f<i.chartData.length;f++)e=new gf,o=i.chartData[f],e.yAxisValue=o.yValue,"Bubble"===n.chartType&&(e.bubbleSize=o.size),u.chartData.push(e);t.chartCategory.push(u)}this.parseChartSeries(n,t)},n.prototype.parseChartSeries=function(n,t){for(var r,i,u,e,f,o=n.chartType,h="Pie"===o||"Doughnut"===o,s=0;s<n.chartSeries.length;s++)r=new te,i=n.chartSeries[s],i.hasOwnProperty("seriesName")&&((r.seriesName=i.seriesName,h&&(i.hasOwnProperty("firstSliceAngle")&&(r.firstSliceAngle=i.firstSliceAngle),"Doughnut"===o&&(r.doughnutHoleSize=i.holeSize)),i.hasOwnProperty("dataLabel")&&this.parseChartDataLabels(i.dataLabel,r),i.hasOwnProperty("seriesFormat"))&&(u=new iu,e=i.seriesFormat,u.markerStyle=e.markerStyle,u.markerColor=e.markerColor,u.numberValue=e.markerSize,r.seriesFormat=u),i.hasOwnProperty("errorBar")&&(f=r.errorBar,f.errorType=i.errorBar.type,f.errorDirection=i.errorBar.direction,f.errorEndStyle=i.errorBar.endStyle,f.numberValue=i.errorBar.numberValue),i.hasOwnProperty("trendLines")&&this.parseChartTrendLines(i.trendLines,r),this.parseChartSeriesDataPoints(i.dataPoints,r)),t.chartSeries.push(r)},n.prototype.parseChartDataLabels=function(n,t){var i=new ru;i.labelPosition=n.position;i.fontName=n.fontName;i.fontColor=n.fontColor;i.fontSize=n.fontSize;i.isLegendKey=n.isLegendKey;i.isBubbleSize=n.isBubbleSize;i.isCategoryName=n.isCategoryName;i.isSeriesName=n.isSeriesName;i.isValue=n.isValue;i.isPercentage=n.isPercentage;i.isLeaderLines=n.isLeaderLines;t.dataLabels=i},n.prototype.parseChartSeriesDataPoints=function(n,t){for(var r,i=0;i<n.length;i++)r=new uu,this.parseChartDataFormat(n[i],r),t.chartDataFormat.push(r)},n.prototype.parseChartTrendLines=function(n,t){for(var r,i,u=0;u<n.length;u++)r=n[u],i=new re,i.trendLineName=r.name,i.trendLineType=r.type,i.forwardValue=r.forward,i.backwardValue=r.backward,i.interceptValue=r.intercept,i.isDisplayEquation=r.isDisplayEquation,i.isDisplayRSquared=r.isDisplayRSquared,t.trendLines.push(i)},n.prototype.parseTableFormat=function(n,t){this.parseBorders(n.borders,t.borders);sf.base.isNullOrUndefined(n.allowAutoFit)||(t.allowAutoFit=n.allowAutoFit);sf.base.isNullOrUndefined(n.cellSpacing)||(t.cellSpacing=n.cellSpacing);sf.base.isNullOrUndefined(n.leftMargin)||(t.leftMargin=n.leftMargin);sf.base.isNullOrUndefined(n.topMargin)||(t.topMargin=n.topMargin);sf.base.isNullOrUndefined(n.rightMargin)||(t.rightMargin=n.rightMargin);sf.base.isNullOrUndefined(n.bottomMargin)||(t.bottomMargin=n.bottomMargin);sf.base.isNullOrUndefined(n.leftIndent)||(t.leftIndent=n.leftIndent);this.parseShading(n.shading,t.shading);sf.base.isNullOrUndefined(n.tableAlignment)||(t.tableAlignment=n.tableAlignment);sf.base.isNullOrUndefined(n.preferredWidth)||(t.preferredWidth=n.preferredWidth);sf.base.isNullOrUndefined(n.preferredWidthType)||(t.preferredWidthType=n.preferredWidthType);sf.base.isNullOrUndefined(n.bidi)||(t.bidi=n.bidi);sf.base.isNullOrUndefined(n.horizontalPositionAbs)||(t.horizontalPositionAbs=n.horizontalPositionAbs);sf.base.isNullOrUndefined(n.horizontalPosition)||(t.horizontalPosition=n.horizontalPosition)},n.prototype.parseCellFormat=function(n,t){sf.base.isNullOrUndefined(n)||(this.parseBorders(n.borders,t.borders),n.isSamePaddingAsTable||this.parseCellMargin(n,t),sf.base.isNullOrUndefined(n.cellWidth)||(t.cellWidth=n.cellWidth),sf.base.isNullOrUndefined(n.columnSpan)||(t.columnSpan=n.columnSpan),sf.base.isNullOrUndefined(n.rowSpan)||(t.rowSpan=n.rowSpan),this.parseShading(n.shading,t.shading),sf.base.isNullOrUndefined(n.verticalAlignment)||(t.verticalAlignment=n.verticalAlignment),sf.base.isNullOrUndefined(n.preferredWidthType)||(t.preferredWidthType=n.preferredWidthType),sf.base.isNullOrUndefined(n.preferredWidth)||(t.preferredWidth=n.preferredWidth))},n.prototype.parseCellMargin=function(n,t){sf.base.isNullOrUndefined(n.leftMargin)||(t.leftMargin=n.leftMargin);sf.base.isNullOrUndefined(n.rightMargin)||(t.rightMargin=n.rightMargin);sf.base.isNullOrUndefined(n.topMargin)||(t.topMargin=n.topMargin);sf.base.isNullOrUndefined(n.bottomMargin)||(t.bottomMargin=n.bottomMargin)},n.prototype.parseRowFormat=function(n,t){sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(n.allowBreakAcrossPages)||(t.allowBreakAcrossPages=n.allowBreakAcrossPages),sf.base.isNullOrUndefined(n.isHeader)||(t.isHeader=n.isHeader),sf.base.isNullOrUndefined(n.heightType)||(t.heightType=n.heightType),sf.base.isNullOrUndefined(n.height)||(t.height=n.height),sf.base.isNullOrUndefined(n.leftMargin)||(t.leftMargin=n.leftMargin),sf.base.isNullOrUndefined(n.topMargin)||(t.topMargin=n.topMargin),sf.base.isNullOrUndefined(n.rightMargin)||(t.rightMargin=n.rightMargin),sf.base.isNullOrUndefined(n.bottomMargin)||(t.bottomMargin=n.bottomMargin),sf.base.isNullOrUndefined(n.leftIndent)||(t.leftIndent=n.leftIndent),!sf.base.isNullOrUndefined(n.revisionIds)&&n.revisionIds.length>0&&this.checkAndApplyRevision(n,t),this.parseBorders(n.borders,t.borders))},n.prototype.parseBorders=function(n,t){sf.base.isNullOrUndefined(n)||(this.parseBorder(n.left,t.left),this.parseBorder(n.right,t.right),this.parseBorder(n.top,t.top),this.parseBorder(n.bottom,t.bottom),this.parseBorder(n.vertical,t.vertical),this.parseBorder(n.horizontal,t.horizontal),this.parseBorder(n.diagonalDown,t.diagonalDown),this.parseBorder(n.diagonalUp,t.diagonalUp))},n.prototype.parseBorder=function(n,t){sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(n.color)||(t.color=this.getColor(n.color)),sf.base.isNullOrUndefined(n.lineStyle)||(t.lineStyle=n.lineStyle),sf.base.isNullOrUndefined(n.lineWidth)||(t.lineWidth=n.lineWidth),sf.base.isNullOrUndefined(n.hasNoneStyle)||(t.hasNoneStyle=n.hasNoneStyle))},n.prototype.parseShading=function(n,t){sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(n.backgroundColor)||(t.backgroundColor=this.getColor(n.backgroundColor)),sf.base.isNullOrUndefined(n.foregroundColor)||(t.foregroundColor=this.getColor(n.foregroundColor)),sf.base.isNullOrUndefined(n.texture)&&sf.base.isNullOrUndefined(n.textureStyle)||(t.textureStyle=sf.base.isNullOrUndefined(n.texture)?n.textureStyle:n.texture))},n.prototype.parseCharacterFormat=function(n,t,i){var r,u;if(!sf.base.isNullOrUndefined(n)){if(i&&n.hasOwnProperty("inlineFormat"))return void this.parseCharacterFormat(n.inlineFormat,t);(sf.base.isNullOrUndefined(n.baselineAlignment)||(t.baselineAlignment=n.baselineAlignment),sf.base.isNullOrUndefined(n.underline)||(t.underline=n.underline),sf.base.isNullOrUndefined(n.strikethrough)||(t.strikethrough=n.strikethrough),sf.base.isNullOrUndefined(n.fontSize))||(n.fontSize=parseFloat(n.fontSize),r=10*n.fontSize,r%10!=0&&(r=10*n.fontSize.toFixed(1),n.fontSize=r%5==0?n.fontSize.toFixed(1):Math.round(n.fontSize)),u=parseFloat(n.fontSize),t.fontSize=u<0?0:u);sf.base.isNullOrUndefined(n.fontFamily)||(-1!==n.fontFamily.indexOf('"')&&(n.fontFamily=n.fontFamily.replace('"',"")),t.fontFamily=n.fontFamily);sf.base.isNullOrUndefined(n.bold)||(t.bold=n.bold);sf.base.isNullOrUndefined(n.italic)||(t.italic=n.italic);sf.base.isNullOrUndefined(n.highlightColor)||(t.highlightColor=n.highlightColor);sf.base.isNullOrUndefined(n.fontColor)||(t.fontColor=this.getColor(n.fontColor));sf.base.isNullOrUndefined(n.bidi)||(t.bidi=n.bidi);sf.base.isNullOrUndefined(n.bdo)||(t.bdo=n.bdo);sf.base.isNullOrUndefined(n.fontSizeBidi)||(t.fontSizeBidi=n.fontSizeBidi<0?0:n.fontSizeBidi);sf.base.isNullOrUndefined(n.fontFamilyBidi)||(t.fontFamilyBidi=n.fontFamilyBidi);sf.base.isNullOrUndefined(n.boldBidi)||(t.boldBidi=n.boldBidi);sf.base.isNullOrUndefined(n.italicBidi)||(t.italicBidi=n.italicBidi);!sf.base.isNullOrUndefined(n.revisionIds)&&n.revisionIds.length>0&&this.checkAndApplyRevision(n,t);sf.base.isNullOrUndefined(n.allCaps)||(t.allCaps=n.allCaps)}},n.prototype.getColor=function(n){return n||"#ffffff"},n.prototype.parseParagraphFormat=function(n,t){sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(n.bidi)||(t.bidi=n.bidi),sf.base.isNullOrUndefined(n.leftIndent)||(t.leftIndent=n.leftIndent),sf.base.isNullOrUndefined(n.rightIndent)||(t.rightIndent=n.rightIndent),sf.base.isNullOrUndefined(n.firstLineIndent)||(t.firstLineIndent=n.firstLineIndent),sf.base.isNullOrUndefined(n.afterSpacing)||(t.afterSpacing=n.afterSpacing),sf.base.isNullOrUndefined(n.beforeSpacing)||(t.beforeSpacing=n.beforeSpacing),sf.base.isNullOrUndefined(n.lineSpacing)||(t.lineSpacing=n.lineSpacing),sf.base.isNullOrUndefined(n.lineSpacingType)?sf.base.isNullOrUndefined(n.lineSpacing)||(t.lineSpacingType="Multiple"):t.lineSpacingType=n.lineSpacingType,sf.base.isNullOrUndefined(n.textAlignment)||(t.textAlignment=n.textAlignment),sf.base.isNullOrUndefined(n.outlineLevel)||(t.outlineLevel=n.outlineLevel),sf.base.isNullOrUndefined(n.contextualSpacing)||(t.contextualSpacing=n.contextualSpacing),sf.base.isNullOrUndefined(n.widowControl)||(t.widowControl=n.widowControl),sf.base.isNullOrUndefined(n.keepLinesTogether)||(t.keepLinesTogether=n.keepLinesTogether),sf.base.isNullOrUndefined(n.keepLinesTogether)||(t.keepLinesTogether=n.keepLinesTogether),t.listFormat=new ai,n.hasOwnProperty("listFormat")&&this.parseListFormat(n,t.listFormat),n.hasOwnProperty("tabs")&&this.parseTabStop(n.tabs,t.tabs))},n.prototype.parseListFormat=function(n,t){sf.base.isNullOrUndefined(n.listFormat)||(sf.base.isNullOrUndefined(n.listFormat.listId)||(t.listId=n.listFormat.listId,t.list=this.documentHelper.getListById(n.listFormat.listId)),sf.base.isNullOrUndefined(n.listFormat.listLevelNumber)||(t.listLevelNumber=n.listFormat.listLevelNumber))},n.prototype.parseSectionFormat=function(n,t){sf.base.isNullOrUndefined(n.pageWidth)||(t.pageWidth=n.pageWidth);sf.base.isNullOrUndefined(n.pageHeight)||(t.pageHeight=n.pageHeight);sf.base.isNullOrUndefined(n.leftMargin)||(t.leftMargin=n.leftMargin);sf.base.isNullOrUndefined(n.topMargin)||(t.topMargin=n.topMargin);sf.base.isNullOrUndefined(n.rightMargin)||(t.rightMargin=n.rightMargin);sf.base.isNullOrUndefined(n.bottomMargin)||(t.bottomMargin=n.bottomMargin);sf.base.isNullOrUndefined(n.headerDistance)||(t.headerDistance=n.headerDistance);sf.base.isNullOrUndefined(n.footerDistance)||(t.footerDistance=n.footerDistance);sf.base.isNullOrUndefined(n.differentFirstPage)||(t.differentFirstPage=n.differentFirstPage);sf.base.isNullOrUndefined(n.differentOddAndEvenPages)||(t.differentOddAndEvenPages=n.differentOddAndEvenPages);sf.base.isNullOrUndefined(n.bidi)||(t.bidi=n.bidi);sf.base.isNullOrUndefined(n.restartPageNumbering)||(t.restartPageNumbering=n.restartPageNumbering);sf.base.isNullOrUndefined(n.pageStartingNumber)||(t.pageStartingNumber=n.pageStartingNumber);sf.base.isNullOrUndefined(n.endnoteNumberFormat)||(t.endnoteNumberFormat=n.endnoteNumberFormat);sf.base.isNullOrUndefined(n.footNoteNumberFormat)||(t.footNoteNumberFormat=n.footNoteNumberFormat);sf.base.isNullOrUndefined(n.restartIndexForFootnotes)||(t.restartIndexForFootnotes=n.restartIndexForFootnotes);sf.base.isNullOrUndefined(n.pageStartingNumber)||(t.restartIndexForEndnotes=n.restartIndexForEndnotes);sf.base.isNullOrUndefined(n.initialFootNoteNumber)||(t.initialFootNoteNumber=n.initialFootNoteNumber);sf.base.isNullOrUndefined(n.initialEndNoteNumber)||(t.initialEndNoteNumber=n.initialEndNoteNumber)},n.prototype.parseTabStop=function(n,t){var i,r;if(n)for(i=0;i<n.length;i++)r=new hu,r.position=n[i].position,r.tabLeader=n[i].tabLeader,r.deletePosition=n[i].deletePosition,r.tabJustification=n[i].tabJustification,t.push(r)},n.prototype.validateImageUrl=function(n){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=3*(n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;return n.charAt(n.length-1)===i.charAt(64)&&t--,n.charAt(n.length-2)===i.charAt(64)&&t--,t%1==0},n.prototype.containsFieldBegin=function(n){for(var t=void 0,u=n.children.length-1;u>=0;u--){if(_instanceof(t=n.children[u],r)&&t.hasFieldEnd&&_instanceof(t.nextElement,i))return t.nextElement;if(_instanceof(t,r))return}return t},n}(),au=function(){function n(n){this.boldIn=void 0;this.italicIn=void 0;this.underlineIn=void 0;this.strikeThroughIn=void 0;this.baselineAlignmentIn=void 0;this.highlightColorIn=void 0;this.fontSizeIn=0;this.fontColorIn=void 0;this.allCapsIn=void 0;this.boldBidi=void 0;this.italicBidi=void 0;this.fontSizeBidi=0;this.bidi=void 0;this.bdo=void 0;this.selection=n}return Object.defineProperty(n.prototype,"fontSize",{get:function(){return this.fontSizeIn},set:function(n){n!==this.fontSizeIn&&(this.fontSizeIn=n,this.notifyPropertyChanged("fontSize"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this.fontFamilyIn},set:function(n){n!==this.fontFamilyIn&&(this.fontFamilyIn=n,this.notifyPropertyChanged("fontFamily"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontColor",{get:function(){return this.fontColorIn},set:function(n){n!==this.fontColorIn&&(this.fontColorIn=n,this.notifyPropertyChanged("fontColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bold",{get:function(){return this.boldIn},set:function(n){n!==this.boldIn&&(this.boldIn=n,this.notifyPropertyChanged("bold"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"italic",{get:function(){return this.italicIn},set:function(n){n!==this.italic&&(this.italicIn=n,this.notifyPropertyChanged("italic"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"strikethrough",{get:function(){return this.strikeThroughIn},set:function(n){n!==this.strikeThroughIn&&(this.strikeThroughIn=n,this.notifyPropertyChanged("strikethrough"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"baselineAlignment",{get:function(){return this.baselineAlignmentIn},set:function(n){n!==this.baselineAlignmentIn&&(this.baselineAlignmentIn=n,this.notifyPropertyChanged("baselineAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"underline",{get:function(){return this.underlineIn},set:function(n){n!==this.underlineIn&&(this.underlineIn=n,this.notifyPropertyChanged("underline"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"highlightColor",{get:function(){return this.highlightColorIn},set:function(n){n===this.highlightColorIn&&"NoColor"!==n||(this.highlightColorIn=n,this.notifyPropertyChanged("highlightColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"allCaps",{get:function(){return this.allCapsIn},set:function(n){n!==this.allCapsIn&&(this.allCapsIn=n,this.notifyPropertyChanged("allCaps"))},enumerable:!0,configurable:!0}),n.prototype.getPropertyValue=function(n){switch(n){case"bold":return this.bold;case"italic":return this.italic;case"fontSize":return this.fontSize>=1?this.fontSize:void 0;case"fontFamily":return this.fontFamily;case"strikethrough":return this.strikethrough;case"baselineAlignment":return this.baselineAlignment;case"highlightColor":return this.highlightColor;case"underline":return this.underline;case"fontColor":return this.fontColor;case"allCaps":return this.allCaps;default:return}},n.prototype.notifyPropertyChanged=function(n){if((sf.base.isNullOrUndefined(this.selection)||!(this.selection.isCleared||this.selection.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.selection.owner.isDocumentLoaded||this.selection.owner.isPastingContent)||this.selection.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.getPropertyValue(n);sf.base.isNullOrUndefined(t)||this.selection.owner.editorModule.onApplyCharacterFormat(n,t)}},n.prototype.copyFormat=function(n){this.styleName=sf.base.isNullOrUndefined(n.baseCharStyle)?"Default Paragraph Font":n.baseCharStyle.name;this.fontSize=n.fontSize;this.fontFamily=n.fontFamily;this.bold=n.bold;this.italic=n.italic;this.baselineAlignment=n.baselineAlignment;this.underline=n.underline;this.fontColor=n.fontColor;this.highlightColor=n.highlightColor;this.strikethrough=n.strikethrough;this.bidi=n.bidi;this.bdo=n.bdo;this.boldBidi=n.boldBidi;this.italicBidi=n.italicBidi;this.fontFamilyBidi=n.fontFamilyBidi;this.fontSizeBidi=n.fontSizeBidi;this.allCaps=n.allCaps},n.prototype.combineFormat=function(n){sf.base.isNullOrUndefined(this.bold)||this.bold===n.bold||(this.bold=void 0);sf.base.isNullOrUndefined(this.italic)||this.italic===n.italic||(this.italic=void 0);0!==this.fontSize&&this.fontSize!==n.fontSize&&(this.fontSize=0);sf.base.isNullOrUndefined(this.fontFamily)||this.fontFamily===n.fontFamily||(this.fontFamily=void 0);sf.base.isNullOrUndefined(this.highlightColor)||this.highlightColor===n.highlightColor||(this.highlightColor=void 0);sf.base.isNullOrUndefined(this.baselineAlignment)||this.baselineAlignment===n.baselineAlignment||(this.baselineAlignment=void 0);sf.base.isNullOrUndefined(this.fontColor)||this.fontColor===n.fontColor||(this.fontColor=void 0);sf.base.isNullOrUndefined(this.underline)||this.underline===n.underline||(this.underline=void 0);sf.base.isNullOrUndefined(this.strikethrough)||this.strikethrough===n.strikethrough||(this.strikethrough=void 0);sf.base.isNullOrUndefined(this.boldBidi)||this.boldBidi===n.boldBidi||(this.boldBidi=void 0);sf.base.isNullOrUndefined(this.italicBidi)||this.italicBidi===n.italicBidi||(this.italicBidi=void 0);0!==this.fontSizeBidi&&this.fontSizeBidi!==n.fontSizeBidi&&(this.fontSizeBidi=0);sf.base.isNullOrUndefined(this.fontFamilyBidi)||this.fontFamilyBidi===n.fontFamilyBidi||(this.fontFamilyBidi=void 0);sf.base.isNullOrUndefined(this.bidi)||this.bidi===n.bidi||(this.bidi=void 0);sf.base.isNullOrUndefined(this.bdo)||this.bdo===n.bdo||(this.bdo=void 0);sf.base.isNullOrUndefined(this.allCaps)||this.allCaps===n.allCaps||(this.allCaps=void 0)},n.prototype.cloneFormat=function(n){this.bold=n.bold;this.italic=n.italic;this.underline=n.underline;this.strikethrough=n.strikethrough;this.baselineAlignment=n.baselineAlignment;this.highlightColor=n.highlightColor;this.fontSize=n.fontSize;this.fontFamily=n.fontFamily;this.fontColor=n.fontColor;this.styleName=n.styleName;this.bidi=n.bidi;this.bdo=n.bdo;this.boldBidi=n.boldBidi;this.italicBidi=n.italicBidi;this.fontSizeBidi=n.fontSizeBidi;this.fontFamilyBidi=n.fontFamilyBidi;this.allCaps=n.allCaps},n.prototype.isEqualFormat=function(n){return this.fontSize===n.fontSize&&this.strikethrough===n.strikethrough&&this.bold===n.bold&&this.fontFamily===n.fontFamily&&this.underline===n.underline&&this.highlightColor===n.highlightColor&&this.italic===n.italic&&this.baselineAlignment===n.baselineAlignment&&this.fontColor===n.fontColor&&this.allCaps===n.allCaps},n.prototype.clearFormat=function(){this.fontSizeIn=0;this.boldIn=void 0;this.italicIn=void 0;this.fontFamilyIn=void 0;this.fontColorIn=void 0;this.underlineIn=void 0;this.strikeThroughIn=void 0;this.highlightColorIn=void 0;this.baselineAlignmentIn=void 0;this.styleName=void 0;this.bidi=void 0;this.bdo=void 0;this.boldBidi=void 0;this.italicBidi=void 0;this.fontFamilyBidi=void 0;this.fontSizeBidi=void 0;this.allCapsIn=void 0},n.prototype.destroy=function(){this.fontSizeIn=void 0;this.boldIn=void 0;this.italicIn=void 0;this.fontFamilyIn=void 0;this.fontColorIn=void 0;this.underlineIn=void 0;this.strikeThroughIn=void 0;this.baselineAlignmentIn=void 0;this.highlightColorIn=void 0;this.selection=void 0;this.styleName=void 0;this.bidi=void 0;this.bdo=void 0;this.boldBidi=void 0;this.italicBidi=void 0;this.fontFamilyBidi=void 0;this.fontSizeBidi=void 0;this.allCapsIn=void 0},n}(),se=function(){function n(n,t){this.leftIndentIn=0;this.rightIndentIn=0;this.beforeSpacingIn=0;this.afterSpacingIn=0;this.textAlignmentIn=void 0;this.firstLineIndentIn=0;this.lineSpacingIn=1;this.lineSpacingTypeIn=void 0;this.bidiIn=void 0;this.keepWithNextIn=void 0;this.keepLinesTogetherIn=void 0;this.widowControlIn=void 0;this.contextualSpacingIn=void 0;this.listLevelNumberIn=-1;this.selection=n;this.documentHelper=t}return Object.defineProperty(n.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(n){n!==this.leftIndentIn&&(this.leftIndentIn=n,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightIndent",{get:function(){return this.rightIndentIn},set:function(n){n!==this.rightIndentIn&&(this.rightIndentIn=n,this.notifyPropertyChanged("rightIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"firstLineIndent",{get:function(){return this.firstLineIndentIn},set:function(n){n!==this.firstLineIndentIn&&(this.firstLineIndentIn=n,this.notifyPropertyChanged("firstLineIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textAlignment",{get:function(){return this.textAlignmentIn},set:function(n){n!==this.textAlignmentIn&&(this.textAlignmentIn=n,this.notifyPropertyChanged("textAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"afterSpacing",{get:function(){return this.afterSpacingIn},set:function(n){n!==this.afterSpacingIn&&(this.afterSpacingIn=n,this.notifyPropertyChanged("afterSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"beforeSpacing",{get:function(){return this.beforeSpacingIn},set:function(n){n!==this.beforeSpacingIn&&(this.beforeSpacingIn=n,this.notifyPropertyChanged("beforeSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineSpacing",{get:function(){return this.lineSpacingIn},set:function(n){n!==this.lineSpacingIn&&(this.lineSpacingIn=n,this.notifyPropertyChanged("lineSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineSpacingType",{get:function(){return this.lineSpacingTypeIn},set:function(n){n!==this.lineSpacingTypeIn&&(this.lineSpacingTypeIn=n,this.notifyPropertyChanged("lineSpacingType"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"listLevelNumber",{get:function(){return this.listLevelNumberIn},set:function(n){n!==this.listLevelNumberIn&&(this.listLevelNumberIn=n,this.notifyPropertyChanged("listLevelNumber"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bidi",{get:function(){return this.bidiIn},set:function(n){this.bidiIn=n;this.notifyPropertyChanged("bidi")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"keepWithNext",{get:function(){return this.keepWithNextIn},set:function(n){this.keepWithNextIn=n;this.notifyPropertyChanged("keepWithNext")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"keepLinesTogether",{get:function(){return this.keepLinesTogetherIn},set:function(n){this.keepLinesTogetherIn=n;this.notifyPropertyChanged("keepLinesTogether")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"widowControl",{get:function(){return this.widowControlIn},set:function(n){this.widowControlIn=n;this.notifyPropertyChanged("widowControl")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"contextualSpacing",{get:function(){return this.contextualSpacingIn},set:function(n){this.contextualSpacingIn=n;this.notifyPropertyChanged("contextualSpacing")},enumerable:!0,configurable:!0}),n.prototype.validateLineSpacing=function(){return"Multiple"!==this.lineSpacingType&&this.lineSpacingIn<12},Object.defineProperty(n.prototype,"listText",{get:function(){var t=void 0,r=this.documentHelper.getListById(this.listId),i,n,f,u;if(_instanceof(r,pi)&&this.listLevelNumberIn>-1&&this.listLevelNumberIn<9&&(i=r.getListLevel(this.listLevelNumber),_instanceof(i,li)))if("Bullet"===i.listLevelPattern)t=i.numberFormat;else for(t=i.numberFormat,n=0;n<9;n++)f="%"+(n+1),t.indexOf(f)>-1&&(n===this.listLevelNumberIn||r.getListLevel(n),u=this.selection.getListTextElementBox(this.selection.start.paragraph),t=u?u.text:"");return t},enumerable:!0,configurable:!0}),n.prototype.getPropertyValue=function(n){switch(n){case"leftIndent":return this.leftIndent;case"rightIndent":return this.rightIndent;case"firstLineIndent":return this.firstLineIndent;case"beforeSpacing":return this.beforeSpacing;case"afterSpacing":return this.afterSpacing;case"textAlignment":return this.textAlignment;case"lineSpacing":return this.lineSpacing;case"lineSpacingType":return this.lineSpacingType;case"bidi":return this.bidi;case"keepWithNext":return this.keepWithNext;case"keepLinesTogether":return this.keepLinesTogether;case"widowControl":return this.widowControl;case"contextualSpacing":return this.contextualSpacing;default:return}},n.prototype.notifyPropertyChanged=function(n){var t,i,u,r;if((sf.base.isNullOrUndefined(this.selection)||(!this.selection.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.selection.owner.isDocumentLoaded||this.selection.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){if(t=this.selection.owner.editorModule,("lineSpacing"===n||"lineSpacingType"===n)&&(i=this.selection.owner.editorHistory,(!i||!i.isUndoing&&!i.isRedoing)&&this.validateLineSpacing()))return(this.selection.owner.editorHistory.initComplexHistory(this.selection,"LineSpacing"),"lineSpacing"===n)?(this.lineSpacingTypeIn="Multiple",u=this.getPropertyValue("lineSpacingType"),t.onApplyParagraphFormat("lineSpacingType",u,!1,!1),t.onApplyParagraphFormat(n,this.getPropertyValue(n),!1,!1)):(t.onApplyParagraphFormat(n,this.getPropertyValue(n),!1,!1),this.lineSpacingIn=12,t.onApplyParagraphFormat("lineSpacing",this.getPropertyValue("lineSpacing"),!1,!1)),void this.selection.owner.editorHistory.updateComplexHistory();if(r=this.getPropertyValue(n),!("leftIndent"!==n&&"rightIndent"!==n&&"firstLineIndent"!==n||r>=-1056&&r<1056))return;"listLevelNumber"===n?t.onApplyListInternal(this.documentHelper.getListById(this.listId),this.listLevelNumber):t.onApplyParagraphFormat(n,r,"textAlignment"===n,!1)}},n.prototype.copyFormat=function(n){this.styleName=sf.base.isNullOrUndefined(n.baseStyle)?"Normal":n.baseStyle.name;this.leftIndent=n.leftIndent;this.rightIndent=n.rightIndent;this.firstLineIndent=n.firstLineIndent;this.afterSpacing=n.afterSpacing;this.beforeSpacing=n.beforeSpacing;this.lineSpacing=n.lineSpacing;this.lineSpacingType=n.lineSpacingType;this.textAlignment=n.textAlignment;this.bidi=n.bidi;this.keepLinesTogether=n.keepLinesTogether;this.keepWithNext=n.keepWithNext;this.widowControl=n.widowControl;this.contextualSpacing=n.contextualSpacing;sf.base.isNullOrUndefined(n.listFormat)||sf.base.isNullOrUndefined(n.listFormat.listId)?(this.listId=void 0,this.listLevelNumber=0):(this.listId=n.listFormat.listId,this.listLevelNumber=n.listFormat.listLevelNumber)},n.prototype.copyToFormat=function(n){sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(this.afterSpacing)||(n.afterSpacing=this.afterSpacing),sf.base.isNullOrUndefined(this.beforeSpacing)||(n.beforeSpacing=this.beforeSpacing),sf.base.isNullOrUndefined(this.leftIndent)||(n.leftIndent=this.leftIndent),sf.base.isNullOrUndefined(this.rightIndent)||(n.rightIndent=this.rightIndent),sf.base.isNullOrUndefined(this.textAlignment)||(n.textAlignment=this.textAlignment),sf.base.isNullOrUndefined(this.lineSpacing)||(n.lineSpacing=this.lineSpacing),sf.base.isNullOrUndefined(this.lineSpacingType)||(n.lineSpacingType=this.lineSpacingType),sf.base.isNullOrUndefined(this.firstLineIndent)||(n.firstLineIndent=this.firstLineIndent),sf.base.isNullOrUndefined(this.bidi)||(n.bidi=this.bidi),sf.base.isNullOrUndefined(this.keepLinesTogether)||(n.keepLinesTogether=this.keepLinesTogether),sf.base.isNullOrUndefined(this.keepWithNext)||(n.keepWithNext=this.keepWithNext),sf.base.isNullOrUndefined(this.widowControl)||(n.widowControl=this.widowControl),sf.base.isNullOrUndefined(this.contextualSpacing)||(n.contextualSpacing=this.contextualSpacing))},n.prototype.combineFormat=function(n){sf.base.isNullOrUndefined(this.leftIndent)||this.leftIndent===n.leftIndent||(this.leftIndent=void 0);sf.base.isNullOrUndefined(this.rightIndent)||this.rightIndent===n.rightIndent||(this.rightIndent=void 0);sf.base.isNullOrUndefined(this.firstLineIndent)||this.firstLineIndent===n.firstLineIndent||(this.firstLineIndent=void 0);0!==this.lineSpacing&&this.lineSpacing!==n.lineSpacing&&(this.lineSpacing=0);-1!==this.beforeSpacing&&this.beforeSpacing!==n.beforeSpacing&&(this.beforeSpacing=-1);-1!==this.afterSpacing&&this.afterSpacing!==n.afterSpacing&&(this.afterSpacing=-1);sf.base.isNullOrUndefined(this.lineSpacingType)||this.lineSpacingType===n.lineSpacingType||(this.lineSpacingType=void 0);sf.base.isNullOrUndefined(this.textAlignment)||this.textAlignment===n.textAlignment||(this.textAlignment=void 0);this.listLevelNumber>=0&&!sf.base.isNullOrUndefined(this.listId)&&(sf.base.isNullOrUndefined(n.listFormat)||n.listFormat.listLevelNumber!==this.listLevelNumber)&&(this.listLevelNumber=-1);(sf.base.isNullOrUndefined(n.listFormat)||sf.base.isNullOrUndefined(n.listFormat.listId)||!sf.base.isNullOrUndefined(this.listId)&&this.listId!==n.listFormat.listId)&&(this.listId=void 0);sf.base.isNullOrUndefined(this.bidi)||this.bidi===n.bidi||(this.bidi=void 0);sf.base.isNullOrUndefined(this.keepLinesTogether)||this.keepLinesTogether===n.keepLinesTogether||(this.keepLinesTogether=void 0);sf.base.isNullOrUndefined(this.keepWithNext)||this.keepWithNext===n.keepWithNext||(this.keepWithNext=void 0);sf.base.isNullOrUndefined(this.widowControl)||this.widowControl===n.widowControl||(this.widowControl=void 0);sf.base.isNullOrUndefined(this.contextualSpacing)||this.contextualSpacing===n.contextualSpacing||(this.contextualSpacing=void 0);!sf.base.isNullOrUndefined(this.styleName)&&n.baseStyle&&this.styleName!==n.baseStyle.name&&(this.styleName=void 0)},n.prototype.clearFormat=function(){this.leftIndent=0;this.rightIndent=0;this.beforeSpacing=0;this.afterSpacing=0;this.firstLineIndent=0;this.lineSpacing=1;this.textAlignment=void 0;this.lineSpacingType=void 0;this.listId=void 0;this.listLevelNumber=-1;this.styleName=void 0;this.bidi=void 0;this.contextualSpacing=void 0},n.prototype.getList=function(){var t=this.documentHelper.getListById(this.listId),n,f,o;if(!sf.base.isNullOrUndefined(t)){var r=new pi,i=new wi,u=this.documentHelper.getAbstractListById(t.abstractListId),e=this.selection.owner.editorModule;if(sf.base.isNullOrUndefined(u))i.levels.push(new li(i));else for(n=0;n<u.levels.length;n++)f=e.cloneListLevel(u.levels[n]),i.levels.push(f),f.ownerBase=i;if(!sf.base.isNullOrUndefined(t.levelOverrides))for(n=0;n<t.levelOverrides.length;n++)o=e.cloneLevelOverride(t.levelOverrides[n]),r.levelOverrides.push(o);return r.abstractList=i,r.abstractListId=i.abstractListId,r.sourceListId=t.listId,r}},n.prototype.setList=function(n){var t;if((!this.documentHelper.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.documentHelper.owner.isDocumentLoaded){var r=this.documentHelper.getListById(this.listId),u=void 0,i=n?this.documentHelper.getAbstractListById(n.abstractListId):void 0;sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(i)||n.sourceListId!==r.listId?sf.base.isNullOrUndefined(n)?this.selection.owner.editorModule.onApplyList(void 0):(this.selection.owner.isLayoutEnabled=!1,sf.base.isNullOrUndefined(i)||-1!==this.documentHelper.abstractLists.indexOf(i)||this.documentHelper.abstractLists.push(i),-1===this.documentHelper.lists.indexOf(n)&&this.documentHelper.lists.push(n),this.selection.owner.isLayoutEnabled=!0,this.selection.owner.editorModule.onApplyList(n)):(t=this.documentHelper.owner.editorHistory,this.documentHelper.layout.getListLevel(r,1),this.selection.owner.isLayoutEnabled=!1,this.documentHelper.owner.editorModule.setOffsetValue(this.selection),t&&(u=t.updateListChangesInHistory(i,r)),this.documentHelper.owner.editorModule.updateListParagraphs(),t&&t.applyListChanges(this.selection,u),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.owner.editorModule.layoutWholeDocument(),this.documentHelper.owner.editorModule.updateSelectionTextPosition(!1),t&&t.currentBaseHistoryInfo&&(t.currentBaseHistoryInfo.modifiedProperties.length>0&&t.currentBaseHistoryInfo.updateSelection(),t.updateHistory()),this.documentHelper.owner.editorModule.fireContentChange())}},n.prototype.destroy=function(){this.leftIndentIn=void 0;this.rightIndentIn=void 0;this.beforeSpacingIn=void 0;this.afterSpacingIn=void 0;this.firstLineIndentIn=void 0;this.lineSpacingIn=void 0;this.textAlignmentIn=void 0;this.lineSpacingTypeIn=void 0;this.listId=void 0;this.listLevelNumberIn=void 0;this.documentHelper=void 0;this.selection=void 0;this.styleName=void 0;this.bidi=void 0;this.contextualSpacing=void 0},n}(),he=function(){function n(n){this.differentFirstPageIn=void 0;this.differentOddAndEvenPagesIn=void 0;this.bidi=void 0;this.selection=n}return Object.defineProperty(n.prototype,"pageHeight",{get:function(){return this.pageHeightIn},set:function(n){this.pageHeightIn=n;this.notifyPropertyChanged("pageHeight")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageWidth",{get:function(){return this.pageWidthIn},set:function(n){this.pageWidthIn=n;this.notifyPropertyChanged("pageWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(n){this.leftMarginIn=n;this.notifyPropertyChanged("leftMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(n){this.bottomMarginIn=n;this.notifyPropertyChanged("bottomMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(n){this.topMarginIn=n;this.notifyPropertyChanged("topMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(n){this.rightMarginIn=n;this.notifyPropertyChanged("rightMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"headerDistance",{get:function(){return this.headerDistanceIn},set:function(n){this.headerDistanceIn=n;this.notifyPropertyChanged("headerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageStartingNumber",{get:function(){return this.pageStartingNumberIn},set:function(n){this.pageStartingNumberIn=n;this.notifyPropertyChanged("pageStartingNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"restartPageNumbering",{get:function(){return this.restartPageNumberingIn},set:function(n){this.restartPageNumberingIn=n;this.notifyPropertyChanged("restartPageNumbering")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"footerDistance",{get:function(){return this.footerDistanceIn},set:function(n){this.footerDistanceIn=n;this.notifyPropertyChanged("footerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"differentFirstPage",{get:function(){return this.differentFirstPageIn},set:function(n){this.differentFirstPageIn=n;this.notifyPropertyChanged("differentFirstPage")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"differentOddAndEvenPages",{get:function(){return this.differentOddAndEvenPagesIn},set:function(n){this.differentOddAndEvenPagesIn=n;this.notifyPropertyChanged("differentOddAndEvenPages")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"endnoteNumberFormat",{get:function(){return this.endnoteNumberFormatIn},set:function(n){this.endnoteNumberFormatIn=n;this.notifyPropertyChanged("endnoteNumberFormat")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"footNoteNumberFormat",{get:function(){return this.footNoteNumberFormatIn},set:function(n){this.footNoteNumberFormatIn=n;this.notifyPropertyChanged("footNoteNumberFormat")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"initialFootNoteNumber",{get:function(){return this.initialFootNoteNumberIn},set:function(n){this.initialFootNoteNumberIn=n;this.notifyPropertyChanged("initialFootNoteNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"initialEndNoteNumber",{get:function(){return this.initialEndNoteNumberIn},set:function(n){this.initialEndNoteNumberIn=n;this.notifyPropertyChanged("initialEndNoteNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"restartIndexForFootnotes",{get:function(){return this.restartIndexForFootnotesIn},set:function(n){this.restartIndexForFootnotesIn=n;this.notifyPropertyChanged("restartIndexForFootnotes")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"restartIndexForEndnotes",{get:function(){return this.restartIndexForEndnotesIn},set:function(n){this.restartIndexForEndnotesIn=n;this.notifyPropertyChanged("restartIndexForEndnotes")},enumerable:!0,configurable:!0}),n.prototype.copyFormat=function(n){this.pageHeight=n.pageHeight;this.pageWidth=n.pageWidth;this.leftMargin=n.leftMargin;this.topMargin=n.topMargin;this.rightMargin=n.rightMargin;this.bottomMargin=n.bottomMargin;this.headerDistance=n.headerDistance;this.footerDistance=n.footerDistance;this.differentFirstPage=n.differentFirstPage;this.differentOddAndEvenPages=n.differentOddAndEvenPages;this.bidi=n.bidi;this.pageStartingNumber=n.pageStartingNumber;this.restartPageNumbering=n.restartPageNumbering;this.endnoteNumberFormat=n.endnoteNumberFormat;this.footNoteNumberFormat=n.footNoteNumberFormat;this.restartIndexForEndnotes=n.restartIndexForEndnotes;this.restartIndexForFootnotes=n.restartIndexForFootnotes;this.initialEndNoteNumber=n.initialEndNoteNumber;this.initialFootNoteNumber=n.initialFootNoteNumber},n.prototype.notifyPropertyChanged=function(n){var t=this.selection,i;!sf.base.isNullOrUndefined(t)&&(t.isCleared||t.owner.isPastingContent||t.owner.isReadOnlyMode||!t.owner.isDocumentLoaded)&&!t.isRetrieveFormatting||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.start)||t.isRetrieveFormatting||(i=this.getPropertyvalue(n),sf.base.isNullOrUndefined(i)||t.owner.editorModule.onApplySectionFormat(n,i))},n.prototype.getPropertyvalue=function(n){switch(n){case"pageHeight":return this.pageHeight>0?this.pageHeight:void 0;case"pageWidth":return this.pageWidth>0?this.pageWidth:void 0;case"leftMargin":return this.leftMargin>=0?this.leftMargin:void 0;case"rightMargin":return this.rightMargin>=0?this.rightMargin:void 0;case"topMargin":return this.topMargin>=0?this.topMargin:void 0;case"bottomMargin":return this.bottomMargin>=0?this.bottomMargin:void 0;case"differentFirstPage":return sf.base.isNullOrUndefined(this.differentFirstPage)?void 0:this.differentFirstPage;case"differentOddAndEvenPages":return sf.base.isNullOrUndefined(this.differentOddAndEvenPages)?void 0:this.differentOddAndEvenPages;case"headerDistance":return this.headerDistanceIn;case"footerDistance":return this.footerDistance;case"pageStartingNumber":return sf.base.isNullOrUndefined(this.pageStartingNumber)?void 0:this.pageStartingNumber;case"restartPageNumbering":return sf.base.isNullOrUndefined(this.restartPageNumbering)?void 0:this.restartPageNumbering;case"endnoteNumberFormat":return this.endnoteNumberFormatIn;case"restartIndexForEndnotes":return this.restartIndexForEndnotesIn;case"restartIndexForFootnotes":return this.restartIndexForFootnotesIn;case"footNoteNumberFormat":return this.footNoteNumberFormatIn;case"initialFootNoteNumber":return this.initialFootNoteNumber;case"initialEndNoteNumber":return this.initialEndNoteNumber;default:return}},n.prototype.combineFormat=function(n){this.pageHeight>0&&this.pageHeight!==n.pageHeight&&(this.pageHeight=0);this.pageWidth>0&&this.pageWidth!==n.pageWidth&&(this.pageWidth=0);this.leftMargin>-1&&this.leftMargin!==n.leftMargin&&(this.leftMargin=-1);this.topMargin>-1&&this.topMargin!==n.topMargin&&(this.topMargin=-1);this.rightMargin>-1&&this.rightMargin!==n.rightMargin&&(this.rightMargin=-1);this.bottomMargin>-1&&this.bottomMargin!==n.bottomMargin&&(this.bottomMargin=-1);0!==this.headerDistance&&this.headerDistance!==n.headerDistance&&(this.headerDistance=0);0!==this.footerDistance&&this.footerDistance!==n.footerDistance&&(this.footerDistance=0);sf.base.isNullOrUndefined(this.differentFirstPage)||this.differentFirstPage===n.differentFirstPage||(this.differentFirstPage=void 0);sf.base.isNullOrUndefined(this.pageStartingNumber)||this.pageStartingNumber===n.pageStartingNumber||(this.pageStartingNumber=void 0);sf.base.isNullOrUndefined(this.restartPageNumbering)||this.restartPageNumbering===n.restartPageNumbering||(this.restartPageNumbering=void 0);sf.base.isNullOrUndefined(this.differentOddAndEvenPages)||this.differentOddAndEvenPages===n.differentOddAndEvenPages||(this.differentOddAndEvenPages=void 0);sf.base.isNullOrUndefined(this.bidi)||this.bidi===n.bidi||(this.bidi=void 0);sf.base.isNullOrUndefined(this.endnoteNumberFormat)||this.endnoteNumberFormat===n.endnoteNumberFormat||(this.endnoteNumberFormat=void 0);sf.base.isNullOrUndefined(this.restartIndexForEndnotes)||this.restartIndexForEndnotes===n.restartIndexForEndnotes||(this.restartIndexForEndnotes=void 0);sf.base.isNullOrUndefined(this.restartIndexForFootnotes)||this.restartIndexForFootnotes===n.restartIndexForFootnotes||(this.restartIndexForFootnotes=void 0);sf.base.isNullOrUndefined(this.footNoteNumberFormat)||this.footNoteNumberFormat===n.footNoteNumberFormat||(this.footNoteNumberFormat=void 0);sf.base.isNullOrUndefined(this.initialFootNoteNumber)||this.initialFootNoteNumber===n.initialFootNoteNumber||(this.initialFootNoteNumber=void 0);sf.base.isNullOrUndefined(this.initialEndNoteNumber)||this.initialEndNoteNumber===n.initialEndNoteNumber||(this.initialEndNoteNumber=void 0)},n.prototype.clearFormat=function(){this.headerDistance=0;this.footerDistance=0;this.pageHeight=0;this.pageWidth=0;this.leftMargin=-1;this.rightMargin=-1;this.topMargin=-1;this.bottomMargin=-1;this.differentFirstPage=void 0;this.differentOddAndEvenPages=void 0;this.bidi=void 0;this.pageStartingNumber=void 0;this.restartPageNumbering=void 0;this.endnoteNumberFormat=void 0;this.footNoteNumberFormat=void 0;this.restartIndexForFootnotes=void 0;this.restartIndexForEndnotes=void 0;this.initialFootNoteNumber=1;this.initialEndNoteNumber=1},n.prototype.destroy=function(){this.headerDistanceIn=void 0;this.footerDistanceIn=void 0;this.pageHeightIn=void 0;this.pageWidthIn=void 0;this.leftMarginIn=void 0;this.rightMarginIn=void 0;this.topMarginIn=void 0;this.bottomMarginIn=void 0;this.differentFirstPageIn=void 0;this.differentOddAndEvenPagesIn=void 0;this.selection=void 0;this.bidi=void 0;this.pageStartingNumberIn=void 0;this.restartPageNumberingIn=void 0;this.endnoteNumberFormatIn=void 0;this.footNoteNumberFormatIn=void 0;this.restartIndexForFootnotesIn=void 0;this.restartIndexForEndnotesIn=void 0;this.initialEndNoteNumber=void 0;this.initialFootNoteNumber=void 0},n}(),ce=function(){function n(n){this.leftIndentIn=0;this.backgroundIn=void 0;this.tableAlignmentIn=void 0;this.cellSpacingIn=0;this.leftMarginIn=0;this.rightMarginIn=0;this.topMarginIn=0;this.bottomMarginIn=0;this.preferredWidthIn=0;this.bidiIn=void 0;this.selection=n}return Object.defineProperty(n.prototype,"table",{get:function(){return this.tableIn},set:function(n){this.tableIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(n){n!==this.leftIndentIn&&(this.leftIndentIn=n,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(n){n!==this.topMarginIn&&(this.topMarginIn=n,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"background",{get:function(){return this.backgroundIn},set:function(n){n!==this.backgroundIn&&(this.backgroundIn=n,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"tableAlignment",{get:function(){return this.tableAlignmentIn},set:function(n){n!==this.tableAlignmentIn&&(this.tableAlignmentIn=n,this.notifyPropertyChanged("tableAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(n){n!==this.leftMarginIn&&(this.leftMarginIn=n,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(n){n!==this.bottomMarginIn&&(this.bottomMarginIn=n,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cellSpacing",{get:function(){return this.cellSpacingIn},set:function(n){n!==this.cellSpacingIn&&(this.cellSpacingIn=n,this.notifyPropertyChanged("cellSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(n){n!==this.rightMarginIn&&(this.rightMarginIn=n,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(n){n!==this.preferredWidthIn&&(this.preferredWidthIn=n,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(n){n!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=n,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bidi",{get:function(){return this.bidiIn},set:function(n){this.bidiIn=n;this.notifyPropertyChanged("bidi")},enumerable:!0,configurable:!0}),n.prototype.getPropertyValue=function(n){switch(n){case"tableAlignment":return this.tableAlignment;case"leftIndent":return this.leftIndent;case"cellSpacing":return this.cellSpacing;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"background":var t=new yi;return t.backgroundColor=this.background,t;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"bidi":return this.bidi;default:return}},n.prototype.notifyPropertyChanged=function(n){if((sf.base.isNullOrUndefined(this.selection)||!this.selection.isCleared&&this.selection.owner.isDocumentLoaded&&!this.selection.owner.isReadOnlyMode&&!this.selection.owner.isPastingContent||this.selection.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.getPropertyValue(n);"background"===n&&(n="shading");sf.base.isNullOrUndefined(t)||this.selection.owner.editorModule.onApplyTableFormat(n,t)}},n.prototype.copyFormat=function(n){this.leftIndent=n.leftIndent;this.background=n.shading.backgroundColor;this.tableAlignment=n.tableAlignment;this.leftMargin=n.leftMargin;this.rightMargin=n.rightMargin;this.topMargin=n.topMargin;this.bottomMargin=n.bottomMargin;this.cellSpacing=n.cellSpacing;this.preferredWidth=n.preferredWidth;this.preferredWidthType=n.preferredWidthType;this.bidi=n.bidi},n.prototype.clearFormat=function(){this.table=void 0;this.leftIndent=0;this.background=void 0;this.leftIndent=0;this.leftMargin=0;this.rightMargin=0;this.topMargin=0;this.bottomMargin=0;this.cellSpacing=0;this.tableAlignment=void 0;this.bidi=void 0},n.prototype.destroy=function(){this.leftIndentIn=void 0;this.backgroundIn=void 0;this.leftIndentIn=void 0;this.leftMarginIn=void 0;this.rightMarginIn=void 0;this.topMarginIn=void 0;this.bottomMarginIn=void 0;this.cellSpacingIn=void 0;this.tableAlignmentIn=void 0;this.tableIn=void 0;this.selection=void 0;this.bidi=void 0},n}(),le=function(){function n(n){this.verticalAlignmentIn=void 0;this.leftMarginIn=0;this.rightMarginIn=0;this.topMarginIn=0;this.bottomMarginIn=0;this.backgroundIn=void 0;this.preferredWidthTypeIn=void 0;this.selection=n}return Object.defineProperty(n.prototype,"verticalAlignment",{get:function(){return this.verticalAlignmentIn},set:function(n){n!==this.verticalAlignmentIn&&(this.verticalAlignmentIn=n,this.notifyPropertyChanged("verticalAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(n){n!==this.leftMarginIn&&(this.leftMarginIn=n,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(n){n!==this.rightMarginIn&&(this.rightMarginIn=n,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(n){n!==this.topMarginIn&&(this.topMarginIn=n,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(n){n!==this.bottomMarginIn&&(this.bottomMarginIn=n,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"background",{get:function(){return this.backgroundIn},set:function(n){n!==this.backgroundIn&&(this.backgroundIn=n,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(n){n!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=n,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(n){n!==this.preferredWidthIn&&(this.preferredWidthIn=n,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),n.prototype.notifyPropertyChanged=function(n){var t=this.selection,i;if(!sf.base.isNullOrUndefined(t)){if((t.isCleared||!t.owner.isDocumentLoaded||t.owner.isReadOnlyMode||t.owner.isPastingContent)&&!t.isRetrieveFormatting)return;sf.base.isNullOrUndefined(this.selection.start)||this.selection.isRetrieveFormatting||(i=this.getPropertyValue(n),"background"===n&&(n="shading"),sf.base.isNullOrUndefined(i)||this.selection.owner.editorModule.onApplyTableCellFormat(n,i))}},n.prototype.getPropertyValue=function(n){switch(n){case"verticalAlignment":return this.verticalAlignment;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"background":var t=new yi;return t.backgroundColor=this.background,t;default:return}},n.prototype.copyFormat=function(n){this.leftMargin=n.leftMargin;this.rightMargin=n.rightMargin;this.topMargin=n.topMargin;this.bottomMargin=n.bottomMargin;this.background=n.shading.backgroundColor;this.verticalAlignment=n.verticalAlignment;this.preferredWidth=n.preferredWidth;this.preferredWidthType=n.preferredWidthType},n.prototype.clearCellFormat=function(){this.leftMargin=void 0;this.rightMargin=void 0;this.topMargin=void 0;this.bottomMargin=void 0;this.background=void 0;this.verticalAlignment=void 0},n.prototype.combineFormat=function(n){sf.base.isNullOrUndefined(this.leftMargin)||this.leftMargin===n.leftMargin||(this.leftMargin=void 0);sf.base.isNullOrUndefined(this.topMargin)||this.topMargin===n.topMargin||(this.topMargin=void 0);sf.base.isNullOrUndefined(this.rightMargin)||this.rightMargin===n.rightMargin||(this.rightMargin=void 0);sf.base.isNullOrUndefined(this.bottomMargin)||this.bottomMargin===n.bottomMargin||(this.bottomMargin=void 0);sf.base.isNullOrUndefined(this.background)||this.background===n.shading.backgroundColor||(this.background=void 0);sf.base.isNullOrUndefined(this.verticalAlignment)||this.verticalAlignment===n.verticalAlignment||(this.verticalAlignment=void 0);sf.base.isNullOrUndefined(this.preferredWidth)||this.preferredWidth===n.preferredWidth||(this.preferredWidth=void 0);sf.base.isNullOrUndefined(this.preferredWidthType)||this.preferredWidthType===n.preferredWidthType||(this.preferredWidthType=void 0)},n.prototype.clearFormat=function(){this.background=void 0;this.bottomMargin=0;this.leftMargin=0;this.rightMargin=0;this.topMargin=0;this.verticalAlignment=void 0},n.prototype.destroy=function(){this.backgroundIn=void 0;this.verticalAlignmentIn=void 0;this.bottomMarginIn=void 0;this.leftMarginIn=void 0;this.rightMarginIn=void 0;this.topMarginIn=void 0;this.selection=void 0},n}(),ae=function(){function n(n){this.heightIn=void 0;this.heightTypeIn=void 0;this.isHeaderIn=void 0;this.allowRowBreakAcrossPagesIn=void 0;this.selection=n}return Object.defineProperty(n.prototype,"height",{get:function(){return this.heightIn},set:function(n){n!==this.heightIn&&(this.heightIn=n,this.notifyPropertyChanged("height"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"heightType",{get:function(){return this.heightTypeIn},set:function(n){n!==this.heightTypeIn&&(this.heightTypeIn=n,this.notifyPropertyChanged("heightType"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isHeader",{get:function(){return this.isHeaderIn},set:function(n){n!==this.isHeaderIn&&(this.isHeaderIn=n,this.notifyPropertyChanged("isHeader"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"allowBreakAcrossPages",{get:function(){return this.allowRowBreakAcrossPagesIn},set:function(n){n!==this.allowRowBreakAcrossPagesIn&&(this.allowRowBreakAcrossPagesIn=n,this.notifyPropertyChanged("allowBreakAcrossPages"))},enumerable:!0,configurable:!0}),n.prototype.notifyPropertyChanged=function(n){var t=this.selection,i;!sf.base.isNullOrUndefined(t)&&(t.isCleared||t.owner.isReadOnlyMode||!t.owner.isDocumentLoaded||t.owner.isPastingContent)&&!t.isRetrieveFormatting||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.start)||t.isRetrieveFormatting||(i=this.getPropertyValue(n),sf.base.isNullOrUndefined(i)||t.owner.editorModule.onApplyTableRowFormat(n,i))},n.prototype.getPropertyValue=function(n){switch(n){case"height":return this.height;case"heightType":return this.heightType;case"isHeader":return this.isHeader;case"allowBreakAcrossPages":return this.allowBreakAcrossPages;default:return}},n.prototype.copyFormat=function(n){this.height=n.height;this.heightType=n.heightType;this.allowBreakAcrossPages=n.allowBreakAcrossPages;this.isHeader=n.isHeader},n.prototype.combineFormat=function(n){sf.base.isNullOrUndefined(this.height)||this.height===n.height||(this.height=void 0);sf.base.isNullOrUndefined(this.heightType)||this.heightType===n.heightType||(this.heightType=void 0);sf.base.isNullOrUndefined(this.allowBreakAcrossPages)||this.allowBreakAcrossPages===n.allowBreakAcrossPages||(this.allowBreakAcrossPages=void 0);sf.base.isNullOrUndefined(this.isHeader)||this.isHeader===n.isHeader||(this.isHeader=void 0)},n.prototype.clearRowFormat=function(){this.height=void 0;this.heightType=void 0;this.allowBreakAcrossPages=void 0;this.isHeader=void 0},n.prototype.clearFormat=function(){this.height=0;this.heightType=void 0;this.allowBreakAcrossPages=void 0;this.isHeader=void 0},n.prototype.destroy=function(){this.heightIn=void 0;this.heightTypeIn=void 0;this.allowRowBreakAcrossPagesIn=void 0;this.isHeaderIn=void 0;this.selection=void 0},n}(),ve=function(){function n(n){this.selection=n}return Object.defineProperty(n.prototype,"width",{get:function(){return this.image?this.image.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.image?this.image.height:0},enumerable:!0,configurable:!0}),n.prototype.resize=function(n,t){this.updateImageFormat(n,t)},n.prototype.updateImageFormat=function(n,t){this.image&&this.selection.owner.editorModule&&this.selection.owner.editorModule.onImageFormat(this.image,n,t)},n.prototype.copyImageFormat=function(n){this.image=n},n.prototype.clearImageFormat=function(){this.image=void 0},n}(),ye=function(){function n(){this.document=void 0;this.prevListLevel=void 0;this.isOrdered=void 0;this.fieldCheck=0;this.isMergeField=!1}return n.prototype.writeHtml=function(n){this.document=n;for(var i="",t=0;t<n.sections.length;t++)i+=this.serializeSection(n.sections[t]);return i},n.prototype.serializeSection=function(n){for(var i,t="",r=0;r<n.blocks.length;r++)i=n.blocks[r],i.hasOwnProperty("inlines")?t+=this.serializeParagraph(i):i.hasOwnProperty("blocks")?t+=this.serializeSection(i):(t+=this.closeList(),t+=this.serializeTable(i));return t+=this.closeList(),this.prevListLevel=void 0,this.isOrdered=void 0,t},n.prototype.serializeParagraph=function(n){var t="",r=!1,u=!1,f,i;return sf.base.isNullOrUndefined(this.prevListLevel)||(u=!0),f=[],i=void 0,sf.base.isNullOrUndefined(n.paragraphFormat.listFormat)||(i=this.getListLevel(n),u||(this.prevListLevel=i),this.prevListLevel!==i&&(u=!1),this.prevListLevel=i),u||(t+=this.closeList()),sf.base.isNullOrUndefined(i)||(r=!0),r&&!u&&(t+=this.getHtmlList(i,n.paragraphFormat.listFormat.listLevelNumber)),f.push('style="'+this.serializeParagraphStyle(n,"",r)+';white-space:pre"'),r?t+=this.createAttributesTag("li",f):(this.prevListLevel=void 0,this.isOrdered=void 0,t+=this.createAttributesTag(this.getStyleName(n.paragraphFormat.styleName),f)),0===n.inlines.length?t+="&nbsp":t=this.serializeInlines(n,t),r?(t+=this.endTag("li")).indexOf("<ul")>-1?this.isOrdered=!1:t.indexOf("<ol")>-1&&(this.isOrdered=!0):t+=this.endTag(this.getStyleName(n.paragraphFormat.styleName)),t},n.prototype.closeList=function(){var n="";return sf.base.isNullOrUndefined(this.isOrdered)||(n=this.isOrdered?this.endTag("ol"):this.endTag("ul"),this.isOrdered=void 0),n},n.prototype.getListLevel=function(n){for(var t,u=void 0,r=void 0,i=0;i<this.document.lists.length;i++)if(this.document.lists[i].listId===n.paragraphFormat.listFormat.listId){r=this.document.lists[i];break}if(r)for(t=0;t<this.document.abstractLists.length;t++)if(this.document.abstractLists[t].abstractListId===r.abstractListId){u=this.document.abstractLists[t].levels[n.paragraphFormat.listFormat.listLevelNumber];break}return u},n.prototype.getHtmlList=function(n,t){var i="";if("Bullet"===n.listLevelPattern){switch(i+='<ul type="',t){case 0:i+="disc";n.characterFormat.fontFamily="Symbol";break;case 1:i+="circle";n.characterFormat.fontFamily="Symbol";break;case 2:i+="square";n.characterFormat.fontFamily="Wingdings";break;default:i+="disc";n.characterFormat.fontFamily="Symbol"}i+='">'}else{switch(i+='<ol type="',n.listLevelPattern){case"LowLetter":i+="a";break;case"UpLetter":i+="A";break;case"LowRoman":i+="i";break;case"UpRoman":i+="I";break;default:i+="1"}i+='" start="'+n.startAt.toString()+'">'}return i},n.prototype.serializeInlines=function(n,t){for(var u,f,i=void 0,e=0,r=[];n.inlines.length>e;)(i=n.inlines[e]).hasOwnProperty("inlines")?(t+=this.serializeContentInlines(i,t),e++):(i.hasOwnProperty("imageString")?t+=this.serializeImageContainer(i):i.hasOwnProperty("fieldType")?0===i.fieldType?(u=n.inlines[e+1],sf.base.isNullOrUndefined(u.text)&&(u=n.inlines[e+2]),sf.base.isNullOrUndefined(u)||sf.base.isNullOrUndefined(u.text)||!(u.text.indexOf("TOC")>=0||u.text.indexOf("HYPERLINK")>=0)?u.text.toLowerCase().indexOf("mergefield")>=0?(this.isMergeField=!0,(r=[]).push('style="mso-element:field-begin"'),t+="<!--[if supportFields]>",t+=this.createAttributesTag("span",r),t+=this.endTag("span"),r=[]):this.fieldCheck=void 0:(this.fieldCheck=1,(r=[]).push('style="'+this.serializeInlineStyle(i.characterFormat)+'"'),t+=this.createAttributesTag("a",r))):2===i.fieldType?(this.isMergeField&&((r=[]).push('style="mso-element:field-separator"'),t+=this.createAttributesTag("span",r),t+=this.endTag("span"),t+="<![endif]-->"),this.fieldCheck=sf.base.isNullOrUndefined(this.fieldCheck)?0:2):(this.isMergeField?(t+="<!--[if supportFields]>",(r=[]).push('style="mso-element:field-end"'),t+=this.createAttributesTag("span",r),t+=this.endTag("span"),t+="<![endif]-->"):sf.base.isNullOrUndefined(this.fieldCheck)||0===this.fieldCheck||(t+=this.endTag("a")),this.fieldCheck=0):(f=sf.base.isNullOrUndefined(i.text)?"":i.text,(0===this.fieldCheck&&(f.indexOf("MERGEFIELD")>=0&&this.isMergeField?((r=[]).push('style="'+this.serializeInlineStyle(i.characterFormat)+'"'),t+=this.createAttributesTag("span",r),t+=f,t+=this.endTag("span")):t+=this.serializeSpan(f,i.characterFormat)),1===this.fieldCheck&&-1===f.indexOf("MERGEFIELD"))&&(t+=' href= "'+f.replace(/"/g,"").replace("HYPERLINK","").trim(),t+='"',t+=">"),2===this.fieldCheck&&(this.isMergeField?((r=[]).push('style="'+this.serializeInlineStyle(i.characterFormat)+'"'),t+=this.createAttributesTag("span",r),t+=f,t+=this.endTag("span")):(t+=this.createAttributesTag("span",[]),t+=this.endTag("span"),t+=f))),e++);return t},n.prototype.serializeContentInlines=function(n,t){return t+this.serializeInlines(n,t)},n.prototype.serializeSpan=function(n,t){var i="",u,r;return-1!==n.indexOf("\v")?(i+="<br>").toString():-1!==n.indexOf("\f")?(i+='<br style = "page-break-after:always;"/>').toString():(u=[],this.serializeInlineStyle(t),u.push('style="'+this.serializeInlineStyle(t)+'"'),i+=this.createAttributesTag("span",u),r=this.decodeHtmlNames(n.toString()),0===r.length&&(r="&nbsp"),i+=r,(i+=this.endTag("span")).toString())},n.prototype.getStyleName=function(n){switch(n){case"Heading 1":return"h1";case"Heading 2":return"h2";case"Heading 3":return"h3";case"Heading 4":return"h4";case"Heading 5":return"h5";default:return"div"}},n.prototype.serializeImageContainer=function(n){var u="",i=[],r,f,e;return this.serializeInlineStyle(n.characterFormat),r="",sf.base.isNullOrUndefined(n.imageString)||(r=n.imageString),f=t.convertPointToPixel(n.width),e=t.convertPointToPixel(n.height),i.push('width="'+f.toString()+'"'),i.push('height="'+e.toString()+'"'),i.push('src="'+r+'"'),u+=this.createAttributesTag("img",i),(u+=this.endTag("img")).toString()},n.prototype.serializeCell=function(n){var e="",i=[],r="",o,s,u,f;for((i=[],sf.base.isNullOrUndefined(n.cellFormat))||((sf.base.isNullOrUndefined(n.cellFormat.shading.backgroundColor)||i.push('bgcolor="'+t.getColor(n.cellFormat.shading.backgroundColor)+'"'),!sf.base.isNullOrUndefined(n.cellFormat.columnSpan)&&n.cellFormat.columnSpan>1&&i.push('colspan="'+n.cellFormat.columnSpan.toString()+'"'),!sf.base.isNullOrUndefined(n.cellFormat.rowSpan)&&n.cellFormat.rowSpan>1&&i.push('rowspan="'+n.cellFormat.rowSpan.toString()+'"'),sf.base.isNullOrUndefined(n.cellFormat.cellWidth)||0===n.cellFormat.cellWidth)||(o=t.convertPointToPixel(n.cellFormat.cellWidth),i.push('width="'+o.toString()+'"')),s=sf.base.isNullOrUndefined(n.cellFormat.verticalAlignment)?"top":n.cellFormat.verticalAlignment.toString().toLowerCase(),i.push('valign="'+s+'"'),sf.base.isNullOrUndefined(n.cellFormat.leftMargin)||0===n.cellFormat.leftMargin||(r+="padding-left:"+n.cellFormat.leftMargin.toString()+"pt;"),sf.base.isNullOrUndefined(n.cellFormat.rightMargin)||0===n.cellFormat.rightMargin||(r+="padding-right:"+n.cellFormat.rightMargin.toString()+"pt;"),sf.base.isNullOrUndefined(n.cellFormat.topMargin)||0===n.cellFormat.topMargin||(r+="padding-top:"+n.cellFormat.topMargin.toString()+"pt;"),sf.base.isNullOrUndefined(n.cellFormat.bottomMargin)||0===n.cellFormat.bottomMargin||(r+="padding-bottom:"+n.cellFormat.bottomMargin.toString()+"pt;"),sf.base.isNullOrUndefined(n.cellFormat.borders)||(r+=this.serializeCellBordersStyle())),0!==r.length&&i.push('style="'+r+'"'),e+=this.createAttributesTag("td",i),u=0;u<n.blocks.length;u++)f=n.blocks[u],e+=f.hasOwnProperty("rows")?this.serializeTable(f):this.serializeParagraph(f);return e+this.endTag("td")},n.prototype.serializeTable=function(n){var i="",t;for(i+=this.createTableStartTag(n),t=0;t<n.rows.length;t++)i+=this.serializeRow(n.rows[t]);return i+this.createTableEndTag()},n.prototype.serializeRow=function(n){var i="",t;for(i+=this.createRowStartTag(n),t=0;t<n.cells.length;t++)i+=this.serializeCell(n.cells[t]);return i},n.prototype.serializeParagraphStyle=function(n,t,i){var r="";return r+=this.serializeCharacterFormat(n.characterFormat),r+this.serializeParagraphFormat(n.paragraphFormat,i)},n.prototype.serializeInlineStyle=function(n){return this.serializeCharacterFormat(n)},n.prototype.serializeTableBorderStyle=function(n){var i="";return sf.base.isNullOrUndefined(n.left.lineStyle)||(i+="border-left-style:"+this.convertBorderLineStyle(n.left.lineStyle),i+=";"),n.left.lineWidth&&(i+="border-left-width:"+n.left.lineWidth.toString()+"pt",i+=";"),sf.base.isNullOrUndefined(n.left.color)||(i+="border-left-color:"+t.getColor(n.left.color),i+=";"),sf.base.isNullOrUndefined(n.right.lineStyle)||(i+="border-right-style:"+this.convertBorderLineStyle(n.right.lineStyle),i+=";"),sf.base.isNullOrUndefined(n.right.lineWidth)||(i+="border-right-width:"+n.right.lineWidth.toString()+"pt",i+=";"),sf.base.isNullOrUndefined(n.right.color)||(i+="border-right-color:"+t.getColor(n.right.color),i+=";"),sf.base.isNullOrUndefined(n.top.lineStyle)||(i+="border-top-style:"+this.convertBorderLineStyle(n.top.lineStyle),i+=";"),sf.base.isNullOrUndefined(n.top.lineWidth)||(i+="border-top-width:"+n.top.lineWidth.toString()+"pt",i+=";"),sf.base.isNullOrUndefined(n.top.color)||(i+="border-top-color:"+t.getColor(n.bottom.color),i+=";"),sf.base.isNullOrUndefined(n.bottom.lineStyle)||(i+="border-bottom-style:"+this.convertBorderLineStyle(n.bottom.lineStyle),i+=";"),sf.base.isNullOrUndefined(n.bottom.lineWidth)||(i+="border-bottom-width:"+n.bottom.lineWidth.toString()+"pt",i+=";"),sf.base.isNullOrUndefined(n.bottom.color)||(i+="border-bottom-color:"+t.getColor(n.bottom.color),i+=";"),i},n.prototype.serializeCellBordersStyle=function(){return"border:solid 1px;"},n.prototype.serializeBorderStyle=function(n,i){var r="";return r+="border-"+i+"-style:"+this.convertBorderLineStyle(n.lineStyle),r+=";",n.lineWidth>0&&(r+="border-"+i+"-width:"+n.lineWidth.toString()+"pt;"),sf.base.isNullOrUndefined(n.color)||(r+="border-"+i+"-color:"+t.getColor(n.color)+";"),r},n.prototype.convertBorderLineStyle=function(n){switch(n){case"None":return"none";case"Single":return"solid";case"Dot":return"dotted";case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":return"dashed";case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":return"double";case"SingleWavy":return"solid";case"DoubleWavy":return"double";case"DashDotStroked":return"solid";case"Emboss3D":return"ridge";case"Engrave3D":return"groove";case"Outset":return"outset";case"Inset":return"inset";default:return"solid"}},n.prototype.serializeCharacterFormat=function(n){if(!sf.base.isNullOrUndefined(n.inlineFormat))return this.serializeCharacterFormat(n.inlineFormat);var r,i="";return i+="font-weight",i+=":",i+=n.bold?"bold":"normal",i+=";",i+="font-style",i+=":",i+=n.italic?"italic":"normal",i+=";",i+=this.serializeTextDecoration(n),"Superscript"!==n.baselineAlignment&&"Subscript"!==n.baselineAlignment||(i+="vertical-align",i+=":",i+="Superscript"===n.baselineAlignment?"super":"sub",i+=";"),sf.base.isNullOrUndefined(n.highlightColor)||"NoColor"===n.highlightColor||(i+="background-color",i+=":",i+=t.getColor(n.highlightColor.toString()),i+=";"),r=n.fontColor,sf.base.isNullOrUndefined(r)||(i+="color",i+=":",i+=t.getColor(r),i+=";"),!sf.base.isNullOrUndefined(n.allCaps)&&n.allCaps&&(i+="text-transform",i+=":",i+="uppercase",i+=";"),r=n.fontSize,sf.base.isNullOrUndefined(r)||(i+="font-size",i+=":",i+=r.toString(),i+="pt",i+=";"),r=n.fontFamily,sf.base.isNullOrUndefined(r)||(i+="font-family",i+=":",i+=r.toString(),i+=";"),i.toString()},n.prototype.serializeTextDecoration=function(n){var t="";return"SingleStrike"!==n.strikethrough&&"DoubleStrike"!==n.strikethrough||(t+="line-through "),sf.base.isNullOrUndefined(n.underline)||"None"===n.underline||(t+="underline"),t.length>1&&(t="text-decoration:"+t+";"),t},n.prototype.serializeParagraphFormat=function(n,t){if(!sf.base.isNullOrUndefined(n.inlineFormat))return this.serializeParagraphFormat(n.inlineFormat,t);var i,r="";return i=n.textAlignment,sf.base.isNullOrUndefined(i)||(r+="text-align:"+i.toLowerCase()+";"),i=n.beforeSpacing,sf.base.isNullOrUndefined(i)||(r+="margin-top:"+i.toString()+"pt; "),i=n.rightIndent,sf.base.isNullOrUndefined(i)||(r+="margin-right:"+i.toString()+"pt; "),i=n.afterSpacing,sf.base.isNullOrUndefined(i)||(r+="margin-bottom:"+i.toString()+"pt; "),i=n.leftIndent,t&&(i=0),sf.base.isNullOrUndefined(i)||(r+="margin-left:"+i.toString()+"pt; "),i=n.firstLineIndent,t&&(i=0),sf.base.isNullOrUndefined(i)||0===i||(r+="text-indent:"+i.toString()+"pt;"),i=n.lineSpacing,sf.base.isNullOrUndefined(i)||(r+="line-height:"+(i="Multiple"===n.lineSpacingType?Math.round(10*i)/10:i.toString()+"pt;")),r.toString()},n.prototype.createAttributesTag=function(n,t){var i="",r;for(i+="<",i+=n,r=0;r<t.length;r++)i+=" ",i+=t[r];return"a"!==n&&(i+=">"),i},n.prototype.createTag=function(n){var t="";return t+="<",t+=n,t+">"},n.prototype.endTag=function(n){var t="";return t+="<",t+="/",t+=n,t+">"},n.prototype.createTableStartTag=function(n){var r="",i=[];return i.push('border="1"'),sf.base.isNullOrUndefined(n.tableFormat)||(sf.base.isNullOrUndefined(n.tableFormat.shading)||sf.base.isNullOrUndefined(n.tableFormat.shading.backgroundColor)||i.push('bgcolor="'+t.getColor(n.tableFormat.shading.backgroundColor)+'"'),sf.base.isNullOrUndefined(n.tableFormat.leftIndent)||0===n.tableFormat.leftIndent||i.push('left-indent="'+n.tableFormat.leftIndent.toString()+'pt;"'),!sf.base.isNullOrUndefined(n.tableFormat.cellSpacing)&&n.tableFormat.cellSpacing>0?i.push('cellspacing="'+(72*n.tableFormat.cellSpacing/48).toString()+'"'):r+="border-collapse:collapse;",i.push('cellpadding="0"'),sf.base.isNullOrUndefined(n.tableFormat.borders)||(r+=this.serializeTableBorderStyle(n.tableFormat.borders))),0!==r.length&&i.push('style="',r.toString()+'"'),""+this.createAttributesTag("table",i)},n.prototype.createTableEndTag=function(){return""+this.endTag("table")},n.prototype.createRowStartTag=function(n){var i="",r=[],u;return(n.rowFormat.isHeader&&(i+=this.createTag("thead")),!sf.base.isNullOrUndefined(n.rowFormat.height)&&n.rowFormat.height>0)&&(u=t.convertPointToPixel(n.rowFormat.height),r.push('height="'+u+'"')),i+this.createAttributesTag("tr",r)},n.prototype.createRowEndTag=function(n){var t="";return t+=this.endTag("tr"),n.rowFormat.isHeader&&(t+=this.endTag("thead")),t},n.prototype.decodeHtmlNames=function(n){var t,i,r;if("\t"===n)return"&emsp;";if(t=(n=n.replace(/</g,"&lt;").replace(/>/g,"&gt;")).split(" "),i="",t.length>0)for(i=t[0],r=0;r<t.length-1;r++)i+=" "+t[r+1];return i},n}(),l=function(){function n(n){this.location=new d(0,0);this.isUpdateLocation=!0;this.owner=n;this.documentHelper=this.owner.documentHelper}return Object.defineProperty(n.prototype,"paragraph",{get:function(){return this.currentWidget.paragraph},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isAtParagraphStart",{get:function(){return this.offset===this.owner.selection.getStartOffset(this.paragraph)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isAtParagraphEnd",{get:function(){return this.owner.selection.isParagraphLastLine(this.currentWidget)&&this.offset===this.owner.selection.getLineLength(this.currentWidget)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isCurrentParaBidi",{get:function(){return!sf.base.isNullOrUndefined(this.currentWidget.paragraph)&&this.currentWidget.paragraph.paragraphFormat.bidi},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selection",{get:function(){return this.owner.selection},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hierarchicalPosition",{get:function(){return this.getHierarchicalIndexInternal()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),n.prototype.clone=function(){var t=new n(this.owner);return t.currentWidget=this.currentWidget,t.offset=this.offset,t.location=this.location,t},n.prototype.containsRtlText=function(n){for(var t=0;t<n.children.length;t++)if(n.children[t].isRightToLeft)return!0;return!1},n.prototype.setPositionForSelection=function(n,t,i,u){var f=!1;sf.base.isNullOrUndefined(t)?this.currentWidget=n:(this.currentWidget=t.line,_instanceof(t.nextNode,r)&&i>t.length&&(f=this.selection.isLastRenderedInline(t,t.length)));this.location=u;this.offset=f?this.selection.getParagraphLength(this.currentWidget.paragraph)+1:this.currentWidget.getOffset(t,i)},n.prototype.setPositionFromLine=function(n,t,i){this.currentWidget=n;this.offset=t;_instanceof(i,d)&&this.location.copy(i)},n.prototype.setPosition=function(n,t){this.currentWidget=n;this.offset=t?this.selection.getStartOffset(n.paragraph):n.paragraph.lastChild.getEndOffset()+1;this.updatePhysicalPosition(!0)},n.prototype.setPositionInternal=function(n){this.currentWidget=n.currentWidget;this.offset=n.offset;this.location=n.location},n.prototype.setPositionForCurrentIndex=function(n){var t={index:n},i=this.getParagraphWidget(t);this.offset=parseFloat(t.index);this.setPositionParagraph(i,this.offset)},n.prototype.getPage=function(n){var t=n.index.indexOf(";"),i="0";return t>=0&&(i=n.index.substring(0,t),n.index=n.index.substring(t).replace(";","")),t=parseInt(i,10),this.documentHelper.pages[t]},n.prototype.getParagraphWidget=function(n){if(!sf.base.isNullOrUndefined(n.index)){var t=this.getPage(n);return this.getLineWidget(void 0,n,t)}},n.prototype.getLineWidget=function(n,t,i){var r,u,e;if(!sf.base.isNullOrUndefined(t.index))if(r=t.index.indexOf(";"),u="0",r>=0&&(u=t.index.substring(0,r),t.index=t.index.substring(r).replace(";","")),"H"===u||"F"===u?n="H"===u?i.headerWidget:i.footerWidget:"FN"===u||"EN"===u?n="FN"===u?i.footnoteWidget:i.endnoteWidget:sf.base.isNullOrUndefined(i)||(n=i.bodyWidgets[0]),r=parseInt(u,10),_instanceof(n,ri)&&(r=t.index.indexOf(";"),u="0",u=t.index.substring(0,r),t.index=t.index.substring(r).replace(";",""),r=parseInt(u,10)),_instanceof(n,a)&&r>=n.childWidgets.length&&(t.index="0;0",r=n.childWidgets.length-1),r>=0&&r<n.childWidgets.length){if(e=n.childWidgets[r],_instanceof(e,k))return t.index.indexOf(";")>0&&(t.index="0"),e;if(_instanceof(e,gt))return t.index.indexOf(";")>0?this.getLineWidget(e,t):_instanceof(e,f)?this.getLineWidget(this.selection.getFirstParagraphInFirstCell(e),t):_instanceof(e,a)&&-1===t.index.indexOf(";")?this.selection.getFirstParagraphInFirstCell(e.ownerTable).childWidgets[0]:void 0}else if(_instanceof(n.nextRenderedWidget,gt))return t.index="0",_instanceof(n.nextRenderedWidget,f)?this.selection.getFirstParagraphInFirstCell(n.nextRenderedWidget).firstChild:this.getLineWidget(n.nextRenderedWidget,t)},n.prototype.updatePhysicalPosition=function(n){this.currentWidget&&this.owner.isLayoutEnabled&&this.isUpdateLocation&&(this.location=this.selection.getPhysicalPositionInternal(this.currentWidget,this.offset,n))},n.prototype.isAtSamePosition=function(n){return this.currentWidget===n.currentWidget&&this.offset===n.offset},n.prototype.isInSameParagraphIndex=function(n){if(sf.base.isNullOrUndefined(n))throw new Error("textPosition is undefined.");return this.paragraph.index===n.paragraph.index},n.prototype.isInSameParagraph=function(n){if(sf.base.isNullOrUndefined(n))throw new Error("textPosition is undefined.");return this.paragraph===n.paragraph},n.prototype.isExistBefore=function(n){if(sf.base.isNullOrUndefined(n))throw new Error("textPosition is undefined.");if(this.currentWidget===n.currentWidget)return this.offset<n.offset;var t=this.currentWidget.paragraph,i=n.currentWidget.paragraph;return t===i?t.childWidgets.indexOf(this.currentWidget)<i.childWidgets.indexOf(n.currentWidget):t.containerWidget===i.containerWidget?t.isInsideTable?t.associatedCell.childWidgets.indexOf(t)<i.associatedCell.childWidgets.indexOf(i):t.containerWidget.childWidgets.indexOf(t)<i.containerWidget.childWidgets.indexOf(i):this.owner.selection.isExistBefore(t,i)},n.prototype.isExistAfter=function(n){if(sf.base.isNullOrUndefined(n))throw new Error("textPosition is undefined.");if(this.currentWidget===n.currentWidget)return this.offset>n.offset;if(this.currentWidget.paragraph===n.currentWidget.paragraph)return this.currentWidget.paragraph.childWidgets.indexOf(this.currentWidget)>n.currentWidget.paragraph.childWidgets.indexOf(n.currentWidget);var t=this.currentWidget.paragraph,i=n.currentWidget.paragraph;return _instanceof(t.containerWidget,c)&&_instanceof(i.containerWidget,c)&&t.containerWidget===i.containerWidget?t.isInsideTable&&i.isInsideTable?t.associatedCell.childWidgets.indexOf(t)>i.associatedCell.childWidgets.indexOf(i):t.containerWidget.childWidgets.indexOf(t)>i.containerWidget.childWidgets.indexOf(i):this.owner.selection.isExistAfter(t,i)},n.prototype.getHierarchicalIndexInternal=function(){return this.getHierarchicalIndex(this.currentWidget,this.offset.toString())},n.prototype.getHierarchicalIndex=function(n,t){return n?n.getHierarchicalIndex(t):t},n.prototype.setPositionParagraph=function(n,t){this.currentWidget=n;this.offset=t;this.updatePhysicalPosition(!0)},n.prototype.setPositionForLineWidget=function(n,t){var u=this.selection.getLineLength(n),f=n.paragraph.childWidgets.indexOf(n),i,r,e,o;(n.isLastLine()&&(u+=sf.base.isNullOrUndefined(n.paragraph.footNoteReference)?1:n.paragraph.footNoteReference.text.length),t>u)?(i=void 0,f>=n.paragraph.childWidgets.length-1?(r=this.selection.getNextRenderedBlock(n.paragraph),r&&r.index===n.paragraph.index&&(i=r.firstChild)):i=n.paragraph.childWidgets[f+1],this.setPositionForLineWidget(i,t-u)):t<0?(e=n.paragraph.childWidgets[f-1],o=this.selection.getLineLength(e)+t,this.setPositionForLineWidget(e,o)):(this.currentWidget=n,this.offset=t,this.updatePhysicalPosition(!0))},n.prototype.moveNextPosition=function(t){var i,o,f,s,h;if(sf.base.isNullOrUndefined(t)&&(t=!0),i=this.selection.getNextStartInline(this.currentWidget,this.offset),_instanceof(i,r)&&0===i.fieldType&&!sf.base.isNullOrUndefined(i.fieldEnd)){if(t)return this.moveNextPositionInternal(i),void this.moveNextPosition();var c=i.fieldEnd.line,v=i.fieldEnd,y=c.getOffset(v,1),p=this.getHierarchicalIndex(c,y.toString());if(n.isForwardSelection(this.selection.end.getHierarchicalIndexInternal(),p))return void this.selection.end.moveToInline(i.fieldEnd,1);this.moveToInline(i.fieldEnd,1)}var l=this.selection.getNextValidOffset(this.currentWidget,this.offset),a=this.paragraph.childWidgets.indexOf(this.currentWidget),u=0;l>this.offset?(this.offset=l,o=this.currentWidget.getInline(this.offset,u),(i=o.element,u=o.index,!sf.base.isNullOrUndefined(i)&&u===i.length&&(_instanceof(i.nextNode,r)||_instanceof(i.nextNode,e)))&&(f=this.selection.getNextValidElement(i.nextNode),(_instanceof(f,r)&&1===f.fieldType||_instanceof(f,e)&&1===f.bookmarkType)&&(i=f,this.currentWidget=i.line,this.offset=this.currentWidget.getOffset(i,this.documentHelper.isFormFillProtectedMode?0:1)))):a+1<this.paragraph.childWidgets.length?(s=this.paragraph.childWidgets[a+1],s&&(this.currentWidget=s,this.offset=this.selection.getStartLineOffset(this.currentWidget)),h=this.currentWidget.getInline(this.offset,u),i=h.element,u=h.index,_instanceof(i,r)&&0===i.fieldType&&this.offset++):this.updateOffsetToNextParagraph(u,!1);this.updatePhysicalPosition(!0)},n.prototype.moveToPreviousParagraphInTable=function(n){var t,i=this.currentWidget.paragraph;t=i.isInsideTable?n.getPreviousSelectionCell(i.associatedCell):n.getPreviousParagraphBlock(i);sf.base.isNullOrUndefined(t)||(this.currentWidget=t.childWidgets[t.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},n.prototype.updateOffsetToNextParagraph=function(n,t){var u,o=!1,i=void 0,h=this.paragraph.childWidgets.indexOf(this.currentWidget),f,e;t?h+1<this.paragraph.childWidgets.length?(f=this.paragraph.childWidgets[h+1],f&&(this.currentWidget=f,this.offset=1)):(i=this.selection.getNextSelectionBlock(this.paragraph),sf.base.isNullOrUndefined(i))||_instanceof(i.containerWidget,s)&&(o=this.selection.start.paragraph.isInsideTable?!this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,i.associatedCell).ownerTable.contains(i.associatedCell):!0):i=this.selection.getNextParagraphBlock(this.paragraph);!sf.base.isNullOrUndefined(i)&&i.childWidgets.length>0&&(o?(this.currentWidget=i.childWidgets[i.childWidgets.length-1],this.offset=this.selection.getLineLength(this.currentWidget)+1):(this.currentWidget=i.firstChild,this.offset=t?1:this.selection.getStartLineOffset(this.currentWidget)));e=this.currentWidget.getInline(this.offset,n);u=e.element;n=e.index;_instanceof(u,r)&&0===u.fieldType&&this.offset++},n.prototype.updateOffsetToPrevPosition=function(n,t){var c,i,l=this.paragraph.childWidgets.indexOf(this.currentWidget),a=this.selection.getPreviousValidOffset(this.currentWidget.paragraph,this.offset),e,f,u,o,h;this.offset>a?this.offset=a:l>0?(e=this.paragraph.childWidgets[l-1],e&&(this.currentWidget=e,f=this.currentWidget.getEndOffset(),this.offset=f>0?f-1:f)):(u=void 0,o=!1,t?(u=this.selection.getPreviousSelectionBlock(this.paragraph),sf.base.isNullOrUndefined(u))||_instanceof(u.containerWidget,s)&&(o=this.selection.start.paragraph.isInsideTable?!this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,u.associatedCell).ownerTable.contains(u.associatedCell):!0):u=this.selection.getPreviousParagraphBlock(this.paragraph),sf.base.isNullOrUndefined(u)||(o?(this.currentWidget=u.firstChild,this.offset=this.selection.getStartLineOffset(this.currentWidget)):(this.currentWidget=u.childWidgets[u.childWidgets.length-1],this.offset=this.currentWidget.isEndsWithPageBreak?this.currentWidget.getEndOffset()-1:this.currentWidget.getEndOffset())));(n=0,i=(c=this.currentWidget.getInline(this.offset,n)).element,n=c.index,_instanceof(i,r)&&0===i.fieldType&&this.offset++,_instanceof(i,r))&&(h=this.selection.getPreviousValidElement(i),sf.base.isNullOrUndefined(h)||(i=h,this.currentWidget=i.line,this.offset=this.currentWidget.getOffset(i,i.length),_instanceof(i,r)&&0===i.fieldType&&this.offset--));this.updatePhysicalPosition(!0)},n.prototype.moveToNextParagraphStartInternal=function(){var n=this.currentWidget.paragraph;sf.base.isNullOrUndefined(this.selection.getNextParagraphBlock(n))||(this.currentWidget=this.selection.getNextParagraphBlock(n).firstChild,this.offset=this.selection.getStartOffset(n),this.updatePhysicalPosition(!0))},n.prototype.movePreviousPosition=function(){var t=0,i=this.currentWidget.getInline(this.offset,t),n=i.element;t=i.index;this.paragraph.childWidgets.indexOf(this.currentWidget);(_instanceof(n,r)&&1===n.fieldType&&!sf.base.isNullOrUndefined(n.fieldBegin)||_instanceof(n,e)&&1===n.bookmarkType)&&this.movePreviousPositionInternal(n);this.updateOffsetToPrevPosition(t,!1)},n.prototype.moveNextPositionInternal=function(n){var t;sf.base.isNullOrUndefined(n.fieldSeparator)?t=n.fieldEnd:(t=n.fieldSeparator,this.currentWidget=t.line,this.currentWidget!==n.fieldEnd.line||this.selection.hasValidInline(this.paragraph,t,n.fieldEnd)||(t=n.fieldEnd));this.currentWidget=t.line;this.offset=this.currentWidget.getOffset(t,1)},n.prototype.moveBackward=function(){var u=0,s=this.currentWidget.getInline(this.offset,u),t=s.element,i,h;if((u=s.index,!this.owner.selection.isEmpty&&!sf.base.isNullOrUndefined(t))&&(i=this.selection.getNextRenderedElementBox(t,u),_instanceof(i,r)&&0===i.fieldType)){var e=this.owner.selection.start.getHierarchicalIndexInternal(),f=i.fieldEnd.line.getOffset(i.fieldEnd,1),o=this.getHierarchicalIndex(i.fieldEnd.line,f.toString());if(!n.isForwardSelection(o,e))return void this.owner.selection.start.setPositionParagraph(i.fieldEnd.line,f)}if(_instanceof(t,r)&&1===t.fieldType&&!sf.base.isNullOrUndefined(t.fieldBegin)){if(e=this.owner.selection.start.getHierarchicalIndexInternal(),f=t.line.getOffset(t,1),o=this.getHierarchicalIndex(t.line,f.toString()),!n.isForwardSelection(e,o))return h=t.fieldBegin.line.getOffset(t.fieldBegin,0),this.currentWidget=t.fieldBegin.line,this.offset=h,void this.updatePhysicalPosition(!0);this.movePreviousPositionInternal(t)}this.updateOffsetToPrevPosition(u,!0)},n.prototype.moveForward=function(){var i=0,s=this.currentWidget.getInline(this.offset,i),t=s.element,o,f;if(i=s.index,!sf.base.isNullOrUndefined(t)){if(!this.owner.selection.isEmpty&&i===t.length&&_instanceof(t,r)&&1===t.fieldType){var a=this.owner.selection.start.getHierarchicalIndexInternal(),h=t.fieldBegin.line.getOffset(t.fieldBegin,0),y=this.getHierarchicalIndex(t.fieldBegin.line,h.toString());if(!n.isForwardSelection(a,y))return void this.owner.selection.start.setPositionParagraph(t.fieldBegin.line,h)}t=this.selection.getNextRenderedElementBox(t,i)}if(_instanceof(t,r)&&!sf.base.isNullOrUndefined(t.fieldEnd)){var e=0,c=this.owner.selection.start.paragraph.getInline(this.owner.selection.start.offset,e),p=c.element;if(e=c.index,this.selection.getNextRenderedElementBox(p,e)!==t)return t=t.fieldEnd,this.currentWidget=t.line,this.offset=this.currentWidget.getOffset(t,1),void this.updatePhysicalPosition(!0);this.moveNextPositionInternal(t)}else _instanceof(t,r)&&(0===t.fieldType||1===t.fieldType)&&(this.currentWidget=t.line,this.offset=this.currentWidget.getOffset(t,1));i=0;var u=this.selection.getNextValidOffset(this.currentWidget,this.offset),l=this.selection.getLineLength(this.currentWidget),w=this.selection.isParagraphLastLine(this.currentWidget);this.offset<u?(this.offset=u,o=this.currentWidget.getInline(this.offset,i),(t=o.element,i=o.index,!sf.base.isNullOrUndefined(t)&&i===t.length&&_instanceof(t.nextNode,r))&&(f=this.selection.getNextValidElement(t.nextNode),_instanceof(f,r)&&1===f.fieldType&&(t=f,this.offset=this.currentWidget.getOffset(t,1)))):this.offset===u&&_instanceof(t,r)&&1===t.fieldType&&_instanceof(t.previousNode,v)?this.offset=u:this.offset===u&&this.offset<l+1&&w?this.offset=l+1:this.updateOffsetToNextParagraph(i,!0);this.updatePhysicalPosition(!0)},n.prototype.moveToInline=function(n,t){this.currentWidget=n.line;this.offset=this.currentWidget.getOffset(n,t);this.updatePhysicalPosition(!0)},n.isForwardSelection=function(n,t){var i,f,e;if(n===t)return!0;n=n.replace(/C;/g,"");t=t.replace(/C;/g,"");n=n.replace(/H;/g,"");t=t.replace(/H;/g,"");n=n.replace(/F;/g,"");t=t.replace(/F;/g,"");var o=n.split(";"),r=t.split(";"),u=o.length;for(u>r.length&&(u=r.length-1),i=0;i<u;i++)if(f=parseFloat(o[i]),e=parseFloat(r[i]),f!==e)return f<e;return!1},n.prototype.movePreviousPositionInternal=function(n){var t,i;t=_instanceof(n,r)&&sf.base.isNullOrUndefined(n.fieldSeparator)?this.selection.getPreviousValidElement(n.fieldBegin):this.selection.getPreviousValidElement(n);this.currentWidget=t.line;i=_instanceof(t,r)||_instanceof(t,e)&&1===t.bookmarkType?0:t.length;this.offset=this.currentWidget.getOffset(t,i)},n.prototype.moveToWordStartInternal=function(n){var i=this.currentWidget.getEndOffset(),t=this.currentWidget.paragraph,u=this.selection,f,e;if(2!==n||this.offset!==i&&this.offset!==i+1){if(this.offset===i+1)this.offset=i;else if(this.offset===u.getStartOffset(t)&&this.currentWidget===t.childWidgets[0]){if(f=u.getPreviousParagraphBlock(t),sf.base.isNullOrUndefined(f))return;this.currentWidget=f.childWidgets[f.childWidgets.length-1];this.offset=this.currentWidget.getEndOffset()}else{this.offset===u.getStartLineOffset(this.currentWidget)&&(e=t.childWidgets.indexOf(this.currentWidget),e-1>=0&&(this.currentWidget=t.childWidgets[e-1],this.offset=this.currentWidget.getEndOffset()));var o=0,h=this.currentWidget.getInline(this.offset,o),s=h.element;o=h.index;this.getPreviousWordOffset(s,u,o,n,_instanceof(s,r)&&1===s.fieldType,!1,!1,this)}1===n&&this.calculateOffset();this.updatePhysicalPosition(!0)}},n.prototype.getNextWordOffset=function(n,t,u,f,o,s,h){_instanceof(n,i)?this.getNextWordOffsetSpan(n,t,u,f,o,s,h):_instanceof(n,v)?this.getNextWordOffsetImage(n,t,u,f,o,s,h):_instanceof(n,r)&&0===n.fieldType?this.getNextWordOffsetFieldBegin(n,t,u,f,o,s,h):_instanceof(n,r)&&2===n.fieldType||_instanceof(n,e)?this.getNextWordOffsetFieldSeparator(n,t,u,f,o,s,h):_instanceof(n,r)&&1===n.fieldType?this.getNextWordOffsetFieldEnd(n,t,u,f,o,s,h):_instanceof(n,g)&&this.getNextWordOffsetComment(n,t,u,f,o,s,h)},n.prototype.getNextWordOffsetFieldBegin=function(n,t,i,r,u,f,e){var s=n.line.getOffset(n,0),o;if(n.length,sf.base.isNullOrUndefined(n.fieldSeparator))this.getNextWordOffsetFieldEnd(n.fieldEnd,0,i,r,u,f,e);else if(0===i)this.getNextWordOffsetFieldSeparator(n.fieldSeparator,0,i,r,u,f,e);else if(!sf.base.isNullOrUndefined(n.fieldEnd)){if(o=n.fieldSeparator,o.line.paragraph!==n.fieldEnd.line.paragraph||this.selection.hasValidInline(o.line.paragraph,o,n.fieldEnd)||(o=n.fieldEnd),this.getNextWordOffset(o,0,i,!(f.paragraph===n.line.paragraph&&f.offset===s),u,f,e),u&&!sf.base.isNullOrUndefined(n.fieldSeparator)&&f.paragraph===n.line.paragraph&&f.offset===n.fieldSeparator.line.getOffset(n.fieldSeparator,n.fieldSeparator.length))return void f.setPositionParagraph(n.line,s);u||f.setPositionParagraph(n.fieldEnd.line,n.fieldEnd.line.getOffset(n.fieldEnd,n.fieldEnd.length))}},n.prototype.getNextWordOffsetImage=function(n,t,i,r,u,f,e){if(r)return f.setPositionParagraph(n.line,n.line.getOffset(n,t)),void(u=!1);if(0===t){var o=n.line.getOffset(n,0);u=!0;f.offset===o?sf.base.isNullOrUndefined(n.nextNode)?f.setPositionParagraph(n.line,o+n.length):this.getNextWordOffset(n.nextNode,0,i,r,u,f,e):f.setPositionParagraph(n.line,o)}else sf.base.isNullOrUndefined(n.nextNode)||this.getNextWordOffset(n.nextNode,0,i,r,u,f,e)},n.prototype.getNextWordOffsetSpan=function(n,i,r,u,f,e,o){var c,s,h,l;if("\t"===n.text||"\v"===n.text){if(u)return e.setPositionParagraph(n.line,n.line.getOffset(n,i)),void(f=!1);0===i?(f=!0,c=n.line.getOffset(n,0),e.offset===c?e.setPositionParagraph(n.line,c+n.length):e.setPositionParagraph(n.line,c)):sf.base.isNullOrUndefined(n.nextNode)||this.getNextWordOffset(n.nextNode,0,r,u,f,e,o)}else if(s=0,0===i&&f&&-1===t.wordSplitCharacters.indexOf(n.text[0])){if(e.setPositionParagraph(n.line,n.line.getOffset(n,i)),u)return}else if(i<n.length)if(h=i>0&&n.text.length-1>=i?n.text.slice(i,n.length):n.text,-1===(s=t.indexOfAny(h,t.wordSplitCharacters))&&_instanceof(n.nextNode,g)&&sf.base.isNullOrUndefined(n.nextNode.nextNode)&&(s=n.length),-1!==s){if(u)return void(f=!1);if(l=n.line.getOffset(n,s+i),(o||" "!==h[s])&&!f&&n.line.paragraph===e.paragraph&&l!==e.offset)return f=!0,void e.setPositionParagraph(n.line,l);for(s++;s<h.length&&-1!==t.wordSplitCharacters.indexOf(h[s])&&(" "===h[s]||""===h[s]);)s++;f=!0;s<h.length||sf.base.isNullOrUndefined(n.nextNode)?e.setPositionParagraph(n.line,n.line.getOffset(n,s+i)):this.getNextWordOffset(n.nextNode,0,r,u,f,e,o)}else sf.base.isNullOrUndefined(n.nextNode)?e.setPositionParagraph(n.line,n.line.getEndOffset()):this.getNextWordOffset(n.nextNode,0,r,u,f,e,o);else sf.base.isNullOrUndefined(n.nextNode)||this.getNextWordOffset(n.nextNode,0,r,u,f,e,o)},n.prototype.getNextWordOffsetFieldSeparator=function(n,t,i,r,u,f,e){sf.base.isNullOrUndefined(n.nextNode)||this.getNextWordOffset(n.nextNode,0,i,r,u,f,e)},n.prototype.getNextWordOffsetComment=function(n,t,i,r,u,f,e){sf.base.isNullOrUndefined(n.nextNode)||this.getNextWordOffset(n.nextNode,0,i,r,u,f,e)},n.prototype.getNextWordOffsetFieldEnd=function(n,t,i,r,u,f,e){var o=n.line.getOffset(n,0),s=o+n.length;f.offset===o&&(f.setPositionParagraph(n.line,s),sf.base.isNullOrUndefined(n.nextNode))||(sf.base.isNullOrUndefined(n.nextNode)?f.setPositionParagraph(n.line,o):(this.getNextWordOffset(n.nextNode,0,i,!1,u,f,e),f.offset===s&&f.setPositionParagraph(n.line,o)),u=!0)},n.prototype.getPreviousWordOffset=function(n,t,u,f,s,h,c,l){_instanceof(n,i)?this.getPreviousWordOffsetSpan(n,t,u,f,s,h,c,l):_instanceof(n,v)?this.getPreviousWordOffsetImage(n,t,u,f,s,h,c,l):_instanceof(n,r)&&0===n.fieldType?this.getPreviousWordOffsetFieldBegin(n,t,u,f,s,h,c,l):_instanceof(n,r)&&2===n.fieldType?this.getPreviousWordOffsetFieldSeparator(n,t,u,f,s,h,c,l):_instanceof(n,r)&&1===n.fieldType?this.getPreviousWordOffsetFieldEnd(n,t,u,f,s,h,c,l):_instanceof(n,e)?this.getPreviousWordOffsetBookMark(n,t,u,f,s,h,c,l):_instanceof(n,o)&&n.previousNode?this.getPreviousWordOffsetSpan(n.previousNode,t,u,f,s,h,c,l):_instanceof(n,g)&&this.getPreviousWordOffsetComment(n,t,u,f,s,h,c,l)},n.prototype.getPreviousWordOffsetBookMark=function(n,r,u,f,e,o,s,h){if(n.previousNode){if(_instanceof(n.previousNode,i)){var c=n.previousNode;t.lastIndexOfAny(c.text,t.wordSplitCharacters)!==c.text.length-1?this.getPreviousWordOffset(c,r,u,f,e,o,s,h):h.setPositionParagraph(n.line,n.line.getOffset(n,0))}}else h.setPositionParagraph(n.line,r.getStartLineOffset(n.line))},n.prototype.getPreviousWordOffsetFieldEnd=function(n,t,i,u,f,e,o,s){var c=n.line.getOffset(n,0),l=c+n.length,h;if(sf.base.isNullOrUndefined(n.fieldSeparator))this.getPreviousWordOffsetFieldBegin(n.fieldBegin,t,0,u,f,e,o,s);else if(0!==u||sf.base.isNullOrUndefined(n.previousNode)){if(!sf.base.isNullOrUndefined(n.fieldBegin)&&0!==u){if(h=n.previousNode,(sf.base.isNullOrUndefined(h)||h.line.paragraph===n.fieldBegin.line.paragraph&&!t.hasValidInline(h.line.paragraph,h,n.fieldBegin))&&(h=n.fieldBegin),this.getPreviousWordOffset(h,t,h.length,u,!(s.paragraph===n.line.paragraph&&s.offset===l),e,o,s),o&&s.paragraph===n.line.paragraph&&s.offset===c)return void s.setPositionParagraph(n.line,l);o||s.setPositionParagraph(n.fieldBegin.line,n.fieldBegin.line.getOffset(n.fieldBegin,0))}}else h=n.previousNode,this.getPreviousWordOffset(h,t,h.length,u,_instanceof(h,r)&&1===h.fieldType,e,o,s)},n.prototype.getPreviousWordOffsetFieldSeparator=function(n,t,i,r,u,f,e,o){this.getPreviousWordOffsetFieldBegin(n.fieldBegin,t,n.fieldBegin.length,r,u,f,e,o)},n.prototype.getPreviousWordOffsetComment=function(n,r,u,f,e,o,s,h){if(n.previousNode){var c=n.previousNode;_instanceof(n.previousNode,i)&&t.lastIndexOfAny(c.text,t.wordSplitCharacters)!==c.text.length-1?this.getPreviousWordOffset(c,r,u,f,e,o,s,h):this.getPreviousWordOffset(n.previousNode,r,n.previousNode.length,f,e,o,s,h)}else h.setPositionParagraph(n.line,r.getStartLineOffset(n.line))},n.prototype.getPreviousWordOffsetFieldBegin=function(n,t,i,r,u,f,e,o){var s=n.line.getOffset(n,0),h=s+n.length;o.offset===h&&o.setPositionParagraph(n.line,s);sf.base.isNullOrUndefined(n.previousNode)?n.fieldSeparator?o.setPositionParagraph(n.line,n.fieldSeparator.line.getOffset(n.fieldSeparator,n.fieldSeparator.length)):o.setPositionParagraph(n.line,t.getStartLineOffset(n.line)):(this.getPreviousWordOffset(n.previousNode,t,n.previousNode.length,r,!1,f,e,o),o.offset===s&&(0===r||sf.base.isNullOrUndefined(n.fieldSeparator)||o.setPositionParagraph(n.line,n.fieldSeparator.line.getOffset(n.fieldSeparator,n.fieldSeparator.length))))},n.prototype.getPreviousWordOffsetImage=function(n,t,i,r,u,f,e,o){if(u)return o.setPositionParagraph(n.line,n.line.getOffset(n,i)),void(e=!1);if(i===n.length){var s=n.line.getOffset(n,n.length);s===o.offset?o.setPositionParagraph(n.line,s-n.length):o.setPositionParagraph(n.line,s)}else sf.base.isNullOrUndefined(n.previousNode)||this.getPreviousWordOffset(n.previousNode,t,n.previousNode.length,r,u,f,e,o)},n.prototype.getPreviousWordOffsetSpan=function(n,r,u,f,e,o,s,h){var a,c,l,v;if("\t"===n.text||"\v"===n.text){if(e)return void(s=!1);u===n.length?(s=!0,a=n.line.getOffset(n,n.length),a===h.offset?h.setPositionParagraph(n.line,a-n.length):h.setPositionParagraph(n.line,a)):sf.base.isNullOrUndefined(n.previousNode)||this.getPreviousWordOffset(n.previousNode,r,n.previousNode.length,f,e,o,s,h)}else{if(c=0,!o){for(;u>0&&" "===n.text[u-1];)u--;h.setPositionParagraph(n.line,n.line.getOffset(n,u))}if(u>0){if(o=!0,0===u&&s&&-1===t.wordSplitCharacters.indexOf(n.text[0]))return h.setPositionParagraph(n.line,n.line.getOffset(n,u)),void(s=!0);if(l=n.text.length>u?n.text.slice(0,u):n.text,-1===(c=t.lastIndexOfAny(l,t.wordSplitCharacters))&&_instanceof(n.previousElement,g)&&sf.base.isNullOrUndefined(n.previousNode.previousNode)&&(c=n.length),-1!==c){if(e)return void(s=!1);for(;c>0&&s&&" "!==l[c]&&-1!==t.wordSplitCharacters.indexOf(l[c-1]);)c--;(" "!==l[c]&&""!==l[c]&&s||c++,s=!0,c>0)?(v=n.line.getOffset(n,c),n.line.paragraph===h.paragraph&&v===h.offset?this.getPreviousWordOffsetSpan(n,r,u,f,e,o,s,h):h.setPositionParagraph(n.line,v)):_instanceof(n.previousNode,i)?this.getPreviousWordOffset(n.previousNode,r,n.previousNode.length,f,e,o,s,h):h.setPositionParagraph(n.line,n.line.getOffset(n,0))}else this.setPreviousWordOffset(n,r,u,f,e,o,s,h)}else this.setPreviousWordOffset(n,r,u,f,e,o,s,h)}},n.prototype.setPreviousWordOffset=function(n,t,i,r,u,f,e,o){_instanceof(n.previousNode,tt)&&n.line===n.previousNode.line?this.getPreviousWordOffset(n.previousNode,t,n.previousNode.length,r,u,f,e,o):o.setPositionParagraph(n.line,t.getStartLineOffset(n.line))},n.prototype.validateForwardFieldSelection=function(t,i){var f=new n(this.owner),h,a,o;for(f.setPositionForCurrentIndex(t),f.isUpdateLocation=!1,h=!1,this.selection.start.paragraph===this.selection.end.paragraph&&this.selection.start.offset!==this.selection.getStartOffset(this.selection.start.paragraph)||this.selection.end.offset===this.selection.end.currentWidget.getEndOffset()&&this.selection.isParagraphLastLine(this.selection.end.currentWidget)&&this.selection.end.setPositionParagraph(this.selection.end.currentWidget,this.selection.end.offset+1);t!==i&&n.isForwardSelection(t,i);){if(!h&&(f.moveNextPosition(!1),t===f.getHierarchicalIndexInternal()))break;var e=0,l=f.currentWidget.getInline(f.offset,e),u=l.element;if(e=l.index,!sf.base.isNullOrUndefined(u)){if(a=this.selection.start.getHierarchicalIndexInternal(),e===u.length&&_instanceof(u,r)&&1===u.fieldType){if(u.line.getOffset(u,0)===this.offset)return;var c=u.fieldBegin.line,v=c.getOffset(u.fieldBegin,0),y=this.getHierarchicalIndex(c,v.toString());n.isForwardSelection(a,y)||this.selection.start.setPositionParagraph(c,v)}o=this.selection.getNextRenderedElementBox(u,e);!sf.base.isNullOrUndefined(o)&&_instanceof(o,tt)&&(u=o)}if(h=_instanceof(u,r)&&0===u.fieldType&&!sf.base.isNullOrUndefined(u.fieldEnd)){if(u.line.getOffset(u,0)===this.offset)return;var s=u.fieldEnd,p=(s.line.paragraph,s.line.getOffset(s,1)),w=this.getHierarchicalIndex(s.line,p.toString());if(!n.isForwardSelection(w,i))return void this.moveToInline(u.fieldEnd,1);f.moveToInline(u.fieldEnd,1)}t=f.getHierarchicalIndexInternal()}},n.prototype.validateBackwardFieldSelection=function(t,i){var f=new n(this.owner),o,s,e;for(f.setPositionForCurrentIndex(t),f.isUpdateLocation=!1,o=!1,(this.selection.start.paragraph!==this.selection.end.paragraph&&this.selection.end.offset!==this.selection.getStartOffset(this.selection.start.paragraph)||this.documentHelper.isSelectionChangedOnMouseMoved&&this.selection.isParagraphFirstLine(this.selection.end.currentWidget)&&this.selection.end.offset===this.selection.getStartOffset(this.selection.start.paragraph))&&(o=!0),o&&this.selection.start.offset===this.selection.start.currentWidget.getEndOffset()&&this.selection.isParagraphLastLine(this.selection.start.currentWidget)&&this.selection.start.setPositionParagraph(this.selection.start.currentWidget,this.selection.start.offset+1),s=this.selection.start.getHierarchicalIndexInternal();t!==i&&n.isForwardSelection(i,t);){var h=0,l=f.currentWidget.getInline(f.offset,h),u=l.element;if((h=l.index,!sf.base.isNullOrUndefined(u))&&(e=this.selection.getNextRenderedElementBox(u,h),_instanceof(e,r)&&0===e.fieldType)){var c=e.fieldEnd.line,a=c.getOffset(e.fieldEnd,1),v=this.getHierarchicalIndex(c,a.toString());n.isForwardSelection(v,s)||(this.selection.start.setPositionParagraph(c,a),s=v)}if(_instanceof(u,r)&&1===u.fieldType&&!sf.base.isNullOrUndefined(u.fieldBegin)){var y=u.fieldBegin.line,p=u.fieldBegin,w=y.getOffset(p,0),b=this.getHierarchicalIndex(y,w.toString());if(!n.isForwardSelection(i,b))return void this.moveToInline(u.fieldBegin,0);f.moveToInline(u.fieldBegin,0)}else f.movePreviousPosition();t=f.getHierarchicalIndexInternal()}},n.prototype.paragraphStartInternal=function(n,t){var i=n.getStartLineOffset(this.currentWidget),r;this.offset===i&&t?this.moveToNextParagraphInTableCheck()?this.moveToPreviousParagraphInTable(n):sf.base.isNullOrUndefined(n.getPreviousParagraphBlock(this.currentWidget.paragraph))||(r=n.getPreviousParagraphBlock(this.currentWidget.paragraph),this.currentWidget=r.childWidgets[0],this.offset=n.getStartLineOffset(this.currentWidget)):(this.currentWidget=this.currentWidget.paragraph.getSplitWidgets()[0].childWidgets[0],this.offset=i);this.calculateOffset()},n.prototype.calculateOffset=function(){var n=this.owner.selection.start.getHierarchicalIndexInternal(),t=this.getHierarchicalIndexInternal();n!==t&&this.validateBackwardFieldSelection(n,t);this.updatePhysicalPosition(!0)},n.prototype.moveToParagraphStartInternal=function(n,t){for(var f,r,u,i=this.currentWidget.paragraph;i.previousSplitWidget;)i=i.previousSplitWidget;f=n.getStartOffset(i);this.offset===f&&t?this.moveToNextParagraphInTableCheck()?this.moveToPreviousParagraphInTable(n):sf.base.isNullOrUndefined(n.getPreviousParagraphBlock(this.paragraph))||(this.currentWidget=n.getPreviousParagraphBlock(this.paragraph).firstChild,this.offset=n.getStartOffset(this.paragraph)):(this.currentWidget=i.firstChild,this.offset=n.getStartLineOffset(this.currentWidget));r=this.owner.selection.start.getHierarchicalIndexInternal();u=this.getHierarchicalIndexInternal();r!==u&&this.validateBackwardFieldSelection(r,u);this.updatePhysicalPosition(!1)},n.prototype.moveToParagraphEndInternal=function(n,t){for(var r,u,i=this.currentWidget.paragraph;i.nextSplitWidget;)i=i.nextSplitWidget;this.currentWidget=i.childWidgets[i.childWidgets.length-1];r=this.currentWidget.getEndOffset()+1;this.offset===r&&t?this.moveToNextParagraphInTableCheck()?this.moveToNextParagraphInTable():sf.base.isNullOrUndefined(n.getNextParagraphBlock(this.currentWidget.paragraph))||(u=n.getNextParagraphBlock(this.currentWidget.paragraph),this.currentWidget=u.childWidgets[u.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1):this.offset=r;this.calculateOffset()},n.prototype.moveUp=function(n,t){var i=this.currentWidget.paragraph,h,o,c,s,r,e,l;if(this.moveToLineStartInternal(n,!0),this.movePreviousPosition(),h=void 0,o=this.currentWidget.paragraph,i.isInsideTable&&i!==o&&i.associatedCell!==o.associatedCell&&!sf.base.isNullOrUndefined(o.associatedCell)&&i.associatedCell.ownerRow===o.associatedCell.ownerRow){if(c=o.associatedCell.ownerRow,_instanceof(c.previousRenderedWidget,a))s=n.getFirstCellInRegion(c.previousRenderedWidget,o.associatedCell,t,!0),r=n.getLastParagraph(s),this.setPosition(r.childWidgets[r.childWidgets.length-1],!1);else{e=c.ownerTable.previousRenderedWidget;do _instanceof(e,f)&&(e=n.getLastBlockInLastCell(e));while(_instanceof(e,f));_instanceof(e,u)&&this.setPosition(e.childWidgets[e.childWidgets.length-1],!1)}h=n.getLineWidgetParagraph(this.offset,this.currentWidget)}else!i.isInsideTable&&this.currentWidget.paragraph.isInsideTable?(s=n.getFirstCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0),r=n.getLastParagraph(s),this.setPosition(r.childWidgets[r.childWidgets.length-1],!1)):i.isInsideTable&&!sf.base.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow.previousRenderedWidget!==i.associatedCell.ownerRow.previousSplitWidget&&i.associatedCell.ownerRow.previousRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow&&(s=n.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0),r=n.getLastParagraph(s),this.setPosition(r.childWidgets[r.childWidgets.length-1],!1)),h=n.getLineWidgetParagraph(this.offset,this.currentWidget);l=n.getTop(h);this.currentWidget.isEndsWithPageBreak&&this.offset===this.currentWidget.getEndOffset()-1&&(t=this.location.x);n.updateTextPositionWidget(h,new d(t,l),this,!1)},n.prototype.moveDown=function(n,t){var i=this.currentWidget.paragraph,l=this.currentWidget,h,e,s,o,r,c;if(this.moveToLineEndInternal(n,!0),h=this.selection.getParagraphLength(this.currentWidget.paragraph),this.offset>h&&(this.offset=h),this.moveNextPosition(),e=void 0,i.isInsideTable&&i!==this.currentWidget.paragraph&&i.associatedCell!==this.currentWidget.paragraph.associatedCell&&!sf.base.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow===this.currentWidget.paragraph.associatedCell.ownerRow){if(s=this.currentWidget.paragraph.associatedCell.ownerRow,i.isInsideTable&&this.currentWidget.paragraph.isInsideTable&&i.associatedCell.cellFormat.rowSpan>1&&i.associatedCell.cellFormat.rowSpan+i.associatedCell.ownerRow.rowIndex===i.associatedCell.ownerTable.childWidgets.length&&(s=this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets[this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets.length-1]),_instanceof(s.nextRenderedWidget,a))o=this.selection.getLastCellInRegion(s.nextRenderedWidget,this.currentWidget.paragraph.associatedCell,t,!1),this.setPosition(this.selection.getFirstParagraph(o).childWidgets[0],!0);else{r=this.selection.getNextRenderedBlock(s.ownerTable);do _instanceof(r,f)&&(r=this.selection.getFirstBlockInFirstCell(r));while(_instanceof(r,f));_instanceof(r,u)&&this.setPosition(r.childWidgets[0],!0)}e=n.getLineWidgetParagraph(this.offset,this.currentWidget)}else!i.isInsideTable&&this.currentWidget.paragraph.isInsideTable?(o=this.selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!1),this.setPosition(this.selection.getFirstParagraph(o).childWidgets[0],!0)):i.isInsideTable&&!sf.base.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow.nextRenderedWidget!==i.associatedCell.ownerRow.nextSplitWidget&&i.associatedCell.ownerRow.nextRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow&&(o=n.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0),this.setPosition(n.getFirstParagraph(o).childWidgets[0],!1)),e=n.getLineWidgetParagraph(this.offset,this.currentWidget);c=this.selection.getTop(e);e!==l&&this.selection.updateTextPositionWidget(e,new d(t,c),this,!1)},n.prototype.moveToLineStartInternal=function(n,t){var f,e,c,l,u,s,h,a;this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);e=n.getLineWidgetInternal(this.currentWidget,this.offset,t);this.currentWidget.paragraph.paragraphFormat.bidi&&e.children.length>0&&this.containsRtlText(e)?_instanceof(f=e.children[e.children.length-1],o)&&(f=void 0):f=n.getFirstElementInternal(e);this.documentHelper.moveCaretPosition=1;c=n.getStartOffset(this.currentWidget.paragraph);sf.base.isNullOrUndefined(f)&&this.offset>c?(l=0,u=(h=this.currentWidget.getInline(this.offset,l)).element,l=h.index,_instanceof(u,i)&&"\v"!==u.text&&(this.offset=c)):sf.base.isNullOrUndefined(f)||(s=0,this.currentWidget=f.line,this.offset=this.currentWidget.getOffset(f,s),s=0,u=(h=this.currentWidget.getInline(this.offset,s)).element,(s=h.index,_instanceof(u,r))&&(a=n.getPreviousValidElement(u),sf.base.isNullOrUndefined(a)||(u=a,this.currentWidget=u.line,this.offset=this.currentWidget.getOffset(u,u.length),_instanceof(u,r)&&this.offset--)));this.updatePhysicalPosition(!0)},n.prototype.moveToNextParagraphInTableCheck=function(){return!(!this.selection.start.paragraph.isInsideTable&&!this.paragraph.isInsideTable||this.selection.start.paragraph.associatedCell===this.paragraph.associatedCell&&!this.selection.isCellSelected(this.selection.start.paragraph.associatedCell,this.selection.start,this))},n.prototype.moveToWordEndInternal=function(n,t){var r=0,i=this.currentWidget.getEndOffset(),u,e,s;if(this.selection.isParagraphFirstLine(this.currentWidget)&&(_instanceof(this.currentWidget.children[0],o)&&(r=1),_instanceof(this.currentWidget.children[1],o)&&(r=2)),this.offset+r===i||this.offset===i+1)if(this.offset===i&&0!==n)this.setPositionParagraph(this.currentWidget,i+1);else{if(u=this.selection.getNextParagraphBlock(this.currentWidget.paragraph),sf.base.isNullOrUndefined(u))return;(this.currentWidget=u.childWidgets[0],this.offset=this.selection.getStartLineOffset(this.currentWidget),1===n)&&(this.moveToNextParagraphInTableCheck()?this.moveToNextParagraphInTable():this.moveToWordEndInternal(n,t))}else{var f=0,h=this.currentWidget.getInline(this.offset,f),c=h.element;f=h.index;this.getNextWordOffset(c,f,n,!1,!1,this,t)}0!==n&&(e=this.owner.selection.start.getHierarchicalIndexInternal(),s=this.getHierarchicalIndexInternal(),e!==s&&this.validateForwardFieldSelection(e,s));this.updatePhysicalPosition(!0)},n.prototype.moveToNextParagraphInTable=function(){var n=this.currentWidget.paragraph,t=n.isInsideTable?this.selection.getNextSelectionCell(n.associatedCell):this.selection.getNextParagraphBlock(n);sf.base.isNullOrUndefined(t)||(this.currentWidget=t.childWidgets[t.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},n.prototype.moveToPreviousParagraph=function(n){var i=n.getStartOffset(this.currentWidget.paragraph),t;this.offset!==i||sf.base.isNullOrUndefined(n.getPreviousParagraphBlock(this.currentWidget.paragraph))?this.offset=n.getStartOffset(this.currentWidget.paragraph):(t=n.getPreviousParagraphBlock(this.currentWidget.paragraph),this.currentWidget=t.childWidgets[0],this.offset=n.getStartOffset(this.currentWidget.paragraph));this.updatePhysicalPosition(!0)},n.prototype.moveToPreviousLine=function(n,t){var o=this.getHierarchicalIndexInternal(),s=n.getLineWidgetParagraph(this.offset,this.currentWidget),i,r,u,f,e;this.moveToLineStartInternal(n,!0);this.currentWidget.paragraph.isInsideTable?this.moveUpInTable(n):this.moveBackward();i=n.getLineWidgetParagraph(this.offset,this.currentWidget);r=n.getLeft(i);n.getWidth(i,!0)+r>=t&&s!==i&&(u=n.getTop(i),f=new d(t,u),n.updateTextPositionWidget(i,f,this,!0));e=this.getHierarchicalIndexInternal();this.validateBackwardFieldSelection(o,e)},n.prototype.moveToLineEndInternal=function(n,t){var f,v,e,c,u,l,h;this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var s=n.getLineWidgetParagraph(this.offset,this.currentWidget),a=n.getFirstElementInternal(s),y=this.currentWidget.paragraph.paragraphFormat.bidi;if(this.documentHelper.moveCaretPosition=2,sf.base.isNullOrUndefined(a)&&this.offset===n.getStartLineOffset(this.currentWidget))this.offset=n.getParagraphLength(this.paragraph)+1,this.updatePhysicalPosition(!0);else if(!sf.base.isNullOrUndefined(a)){if(f=void 0,y&&this.containsRtlText(s)?(v=s.getEndOffset(),f=s.getInline(v,0).element):_instanceof(f=s.children[s.children.length-1],o)&&s.children.length>2&&(f=s.children[s.children.length-3]),e=0,e+=_instanceof(f,i)?f.length:1,this.currentWidget=f.line,e===f.length&&sf.base.isNullOrUndefined(f.nextNode)&&n.isParagraphLastLine(this.currentWidget))c=n.getLineLength(this.currentWidget),this.offset=t?c+1:c;else{for(u=f;!sf.base.isNullOrUndefined(u)&&u.length===e&&_instanceof(u.nextNode,r);)l=n.getNextValidElement(u.nextNode),(u!==l&&(u=l,e=0),_instanceof(u,r)&&0===u.fieldType&&!sf.base.isNullOrUndefined(u.fieldEnd))&&(h=u,sf.base.isNullOrUndefined(h.fieldSeparator)?u=h.fieldEnd:(u=h.fieldSeparator,this.currentWidget=u.line,this.currentWidget!==h.fieldEnd.line||n.hasValidInline(this.currentWidget.paragraph,u,h.fieldEnd)||(u=h.fieldEnd)),this.currentWidget=u.line),_instanceof(u,r)&&(e=1);e===u.length&&sf.base.isNullOrUndefined(u.nextNode)&&e++;!t&&_instanceof(u,tt)&&"\v"===u.text&&e--;this.offset=this.currentWidget.getOffset(u,e)}this.updatePhysicalPosition(t)}},n.prototype.moveToNextLine=function(t){var i=this.selection,u=new n(this.owner),o,e,h,c,l;u.setPositionInternal(this);o=this.getHierarchicalIndexInternal();i.getLineWidgetParagraph(this.offset,this.currentWidget);this.offset;this.moveToLineEndInternal(i,!0);e=!u.isAtSamePosition(this);u.setPositionInternal(this);this.currentWidget.paragraph.isInsideTable?this.moveDownInTable(i):(this.moveNextPosition(),this.moveForward());var r=i.getLineWidgetParagraph(this.offset,this.currentWidget),f=i.getLeft(r),s=i.getFirstElementInternal(r),a=sf.base.isNullOrUndefined(s)?i.getWidth(r,!0):i.getLeftInternal(r,s,1)-f;f<t&&a/2<t-f?(h=i.getTop(r),c=new d(t,h),i.updateTextPositionWidget(r,c,this,!0),i.getWidth(r,!0)<t-f&&this.moveToLineEndInternal(i,!0)):e&&this.currentWidget.paragraph.isInsideTable&&this.currentWidget===this.owner.selection.start.currentWidget?this.setPositionInternal(u):e||this.moveToLineEndInternal(i,!0);l=this.getHierarchicalIndexInternal();this.validateForwardFieldSelection(o,l)},n.prototype.moveUpInTable=function(n){var o=!1,s=this.owner.selection.end,c=!this.owner.selection.isEmpty,f,e;if(o=s.paragraph.isInsideTable){var t=this.currentWidget.paragraph.associatedCell,h=s.paragraph.associatedCell,u=n.getContainerCellOf(h,t);if(o=u.ownerTable.contains(t)){if(h=n.getSelectedCell(h,u),t=n.getSelectedCell(t,u),f=n.containsCell(u,this.currentWidget.paragraph.associatedCell),e=n.isCellSelected(u,this,s),e||(e=this.currentWidget.paragraph===n.getFirstParagraph(u)&&this.isAtParagraphStart),(f&&e||!f)&&!sf.base.isNullOrUndefined(t.ownerRow.previousRenderedWidget)){var l=t.ownerRow.previousRenderedWidget,i=n.getFirstCellInRegion(l,u,this.owner.selection.upDownSelectionLength,!0),r=n.getLastParagraph(i);return void this.setPosition(r.childWidgets[0],!0)}(f&&e&&sf.base.isNullOrUndefined(t.ownerRow.previousRenderedWidget)||!f)&&(c?(t=t.ownerRow.childWidgets[0],r=n.getFirstParagraph(t),this.setPosition(r.childWidgets[0],!0)):(t=t.ownerRow.childWidgets[t.ownerRow.childWidgets.length-1],r=n.getLastParagraph(t),this.setPosition(r.childWidgets[0],!1)))}}o||(i=n.getContainerCell(this.currentWidget.paragraph.associatedCell),c?(i=i.ownerRow.childWidgets[0],r=n.getFirstParagraph(i),this.setPosition(r.childWidgets[0],!0)):(i=i.ownerRow.childWidgets[i.ownerRow.childWidgets.length-1],r=n.getLastParagraph(i),this.setPosition(r.childWidgets[0],!1)));this.moveBackward()},n.prototype.moveDownInTable=function(n){var e=!1,h=this.owner.selection.isEmpty||this.owner.selection.isForward,f,s;if(e=this.owner.selection.start.paragraph.isInsideTable){var o=this.owner.selection.start.paragraph.associatedCell,t=this.currentWidget.paragraph.associatedCell,u=n.getContainerCellOf(o,t);if(e=u.ownerTable.contains(t)){if(o=n.getSelectedCell(o,u),t=n.getSelectedCell(t,u),f=n.containsCell(u,this.currentWidget.paragraph.associatedCell),s=n.isCellSelected(u,this.owner.selection.start,this),(f&&s||!f)&&!sf.base.isNullOrUndefined(t.ownerRow.nextRenderedWidget)){var c=t.ownerRow.nextRenderedWidget,r=n.getLastCellInRegion(c,u,this.owner.selection.upDownSelectionLength,!1),i=n.getLastParagraph(r);return void this.setPosition(i.childWidgets[i.childWidgets.length-1],!1)}(f&&s&&sf.base.isNullOrUndefined(t.ownerRow.nextRenderedWidget)||!f)&&(h?(t=t.ownerRow.childWidgets[t.ownerRow.childWidgets.length-1],i=n.getLastParagraph(t),this.setPosition(i.childWidgets[i.childWidgets.length-1],!1)):(t=t.ownerRow.childWidgets[0],i=n.getFirstParagraph(t),this.setPosition(i.childWidgets[i.childWidgets.length-1],!0)))}}e||(r=n.getContainerCell(this.currentWidget.paragraph.associatedCell),h?(r=r.ownerRow.childWidgets[r.ownerRow.childWidgets.length-1],i=n.getLastParagraph(r),this.setPosition(i.childWidgets[i.childWidgets.length-1],!1)):r.ownerRow.nextRenderedWidget&&(r=r.ownerRow.nextRenderedWidget.childWidgets[0],i=n.getFirstParagraph(r),this.setPosition(i.childWidgets[i.childWidgets.length-1],!0)));this.moveForward()},n.prototype.destroy=function(){this.offset=void 0;this.isUpdateLocation=void 0;sf.base.isNullOrUndefined(this.location)||this.location.destroy();this.location=void 0;this.currentWidget=void 0;this.owner=void 0;this.documentHelper=void 0},n}(),ui=function(){function n(n,t){this.leftIn=0;this.widthIn=0;this.color="";this.leftIn=n;this.widthIn=t}return Object.defineProperty(n.prototype,"left",{get:function(){return this.leftIn},set:function(n){this.leftIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.widthIn},set:function(n){this.widthIn=n},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){this.widthIn=void 0;this.leftIn=void 0;this.floatingItems=[];this.floatingItems=void 0},n}(),vu=function(){function n(n,t){this.linkInternal="";this.localRef="";this.opensNewWindow=!1;this.isCrossRefField=!1;var i=t.getFieldCode(n),r=i.toLowerCase();"hyperlink"===r.substring(0,9)?this.parseFieldValues(i.substring(9).trim(),!0):0===r.indexOf("ref ")&&r.match("\\h")&&(this.parseFieldValues(i.substring(4).trim(),!1),this.isCrossRefField=!0)}return Object.defineProperty(n.prototype,"navigationLink",{get:function(){return this.linkInternal},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"localReference",{get:function(){return this.localRef},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"linkType",{get:function(){return this.typeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isCrossRef",{get:function(){return this.isCrossRefField},enumerable:!0,configurable:!0}),n.prototype.parseFieldValues=function(n,t){var u=n.split(" "),f=!1,r,i;if(t)for(r=0;r<u.length;r++)i=u[r],i.length<1||("\\t"===i||"\\l"===i?f=!0:"\\n"===i?this.opensNewWindow=!0:(i=this.parseFieldValue(i,'"'===i[0]?'"':void 0,t),f?(this.localRef=i,f=!1):this.linkInternal=i));else this.localRef=u[0];this.setLinkType()},n.prototype.parseFieldValue=function(n,t,i){n=i?n.substring(1):n.substring(0);var r=t?n.indexOf(t):-1;return r<0&&(r=n.length),n.substring(0,r).trim()},n.prototype.setLinkType=function(){sf.base.isNullOrUndefined(this.linkInternal)||this.linkInternal.length<1?this.typeInternal="Bookmark":("www."===this.linkInternal.substring(0,4)?this.linkInternal="http://"+this.navigationLink:"@"===this.linkInternal[0]&&(this.linkInternal="mailto:"+this.navigationLink),this.typeInternal="http://"===this.linkInternal.substring(0,7)||"https://"===this.linkInternal.substring(0,8)?"WebPage":"mailto:"===this.linkInternal.substring(0,7)?"Email":"File")},n.prototype.destroy=function(){this.linkInternal=void 0;this.localRef=void 0;this.typeInternal=void 0;this.opensNewWindow=void 0},n}(),wr=function(){function n(n){this.width=0;this.height=0;this.width=n.width;this.height=n.height}return n.prototype.destroy=function(){this.width=void 0;this.height=void 0},n}(),pe=function(){function n(n){var t=this;this.upDownSelectionLength=0;this.isSkipLayouting=!1;this.isImageSelected=!1;this.contextTypeInternal=void 0;this.caret=void 0;this.isRetrieveFormatting=!1;this.skipFormatRetrieval=!1;this.isMoveDownOrMoveUp=!1;this.isViewPasteOptions=!1;this.skipEditRangeRetrieval=!1;this.selectedWidgets=void 0;this.isHighlightEditRegionIn=!1;this.isHighlightFormFields=!1;this.isHightlightEditRegionInternal=!1;this.isCurrentUser=!1;this.isHighlightNext=!1;this.isWebLayout=!1;this.editRegionHighlighters=void 0;this.formFieldHighlighters=void 0;this.isSelectList=!1;this.previousSelectedFormField=void 0;this.isFormatUpdated=!1;this.pasteOptions=function(n){"Keep source formatting"===n?t.owner.editor.applyPasteOptions("KeepSourceFormatting"):"Match destination formatting"===n?t.owner.editor.applyPasteOptions("MergeWithExistingFormatting"):(t.owner.editor.previousParaFormat=void 0,t.owner.editor.applyPasteOptions("KeepTextOnly"))};this.hideCaret=function(){sf.base.isNullOrUndefined(t.caret)||(t.caret.style.display="none")};this.owner=n;this.documentHelper=this.owner.documentHelper;this.start=new l(this.owner);this.end=new l(this.owner);this.selectedWidgets=new h;this.characterFormatIn=new au(this);this.paragraphFormatIn=new se(this,this.documentHelper);this.sectionFormatIn=new he(this);this.rowFormatIn=new ae(this);this.cellFormatIn=new le(this);this.tableFormatIn=new ce(this);this.imageFormatInternal=new ve(this);this.editRangeCollection=[];this.editRegionHighlighters=new h;this.formFieldHighlighters=new h}return Object.defineProperty(n.prototype,"isHighlightEditRegion",{get:function(){return this.isHighlightEditRegionIn},set:function(n){this.isHighlightEditRegionIn=n;this.onHighlight()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"htmlWriter",{get:function(){return sf.base.isNullOrUndefined(this.htmlWriterIn)&&(this.htmlWriterIn=new ye),this.htmlWriterIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"start",{get:function(){if(!sf.base.isNullOrUndefined(this.owner)&&!sf.base.isNullOrUndefined(this.viewer))return sf.base.isNullOrUndefined(this.startInternal)&&(this.startInternal=this.owner.documentStart),this.startInternal},set:function(n){this.startInternal=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"characterFormat",{get:function(){return this.characterFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paragraphFormat",{get:function(){return this.paragraphFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sectionFormat",{get:function(){return this.sectionFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"tableFormat",{get:function(){return this.tableFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cellFormat",{get:function(){return this.cellFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rowFormat",{get:function(){return this.rowFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageFormat",{get:function(){return this.imageFormatInternal},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"end",{get:function(){return this.endInternal},set:function(n){this.endInternal=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"startPage",{get:function(){return!this.owner.isDocumentLoaded||sf.base.isNullOrUndefined(this.viewer)||_instanceof(this.viewer,at)||sf.base.isNullOrUndefined(this.documentHelper.selectionStartPage)?1:this.documentHelper.pages.indexOf(this.documentHelper.selectionStartPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"endPage",{get:function(){return!this.owner.isDocumentLoaded||sf.base.isNullOrUndefined(this.viewer)||_instanceof(this.viewer,at)||sf.base.isNullOrUndefined(this.documentHelper.selectionEndPage)?1:this.documentHelper.pages.indexOf(this.documentHelper.selectionEndPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isForward",{get:function(){return this.start.isExistBefore(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isinFootnote",{get:function(){var n=this.getContainerWidget(this.start.paragraph);return _instanceof(n,it)&&"Footnote"===n.footNoteType},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isinEndnote",{get:function(){var n=this.getContainerWidget(this.start.paragraph);return _instanceof(n,it)&&"Endnote"===n.footNoteType},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isEmpty",{get:function(){return!!sf.base.isNullOrUndefined(this.start)||this.start.isAtSamePosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"startOffset",{get:function(){return this.getHierarchicalIndexByPosition(this.start)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"endOffset",{get:function(){return this.getHierarchicalIndexByPosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isInShape",{get:function(){var n=this.start.paragraph.containerWidget;do{if(_instanceof(n,et))return!0;n&&(n=n.containerWidget)}while(n);return!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this.getText(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"contextType",{get:function(){return this.contextTypeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bookmarks",{get:function(){return this.getSelBookmarks(!1)},enumerable:!0,configurable:!0}),n.prototype.getBookmarks=function(n){return this.getSelBookmarks(n)},Object.defineProperty(n.prototype,"isCleared",{get:function(){return sf.base.isNullOrUndefined(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isInField",{get:function(){return!sf.base.isNullOrUndefined(this.getHyperlinkField(!0))},enumerable:!0,configurable:!0}),n.prototype.getSelBookmarks=function(n){var l,a,v=[],s=this.documentHelper.bookmarks,u=this.start,r=this.end,i,t,o,c;this.isForward||(u=this.end,r=this.start);for(var e=!1,f=this.getSelectedCells(),h=0;h<s.length;h++)if(n||!n&&0!==s.keys[h].indexOf("_")){if(a=(l=s.get(s.keys[h])).reference,sf.base.isNullOrUndefined(a))continue;if(i=this.getElementPosition(l).startPosition,t=this.getElementPosition(a,!0).startPosition,i.paragraph.isInsideTable||t.paragraph.isInsideTable)if(f.length>0){if(f.indexOf(i.paragraph.associatedCell)>=0||f.indexOf(t.paragraph.associatedCell)>=0)e=!0;else if((e=!1,f.indexOf(i.paragraph.associatedCell)<0||f.indexOf(t.paragraph.associatedCell)<0)&&(o=r.paragraph.isInsideTable&&r.paragraph.associatedCell,c=t.paragraph.associatedCell,o&&c&&o.ownerTable.equals(c.ownerTable)&&!(o.ownerTable&&f.indexOf(this.getCellInTable(o.ownerTable,c))>=0)))continue}else e=!1;else e=!1;((u.isExistAfter(i)||u.isAtSamePosition(i))&&(r.isExistBefore(t)||r.isAtSamePosition(t))||(i.isExistAfter(u)||i.isAtSamePosition(u))&&(t.isExistBefore(r)||t.isAtSamePosition(r))||i.isExistAfter(u)&&i.isExistBefore(r)&&(r.isExistAfter(t)||r.isExistBefore(t))||t.isExistBefore(r)&&t.isExistAfter(u)&&(u.isExistBefore(i)||u.isExistAfter(i))||e)&&v.push(l.name)}return v},Object.defineProperty(n.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),n.prototype.getModuleName=function(){return"Selection"},n.prototype.checkLayout=function(){"Continuous"===this.owner.layoutType&&(this.isWebLayout=!0,this.documentHelper.isHeaderFooter=!0,this.owner.layoutType="Pages",this.owner.viewer.destroy(),this.owner.viewer=new rt(this.owner),this.owner.editor.layoutWholeDocument())},n.prototype.goToHeader=function(){this.checkLayout();this.owner.enableHeaderAndFooter=!0;this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.headerWidget);this.isWebLayout=!1},n.prototype.goToFooter=function(){this.checkLayout();this.owner.enableHeaderAndFooter=!0;this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.footerWidget);this.isWebLayout=!1},n.prototype.closeHeaderFooter=function(){this.disableHeaderFooter();this.documentHelper.isHeaderFooter&&"Pages"===this.owner.layoutType&&(this.owner.layoutType="Continuous",this.documentHelper.isHeaderFooter=!1)},n.prototype.goToPage=function(n){if(n>=1&&n<=this.owner.documentHelper.pages.length){var t=this.owner.documentHelper.pages[n-1];this.updateTextPositionForBlockContainer(t.bodyWidgets[0])}},n.prototype.selectTable=function(){this.owner.enableSelection&&this.selectTableInternal()},n.prototype.selectRow=function(){this.owner.enableSelection&&this.selectTableRow()},n.prototype.selectColumn=function(){this.owner.enableSelection&&this.selectColumnInternal()},n.prototype.selectCell=function(){this.owner.enableSelection&&this.selectTableCell()},n.prototype.select=function(n,t){var r,u,f,i;"string"==typeof n?(r=this.getTextPosBasedOnLogicalIndex(n),u=this.getTextPosBasedOnLogicalIndex(t),this.selectPosition(r,u)):(f=new d(n.x,n.y),i=this.viewer.findFocusedPage(f,!0),n.extend?this.moveTextPosition(i,this.end):this.documentHelper.updateTextPositionForSelection(i,1))},n.prototype.selectByHierarchicalIndex=function(n,t){var i=this.getTextPosBasedOnLogicalIndex(n),r=this.getTextPosBasedOnLogicalIndex(t);this.selectPosition(i,r)},n.prototype.selectField=function(n){!this.isInField&&sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(n)&&(n=this.getHyperlinkField(!0)),this.selectFieldInternal(n))},n.prototype.selectFieldInternal=function(n){var t,i,f,r,o,u;n&&(t=this.documentHelper.isFormFillProtectedMode,i=n.fieldEnd,t&&(n=n.fieldSeparator),f=n.line.getOffset(n,t?1:0),r=new l(this.owner),r.setPositionParagraph(n.line,f),_instanceof(n.nextNode,e)&&!t&&(i=n.nextElement.reference),o=i.line.getOffset(i,t?0:1),u=new l(this.owner),u.setPositionParagraph(i.line,o),this.documentHelper.selection.selectRange(r,u))},n.prototype.selectShape=function(n){var r,t,u,i;n&&(r=n.line.getOffset(n,0),t=new l(this.owner),t.setPositionParagraph(n.line,r),u=n.line.getOffset(n,1),i=new l(this.owner),i.setPositionParagraph(n.line,u),this.documentHelper.selection.selectRange(t,i))},n.prototype.toggleBold=function(){this.owner.editorModule&&this.owner.editorModule.toggleBold()},n.prototype.toggleItalic=function(){this.owner.editorModule&&this.owner.editorModule.toggleItalic()},n.prototype.toggleAllCaps=function(){this.owner.editorModule&&this.owner.editorModule.toggleAllCaps()},n.prototype.toggleUnderline=function(n){this.owner.editor&&this.owner.editor.toggleUnderline(n)},n.prototype.toggleStrikethrough=function(n){this.owner.editor&&this.owner.editor.toggleStrikethrough(n)},n.prototype.toggleHighlightColor=function(n){this.owner.editor&&this.owner.editor.toggleHighlightColor(n)},n.prototype.toggleSubscript=function(){this.owner.editor&&this.owner.editor.toggleSubscript()},n.prototype.toggleSuperscript=function(){this.owner.editor&&this.owner.editor.toggleSuperscript()},n.prototype.toggleTextAlignment=function(n){this.owner.editor&&this.owner.editor.toggleTextAlignment(n)},n.prototype.increaseIndent=function(){this.owner.editor&&this.owner.editor.increaseIndent()},n.prototype.decreaseIndent=function(){this.owner.editor&&this.owner.editor.decreaseIndent()},n.prototype.navigateHyperlink=function(){var n=this.getHyperlinkField();n&&this.fireRequestNavigate(n)},n.prototype.fireRequestNavigate=function(n){var i=this.getFieldCode(n),t,r;(0!==i.toLowerCase().indexOf("ref ")||i.match("\\h"))&&(t=new vu(n,this),r={isHandled:!1,navigationLink:t.navigationLink,linkType:t.linkType,localReference:t.localReference},this.owner.dotNetRef.invokeMethodAsync("RequestNavigate",r))},n.prototype.copyHyperlink=function(){var n=this.getHyperlinkField(),t=this.getLinkText(n);this.copyToClipboard(t)},n.prototype.isHideSelection=function(n){var i=n.bodyWidget,r=i.sectionFormat,u=r.pageHeight-r.footerDistance,f=i.page.boundingRectangle.height/100*40;return this.contextType.indexOf("Footer")>=0&&n.y+n.height>t.convertPointToPixel(u)||this.contextType.indexOf("Header")>=0&&n.y+n.height>f},n.prototype.highlightSelection=function(n){if(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.hideImageResizer(),this.isEmpty){if(!this.isInShape&&this.isHideSelection(this.start.paragraph))return void this.hideCaret();this.isInShape&&this.showResizerForShape();this.updateCaretPosition()}else this.isForward?this.highlightSelectedContent(this.start,this.end):this.highlightSelectedContent(this.end,this.start),this.documentHelper.isComposingIME&&this.updateCaretPosition();this.documentHelper.updateTouchMarkPosition();n&&this.documentHelper.scrollToPosition(this.start,this.end)},n.prototype.createHighlightBorder=function(n,t,i,r,u){var l,o,y,a,h,s,p,w,v;if(t<0&&(t=0),l=n.paragraph,o=[],l.floatingElements.length>0)for(y=0;y<l.floatingElements.length;y++)a=l.floatingElements[y],a.line===n&&(h=this.start,s=this.end,this.isForward||(h=this.end,s=this.start),p=a.line.getOffset(a,0),(h.currentWidget!==n&&s.currentWidget!==n||h.currentWidget===n&&h.offset<=p&&(s.currentWidget===n&&s.offset>=p+1||s.currentWidget!==n)||h.currentWidget!==n&&s.currentWidget===n&&s.offset>=p)&&o.push(a));var b=this.getPage(n.paragraph),f=(n.height,this.selectedWidgets),e=void 0,c=void 0;if(this.isHightlightEditRegionInternal)this.addEditRegionHighlight(n,i,t);else if(this.isHighlightFormFields)this.addFormFieldHighlight(n,i,t);else{if(f.containsKey(n))_instanceof(f.get(n),ui)?(e=f.get(n),u&&(f.remove(n),c=[],f.add(n,c))):c=f.get(n);else if(u)c=[],f.add(n,c);else if(w=this.getWrapPosition(n,l),w.length>0){if(v=this.splitSelectionHighlightPosition(i,t,w),v.length>0)return v[0].floatingItems=o,f.add(n,v),void this.renderHighlight(b,n,v,r,o);(e=new ui(i,t)).floatingItems=o;f.add(n,e)}else(e=new ui(i,t)).floatingItems=o,f.add(n,e);void 0===e&&((e=new ui(i,t)).floatingItems=o,f.add(n,e));this.renderHighlight(b,n,[e],r,o);u&&c.push(e)}},n.prototype.renderHighlight=function(n,t,i,r,u){var e=this.owner.documentHelper,s=this.getPageTop(n),l=n.boundingRectangle.x,a=t.height,f,h,o;if(this.viewer.containerTop<=s||s<this.viewer.containerTop+e.selectionCanvas.height){for(f=e.zoomFactor,this.clipSelection(n,s),h=0;h<i.length;h++){var v=i[h],c=v.left,y=v.width;this.documentHelper.isComposingIME?this.renderDashLine(e.selectionContext,n,t,l+c*f-this.viewer.containerLeft,r,y*f,a):(this.documentHelper.selectionContext.fillStyle="gray",e.selectionContext.globalAlpha=.4,e.selectionContext.fillRect(l+c*f-this.viewer.containerLeft,s+r*f-this.viewer.containerTop,y*f,a*f))}if(u.length>0)for(o=0;o<u.length;o++){c=u[o].x;var p=u[o].y,w=u[o].width,b=u[o].height;e.selectionContext.fillRect(l+c*f-this.viewer.containerLeft,s+p*f-this.viewer.containerTop,w*f,b*f)}e.selectionContext.restore()}},n.prototype.getWrapPosition=function(n,t){var h=t.bodyWidget,u,f;if(!sf.base.isNullOrUndefined(h)&&h.floatingElements.length>0&&n.children.length>0){for(var e=this.getLeftInternal(n,n.children[0],0),o=0,r=[],c=!1,s=0;s<n.children.length;s++)u=n.children[s],_instanceof(u,lt)&&"Inline"!==u.textWrappingStyle||(u.padding.left>0&&(1===r.length&&0===r[0].end&&(r[0].end=r[0].start-t.x,r[0].start=t.x,e=t.x),f={},f.start=e+o,f.end=0,c&&(f.end=e+o+u.padding.left),r.push(f)),o+=u.padding.left+u.width,_instanceof(u,i)&&(c=!0));return 1===r.length&&0===r[0].end&&(r[0].end=r[0].start-t.x,r[0].start=t.x),r}return[]},n.prototype.splitSelectionHighlightPosition=function(n,t,i){for(var r,f=[],u=0;u<i.length;u++)r=i[u],n<r.start&&n+t<r.end||n>r.end||(n<r.start&&n+t>r.end?(f.push(new ui(n,r.start-n)),t=n+t-r.end,n=r.end):n===r.start&&(n+=r.end,t-=r.end),u===i.length-1&&f.push(new ui(n,t)));return f},n.prototype.addEditRegionHighlight=function(n,t,i){var r=void 0,f=this.editRegionHighlighters,u;return f.containsKey(n)?r=f.get(n):(r=[],f.add(n,r)),u=new ui(t,i),this.isCurrentUser&&(u.color=""!==this.owner.userColor?this.owner.userColor:"#FFFF00"),r.push(u),u},n.prototype.addFormFieldHighlight=function(n,t,i){var r=void 0,u=this.formFieldHighlighters,f;u.containsKey(n)?r=u.get(n):(r=[],u.add(n,r));f=new ui(t,i);r.push(f)},n.prototype.createHighlightBorderInsideTable=function(n){var f=this.getPage(n),i=void 0,e=n.x-n.margin.left+n.leftBorderWidth,o=n.width+n.margin.left+n.margin.right-n.leftBorderWidth-n.rightBorderWidth,s=n.y,h=n.height,r=this.getPageTop(f),c=f.boundingRectangle.x,l=this.viewer.containerTop<=r||r<this.viewer.containerTop+this.documentHelper.selectionCanvas.height,t=this.selectedWidgets,u;(this.isHightlightEditRegionInternal||this.isHighlightFormFields||(t.containsKey(n)&&_instanceof(t.get(n),ui)?(i=t.get(n),l&&this.documentHelper.selectionContext.clearRect(c+i.left*this.documentHelper.zoomFactor-this.viewer.containerLeft,r+s*this.documentHelper.zoomFactor-this.viewer.containerTop,i.width*this.documentHelper.zoomFactor,h*this.documentHelper.zoomFactor)):(i=new ui(e,o),t.containsKey(n)&&t.remove(t.get(n)),t.add(n,i))),l)&&(this.documentHelper.selectionContext.fillStyle="gray",this.documentHelper.selectionContext.globalAlpha=.4,u=this.documentHelper.zoomFactor,this.clipSelection(f,r),this.documentHelper.selectionContext.fillRect(c+e*u-this.viewer.containerLeft,r+s*u-this.viewer.containerTop,o*u,h*u),this.documentHelper.selectionContext.restore())},n.prototype.clipSelection=function(n,t){var r,u,i=this.owner.documentHelper,f;_instanceof(this.viewer,at)&&this.documentHelper.zoomFactor<1?(r=n.boundingRectangle.width/this.documentHelper.zoomFactor,u=n.boundingRectangle.height/this.documentHelper.zoomFactor):(r=n.boundingRectangle.width*this.documentHelper.zoomFactor,u=n.boundingRectangle.height*this.documentHelper.zoomFactor);f=n.boundingRectangle.x;i.selectionContext.beginPath();i.selectionContext.save();i.selectionContext.rect(f-this.viewer.containerLeft,t-this.viewer.containerTop,r,u);i.selectionContext.clip()},n.prototype.addSelectionHighlight=function(n,t,i){var u,h,f,v;if(this.selectedWidgets.containsKey(t)){var a=this.documentHelper.render.getScaledValue(t.height),c=this.selectedWidgets.get(t),r=void 0;if(_instanceof(c,ui)?(r=[]).push(c):r=c,!sf.base.isNullOrUndefined(r))for(u=0;u<r.length;u++){var e=r[u],o=this.documentHelper.render.getScaledValue(r[u].width),s=this.documentHelper.render.getScaledValue(r[u].left,1),l=this.owner.selection.getPage(t.paragraph);if(this.owner.selection.clipSelection(l,this.owner.selection.getPageTop(l)),this.documentHelper.isComposingIME)this.renderDashLine(n,l,t,s,i,o,a);else if(n.globalAlpha=.4,n.fillStyle="gray",n.fillRect(s,this.documentHelper.render.getScaledValue(i,2),o,a),e.floatingItems&&e.floatingItems.length>0)for(h=0;h<e.floatingItems.length;h++)f=e.floatingItems[h],o=this.documentHelper.render.getScaledValue(f.width),s=this.documentHelper.render.getScaledValue(f.x,1),v=this.documentHelper.render.getScaledValue(f.y,2),n.fillRect(s,v,o,this.documentHelper.render.getScaledValue(f.height));n.restore()}}},n.prototype.renderDashLine=function(n,i,r,u,f,e){var o=this.characterFormat.fontColor,h=o?t.getColor(o):"#000000";n.globalAlpha=1;var c=this.owner.editor.copyInsertFormat(new p,!1),s=this.documentHelper.textHelper.getHeight(c),l=this.getPageTop(i),a=s.Height-s.BaselineOffset;f=this.documentHelper.render.getUnderlineYPosition(r)+f+4-a;this.documentHelper.render.renderDashLine(n,u,l-this.viewer.containerTop+f*this.documentHelper.zoomFactor,e,h,!0)},n.prototype.addSelectionHighlightTable=function(n,t){var u,i,r,f;if(this.selectedWidgets.containsKey(t)&&(u=this.selectedWidgets.get(t),i=void 0,_instanceof(u,ui)?(i=[]).push(u):i=u,!sf.base.isNullOrUndefined(i)))for(r=0;r<i.length;r++){var e=this.documentHelper.render.getScaledValue(i[r].left,1),o=this.documentHelper.render.getScaledValue(t.y,2),s=this.documentHelper.render.getScaledValue(i[r].width),h=this.documentHelper.render.getScaledValue(t.height);n.fillStyle="gray";f=this.owner.selection.getPage(t);this.owner.selection.clipSelection(f,this.owner.selection.getPageTop(f));n.fillRect(e,o,s,h);n.restore()}},n.prototype.removeSelectionHighlight=function(n){var l=0,o=0,a=0,h=0,t=void 0,r,v,f,i,u;if(_instanceof(n,k)){if(r=n,v=r.paragraph,t=sf.base.isNullOrUndefined(v)?void 0:this.getPage(r.paragraph),sf.base.isNullOrUndefined(t))return;o=this.getTop(r);h=r.height}else if(_instanceof(n,s)){if(t=sf.base.isNullOrUndefined(n)?void 0:this.getPage(n),sf.base.isNullOrUndefined(t))return;o=n.y;h=n.height}if(!sf.base.isNullOrUndefined(t)&&(f=this.selectedWidgets.get(n),i=void 0,_instanceof(f,ui)?(i=[]).push(f):i=f,!sf.base.isNullOrUndefined(i)))for(u=0;u<i.length;u++){a=i[u].width;l=i[u].left;var y=t.boundingRectangle,p=this.documentHelper.pages.indexOf(t),w=this.viewer.pageGap,c=(y.y-w*(p+1))*this.documentHelper.zoomFactor+w*(p+1),b=y.x,e=this.documentHelper.zoomFactor;(this.viewer.containerTop<=c||c<this.viewer.containerTop+this.documentHelper.selectionCanvas.height)&&this.documentHelper.selectionContext.clearRect(b+l*e-this.viewer.containerLeft-.5,c+o*e-this.viewer.containerTop-.5,a*e+.5,h*e+.5)}},n.prototype.selectCurrentWord=function(n){var t=this.start.clone(),i=this.end.clone();this.selectCurrentWordRange(t,i,n||!1);this.selectRange(t,i)},n.prototype.selectParagraph=function(){sf.base.isNullOrUndefined(this.start)||(this.start.paragraphStartInternal(this,!1),this.end.moveToParagraphEndInternal(this,!1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},n.prototype.selectLine=function(){sf.base.isNullOrUndefined(this.start)||(this.moveToLineStart(),this.handleShiftEndKey())},n.prototype.moveToDocumentStart=function(){this.handleControlHomeKey()},n.prototype.moveToDocumentEnd=function(){this.handleControlEndKey()},n.prototype.moveToParagraphStart=function(){this.isForward?(this.start.paragraphStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.end.location.x):(this.end.paragraphStartInternal(this,!1),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x);this.fireSelectionChanged(!0)},n.prototype.moveToParagraphEnd=function(){this.isForward?(this.start.moveToParagraphEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.end.location.x):(this.end.moveToParagraphEndInternal(this,!1),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x);this.fireSelectionChanged(!0)},n.prototype.moveToNextLine=function(){this.moveDown()},n.prototype.moveToPreviousLine=function(){this.moveUp()},n.prototype.moveToNextCharacter=function(){this.handleRightKey()},n.prototype.moveToPreviousCharacter=function(){this.handleLeftKey()},n.prototype.selectCurrentWordRange=function(n,t,i){if(!sf.base.isNullOrUndefined(n)){if(n.offset>0){var u=n.clone(),e=0,o=n.currentWidget.getInline(n.offset,e),f=o.element;e=o.index;!sf.base.isNullOrUndefined(f)&&_instanceof(f,r)&&1===f.fieldType?n.offset>2&&(!sf.base.isNullOrUndefined(f.fieldSeparator)||sf.base.isNullOrUndefined(f.fieldBegin))?(u.setPositionParagraph(u.currentWidget,n.offset-2),u.moveToWordEndInternal(0,!1),u.paragraph===n.paragraph&&u.offset===n.offset-1||n.moveToWordStartInternal(2)):n.offset>3&&sf.base.isNullOrUndefined(f.fieldSeparator)&&(u.setPositionParagraph(u.currentWidget,n.offset-3),u.moveToWordEndInternal(0,!1),u.paragraph===n.paragraph&&u.offset===n.offset||n.moveToWordStartInternal(2)):(u.setPositionParagraph(u.currentWidget,n.offset-1),u.moveToWordEndInternal(0,!1),u.paragraph===n.paragraph&&u.offset===n.offset||n.moveToWordStartInternal(2))}t.moveToWordEndInternal(2,i)}},n.prototype.extendToParagraphStart=function(){sf.base.isNullOrUndefined(this.start)||(this.end.paragraphStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},n.prototype.extendToParagraphEnd=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToParagraphEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},n.prototype.moveNextPosition=function(){if(!sf.base.isNullOrUndefined(this.start)&&(this.isEmpty&&(this.start.moveNextPosition(),this.end.setPositionInternal(this.start)),this.updateForwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0),this.documentHelper.isFormFillProtectedMode)){var n=this.getCurrentFormField();n||(n=this.getFormFieldInFormFillMode(),this.selectPrevNextFormField(!0,n))}},n.prototype.moveToNextParagraph=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToNextParagraphStartInternal(),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},n.prototype.nextFootnote=function(){var t,n;if(this.isinFootnote){var f=this.start.paragraph.footNoteReference,o=(this.documentHelper.footnoteCollection.length,this.documentHelper.footnoteCollection.indexOf(f)),i=this.documentHelper.footnoteCollection[o+1];sf.base.isNullOrUndefined(i)&&(i=f);for(var r=this.start.clone(),e=this.end.clone(),u=0;u<this.documentHelper.pages.length;u++)for(t=this.documentHelper.pages[u].footnoteWidget,n=1;n<t.childWidgets.length;n++)t.childWidgets[n].footNoteReference===i&&(r.setPositionParagraph(t.childWidgets[n].childWidgets[0],0),e.setPositionInternal(r),this.selectRange(r,e))}},n.prototype.previousFootnote=function(){var t,n;if(this.isinFootnote){var f=this.start.paragraph.footNoteReference,o=(this.documentHelper.footnoteCollection.length,this.documentHelper.footnoteCollection.indexOf(f)),i=this.documentHelper.footnoteCollection[o-1];sf.base.isNullOrUndefined(i)&&(i=f);for(var r=this.start.clone(),e=this.end.clone(),u=0;u<this.documentHelper.pages.length;u++)for(t=this.documentHelper.pages[u].footnoteWidget,n=1;n<t.childWidgets.length;n++)t.childWidgets[n].footNoteReference===i&&(r.setPositionParagraph(t.childWidgets[n].childWidgets[0],0),e.setPositionInternal(r),this.selectRange(r,e))}},n.prototype.nextEndnote=function(){if(this.isinEndnote){var u=this.start.paragraph.footNoteReference,e=(this.documentHelper.endnoteCollection.length,this.documentHelper.endnoteCollection.indexOf(u)),t=this.documentHelper.endnoteCollection[e+1];sf.base.isNullOrUndefined(t)&&(t=u);for(var i=this.start.clone(),f=this.end.clone(),r=this.documentHelper.pages[this.endPage-1].endnoteWidget,n=0;n<r.childWidgets.length;n++)r.childWidgets[n].footNoteReference===t&&(i.setPositionParagraph(r.childWidgets[n].childWidgets[0],0),f.setPositionInternal(i),this.selectRange(i,f))}},n.prototype.previousEndnote=function(){if(this.isinEndnote){var u=this.start.paragraph.footNoteReference,e=(this.documentHelper.endnoteCollection.length,this.documentHelper.endnoteCollection.indexOf(u)),t=this.documentHelper.endnoteCollection[e-1];sf.base.isNullOrUndefined(t)&&(t=u);for(var i=this.start.clone(),f=this.end.clone(),r=this.documentHelper.pages[this.endPage-1].endnoteWidget,n=0;n<r.childWidgets.length;n++)r.childWidgets[n].footNoteReference===t&&(i.setPositionParagraph(r.childWidgets[n].childWidgets[0],0),f.setPositionInternal(i),this.selectRange(i,f))}},n.prototype.movePreviousPosition=function(){if(!sf.base.isNullOrUndefined(this.start)&&(this.isEmpty&&(this.start.movePreviousPosition(),this.end.setPositionInternal(this.start)),this.updateBackwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0),this.documentHelper.isFormFillProtectedMode)){var n=this.getCurrentFormField();n||(n=this.getFormFieldInFormFillMode(),this.selectPrevNextFormField(!1,n))}},n.prototype.moveToPreviousParagraph=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToPreviousParagraph(this),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},n.prototype.extendToPreviousLine=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToPreviousLine(this,this.upDownSelectionLength),this.fireSelectionChanged(!0))},n.prototype.extendToLineEnd=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToLineEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},n.prototype.extendToLineStart=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToLineStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.start.paragraph===this.end.paragraph&&this.start.offset===this.start.currentWidget.getEndOffset()&&this.isParagraphLastLine(this.start.currentWidget)&&this.isParagraphFirstLine(this.end.currentWidget)&&this.start.setPositionParagraph(this.start.currentWidget,this.start.offset+1),this.fireSelectionChanged(!0))},n.prototype.moveUp=function(){this.documentHelper.isFormFillProtectedMode?this.selectPrevNextFormField(!1):sf.base.isNullOrUndefined(this.start)||(this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.upDownSelectionLength=this.start.location.x,this.start.moveUp(this,this.upDownSelectionLength),this.end.setPositionInternal(this.start),this.fireSelectionChanged(!0))},n.prototype.moveDown=function(){this.documentHelper.isFormFillProtectedMode?this.selectPrevNextFormField(!0):sf.base.isNullOrUndefined(this.start)||(this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x),this.start.moveDown(this,this.upDownSelectionLength),this.end.setPositionInternal(this.start),this.fireSelectionChanged(!0))},n.prototype.updateForwardSelection=function(){this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start))},n.prototype.updateBackwardSelection=function(){this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end))},n.prototype.getFirstBlockInFirstCell=function(n){var t,i;if(n.childWidgets.length>0&&(t=n.childWidgets[0],t.childWidgets.length>0))return(i=t.childWidgets[0],0===i.childWidgets.length)?void 0:i.childWidgets[0]},n.prototype.getFirstCellInRegion=function(n,i,r,u){var o=this.getCellLeft(n,i),l=o+i.cellFormat.cellWidth,s=!0,e,h,f,c,a;if(o<=r&&r<l){for(e=0;e<n.childWidgets.length;e++)if(h=this.getCellLeft(n,n.childWidgets[e]),t.round(o,2)<=t.round(h,2)&&t.round(h,2)<t.round(l,2))return s=!1,n.childWidgets[e]}else for(f=0;f<n.childWidgets.length;f++)if(c=this.getCellLeft(n,n.childWidgets[f]),c<=r&&c+n.childWidgets[f].cellFormat.cellWidth>r)return s=!1,n.childWidgets[f];if(s){if(!sf.base.isNullOrUndefined(n.previousRenderedWidget)&&u)return a=n.previousRenderedWidget,this.getFirstCellInRegion(a,i,r,u);if(!sf.base.isNullOrUndefined(n.nextRenderedWidget)&&!u)return this.getFirstCellInRegion(n.nextRenderedWidget,i,r,u)}return n.childWidgets[0]},n.prototype.getFirstParagraph=function(n){for(;n.previousSplitWidget;)n=n.previousSplitWidget;var t=n.firstChild;return this.getFirstParagraphBlock(t)},n.prototype.getLastBlockInLastCell=function(n){if(n.childWidgets.length>0){for(var i=n.childWidgets[n.childWidgets.length-1],t=i.childWidgets[i.childWidgets.length-1];0===t.childWidgets.length&&!sf.base.isNullOrUndefined(t.previousSplitWidget);)t=t.previousSplitWidget;return t.childWidgets[t.childWidgets.length-1]}},n.prototype.moveToLineStart=function(){sf.base.isNullOrUndefined(this.start)||(this.updateBackwardSelection(),this.start.moveToLineStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},n.prototype.moveToLineEnd=function(){sf.base.isNullOrUndefined(this.start)||(this.updateForwardSelection(),this.start.moveToLineEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},n.prototype.getPageTop=function(n){return(n.boundingRectangle.y-this.viewer.pageGap*(this.documentHelper.pages.indexOf(n)+1))*this.documentHelper.zoomFactor+this.viewer.pageGap*(this.documentHelper.pages.indexOf(n)+1)},n.prototype.moveTextPosition=function(n,t){var u,i,r;sf.base.isNullOrUndefined(this.start)||(u=this.documentHelper.getLineWidgetInternal(n,!0),sf.base.isNullOrUndefined(u)||this.updateTextPositionWidget(u,n,t,!0),this.upDownSelectionLength=t.location.x,i=this.start.getHierarchicalIndexInternal(),r=this.end.getHierarchicalIndexInternal(),i!==r&&(l.isForwardSelection(i,r)?t.validateForwardFieldSelection(i,r):t.validateBackwardFieldSelection(i,r)),this.fireSelectionChanged(!0))},n.prototype.getDocumentStart=function(){var n=this.documentHelper.pages[0].bodyWidgets[0].childWidgets[0];return this.setPositionForBlock(n,!0)},n.prototype.getDocumentEnd=function(){var n=void 0,f=this.owner.documentStart,t=this.documentHelper.pages[this.documentHelper.pages.length-1];if(!sf.base.isNullOrUndefined(f)&&t.bodyWidgets[0].childWidgets.length>0){var i=void 0,r=t.bodyWidgets[0].childWidgets,u=r[r.length-1];_instanceof(u,wt)&&(i=u);n=this.setPositionForBlock(i,!1)}return n},n.prototype.handleControlEndKey=function(){var n=void 0;sf.base.isNullOrUndefined(this.owner.documentEnd)||(n=this.owner.documentEnd);sf.base.isNullOrUndefined(n)||this.owner.selection.selectContent(n,!0);this.checkForCursorVisibility()},n.prototype.handleControlHomeKey=function(){var n=void 0;sf.base.isNullOrUndefined(this.owner.documentStart)||(n=this.owner.documentStart);sf.base.isNullOrUndefined(n)||this.owner.selection.selectContent(n,!0);this.checkForCursorVisibility()},n.prototype.handleControlLeftKey=function(){this.extendToWordStartInternal(!0);this.checkForCursorVisibility()},n.prototype.handleControlRightKey=function(){this.extendToWordEndInternal(!0);this.checkForCursorVisibility()},n.prototype.handleControlDownKey=function(){this.moveToNextParagraph();this.checkForCursorVisibility()},n.prototype.handleControlUpKey=function(){this.moveToPreviousParagraph();this.checkForCursorVisibility()},n.prototype.handleShiftLeftKey=function(){this.extendBackward();this.checkForCursorVisibility()},n.prototype.handleShiftUpKey=function(){this.extendToPreviousLine();this.checkForCursorVisibility()},n.prototype.handleShiftRightKey=function(){this.extendForward();this.checkForCursorVisibility()},n.prototype.handleShiftDownKey=function(){this.extendToNextLine();this.checkForCursorVisibility()},n.prototype.handleControlShiftLeftKey=function(){(this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.extendToWordEndInternal(!1):this.extendToWordStartInternal(!1);this.checkForCursorVisibility()},n.prototype.handleControlShiftUpKey=function(){this.extendToParagraphStart();this.checkForCursorVisibility()},n.prototype.handleControlShiftRightKey=function(){(this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.extendToWordStartInternal(!1):this.extendToWordEndInternal(!1);this.checkForCursorVisibility()},n.prototype.handleControlShiftDownKey=function(){this.extendToParagraphEnd();this.checkForCursorVisibility()},n.prototype.handleLeftKey=function(){this.end.isCurrentParaBidi?this.moveNextPosition():this.movePreviousPosition();this.checkForCursorVisibility()},n.prototype.handleUpKey=function(){this.isMoveDownOrMoveUp=!0;this.moveUp();this.isMoveDownOrMoveUp=!1;this.checkForCursorVisibility()},n.prototype.handleRightKey=function(){this.end.isCurrentParaBidi?this.movePreviousPosition():this.moveNextPosition();this.checkForCursorVisibility()},n.prototype.handleEndKey=function(){this.moveToLineEnd();this.checkForCursorVisibility()},n.prototype.handleHomeKey=function(){this.moveToLineStart();this.checkForCursorVisibility()},n.prototype.handleDownKey=function(){this.isMoveDownOrMoveUp=!0;this.moveDown();this.isMoveDownOrMoveUp=!1;this.checkForCursorVisibility()},n.prototype.handleShiftEndKey=function(){this.extendToLineEnd();this.checkForCursorVisibility()},n.prototype.handleShiftHomeKey=function(){this.extendToLineStart();this.checkForCursorVisibility()},n.prototype.handleControlShiftEndKey=function(){var n=void 0;sf.base.isNullOrUndefined(this.owner.documentEnd)||(n=this.owner.documentEnd);sf.base.isNullOrUndefined(n)||(this.end.setPosition(n.currentWidget,!1),this.fireSelectionChanged(!0));this.checkForCursorVisibility()},n.prototype.handleControlShiftHomeKey=function(){var n=void 0;sf.base.isNullOrUndefined(this.owner.documentStart)||(n=this.owner.documentStart);sf.base.isNullOrUndefined(n)||(this.end.setPositionInternal(n),this.fireSelectionChanged(!0));this.checkForCursorVisibility()},n.prototype.handleSpaceBarKey=function(){this.owner.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.owner.documentHelper.protectionType&&"CheckBox"===this.getFormFieldType()&&this.owner.editor.toggleCheckBoxFormField(this.getCurrentFormField())},n.prototype.handleTabKey=function(n,t){var i=this.start;sf.base.isNullOrUndefined(i)||(i.paragraph.isInsideTable&&this.end.paragraph.isInsideTable&&(n||t)?this.owner.documentHelper.isDocumentProtected||"FormFieldsOnly"===this.documentHelper.protectionType||(t?this.selectPreviousCell():this.selectNextCell()):!n&&!t||sf.base.isNullOrUndefined(i)||i.offset!==this.getStartOffset(i.paragraph)||sf.base.isNullOrUndefined(i.paragraph.paragraphFormat)||sf.base.isNullOrUndefined(i.paragraph.paragraphFormat.listFormat)||-1===i.paragraph.paragraphFormat.listFormat.listId||this.owner.isReadOnlyMode?this.owner.isReadOnlyMode||this.documentHelper.isFormFillProtectedMode||this.owner.editorModule.handleTextInput("\t"):this.owner.editorModule.updateListLevel(!t),"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.formFields.length>0&&this.selectPrevNextFormField(!t),this.checkForCursorVisibility())},n.prototype.getFormFieldInFormFillMode=function(){for(var t,i=this.owner.selection.start,n=this.documentHelper.formFields.length-1;n>=0;n--)if(this.documentHelper.formFields[n].formFieldData.enabled){if(this.getElementPosition(this.documentHelper.formFields[n]).startPosition.isExistBefore(i)){t=this.documentHelper.formFields[n];break}0===n&&(t=this.documentHelper.formFields[this.documentHelper.formFields.length-1])}return t},n.prototype.selectPrevNextFormField=function(n,t){var r,i;if(this.documentHelper.isFormFillProtectedMode)if(t||(t=this.getCurrentFormField()),r=this.documentHelper.formFields.indexOf(t),n)for(i=r;;i++){if(i===this.documentHelper.formFields.length-1?i=0:i+=1,this.documentHelper.formFields[i].formFieldData.enabled){this.selectFieldInternal(this.documentHelper.formFields[i]);break}i-=1}else for(i=r;;i--){if(0===i?i=this.documentHelper.formFields.length-1:i-=1,this.documentHelper.formFields[i].formFieldData.enabled){this.selectFieldInternal(this.documentHelper.formFields[i]);break}i+=1}},n.prototype.navigateToNextFormField=function(){for(var t,i=this.owner.selection.end,n=0;n<this.documentHelper.formFields.length;n++)if(t=this.documentHelper.formFields[n],this.documentHelper.formFields[n].formFieldData.enabled){if(this.getElementPosition(this.documentHelper.formFields[n]).startPosition.isExistAfter(i)){_instanceof(t.formFieldData,vt)&&"Text"===t.formFieldData.type&&this.documentHelper.isInlineFormFillProtectedMode?this.selectTextElementStartOfField(this.documentHelper.formFields[n]):this.selectFieldInternal(this.documentHelper.formFields[n]);break}n===this.documentHelper.formFields.length-1&&(_instanceof((t=this.documentHelper.formFields[0]).formFieldData,vt)&&"Text"===t.formFieldData.type&&this.documentHelper.isInlineFormFillProtectedMode?this.selectTextElementStartOfField(this.documentHelper.formFields[0]):this.selectFieldInternal(this.documentHelper.formFields[0]))}},n.prototype.selectTextElementStartOfField=function(n){var t=n.fieldSeparator.nextElement,r,u;if(t){for(;!_instanceof(t,i);)t=t.nextElement;r=n.line.getOffset(t,0);u=this.getPhysicalPositionInternal(n.line,r,!1);this.selectInternal(n.line,t,0,u)}},n.prototype.triggerFormFillEvent=function(){var n=this.previousSelectedFormField,t=this.getCurrentFormField();t!==n&&n&&_instanceof(n.formFieldData,vt)&&"Text"===n.formFieldData.type&&(""===n.formFieldData.format||this.isFormatUpdated||this.owner.editor.applyFormTextFormat(n),n.formFieldData.name,this.owner.editorModule.getFormFieldText(n));t!==n&&t&&_instanceof(t.formFieldData,vt)&&"Text"===t.formFieldData.type&&(t.formFieldData.name,this.owner.editorModule.getFormFieldText(t))},n.prototype.selectPreviousCell=function(){var n=this.start.paragraph.associatedCell,t=n.ownerRow,i,r;t.ownerTable;sf.base.isNullOrUndefined(n.previousWidget)?sf.base.isNullOrUndefined(t.previousRenderedWidget)||(i=void 0,_instanceof(t.previousRenderedWidget,a)&&(i=t.previousRenderedWidget),this.selectTableCellInternal(i.childWidgets[i.childWidgets.length-1],!0)):(r=void 0,_instanceof(n.previousWidget,s)&&(r=n.previousWidget),this.selectTableCellInternal(r,!0))},n.prototype.selectNextCell=function(){var n=this.start.paragraph.associatedCell,t=n.ownerRow,i,r;t.ownerTable;sf.base.isNullOrUndefined(n.nextWidget)?sf.base.isNullOrUndefined(t.nextRenderedWidget)&&!this.owner.isReadOnlyMode?this.owner.editorModule.insertRow(!1):(i=void 0,_instanceof(t.nextRenderedWidget,a)&&(i=t.nextRenderedWidget),this.selectTableCellInternal(i.childWidgets[0],!0)):(r=void 0,_instanceof(n.nextRenderedWidget,s)&&(r=n.nextRenderedWidget),this.selectTableCellInternal(r,!0))},n.prototype.selectTableCellInternal=function(n){var r=this.getFirstParagraph(n),t=this.getLastParagraph(n),i;r===t&&t.isEmpty()?this.selectParagraphInternal(t,!0):(i=t.childWidgets[0],this.start.setPosition(r.childWidgets[0],!0),this.end.setPositionParagraph(i,i.getEndOffset()),this.fireSelectionChanged(!0))},n.prototype.selectTableInternal=function(){var n=this.start,t=this.end;if(this.isForward||(n=this.end,t=this.start),!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.getTable(n,t))){var i=this.getContainerCellOf(n.paragraph.associatedCell,t.paragraph.associatedCell).ownerTable,u=this.getFirstParagraphBlock(i),r=this.getLastParagraphBlock(i),f=r.lastChild.getEndOffset();this.start.setPosition(u.childWidgets[0],!0);this.end.setPositionParagraph(r.lastChild,f+1)}this.selectPosition(this.start,this.end)},n.prototype.selectColumnInternal=function(){var r=this.start,t=this.end,n,f,h,u,e,o,i,c,s;(this.isForward||(r=this.end,t=this.start),sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(this.getTable(r,t)))||(n=this.getContainerCellOf(r.paragraph.associatedCell,t.paragraph.associatedCell),n.ownerTable.contains(t.paragraph.associatedCell)&&(f=this.getSelectedCell(r.paragraph.associatedCell,n),h=this.getSelectedCell(t.paragraph.associatedCell,n),this.containsCell(n,t.paragraph.associatedCell)?(f.ownerRow,u=n.ownerTable.getColumnCellsForSelection(n,n),u.length>0&&(e=this.getFirstParagraph(u[0]),o=this.getLastParagraph(u[u.length-1]),this.start.setPosition(e.firstChild,!0),i=o.lastChild,this.end.setPositionParagraph(i,i.getEndOffset()+1))):(c=n.ownerTable.getColumnCellsForSelection(f,f),s=n.ownerTable.getColumnCellsForSelection(h,h),c.length>0&&s.length>0&&(e=this.getFirstParagraph(c[0]),o=this.getLastParagraph(s[s.length-1]),this.start.setPosition(e.firstChild,!0),i=o.lastChild,this.end.setPositionParagraph(i,i.getEndOffset()+1)))));this.selectPosition(this.start,this.end)},n.prototype.selectTableRow=function(){var i=this.start,n=this.end,r,u,f;if((this.isForward||(i=this.end,n=this.start),!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(this.getTable(i,n)))&&(r=void 0,(r=this.getContainerCellOf(i.paragraph.associatedCell,n.paragraph.associatedCell)).ownerTable.contains(n.paragraph.associatedCell)))if(u=this.getSelectedCell(i.paragraph.associatedCell,r),f=this.getSelectedCell(n.paragraph.associatedCell,r),this.containsCell(r,n.paragraph.associatedCell)){var e=u.ownerRow,o=this.getFirstParagraph(e.childWidgets[0]),t=this.getLastParagraph(e.childWidgets[e.childWidgets.length-1]);this.start.setPosition(o.firstChild,!0);this.end.setPositionParagraph(t.lastChild,t.lastChild.getEndOffset()+1)}else o=this.getFirstParagraph(u.ownerRow.childWidgets[0]),t=void 0,t=this.getLastParagraph(f.ownerRow.childWidgets[f.ownerRow.childWidgets.length-1]),this.start.setPosition(o.firstChild,!0),this.end.setPositionParagraph(t.lastChild,t.lastChild.getEndOffset()+1);this.selectPosition(this.start,this.end)},n.prototype.selectTableCell=function(){var t=this.start,u=this.end,i,r,n;(this.isForward||(t=this.end,u=this.start),sf.base.isNullOrUndefined(this.getTable(t,u)))||(this.isEmpty?t.paragraph.isInsideTable&&!sf.base.isNullOrUndefined(t.paragraph.associatedCell)&&((r=this.getFirstParagraph(t.paragraph.associatedCell))===(n=this.getLastParagraph(u.paragraph.associatedCell))?(this.start.setPosition(n.firstChild,!0),this.end.setPositionParagraph(n.lastChild,n.lastChild.getEndOffset()+1)):(this.start.setPosition(r.firstChild,!0),this.end.setPositionParagraph(n.lastChild,n.lastChild.getEndOffset()+1))):(i=this.getContainerCell(t.paragraph.associatedCell),this.containsCell(i,t.paragraph.associatedCell)&&this.containsCell(i,u.paragraph.associatedCell)&&(r=this.getFirstParagraph(i),n=this.getLastParagraph(i),sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(n)||(this.start.setPosition(r.firstChild,!0),this.end.setPositionParagraph(n.lastChild,n.lastChild.getEndOffset()+1)))),this.selectPosition(this.start,this.end))},n.prototype.selectAll=function(){var n,t,r,f,e,h,o;if(this.documentHelper.skipScrollToPosition=!0,r=this.getContainerWidget(this.start.paragraph),this.owner.enableHeaderAndFooter)f=this.getContainerWidget(this.start.paragraph),n=this.setPositionForBlock(f.firstChild,!0),t=this.setPositionForBlock(f.lastChild,!1);else if(this.isInShape)e=this.getCurrentTextFrame(),n=this.setPositionForBlock(e.firstChild,!0),t=this.setPositionForBlock(e.lastChild,!1);else if(_instanceof(r,it)&&"Footnote"===r.footNoteType){for(var u=void 0,i=void 0,s=this.documentHelper.pages.length,u=0;u<=s-1;u++)if(!sf.base.isNullOrUndefined(this.documentHelper.pages[u].footnoteWidget)){n=this.setPositionForBlock(this.documentHelper.pages[u].footnoteWidget.firstChild,!0);break}for(i=s-1;i>=0;i--)if(!sf.base.isNullOrUndefined(this.documentHelper.pages[i].footnoteWidget)){h=this.documentHelper.pages[i].footnoteWidget.childWidgets.length;t=this.setPositionForBlock(this.documentHelper.pages[i].footnoteWidget.childWidgets[h-1],!1);break}}else _instanceof(r,it)&&"Endnote"===r.footNoteType?(o=this.getContainerWidget(this.start.paragraph),n=this.setPositionForBlock(o.firstChild,!0),t=this.setPositionForBlock(o.lastChild,!1)):(n=this.owner.documentStart,t=this.owner.documentEnd);sf.base.isNullOrUndefined(n)||(this.start.setPositionInternal(n),this.end.setPositionParagraph(t.currentWidget,t.offset+1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},n.prototype.extendBackward=function(){sf.base.isNullOrUndefined(this.start)||((this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.end.moveForward():this.end.moveBackward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},n.prototype.extendForward=function(){sf.base.isNullOrUndefined(this.start)||((this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.end.moveBackward():this.end.moveForward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},n.prototype.extendToWordStartEnd=function(){return!(!this.start.paragraph.isInsideTable&&!this.end.paragraph.isInsideTable||this.start.paragraph.associatedCell===this.end.paragraph.associatedCell&&!this.isCellSelected(this.start.paragraph.associatedCell,this.start,this.end))},n.prototype.extendToWordStart=function(){this.extendToWordStartInternal(!1)},Object.defineProperty(n.prototype,"sfdt",{get:function(){return this.owner.editorModule&&this.start.offset!==this.end.offset?JSON.stringify(this.writeSfdt()):null},enumerable:!0,configurable:!0}),n.prototype.extendToWordEnd=function(){this.extendToWordEndInternal(!1)},n.prototype.extendToWordStartInternal=function(n){sf.base.isNullOrUndefined(this.start)||(this.extendToWordStartEnd()?this.end.moveToPreviousParagraphInTable(this):n&&this.end.isCurrentParaBidi?this.end.moveToWordEndInternal(n?0:1,!1):this.end.moveToWordStartInternal(n?0:1),n&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},n.prototype.extendToWordEndInternal=function(n){sf.base.isNullOrUndefined(this.start)||(this.extendToWordStartEnd()?this.end.moveToNextParagraphInTable():n&&this.end.isCurrentParaBidi?this.end.moveToWordStartInternal(n?0:1):this.end.moveToWordEndInternal(n?0:1,!1),n&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},n.prototype.extendToNextLine=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToNextLine(this.upDownSelectionLength),this.fireSelectionChanged(!0))},n.prototype.getTextPosition=function(n){var t=new l(this.owner);return t.setPositionForCurrentIndex(n),t},n.prototype.getText=function(n){if(!(sf.base.isNullOrUndefined(this.start)||sf.base.isNullOrUndefined(this.end)||sf.base.isNullOrUndefined(this.start.paragraph)||sf.base.isNullOrUndefined(this.end.paragraph))){var t=this.start,i=this.end;return t.isAtSamePosition(i)?"":this.getTextInternal(t,i,n)}},n.prototype.getTextInternal=function(n,t,u){var w,a,h,f,y,p,l,e,s;if(n.isExistAfter(t)&&(w=t,t=n,n=w),a=n,h=t,!(sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(n.paragraph)||sf.base.isNullOrUndefined(t.paragraph))){var o=0,c=0,d=n.offset,b=t.offset,k=n.currentWidget.getInline(d,o);if(o=k.index,f=k.element,_instanceof(f,r)&&!sf.base.isNullOrUndefined(f.fieldEnd)&&(y=this.getRenderedInline(f,o),f=y.element,o=y.index),p=t.currentWidget.getInline(b,c),l=p.element,c=p.index,e="",_instanceof(f,v)&&u&&0===o?e=tt.objectCharacter:_instanceof(f,i)&&(e=sf.base.isNullOrUndefined(f.text)||""===f.text||f.text.length<o?e:f.text.substring(o)),a.paragraph===h.paragraph)_instanceof(f,tt)&&(f===l&&_instanceof(f,i)?e=e.length<c-o?e:e.substring(0,c-o):_instanceof(f.nextNode,tt)&&(e+=this.getTextInline(f.nextNode,h.paragraph,l,c,u)));else if(_instanceof(f,tt)&&_instanceof(f.nextNode,tt))e+=this.getTextInline(f.nextNode,h.paragraph,void 0,0,u);else{for(s=this.documentHelper.selection.getNextParagraphBlock(a.paragraph),e+="\r";!sf.base.isNullOrUndefined(s)&&s.isEmpty();){if(e+="\r",s===h.paragraph)return e;s=this.documentHelper.selection.getNextParagraphBlock(s)}sf.base.isNullOrUndefined(s)||s.isEmpty()||(e+=this.getTextInline(s.childWidgets[0].children[0],h.paragraph,l,c,u))}return b===h.currentWidget.getEndOffset()+1&&(e+="\r"),e}},n.prototype.getHierarchicalIndex=function(n,t){var i,r,u;if(n){if(_instanceof(n,ct)?(r=-1!==n.headerFooterType.indexOf("Header")?"H":"F",u=n.page.index.toString(),i=n.page.sectionIndex+";"+r+";"+u+";"+t):i=n.index+";"+t,_instanceof(n,et))return i="S;"+n.containerShape.indexInOwner.toString()+";"+t,this.getHierarchicalIndex(n.containerShape.paragraph,i);if(_instanceof(n,it)&&(r="Footnote"===n.footNoteType?"FN":"EN",u=n.page.index.toString(),i=n.page.sectionIndex+";"+r+";"+u+";"+t),n.containerWidget)return _instanceof(n,s)&&n.rowIndex!==n.containerWidget.index&&(i=n.rowIndex+";"+i,n=n.containerWidget),this.getHierarchicalIndex(n.containerWidget,i)}return i},n.prototype.getHierarchicalIndexByPosition=function(n){var t=this.getParagraphInfo(n);return this.getHierarchicalIndex(t.paragraph,t.offset.toString())},n.prototype.getTextPosBasedOnLogicalIndex=function(n){var t=new l(this.owner),i=this.getParagraph({index:n}),r=this.getLineInfoBasedOnParagraph(i.paragraph,i.offset);return t.setPositionForLineWidget(r.line,r.offset),t},n.prototype.getLineInfoBasedOnParagraph=function(n,t){var i=this.getParagraphLength(n),r=n.nextSplitWidget;for(t>i+1&&sf.base.isNullOrUndefined(r)&&(t=i);t>i&&_instanceof(r,u);)t-=i,n=r,i=this.getParagraphLength(n),r=n.nextSplitWidget;return this.getLineInfo(n,t)},n.prototype.getParagraph=function(n){return{paragraph:this.getParagraphInternal(this.getBodyWidget(n),n),offset:parseInt(n.index,10)}},n.prototype.getBodyWidget=function(n){var t=n.index.indexOf(";"),i=n.index.substring(0,t),r;return n.index=n.index.substring(t).replace(";",""),r=parseInt(i,10),t=parseInt(i,10),t=n.index.indexOf(";"),"H"===(i=n.index.substring(0,t))||"F"===i?this.getHeaderFooterWidget(n):"FN"===i||"EN"===i?this.getFootNoteWidget(n):(t=parseInt(i,10),this.getBodyWidgetInternal(r,t))},n.prototype.getFootNoteWidget=function(n){var t=n.index.indexOf(";"),i=n.index.substring(0,t),u,r;return n.index=n.index.substring(t).replace(";",""),u="FN"===i,t=n.index.indexOf(";"),i=n.index.substring(0,t),n.index=n.index.substring(t).replace(";",""),t=parseInt(i,10),r=this.documentHelper.pages[t],u?r.footnoteWidget:r.endnoteWidget},n.prototype.getHeaderFooterWidget=function(n){var t=n.index.indexOf(";"),i=n.index.substring(0,t),u,r;return n.index=n.index.substring(t).replace(";",""),u="H"===i,t=n.index.indexOf(";"),i=n.index.substring(0,t),n.index=n.index.substring(t).replace(";",""),t=parseInt(i,10),r=this.documentHelper.pages[t],u?r.headerWidget:r.footerWidget},n.prototype.getBodyWidgetInternal=function(n,t){for(var i,r=0;r<this.documentHelper.pages.length;r++){if(i=this.documentHelper.pages[r].bodyWidgets[0],i.index===n&&i.childWidgets.length>0&&i.firstChild.index<=t&&i.lastChild.index>=t)return i;if(i.index>n)break}},n.prototype.getParagraphInternal=function(n,t){var i,s,e,h,c,r,o;if(!sf.base.isNullOrUndefined(t.index))if(i=t.index.indexOf(";"),s="0",i>=0&&(s=t.index.substring(0,i),t.index=t.index.substring(i).replace(";","")),i=parseInt(s,10),_instanceof(n,a)&&i>=n.childWidgets.length&&(t.index="0;0",i=n.childWidgets.length-1),e=this.getBlockByIndex(n,i),e){if("S"===(s=t.index.substring(0,1))&&(t.index=t.index.substring(1).replace(";",""),h=t.index.substring(0,1),t.index=t.index.substring(1).replace(";",""),c=t.index.substring(0,1),t.index=t.index.substring(1).replace(";",""),e=e.floatingElements[h].textFrame.childWidgets[c]),r=e,_instanceof(r,u))return t.index.indexOf(";")>0&&(t.index="0"),r;if(_instanceof(r,gt))return t.index.indexOf(";")>0?this.getParagraphInternal(r,t):_instanceof(r,f)?this.documentHelper.selection.getFirstParagraphInFirstCell(r):void 0}else if(n&&(o=n.getSplitWidgets().pop().nextRenderedWidget,_instanceof(o,gt)))return t.index="0",_instanceof(o,f)?this.documentHelper.selection.getFirstParagraphInFirstCell(o):o},n.prototype.getBlockByIndex=function(n,t){var r,i;if(n){for(i=0;i<n.childWidgets.length;i++)if(n.childWidgets[i].index===t){r=n.childWidgets[i];break}if(!(r||_instanceof(n,ct)))return this.getBlockByIndex(n.nextSplitWidget,t)}return r},n.prototype.getParagraphInfo=function(n){return this.getParagraphInfoInternal(n.currentWidget,n.offset)},n.prototype.getParagraphInfoInternal=function(n,t){for(var i=n.paragraph,f=this.getParagraphLength(i,n)+t,r=i.previousSplitWidget;_instanceof(r,u);)i=r,f+=this.documentHelper.selection.getParagraphLength(i),r=i.previousSplitWidget;return{paragraph:i,offset:f}},n.prototype.getListTextElementBox=function(n){var i,t;if(!sf.base.isNullOrUndefined(n))return n.isEmpty()||(t=n.childWidgets[0],t.children.length>1&&_instanceof(t.children[0],o)&&(i=t.children[0])),i},n.prototype.getListLevel=function(n){var t=void 0,i=0;if(sf.base.isNullOrUndefined(n.paragraphFormat)||sf.base.isNullOrUndefined(n.paragraphFormat.listFormat)||(t=this.documentHelper.getListById(n.paragraphFormat.listFormat.listId),i=n.paragraphFormat.listFormat.listLevelNumber),!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId))&&!sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId).levels))return this.documentHelper.layout.getListLevel(t,i)},n.prototype.getTextInline=function(n,t,u,f,e){var o="",h,s,c;do{if(n===u)return _instanceof(n,i)?(h=n,sf.base.isNullOrUndefined(h.text)||""===h.text||(o+=h.text.length<f?h.text:h.text.substring(0,f))):_instanceof(n,v)&&e&&f===n.length&&(o+=tt.objectCharacter),o;if(_instanceof(n,i)?o+=n.text:_instanceof(n,v)&&e?o+=tt.objectCharacter:_instanceof(n,r)&&!sf.base.isNullOrUndefined(n.fieldEnd)&&(n=sf.base.isNullOrUndefined(n.fieldSeparator)?n.fieldEnd:n.fieldSeparator),sf.base.isNullOrUndefined(n.nextNode))break;n=n.nextNode}while(!sf.base.isNullOrUndefined(n));if(t===n.line.paragraph)return o;for(s=this.documentHelper.selection.getNextParagraphBlock(n.line.paragraph);!sf.base.isNullOrUndefined(s)&&s.isEmpty();){if(o+="\r",s===t)return o;s=this.documentHelper.selection.getNextParagraphBlock(s)}return sf.base.isNullOrUndefined(s)||s.isEmpty()||(c=s.childWidgets[0],o=o+"\r"+this.getTextInline(c.children[0],t,u,f,e)),o},n.prototype.getFieldCode=function(n){var i="",t,f,e,o;if(!_instanceof(n.fieldEnd,r))return i;t=n.paragraph;f=n.fieldEnd.paragraph;_instanceof(n.fieldSeparator,r)&&(f=n.fieldSeparator.paragraph);e=n.line.indexInOwner;o=n.indexInOwner;do{if(i+=this.getFieldCodeInternal(t,e,o),t===f)break;t=this.getNextParagraphBlock(t);e=0;o=0}while(_instanceof(t,u));return i.trim()},n.prototype.getFieldCodeInternal=function(n,t,u){for(var h,s,f,e="",o=t;o<n.childWidgets.length;o++){for(h=n.childWidgets[o],s=u;s<h.children.length;s++)if(f=h.children[s],_instanceof(f,i)&&(e+=f.text),_instanceof(f,r)&&(2===f.fieldType||1===f.fieldType))return e;u=0}return e},n.prototype.getTocFieldInternal=function(){var n=this.start.paragraph,f,t,e;for(this.isEmpty||this.isForward||(n=this.end.paragraph);_instanceof(n,u)&&n.childWidgets.length>0;){if(f=n.firstChild,f.children.length>0&&(t=f.children[0],e=t.nextNode,_instanceof(t,r)&&0===t.fieldType&&_instanceof(e,i)&&0===e.text.trim().toLowerCase().indexOf("toc")))return t;n=n.previousRenderedWidget}},n.prototype.getNextParagraph=function(n){if(_instanceof(n.nextRenderedWidget,c)){var t=n.nextRenderedWidget.childWidgets[0];return this.getFirstParagraphBlock(t)}},n.prototype.getPreviousParagraph=function(n){if(_instanceof(n.previousRenderedWidget,c)){var t=n.previousRenderedWidget,i=t.childWidgets[t.childWidgets.length-1];return this.getLastParagraphBlock(i)}},n.prototype.getFirstParagraphInCell=function(n){var t=n.childWidgets[0];return _instanceof(t,u)?t:this.getFirstParagraphInFirstCell(t)},n.prototype.getFirstParagraphInFirstCell=function(n){if(n.childWidgets.length>0){var t=n.childWidgets[0].childWidgets[0].childWidgets[0];return this.getFirstParagraphBlock(t)}},n.prototype.getLastParagraphInLastCell=function(n){if(n.childWidgets.length>0){var t=n.lastChild.lastChild.lastChild;return this.getLastParagraphBlock(t)}},n.prototype.getLastParagraphInFirstRow=function(n){if(n.childWidgets.length>0){var t=n.firstChild.lastChild.lastChild;return this.getLastParagraphBlock(t)}},n.prototype.getNextStartInline=function(n,t){var f=0,e=n.getInline(t,f),i=e.element,u;return(f=e.index,!sf.base.isNullOrUndefined(i)&&f===i.length&&_instanceof(i.nextNode,r)||_instanceof(i,nt))&&(u=this.getNextValidElement(i.nextNode),_instanceof(u,r)&&0===u.fieldType&&(i=u)),i},n.prototype.getPreviousTextInline=function(n){return _instanceof(n.previousNode,i)?n.previousNode:_instanceof(n.previousNode,r)&&t.isLinkedFieldCharacter(n.previousNode)?0===n.previousNode.fieldType||1===n.previousNode.fieldType?n.previousNode:n.previousNode.fieldBegin:sf.base.isNullOrUndefined(n.previousNode)?void 0:this.getPreviousTextInline(n.previousNode)},n.prototype.getNextTextInline=function(n){return _instanceof(n.nextNode,i)?n.nextNode:_instanceof(n.nextNode,r)&&t.isLinkedFieldCharacter(n.nextNode)?1===n.nextNode.fieldType||0===n.nextNode.fieldType?n.nextNode:n.nextNode.fieldEnd:sf.base.isNullOrUndefined(n.nextNode)?void 0:this.getNextTextInline(n.nextNode)},n.prototype.getContainerTable=function(n){if(n.isInsideTable&&(n=n.associatedCell.ownerTable.isInsideTable?this.getContainerTable(n.associatedCell.ownerTable):n.associatedCell.ownerTable),_instanceof(n,f))return n},n.prototype.isExistBefore=function(n,t){var r,i,u,f;return n.isInsideTable?(r=n.associatedCell,t.isInsideTable)?(i=t.associatedCell,r===i)?r.childWidgets.indexOf(n)<r.childWidgets.indexOf(t):r.ownerRow===i.ownerRow?r.cellIndex<i.cellIndex:r.ownerTable===i.ownerTable?r.ownerRow.rowIndex<i.ownerRow.rowIndex:(u=this.getContainerCellOf(r,i),u.ownerTable.contains(i)?(r=this.getSelectedCell(r,u),i=this.getSelectedCell(i,u),r===u?this.isExistBefore(n,i.ownerTable):i===u?this.isExistBefore(r.ownerTable,t):u.ownerRow===i.ownerRow?u.cellIndex<i.cellIndex:u.ownerTable===i.ownerTable?u.ownerRow.rowIndex<i.ownerRow.rowIndex:this.isExistBefore(r.ownerTable,i.ownerTable)):this.isExistBefore(u.ownerTable,this.getContainerTable(i.ownerTable))):(f=this.getContainerTable(n),this.isExistBefore(f,t)):t.isInsideTable?(f=this.getContainerTable(t),this.isExistBefore(n,f)):n.containerWidget===t.containerWidget?n.index<t.index:(_instanceof(n.containerWidget,c)&&_instanceof(t.containerWidget,c)||_instanceof(n.containerWidget,it)&&_instanceof(t.containerWidget,it))&&this.documentHelper.pages.indexOf(n.containerWidget.page)<this.documentHelper.pages.indexOf(t.containerWidget.page)},n.prototype.isExistAfter=function(n,t){var r,i,u,f;return n.isInsideTable?(r=n.associatedCell,t.isInsideTable)?(i=t.associatedCell,r===i)?r.childWidgets.indexOf(n)>r.childWidgets.indexOf(t):r.ownerRow===i.ownerRow?r.cellIndex>i.cellIndex:r.ownerTable===i.ownerTable?r.ownerRow.rowIndex>i.ownerRow.rowIndex:(u=this.getContainerCellOf(r,i),u.ownerTable.contains(i)?(r=this.getSelectedCell(r,u),i=this.getSelectedCell(i,u),r===u?this.isExistAfter(n,i.ownerTable):i===u?this.isExistAfter(r.ownerTable,t):u.ownerRow===i.ownerRow?u.cellIndex>i.cellIndex:u.ownerTable===i.ownerTable?u.ownerRow.rowIndex>i.ownerRow.rowIndex:this.isExistAfter(r.ownerTable,i.ownerTable)):this.isExistAfter(u.ownerTable,this.getContainerTable(i.ownerTable))):(f=this.getContainerTable(n),this.isExistAfter(f,t)):t.isInsideTable?(f=this.getContainerTable(t),this.isExistAfter(n,f)):n.containerWidget===t.containerWidget?n.index>t.index:(_instanceof(n.containerWidget,c)&&_instanceof(t.containerWidget,c)||_instanceof(n.containerWidget,it)&&_instanceof(t.containerWidget,it))&&this.documentHelper.pages.indexOf(n.containerWidget.page)>this.documentHelper.pages.indexOf(t.containerWidget.page)},n.prototype.isExistBeforeInline=function(n,t){if(n.line===t.line)return n.line.children.indexOf(n)<=t.line.children.indexOf(t);if(n.line.paragraph===t.line.paragraph)return n.line.paragraph.childWidgets.indexOf(n.line)<t.line.paragraph.childWidgets.indexOf(t.line);var i=n.line.paragraph,r=t.line.paragraph;if(i.containerWidget===r.containerWidget){if(i.isInsideTable)return i.associatedCell.childWidgets.indexOf(i)<r.associatedCell.childWidgets.indexOf(r);if(!_instanceof(i.containerWidget,ct))return i.containerWidget.childWidgets.indexOf(i)<r.containerWidget.childWidgets.indexOf(r)}return this.isExistBefore(i,r)},n.prototype.isExistAfterInline=function(n,t,i){var f,r,u;if(n.line===t.line)return f=this.documentHelper.selection,i?n.line.children.indexOf(n)>=t.line.children.indexOf(t):n===t&&f.start.offset!==f.end.offset?n.line.children.indexOf(n)===t.line.children.indexOf(t):n.line.children.indexOf(n)>t.line.children.indexOf(t);if(n.line.paragraph===t.line.paragraph)return n.line.paragraph.childWidgets.indexOf(n.line)>t.line.paragraph.childWidgets.indexOf(t.line);if(r=n.line.paragraph,u=t.line.paragraph,r.containerWidget===u.containerWidget){if(r.isInsideTable)return r.associatedCell.childWidgets.indexOf(r)>u.associatedCell.childWidgets.indexOf(u);if(!_instanceof(r.containerWidget,ct))return r.containerWidget.childWidgets.indexOf(r)>u.containerWidget.childWidgets.indexOf(u)}return this.isExistAfter(r,u)},n.prototype.getNextRenderedBlock=function(n){return sf.base.isNullOrUndefined(n.nextWidget)?n.nextRenderedWidget:n.nextWidget},n.prototype.getPreviousRenderedBlock=function(n){return sf.base.isNullOrUndefined(n.previousWidget)?n.previousRenderedWidget:n.previousWidget},n.prototype.getNextParagraphBlock=function(n){return _instanceof(n.nextRenderedWidget,u)?n.nextRenderedWidget:_instanceof(n.nextRenderedWidget,f)?this.getFirstParagraphInFirstCell(n.nextRenderedWidget):_instanceof(n.containerWidget,s)?this.getNextParagraphCell(n.containerWidget):_instanceof(n.containerWidget,c)?(n.containerWidget,this.getNextParagraph(n.containerWidget)):_instanceof(n.containerWidget,ct)&&this.isMoveDownOrMoveUp?this.getFirstBlockInNextHeaderFooter(n):void 0},n.prototype.getFirstBlockInNextHeaderFooter=function(n){var t,i=n.containerWidget;if(-1!==i.headerFooterType.indexOf("Header"))t=i.page.footerWidget.firstChild;else{if(!i.page.nextPage)return;t=i.page.nextPage.headerWidget.firstChild}return _instanceof(t,u)?t:this.getFirstBlockInFirstCell(t)},n.prototype.getLastBlockInPreviousHeaderFooter=function(n){var t,i=n.containerWidget;if(-1!==i.headerFooterType.indexOf("Footer"))t=i.page.headerWidget.lastChild;else{if(!i.page.previousPage)return;t=i.page.previousPage.footerWidget.lastChild}return _instanceof(t,u)?t:this.getFirstBlockInFirstCell(t)},n.prototype.getPreviousParagraphBlock=function(n){return _instanceof(n.previousRenderedWidget,u)?n.previousRenderedWidget:_instanceof(n.previousRenderedWidget,f)?this.getLastParagraphInLastCell(n.previousRenderedWidget):_instanceof(n.containerWidget,s)?this.getPreviousParagraphCell(n.containerWidget):_instanceof(n.containerWidget,c)?this.getPreviousParagraph(n.containerWidget):_instanceof(n.containerWidget,ct)&&this.isMoveDownOrMoveUp?this.getLastBlockInPreviousHeaderFooter(n):void 0},n.prototype.getFirstParagraphBlock=function(n){return _instanceof(n,u)?n:_instanceof(n,f)?this.getFirstParagraphInFirstCell(n):void 0},n.prototype.getLastParagraphBlock=function(n){return _instanceof(n,u)?n:_instanceof(n,f)?this.getLastParagraphInLastCell(n):void 0},n.prototype.hasValidInline=function(n,u,f){for(var s,e,o=n.childWidgets.indexOf(u.line);o<n.childWidgets.length;o++)for(s=0;s<n.childWidgets[o].children.length;s++)if(e=n.childWidgets[o].children[s],0!==e.length){if(e===f)return!1;if(_instanceof(e,i)||_instanceof(e,v)||_instanceof(e,r)&&t.isLinkedFieldCharacter(e))return!0}return!1},n.prototype.getParagraphLength=function(n,t,i){for(var f,r=0,u=0;u<n.childWidgets.length;u++){if(f=n.childWidgets[u],_instanceof(t,k)&&t===f){i&&(r+=this.getLineLength(f,i));break}r+=this.getLineLength(f)}return r},n.prototype.getLineLength=function(n,t){for(var r,u=0,f=n.paragraph.bidi,i=f?n.children.length-1:0;f?i>-1:i<n.children.length;f?i--:i++)if(r=n.children[i],!_instanceof(r,o)){if(t&&_instanceof(t.element,tt)&&t.element===r){u+=t.index;break}u+=r.length}return u},n.prototype.getLineInfo=function(n,t){for(var r=void 0,u=0,f=n.childWidgets.length,i=0;i<f&&(r=n.childWidgets[i],!(t<=(u=this.getLineLength(r))||i===f-1));i++)t-=u;return{line:r,offset:t}},n.prototype.getElementInfo=function(n,t){for(var i=void 0,r=0;r<n.children.length;r++)if(!_instanceof(i=n.children[r],o)){if(!(t>i.length)||t===i.length+1&&sf.base.isNullOrUndefined(i.nextNode))break;t-=i.length}return{element:i,index:t}},n.prototype.getStartOffset=function(n){if(n.childWidgets.length>0){var t=n.childWidgets[0];return this.getStartLineOffset(t)}return 0},n.prototype.getStartLineOffset=function(n){for(var u,f=0,s=0;s<n.children.length;s++)if(u=n.children[s],0!==u.length){if(_instanceof(u,i)||_instanceof(u,v)||_instanceof(u,e)||_instanceof(u,nt)||_instanceof(u,ht)||_instanceof(u,ot)||_instanceof(u,g)||_instanceof(u,r)&&t.isLinkedFieldCharacter(u)||_instanceof(u,w))return f;_instanceof(u,o)||(f+=u.length)}return f},n.prototype.getPreviousSelectionCell=function(n){var i,t;return sf.base.isNullOrUndefined(n.previousRenderedWidget)?this.getPreviousSelectionRow(n.ownerRow):this.isForward?(i=n.previousRenderedWidget.childWidgets,_instanceof(t=i[i.length-1],u)?t:this.getPreviousParagraphSelection(t.childWidgets[t.childWidgets.length-1])):_instanceof(t=n.previousRenderedWidget.childWidgets[0],u)?t:this.getFirstParagraphInLastRow(t)},n.prototype.getPreviousSelectionRow=function(n){if(!sf.base.isNullOrUndefined(n.previousRenderedWidget)){if(this.isForward)return this.getPreviousParagraphSelection(n.previousRenderedWidget);var t=n.previousRenderedWidget.childWidgets[0].childWidgets[0];return this.getFirstParagraphBlock(t)}return this.getPreviousSelectionBlock(n.ownerTable)},n.prototype.getNextSelectionBlock=function(n){return _instanceof(n.nextRenderedWidget,u)?n.nextRenderedWidget:_instanceof(n.nextRenderedWidget,f)?this.isEmpty||this.isForward?this.getLastParagraphInFirstRow(n.nextRenderedWidget):this.getNextParagraphSelection(n.nextRenderedWidget.childWidgets[0]):_instanceof(n.containerWidget,s)?this.getNextSelectionCell(n.containerWidget):_instanceof(n.containerWidget,c)?this.getNextSelection(n.containerWidget):void 0},n.prototype.getNextSelectionCell=function(n){if(!sf.base.isNullOrUndefined(n.nextRenderedWidget)){if(this.isEmpty||this.isForward){var t=n.nextRenderedWidget.childWidgets[n.nextRenderedWidget.childWidgets.length-1];return this.getLastParagraphBlock(t)}return _instanceof(t=n.nextRenderedWidget.childWidgets[0],u)?t:this.getNextParagraphSelection(t.childWidgets[0])}return this.getNextSelectionRow(n.ownerRow)},n.prototype.getNextSelectionRow=function(n){if(!sf.base.isNullOrUndefined(n.nextRenderedWidget)){if(this.isEmpty||this.isForward){var t=n.nextRenderedWidget.childWidgets[n.nextRenderedWidget.childWidgets.length-1],i=t.childWidgets[t.childWidgets.length-1];return this.getLastParagraphBlock(i)}return this.getNextParagraphSelection(n.nextRenderedWidget)}return this.getNextSelectionBlock(n.ownerTable)},n.prototype.getNextSelection=function(n){if(_instanceof(n.nextRenderedWidget,c)){var t=n.nextRenderedWidget.childWidgets[0];return _instanceof(t,u)?t:this.isEmpty||this.isForward?this.getLastParagraphInFirstRow(t):this.getNextParagraphSelection(t.childWidgets[0])}},n.prototype.getNextParagraphSelection=function(n){var t=n.childWidgets[0],i,r;return this.start.paragraph.isInsideTable&&n.ownerTable.contains(this.start.paragraph.associatedCell)&&(i=this.getCellInTable(n.ownerTable,this.start.paragraph.associatedCell),t=this.getFirstCellInRegion(n,i,this.upDownSelectionLength,!1)),r=t.childWidgets[0],this.getFirstParagraphBlock(r)},n.prototype.getPreviousSelectionBlock=function(n){return _instanceof(n.previousRenderedWidget,u)?n.previousRenderedWidget:_instanceof(n.previousRenderedWidget,f)?this.isForward?this.getPreviousParagraphSelection(n.previousRenderedWidget.childWidgets[n.previousRenderedWidget.childWidgets.length-1]):this.getFirstParagraphInLastRow(n.previousRenderedWidget):_instanceof(n.containerWidget,s)?this.getPreviousSelectionCell(n.containerWidget):_instanceof(n.containerWidget,c)?this.getPreviousSelection(n.containerWidget):void 0},n.prototype.getPreviousSelection=function(n){var i,t,r;if(_instanceof(n.previousRenderedWidget,c))return(i=n.previousRenderedWidget,t=i.childWidgets[i.childWidgets.length-1],_instanceof(t,u))?t:this.isForward?(r=t,this.getPreviousParagraphSelection(r.childWidgets[r.childWidgets.length-1])):this.getFirstParagraphInLastRow(t)},n.prototype.getPreviousParagraphSelection=function(n){var t=n.childWidgets[n.childWidgets.length-1],i,r;return this.start.paragraph.isInsideTable&&n.ownerTable.contains(this.start.paragraph.associatedCell)&&(i=this.getCellInTable(n.ownerTable,this.start.paragraph.associatedCell),t=this.getLastCellInRegion(n,i,this.upDownSelectionLength,!0)),r=t.childWidgets[t.childWidgets.length-1],this.getLastParagraphBlock(r)},n.prototype.getLastCellInRegion=function(n,i,r,u){var o=this.getCellLeft(n,i),h=o+i.cellFormat.cellWidth,s=!0,f,e;if(o<=r&&r<h){for(f=n.childWidgets.length-1;f>=0;f--)if(e=this.getCellLeft(n,n.childWidgets[f]),t.round(o,2)<=t.round(e,2)&&t.round(e,2)<t.round(h,2))return s=!1,n.childWidgets[f]}else for(f=n.childWidgets.length-1;f>=0;f--)if((e=this.getCellLeft(n,n.childWidgets[f]))<=r&&e+n.childWidgets[f].cellFormat.cellWidth>r)return s=!1,n.childWidgets[f];if(s){if(!sf.base.isNullOrUndefined(n.previousRenderedWidget)&&u)return this.getLastCellInRegion(n.previousRenderedWidget,i,r,u);if(!sf.base.isNullOrUndefined(n.nextRenderedWidget)&&!u)return this.getLastCellInRegion(n.nextRenderedWidget,i,r,u)}return n.childWidgets[n.childWidgets.length-1]},n.prototype.getCellInTable=function(n,t){for(;t.ownerTable.isInsideTable;){if(n.equals(t.ownerTable))return t;t=t.ownerTable.associatedCell}return t},n.prototype.getFirstParagraphInLastRow=function(n){if(n.childWidgets.length>0){var t=n.childWidgets[n.childWidgets.length-1].childWidgets[0].childWidgets[0];return this.getFirstParagraphBlock(t)}},n.prototype.getPreviousValidOffset=function(n,u){var h,c,f;if(0===u)return 0;for(var l=0,s=0,y=0,p=n.paragraphFormat.bidi,a=0;a<n.childWidgets.length;a++)if(h=n.childWidgets[a],p){if((y=h.getInlineForOffset(u,!1,void 0,!1,!0,!1).index)>=0)return y}else for(c=0;c<h.children.length;c++)if(f=h.children[c],!(0===f.length||_instanceof(f,o))){if(u<=s+f.length)return u-1===s?l:u-1;(_instanceof(f,i)||_instanceof(f,v)||_instanceof(f,e)||_instanceof(f,r)&&t.isLinkedFieldCharacter(f))&&(l=s+f.length);s+=f.length}return u-1===s?l:u-1},n.prototype.getNextValidOffset=function(n,u){var e=0,s,f;if(n.paragraph.paragraphFormat.bidi)u!==this.getLineLength(n)&&(u=n.getInlineForOffset(u,!1,void 0,!1,!1,!0).index);else for(s=0;s<n.children.length;s++)if(f=n.children[s],!(0===f.length||_instanceof(f,o))){if(u<e+f.length&&(_instanceof(f,i)||_instanceof(f,v)||_instanceof(f,r)&&t.isLinkedFieldCharacter(f)))return(u>e?u:e)+1;if(u===e+f.length&&_instanceof(f,r)&&1===f.fieldType&&_instanceof(f.previousNode,v))return u;e+=f.length}return u},n.prototype.getParagraphMarkSize=function(n,t,i){var r=this.documentHelper.textHelper.getParagraphMarkSize(n.characterFormat),o=r.BaselineOffset,e=r.Height,h=o,f,c,s;return _instanceof(n,u)&&(n.childWidgets.length>0&&n.childWidgets[0],f=this.documentHelper.layout.getLineSpacing(n,e),c=this.documentHelper.layout.getBeforeSpacing(n),t=h-o,i=e-h-(r.Height-o),s=n.paragraphFormat.lineSpacingType,"Multiple"===s?f>e?i+=f-e:t+=f-e:("Exactly"===s||f>t+r.Height+i)&&(t+=f-(t+r.Height+i)),t+=c,i+=this.documentHelper.layout.getAfterSpacing(n)),{width:r.Width,height:r.Height,topMargin:t,bottomMargin:i}},n.prototype.getPhysicalPositionInternal=function(n,t,i){var r,u,e,o;if(n.paragraph.isEmpty())return r=n.paragraph,u=r.x,r.childWidgets.length>0&&(e=r.childWidgets[0],u=this.getLeft(e)),o=this.getParagraphMarkSize(n.paragraph,0,0),t>0&&(u+=o.width),new d(u,r.y+0);var f=0,s=n.getInline(t,f,n.paragraph.bidi),h=s.element;return f=s.index,this.getPhysicalPositionInline(h,f,i)},n.prototype.highlightSelectedContent=function(n,t){var i,f,s,h,c,o,l,y;if(!n.paragraph.isInsideTable||t.paragraph.isInsideTable&&n.paragraph.associatedCell.equals(t.paragraph.associatedCell)&&!this.isCellSelected(n.paragraph.associatedCell,n,t)){if(i=void 0,f=0,!this.owner.isReadOnlyMode&&n.paragraph===t.paragraph)if(n.offset+1===t.offset)s=t.currentWidget.getInline(t.offset,f),(i=s.element,f=s.index,_instanceof(i,v)||_instanceof(i,nt))&&n.currentWidget.getOffset(i,0)!==n.offset&&(i=void 0);else{var e=0,a=n.currentWidget.getInline(n.offset,e),u=a.element;(e=a.index)===u.length&&(u=this.getNextRenderedElementBox(u,e));h=t.currentWidget.getInline(t.offset,e);c=h.element;(e=h.index,_instanceof(u,r)&&_instanceof(c,r)&&!sf.base.isNullOrUndefined(u.fieldSeparator))&&(o=u.fieldSeparator.nextNode,_instanceof(o,v)&&o.nextNode===c&&(i=o))}!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&(_instanceof(i,v)||_instanceof(i,nt))?(l=this.getElementBoxInternal(i,f),y=l.element,f=l.index,this.owner.enableImageResizerMode&&(this.owner.imageResizerModule.positionImageResizer(y),this.owner.imageResizerModule.showImageResizer()),this.documentHelper.isTouchInput&&(this.documentHelper.touchStart.style.display="none",this.documentHelper.touchEnd.style.display="none")):(this.highlight(n.paragraph,n,t),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,n,t),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0));this.isInShape&&this.showResizerForShape()}else this.highlightCell(n.paragraph.associatedCell,this,n,t)},n.prototype.showResizerForShape=function(){var n=this.getCurrentTextFrame().containerShape;this.owner.imageResizerModule.positionImageResizer(n);this.owner.imageResizerModule.showImageResizer()},n.prototype.highlight=function(n,t,r){var d=0,w=0,a=void 0,c=void 0,u=void 0,tt=void 0,rt=this.getStartLineWidget(n,t,a,d),it,h,f,b,ut,g,p,e,v,nt,k,l;if(a=rt.element,u=sf.base.isNullOrUndefined(a)?n.childWidgets[0]:a.line,d=rt.index,it=this.getEndLineWidget(r,c,w),tt=(c=it.element)?c.line:r.paragraph.childWidgets[r.paragraph.childWidgets.length-1],w=it.index,h=0,f=0,sf.base.isNullOrUndefined(u)||(h=this.getTop(u),f=this.getLeftInternal(u,a,d)),sf.base.isNullOrUndefined(u)||u!==tt){if(!sf.base.isNullOrUndefined(u)){if(u.paragraph.x,n!==u.paragraph&&(n=u.paragraph),s=this.getWidth(u,!0)-(f-u.paragraph.x),n.bidi||_instanceof(a,i)&&a.isRightToLeft)if(o=0,b=this.getElementsForward(u,a,c,n.bidi),b){for(v=!1,p=0;p<b.length;p++)v=!1,f=(e=b[p])===a?this.getLeftInternal(u,e,d):this.getLeftInternal(u,e,0),nt=_instanceof(e,i)?e.length:1,o=this.getLeftInternal(u,e,nt),_instanceof(e,i)&&(v=e.isRightToLeft),s=Math.abs(o-f),this.createHighlightBorder(u,s,v?o:f,h,!0);u.isLastLine()&&(k=b[b.length-1].line.paragraph.characterFormat,l=this.documentHelper.textHelper.getParagraphMarkSize(k).Width,f=n.bidi?this.getLineStartLeft(u)-l:v?u.paragraph.x+this.getWidth(u,!1):o,this.createHighlightBorder(u,l,f,h,!0))}else this.createHighlightBorder(u,s,f,h,!1);else this.createHighlightBorder(u,s,f,h,!1);if(ut=u.paragraph.childWidgets.indexOf(u),this.highlightParagraph(n,ut+1,tt,c,w),-1!==n.childWidgets.indexOf(r.currentWidget))return}if(this.isHideSelection(n))return void(this.isHighlightNext=!1);this.isHighlightNext=!0;this.hightLightNextParagraph=n}else{var o=this.getLeftInternal(tt,c,w),s=0,y=!1;if(_instanceof(c,i)&&(y=c.isRightToLeft),!y&&_instanceof(a,i)&&(y=a.isRightToLeft),s=Math.abs(o-f),y||n.bidi)if(g=this.getElementsForward(u,a,c,n.bidi),g&&g.length>1)for(p=0;p<g.length;p++){if(v=!1,nt=_instanceof(e=g[p],i)?e.length:1,(e===a?(f=this.getLeftInternal(u,e,d),o=this.getLeftInternal(u,e,nt)):e===c?(f=this.getLeftInternal(u,e,0),o=this.getLeftInternal(u,e,w)):(f=this.getLeftInternal(u,e,0),o=this.getLeftInternal(u,e,nt)),_instanceof(e,i)&&(v=e.isRightToLeft),s=Math.abs(o-f),e===c&&_instanceof(e,i)&&w>e.length)&&(k=e.line.paragraph.characterFormat,l=this.documentHelper.textHelper.getParagraphMarkSize(k).Width,n.bidi&&!v)){s-=l;this.createHighlightBorder(u,s,f,h,!0);f=this.getLineStartLeft(u)-l;this.createHighlightBorder(u,l,f,h,!0);continue}this.createHighlightBorder(u,s,v?o:f,h,!0)}else _instanceof(c,i)&&w>c.length?(k=c.line.paragraph.characterFormat,l=this.documentHelper.textHelper.getParagraphMarkSize(k).Width,!n.bidi&&y?(o+=l,s-=l,this.createHighlightBorder(u,s,o,h,!0),o+=c.width,this.createHighlightBorder(u,l,o,h,!0)):n.bidi&&!y?(s-=l,this.createHighlightBorder(u,s,f,h,!0),f=this.getLineStartLeft(u)-l,this.createHighlightBorder(u,l,f,h,!0)):this.createHighlightBorder(u,s,y?o:f,h,!1)):this.createHighlightBorder(u,s,y?o:f,h,!1);else this.createHighlightBorder(u,s,n.bidi?o:f,h,!1)}},n.prototype.highlightNextBlock=function(n,t,i){var r=n.nextRenderedWidget;sf.base.isNullOrUndefined(r)||(_instanceof(r,u)?(this.isHighlightNext=!1,this.highlight(r,t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)):this.highlightTable(r,t,i))},n.prototype.getStartLineWidget=function(n,t,i,u){var f=n===t.paragraph?t.offset:this.getStartOffset(n),o=void 0,e;return(i=(o=n===t.paragraph?t.currentWidget.getInline(f,u):n.firstChild.getInline(f,u)).element,u=o.index,_instanceof(i,r))&&(e=this.getRenderedInline(i,u),i=e.element,u=e.index),f===this.getParagraphLength(t.paragraph)+1&&u++,{index:u,element:i}},n.prototype.getEndLineWidget=function(n,t,i){var f=n.currentWidget.getInline(n.offset,i),u;return(t=f.element,i=f.index,_instanceof(t,r))&&(u=this.getRenderedInline(t,i),t=u.element,i=u.index),n.paragraph.childWidgets.indexOf(n.currentWidget)===n.paragraph.childWidgets.length-1&&n.offset===this.getLineLength(n.currentWidget)+1&&(i=t?t.length+1:1),{index:i,element:t}},n.prototype.getLineWidgetInternal=function(n,t,i){var r=void 0;if(0===n.children.length&&_instanceof(n,k))r=n;else{var u=0,e=n.getInline(t,u),f=e.element;u=e.index;r=_instanceof(f,tt)?f.line:this.getLineWidgetInternalInline(f,u,i)}return r},n.prototype.getLineWidgetParagraph=function(n,t){var i=void 0;if(0===t.children.length)i=t;else{var r=0,u=t.getInline(n,r),f=u.element;r=u.index;i=this.getLineWidget(f,r)}return i},n.prototype.highlightCells=function(n,t,i){var u=this.getCellLeft(t.ownerRow,t),f=u+t.cellFormat.cellWidth,o=this.getCellLeft(i.ownerRow,i),v=o+i.cellFormat.cellWidth,y,r,l,a,e;u>o&&(u=o);f<v&&(f=v);u>this.upDownSelectionLength&&(u=this.upDownSelectionLength);f<this.upDownSelectionLength&&(f=this.upDownSelectionLength);var s=n.getSplitWidgets(),h=s.indexOf(t.ownerRow.ownerTable),c=s.indexOf(i.ownerRow.ownerTable);if(h===c)for(y=n.childWidgets.indexOf(i.ownerRow),r=n.childWidgets.indexOf(t.ownerRow);r<=y;r++)this.highlightRow(n.childWidgets[r],u,f);else for(l=0,a=0,r=h;r<=c;r++)for(n=s[r],l=r===h?n.childWidgets.indexOf(t.ownerRow):0,a=r===c?n.childWidgets.indexOf(i.ownerRow):n.childWidgets.length-1,e=l;e<=a;e++)this.highlightRow(n.childWidgets[e],u,f)},n.prototype.highlightTable=function(n,t,i){this.highlightInternal(n.childWidgets[0],t,i);i.paragraph.isInsideTable&&n.contains(i.paragraph.associatedCell)||this.highlightNextBlock(n,t,i)},n.prototype.getCellLeft=function(n,t){return 0+(t.x-t.margin.left)},n.prototype.getNextParagraphRow=function(n){if(!sf.base.isNullOrUndefined(n.nextRenderedWidget)){var t=n.nextRenderedWidget.childWidgets[0].childWidgets[0];return this.getFirstParagraphBlock(t)}return this.getNextParagraphBlock(n.ownerTable)},n.prototype.getPreviousParagraphRow=function(n){if(!sf.base.isNullOrUndefined(n.previousRenderedWidget)){var t=n.previousRenderedWidget.lastChild,i=t.lastChild?t.lastChild:t.previousSplitWidget.lastChild;return this.getLastParagraphBlock(i)}return this.getPreviousParagraphBlock(n.ownerTable)},n.prototype.containsRow=function(n,t){if(-1!==n.childWidgets.indexOf(t))return!0;for(;t.ownerTable.isInsideTable;){if(-1!==n.childWidgets.indexOf(t))return!0;t=t.ownerTable.associatedCell}return-1!==n.childWidgets.indexOf(t)},n.prototype.highlightRow=function(n,i,r){for(var f,u=0;u<n.childWidgets.length;u++)f=this.getCellLeft(n,n.childWidgets[u]),t.round(i,2)<=t.round(f,2)&&t.round(f,2)<t.round(r,2)&&this.highlightCellWidget(n.childWidgets[u])},n.prototype.highlightInternal=function(n,t,i){for(var r=0;r<n.childWidgets.length;r++)this.highlightCellWidget(n.childWidgets[r]);i.paragraph.isInsideTable&&this.containsRow(n,i.paragraph.associatedCell)||_instanceof(n.nextRenderedWidget,a)&&this.highlightInternal(n.nextRenderedWidget,t,i)},n.prototype.getLastParagraph=function(n){for(;n.nextSplitWidget&&n.nextSplitWidget.childWidgets.length>0;)n=n.nextSplitWidget;var t;return t=n.childWidgets.length>0?n.lastChild:n.previousSplitWidget.lastChild,this.getLastParagraphBlock(t)},n.prototype.containsCell=function(n,t){if(n.equals(t))return!0;for(;t.ownerTable.isInsideTable;){if(n.equals(t.ownerTable.associatedCell))return!0;t=t.ownerTable.associatedCell}return!1},n.prototype.isCellSelected=function(n,t,i){var r=this.getLastParagraph(n);return r===i.paragraph&&i.offset===this.getParagraphLength(r)+1||!this.containsCell(n,t.paragraph.associatedCell)||!this.containsCell(n,i.paragraph.associatedCell)},n.prototype.getContainerCellOf=function(n,t){for(;n.ownerTable.isInsideTable;){if(n.ownerTable.contains(t))return n;n=n.ownerTable.associatedCell}return n},n.prototype.getSelectedCell=function(n,t){if(n.ownerTable.equals(t.ownerTable))return n;for(;n.ownerTable.isInsideTable;){if(n.ownerTable.associatedCell.equals(t))return n;n=n.ownerTable.associatedCell}return n},n.prototype.getSelectedCells=function(){for(var i,t=[],n=0;n<this.selectedWidgets.keys.length;n++)i=this.selectedWidgets.keys[n],_instanceof(i,s)&&t.push(i);return t},n.prototype.getNextParagraphCell=function(n){if(n.nextRenderedWidget&&_instanceof(n.nextRenderedWidget,s)){var t=(n=n.nextRenderedWidget).firstChild;return t?this.getFirstParagraphBlock(t):this.getNextParagraphCell(n)}return this.getNextParagraphRow(n.containerWidget)},n.prototype.getPreviousParagraphCell=function(n){if(!sf.base.isNullOrUndefined(n.previousRenderedWidget)&&_instanceof(n.previousRenderedWidget,s)){var t=(n=n.previousRenderedWidget).lastChild;return this.getLastParagraphBlock(t)}return this.getPreviousParagraphRow(n.ownerRow)},n.prototype.getContainerCell=function(n){for(;!sf.base.isNullOrUndefined(n.ownerTable)&&n.ownerTable.isInsideTable;)n=n.ownerTable.associatedCell;return n},n.prototype.highlightCell=function(n,t,i,r){var u,f,e,o;if(r.paragraph.isInsideTable)if(u=this.getContainerCellOf(n,r.paragraph.associatedCell),u.ownerTable.contains(r.paragraph.associatedCell))if(f=this.getSelectedCell(n,u),e=this.getSelectedCell(r.paragraph.associatedCell,u),this.containsCell(u,r.paragraph.associatedCell))this.isCellSelected(u,i,r)?this.highlightCellWidget(u):f===u?(this.highlight(i.paragraph,i,r),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,i,r),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)):this.highlightContainer(f,i,r);else if(this.highlightCellWidget(u),u.ownerRow.equals(e.ownerRow))for(f=u;!sf.base.isNullOrUndefined(f.nextRenderedWidget)&&(f=f.nextRenderedWidget,this.highlightCellWidget(f),f!==e););else this.highlightCells(u.ownerTable,u,e);else this.highlightContainer(u,i,r);else o=this.getContainerCell(n),this.highlightContainer(o,i,r)},n.prototype.highlightContainer=function(n,t,i){this.highlightInternal(n.containerWidget,t,i);this.highlightNextBlock(n.ownerTable,t,i)},n.prototype.getPreviousValidElement=function(n){var i=void 0;if(this.documentHelper.isFormFillProtectedMode&&2===n.fieldType)return n;for(;_instanceof(n,r);)t.isLinkedFieldCharacter(n)&&(_instanceof(n,r)&&0===n.fieldType?i=n:_instanceof(n,r)&&1===n.fieldType?(i=n,sf.base.isNullOrUndefined(n.fieldSeparator)&&(i=n=n.fieldBegin)):i=n=n.fieldBegin),n=n.previousNode;return sf.base.isNullOrUndefined(i)?n:i},n.prototype.getNextValidElement=function(n){var t=void 0;if(_instanceof(n,e)&&1===n.bookmarkType)return n;for(;_instanceof(n,r);){if(0===n.fieldType&&!sf.base.isNullOrUndefined(n.fieldEnd))return sf.base.isNullOrUndefined(t)?n:t;1!==n.fieldType||sf.base.isNullOrUndefined(n.fieldBegin)||(t=n);n=n.nextNode}return sf.base.isNullOrUndefined(t)?n:t},n.prototype.validateTextPosition=function(n,t){if(n.length===t&&(_instanceof(n.nextNode,r)||!_instanceof(n,v)&&_instanceof(n.nextNode,e))){var i=this.getNextValidElement(n.nextNode);(_instanceof(i,r)&&1===i.fieldType||_instanceof(i,e)&&1===i.bookmarkType)&&(n=i,t=this.documentHelper.isFormFillProtectedMode?0:1)}else 0===t&&_instanceof(n.previousNode,r)&&(t=_instanceof(n=this.getPreviousValidElement(n.previousNode),r)?0:n.length,_instanceof(n,r)&&1===n.fieldType&&t++);return{element:n,index:t}},n.prototype.getPhysicalPositionInline=function(n,t,u){var f=void 0,o,p,c,s,h,l,a,y;if(f=this.getElementBox(n,t,u).element,o=void 0,sf.base.isNullOrUndefined(f)||sf.base.isNullOrUndefined(f.line)){if(!(_instanceof(n,r)&&1===n.fieldType))return _instanceof(n,r)||_instanceof(n,e)?this.getFieldCharacterPosition(n):new d(0,0);f=n}return c=f.margin,s=0,(_instanceof(f,i)&&"\v"===f.text&&sf.base.isNullOrUndefined(n.nextNode)?(o=this.getNextLineWidget(f.line.paragraph,f),t=0):o=f.line,s=this.getTop(o),_instanceof(f,v)&&"Inline"===f.textWrappingStyle)?(h=f.line.paragraph.characterFormat,l=this.getPreviousTextElement(n),sf.base.isNullOrUndefined(l)?(a=this.getNextTextElement(n),sf.base.isNullOrUndefined(a)||(h=a.characterFormat)):h=l.characterFormat,y=this.documentHelper.textHelper.getHeight(h),f.margin.top+f.height-y.BaselineOffset>0&&(s+=f.margin.top+f.height-y.BaselineOffset)):_instanceof(f,r)||(s+=c.top>0?c.top:0),p=sf.base.isNullOrUndefined(f)||sf.base.isNullOrUndefined(o)?0:this.getLeftInternal(o,f,t),new d(p,s)},n.prototype.getFieldCharacterPosition=function(n){var t=this.getNextValidElementForField(n),i;return sf.base.isNullOrUndefined(t)?(i=n.line.paragraph,this.getEndPosition(i)):this.getPhysicalPositionInline(t,0,!0)},n.prototype.getNextValidElementForField=function(n){var i,u;return _instanceof(n,r)&&0===n.fieldType&&t.isLinkedFieldCharacter(n)&&(i=n,n=sf.base.isNullOrUndefined(i.fieldSeparator)?i.fieldEnd:i.fieldSeparator),u=void 0,sf.base.isNullOrUndefined(n.nextNode)||(u=this.getNextValidElement(n.nextNode)),u},n.prototype.getEndPosition=function(n){var i=n.x,r=n.y,t=void 0,u;return n.childWidgets.length>0&&(t=n.childWidgets[n.childWidgets.length-1],i+=this.getWidth(t,!1)),sf.base.isNullOrUndefined(t)||(r=this.getTop(t)),u=this.getParagraphMarkSize(n,0,0),new d(i,r+u.topMargin)},n.prototype.getElementBox=function(n,t){var i=void 0;return _instanceof(n,r)||_instanceof(n,e)||_instanceof(n,g)||(i=n),{element:i,index:t}},n.prototype.getPreviousTextElement=function(n){return _instanceof(n.previousNode,i)?n.previousNode:sf.base.isNullOrUndefined(n.previousNode)?void 0:this.getPreviousTextElement(n.previousNode)},n.prototype.getNextTextElement=function(n){return _instanceof(n.nextNode,i)?n.nextNode:sf.base.isNullOrUndefined(n.nextNode)?void 0:this.getNextTextElement(n.nextNode)},n.prototype.getNextRenderedElementBox=function(n,t){var u,i;if(_instanceof(n,r)){if(0===(i=n).fieldType&&i===(n=this.getRenderedField(i)))return i;t=1}for(;!sf.base.isNullOrUndefined(n)&&t===n.length&&_instanceof(n.nextNode,r);)if(u=this.getNextValidElement(n.nextNode),_instanceof(u,r)&&0===u.fieldType){if(i=u,n=this.getRenderedField(i),!sf.base.isNullOrUndefined(n)&&i===n)return i;t=1}else n=u;return n},n.prototype.getElementBoxInternal=function(n,t){return{element:n,index:t}},n.prototype.getLineWidget=function(n,t){return this.getLineWidgetInternalInline(n,t,!0)},n.prototype.getLineWidgetInternalInline=function(n,t,r){var h=this.getElementBox(n,t,r),u=h.element,e,o,s,f;return(t=h.index,!sf.base.isNullOrUndefined(u))?r&&_instanceof(u,i)&&"\v"===u.text&&1===t?this.getNextLineWidget(u.line.paragraph,u):u.line:(e=n,o=this.getNextValidElementForField(e),sf.base.isNullOrUndefined(o))?(s=void 0,f=e.line.paragraph,f.childWidgets.length>0&&(s=f.childWidgets[f.childWidgets.length-1]),s):this.getLineWidget(o,0)},n.prototype.getNextLineWidget=function(n,t){var u=void 0,i=n,r;return i.childWidgets.length>0&&(r=i.childWidgets.indexOf(t.line),r===i.childWidgets.length-1?(i=n,r=-1):r>i.childWidgets.length-1?(i=this.getNextParagraphBlock(n),r=-1):r<0&&(r=(i=n).childWidgets.indexOf(t.line)),u=i.childWidgets[r+1]),u},n.prototype.getCaretHeight=function(n,t,i,u,f,e){var o=this.getElementBox(n,t,!1).element,k=n,h,c,b,l,a;if(sf.base.isNullOrUndefined(o))return _instanceof(k,r)?this.getFieldCharacterHeight(k,i,u,f,e):{height:this.documentHelper.textHelper.getHeight(i).Height,topMargin:f,isItalic:e};var y=o.margin,d=o.height,s=0;if(_instanceof(o,v))if(h=this.getPreviousTextElement(n),c=this.getNextTextElement(n),sf.base.isNullOrUndefined(h)&&sf.base.isNullOrUndefined(c)){var g=0,nt=0,p=n.line.paragraph,w=this.getParagraphMarkSize(p,g,nt);g=w.topMargin;nt=w.bottomMargin;s=w.height;e=p.characterFormat.italic;u||(s+=this.documentHelper.layout.getAfterSpacing(p))}else{if(sf.base.isNullOrUndefined(h))return e=c.characterFormat.italic,this.getCaretHeight(c,0,c.characterFormat,u,f,e);if(sf.base.isNullOrUndefined(c)||!_instanceof(o,v))return e=h.characterFormat.italic,this.getCaretHeight(h,h.length,h.characterFormat,u,f,e);var tt=this.documentHelper.textHelper.getHeight(o.characterFormat),it=tt.Height,rt=tt.BaselineOffset;s=o.margin.top<0&&rt>o.margin.top+o.height?o.margin.top+o.height+it-rt:it;u||(s+=o.margin.bottom)}else b=i.baselineAlignment,l=d,"Normal"!==b&&u&&(l/=1.5,"Subscript"===b&&(f=d-l)),s=(y.top<0?y.top:0)+l,u||(s+=y.bottom);return u?(a=this.documentHelper.textHelper.getHeight(i).Height,a>s&&(a=s),{height:a,topMargin:f,isItalic:e}):{height:s,topMargin:f,isItalic:e}},n.prototype.getFieldCharacterHeight=function(n,t,i,r,u){var h=this.getNextValidElementForField(n);if(sf.base.isNullOrUndefined(h)){var l=n.line.paragraph,f=this.documentHelper.textHelper.getParagraphMarkSize(t).Height,c=0,e=0,o=this.getParagraphMarkSize(l,c,e),s=o.height;return c=o.topMargin,e=o.bottomMargin,i?(f>s&&(f=s),{height:f,topMargin:r,isItalic:u}):{height:s+=e,topMargin:r,isItalic:u}}return this.getCaretHeight(h,0,t,i,r,u)},n.prototype.getRenderedInline=function(n,i){for(var u,f=this.getPreviousValidElement(n);_instanceof(f,r);)_instanceof(f=this.getPreviousTextElement(f),r)&&(f=f.previousNode);if(!sf.base.isNullOrUndefined(f))return{element:f,index:i=f.length};if(i=0,u=this.getNextRenderedElementBox(n,0),_instanceof(u,r)&&0===u.fieldType)for(u=(u=u.fieldSeparator).nextNode;_instanceof(u,r);)_instanceof(u,r)&&0===u.fieldType&&t.isLinkedFieldCharacter(u)&&(u=sf.base.isNullOrUndefined(u.fieldSeparator)?u.fieldEnd:u.fieldSeparator),u=u.nextNode;return{element:u,index:i}},n.prototype.getRenderedField=function(n){var t=n,i;if(sf.base.isNullOrUndefined(n.fieldSeparator))t=n.fieldEnd;else{if(i=(t=n.fieldSeparator).line.paragraph,i!==n.fieldEnd.line.paragraph||this.hasValidInline(i,t,n.fieldEnd))return t;t=n.fieldEnd}return t},n.prototype.isLastRenderedInline=function(n,t){for(var u,i,f;t===n.length&&_instanceof(n.nextNode,r);)if(u=this.getNextValidElement(n.nextNode),t=0,_instanceof(u,r)&&0===u.fieldType&&(n=u),_instanceof(n,r)&&0===n.fieldType&&!sf.base.isNullOrUndefined(n.fieldEnd))if(i=n,sf.base.isNullOrUndefined(i.fieldSeparator))n=i.fieldEnd,t=1;else{if(f=(n=i.fieldSeparator).line.paragraph,t=1,f!==i.fieldEnd.line.paragraph||this.hasValidInline(f,n,i.fieldEnd))break;n=i.fieldEnd}return t===n.length&&sf.base.isNullOrUndefined(n.nextNode)},n.prototype.getPage=function(n){var t=void 0,i;return _instanceof(n.containerWidget,et)?(i=n.containerWidget.containerShape,i.line&&(t=this.getPage(i.line.paragraph))):_instanceof(n.containerWidget,ri)?(n.containerWidget,t=n.containerWidget.page):sf.base.isNullOrUndefined(n.containerWidget)||(t=this.getPage(n.containerWidget)),t},n.prototype.clearSelectionHighlightInSelectedWidgets=function(){for(var t=!1,i=this.selectedWidgets.keys,n=0;n<i.length;n++)this.removeSelectionHighlight(i[n]),t=!0;return this.selectedWidgets.clear(),t},n.prototype.clearChildSelectionHighlight=function(n){for(var t=0;t<n.childWidgets.length;t++)_instanceof(n.childWidgets[t],k)?this.clearSelectionHighlightLineWidget(n.childWidgets[t]):_instanceof(n.childWidgets[t],s)?this.clearSelectionHighlight(n.childWidgets[t]):_instanceof(n.childWidgets[t],gt)&&this.clearChildSelectionHighlight(n.childWidgets[t])},n.prototype.getLineWidgetBodyWidget=function(n,t){var a=n,s,r,y,h,c,e,v,l,o,i;if(_instanceof(a,ri))for(s=0;s<a.floatingElements.length;s++)if(r=a.floatingElements[s],_instanceof(r,f)&&(y=r.getTableCellWidth(),t.x<=r.x+y&&t.x>=r.x&&t.y<=r.y+r.height&&t.y>=r.y))return this.getLineWidgetTableWidget(r,t);for(h=0;h<n.childWidgets.length;h++)if(_instanceof(i=n.childWidgets[h],it)){for(c=0;c<i.childWidgets.length;c++)if(e=i.childWidgets[c],_instanceof(e,gt)&&e.y<=t.y&&e.y+e.height>=t.y)return _instanceof(e,u)?this.getLineWidgetParaWidget(e,t):this.getLineWidgetTableWidget(e,t)}else if(_instanceof(i,gt)&&i.y<=t.y&&i.y+i.height>=t.y){if(_instanceof(i,u))return this.getLineWidgetParaWidget(i,t);if(v=i,v.wrapTextAround)continue;return this.getLineWidgetTableWidget(v,t)}return l=void 0,n.childWidgets.length>0&&(o=n.childWidgets[0],_instanceof(o,gt)&&o.y<=t.y?l=_instanceof(n.childWidgets[n.childWidgets.length-1],u)?this.getLineWidgetParaWidget(n.childWidgets[n.childWidgets.length-1],t):this.getLineWidgetTableWidget(n.childWidgets[n.childWidgets.length-1],t):(i=void 0,_instanceof(o,gt)&&(i=o),sf.base.isNullOrUndefined(i)||(l=_instanceof(i,u)?this.getLineWidgetParaWidget(o,t):this.getLineWidgetTableWidget(o,t)))),l},n.prototype.getLineWidgetParaWidget=function(n,t){for(var i,e,o,r=n.childWidgets,u=n.y,f=0;f<r.length;f++){if(i=r[f],u+=i.marginTop,e=i.height,i.nextLine&&i.nextLine.marginTop>0&&(e+=i.nextLine.marginTop),u<=t.y&&u+e>=t.y)return i;u+=i.height}return o=void 0,r.length>0&&(o=n.y<=t.y?r[r.length-1]:r[0]),o},n.prototype.highlightParagraph=function(n,t,r,u,f){var c=0,l=0,w=!1,a,e,s,h,b,p,o,v,k,y;for(n.paragraphFormat.bidi&&r.children.indexOf(u)>0&&(u=r.children[0]),a=t;a<n.childWidgets.length;a++){if(e=n.childWidgets[a],a===t?c=this.getTop(e):c+=e.marginTop,_instanceof(u,i)&&(w=u.isRightToLeft),s=this.getLeft(e),e===r){if(h=0,w||n.bidi){for(b=this.getElementsBackward(e,u,u,n.bidi),p=0;p<b.length;p++){if(o=b[p],v=!1,o===u?h=this.getLeftInternal(e,o,f):(k=_instanceof(o,i)?o.length:1,h=this.getLeftInternal(e,o,k)),s=this.getLeftInternal(e,o,0),_instanceof(o,i)&&(v=o.isRightToLeft),l=Math.abs(h-s),o===u&&_instanceof(o,i)&&f>o.length)if(y=this.documentHelper.textHelper.getParagraphMarkSize(o.line.paragraph.characterFormat).Width,!n.bidi&&v)h+=y;else if(n.bidi&&!v){l-=y;this.createHighlightBorder(e,l,s,c,!0);s=this.getLineStartLeft(e)-y;this.createHighlightBorder(e,y,s,c,!0);continue}this.createHighlightBorder(e,l,v?h:s,c,!0)}return}return h=this.getLeftInternal(r,u,f),l=Math.abs(h-s),void this.createHighlightBorder(e,l,w?h:s,c,!1)}l=this.getWidth(e,!0)-(s-n.x);n.bidi&&e.isLastLine()&&(s-=this.documentHelper.textHelper.getParagraphMarkSize(n.characterFormat).Width);this.createHighlightBorder(e,l,s,c,!1);c+=e.height}},n.prototype.getLineWidgetTableWidget=function(n,i){for(var o,r,e,l,h,v,u=void 0,c=0;c<n.childWidgets.length;c++)if(o=n.childWidgets[c],_instanceof(o,a)&&o.y<=i.y){if("Exactly"===o.rowFormat.heightType&&o.y+t.convertPointToPixel(o.rowFormat.height)<i.y)continue;u=this.getLineWidgetRowWidget(o,i);r=void 0;!sf.base.isNullOrUndefined(u)&&_instanceof(u.paragraph.containerWidget,s)&&(r=u.paragraph.containerWidget);e=0;l=0;sf.base.isNullOrUndefined(r)||(h=r.ownerRow.containerWidget,e=t.convertPointToPixel(h.tableFormat.cellSpacing),l=r.cellFormat.rowSpan);var y=0,p=0,w=0,b=0;if(e>0&&(y=0===r.cellIndex?e:e/2,p=r.cellIndex===r.ownerRow.childWidgets.length-1?e:e/2,v=void 0,_instanceof(r.containerWidget,a)&&(v=r.containerWidget),h=void 0,_instanceof(r.containerWidget.containerWidget,f)&&(h=r.containerWidget.containerWidget),sf.base.isNullOrUndefined(v)||sf.base.isNullOrUndefined(h)||(w=0===r.ownerRow.rowIndex?e:e/2,b=r.ownerRow.rowIndex+l===r.ownerTable.childWidgets.length?e:e/2)),!sf.base.isNullOrUndefined(u)&&u.paragraph.x<=i.x&&u.paragraph.x+u.width>=i.x&&u.paragraph.y<=i.y&&this.getTop(u)+u.height>=i.y||!sf.base.isNullOrUndefined(r)&&r.x-r.margin.left-y<=i.x&&r.x+r.width+r.margin.right+p>=i.x&&r.y-r.margin.top-w<=i.y&&r.y+r.height+r.margin.bottom+b>=i.y)break}return u},n.prototype.getLineWidgetRowWidget=function(n,i){for(var u,f,e,o,r=0;r<n.childWidgets.length;r++)if(f=0,e=0,(u=t.convertPointToPixel(n.ownerTable.tableFormat.cellSpacing))>0&&(f=0===n.childWidgets[r].columnIndex?u:u/2,e=n.childWidgets[r].cellIndex===n.childWidgets[r].ownerRow.childWidgets.length-1?u:u/2),n.childWidgets[r].x-n.childWidgets[r].margin.left-f<=i.x&&n.childWidgets[r].x+n.childWidgets[r].width+n.childWidgets[r].margin.right+e>=i.x)return this.getLineWidgetCellWidget(n.childWidgets[r],i);return o=void 0,n.childWidgets.length>0&&(o=n.childWidgets[0].x<=i.x?this.getLineWidgetCellWidget(n.childWidgets[n.childWidgets.length-1],i):this.getLineWidgetCellWidget(n.childWidgets[0],i)),o},n.prototype.getFirstBlock=function(n){if(n.childWidgets.length>0)return n.childWidgets[0]},n.prototype.highlightCellWidget=function(n){var t=[],i;for(n.previousSplitWidget||n.nextSplitWidget?t=n.getSplitWidgets():t.push(n),i=0;i<t.length;i++)n=t[i],this.clearChildSelectionHighlight(n),this.createHighlightBorderInsideTable(n)},n.prototype.clearSelectionHighlight=function(n){this.selectedWidgets.containsKey(n)&&(this.removeSelectionHighlight(n),this.selectedWidgets.remove(n))},n.prototype.getLineWidgetCellWidget=function(n,t){for(var r,i=0;i<n.childWidgets.length;i++)if(n.childWidgets[i].y<=t.y&&n.childWidgets[i].y+n.childWidgets[i].height>=t.y)return _instanceof(n.childWidgets[i],u)?this.getLineWidgetParaWidget(n.childWidgets[i],t):this.getLineWidgetTableWidget(n.childWidgets[i],t);return r=void 0,n.childWidgets.length>0&&n.childWidgets[0].y<=t.y&&(r=_instanceof(n.childWidgets[n.childWidgets.length-1],u)?this.getLineWidgetParaWidget(n.childWidgets[n.childWidgets.length-1],t):this.getLineWidgetTableWidget(n.childWidgets[0],t)),r},n.prototype.updateTextPosition=function(n,t){var f=t,u=void 0,i=0,e=!1,r=this.updateTextPositionIn(n,u,i,t,!1);sf.base.isNullOrUndefined(r)||(u=r.element,i=r.index,f=r.caretPosition,e=r.isImageSelected,this.isImageSelected=e);e?(this.selectInternal(n,u,i,f),0===i?this.extendForward():this.extendBackward()):this.selectInternal(n,u,i,f)},n.prototype.updateTextPositionIn=function(n,t,u,f,s){var ft=!1,y=this.getTop(n),c=n.paragraph.x,yt=this.getFirstElement(n,c),h=yt.element,p=!1,tt=!1,et,l,st,rt,w,g,a,b,ht,ct,at,ut,vt;if(c=yt.left,sf.base.isNullOrUndefined(h)){var it=0,pt=0,k=this.getParagraphMarkSize(n.paragraph,it,pt);it=k.topMargin;pt=k.bottomMargin;(!(this.documentHelper.mouseDownOffset.y>=y&&this.documentHelper.mouseDownOffset.y<y+n.height)||this.documentHelper.mouseDownOffset.x<c+k.width)&&s&&f.x>c+k.width/2&&(c+=k.width,n.children.length>0&&(u=(t=n.children[n.children.length-1]).length),u++);f=new d(c,it>0?y+it:y)}else if(!sf.base.isNullOrUndefined(h)){if(f.x>c+h.margin.left||_instanceof(h,lt)&&"Inline"!==h.textWrappingStyle){for(et=!1,n.paragraph.floatingElements.length>0&&(et=this.documentHelper.checkPointIsInLine(n,f)),l=n.children.indexOf(h);l<n.children.length;l++)if(_instanceof(h=n.children[l],lt)&&"Inline"!==h.textWrappingStyle){if(this.documentHelper.isInShapeBorder(h,f)&&!this.documentHelper.isSelectionChangedOnMouseMoved&&!et){c=h.x;y=h.y;break}}else{if(st=!1,(_instanceof(h,o)||_instanceof(h,i))&&(st=h.line.paragraph.paragraphFormat.bidi),f.x<c+h.margin.left+h.width+h.padding.left||l===n.children.length-1||_instanceof(n.children[l+1],o)&&st)break;c+=h.margin.left+h.width+h.padding.left}if(_instanceof(h,i)&&(p=h.isRightToLeft,tt=h.line.paragraph.paragraphFormat.bidi),f.x>c+h.margin.left+h.width+h.padding.left)u=_instanceof(h,i)?h.length:1,p&&tt&&(u=0),(_instanceof(h,i)&&("\v"!==h.text||"\f"!==h.text)||s)&&(c+=h.margin.left+h.width+h.padding.left);else if(_instanceof(h,i)){for(_instanceof(h,i)&&p&&(c+=h.width+h.padding.left),rt=0,rt=p?c+h.margin.left-f.x:f.x-c-h.margin.left-h.padding.left,c+=h.margin.left+h.padding.left,w=0,g=0,l=1;l<=h.length;l++){if(a=0,l===h.length?a=h.width+h.padding.left:(a=this.documentHelper.textHelper.getWidth(h.text.substr(0,l),h.characterFormat),h.trimEndWidth=a),rt<a||l===h.length){rt-w>(a-w)/2?(p?c-=a:c+=a,g=l):(p?c-=w:c+=w,g=l-1,1!==l||h===n.children[0]||_instanceof(n.children[0],lt)&&"Inline"!==n.children[0].textWrappingStyle)||(b=n.children.indexOf(h),_instanceof(n.children[b-1],o)||p||(g=_instanceof(h=n.children[b-1],i)?h.length:1));break}w=a}u=g}else(ft=_instanceof(h,v)||_instanceof(h,nt),f.x-c-h.margin.left>h.width/2)?(u=1,c+=h.margin.left+h.width+h.padding.left):h===n.children[0]||ft||(b=n.children.indexOf(h),_instanceof(n.children[b-1],o)||(u=_instanceof(h=n.children[b-1],i)?h.length:1));_instanceof(h,i)&&("\v"===h.text||"\f"===h.text)&&(u=0)}else p=h.isRightToLeft,tt=h.line.paragraph.paragraphFormat.bidi,u=_instanceof(h,i)&&(tt||p)&&f.x<c+h.margin.left+h.width+h.padding.left?this.getTextLength(h.line,h)+h.length:this.getTextLength(h.line,h),c+=h.margin.left;_instanceof(h,i)?y+=h.margin.top>0?h.margin.top:0:(ht=this.documentHelper.textHelper.getHeight(h.characterFormat),ct=h.height,_instanceof(h,e)&&!this.documentHelper.layout.hasValidElement(h.line.paragraph)&&(ct=ht.Height),y+=h.margin.top+ct-ht.BaselineOffset);_instanceof(t=h,r)&&2===t.fieldType&&!sf.base.isNullOrUndefined(t.fieldBegin)&&(t=t.fieldBegin,u=0);_instanceof(t,ot)&&(u=0);at=this.validateTextPosition(t,u);t=at.element;u=at.index;ut=sf.base.isNullOrUndefined(t.nextNode)&&u===t.length;vt=sf.base.isNullOrUndefined(t.nextNode)&&_instanceof(t,i)&&"\v"===t.text;(s&&_instanceof(t.nextNode,r)&&u===t.length&&(ut=this.isLastRenderedInline(t,u)),s&&ut||vt)&&(a=0,ut?(a=this.documentHelper.textHelper.getParagraphMarkWidth(n.paragraph.characterFormat),(!(this.documentHelper.mouseDownOffset.y>=y&&this.documentHelper.mouseDownOffset.y<y+n.height)||this.documentHelper.mouseDownOffset.x<c+a)&&f.x>c+a/2&&(c+=a,u=t.length+1)):vt&&(c+=a=h.width+h.padding.left,u=t.length));f=new d(c,y)}return{element:t,index:u,caretPosition:f,isImageSelected:ft}},n.prototype.checkAllFloatingElements=function(n,t){var u,i,e=!1,o=!1,r;if(!sf.base.isNullOrUndefined(n))for(u=n.paragraph.bodyWidget,e=!1,o=!1,r=0;r<u.floatingElements.length;r++)if(!_instanceof(u.floatingElements[r],f)&&(i=u.floatingElements[r],t.x<i.x+i.margin.left+i.width&&t.x>i.x&&t.y<i.y+i.margin.top+i.height&&t.y>i.y)){e=!0;this.documentHelper.isInShapeBorder(i,t)&&(o=!0);break}return{element:i,caretPosition:t,isShapeSelected:e,isInShapeBorder:o}},n.prototype.getTextLength=function(n,t){var r=0,u=n.children.indexOf(t),i;for(n.children.length>0&&_instanceof(n.children[0],o)&&(u-=_instanceof(n.children[1],o)?2:1),i=1;i<u;i++)r+=n.children[i].length;return r},n.prototype.getLeft=function(n){var u=n.paragraph.x,f=n.paragraph.paragraphFormat,r,i;for(this.isParagraphFirstLine(n)&&!f.bidi&&"Right"!==f.textAlignment&&(u+=t.convertPointToPixel(f.firstLineIndent)),r=0;r<n.children.length;r++){if(i=n.children[r],!_instanceof(i,o)||f.bidi){u+=i.margin.left;break}u+=0===r?i.margin.left+i.width:i.width}return u},n.prototype.getTop=function(n){for(var r,t=n.paragraph.y,u=n.paragraph.childWidgets.indexOf(n),i=0;i<u;i++)r=n.paragraph.childWidgets[i],t=t+r.height+r.marginTop;return t+n.marginTop},n.prototype.getFirstElement=function(n,i){var f=0,r,u;for(this.isParagraphFirstLine(n)&&!n.paragraph.paragraphFormat.bidi&&(f=t.convertPointToPixel(n.paragraph.paragraphFormat.firstLineIndent)),i+=f,r=void 0,u=0;u<n.children.length&&(_instanceof(r=n.children[u],o)||_instanceof(r,g));u++){if(n.paragraph.paragraphFormat.bidi){i+=r.margin.left;r=void 0;break}i+=r.margin.left+r.width;r=void 0}return{element:r,left:i}},n.prototype.getIndexInInline=function(n){var f=0,e,t,u;if(_instanceof(n,i))for(e=n.line.children.indexOf(n),t=0;t<e;t++)u=n.line.children[t],_instanceof(u,r)||_instanceof(u,o)||(f+=u.length);return f},n.prototype.isParagraphFirstLine=function(n){return!(!sf.base.isNullOrUndefined(n.paragraph.previousSplitWidget)||n!==n.paragraph.firstChild)},n.prototype.isParagraphLastLine=function(n){return!(!sf.base.isNullOrUndefined(n.paragraph.nextSplitWidget)||n!==n.paragraph.lastChild)},n.prototype.getWidth=function(n,i){var u=0,e=n.paragraph.paragraphFormat,f,r;for(this.isParagraphFirstLine(n)&&!e.bidi&&(u+=t.convertPointToPixel(e.firstLineIndent)),f=0;f<n.children.length;f++)r=n.children[f],_instanceof(r,lt)&&"Inline"!==r.textWrappingStyle||(u+=r.margin.left+r.width+r.padding.left);return i&&n.paragraph.childWidgets.indexOf(n)===n.paragraph.childWidgets.length-1&&sf.base.isNullOrUndefined(n.paragraph.nextSplitWidget)&&(u+=this.documentHelper.textHelper.getParagraphMarkWidth(n.paragraph.characterFormat)),u},n.prototype.getLeftInternal=function(n,r,u){var f=n.paragraph.x,y=n.paragraph.paragraphFormat,s,c,a,e,l,h,v;for(this.isParagraphFirstLine(n)&&!y.bidi&&(f+=t.convertPointToPixel(n.paragraph.paragraphFormat.firstLineIndent)),s=!1,c=!1,_instanceof(r,i)&&(s=r.isRightToLeft,c=r.line.paragraph.paragraphFormat.bidi),c&&(s||(1===this.documentHelper.moveCaretPosition&&n.children.length>0?r=n.children[n.children.length-1]:2===this.documentHelper.moveCaretPosition&&(r=n.children[0]),_instanceof(r,o)&&n.children.length>2&&(r=n.children[n.children.length-3]))),a=n.children.indexOf(r),(1===n.children.length&&_instanceof(n.children[0],o)||2===n.children.length&&_instanceof(n.children[0],o)&&_instanceof(n.children[1],o))&&(a=n.children.length),e=0;e<a;e++)l=n.children[e],_instanceof(l,lt)&&"Inline"!==l.textWrappingStyle||(f+=1===e&&_instanceof(n.children[e],o)?n.children[e].width:_instanceof(n.children[e],oi)&&r===l?n.children[e].margin.left:n.children[e].margin.left+n.children[e].width+n.children[e].padding.left);if(sf.base.isNullOrUndefined(r)||(f+=r.margin.left+r.padding.left,_instanceof(r,lt)&&!sf.base.isNullOrUndefined(r.nextElement)&&(f+=r.nextElement.margin.left+r.nextElement.padding.left),(s||1===this.documentHelper.moveCaretPosition&&!s&&c)&&(f+=r.width)),h=0,_instanceof(r,i)){if(0!==this.documentHelper.moveCaretPosition&&(c||s))return(s&&c&&2===this.documentHelper.moveCaretPosition||s&&!c&&1===this.documentHelper.moveCaretPosition)&&(f-=r.width),this.documentHelper.moveCaretPosition=0,f;u!==r.length||s?u>r.length?(h=this.documentHelper.textHelper.getParagraphMarkWidth(r.line.paragraph.characterFormat),s?f-=r.width+h:f+=r.width+h):(h=this.documentHelper.textHelper.getWidth(r.text.substr(0,u),r.characterFormat),r.trimEndWidth=h,s?f-=h:f+=h):f+=r.width;this.documentHelper.moveCaretPosition=0}else u>0&&(sf.base.isNullOrUndefined(r)||_instanceof(r,o)?f+=this.documentHelper.textHelper.getParagraphMarkWidth(n.paragraph.characterFormat):(_instanceof(r,lt)&&"Inline"!==r.textWrappingStyle||(f+=r.width),2===u)&&(v=r.line.paragraph,f+=this.documentHelper.textHelper.getParagraphMarkWidth(v.characterFormat)));return f},n.prototype.getLineStartLeft=function(n){var i=n.paragraph.x,r=n.paragraph.paragraphFormat;return this.isParagraphFirstLine(n)&&!r.bidi&&(i+=t.convertPointToPixel(r.firstLineIndent)),n.children.length>0&&(i+=n.children[0].margin.left),i},n.prototype.updateTextPositionWidget=function(n,t,i,r){var u,f=t,e=void 0,o=0;e=(u=this.updateTextPositionIn(n,e,o,f,r)).element;o=u.index;f=u.caretPosition;i.setPositionForSelection(n,e,o,f)},n.prototype.clearSelectionHighlightLineWidget=function(){!sf.base.isNullOrUndefined(this.owner)&&this.selectedWidgets.length>0&&this.clearSelectionHighlight(this)},n.prototype.getFirstElementInternal=function(n){for(var i=void 0,r=n.paragraph.paragraphFormat.bidi,u=n.children.length,t=r?u-1:0;(r?t>=0:t<u)&&_instanceof(i=n.children[t],o);r?t--:t++)i=void 0;return i},n.prototype.selectRange=function(n,t){this.start.setPositionInternal(n);this.end.setPositionInternal(t);this.upDownSelectionLength=this.end.location.x;this.fireSelectionChanged(!0)},n.prototype.selectParagraphInternal=function(n,t){var i,r;sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.firstChild)||((i=n.firstChild,t)?this.start.setPosition(i,t):(r=i.getEndOffset(),this.start.setPositionParagraph(i,r)));this.end.setPositionInternal(this.start);this.upDownSelectionLength=this.start.location.x;this.fireSelectionChanged(!0)},n.prototype.setPositionForBlock=function(n,t){var i,r;return(_instanceof(n,f)&&(n=t?this.getFirstParagraphInFirstCell(n):this.getLastParagraphInLastCell(n)),_instanceof(n,u))&&((i=new l(this.owner),t)?i.setPosition(n.firstChild,!0):(r=n.lastChild,i.setPositionParagraph(r,r.getEndOffset()))),i},n.prototype.selectContent=function(n){if(sf.base.isNullOrUndefined(n))throw new Error("textPosition is undefined.");this.start.setPositionInternal(n);this.end.setPositionInternal(n);this.upDownSelectionLength=this.end.location.x;this.fireSelectionChanged(!0)},n.prototype.selectInternal=function(n,t,i,r){this.start.setPositionForSelection(n,t,i,r);this.end.setPositionInternal(this.start);this.upDownSelectionLength=r.x;this.fireSelectionChanged(!0)},n.prototype.selects=function(n,t,i){this.documentHelper.clearSelectionHighlight();this.start.setPositionForLineWidget(n,t);this.end.setPositionInternal(this.start);i||this.fireSelectionChanged(!0)},n.prototype.selectPosition=function(n,t){if(sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(t))throw new Error("TextPosition cannot be undefined");if(sf.base.isNullOrUndefined(n.paragraph)||n.offset>this.getParagraphLength(n.paragraph)+1)throw new Error("Start TextPosition is not valid.");if(sf.base.isNullOrUndefined(t.paragraph)||t.offset>this.getParagraphLength(t.paragraph)+1)throw new Error("End TextPosition is not valid.");n.isAtSamePosition(t)?this.selectRange(n,n):(n.isExistBefore(t)?t.validateForwardFieldSelection(n.getHierarchicalIndexInternal(),t.getHierarchicalIndexInternal()):n.validateForwardFieldSelection(t.getHierarchicalIndexInternal(),n.getHierarchicalIndexInternal()),this.selectRange(n,t))},n.prototype.fireSelectionChanged=function(n){this.isEmpty||(this.isForward?(this.start.updatePhysicalPosition(!0),this.end.updatePhysicalPosition(!1)):(this.start.updatePhysicalPosition(!1),this.end.updatePhysicalPosition(!0)));this.skipFormatRetrieval||this.retrieveCurrentFormatProperties();this.documentHelper.clearSelectionHighlight();this.hideToolTip();this.owner.isLayoutEnabled&&!this.owner.isShiftingEnabled&&this.highlightSelection(!0);n&&(this.start.paragraph.isInHeaderFooter&&!this.owner.enableHeaderAndFooter?this.owner.enableHeaderAndFooter=!0:!this.start.paragraph.isInHeaderFooter&&this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1),this.owner.fireSelectionChange());this.documentHelper.updateFocus();this.documentHelper.isInlineFormFillProtectedMode&&n&&(this.triggerFormFillEvent(),this.previousSelectedFormField=this.getCurrentFormField())},n.prototype.retrieveCurrentFormatProperties=function(){this.isRetrieveFormatting=!0;var n=this.start,t=this.end;this.isForward||(n=this.end,t=this.start);this.retrieveImageFormat(n,t);this.retrieveCharacterFormat(n,t);this.retrieveParagraphFormat(n,t);this.retrieveSectionFormat(n,t);this.retrieveTableFormat(n,t);this.isImageSelected||this.imageFormat.clearImageFormat();this.isRetrieveFormatting=!1;this.setCurrentContextType()},n.prototype.retrieveImageFormat=function(n,t){var i,r;n.currentWidget===t.currentWidget&&n.offset+1===t.offset&&(r=t.currentWidget.getInline(t.offset,0),i=r.element,r.index,_instanceof(i,v)&&n.currentWidget.getOffset(i,0)!==n.offset&&(i=void 0));_instanceof(i,v)?this.imageFormat.copyImageFormat(i):this.imageFormat.clearImageFormat()},n.prototype.getPreviousContextType=function(n){var t=this.start,i;if(t.offset>0)return i=t.currentWidget.getInline(t.offset,0).element,i=n?i.previousElement:t.currentWidget.getInline(t.offset-1,0).element,this.getContextElement(i)},n.prototype.getNextContextType=function(n){var t=this.start,i=t.currentWidget.getInline(t.offset,0).element;return i=n&&i.nextElement?i.nextElement:t.currentWidget.getInline(t.offset+1,0).element,this.getContextElement(i)},n.prototype.getContextElement=function(n){return _instanceof(n,i)?"Text":_instanceof(n,r)||_instanceof(n,ci)?"Field":_instanceof(n,e)?"Bookmark":_instanceof(n,v)?"Image":_instanceof(n,nt)?"Shape":_instanceof(n,rr)||_instanceof(n,g)?"Comment":_instanceof(n,o)?"List":_instanceof(n,ht)||_instanceof(n,ot)?"EditRange":void 0},n.prototype.setCurrentContextType=function(){var t=!!this.imageFormat.image,r=!sf.base.isNullOrUndefined(this.tableFormat)&&!sf.base.isNullOrUndefined(this.tableFormat.table),u=this.start.paragraph.paragraphFormat.baseStyle,f,i,n;if(_instanceof(u,fi)&&0===u.name.toLowerCase().indexOf("toc")&&(f=this.getTocFieldInternal(),!sf.base.isNullOrUndefined(f)))return void(this.contextTypeInternal="TableOfContents");i=this.getCurrentRevision();(i?(this.owner.showRevisions=!0,this.owner.dotNetRef.invokeMethodAsync("ShowRevisions",!0),this.owner.trackChangesPane.currentSelectedRevision=i[0]):sf.base.isNullOrUndefined(this.owner.trackChangesPane.currentSelectedRevision)||(this.owner.trackChangesPane.currentSelectedRevision=void 0),this.start.paragraph.isInHeaderFooter)?(n=-1!==this.start.paragraph.bodyWidget.headerFooterType.indexOf("Header"),this.contextTypeInternal=r?t?n?"HeaderTableImage":"FooterTableImage":n?"HeaderTableText":"FooterTableText":t?n?"HeaderImage":"FooterImage":n?"HeaderText":"FooterText"):this.contextTypeInternal=r?t?"TableImage":"TableText":t?"Image":"Text"},n.prototype.addItemRevisions=function(n,t){for(var r,i=0;i<n.revisions.length;i++)r=n.revisions[i],this.selectRevision(r),t?r.accept():r.reject()},n.prototype.hasRevisions=function(){return!!this.getCurrentRevision()},n.prototype.getCurrentRevision=function(){var t=this.start,i=this.end,e,r;this.isForward||(t=this.end,i=this.start);var u,n=t.currentWidget.getInline(t.offset,0).element,f=t.paragraph,o=t.currentWidget.getInline(t.offset+1,0).element;if(!n||n!==o||(e=n.line.getOffset(n,n.length),(u=new l(this.owner)).setPositionParagraph(n.line,e),i.offset!==u.offset||sf.base.isNullOrUndefined(n.nextElement)))return!sf.base.isNullOrUndefined(n)&&n.revisions.length>0?n.revisions:f.isInsideTable&&(r=f.associatedCell,!sf.base.isNullOrUndefined(r.ownerRow)&&r.ownerRow.rowFormat.revisions.length>0)?r.ownerRow.rowFormat.revisions:i.offset>i.paragraph.getLength()&&i.paragraph.characterFormat.revisions.length>0?i.paragraph.characterFormat.revisions:void 0},n.prototype.processLineRevisions=function(n,t){for(var r,i=0;i<n.children.length;i++)r=n.children[i],r.revisions.length>0&&this.addItemRevisions(r,t)},n.prototype.handleAcceptReject=function(n){var r,u,i,t,e,f,s,o;if(this.isEmpty){if(r=this.start.currentWidget.getInline(this.start.offset+1,0).element,u=this.start.paragraph,!sf.base.isNullOrUndefined(r)&&r.revisions.length>0&&this.addItemRevisions(r,n),u.isInsideTable)if(i=u.associatedCell,sf.base.isNullOrUndefined(i)){if(!u.isEmpty())for(t=0;t<i.childWidgets.length;t++)for(e=i.childWidgets[t],f=void 0;f<e.childWidgets.length;f++)s=e.childWidgets[f],this.processLineRevisions(s,n)}else i.ownerRow.rowFormat.revisions.length>0&&this.addItemRevisions(i.ownerRow.rowFormat,n)}else for(o=this.getselectedRevisionElements(),t=0;t<o.length;t++)this.acceptReject(o[t],n)},n.prototype.acceptReject=function(n,t){this.selectRevision(n);t?n.accept():n.reject()},n.prototype.getselectedRevisionElements=function(){var t=[],f=this.start,e=this.end,i,n,r,o,u,h;for(this.isForward||(f=this.end,e=this.start),i=0;i<this.selectedWidgets.length;i++)if(n=this.selectedWidgets.keys[i],_instanceof(n,k))t=this.getSelectedLineRevisions(n,f,e,t);else if(_instanceof(n,s))for(n.ownerRow.rowFormat.revisions.length>0&&(t=this.addRevisionsCollec(n.ownerRow.rowFormat.revisions,t)),r=0;r<n.childWidgets.length;r++)for(o=n.childWidgets[r],u=0;u<o.childWidgets.length;u++)h=o.childWidgets[u],t=this.getSelectedLineRevisions(h,f,e,t);return t},n.prototype.getSelectedLineRevisions=function(n,t,i,r){var o,e;for(n.paragraph.characterFormat.revisions.length>0&&(r=this.addRevisionsCollec(n.paragraph.characterFormat.revisions,r)),o=0;o<n.children.length;o++){var u=n.children[o],s=u.line.getOffset(u,0),f=new l(this.owner);f.setPositionParagraph(u.line,s);s=u.line.getOffset(u,u.length);e=new l(this.owner);e.setPositionParagraph(u.line,s);(e.isExistAfter(t)&&e.isExistBefore(i)||f.isExistAfter(t)&&f.isExistBefore(i)||f.isAtSamePosition(t)||t.isExistAfter(f)&&i.isExistBefore(e))&&u.revisions.length>0&&(r=this.addRevisionsCollec(u.revisions,r))}return r},n.prototype.addRevisionsCollec=function(n,t){for(var i=0;i<n.length;i++)-1===t.indexOf(n[i])&&t.push(n[i]);return t},n.prototype.retrieveTableFormat=function(n,t){var i=this.getTable(n,t);sf.base.isNullOrUndefined(i)?this.tableFormat.clearFormat():(this.tableFormat.copyFormat(i.tableFormat),this.tableFormat.table=i,this.retrieveCellFormat(n,t),this.retrieveRowFormat(n,t))},n.prototype.retrieveCellFormat=function(n,t){n.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.cellFormat.copyFormat(n.paragraph.associatedCell.cellFormat),this.getCellFormat(n.paragraph.associatedCell.ownerTable,n,t)):this.cellFormat.clearCellFormat()},n.prototype.retrieveRowFormat=function(n,t){n.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.rowFormat.copyFormat(n.paragraph.associatedCell.ownerRow.rowFormat),this.getRowFormat(n.paragraph.associatedCell.ownerTable,n,t)):this.rowFormat.clearRowFormat()},n.prototype.getCellFormat=function(n,t,i){var o,u,f,e,r;if(!t.paragraph.associatedCell.equals(i.paragraph.associatedCell))for(o=!1,u=0;u<n.childWidgets.length;u++)if(f=n.childWidgets[u],f===t.paragraph.associatedCell.ownerRow&&(o=!0),o)for(e=0;e<f.childWidgets.length;e++)if(r=f.childWidgets[e],this.isCellSelected(r,t,i)&&this.cellFormat.combineFormat(r.cellFormat),r===i.paragraph.associatedCell)return void this.cellFormat.combineFormat(r.cellFormat)},n.prototype.getRowFormat=function(n,t,i){var f=t.paragraph.associatedCell.ownerRow,r,u;if(f!==i.paragraph.associatedCell.ownerRow)for(r=n.childWidgets.indexOf(f)+1;r<n.childWidgets.length;r++)if(u=n.childWidgets[r],this.rowFormat.combineFormat(u.rowFormat),u===i.paragraph.associatedCell.ownerRow)return},n.prototype.getTable=function(n,t){if(!sf.base.isNullOrUndefined(n.paragraph.associatedCell)&&!sf.base.isNullOrUndefined(t.paragraph.associatedCell)){var i=n.paragraph.associatedCell.ownerTable,r=n.paragraph.associatedCell.ownerTable;if(i===r||i.contains(n.paragraph.associatedCell))return i;if(r.contains(n.paragraph.associatedCell))return r;if(!i.isInsideTable||!r.isInsideTable)return;do{if((i=i.associatedCell.ownerTable)===r||i.contains(r.associatedCell))return i;if(r.contains(i.associatedCell))return r}while(!sf.base.isNullOrUndefined(i.associatedCell))}},n.prototype.getContainerWidget=function(n){var t;if(_instanceof(n.containerWidget,et))t=n.containerWidget.containerShape.line.paragraph.bodyWidget;else if(_instanceof(n.containerWidget,ri))t=n.containerWidget;else for(t=n.containerWidget;!_instanceof(t,ri);)_instanceof(t,et)&&(t=t.containerShape.line.paragraph),t=t.containerWidget;return t},n.prototype.retrieveSectionFormat=function(n,t){var i=this.getContainerWidget(n.paragraph),u=this.getContainerWidget(t.paragraph);if(!sf.base.isNullOrUndefined(i)){this.sectionFormat.copyFormat(i.sectionFormat);for(var f=this.documentHelper.pages.indexOf(i.page),e=this.documentHelper.pages.indexOf(u.page),r=f+1;r<=e;r++)this.sectionFormat.combineFormat(this.documentHelper.pages[r].bodyWidgets[0].sectionFormat)}},n.prototype.retrieveParagraphFormat=function(n,t){this.getParagraphFormatForSelection(n.paragraph,this,n,t)},n.prototype.getParagraphFormatForSelection=function(n,t,i,r){!i.paragraph.isInsideTable||r.paragraph.isInsideTable&&i.paragraph.associatedCell===r.paragraph.associatedCell&&!this.isCellSelected(i.paragraph.associatedCell,i,r)?this.getParagraphFormatInternalInParagraph(n,i,r):this.getParagraphFormatInternalInCell(i.paragraph.associatedCell,i,r)},n.prototype.getParagraphFormatInternalInParagraph=function(n,t,i){if(t.paragraph===n?this.paragraphFormat.copyFormat(n.paragraphFormat):this.paragraphFormat.combineFormat(n.paragraphFormat),i.paragraph!==n){var r=this.getNextRenderedBlock(n);sf.base.isNullOrUndefined(r)||this.getParagraphFormatInternalInBlock(r,t,i)}},n.prototype.getParagraphFormatInternalInBlock=function(n,t,i){_instanceof(n,u)?this.getParagraphFormatInternalInParagraph(n,t,i):this.getParagraphFormatInternalInTable(n,t,i)},n.prototype.getParagraphFormatInternalInTable=function(n,t,i){for(var u,f,e,r=0;r<n.childWidgets.length;r++){for(u=n.childWidgets[r],f=0;f<u.childWidgets.length;f++)this.getParagraphFormatInCell(u.childWidgets[f]);if(i.paragraph.isInsideTable&&this.containsRow(u,i.paragraph.associatedCell))return}e=this.getNextRenderedBlock(n);this.getParagraphFormatInternalInBlock(e,t,i)},n.prototype.getParagraphFormatInCell=function(n){for(var t=0;t<n.childWidgets.length;t++)this.getParagraphFormatInBlock(n.childWidgets[t])},n.prototype.getParagraphFormatInBlock=function(n){_instanceof(n,u)?this.getParagraphFormatInParagraph(n):this.getParagraphFormatInTable(n)},n.prototype.getParagraphFormatInTable=function(n){for(var r,i,t=0;t<n.childWidgets.length;t++)for(r=n.childWidgets[t],i=0;i<r.childWidgets.length;i++)this.getParagraphFormatInCell(r.childWidgets[i])},n.prototype.getParagraphFormatInParagraph=function(n){this.paragraphFormat.combineFormat(n.paragraphFormat)},n.prototype.getParagraphFormatInternalInCell=function(n,t,i){var r,u,f,e;i.paragraph.isInsideTable?(r=this.getContainerCellOf(n,i.paragraph.associatedCell),r.ownerTable.contains(i.paragraph.associatedCell)?(u=this.getSelectedCell(n,r),f=this.getSelectedCell(i.paragraph.associatedCell,r),this.containsCell(r,i.paragraph.associatedCell)?this.isCellSelected(r,t,i)?this.getParagraphFormatInCell(r):u===r?this.getParagraphFormatInternalInParagraph(t.paragraph,t,i):this.getParagraphFormatInRow(u.ownerRow,t,i):this.getParaFormatForCell(r.ownerTable,r,f)):this.getParagraphFormatInRow(r.ownerRow,t,i)):(e=this.getContainerCell(n),this.getParagraphFormatInRow(e.ownerRow,t,i))},n.prototype.getParaFormatForCell=function(n,i,r){var u=this.getCellLeft(i.ownerRow,i),s=u+i.cellFormat.cellWidth,h=this.getCellLeft(r.ownerRow,r),a=h+r.cellFormat.cellWidth,v,f,e,o,c,l;for(u>h&&(u=h),s<a&&(s=a),u>this.upDownSelectionLength&&(u=this.upDownSelectionLength),u<this.upDownSelectionLength&&(u=this.upDownSelectionLength),v=n.childWidgets.indexOf(r.ownerRow),f=n.childWidgets.indexOf(i.ownerRow);f<=v;f++)for(e=n.childWidgets[f],o=0;o<e.childWidgets.length;o++)c=e.childWidgets[o],l=this.getCellLeft(e,c),t.round(u,2)<=t.round(l,2)&&t.round(l,2)<t.round(s,2)&&this.getParagraphFormatInCell(c)},n.prototype.getParagraphFormatInRow=function(n,t,i){for(var u,f,e,r=n.rowIndex;r<n.ownerTable.childWidgets.length;r++){for(u=n.ownerTable.childWidgets[r],f=0;f<u.childWidgets.length;f++)this.getParagraphFormatInCell(u.childWidgets[f]);if(i.paragraph.isInsideTable&&this.containsRow(u,i.paragraph.associatedCell))return}e=this.getNextRenderedBlock(n.ownerTable);this.getParagraphFormatInternalInBlock(e,t,i)},n.prototype.retrieveCharacterFormat=function(n,t){var i,r,u;if(this.characterFormat.copyFormat(n.paragraph.characterFormat),n.paragraph!==t.paragraph||!n.currentWidget.isLastLine()||n.offset!==this.getLineLength(n.currentWidget)||n.offset+1!==t.offset)if(i=n.paragraph,n.paragraph===t.paragraph&&this.isSelectList)r=this.getListLevel(n.paragraph),r&&r.characterFormat.uniqueCharacterFormat&&this.characterFormat.copyFormat(r.characterFormat);else{for(n.offset!==this.getParagraphLength(i)||this.isEmpty||(i=this.getNextParagraphBlock(i));!sf.base.isNullOrUndefined(i)&&i!==t.paragraph&&i.isEmpty();)i=this.getNextParagraphBlock(i);if(u=i===n.paragraph?n.offset:0,!sf.base.isNullOrUndefined(i)&&!i.isEmpty()){var f=new l(this.owner),e=n.currentWidget.getInline(u,0),o=this.getPhysicalPositionInternal(n.currentWidget,u,!0);f.setPositionForSelection(n.currentWidget,e.element,e.index,o);this.getCharacterFormatForSelection(i,this,f,t)}}},n.prototype.getCharacterFormatForSelection=function(n,t,i,r){_instanceof(i.paragraph,u)&&i.paragraph.isInsideTable&&(!r.paragraph.isInsideTable||i.paragraph.associatedCell!==r.paragraph.associatedCell||this.isCellSelected(i.paragraph.associatedCell,i,r))?this.getCharacterFormatInTableCell(i.paragraph.associatedCell,t,i,r):this.getCharacterFormat(n,i,r)},n.prototype.getCharacterFormatForTableRow=function(n,t,i){for(var u,f,e,r=n.rowIndex;r<n.ownerTable.childWidgets.length;r++){for(u=n.ownerTable.childWidgets[r],f=0;f<u.childWidgets.length;f++)this.getCharacterFormatForSelectionCell(u.childWidgets[f],t,i);if(i.paragraph.isInsideTable&&this.containsRow(u,i.paragraph.associatedCell))return}e=this.getNextRenderedBlock(n.ownerTable);this.getCharacterFormatForBlock(e,t,i)},n.prototype.getCharacterFormatInTableCell=function(n,t,i,r){var u,f,e,o;r.paragraph.isInsideTable?(u=this.getContainerCellOf(n,r.paragraph.associatedCell),u.ownerTable.contains(r.paragraph.associatedCell)?(f=this.getSelectedCell(n,u),e=this.getSelectedCell(r.paragraph.associatedCell,u),this.containsCell(u,r.paragraph.associatedCell)?this.isCellSelected(u,i,r)?this.getCharacterFormatForSelectionCell(u,i,r):f===u?this.getCharacterFormat(i.paragraph,i,r):this.getCharacterFormatForTableRow(f.ownerRow,i,r):this.getCharacterFormatInternalInTable(u.ownerTable,u,e,i,r)):this.getCharacterFormatForTableRow(u.ownerRow,i,r)):(o=this.getContainerCell(n),this.getCharacterFormatForTableRow(o.ownerRow,i,r))},n.prototype.getCharacterFormatInternalInTable=function(n,i,r,u,f){var e=this.getCellLeft(i.ownerRow,i),o=e+i.cellFormat.cellWidth,l=this.getCellLeft(r.ownerRow,r),y=l+r.cellFormat.cellWidth,p,s,h,c,a,v;for(e>l&&(e=l),o<y&&(o=y),e>this.upDownSelectionLength&&(e=this.upDownSelectionLength),o<this.upDownSelectionLength&&(o=this.upDownSelectionLength),p=n.childWidgets.indexOf(r.ownerRow),s=n.childWidgets.indexOf(i.ownerRow);s<=p;s++)for(h=n.childWidgets[s],c=0;c<h.childWidgets.length;c++)a=h.childWidgets[c],v=this.getCellLeft(h,a),t.round(e,2)<=t.round(v,2)&&t.round(v,2)<t.round(o,2)&&this.getCharacterFormatForSelectionCell(a,u,f)},n.prototype.getCharacterFormat=function(n,u,f){var a,y,w,s,h,c,v,e,d,l,b;if(n===u.paragraph||n===f.paragraph||n.isEmpty()){if(f.paragraph!==n||u.paragraph===n||0!==f.offset){if(a=0,y=this.getParagraphLength(n),n===u.paragraph&&(a=u.offset,this.setCharacterFormat(n,u,f,y)))return;var k=-1!==n.childWidgets.indexOf(u.currentWidget)?n.childWidgets.indexOf(u.currentWidget):0,g=-1!==n.childWidgets.indexOf(f.currentWidget)?n.childWidgets.indexOf(f.currentWidget):n.childWidgets.length-1,p=f.offset;for(n!==f.paragraph&&(p=y),w=!1,s=k;s<=g;s++)for(h=n.childWidgets[s],s!==k&&(a=this.getStartLineOffset(h)),p=h===f.currentWidget?f.offset:this.getLineLength(h),c=0,v=0;v<h.children.length;v++)if(e=h.children[v],!_instanceof(e,o))if(a>=c+e.length)c+=e.length;else{if(_instanceof(e,r)&&0===e.fieldType&&t.isLinkedFieldCharacter(e)){d=sf.base.isNullOrUndefined(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator;do c+=e.length,e=e.nextNode,s++;while(!sf.base.isNullOrUndefined(e)&&e!==d);w=!0}if(_instanceof(e,r)&&1===e.fieldType&&t.isLinkedFieldCharacter(e)&&w){l=e.fieldBegin;do this.characterFormat.combineFormat(l.characterFormat),l=l.nextNode;while(!_instanceof(l,r))}if(_instanceof(e,i)&&this.characterFormat.combineFormat(e.characterFormat),sf.base.isNullOrUndefined(e)||p<=c+e.length)break;c+=e.length}f.paragraph!==n&&(b=this.getNextRenderedBlock(n),sf.base.isNullOrUndefined(b)||this.getCharacterFormatForBlock(b,u,f))}}else this.getCharacterFormatInternal(n,this)},n.prototype.setCharacterFormat=function(n,t,u,f){var o=0,s=t.offset,c=t.currentWidget.getInline(s,o),e,h;if(o=c.index,e=c.element,sf.base.isNullOrUndefined(e)&&(t.paragraph.childWidgets.indexOf(t.currentWidget),t.currentWidget.previousLine))return e=t.currentWidget.previousLine.children[t.currentWidget.previousLine.children.length-1],this.characterFormat.copyFormat(e.characterFormat),!0;if(s<f){if(this.isEmpty)return _instanceof(e,i)||_instanceof(e,r)&&(0===e.fieldType||1===e.fieldType)?(h=this.getPreviousTextElement(e),0===s&&h&&(e=h),this.characterFormat.copyFormat(e.characterFormat)):sf.base.isNullOrUndefined(this.getPreviousTextElement(e))?sf.base.isNullOrUndefined(this.getNextTextElement(e))?this.characterFormat.copyFormat(n.characterFormat):this.characterFormat.copyFormat(this.getNextTextElement(e).characterFormat):this.characterFormat.copyFormat(this.getPreviousTextElement(e).characterFormat),!0;o!==e.length||sf.base.isNullOrUndefined(e.nextNode)?_instanceof(e,i)?this.characterFormat.copyFormat(e.characterFormat):_instanceof(e,r)&&this.characterFormat.copyFormat(this.getNextValidCharacterFormatOfField(e)):this.characterFormat.copyFormat(this.getNextValidCharacterFormat(e))}else if(f===u.offset)return _instanceof(e,i)||_instanceof(e,r)?this.characterFormat.copyFormat(e.characterFormat):sf.base.isNullOrUndefined(e)?this.characterFormat.copyFormat(n.characterFormat):(e=this.getPreviousTextElement(e),sf.base.isNullOrUndefined(e)||this.characterFormat.copyFormat(e.characterFormat)),!0;return!1},n.prototype.getCharacterFormatForBlock=function(n,t,i){_instanceof(n,u)?this.getCharacterFormat(n,t,i):this.getCharacterFormatInTable(n,t,i)},n.prototype.getCharacterFormatInTable=function(n,t,i){for(var u,f,e,r=0;r<n.childWidgets.length;r++){for(u=n.childWidgets[r],f=0;f<u.childWidgets.length;f++)this.getCharacterFormatForSelectionCell(u.childWidgets[f],t,i);if(i.paragraph.isInsideTable&&this.containsRow(u,i.paragraph.associatedCell))return}e=this.getNextRenderedBlock(n);this.getCharacterFormatForBlock(e,t,i)},n.prototype.getCharacterFormatForSelectionCell=function(n,t,i){for(var r=0;r<n.childWidgets.length;r++)this.getCharacterFormatForBlock(n.childWidgets[r],t,i)},n.prototype.getCharacterFormatInternal=function(n,t){for(var e,u,f,i=0;i<n.childWidgets.length;i++)for(e=n.childWidgets[i],u=0;u<e.children.length;u++)f=e.children[u],_instanceof(f,v)||_instanceof(f,r)||t.characterFormat.combineFormat(f.characterFormat)},n.prototype.getNextValidCharacterFormat=function(n){var i=this.getNextTextElement(n),t;return sf.base.isNullOrUndefined(i)?n.characterFormat:(t=void 0,_instanceof(i,r)&&0===t.fieldType&&(t=i),sf.base.isNullOrUndefined(t)?i.characterFormat:this.getNextValidCharacterFormatOfField(t))},n.prototype.getNextValidCharacterFormatOfField=function(n){var i=n,r;return t.isLinkedFieldCharacter(n)&&(i=sf.base.isNullOrUndefined(n.fieldSeparator)?n.fieldEnd:n.fieldSeparator),r=void 0,sf.base.isNullOrUndefined(i.nextNode)||(r=this.getNextValidElement(i.nextNode)),sf.base.isNullOrUndefined(r)?i.characterFormat:r.characterFormat},n.prototype.checkCursorIsInSelection=function(n,t){var r,i,u;if(sf.base.isNullOrUndefined(this.start)||this.isEmpty||sf.base.isNullOrUndefined(n))return!1;r=!1;do this.selectedWidgets.containsKey(n)&&(i=void 0,_instanceof(n,k)?(i=this.owner.selection.getTop(n),this.owner.selection.getLeft(n)):(i=n.y,n.x),u=this.selectedWidgets.get(n),r=u.left<=t.x&&i<=t.y&&i+n.height>=t.y&&u.left+u.width>=t.x),n=_instanceof(n,k)?n.paragraph:n.containerWidget;while(!sf.base.isNullOrUndefined(n)&&!r);return r},n.prototype.copySelectionParagraphFormat=function(){var n=new ut;return this.paragraphFormat.copyToFormat(n),n},n.prototype.getHyperlinkDisplayText=function(n,t,u,f,e){var s=n,h,l,o;if(s!==u.line.paragraph)return{displayText:"<<Selection in Document>>",isNestedField:f=!0,format:e};for(var a="",v=s.childWidgets.indexOf(t.line),y=s.childWidgets[v].children.indexOf(t),c=v;c<s.childWidgets.length;c++)for(h=s.childWidgets[c],c!==v&&(y=-1),l=y+1;l<h.children.length;l++){if(o=h.children[l],o===u)return{displayText:a,isNestedField:f,format:e};if(_instanceof(o,i))a+=o.text,e=o.characterFormat;else{if(!_instanceof(o,r))return{displayText:"<<Selection in Document>>",isNestedField:f=!0,format:e};_instanceof(o,r)&&0===o.fieldType&&!sf.base.isNullOrUndefined(o.fieldEnd)&&(y=sf.base.isNullOrUndefined(o.fieldSeparator)?h.children.indexOf(o.fieldEnd):h.children.indexOf(o.fieldSeparator))}}return{displayText:a,isNestedField:f,format:e}},n.prototype.navigateHyperLinkOnEvent=function(n,t){var i=this,u=this.documentHelper.getLineWidget(n),r;sf.base.isNullOrUndefined(u)||(r=this.getHyperLinkFieldInCurrentSelection(u,n),sf.base.isNullOrUndefined(r)||(this.documentHelper.updateTextPositionForSelection(n,1),this.fireRequestNavigate(r),setTimeout(function(){i.viewer&&(i.documentHelper.isTouchInput=t,i.documentHelper.updateFocus(),i.documentHelper.isTouchInput=!1)})))},n.prototype.getLinkText=function(n){var t=new vu(n,this),i=t.navigationLink;return t.localReference.length>0&&("_"!==t.localReference[0]||!sf.base.isNullOrUndefined(i)&&0!==i.length?i+=t.isCrossRef?t.localReference:"#"+t.localReference:i="Current Document"),t.destroy(),i},n.prototype.setHyperlinkContentToToolTip=function(n,t,i,r){var f,o,e,u;if(n){if(this.toolTipElement||(this.toolTipElement=sf.base.createElement("div",{className:"e-de-tooltip e-lib e-popup e-control"}),this.documentHelper.viewerContainer.appendChild(this.toolTipElement)),this.toolTipElement.style.display="block",f=this.owner.defaultLocale["Click to follow link"]?this.owner.defaultLocale["Click to follow link"]:"Click to follow link",this.owner.useCtrlClickToFollowHyperlink&&(f="Ctrl+"+f),o=this.getLinkText(n),r){if(e=n.formFieldData.helpText,sf.base.isNullOrUndefined(e)||""===e)return;this.toolTipElement.innerHTML=e}else this.toolTipElement.innerHTML=o+"<\/br><b>"+f+"<\/b>";u=this.getTooltipPosition(n.line,i,this.toolTipElement.clientWidth,this.toolTipElement.offsetHeight,!1);this.showToolTip(u.x,u.y);(sf.base.isNullOrUndefined(this.toolTipField)||!sf.base.isNullOrUndefined(this.toolTipField)&&n!==this.toolTipField)&&(this.toolTipElement.style.left=u.x+"px",this.toolTipElement.style.top=u.y+"px",this.toolTipElement.style.zIndex="2000");this.toolTipElement.style.position="absolute";this.toolTipElement.style.display="block";this.toolTipField=n}else this.hideToolTip()},n.prototype.setFootnoteContentToToolTip=function(n,t,i){var u,r;n?(this.toolTipElement||(this.toolTipElement=sf.base.createElement("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.toolTipElement)),this.toolTipElement.style.display="block",u=void 0,"Endnote"===n.footnoteType?u="Click to View/Edit Endnote":"Footnote"===n.footnoteType&&(u="Click to View/Edit Footnote"),this.toolTipElement.innerHTML="<b>"+u+"<\/b>",r=this.getTooltipPosition(n.line,i,this.toolTipElement.clientWidth,this.toolTipElement.offsetHeight,!1),this.showToolTip(r.x,r.y),sf.base.isNullOrUndefined(this.toolTipField)||(this.toolTipElement.style.left=r.x+"px",this.toolTipElement.style.top=r.y+"px",this.toolTipElement.style.zIndex="2000"),this.toolTipElement.style.position="absolute",this.toolTipElement.style.display="block"):this.hideToolTip()},n.prototype.setLockInfoTooptip=function(){},n.prototype.getTooltipPosition=function(n,t,i,r,u){var c=this.getTop(n)*this.documentHelper.zoomFactor,s=this.getPage(n.paragraph),h=this.documentHelper.viewerContainer.getBoundingClientRect().width+this.documentHelper.viewerContainer.scrollLeft,e=s.boundingRectangle.x+t*this.documentHelper.zoomFactor,o,f;return e+i+10>h&&(e-=i-(h-e)+15),o=u?0:r,f=this.getPageTop(s)+(c-o),f=f>this.documentHelper.viewerContainer.scrollTop?f:f+n.height+o,new d(e,f)},n.prototype.createPasteElement=function(n,t){if(!this.pasteElement){var i=this.documentHelper.viewerContainer.getElementsByClassName("e-de-paste")[0];this.pasteElement=i.parentElement.parentElement}this.pasteElement.style.display="block";this.pasteElement.style.position="absolute";this.pasteElement.style.left=t;this.pasteElement.style.top=n;this.pasteElement.style.zIndex="2000"},n.prototype.showToolTip=function(){},n.prototype.hideToolTip=function(){this.toolTipField=void 0;this.toolTipElement&&(this.toolTipElement.style.display="none")},n.prototype.getHyperLinkFieldInCurrentSelection=function(n,t,i){var o=void 0,a=this.getTop(n),h=this.getLineStartLeft(n),f,l,r,e,u,c,s;if(!(t.y<a||t.y>a+n.height||t.x<h||t.x>h+n.paragraph.width))if(f=n.paragraph.x,l=this.getFirstElement(n,f),f=l.left,r=l.element,sf.base.isNullOrUndefined(r)){if(e=this.documentHelper.textHelper.getParagraphMarkWidth(n.paragraph.characterFormat),t.x<=h+e||t.x>=h+e)return u=[],c=this.getHyperLinkFields(n.paragraph,u,!1,i),u=[],u=void 0,c}else{if(t.x>f+r.margin.left)for(s=n.children.indexOf(r);s<n.children.length&&(r=n.children[s],!(t.x<f+r.margin.left+r.width||s===n.children.length-1));s++)f+=r.margin.left+r.width;if(o=r,e=r.margin.left+r.width,sf.base.isNullOrUndefined(o.nextNode)&&(e+=this.documentHelper.textHelper.getParagraphMarkWidth(o.line.paragraph.characterFormat)),t.x<=f+e)return u=[],c=this.getHyperLinkFieldInternal(o.line.paragraph,o,u,!1,i),u=[],u=void 0,c}},n.prototype.getFootNoteElementInCurrentSelection=function(n,t){var h=void 0,c=this.getTop(n),e=this.getLineStartLeft(n),r,o,i,u,s,f;if(!(t.y<c||t.y>c+n.height||t.x<e||t.x>e+n.paragraph.width))if(r=n.paragraph.x,o=this.getFirstElement(n,r),r=o.left,i=o.element,sf.base.isNullOrUndefined(i)){if(u=this.documentHelper.textHelper.getParagraphMarkWidth(n.paragraph.characterFormat),t.x<=e+u||t.x>=e+u)return s=this.documentHelper.selection.start.currentWidget.getInline(this.documentHelper.selection.start.offset,0).element,_instanceof(s,yt)?s:void 0}else{if(t.x>r+i.margin.left)for(f=n.children.indexOf(i);f<n.children.length&&(i=n.children[f],!(t.x<r+i.margin.left+i.width||f===n.children.length-1));f++)r+=i.margin.left+i.width;if(_instanceof(i,yt)&&(h=i),u=i.margin.left+i.width,sf.base.isNullOrUndefined(i.nextNode)&&(u+=this.documentHelper.textHelper.getParagraphMarkWidth(i.line.paragraph.characterFormat)),t.x<=r+u)return h}},n.prototype.getHyperlinkField=function(n){var f,c;if(!sf.base.isNullOrUndefined(this.end)){var s=0,i=this.documentHelper.selection,h=(i.start,i.end);i.isForward||(i.end,h=i.start);f=this.end.currentWidget.getInline(h.offset,s);s=f.index;var t=f.element,o=[],u=void 0;return sf.base.isNullOrUndefined(t)?u=this.getHyperLinkFields(this.end.paragraph,o,n):this.documentHelper.isFormFillProtectedMode&&_instanceof(t,e)&&_instanceof(t.previousNode,r)&&1===t.previousNode.fieldType?u=void 0:(c=t.line.paragraph,u=this.getHyperLinkFieldInternal(c,t,o,n,!1)),o=[],u}},n.prototype.getHyperLinkFields=function(n,t,i,r){for(var f,e,u=0;u<this.documentHelper.fields.length;u++)if(-1===t.indexOf(this.documentHelper.fields[u])&&!sf.base.isNullOrUndefined(this.documentHelper.fields[u].fieldSeparator)&&((t.push(this.documentHelper.fields[u]),f=this.getFieldCode(this.documentHelper.fields[u]),f=f.trim().toLowerCase(),e=this.paragraphIsInFieldResult(this.documentHelper.fields[u],n),(i||!i&&f.match("hyperlink "))&&e)||e&&r&&this.documentHelper.fields[u].formFieldData||(i||!i&&f.match("ref "))&&e))return this.documentHelper.fields[u]},n.prototype.getHyperLinkFieldInternal=function(n,t,i,r,u){for(var s,o,l,h,f=0;f<this.documentHelper.fields.length;f++)if(-1===i.indexOf(this.documentHelper.fields[f])&&!sf.base.isNullOrUndefined(this.documentHelper.fields[f].fieldSeparator)&&((i.push(this.documentHelper.fields[f]),s=this.getFieldCode(this.documentHelper.fields[f]),s=s.trim().toLowerCase(),o=this.documentHelper.fields[f],l=o.fieldEnd,r&&_instanceof(o.nextNode,e)&&(l=o.nextNode.reference),h=this.inlineIsInFieldResult(o,l,o.fieldSeparator,t,r)||this.isImageField(),(r||!r&&s.match("hyperlink "))&&h)||h&&u&&this.documentHelper.fields[f].formFieldData||(r||!r&&s.match("ref "))&&h))return this.documentHelper.fields[f];if(_instanceof(n.containerWidget,c)&&!_instanceof(n,ct))return this.getHyperLinkFieldInternal(n.containerWidget,t,i,r,u)},n.prototype.getBlock=function(n){var r;if(""!==n&&!sf.base.isNullOrUndefined(n)){var t={index:n},u=this.start.getPage(t),i=t.index.indexOf(";"),f=t.index.substring(0,i);return t.index=t.index.substring(i).replace(";",""),r=u.bodyWidgets[parseInt(f,10)],this.getBlockInternal(r,t.index)}},n.prototype.getBlockInternal=function(n,t){var i,e,f,r;if(""!==t&&!sf.base.isNullOrUndefined(t))return(i=t.indexOf(";"),e=t.substring(0,i),t=t.substring(i).replace(";",""),f=n,!((i=parseInt(e,10))>=0&&i<n.childWidgets.length))?f:(r=n.childWidgets[i],t.indexOf(";")>=0?_instanceof(r,u)?(t.indexOf(";")>=0&&(t="0"),r):_instanceof(r,wt)?this.getBlockInternal(r,t):f:r)},n.prototype.inlineIsInFieldResult=function(n,t,i,r,u){return!(sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(i)||!this.isExistBeforeInline(i,r))&&this.isExistAfterInline(t,r,u)},n.prototype.paragraphIsInFieldResult=function(n,t){if(!sf.base.isNullOrUndefined(n.fieldEnd)&&!sf.base.isNullOrUndefined(n.fieldSeparator)){var i=n.fieldSeparator.line.paragraph;if(n.fieldSeparator.line.paragraph===t||this.isExistBefore(i,t))return n.fieldEnd.line.paragraph!==t&&this.isExistAfter(i,t)}return!1},n.prototype.isImageField=function(){var i,u,e,o;if(this.start.paragraph.isEmpty()||this.end.paragraph.isEmpty())return!1;i=this.start;u=this.end;this.isForward||(i=this.end,u=this.start);var t=0,f=i.paragraph.getInline(i.offset,t),n=f.element;return((t=f.index)===n.length&&(n=this.getNextRenderedElementBox(n,t)),e=(f=u.paragraph.getInline(u.offset,t)).element,(t=f.index,_instanceof(n,r)&&0===n.fieldType&&_instanceof(e,r)&&1===e.fieldType&&n.fieldSeparator)&&(o=n.fieldSeparator.nextNode,_instanceof(o,v)&&o.nextNode===e))?!0:!1},n.prototype.isFormField=function(){var n=this.getCurrentFormField();return!!(_instanceof(n,r)&&n.formFieldData)},n.prototype.isReferenceField=function(n){if(sf.base.isNullOrUndefined(n)&&(n=this.getHyperlinkField(!0)),n){var t=this.getFieldCode(n);if(t=t.toLowerCase(),_instanceof(n,r)&&t.match("ref "))return!0}return!1},n.prototype.isInlineFormFillMode=function(n){return!!(this.documentHelper.isInlineFormFillProtectedMode&&(sf.base.isNullOrUndefined(n)&&(n=this.getCurrentFormField()),n&&_instanceof(n.formFieldData,vt)&&"Text"===n.formFieldData.type))},n.prototype.getFormFieldType=function(n){if(sf.base.isNullOrUndefined(n)&&(n=this.getCurrentFormField()),_instanceof(n,r)){if(_instanceof(n.formFieldData,vt))return"Text";if(_instanceof(n.formFieldData,bt))return"CheckBox";if(_instanceof(n.formFieldData,kt))return"DropDown"}},n.prototype.getCurrentFormField=function(n){var u,f,i,e,o,s,h,c,a;if(n||this.documentHelper.isFormFillProtectedMode&&this.owner.documentEditorSettings.formFieldSettings&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode){for(f=0;f<this.documentHelper.formFields.length;f++)if(i=this.documentHelper.formFields[f],t.isLinkedFieldCharacter(i)&&(e=i.fieldSeparator.line.getOffset(i.fieldSeparator,1),o=new l(this.owner),o.setPositionParagraph(i.fieldSeparator.line,e),s=i.fieldEnd,e=s.line.getOffset(s,0),h=new l(this.owner),h.setPositionParagraph(s.line,e),c=this.start,a=this.end,this.isForward||(c=this.end,a=this.start),(c.isExistAfter(o)||c.isAtSamePosition(o))&&(a.isExistBefore(h)||a.isAtSamePosition(h)))){u=i;break}}else u=this.getHyperlinkField(!0);if(_instanceof(u,r)&&0===u.fieldType&&!sf.base.isNullOrUndefined(u.formFieldData))return u},n.prototype.getCurrentTextFrame=function(){var n=this.start.paragraph.containerWidget;do{if(_instanceof(n,et))return n;n&&(n=n.containerWidget)}while(n);return null},n.prototype.isTableSelected=function(){var n=this.start,t=this.end;if(this.isForward||(n=this.end,t=this.start),sf.base.isNullOrUndefined(n.paragraph.associatedCell)||sf.base.isNullOrUndefined(t.paragraph.associatedCell))return!1;var i=n.paragraph.associatedCell.ownerTable.getSplitWidgets(),u=this.getFirstBlockInFirstCell(i[0]),r=this.getLastBlockInLastCell(i[i.length-1]);return n.paragraph.associatedCell.equals(u.associatedCell)&&t.paragraph.associatedCell.equals(r.associatedCell)&&(!u.associatedCell.equals(r.associatedCell)||0===n.offset&&t.offset===this.getLineLength(r.lastChild)+1)},n.prototype.selectListText=function(){var n=this.documentHelper.selectionLineWidget.getHierarchicalIndex("0"),t=this.getTextPosition(n),i=this.getTextPosition(n);this.isSelectList=!0;this.selectRange(t,i);this.isSelectList=!1;this.highlightListText(this.documentHelper.selectionLineWidget);this.contextTypeInternal="List"},n.prototype.highlightListText=function(n){var t=n.children[0].width,i=this.documentHelper.getLeftValue(n),r=n.paragraph.y;this.createHighlightBorder(n,t,i,r,!1);this.documentHelper.isListTextSelected=!0},n.prototype.updateImageSize=function(n){var u,r,f,o,s,h,c;this.owner.isShiftingEnabled=!0;u=this.start;r=this.end;this.isForward||(u=this.end,r=this.start);var t=null,e=0,i=u.paragraph;i===r.paragraph&&u.offset+1===r.offset&&(f=i.getInline(r.offset,e),t=f.element,e=f.index);(_instanceof(t,v)||_instanceof(t,nt))&&(o=t.width,s=t.height,(t.width=n.width,t.height=n.height,n.width=o,n.height=s,null!==i&&null!==i.containerWidget&&this.owner.editorModule)&&(h=i.childWidgets.indexOf(t.line),c=t.line.children.indexOf(t),this.documentHelper.layout.reLayoutParagraph(i,h,c),this.highlightSelection(!1)))},n.prototype.getSelectedCellsInTable=function(n,t,i){for(var r,u,f,h=t.columnIndex,c=i.columnIndex+i.cellFormat.columnSpan-1,l=t.ownerRow.index,o=i.ownerRow.index,s=[],e=0;e<n.childWidgets.length;e++){if(r=n.childWidgets[e],r.index>=l&&r.index<=o)for(u=0;u<r.childWidgets.length;u++)f=r.childWidgets[u],f.columnIndex>=h&&f.columnIndex<=c&&s.push(f);if(r.index>o)break}return s},n.prototype.copy=function(){this.isEmpty||this.copySelectedContent(!1)},n.prototype.copySelectedContent=function(n){sf.base.isNullOrUndefined(this.owner.sfdtExportModule)||(this.copyToClipboard(this.getHtmlContent()),n&&this.owner.editorModule&&this.owner.editorModule.handleCut(this),this.documentHelper.updateFocus())},n.prototype.writeSfdt=function(){var n=this.start,t=this.end;return this.isForward||(n=this.end,t=this.start),this.owner.sfdtExportModule.write(n.currentWidget,n.offset,t.currentWidget,t.offset,!0)},n.prototype.getHtmlContent=function(){var n=this.writeSfdt();return this.owner.editorModule&&(this.owner.editorModule.copiedData=JSON.stringify(n)),this.htmlWriter.writeHtml(n)},n.prototype.copyToClipboard=function(n){var t,i,r;window.getSelection().removeAllRanges();t=document.createElement("div");t.style.left="-10000px";t.style.top="-10000px";t.style.position="relative";t.innerHTML=n;this.htmlWriter.isMergeField&&(t.innerText="",this.htmlWriter.isMergeField=!1);document.body.appendChild(t);-1!==navigator.userAgent.indexOf("Firefox")&&(t.tabIndex=0,t.focus());i=document.createRange();i.selectNodeContents(t);window.getSelection().addRange(i);r=!1;try{r=document.execCommand("copy")}catch(n){}finally{window.getSelection().removeAllRanges();t.parentNode.removeChild(t)}return r},n.prototype.showCaret=function(){var i=sf.base.isNullOrUndefined(this.documentHelper.currentPage)?this.documentHelper.currentRenderingPage:this.documentHelper.currentPage,t,n,r;if(!(sf.base.isNullOrUndefined(i)||this.documentHelper.isRowOrCellResizing||this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize))if(n=i.boundingRectangle.x,(t=_instanceof(this.viewer,rt)?i.boundingRectangle.width*this.documentHelper.zoomFactor+n:i.boundingRectangle.width-this.owner.viewer.padding.right-this.documentHelper.scrollbarWidth,this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize)||(this.isHideSelection(this.start.paragraph)?this.caret.style.display="none":this.isEmpty&&(!this.owner.isReadOnlyMode||this.owner.enableCursorOnReadOnly||this.isInlineFormFillMode())?(r=parseInt(this.caret.style.left.replace("px",""),10),this.caret.style.display=r<n||r>t?"none":"block"):this.isImageSelected&&!this.owner.enableImageResizerMode?this.caret.style.display="block":("block"===this.caret.style.display||sf.base.isNullOrUndefined(this))&&(this.documentHelper.isComposingIME||(this.caret.style.display="none"))),sf.base.isNullOrUndefined(this)||!this.documentHelper.isTouchInput||this.owner.isReadOnlyMode)this.documentHelper.touchStart.style.display="none",this.documentHelper.touchEnd.style.display="none";else{var f=parseInt(this.documentHelper.touchStart.style.left.replace("px",""),10)+14,e=parseInt(this.documentHelper.touchEnd.style.left.replace("px",""),10)+14,u=this.getSelectionPage(this.start);u&&(this.documentHelper.touchEnd.style.display=e<n||e>t?"none":"block",this.isEmpty||(n=u.boundingRectangle.x,t=u.boundingRectangle.width*this.documentHelper.zoomFactor+n),this.documentHelper.touchStart.style.display=f<n||f>t?"none":"block")}},n.prototype.setEditableDivCaretPosition=function(n){var i,t;this.documentHelper.editableDiv.focus();i=this.documentHelper.editableDiv.childNodes[this.documentHelper.editableDiv.childNodes.length-1];i&&(t=document.createRange(),t.setStart(i,n),t.collapse(!0),window.getSelection().removeAllRanges(),window.getSelection().addRange(t))},n.prototype.initCaret=function(){this.caret=sf.base.createElement("div",{styles:"position:absolute",className:"e-de-blink-cursor e-de-cursor-animation"});this.owner.documentHelper.viewerContainer.appendChild(this.caret)},n.prototype.updateCaretPosition=function(){var t=this.end.location,n=this.getSelectionPage(this.end);if(n&&!sf.base.isNullOrUndefined(this.caret)){this.caret.style.left=n.boundingRectangle.x+Math.round(t.x)*this.documentHelper.zoomFactor+"px";var i=this.updateCaretSize(this.owner.selection.end),f=i.topMargin,u=this.viewer,r=(n.boundingRectangle.y-u.pageGap*(this.documentHelper.pages.indexOf(n)+1))*this.documentHelper.zoomFactor+u.pageGap*(this.documentHelper.pages.indexOf(n)+1);this.caret.style.top=r+Math.round(t.y+f)*this.documentHelper.zoomFactor+"px";"Subscript"===this.owner.selection.characterFormat.baselineAlignment&&(this.caret.style.top=parseFloat(this.caret.style.top)+parseFloat(this.caret.style.height)/2+"px");(this.documentHelper.isTouchInput||"none"!==this.documentHelper.touchStart.style.display)&&(this.documentHelper.touchStart.style.left=n.boundingRectangle.x+(Math.round(t.x)*this.documentHelper.zoomFactor-14)+"px",this.documentHelper.touchStart.style.top=r+(t.y+i.height)*this.documentHelper.zoomFactor+"px",this.documentHelper.touchEnd.style.left=n.boundingRectangle.x+(Math.round(t.x)*this.documentHelper.zoomFactor-14)+"px",this.documentHelper.touchEnd.style.top=r+(t.y+i.height)*this.documentHelper.zoomFactor+"px")}this.showHidePasteOptions(this.caret.style.top,this.caret.style.left)},n.prototype.showHidePasteOptions=function(n,t){if(!sf.base.Browser.isIE)if(this.isViewPasteOptions){if(this.pasteElement&&"block"===this.pasteElement.style.display)return;this.createPasteElement(n,t)}else this.pasteElement&&(this.pasteElement.style.display="none")},n.prototype.getRect=function(n){var r=n.location,t=this.getSelectionPage(n);if(t){var i=this.owner.documentHelper,f=t.boundingRectangle.x+Math.round(r.x)*i.zoomFactor,u=this.viewer.pageGap,e=(t.boundingRectangle.y-u*(t.index+1))*i.zoomFactor+u*(t.index+1)+Math.round(r.y)*i.zoomFactor;return new d(f,e)}return new d(0,0)},n.prototype.getSelectionPage=function(n){var t=this.getLineWidgetInternal(n.currentWidget,n.offset,!0);if(t)return this.getPage(t.paragraph)},n.prototype.updateCaretSize=function(n,t){var c,i=0,f=!1,e=0,r=0,s,h,u;if(this.characterFormat.italic&&(f=this.characterFormat.italic),n.paragraph.isEmpty()){var a=n.paragraph,l=0,o=this.getParagraphMarkSize(a,i,l);i=o.topMargin;l=o.bottomMargin;s=o.height;r=i<0?i+s:s;t||(this.caret.style.height=r*this.documentHelper.zoomFactor+"px");i=0}else h=n.currentWidget.getInline(n.offset,e),e=h.index,u=h.element,sf.base.isNullOrUndefined(u)||(r=(c=this.getCaretHeight(u,e,u.characterFormat,!0,i,f)).height,t||(this.caret.style.height=c.height*this.documentHelper.zoomFactor+"px"));return t||(this.caret.style.transform=f?"rotate(13deg)":""),{topMargin:i,height:r}},n.prototype.updateCaretToPage=function(n,t){if(!sf.base.isNullOrUndefined(t))if(this.documentHelper.selectionEndPage=t,this.owner.selection.isEmpty)this.documentHelper.selectionStartPage=t;else{var r=this.getLineWidgetParagraph(n.offset,n.paragraph.childWidgets[0]),i=this.getPage(r.paragraph);sf.base.isNullOrUndefined(i)||(this.documentHelper.selectionStartPage=i)}this.checkForCursorVisibility()},n.prototype.getCaretBottom=function(n,i){var r=n.location.y,h,f;if(n.paragraph.isEmpty()){var a=n.paragraph,u=0,e=0,o=this.getParagraphMarkSize(a,u,e);u=o.topMargin;e=o.bottomMargin;r+=o.height;r+=u;i||(r+=e)}else{var s=0,c=n.paragraph.getInline(n.offset,s),l=c.element;s=c.index;u=0;h=!1;f=this.getCaretHeight(l,s,l.characterFormat,!1,u,h);u=f.topMargin;h=f.isItalic;r+=f.height;i&&(r-=t.convertPointToPixel(this.documentHelper.layout.getAfterSpacing(n.paragraph)))}return r},n.prototype.checkForCursorVisibility=function(){this.showCaret()},n.prototype.onKeyDownInternal=function(n,t,i,r){var f=n.which||n.keyCode,u;if(!t||i||r)if(!i||t||r)if(i&&t&&!r)switch(f){case 35:this.handleControlShiftEndKey();break;case 36:this.handleControlShiftHomeKey();break;case 37:this.handleControlShiftLeftKey();break;case 38:this.handleControlShiftUpKey();break;case 39:this.handleControlShiftRightKey();break;case 40:this.handleControlShiftDownKey()}else switch(f){case 33:n.preventDefault();this.documentHelper.viewerContainer.scrollTop-=this.documentHelper.visibleBounds.height;break;case 34:n.preventDefault();this.documentHelper.viewerContainer.scrollTop+=this.documentHelper.visibleBounds.height;break;case 35:this.handleEndKey();n.preventDefault();break;case 36:this.handleHomeKey();n.preventDefault();break;case 37:this.handleLeftKey();n.preventDefault();break;case 38:this.handleUpKey();n.preventDefault();break;case 39:this.handleRightKey();n.preventDefault();break;case 40:this.handleDownKey();n.preventDefault()}else switch(f){case 35:this.handleShiftEndKey();n.preventDefault();break;case 36:this.handleShiftHomeKey();n.preventDefault();break;case 37:this.handleShiftLeftKey();n.preventDefault();break;case 38:this.handleShiftUpKey();n.preventDefault();break;case 39:this.handleShiftRightKey();n.preventDefault();break;case 40:this.handleShiftDownKey();n.preventDefault()}else switch(this.documentHelper.isControlPressed=!0,f){case 35:this.handleControlEndKey();break;case 36:this.handleControlHomeKey();break;case 37:this.handleControlLeftKey();break;case 38:this.handleControlUpKey();break;case 39:this.handleControlRightKey();break;case 40:this.handleControlDownKey();break;case 65:this.owner.selection.selectAll();break;case 67:n.preventDefault();this.copy();break;case 70:n.preventDefault();this.owner.showDialog("FindPane")}if(this.isFormField()&&!this.documentHelper.isDocumentProtected&&(u=this.getCurrentFormField(!0),u&&_instanceof(u.formFieldData,kt))){u=37===n.keyCode||38===n.keyCode||40===n.keyCode?u:_instanceof(u.nextElement,e)?u.nextElement.reference:u.fieldEnd;var o=39===n.keyCode?1:0,s=u.line.getOffset(u,o),h=this.getPhysicalPositionInternal(u.line,s,!1);this.selectInternal(u.line,u,o,h)}!this.owner.isReadOnlyMode||this.isInlineFormFillMode()?this.owner.editorModule.onKeyDownInternal(n,t,i,r):this.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.documentHelper.protectionType&&(9!==n.keyCode&&32!==n.keyCode||this.owner.editorModule.onKeyDownInternal(n,t,i,r));this.owner.searchModule&&!sf.base.isNullOrUndefined(this.owner.searchModule.searchHighlighters)&&this.owner.searchModule.searchHighlighters.length>0&&this.owner.searchModule.searchResults.clear();27!==n.keyCode&&27!==n.which||(sf.base.isNullOrUndefined(this.owner.optionsPaneModule),this.owner.enableHeaderAndFooter&&this.disableHeaderFooter())},n.prototype.checkAndEnableHeaderFooter=function(n,t){var i=this.documentHelper.currentPage;if(this.isCursorInsidePageRect(n,i)){if(this.isCursorInHeaderRegion(n,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.headerWidget);if(this.isCursorInFooterRegion(n,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.footerWidget)}return!!this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1,this.documentHelper.updateTextPositionForSelection(t,1),!0)},n.prototype.isCursorInsidePageRect=function(n,t){return this.viewer.containerLeft+n.x>=t.boundingRectangle.x&&this.viewer.containerLeft+n.x<=t.boundingRectangle.x+t.boundingRectangle.width*this.documentHelper.zoomFactor&&_instanceof(this.viewer,rt)||this.viewer.containerLeft+n.x>=t.boundingRectangle.x&&this.viewer.containerLeft+n.x<=t.boundingRectangle.x+t.boundingRectangle.width},n.prototype.isCursorInHeaderRegion=function(n,i){if(_instanceof(this.viewer,rt)){var u=this.getPageTop(i),f=0,r=i.headerWidget;r&&(f=r.y+r.height);var s=r.isEmpty&&!this.owner.enableHeaderAndFooter,e=t.convertPointToPixel(i.bodyWidgets[0].sectionFormat.topMargin),h=t.convertPointToPixel(i.bodyWidgets[0].sectionFormat.pageHeight),o=s?e:Math.min(Math.max(f,e),h/100*40);if(o*=this.documentHelper.zoomFactor,this.viewer.containerTop+n.y>=u&&this.viewer.containerTop+n.y<=u+o)return!0}return!1},n.prototype.isCursorInFooterRegion=function(n,i){if(_instanceof(this.viewer,rt)){var u=i.boundingRectangle,f=this.getPageTop(i),s=f+u.height*this.documentHelper.zoomFactor,h=t.convertPointToPixel(i.bodyWidgets[0].sectionFormat.footerDistance),e=0;i.footerWidget&&(e=i.footerWidget.height);var o=t.convertPointToPixel(i.bodyWidgets[0].sectionFormat.bottomMargin),c=i.footerWidget.isEmpty&&!this.owner.enableHeaderAndFooter,r=u.height;if(r=c?(r-o)*this.documentHelper.zoomFactor:(r-Math.min(u.height/100*40,Math.max(e+h,o)))*this.documentHelper.zoomFactor,this.viewer.containerTop+n.y<=s&&this.viewer.containerTop+n.y>=f+r)return!0}return!1},n.prototype.enableHeadersFootersRegion=function(n){return _instanceof(this.viewer,rt)&&(this.owner.enableHeaderAndFooter=!0,this.updateTextPositionForBlockContainer(n),this.shiftBlockOnHeaderFooterEnableDisable(),!0)},n.prototype.shiftBlockOnHeaderFooterEnableDisable=function(){for(var i,n=0;n<this.documentHelper.headersFooters.length;n++)for(var r=this.documentHelper.headersFooters[n],f=this.getBodyWidgetInternal(n,0).sectionFormat,t=0,u=Object.keys(r);t<u.length;t++)i=r[u[t]],i.isEmpty&&this.owner.editor.shiftPageContent(i.headerFooterType,f)},n.prototype.updateTextPositionForBlockContainer=function(n){var t=n.firstChild;_instanceof(t,f)&&_instanceof(t=this.getFirstBlockInFirstCell(t),f)&&(t=this.getFirstBlockInFirstCell(t));this.selectParagraphInternal(t,!0)},n.prototype.disableHeaderFooter=function(){var n=this.getPage(this.start.paragraph);this.updateTextPositionForBlockContainer(n.bodyWidgets[0]);this.owner.enableHeaderAndFooter=!1;this.shiftBlockOnHeaderFooterEnableDisable()},n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.contextTypeInternal)||(this.contextTypeInternal=void 0);this.caret=void 0;this.contextTypeInternal=void 0;this.upDownSelectionLength=void 0;this.owner=void 0},n.prototype.navigateBookmark=function(n,t){var f=this.documentHelper.bookmarks;if(f.containsKey(n)){var i=f.get(n),o=i.line.getOffset(i,0),r=new l(this.owner);if(r.setPositionParagraph(i.line,o),t)this.documentHelper.selection.selectRange(r,r);else{var u=i.reference,s=u.line.getOffset(u,1),e=new l(this.owner);e.setPositionParagraph(u.line,s);this.documentHelper.selection.selectRange(r,e)}}},n.prototype.selectBookmark=function(n){this.navigateBookmark(n)},n.prototype.getTocField=function(){for(var i,n=this.start.paragraph,t=void 0;void 0!==n&&this.isTocStyle(n);)t=n,n=n.previousRenderedWidget;if(void 0!==t&&(i=t.childWidgets[0],void 0!==i))return i.children[0]},n.prototype.isTocStyle=function(n){var t=n.paragraphFormat.baseStyle;return void 0!==t&&-1!==t.name.toLowerCase().indexOf("toc")},n.prototype.isTOC=function(){for(var i,u,t=this.getParagraphInfo(this.start).paragraph,n=0;n<t.childWidgets[0].children.length;n++)if(i=t.childWidgets[0].children[n],_instanceof(i,r)&&(u=this.owner.selection.getFieldCode(i),u.match("TOC ")||u.match("Toc")))return!0;return!1},n.prototype.getElementsForward=function(n,t,i,r){var e,u,f,o;if(!sf.base.isNullOrUndefined(t)){for(e=[];r&&t&&t!==i&&t.nextElement&&!t.isRightToLeft;)t=t.nextElement;for(;r&&i&&t!==i&&i.previousElement&&!i.isRightToLeft;)i=i.previousElement;for(u=n.children.indexOf(t);u>=0;){for(f=u;f>-1&&f<n.children.length;r?f--:f++){if(o=n.children[f],o.line!==n){u=-1;break}if(o===i){e.push(o);u=-1;break}e.push(o)}u=-1}return 0===e.length?void 0:e}},n.prototype.getElementsBackward=function(n,t,r,u){for(var e,f,s,o=[];u&&t&&t.previousElement&&(!t.isRightToLeft||_instanceof(t,i)&&this.documentHelper.textHelper.isRTLText(t.text));)t=t.previousElement;for(e=n.children.indexOf(t);e>=0;){for(f=e;f>-1&&f<n.children.length;u?f++:f--){if(s=n.children[f],s.line!==n){e=-1;break}o.push(s)}e=-1}return o},n.prototype.navigatePreviousComment=function(){this.commentNavigateInternal(!1)},n.prototype.navigateNextComment=function(){this.commentNavigateInternal(!0)},n.prototype.commentNavigateInternal=function(n){if(!this.documentHelper.currentSelectedComment){if(0===this.documentHelper.comments.length)return;this.documentHelper.currentSelectedComment=this.documentHelper.comments[0]}if(this.documentHelper.currentSelectedComment){var t=this.documentHelper.comments,i=this.documentHelper.currentSelectedComment,r=t.indexOf(i);i=n?r===t.length-1?t[0]:t[r+1]:0===r?t[t.length-1]:t[r-1];this.documentHelper.currentSelectedComment=i;this.selectComment(i)}},n.prototype.navigatePreviousRevision=function(){this.revisionNavigateInternal(!1)},n.prototype.navigateNextRevision=function(){this.revisionNavigateInternal(!0)},n.prototype.revisionNavigateInternal=function(n){if(!this.documentHelper.currentSelectedRevisionInternal){if(0===this.documentHelper.owner.revisions.length)return;this.documentHelper.currentSelectedRevision=this.documentHelper.owner.revisions.get(0)}if(this.documentHelper.currentSelectedRevision){var t=this.documentHelper.owner.revisions.changes,i=this.documentHelper.currentSelectedRevision,r=t.indexOf(i);i=n?r===t.length-1?t[0]:t[r+1]:0===r?t[t.length-1]:t[r-1];this.documentHelper.currentSelectedRevision=i;this.selectRevision(i)}this.owner.trackChangesPane.currentSelectedRevision=this.documentHelper.currentSelectedRevision},n.prototype.selectComment=function(n){if(!sf.base.isNullOrUndefined(n)){var t=this.getElementPosition(n.commentStart).startPosition,i=this.getElementPosition(n.commentEnd).startPosition;this.selectPosition(t,i);this.documentHelper.currentSelectedComment=n;this.owner.dotNetRef.invokeMethodAsync("SetSelectedComment",n.commentId)}},n.prototype.hightlightCommentSelectionMark=function(){if(this.documentHelper.currentSelectedComment){var n=this.getCommentStart(this.documentHelper.currentSelectedComment);n&&!n.commentMark&&n.renderCommentMark();sf.base.classList(n.commentMark,["e-de-cmt-mark-selected"],[])}},n.prototype.updatePreviousCommentMark=function(){if(this.documentHelper.currentSelectedComment){var n=this.getCommentStart(this.documentHelper.currentSelectedComment).commentMark;n&&(sf.base.classList(n,[],["e-de-cmt-mark-selected"]),this.removeSelectionMark("e-de-cmt-mark-selected"))}},n.prototype.removeSelectionMark=function(n){if(this.documentHelper.pageContainer)for(var i=this.documentHelper.pageContainer.getElementsByClassName(n),t=0;t<i.length;t++)sf.base.classList(i[t],[],[n])},n.prototype.getCommentStart=function(n){var t=void 0;return n&&n.commentStart&&(t=n.commentStart),void 0!==t.commentMark&&(t.commentMark.title="Click to see this comment"),this.getFirstCommentInLine(t)},n.prototype.getFirstCommentInLine=function(n){for(var i,t=0;t<n.line.children.length;t++)if(i=n.line.children[t],_instanceof(i,g)&&0===i.commentType)return i;return n},n.prototype.selectRevision=function(n){var i,r,f,t,e,u,h;if(!sf.base.isNullOrUndefined(n)&&n.range.length>0)if(i=n.range[0],r=n.range[n.range.length-1],_instanceof(i,ti)){var o=i.ownerBase,c=o.childWidgets[0],a=o.childWidgets[o.childWidgets.length-1],v=this.getFirstParagraph(c),s=this.getLastParagraph(a);this.start.setPosition(v.firstChild,!0);this.end.setPositionParagraph(s.lastChild,s.lastChild.getEndOffset()+1);this.selectPosition(this.start,this.end)}else i&&r&&(f=new l(this.owner),t=0,_instanceof(i,p)?(t=(e=i.ownerBase).getLength(),f.setPositionParagraph(e.lastChild,t)):(t=i.line.getOffset(i,0),f.setPositionForLineWidget(i.line,t)),u=new l(this.owner),_instanceof(r,p)?(e=r.ownerBase).isEndsWithPageBreak?(this.owner.trackChangesPane.isTrackingPageBreak=!0,u.setPositionParagraph(e.nextRenderedWidget.childWidgets[0],0)):(t=e.getLength(),u.setPositionParagraph(e.lastChild,t+1)):(t=r.line.getOffset(r,0)+r.length,this.isTOC()&&(t+=1),u.setPositionForLineWidget(r.line,t)),h=f.clone(),f.isExistBefore(u)||(f=u,u=h),this.selectPosition(f,u))},n.prototype.updateEditRangeCollection=function(){var t,u,i,r,n;if(this.editRangeCollection.length>0&&(this.editRangeCollection=[]),this.documentHelper.isDocumentProtected){if(this.documentHelper.editRanges.containsKey(this.owner.currentUser))for(t=this.documentHelper.editRanges.get(this.owner.currentUser),n=0;n<t.length;n++)this.editRangeCollection.push(t[n]);if(this.documentHelper.editRanges.containsKey("Everyone"))for(r="Everyone",u=this.documentHelper.editRanges.get(r),n=0;n<u.length;n++)this.editRangeCollection.push(u[n])}else for(i=0;i<this.documentHelper.editRanges.length;i++)for(r=this.documentHelper.editRanges.keys[i],t=this.documentHelper.editRanges.get(r),n=0;n<t.length;n++)this.editRangeCollection.push(t[n])},n.prototype.onHighlight=function(){this.isHighlightEditRegion?this.highlightEditRegion():this.unHighlightEditRegion();this.viewer.renderVisiblePages()},n.prototype.highlightEditRegion=function(){if(this.updateEditRangeCollection(),this.isHighlightEditRegion){this.isHightlightEditRegionInternal=!0;sf.base.isNullOrUndefined(this.editRegionHighlighters)&&(this.editRegionHighlighters=new h);this.editRegionHighlighters.clear();for(var n=0;n<this.editRangeCollection.length;n++)this.highlightEditRegionInternal(this.editRangeCollection[n]);this.isHightlightEditRegionInternal=!1;this.viewer.updateScrollBars()}else this.unHighlightEditRegion()},n.prototype.highlightFormFields=function(){var i,u,n,f,r,e,o;if(sf.base.isNullOrUndefined(this.formFieldHighlighters)&&(this.formFieldHighlighters=new h),this.formFieldHighlighters.clear(),i=this.documentHelper.formFields,!sf.base.isNullOrUndefined(i)&&i.length>0){for(u=0;u<i.length;u++)n=i[u],t.isLinkedFieldCharacter(n)&&(f=n.line.getOffset(n,0),r=new l(this.owner),r.setPositionParagraph(n.line,f),e=n.fieldEnd,f=e.line.getOffset(e,1),o=new l(this.owner),o.setPositionParagraph(e.line,f),this.isHighlightFormFields=!0,this.highlight(r.paragraph,r,o),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,r,o),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0));this.isHighlightFormFields=!1;this.viewer.updateScrollBars()}},n.prototype.unHighlightEditRegion=function(){sf.base.isNullOrUndefined(this.editRegionHighlighters)||(this.editRegionHighlighters.clear(),this.editRegionHighlighters=void 0);this.isHightlightEditRegionInternal=!1},n.prototype.highlightEditRegionInternal=function(n){var t=this.getPosition(n),i=t.startPosition,r=t.endPosition;this.isCurrentUser=!0;this.highlightEditRegions(n,i,r);this.isCurrentUser=!1},n.prototype.showAllEditingRegion=function(){var n;for(0===this.editRangeCollection.length&&this.updateEditRangeCollection(),this.documentHelper.clearSelectionHighlight(),n=0;n<this.editRangeCollection.length;n++){var t=this.editRangeCollection[n],i=this.getPosition(t),r=i.startPosition,u=i.endPosition;this.highlightEditRegions(t,r,u)}},n.prototype.highlightEditRegions=function(n,t,i){var r,f;if(n.line.paragraph.isInsideTable&&(!n.line.paragraph.isInsideTable||n.editRangeEnd.line.paragraph.isInsideTable)){if(r=n.line.paragraph.associatedCell.ownerRow.childWidgets[n.columnFirst],r)for(f=0;f<r.childWidgets.length;f++)_instanceof(r.childWidgets[f],u)&&(this.highlight(r.childWidgets[f],t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0))}else this.highlight(n.line.paragraph,t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)},n.prototype.navigateToNextEditingRegion=function(){for(var n,r,u,f,i=this.getEditRangeStartElement(),t=this.editRangeCollection.length-1;t>=0;t--)for(n=1;n<=t;n++)r=this.getPosition(this.editRangeCollection[n-1]).startPosition,u=this.getPosition(this.editRangeCollection[n]).startPosition,r.isExistAfter(u)&&(f=this.editRangeCollection[n-1],this.editRangeCollection[n-1]=this.editRangeCollection[n],this.editRangeCollection[n]=f);var e=this.editRangeCollection.indexOf(i),s=e<this.editRangeCollection.length-1?this.editRangeCollection[e+1]:this.editRangeCollection[0],o=this.getPosition(s),h=o.startPosition,c=o.endPosition;this.selectRange(h,c)},n.prototype.toggleEditingRegionHighlight=function(){this.isHighlightEditRegion=!this.isHighlightEditRegion},n.prototype.getEditRangeStartElement=function(){for(var n=0;n<this.editRangeCollection.length;n++){var t=this.editRangeCollection[n],i=this.getPosition(t),r=i.startPosition,u=i.endPosition;if((this.start.isExistAfter(r)||this.start.isAtSamePosition(r))&&(this.end.isExistBefore(u)||this.end.isAtSamePosition(u)))return t}},n.prototype.isSelectionInEditRegion=function(){return!!this.documentHelper.isDocumentProtected&&this.checkSelectionIsAtEditRegion()},n.prototype.checkSelectionIsAtEditRegion=function(n,t){for(var i=0;i<this.editRangeCollection.length;i++){var e=this.editRangeCollection[i],r=this.getPosition(e),u=r.startPosition,f=r.endPosition;if(sf.base.isNullOrUndefined(n)&&sf.base.isNullOrUndefined(t)&&(n=this.start,t=this.end,this.isForward||(n=this.end,t=this.start)),(n.isExistAfter(u)||n.isAtSamePosition(u))&&(t.isExistBefore(f)||t.isAtSamePosition(f)))return!0}return!1},n.prototype.getPosition=function(n){var t,i=n.line.getOffset(n,1),u=new l(this.owner),r;return u.setPositionParagraph(n.line,i),_instanceof(n,ht)?t=n.editRangeEnd:(_instanceof(n,w)||_instanceof(n,e))&&(t=n.reference),i=t.line.getOffset(t,1),r=new l(this.owner),r.setPositionParagraph(t.line,i),{startPosition:u,endPosition:r}},n.prototype.checkContentControlLocked=function(n){var e,o,s;for(this.owner.editorModule.isXmlMapped=!1,e=0;e<this.documentHelper.contentControlCollection.length;e++){var t=this.documentHelper.contentControlCollection[e],h=this.getPosition(t),r=h.startPosition,u=h.endPosition,i=this.start,f=this.end;if(this.isForward||(i=this.end,f=this.start),sf.base.isNullOrUndefined(n)){if(o=(r.isExistAfter(i)||r.isAtSamePosition(i))&&(r.isExistBefore(f)||r.isAtSamePosition(f)),s=(u.isExistAfter(i)||u.isAtSamePosition(i))&&(u.isExistBefore(f)||u.isAtSamePosition(f)),o&&s)return!!t.contentControlProperties.lockContentControl;if((o||s)&&!r.isAtSamePosition(i)&&!u.isAtSamePosition(i))return!0}if((i.isExistAfter(r)||i.isAtSamePosition(r))&&(f.isExistBefore(u)||f.isAtSamePosition(u))&&((t.contentControlProperties.xmlMapping&&t.contentControlProperties.xmlMapping.isMapped&&(this.owner.editorModule.isXmlMapped=!0),t.contentControlProperties.lockContents)||sf.base.isNullOrUndefined(n)&&("CheckBox"===t.contentControlProperties.type||"ComboBox"===t.contentControlProperties.type||"DropDownList"===t.contentControlProperties.type||"Date"===t.contentControlProperties.type)))return!0}return!1},n.prototype.getElementPosition=function(n,t){var r=n.line.getOffset(n,t?0:1),i=new l(this.owner);return i.setPositionParagraph(n.line,r),{startPosition:i,endPosition:void 0}},n.prototype.updateRefField=function(n){var o,s,h,f,e,a;if(sf.base.isNullOrUndefined(n)&&(n=this.getHyperlinkField(!0)),!sf.base.isNullOrUndefined(n)){if(!this.isReferenceField(n))return;if(o=this.getFieldCode(n).replace(/\s+/g," "),0===(o=o.trim()).toLowerCase().indexOf("ref")&&(s=o.split(" "),s.length>1&&(h=s[1],this.documentHelper.bookmarks.containsKey(h)))){f=this.start;e=this.end;this.isForward||(f=this.end,e=this.start);var i=this.documentHelper.bookmarks.get(h),t=i.reference,u=i.previousNode;!sf.base.isNullOrUndefined(u)&&_instanceof(u,r)||!_instanceof(t.previousNode,r)||1!==t.previousNode.fieldType||sf.base.isNullOrUndefined(t.previousNode.fieldBegin)||sf.base.isNullOrUndefined(t.previousNode.fieldBegin.formFieldData)?_instanceof(u,r)&&0===u.fieldType&&!sf.base.isNullOrUndefined(u.formFieldData)&&(i=u.fieldSeparator,t=u.fieldEnd):(i=t.previousNode.fieldBegin.fieldSeparator,t=t.previousNode.fieldBegin.fieldEnd);a=i.line.getOffset(i,1);f.setPositionParagraph(i.line,a);e.setPositionParagraph(t.line,t.line.getOffset(t,0));var v=this.owner.sfdtExportModule.write(f.currentWidget,f.offset,e.currentWidget,e.offset,!1,!0),c=n.fieldSeparator,l=n.fieldEnd;f.setPositionParagraph(c.line,c.line.getOffset(c,1));e.setPositionParagraph(l.line,l.line.getOffset(l,0));this.owner.editor.pasteContents(v)}}},n.prototype.footnoteReferenceElement=function(n,t){var r=0,v,u,c,f,l,e,a,o,i,s,h;if(_instanceof(this.getContainerWidget(n.paragraph),it))for(v=this.start.paragraph.footNoteReference,u=0;u<this.documentHelper.pages.length;u++)for(r=0,c=this.documentHelper.pages[u],f=0;f<c.bodyWidgets.length;f++)for(l=c.bodyWidgets[f],e=0;e<l.childWidgets.length;e++)for(a=l.childWidgets[e],o=0;o<a.childWidgets.length;o++)if(i=a.childWidgets[o],r=0,!sf.base.isNullOrUndefined(i.children))for(s=0;s<i.children.length;s++)h=i.children[s],r+=h.length,_instanceof(h,yt)&&h===v&&(n.setPositionParagraph(i,r-1),t.setPositionParagraph(i,r),this.selectRange(n,t))},n}(),we=function(){function n(n){this.wordBefore="\\b";this.wordAfter="\\b";this.isHeader=!1;this.isFooter=!1;this.owner=n;this.documentHelper=this.owner.documentHelper}return n.prototype.find=function(n,t){return this.findNext(n,t,"0;0;0")},n.prototype.findNext=function(n,t,i){"string"==typeof n&&(n=this.stringToRegex(n,t));void 0===i&&(i="0;0;0");this.owner.searchModule.textSearchResults.clearResults();var r=this.owner.searchModule.textSearchResults;return this.findDocument(r,n,!0,t,i),r.length,r.currentSearchResult},n.prototype.stringToRegex=function(n,t){if(n.indexOf("\\")>-1&&(n=n.split("\\").join("\\\\")),n.indexOf("(")>-1||n.indexOf(")")>-1||n.indexOf(".")>-1||n.indexOf("[")>-1||n.indexOf("]")>-1||n.indexOf("$")>-1||n.indexOf("{")>-1||n.indexOf("}")>-1||n.indexOf("*")>-1||n.indexOf("|")>-1||n.indexOf("^")>-1||n.indexOf("?")>-1){for(var r="",i=0;i<n.length;i++)r+="("===n[i]||")"===n[i]||"."===n[i]||"["===n[i]||"]"===n[i]||"$"===n[i]||"{"===n[i]||"}"===n[i]||"*"===n[i]||"|"===n[i]||"^"===n[i]||"?"===n[i]?"\\"+n[i]:n[i];n=r}return"WholeWord"!==t&&"CaseSensitiveWholeWord"!==t||(n=this.wordBefore+n+this.wordAfter),new RegExp(n,"CaseSensitive"===t||"CaseSensitiveWholeWord"===t?"g":"ig")},n.prototype.isPatternEmpty=function(n){var i=this.wordBefore+this.wordAfter,t=n.toString();return 0===t.length||t===i},n.prototype.findAll=function(n,t,i){"string"==typeof n&&(n=this.stringToRegex(n,t));void 0===i&&(i="0;0;0");this.owner.searchModule.textSearchResults.clearResults();var r=this.owner.searchModule.textSearchResults;if(this.findDocument(r,n,!1,t,i),r.length>0&&r.currentIndex<0&&(r.currentIndex=0),!sf.base.isNullOrUndefined(r.currentSearchResult))return this.documentHelper.owner,this.owner.dotNetRef.invokeMethodAsync("SearchResultsChange"),r},n.prototype.getElementInfo=function(n,t,u){for(var f,s,c,l=n,e="",o=new h;;){if(_instanceof(n,i)&&!sf.base.isNullOrUndefined(n.text)&&""!==n.text?(o.add(n,e.length),e+=n===l?n.text.substring(t):n.text):_instanceof(n,r)&&(f=n,sf.base.isNullOrUndefined(f.fieldEnd)||(n=sf.base.isNullOrUndefined(f.fieldSeparator)?f.fieldEnd:f.fieldSeparator)),!sf.base.isNullOrUndefined(n)&&sf.base.isNullOrUndefined(n.nextNode))break;if(!sf.base.isNullOrUndefined(n))if(sf.base.isNullOrUndefined(u)||u)n=n.nextNode;else{if(s=n.line.children,c=n.line.children.length,!(s.indexOf(n)<c-1)){n=void 0;break}n=n.nextNode}}return{elementsWithOffset:o,fullText:e.toString()}},n.prototype.updateMatchedTextLocation=function(n,t,i,r,u,f,e,o){for(var c,p,a,l,v=0;v<n.length;v++)if(c=n[v],p=void 0,sf.base.isNullOrUndefined(o)||!(c.index<o)){for(var h=t.addResult(),k=i.keys,w=0;w<k.length;w++){var s=k[w],y=i.get(s),b=s.length;if((s===u&&(b-=r),sf.base.isNullOrUndefined(h.start)&&c.index<y+b)&&(a=c.index-y,s===u&&(a+=r),l=s.line.getOffset(s,a),h.start=this.getTextPosition(s.line,l.toString()),h.start.location=this.owner.selection.getPhysicalPositionInternal(s.line,l,!0),h.start.setPositionParagraph(s.line,l)),c.index+c[0].length<=y+b){a=c.index+c[0].length-y;s===u&&(a+=r);l=s.line.getOffset(s,a);h.end=this.getTextPosition(s.line,l.toString());h.end.location=this.owner.selection.getPhysicalPositionInternal(s.line,l,!0);h.end.setPositionParagraph(s.line,l);p=!0;break}}if(h.isHeader=this.isHeader,h.isFooter=this.isFooter,f){t.currentIndex=0;break}if(t.currentIndex<0&&!sf.base.isNullOrUndefined(e)&&(e.isExistBefore(h.start)||e.isAtSamePosition(h.start))&&(t.currentIndex=t.indexOf(h)),!sf.base.isNullOrUndefined(o)&&p)break}},n.prototype.findDocument=function(n,t,r,f,e){var c,a,s,y,p,h,v,l,w,b;if(!this.isPatternEmpty(t)){if(void 0===f&&(f="None"),a=void 0,s=void 0,(void 0!==e&&(s=this.owner.selection.end),void 0!==e&&r&&void 0!==s&&void 0!==s.paragraph&&_instanceof(s.paragraph,u))&&(y=0,p=s.currentWidget.getInline(this.owner.selection.start.offset,y),a=p.element,y=p.index,!sf.base.isNullOrUndefined(a))){for(h=void 0,h=this.findInline(a,t,f,y,r,n,s);0===n.length&&!sf.base.isNullOrUndefined(h);){for(;!sf.base.isNullOrUndefined(h)&&0===h.childWidgets.length;)h=this.owner.selection.getNextParagraph(h.containerWidget);if(sf.base.isNullOrUndefined(h))break;if(v=h.childWidgets[0],a=_instanceof(v.children[0],o)?_instanceof(v.children[2],i)?v.children[2]:void 0:v.children[0],sf.base.isNullOrUndefined(a))break;h=this.findInline(a,t,f,0,r,n,s)}if(n.length>0)return}for(c=this.documentHelper.pages[0].bodyWidgets[0];!sf.base.isNullOrUndefined(c)&&0===c.childWidgets.length;)c=c.nextWidget;if(!sf.base.isNullOrUndefined(c)&&0!==c.childWidgets.length){for(this.isHeader=!1,this.isFooter=!1,this.findInlineText(c,t,f,r,n,s),l=0;l<this.documentHelper.pages.length;l++)w=this.documentHelper.pages[l].headerWidget,sf.base.isNullOrUndefined(w)||(this.isHeader=!0,this.isFooter=!1,this.findInlineText(w,t,f,r,n,s));for(l=0;l<this.documentHelper.pages.length;l++)b=this.documentHelper.pages[l].footerWidget,sf.base.isNullOrUndefined(b)||(this.isHeader=!1,this.isFooter=!0,this.findInlineText(b,t,f,r,n,s));r&&!sf.base.isNullOrUndefined(n)&&n.length}}},n.prototype.findInlineText=function(n,t,i,r,u,f){for(var o,e=this.owner.selection.getFirstParagraphBlock(n.childWidgets[0]);!sf.base.isNullOrUndefined(e)&&1===e.childWidgets.length&&0===e.childWidgets[0].children.length;)e=this.owner.selection.getNextParagraphBlock(e);for(;!sf.base.isNullOrUndefined(e)&&e.childWidgets.length>0;){if(o=e.childWidgets[0].children[0],sf.base.isNullOrUndefined(o))break;for(this.findInline(o,t,i,0,r,u,f),e=this.owner.selection.getNextParagraphBlock(e);!sf.base.isNullOrUndefined(e)&&1===e.childWidgets.length&&0===e.childWidgets[0].children.length;)e=this.owner.selection.getNextParagraphBlock(e)}r&&!sf.base.isNullOrUndefined(u)&&u.length},n.prototype.findInline=function(n,t,i,r,u,f,e){for(var o,c=n,s=this.getElementInfo(n,r),l=s.fullText,h=[],a=s.elementsWithOffset;!sf.base.isNullOrUndefined(o=t.exec(l));)h.push(o);if(this.updateMatchedTextLocation(h,f,a,r,c,u,e),!u)return this.owner.selection.getNextParagraphBlock(n.line.paragraph)},n.prototype.getTextPosition=function(n,t){var i=new l(this.owner),r=i.getHierarchicalIndex(n,t);return i.setPositionForCurrentIndex(r),i},n}(),be=function(){function n(n,t){this.leftInternal=0;this.widthInternal=0;this.leftInternal=n;this.widthInternal=t}return Object.defineProperty(n.prototype,"left",{get:function(){return this.leftInternal},set:function(n){this.leftInternal=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.widthInternal},set:function(n){this.widthInternal=n},enumerable:!0,configurable:!0}),n}(),ke=function(){function n(n){this.startIn=void 0;this.endIn=void 0;this.owner=n;this.documentHelper=this.owner.documentHelper}return Object.defineProperty(n.prototype,"start",{get:function(){return this.startIn},set:function(n){this.startIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"end",{get:function(){return this.endIn},set:function(n){this.endIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this.documentHelper.selection.getTextInternal(this.start,this.end,!1)},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){this.start=void 0;this.end=void 0},n}(),yu=function(){function n(n){this.currentIndex=-1;this.owner=n}return Object.defineProperty(n.prototype,"length",{get:function(){return void 0===this.innerList?0:this.innerList.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentSearchResult",{get:function(){if(!(void 0===this.innerList||this.currentIndex<0||this.currentIndex>=this.length))return this.innerList[this.currentIndex]},enumerable:!0,configurable:!0}),n.prototype.addResult=function(){var n=new ke(this.owner);return sf.base.isNullOrUndefined(this.innerList)&&(this.innerList=[]),this.innerList.push(n),n},n.prototype.clearResults=function(){if(this.currentIndex=-1,!sf.base.isNullOrUndefined(this.innerList))for(var n=this.innerList.length-1;n>=0;n--)this.innerList[n].destroy(),this.innerList.splice(n,1)},n.prototype.indexOf=function(n){return sf.base.isNullOrUndefined(this.innerList)?-1:this.innerList.indexOf(n)},n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.innerList)||this.clearResults();this.innerList=void 0},n}(),de=function(){function n(n){this.searchModule=n}return Object.defineProperty(n.prototype,"length",{get:function(){return this.searchModule.textSearchResults.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"index",{get:function(){return this.searchModule.textSearchResults.currentIndex},set:function(n){0===this.length||n<0||n>this.searchModule.textSearchResults.length-1||(this.searchModule.textSearchResults.currentIndex=n,this.navigate())},enumerable:!0,configurable:!0}),n.prototype.getTextSearchResultsOffset=function(){for(var t,i=[],n=0;n<this.searchModule.textSearchResults.innerList.length;n++)t=this.getOffset(this.searchModule.textSearchResults.innerList[n]),i.push(t);return i},n.prototype.getOffset=function(n){var i=n.start,r=n.end,t=this.searchModule.documentHelper.owner.selection.getParagraphInfo(i),u=this.searchModule.documentHelper.owner.selection.getHierarchicalIndex(t.paragraph,t.offset.toString());return t=this.searchModule.documentHelper.owner.selection.getParagraphInfo(r),{startOffset:u,endOffset:this.searchModule.documentHelper.owner.selection.getHierarchicalIndex(t.paragraph,t.offset.toString())}},n.prototype.getModuleName=function(){return"SearchResults"},n.prototype.replace=function(n){-1!==this.index&&this.searchModule.replaceInternal(n)},n.prototype.replaceAll=function(n){-1!==this.index&&this.searchModule.replaceAllInternal(n)},n.prototype.navigate=function(){this.searchModule.navigate(this.searchModule.textSearchResults.currentSearchResult);this.searchModule.highlight(this.searchModule.textSearchResults)},n.prototype.clear=function(){this.searchModule.textSearchResults.clearResults();this.searchModule.clearSearchHighlight();this.searchModule.viewer.renderVisiblePages()},n}(),ge=function(){function n(n){this.searchHighlighters=void 0;this.isHandledOddPageHeader=void 0;this.isHandledEvenPageHeader=void 0;this.isHandledOddPageFooter=void 0;this.isHandledEvenPageFooter=void 0;this.owner=n;this.searchHighlighters=new h;this.textSearch=new we(this.owner);this.textSearchResults=new yu(this.owner);this.searchResultsInternal=new de(this)}return Object.defineProperty(n.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"searchResults",{get:function(){return this.searchResultsInternal},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),n.prototype.getModuleName=function(){return"Search"},n.prototype.find=function(n,t){sf.base.isNullOrUndefined(t)&&(t="None");var i=this.textSearch.find(n,t);sf.base.isNullOrUndefined(i)||this.navigate(i)},n.prototype.findAll=function(n,t){if(!sf.base.isNullOrUndefined(n||""===n)){sf.base.isNullOrUndefined(t)&&(t="None");var i=this.textSearch.findAll(n,t);!sf.base.isNullOrUndefined(i)&&i.length>0&&(this.navigate(i.innerList[i.currentIndex]),this.highlight(i))}},n.prototype.replace=function(n,t,i){var r,f,u;return sf.base.isNullOrUndefined(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||sf.base.isNullOrUndefined(i)?0:(sf.base.isNullOrUndefined(this.viewer)||this.clearSearchHighlight(),this.navigate(t),r=this.documentHelper.selection.start,this.owner.enableTrackChanges&&this.documentHelper.selection.start.currentWidget&&this.documentHelper.selection.end.currentWidget.getInline(this.owner.selection.start.offset,0).element.revisions.length>0&&(this.isRepalceTracking=!0),i.indexOf(t)<0)?0:(this.owner.editorModule.insertTextInternal(n,!0),f=t.end,u=new l(this.viewer.owner),u.setPositionParagraph(f.currentWidget,r.offset-n.length),this.documentHelper.selection.selectRange(r,u),this.viewer.owner,this.owner.dotNetRef.invokeMethodAsync("SearchResultsChange"),1)},n.prototype.replaceInternal=function(n,t){if(""!==n&&!sf.base.isNullOrUndefined(n)){sf.base.isNullOrUndefined(t)&&(t="None");var u=this.textSearchResults.currentSearchResult.text,f=this.viewer.owner.searchModule.textSearch.stringToRegex(u,t),r=this.owner.selection.end.getHierarchicalIndexInternal(),i=this.viewer.owner.searchModule.textSearch.findNext(f,t,r);sf.base.isNullOrUndefined(i)||(this.navigate(i),this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=i,this.replace(n,i,this.textSearchResults),r=this.owner.selection.end.getHierarchicalIndexInternal(),(i=this.textSearch.findNext(u,t,r))&&(this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=i,this.navigate(i)))}},n.prototype.replaceAll=function(n,t){var r,i,u;if(sf.base.isNullOrUndefined(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||sf.base.isNullOrUndefined(t))return 0;for(this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(this.owner.selection,"ReplaceAll"),r=t.length,this.viewer.owner.isLayoutEnabled=!1,i=r-1;i>=0;i--)u=t.innerList[i],this.navigate(t.innerList[i]),this.owner.editorModule.insertTextInternal(n,!0),(u.isHeader||u.isFooter)&&this.documentHelper.layout.updateHeaderFooterToParent(this.documentHelper.selection.start.paragraph.bodyWidget),t.innerList[i].destroy();return this.owner.editorHistory&&!sf.base.isNullOrUndefined(this.owner.editorHistory.currentHistoryInfo)?this.owner.editorHistory.updateComplexHistory():this.owner.editorModule.updateComplexWithoutHistory(2),this.searchResults.clear(),r},n.prototype.replaceAllInternal=function(n,t){sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(t)&&(t="None"),this.textSearchResults.length>0&&(this.navigate(this.textSearchResults.innerList[this.textSearchResults.currentIndex]),this.highlight(this.textSearchResults),this.replaceAll(n,this.textSearchResults)))},n.prototype.navigate=function(n){if(n){var t=n.start,i=n.end;sf.base.isNullOrUndefined(this.owner)||sf.base.isNullOrUndefined(this.owner.selection)||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(t.paragraph)||sf.base.isNullOrUndefined(i.paragraph)||this.owner.selection.selectRange(t,i)}},n.prototype.highlight=function(n){var t,i;for(this.searchHighlighters=new h,t=0;t<n.innerList.length;t++)i=n.innerList[t],this.highlightResult(i);this.viewer.renderVisiblePages()},n.prototype.highlightResult=function(n){this.highlightSearchResult(n.start.paragraph,n.start,n.end)},n.prototype.highlightSearchResult=function(n,t,r){var y=0,p=0,o=null,c=null,it=this.documentHelper.selection.getStartLineWidget(n,t,o,y),u,tt,g,nt,s,v,l,b,h,f,a,k;y=it.index;u=(o=it.element)?o.line:n.childWidgets[0];tt=this.documentHelper.selection.getEndLineWidget(r,c,p);p=tt.index;var d=(c=tt.element)?c.line:r.paragraph.childWidgets[r.paragraph.childWidgets.length-1],w=this.documentHelper.selection.getTop(u),e=this.documentHelper.selection.getLeftInternal(u,o,y);if(sf.base.isNullOrUndefined(u)||u!==d){if(!sf.base.isNullOrUndefined(u)){if(n!==u.paragraph&&(n=u.paragraph),l=this.documentHelper.selection.getWidth(u,!0)-(e-u.paragraph.x),n.bidi||_instanceof(o,i)&&o.isRightToLeft){if(s=0,g=this.documentHelper.selection.getElementsForward(u,o,c,n.bidi),g)for(a=!1,h=0;h<g.length;h++)k=_instanceof(f=g[h],i)?f.length:1,s=this.documentHelper.selection.getLeftInternal(u,f,k),a=!1,e=f===o?this.documentHelper.selection.getLeftInternal(u,f,y):this.documentHelper.selection.getLeftInternal(u,f,0),_instanceof(f,i)&&(a=f.isRightToLeft),l=Math.abs(s-e),this.createHighlightBorder(u,l,a?s:e,w)}else this.createHighlightBorder(u,l,e,w);for(nt=u.paragraph.childWidgets.indexOf(u),h=0;h<n.childWidgets.length;h++){if(n===u.paragraph&&(nt+=1),this.highlightSearchResultParaWidget(n,nt,d,c,p),n===d.paragraph)return;nt=0}}}else if(s=this.documentHelper.selection.getLeftInternal(d,c,p),v=!1,_instanceof(c,i)&&(v=c.isRightToLeft),l=0,l=Math.abs(s-e),!v&&_instanceof(o,i)&&(v=o.isRightToLeft),v||n.bidi)if(b=this.documentHelper.selection.getElementsForward(u,o,c,n.bidi),b&&b.length>1)for(h=0;h<b.length;h++)a=!1,k=_instanceof(f=b[h],i)?f.length:1,f===o?(e=this.documentHelper.selection.getLeftInternal(u,f,y),s=this.documentHelper.selection.getLeftInternal(u,f,k)):f===c?(e=this.documentHelper.selection.getLeftInternal(u,f,0),s=this.documentHelper.selection.getLeftInternal(u,f,p)):(e=this.documentHelper.selection.getLeftInternal(u,f,0),s=this.documentHelper.selection.getLeftInternal(u,f,k)),_instanceof(f,i)&&(a=f.isRightToLeft),l=Math.abs(s-e),this.createHighlightBorder(u,l,a?s:e,w);else this.createHighlightBorder(u,l,v?s:e,w);else this.createHighlightBorder(u,l,e,w)},n.prototype.createHighlightBorder=function(n,t,i,r){var u=this.addSearchHighlightBorder(n),f=this.viewer.owner.selection.getPage(n.paragraph);f.boundingRectangle.y;f.boundingRectangle.x;u.left=Math.ceil(i);r=Math.ceil(r);u.width=Math.floor(t);Math.floor(n.height);this.documentHelper.containerContext},n.prototype.addSearchHighlightBorder=function(n){var t=void 0,i=this.searchHighlighters,r;return i.containsKey(n)?t=i.get(n):(t=[],i.add(n,t)),r=new be(0,0),t.push(r),r},n.prototype.highlightSearchResultParaWidget=function(n,t,r,u,f){for(var e,s,h,p,v,o,w,b,l=0,c=0,y=!1,a=t;a<n.childWidgets.length;a++){if(e=n.childWidgets[a],a===t&&(l=this.documentHelper.selection.getTop(e)),s=this.documentHelper.selection.getLeft(e),_instanceof(u,i)&&(y=u.isRightToLeft),e===r){if(h=0,y||n.bidi){for(p=this.documentHelper.selection.getElementsBackward(e,u,u,n.bidi),v=0;v<p.length;v++)o=p[v],w=!1,(s=this.documentHelper.selection.getLeftInternal(e,o,0),o===u)?h=this.documentHelper.selection.getLeftInternal(e,o,f):(b=_instanceof(o,i)?o.length:1,h=this.documentHelper.selection.getLeftInternal(e,o,b)),_instanceof(o,i)&&(w=o.isRightToLeft),c=Math.abs(h-s),this.createHighlightBorder(e,c,w?h:s,l);return}return h=this.documentHelper.selection.getLeftInternal(r,u,f),c=Math.abs(h-s),void this.createHighlightBorder(e,c,y?h:s,l)}c=this.documentHelper.selection.getWidth(e,!0)-(s-n.x);this.createHighlightBorder(e,c,s,l);l+=e.height}},n.prototype.addSearchResultItems=function(n){sf.base.isNullOrUndefined(n)||""===n||(sf.base.isNullOrUndefined(this.owner.findResultsList)&&(this.owner.findResultsList=[]),this.owner.findResultsList.push(n))},n.prototype.addFindResultView=function(n){for(var i,t=0;t<n.innerList.length;t++)i=n.innerList[t],this.addFindResultViewForSearch(i);this.isHandledOddPageHeader=!0;this.isHandledOddPageFooter=!0;this.isHandledEvenPageHeader=!0;this.isHandledEvenPageFooter=!0},n.prototype.addFindResultViewForSearch=function(n){var u,l,a,v,t,e,w,o,h,c;if(null!=n.start&&null!=n.end&&null!=n.start.paragraph&&null!=n.end.paragraph){var f=void 0,s=0,b=n.start.currentWidget.getInline(n.start.offset,s),p=b.element;if(s=b.index,u="",l=0,_instanceof(p,r)&&(a=this.owner.selection.getRenderedInline(p,s),_instanceof(a.element.nextNode,i)?(p=a.element.nextNode,s=a.index):(p=a.element,s=a.index)),v=this.owner.selection.getElementBoxInternal(p,s),t=v.element,s=v.index,null!=t)for(_instanceof(t,i)&&s>0&&(u=t.text.substring(0,s)),e=t.line.children.indexOf(t),l=u.lastIndexOf(" ");l<0&&e>0&&_instanceof(t.line.children[e-1],i);)u=t.line.children[e-1].text+u,e--,l=u.lastIndexOf(" ");w=u.lastIndexOf("\v");w>0?u=u.substring(0,w):(l=u.lastIndexOf(" "))<0?u:u.substring(l+1);n.text;var y=0,k=n.end.currentWidget.getInline(n.end.offset,y),d=k.element;if(y=k.index,f="",null!=v&&(t=(v=this.owner.selection.getElementBoxInternal(d,y)).element,y=v.index),null!=t)for(_instanceof(t,i)&&y<t.length&&(f=t.text.substring(y)),e=t.line.children.indexOf(t);e+1<t.line.children.length&&_instanceof(t.line.children[e+1],i)||_instanceof(t.line.children[e+1],r);)_instanceof(t.line.children[e+1],r)?e+=2:(f+=t.line.children[e+1].text,e+=1);l=f.lastIndexOf(" ");f="\v"===f?f="":f;o="";n.isHeader?o='<span class="e-de-header-footer-list">Header: <\/span>':n.isFooter?o='<span class="e-de-header-footer-list">Footer: <\/span>':(o="",o="",this.isHandledOddPageHeader=!0,this.isHandledEvenPageHeader=!0,this.isHandledOddPageFooter=!0,this.isHandledEvenPageFooter=!0);h="";c=n.documentHelper.selection.getPage(n.start.paragraph);sf.base.isNullOrUndefined(this.isHandledEvenPageHeader)&&sf.base.isNullOrUndefined(this.isHandledEvenPageFooter)?(this.isHandledEvenPageHeader=!0,this.isHandledEvenPageFooter=!0):sf.base.isNullOrUndefined(this.isHandledOddPageHeader)&&sf.base.isNullOrUndefined(this.isHandledOddPageFooter)&&(this.isHandledOddPageHeader=!0,this.isHandledOddPageFooter=!0);n.isHeader?"FirstPageHeader"===c.headerWidget.headerFooterType&&c.bodyWidgets[0].sectionFormat.differentFirstPage?h='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+o+u+'<span class="e-de-op-search-word" style="pointer-events:none">'+n.text+"<\/span>"+f+"<\/li>":"EvenHeader"===c.headerWidget.headerFooterType&&this.isHandledEvenPageHeader?(h='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+o+u+'<span class="e-de-op-search-word" style="pointer-events:none">'+n.text+"<\/span>"+f+"<\/li>",this.isHandledEvenPageHeader=!1):"OddHeader"===c.headerWidget.headerFooterType&&this.isHandledOddPageHeader&&(h='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+o+u+'<span class="e-de-op-search-word" style="pointer-events:none">'+n.text+"<\/span>"+f+"<\/li>",this.isHandledOddPageHeader=!1):n.isFooter?"FirstPageFooter"===c.footerWidget.headerFooterType&&c.bodyWidgets[0].sectionFormat.differentFirstPage?h='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+o+u+'<span class="e-de-op-search-word" style="pointer-events:none">'+n.text+"<\/span>"+f+"<\/li>":"EvenFooter"===c.footerWidget.headerFooterType&&this.isHandledEvenPageFooter?(h='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+o+u+'<span class="e-de-op-search-word" style="pointer-events:none">'+n.text+"<\/span>"+f+"<\/li>",this.isHandledEvenPageFooter=!1):"OddFooter"===c.footerWidget.headerFooterType&&this.isHandledOddPageFooter&&(h='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+o+u+'<span class="e-de-op-search-word" style="pointer-events:none">'+n.text+"<\/span>"+f+"<\/li>",this.isHandledOddPageFooter=!1):n.isHeader||n.isFooter||(h='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+o+u+'<span class="e-de-op-search-word" style="pointer-events:none">'+n.text+"<\/span>"+f+"<\/li>");this.addSearchResultItems(h)}},n.prototype.clearSearchHighlight=function(){sf.base.isNullOrUndefined(this.searchHighlighters)||(this.searchHighlighters.clear(),this.searchHighlighters=void 0);this.viewer.owner;this.owner.dotNetRef.invokeMethodAsync("SearchResultsChange")},n.prototype.destroy=function(){this.textSearchResults&&this.textSearchResults.destroy()},n}(),no=function(){},ki=function(){function n(n,t){this.ownerListLevelIn=void 0;this.modifiedListLevelIn=void 0;this.ownerListLevel=n;this.modifiedListLevel=t}return Object.defineProperty(n.prototype,"ownerListLevel",{get:function(){return this.ownerListLevelIn},set:function(n){this.ownerListLevelIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"modifiedListLevel",{get:function(){return this.modifiedListLevelIn},set:function(n){this.modifiedListLevelIn=n},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){this.ownerListLevel=void 0;this.modifiedListLevel=void 0},n}(),to=function(){function n(n,t){this.ownerFormatIn=void 0;this.modifiedFormatIn=void 0;this.ownerFormat=n;this.modifiedFormat=t}return Object.defineProperty(n.prototype,"ownerFormat",{get:function(){return this.ownerFormatIn},set:function(n){this.ownerFormatIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"modifiedFormat",{get:function(){return this.modifiedFormatIn},set:function(n){this.modifiedFormatIn=n},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){this.ownerFormat=void 0;this.modifiedFormat.destroy();this.modifiedFormat=void 0},n}(),pu=function(){function n(n,t){this.startingPoint=n;this.rowFormat=t;this.rowHeightType=t.heightType}return n.prototype.revertChanges=function(n,t){var i=this.rowFormat.heightType;t.editorModule.tableResize.updateRowHeight(this.rowFormat.ownerBase,n?this.displacement:-this.displacement);t.documentHelper.layout.reLayoutTable(this.rowFormat.ownerBase.ownerTable);this.rowFormat.heightType!==this.rowHeightType&&(this.rowFormat.heightType=this.rowHeightType);this.rowHeightType=i},n}(),br=function(){function n(n,t){this.tableHolder=new su;this.tableFormat=new io;this.rows=[];this.owner=t;this.copyProperties(n)}return n.prototype.copyProperties=function(n){var f,t,i,e,u,r;for(n.tableHolder&&(this.tableHolder=n.tableHolder.clone()),n.tableFormat&&(this.tableFormat.leftIndent=n.tableFormat.leftIndent,this.tableFormat.preferredWidth=n.tableFormat.preferredWidth,this.tableFormat.preferredWidthType=n.tableFormat.preferredWidthType,this.tableFormat.allowAutoFit=n.tableFormat.allowAutoFit),f=0;f<n.childWidgets.length;f++){for(t=n.childWidgets[f],i=new ro,i.gridBefore=t.rowFormat.gridBefore,i.gridBeforeWidth=t.rowFormat.gridBeforeWidth,i.gridBeforeWidthType=t.rowFormat.gridBeforeWidthType,i.gridAfter=t.rowFormat.gridAfter,i.gridAfterWidth=t.rowFormat.gridAfterWidth,i.gridAfterWidthType=t.rowFormat.gridAfterWidthType,e=0;e<t.childWidgets.length;e++)u=t.childWidgets[e],r=new uo,r.columnIndex=u.columnIndex,r.columnSpan=u.cellFormat.columnSpan,r.preferredWidth=u.cellFormat.preferredWidth,r.preferredWidthType=u.cellFormat.preferredWidthType,i.cells.push(r);this.rows.push(i)}this.tableHierarchicalIndex=this.owner.selection.getHierarchicalIndex(n,"0")},n.prototype.destroy=function(){this.tableHierarchicalIndex=void 0;this.tableHolder&&(this.tableHolder.destroy(),this.tableHolder=void 0);this.tableFormat&&(this.tableFormat=null);this.rows&&(this.rows=[],this.rows=void 0)},n}(),io=function(){},ro=function(){this.cells=[]},uo=function(){},fr=function(){function n(n){this.ownerIn=n;this.documentHelper=n.documentHelper;this.modifiedPropertiesIn=[];this.modifiedNodeLength=[];this.removedNodesIn=[]}return Object.defineProperty(n.prototype,"owner",{get:function(){return this.ownerIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"editorHistory",{get:function(){return this.owner.editorHistory},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"action",{get:function(){return this.actionIn},set:function(n){this.actionIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"modifiedProperties",{get:function(){return this.modifiedPropertiesIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"removedNodes",{get:function(){return this.removedNodesIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionStart",{get:function(){return this.selectionStartIn},set:function(n){this.selectionStartIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionEnd",{get:function(){return this.selectionEndIn},set:function(n){this.selectionEndIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"insertPosition",{get:function(){return this.insertPositionIn},set:function(n){this.insertPositionIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"endPosition",{get:function(){return this.endPositionIn},set:function(n){this.endPositionIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewer",{get:function(){return this.ownerIn.viewer},enumerable:!0,configurable:!0}),n.prototype.updateSelection=function(){var n=this.owner.selection.getParagraphInfo(this.owner.selection.start);this.selectionStart=this.owner.selection.getHierarchicalIndex(n.paragraph,n.offset.toString());n=this.owner.selection.getParagraphInfo(this.owner.selection.end);this.selectionEnd=this.owner.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())},n.prototype.setBookmarkInfo=function(n){this.removedNodes.push({bookmark:n,startIndex:n.indexInOwner,endIndex:n.reference.indexInOwner})},n.prototype.setFormFieldInfo=function(n,t){this.removedNodes.push({formField:n,value:t})},n.prototype.setEditRangeInfo=function(n){this.removedNodes.push({editStart:n,startIndex:n.indexInOwner,endIndex:n.editRangeEnd.indexInOwner})},n.prototype.revertFormTextFormat=function(){var r=this.removedNodes[0],n=r.value,i=r.formField;this.editorHistory.isUndoing?(this.owner.editorModule.applyTextFormatInternal(i,n),this.editorHistory.recordChanges(this)):(n=t.formatText(i.formFieldData.format,n),this.owner.editorModule.applyTextFormatInternal(i,n),this.editorHistory.undoStack.push(this))},n.prototype.revertFormField=function(){var n=this.removedNodes[0],t=n.formField;_instanceof(t.formFieldData,bt)?this.owner.editorModule.toggleCheckBoxFormField(t,!0,n.value):this.owner.editorModule.updateFormField(t,n.value)},n.prototype.revertBookmark=function(){var i=this.removedNodes[0],n=i.bookmark,t;this.editorHistory.isUndoing?(this.documentHelper.bookmarks.add(n.name,n),n.line.children.splice(i.startIndex,0,n),t=n.previousNode,_instanceof(t,r)&&!sf.base.isNullOrUndefined(t.formFieldData)&&(t.formFieldData.name=n.name),n.reference.line.children.splice(i.endIndex,0,n.reference),this.editorHistory.recordChanges(this)):(this.owner.editorModule.deleteBookmarkInternal(n),this.editorHistory.undoStack.push(this))},n.prototype.revertComment=function(){var r=this.insertPosition,n=this.removedNodes[0],t=!1,i;("InsertCommentWidget"===this.action?t=this.editorHistory.isRedoing:"DeleteCommentWidget"===this.action&&(t=this.editorHistory.isUndoing),t)?n&&(n.isReply?this.owner.editor.addReplyComment(n,this.insertPosition):this.owner.editor.addCommentWidget(n,!1,!0,!0)):(i=this.owner.editor.getCommentElementBox(r),this.owner.editor.deleteCommentWidget(i))},n.prototype.revertEditRangeRegion=function(){var t=this.removedNodes[0],n=t.editStart,i;this.editorHistory.isUndoing?(i=""===n.user?n.group:n.user,this.owner.editor.updateRangeCollection(n,i),n.line.children.splice(t.startIndex,0,n),n.editRangeEnd.line.children.splice(t.endIndex,0,n.editRangeEnd),this.editorHistory.recordChanges(this)):(this.owner.editorModule.removeUserRestrictionsInternal(n),this.editorHistory.undoStack.push(this));this.owner.editor.fireContentChange()},n.prototype.revert=function(){var n,r,y,u,a,f,b,k,d,p,v;if("FormTextFormat"!==this.action)if("UpdateFormField"!==this.action)if("DeleteBookmark"!==this.action)if("RemoveEditRange"!==this.action)if("InsertCommentWidget"!==this.action&&"DeleteCommentWidget"!==this.action){if("ListFormat"===this.action&&""!==this.owner.editor.listNumberFormat){var c=this.documentHelper.lists[0].abstractList.levels[this.owner.editor.listLevelNumber],g=c.listLevelPattern,nt=c.numberFormat;c.listLevelPattern=this.owner.editor.listLevelPattern;c.numberFormat=this.owner.editor.listNumberFormat;this.owner.editor.listLevelPattern=g;this.owner.editor.listNumberFormat=nt}this.owner.isShiftingEnabled=!0;var s=void 0,h=void 0,e=this.selectionStart,o=this.selectionEnd,tt=l.isForwardSelection(e,o);if(this.modifiedProperties.length>0||"Selection"===this.action||"ClearCharacterFormat"===this.action||"ClearParagraphFormat"===this.action)s=this.owner.selection.getTextPosBasedOnLogicalIndex(e),h=this.owner.selection.getTextPosBasedOnLogicalIndex(o),this.revertModifiedProperties(s,h);else{n=this.owner.selection;r=this.removedNodes;this.removedNodesIn=[];sf.base.isNullOrUndefined(this.endPosition)&&(this.endPosition=this.insertPosition);var w=l.isForwardSelection(this.insertPosition,this.endPosition),t=n.getTextPosBasedOnLogicalIndex(w?this.insertPosition:this.endPosition),i=n.getTextPosBasedOnLogicalIndex(w?this.endPosition:this.insertPosition);if(this.lastElementRevision&&this.editorHistory.isUndoing&&sf.base.isNullOrUndefined(this.endRevisionLogicalIndex)&&this.updateEndRevisionInfo(),"ClearRevisions"===this.action&&(this.undoRevisionForElements(t,i,r[r.length-1]),r=[]),"Uppercase"===this.action)return n.selectPosition(t,i),this.editorHistory.currentBaseHistoryInfo=this,y=this.owner.editorModule,y.changeSelectedTextCase(n,t,i,this.action.toString(),r),void y.reLayout(n);(t.isAtSamePosition(i)?n.selectContent(t,!0):n.selectPosition(t,i),"InsertHyperlink"===this.action&&this.editorHistory.isRedoing)&&(u=this.owner.selection.getHyperlinkField(),sf.base.isNullOrUndefined(u)||(a=u.line.getOffset(u,0),t.setPositionParagraph(u.line,a),this.owner.selection.start.setPositionInternal(t),a=u.fieldEnd.line.getOffset(u.fieldEnd,1),i.setPositionParagraph(u.fieldEnd.line,a)));this.editorHistory.currentBaseHistoryInfo=this;this.selectionStart=this.insertPosition;this.insertPosition=void 0;this.selectionEnd=this.endPosition;this.endPosition=void 0;f=!1;this.endRevisionLogicalIndex&&r.length>0&&((this.editorHistory.isUndoing||this.editorHistory.isRedoing&&t.isAtSamePosition(i))&&(b=n.getTextPosBasedOnLogicalIndex(this.endRevisionLogicalIndex),n.selectPosition(t,b)),this.editorHistory.isUndoing&&this.owner.editor.deleteSelectedContents(n,!0));t.isAtSamePosition(i)||(f="BackSpace"===this.action||"Delete"===this.action||"ClearCells"===this.action||"DeleteCells"===this.action,k=r.length>0&&"ParaMarkTrack"===this.action||"ClearRevisions"===this.action||"AcceptTOC"===this.action,f||"MergeCells"===this.action||"InsertRowAbove"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"InsertColumnRight"===this.action||"Borders"===this.action||"DeleteTable"===this.action||"DeleteColumn"===this.action||"DeleteRow"===this.action||(n.end.setPositionInternal(i),this.owner.selection.isEmpty||k||(this.editorHistory.isRedoing&&"Accept Change"!==this.action&&"ParaMarkTrack"!==this.action&&"ParaMarkReject"!==this.action&&"RemoveRowTrack"!==this.action?this.owner.editorModule.removeSelectedContents(n):this.owner.editorModule.deleteSelectedContents(n,!0),!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.blockToShift&&this.documentHelper.layout.shiftLayoutedItems(!1))));d=this.editorHistory.isRedoing&&!f;f=!this.lastElementRevision&&f;this.revertModifiedNodes(r,d,tt?e:o,e===o);f&&this.removeContent(t,i)}p=!1;v=!1;sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||"Reject All"!==this.editorHistory.currentHistoryInfo.action&&"Accept All"!==this.editorHistory.currentHistoryInfo.action||(v=!0);(!this.owner.trackChangesPane.isTrackingPageBreak&&((this.editorHistory.isUndoing||this.endRevisionLogicalIndex||"RemoveRowTrack"===this.action||v)&&sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||v)||("InsertRowAbove"===this.action||"Borders"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"InsertColumnRight"===this.action||"Accept Change"===this.action)&&(this.editorHistory.isRedoing||"Paste"===this.editorHistory.currentHistoryInfo.action))&&("RemoveRowTrack"===this.action&&this.editorHistory.isRedoing?(s=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionStart),h=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionEnd)):(s=this.owner.selection.getTextPosBasedOnLogicalIndex(e),h=this.owner.selection.getTextPosBasedOnLogicalIndex(o)),this.owner.selection.selectRange(s,h),p=!0);this.owner.trackChangesPane.isTrackingPageBreak=!1;this.insertPosition=e;this.endPosition=o;sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||"Accept All"!==this.editorHistory.currentHistoryInfo.action&&"Reject All"!==this.editorHistory.currentHistoryInfo.action||this.owner.documentHelper.blockToShift&&this.owner.documentHelper.layout.shiftLayoutedItems(!1);this.owner.editorModule.reLayout(this.owner.selection,this.owner.selection.isEmpty);p&&this.documentHelper.scrollToPosition(this.owner.selection.start,this.owner.selection.end);this.highlightListText()}else this.revertComment();else this.revertEditRangeRegion();else this.revertBookmark();else this.revertFormField();else this.revertFormTextFormat()},n.prototype.highlightListText=function(){if(!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&("ListCharacterFormat"===this.action||"ListSelect"===this.editorHistory.currentHistoryInfo.action&&"ListFormat"===this.action)){var n=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionStart).currentWidget;this.documentHelper.selection.highlightListText(n)}},n.prototype.removeContent=function(n,t){if(!sf.base.isNullOrUndefined(n.paragraph.containerWidget)&&_instanceof(n.paragraph.containerWidget,c)&&!sf.base.isNullOrUndefined(t.paragraph.containerWidget)&&_instanceof(t.paragraph.containerWidget,c)||!sf.base.isNullOrUndefined(n.paragraph.containerWidget)&&!sf.base.isNullOrUndefined(t.paragraph.containerWidget)&&_instanceof(n.paragraph.containerWidget,s)&&_instanceof(t.paragraph.containerWidget,s)&&!sf.base.isNullOrUndefined(n.paragraph.bodyWidget)||!sf.base.isNullOrUndefined(n.paragraph.containerWidget)&&!sf.base.isNullOrUndefined(t.paragraph.containerWidget)&&_instanceof(n.paragraph.containerWidget,et)&&_instanceof(t.paragraph.containerWidget,et)){this.owner.selection.selectRange(n,t);var i=!1;"BackSpace"!==this.action&&"Uppercase"!==this.action&&"RemoveRowTrack"!==this.action||(i=!0);this.owner.editorModule.deleteSelectedContents(this.owner.selection,i)}},n.prototype.updateEndRevisionInfo=function(){this.lastElementRevision=this.checkAdjacentNodeForMarkedRevision(this.lastElementRevision);var t=this.retrieveEndPosition(this.lastElementRevision),n=this.owner.selection.getParagraphInfo(t);this.endRevisionLogicalIndex=this.owner.selection.getHierarchicalIndex(n.paragraph,n.offset.toString());this.lastElementRevision.isMarkedForRevision=!1},n.prototype.retrieveEndPosition=function(n){var t=new l(this.owner),i=n.line.getOffset(n,0)+n.length;return t.setPositionFromLine(n.line,i),t},n.prototype.checkAdjacentNodeForMarkedRevision=function(n){for(var i,t=n.nextNode;!sf.base.isNullOrUndefined(t)&&t.isMarkedForRevision;)i=t,t=t.nextNode;return sf.base.isNullOrUndefined(i)?n:i},n.prototype.revertModifiedProperties=function(n,t){"CellFormat"!==this.action&&"CellOptions"!==this.action&&"TableOptions"!==this.action||(this.owner.isShiftingEnabled=!1);this.owner.selection.selectRange(n,t);"RowResizing"===this.action||"CellResizing"===this.action?this.revertResizing():"CellOptions"===this.action||"TableOptions"===this.action?this.revertTableDialogProperties(this.action):"Selection"!==this.action&&this.revertProperties()},n.prototype.redoAction=function(){var n=this.owner.editorModule;switch(this.action){case"BackSpace":n.singleBackspace(this.owner.selection,!0);break;case"Delete":n.singleDelete(this.owner.selection,!0);break;case"DeleteTable":n.deleteTable();break;case"DeleteColumn":n.deleteColumn();break;case"DeleteRow":n.deleteRow();break;case"MergeCells":n.mergeSelectedCellsInTable();break;case"InsertRowAbove":n.insertRow(!0);break;case"InsertRowBelow":n.insertRow(!1);break;case"InsertColumnLeft":case"InsertColumnRight":n.insertColumn(!0);break;case"SectionBreak":n.insertSection(this.owner.selection,!0);break;case"TableAutoFitToContents":n.autoFitTable("FitToContents");break;case"TableAutoFitToWindow":n.autoFitTable("FitToWindow");break;case"TableFixedColumnWidth":n.autoFitTable("FixedColumnWidth");break;case"RemoveRowTrack":this.owner.selection.handleAcceptReject(!0)}},n.prototype.revertModifiedNodes=function(n,t,i,r){var l,a,h,s,y,p,w,v;if((!t||"BackSpace"!==this.action&&"Delete"!==this.action&&"DeleteTable"!==this.action&&"DeleteColumn"!==this.action&&"DeleteRow"!==this.action&&"InsertRowAbove"!==this.action&&"InsertRowBelow"!==this.action&&"InsertColumnLeft"!==this.action&&"InsertColumnRight"!==this.action&&"MergeCells"!==this.action&&"SectionBreak"!==this.action&&"TableAutoFitToContents"!==this.action&&"TableAutoFitToWindow"!==this.action&&"TableFixedColumnWidth"!==this.action||(this.redoAction(),"SectionBreak"!==this.action))&&n.length>0)if(this.editorHistory.isUndoing&&("RemoveRowTrack"===this.action||"DeleteCells"===this.action||"DeleteColumn"===this.action||"DeleteRow"===this.action||"MergeCells"===this.action)||"InsertRowAbove"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"ClearCells"===this.action||"InsertColumnRight"===this.action||"Borders"===this.action||"TableAutoFitToContents"===this.action||"TableAutoFitToWindow"===this.action||"TableFixedColumnWidth"===this.action||"RemoveRowTrack"===this.action){var b=this.selectionStart,e=this.owner.editorModule.getBlock({index:b}).node,o=n[n.length-1];(_instanceof(e,f)||_instanceof(e.previousRenderedWidget,f)||e.isInsideTable)&&_instanceof(o,f)?(_instanceof(e,u)&&!e.isInsideTable?e=e.previousRenderedWidget:_instanceof(e,u)&&e.isInsideTable&&(e=e.associatedCell.ownerTable),e=e.combineWidget(this.viewer),this.owner.editorModule.insertTableInternal(e,o,!1),n.splice(n.indexOf(o),1)):_instanceof(o,f)&&this.owner.editorModule.insertBlock(o)}else l=i,e=this.owner.editorModule.getBlock({index:l}).node,n.length>0&&("BackSpace"===this.action&&r||!_instanceof(e,f)&&!_instanceof(e,ct))&&(o=n[0],(("TrackingPageBreak"===this.action||"SectionBreak"===this.action&&_instanceof(o,c)||!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action)&&(o=n[1]),_instanceof(o,u)&&this.owner.selection.start.offset>0&&(this.owner.editorModule.insertNewParagraphWidget(o,!0),o.characterFormat.removedIds.length>0&&this.owner.editor.constructRevisionFromID(o.characterFormat,void 0),n.splice(n.indexOf(o),1),sf.base.isNullOrUndefined(e)))&&(a=this.documentHelper.selection.getNextParagraphBlock(o.getSplitWidgets().pop()),this.owner.selection.getNextRenderedBlock(o),sf.base.isNullOrUndefined(a)&&this.owner.selection.selectParagraphInternal(o,!0)),_instanceof(o,f)&&this.owner.selection.start.offset>0&&(h=n[n.length-1],_instanceof(h,u)&&(this.owner.editorModule.insertNewParagraphWidget(h,!0),n.splice(n.indexOf(h),1),sf.base.isNullOrUndefined(e))&&(a=this.documentHelper.selection.getNextParagraphBlock(h.getSplitWidgets().pop()),sf.base.isNullOrUndefined(a)&&this.owner.selection.selectParagraphInternal(h,!0)))),n.length>0&&(s=n[n.length-1],_instanceof(e,f)&&(e=e.combineWidget(this.viewer),_instanceof(s,f))&&(this.owner.editorModule.insertTableInternal(e,s,!0),n.splice(n.indexOf(s),1),this.insertPosition=i,y=s.getSplitWidgets().pop(),_instanceof(y.nextRenderedWidget,f)?e=y.nextRenderedWidget:(l=i,e=this.owner.editorModule.getBlock({index:l}).node)),_instanceof(s,u)&&this.owner.selection.start.offset>0&&this.owner.selection.start.offset===this.owner.selection.getLineLength(this.owner.selection.start.paragraph.lastChild)?(p=this.owner.editorModule,p.insertNewParagraphWidget(s,!1),s.characterFormat.removedIds.length>0&&this.owner.editor.constructRevisionFromID(s.characterFormat,void 0),n.splice(n.indexOf(s),1),"Paste"!==this.action&&p.removeBlock(this.owner.selection.start.paragraph),w=this.documentHelper.selection.getNextParagraphBlock(s.getSplitWidgets().pop()),sf.base.isNullOrUndefined(w)||this.owner.selection.selectParagraphInternal(w,!0)):_instanceof(n[0],f)&&1!==n.length&&(v=n[1],_instanceof(v,u)&&v.isEmpty()&&n.splice(n.indexOf(v),1))),n.length>0&&(_instanceof(e,f)&&(e=e.combineWidget(this.viewer)),this.insertRemovedNodes(n,e))},n.prototype.insertRemovedNodes=function(n,t){for(var i,h,o,l,v,w,e=n.length-1;e>-1;e--)if(i=n[e],_instanceof(i,tt))this.owner.editorModule.insertInlineInSelection(this.owner.selection,i);else if(_instanceof(i,wt))_instanceof(i,a)?_instanceof(t,f)&&(t.childWidgets.splice(0,0,i),this.owner.editorModule.updateNextBlocksIndex(i,!0),0!==e&&_instanceof(n[e-1],a)||this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)):_instanceof(t,f)?this.owner.editorModule.insertBlockTable(this.owner.selection,i,t):this.owner.editorModule.insertBlock(i);else if(_instanceof(i,p))h=this.selectionStart,o=this.owner.editorModule.getBlock({index:h}).node,_instanceof(o,u)&&(i.removedIds.length>0?(o.characterFormat.removedIds=i.removedIds.slice(),this.owner.editor.constructRevisionFromID(o.characterFormat,!0)):o.characterFormat.revisions.length>0&&(o.characterFormat=i.cloneFormat()));else if(_instanceof(i,c))this.owner.editorModule.insertSection(this.owner.selection,!1);else if("string"==typeof i&&"AcceptTOC"===this.action){h=this.selectionStart;var s=this.owner.editorModule.getBlock({index:h}).node,y=this.owner.editorModule.getBlock({index:this.selectionEnd}).node,r=this.owner.documentHelper.revisionsInternal.get(i);if(this.editorHistory.isUndoing){for(;_instanceof(s,u)&&s!==y;)this.owner.editor.insertRevisionForBlock(s,r.revisionType,!0,r),s=this.documentHelper.selection.getNextParagraphBlock(s.getSplitWidgets().pop());this.owner.editor.insertRevisionForBlock(y,r.revisionType,!0,r)}else for(;r.range.length>0;)l=r.range[0],v=l.revisions.indexOf(r),v>=0&&(l.revisions.splice(v,1),w=r.range.indexOf(l),r.range.splice(w,1)),0===r.range.length&&this.owner.revisions.remove(r);this.owner.editor.addRemovedNodes(r.revisionID)}n=[]},n.prototype.undoRevisionForElements=function(n,t,i){var r=n.paragraph,o=t.paragraph,u=this.documentHelper.revisionsInternal.get(i),f=this.owner.selection.getParagraphInfo(n).offset,c=this.owner.selection.getParagraphInfo(t).offset,l=n.paragraph===t.paragraph,e,s,h;if(this.editorHistory.isUndoing){for(;r!==o;)this.owner.editor.applyRevisionForCurrentPara(r,f,r.getLength(),i,!0),(r=this.documentHelper.selection.getNextParagraphBlock(r.getSplitWidgets().pop()))!==o&&(f=0);r===o&&(l||(f=0),this.owner.editor.applyRevisionForCurrentPara(r,f,c,i,!1))}else for(;u.range.length>0;)e=u.range[0],s=e.revisions.indexOf(u),s>=0&&(e.revisions.splice(s,1),h=u.range.indexOf(e),u.range.splice(h,1)),0===u.range.length&&this.owner.revisions.remove(u);this.removedNodes.push(i)},n.prototype.revertResizing=function(){var n,r;if(this.editorHistory.currentBaseHistoryInfo=this,"RowResizing"===this.action)_instanceof(this.modifiedProperties[0],pu)&&this.modifiedProperties[0].revertChanges(this.editorHistory.isRedoing,this.owner);else if(_instanceof(this.modifiedProperties[0],br)){0===this.owner.selection.selectedWidgets.length&&this.owner.selection.highlightSelection(!0);var i=this.modifiedProperties[0],u=i.tableHierarchicalIndex,t=this.owner.editorModule.getBlock({index:u}).node;_instanceof(t,f)&&(n=this.owner.editorModule.tableResize,(this.owner.editor.setOffsetValue(this.owner.selection),t=t.combineWidget(this.owner.viewer),n.currentResizingTable=t,this.modifiedProperties.splice(0,1),this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(r=new br(t,this.owner),this.modifiedProperties.splice(0,0,r),this.owner.isLayoutEnabled=!1,n.applyProperties(n.currentResizingTable,i),n.currentResizingTable.isGridUpdated=!0,this.owner.isLayoutEnabled=!0,n.updateGridValue(n.currentResizingTable,!1),i.destroy(),i=void 0))}},n.prototype.revertTableDialogProperties=function(n){if(this.owner.isShiftingEnabled=!1,this.editorHistory.currentBaseHistoryInfo=this,this.currentPropertyIndex=0,"CellOptions"===n){var t=this.owner.selection,i=this.modifiedProperties[0];this.owner.editorModule.updateCellMargins(t,i)}this.currentPropertyIndex=0;this.owner.isShiftingEnabled=!0},n.prototype.addModifiedPropertiesForSection=function(n,t,i){var r,u,f;return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(r=this.modifiedProperties,u=this.currentPropertyIndex<r.length?r[this.currentPropertyIndex]:r[r.length-1],sf.base.isNullOrUndefined(t)?(i=u,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=n.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=n.cloneFormat()):(i=u.getPropertyValue(t),u.copyFormat(n)),this.currentPropertyIndex++):sf.base.isNullOrUndefined(t)?this.modifiedProperties.push(n.cloneFormat()):(f=new dt,f.copyFormat(n),this.modifiedProperties.push(f)),i},n.prototype.addModifiedProperties=function(n,t,i){var r,u,f,e,o;return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],u=!1,_instanceof(n.ownerBase,tt)&&(f=this.modifiedNodeLength[this.currentPropertyIndex],n.ownerBase.length<f&&(u=!0,this.modifiedNodeLength[this.currentPropertyIndex]=n.ownerBase.length,this.modifiedNodeLength.splice(this.currentPropertyIndex+1,0,f-n.ownerBase.length),e=new p(void 0),e.copyFormat(r),this.modifiedProperties.splice(this.currentPropertyIndex+1,0,e))),"ClearCharacterFormat"===this.action?this.editorHistory.isUndoing?(i=r,u||(this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--)):this.modifiedProperties.push(n.cloneFormat()):(i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=n.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=n.cloneFormat()),this.currentPropertyIndex++):(sf.base.isNullOrUndefined(t)?this.modifiedProperties.push(n.cloneFormat()):(o=new p(void 0),o.copyFormat(n),this.modifiedProperties.push(o)),_instanceof(n.ownerBase,tt)?this.modifiedNodeLength.push(n.ownerBase.length):this.modifiedNodeLength.push(0)),i},n.prototype.addModifiedPropertiesForParagraphFormat=function(n,t,i){var r,u;if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){if(r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],"ClearParagraphFormat"===this.action)return this.editorHistory.isUndoing?(i=r,this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--):this.modifiedProperties.push(n.cloneFormat()),this.currentPropertyIndex++,i;if(sf.base.isNullOrUndefined(t))return i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=n.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=n.cloneFormat(),this.currentPropertyIndex++,i;if("listFormat"===t)return(i=new ut(void 0)).copyFormat(r),r.listFormat=new ai,r.listFormat.copyFormat(n.listFormat),this.currentPropertyIndex++,i;if("styleName"===t)return sf.base.isNullOrUndefined(r.baseStyle)?void(sf.base.isNullOrUndefined(n.baseStyle)||(r.baseStyle=new fi,r.baseStyle.copyStyle(n.baseStyle))):((i=new fi).copyStyle(r.baseStyle),this.currentPropertyIndex++,sf.base.isNullOrUndefined(n.baseStyle)||(r.baseStyle=new fi,r.baseStyle.copyStyle(n.baseStyle)),i);i=r.getPropertyValue(t);r.copyFormat(n);this.currentPropertyIndex++}else sf.base.isNullOrUndefined(t)?this.modifiedProperties.push(n.cloneFormat()):(u=new ut(void 0),u.copyFormat(n),this.modifiedProperties.push(u));return i},n.prototype.addModifiedPropertiesForContinueNumbering=function(n,t){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing)return t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=n.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=n.cloneFormat(),this.currentPropertyIndex++,t;var i=new ut;return i.copyFormat(n),this.modifiedProperties.push(i),t},n.prototype.addModifiedPropertiesForRestartNumbering=function(n,t){return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=n.listId:this.modifiedProperties[this.modifiedProperties.length-1]=n.listId,this.currentPropertyIndex++,t):(this.modifiedProperties.push(n.listId),t)},n.prototype.addModifiedPropertiesForList=function(n){var i,t;return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],i=t,t=new ki(n,this.owner.editorModule.cloneListLevel(n)),this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=t:this.modifiedProperties[this.modifiedProperties.length-1]=t,this.currentPropertyIndex++):(this.modifiedProperties.push(new ki(n,this.owner.editorModule.cloneListLevel(n))),i=n),i},n.prototype.revertProperties=function(){var n,r,u,t,i,f;if(this.editorHistory.currentBaseHistoryInfo=this,this.currentPropertyIndex=0,n=this.getProperty(),this.viewer.owner.editorModule.setOffsetValue(this.documentHelper.selection),"ClearCharacterFormat"===this.action||_instanceof(this.modifiedProperties[0],p)){if("ListCharacterFormat"===this.action)return void this.owner.editorModule.updateListCharacterFormat(this.documentHelper.selection,n,void 0);this.owner.editorModule.updateSelectionCharacterFormatting(n,void 0,!1)}else if("ClearParagraphFormat"===this.action||_instanceof(this.modifiedProperties[0],ut)){if("ContinueNumbering"===this.action)return void this.owner.editorModule.revertContinueNumbering(this.owner.selection,this.modifiedProperties[0]);if("StyleName"===this.action&&_instanceof(this.modifiedProperties[0],ut))return void this.owner.editorModule.updateSelectionParagraphFormatting(n,this.modifiedProperties[0].baseStyle,!1);this.owner.editor.setPreviousBlockToLayout();r=this.owner.documentHelper.selection;u=(r.paragraphFormat.bidi||(_instanceof(this.modifiedProperties[0],ut)&&this.modifiedProperties[0]).bidi)&&(-1!==r.paragraphFormat.listId||"listFormat"===n);u||(this.owner.documentHelper.layout.isBidiReLayout=!0);this.owner.editorModule.updateSelectionParagraphFormatting(n,void 0,!1);u||(this.owner.documentHelper.layout.isBidiReLayout=!1)}else if(_instanceof(this.modifiedProperties[0],dt))this.owner.editorModule.updateSectionFormat(n,void 0);else{if("RestartNumbering"===this.action)return void this.owner.editorModule.restartListAtInternal(this.owner.selection,this.modifiedProperties[0]);if(_instanceof(this.modifiedProperties[0],wr))this.owner.selection.updateImageSize(this.modifiedProperties[0]);else if(_instanceof(this.modifiedProperties[0],ki)){for(t=new h,i=0;i<this.modifiedProperties.length;i++)f=this.modifiedProperties[i],t.add(i,f);this.editorHistory.updateListChanges(t);t.destroy();t=void 0}else _instanceof(this.modifiedProperties[0],pt)?this.owner.editorModule.updateTableFormat(this.owner.selection,n,void 0):_instanceof(this.modifiedProperties[0],si)?(this.owner.isShiftingEnabled=!0,this.owner.editorModule.updateCellFormat(this.owner.selection,n,void 0)):_instanceof(this.modifiedProperties[0],ti)&&this.owner.editorModule.updateRowFormat(this.owner.selection,n,void 0)}this.currentPropertyIndex=0;"ClearCharacterFormat"!==this.action&&"ClearParagraphFormat"!==this.action||this.owner.editorModule.getOffsetValue(this.documentHelper.selection)},n.prototype.addModifiedCellOptions=function(n,t,i){var r;return r=sf.base.isNullOrUndefined(n.bottomMargin)&&sf.base.isNullOrUndefined(n.topMargin)&&sf.base.isNullOrUndefined(n.rightMargin)&&sf.base.isNullOrUndefined(n.leftMargin)?this.copyCellOptions(i.tableFormat):this.copyCellOptions(n),this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=this.copyCellOptions(n):this.modifiedProperties[this.modifiedProperties.length-1]=this.copyCellOptions(n),this.currentPropertyIndex++,t):(this.modifiedProperties.push(r),t)},n.prototype.copyCellOptions=function(n){var t=new si;return t.topMargin=n.topMargin,t.rightMargin=n.rightMargin,t.bottomMargin=n.bottomMargin,t.leftMargin=n.leftMargin,t},n.prototype.addModifiedTableOptions=function(n){var t=this.copyTableOptions(n);this.editorHistory.isUndoing||this.editorHistory.isRedoing?(this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties.splice(this.currentPropertyIndex,1,t):this.modifiedProperties.splice(this.modifiedProperties.length-1,1,t),this.currentPropertyIndex++):this.modifiedProperties.push(t)},n.prototype.copyTableOptions=function(n){var t=new pt;return t.topMargin=n.topMargin,t.rightMargin=n.rightMargin,t.bottomMargin=n.bottomMargin,t.leftMargin=n.leftMargin,t.cellSpacing=n.cellSpacing,t},n.prototype.getProperty=function(){switch(this.action){case"Bold":return"bold";case"Italic":return"italic";case"FontColor":return"fontColor";case"FontFamily":return"fontFamily";case"FontSize":return"fontSize";case"HighlightColor":return"highlightColor";case"BaselineAlignment":return"baselineAlignment";case"Strikethrough":return"strikethrough";case"Underline":return"underline";case"AfterSpacing":return"afterSpacing";case"BeforeSpacing":return"beforeSpacing";case"LeftIndent":return"leftIndent";case"RightIndent":return"rightIndent";case"FirstLineIndent":return"firstLineIndent";case"LineSpacingType":return"lineSpacingType";case"LineSpacing":return"lineSpacing";case"TextAlignment":return"textAlignment";case"ListFormat":return"listFormat";case"PageHeight":return"pageHeight";case"PageWidth":return"pageWidth";case"TableAlignment":return"tableAlignment";case"TableLeftIndent":return"leftIndent";case"DefaultCellSpacing":return"cellSpacing";case"LeftMargin":case"CellLeftMargin":case"DefaultCellLeftMargin":return"leftMargin";case"RightMargin":case"CellRightMargin":case"DefaultCellRightMargin":return"rightMargin";case"TopMargin":case"CellTopMargin":case"DefaultCellTopMargin":return"topMargin";case"BottomMargin":case"CellBottomMargin":case"DefaultCellBottomMargin":return"bottomMargin";case"CellContentVerticalAlignment":return"verticalAlignment";case"RowHeight":return"height";case"RowHeightType":return"heightType";case"RowHeader":return"isHeader";case"AllowBreakAcrossPages":return"allowBreakAcrossPages";case"TablePreferredWidth":case"CellPreferredWidth":return"preferredWidth";case"TablePreferredWidthType":case"CellPreferredWidthType":return"preferredWidthType";case"Shading":return"shading";case"StyleName":return"styleName";case"ParagraphBidi":case"TableBidi":return"bidi";case"ContextualSpacing":return"contextualSpacing"}},n.prototype.getCharacterPropertyValue=function(n,t){var i;return"bold"===n?i=t.bold:"italic"===n?i=t.italic:"fontColor"===n?i=t.fontColor:"fontFamily"===n?i=t.fontFamily:"fontSize"===n?i=t.fontSize:"highlightColor"===n?i=t.highlightColor:"baselineAlignment"===n?i=t.baselineAlignment:"strikethrough"===n?i=t.strikethrough:"underline"===n&&(i=t.underline),i},n.prototype.addModifiedTableProperties=function(n,t,i){var r,u;if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){if(r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],sf.base.isNullOrUndefined(t))return i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=n.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=n.cloneFormat(),this.currentPropertyIndex++,i;i="shading"===t?r.shading:r.getPropertyValue(t);r.copyFormat(n);this.currentPropertyIndex++}else u=new pt,u.copyFormat(n),this.modifiedProperties.push(u);return i},n.prototype.addModifiedRowProperties=function(n,t,i){var r,u;if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){if(r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],sf.base.isNullOrUndefined(t))return i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=n.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=n.cloneFormat(),this.currentPropertyIndex++,i;i=r.getPropertyValue(t);r.copyFormat(n);this.currentPropertyIndex++}else u=new ti,u.copyFormat(n),this.modifiedProperties.push(u);return i},n.prototype.addModifiedCellProperties=function(n,t,i){var r,u;if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){if(r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],sf.base.isNullOrUndefined(t))return i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=n.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=n.cloneFormat(),this.currentPropertyIndex++,i;i="shading"===t?r.shading:r.getPropertyValue(t);r.copyFormat(n);this.currentPropertyIndex++}else u=new si,u.copyFormat(n),this.modifiedProperties.push(u);return i},n.prototype.destroy=function(){var n,t,i;if(this.selectionStart=void 0,this.selectionEnd=void 0,this.insertPosition=void 0,this.endPosition=void 0,sf.base.isNullOrUndefined(this.modifiedNodeLength)||(this.modifiedNodeLength=[],this.modifiedNodeLength=void 0),!sf.base.isNullOrUndefined(this.modifiedProperties)){for(n=0;n<this.modifiedProperties.length;n++)t=this.modifiedProperties[n],(_instanceof(t,p)||_instanceof(t,ut)||_instanceof(t,dt)||_instanceof(t,ki))&&t.destroy(),this.modifiedProperties.splice(this.modifiedProperties.indexOf(t),1),n--;this.modifiedPropertiesIn=void 0}if(!sf.base.isNullOrUndefined(this.removedNodes)){for(n=0;n<this.removedNodes.length;n++)i=this.removedNodes[n],_instanceof(i,u)?i.destroyInternal(this.viewer):_instanceof(i,tt)&&i.destroy(),this.removedNodes.splice(this.removedNodes.indexOf(i),1),n--;this.removedNodesIn=void 0}this.ownerIn=void 0},n}(),fo=(hr=function(n,t){return(hr=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}hr(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),kr=function(n){function t(t,i){var r=n.call(this,t)||this;return r.isChildHistoryInfo=!1,r.editRangeStart=void 0,r.documentHelper=t.documentHelper,r.isChildHistoryInfo=i,r}return fo(t,n),Object.defineProperty(t.prototype,"hasAction",{get:function(){return!sf.base.isNullOrUndefined(this.modifiedActions)},enumerable:!0,configurable:!0}),t.prototype.addModifiedAction=function(n){this.editorHistory.isUndoing||this.editorHistory.isRedoing||(sf.base.isNullOrUndefined(this.modifiedActions)&&(this.modifiedActions=[]),this.modifiedActions.push(n))},t.prototype.revert=function(){var n,t,i;if(this.editorHistory.currentHistoryInfo=this,"BordersAndShading"===this.action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),!sf.base.isNullOrUndefined(this.modifiedActions))if(this.editorHistory.isUndoing)for(n=this.modifiedActions.length;n>0;)this.modifiedActions[n-1].revert(),n-=1;else for(n=0;n<this.modifiedActions.length;)this.modifiedActions[n].revert(),n+=1;"RestrictEditing"===this.action&&(t=""!==this.editRangeStart.user?this.editRangeStart.user:this.editRangeStart.group,this.editorHistory.isUndoing?(i=this.owner.documentHelper.editRanges.get(t).indexOf(this.editRangeStart),-1!==i&&this.owner.documentHelper.editRanges.get(t).splice(i,1)):this.owner.editor.updateRangeCollection(this.editRangeStart,t),this.owner.selection.updateEditRangeCollection());this.isChildHistoryInfo?this.editorHistory.updateComplexHistoryInternal():this.editorHistory.updateComplexHistory()},t.prototype.destroy=function(){if(!sf.base.isNullOrUndefined(this.modifiedActions)){for(;this.modifiedActions.length>0;){var t=this.modifiedActions[this.modifiedActions.length-1];t.destroy();this.modifiedActions.splice(this.modifiedActions.indexOf(t),1)}this.modifiedActions=void 0}n.prototype.destroy.call(this)},t}(fr),eo=function(){function n(n){this.undoStackIn=[];this.redoStackIn=[];this.historyInfoStack=[];this.isUndoing=!1;this.isRedoing=!1;this.owner=n;this.documentHelper=n.documentHelper;this.modifiedParaFormats=new h;this.undoLimitIn=500;this.redoLimitIn=500}return Object.defineProperty(n.prototype,"currentHistoryInfo",{get:function(){if(this.historyInfoStack&&this.historyInfoStack.length>0)return this.historyInfoStack[this.historyInfoStack.length-1]},set:function(n){_instanceof(n,kr)?this.historyInfoStack.push(n):this.historyInfoStack.pop()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"undoStack",{get:function(){return this.undoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"redoStack",{get:function(){return this.redoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"undoLimit",{get:function(){return sf.base.isNullOrUndefined(this.undoLimitIn)?0:this.undoLimitIn},set:function(n){if(n<0)throw new Error("The limit should be greater than or equal to zero.");this.undoLimitIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"redoLimit",{get:function(){return sf.base.isNullOrUndefined(this.redoLimitIn)?0:this.redoLimitIn},set:function(n){if(n<0)throw new Error("The limit should be greater than or equal to zero.");this.redoLimitIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),n.prototype.getModuleName=function(){return"EditorHistory"},n.prototype.canUndo=function(){return!sf.base.isNullOrUndefined(this.undoStack)&&this.undoStack.length>0},n.prototype.canRedo=function(){return!sf.base.isNullOrUndefined(this.redoStack)&&this.redoStack.length>0},n.prototype.initializeHistory=function(n){this.currentBaseHistoryInfo=new fr(this.owner);this.currentBaseHistoryInfo.action=n;this.currentBaseHistoryInfo.updateSelection()},n.prototype.initComplexHistory=function(n,t){this.currentHistoryInfo=new kr(n.owner,!sf.base.isNullOrUndefined(this.currentHistoryInfo));this.currentHistoryInfo.action=t;this.currentHistoryInfo.updateSelection()},n.prototype.initResizingHistory=function(n,t){if(1===t.resizeNode)this.initializeHistory("RowResizing"),sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)||this.currentBaseHistoryInfo.modifiedProperties.push(new pu(n,t.currentResizingTable.childWidgets[t.resizerPosition].rowFormat));else if(this.initializeHistory("CellResizing"),this.currentBaseHistoryInfo){t.currentResizingTable=t.currentResizingTable.combineWidget(this.viewer);var i=new br(t.currentResizingTable,this.owner);i.startingPoint=n;this.currentBaseHistoryInfo.modifiedProperties.push(i)}},n.prototype.updateResizingHistory=function(n,i){var u,r;1===i.resizeNode?sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)||(u=this.currentBaseHistoryInfo.modifiedProperties[0],u.startingPoint.y===n.y?this.currentBaseHistoryInfo.modifiedProperties.length=0:(u.displacement=t.convertPixelToPoint(n.y-u.startingPoint.y),this.recordChanges(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)):sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)||(r=this.currentBaseHistoryInfo.modifiedProperties[0],r.startingPoint.x===n.x?this.currentBaseHistoryInfo.modifiedProperties.length=0:(r.displacement=t.convertPixelToPoint(n.x-r.startingPoint.x),r.endIndex=i.getCellReSizerPosition(n),this.owner.editorHistory.recordChanges(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0))},n.prototype.recordChanges=function(n){if(this.owner.enableHistoryMode)if(this.isUndoing){if(sf.base.isNullOrUndefined(this.redoStack)&&(this.redoStackIn=[]),this.redoStack.length===this.redoLimit&&this.redoLimit>0){var t=this.undoLimit>20?10:1;this.redoStackIn.splice(0,t)}this.redoStack.length<this.redoLimit&&this.redoStack.push(n)}else(this.isRedoing||this.clearRedoStack(),sf.base.isNullOrUndefined(this.undoStack)&&(this.undoStackIn=[]),this.undoStack.length===this.undoLimit&&this.undoLimit>0)&&(t=this.undoLimit>20?10:1,this.undoStackIn.splice(0,t)),this.undoStack.length<this.undoLimit&&this.undoStackIn.push(n)},n.prototype.updateHistory=function(){this.documentHelper.owner.enableHistoryMode&&!sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)&&(!sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)&&sf.base.isNullOrUndefined(this.currentBaseHistoryInfo.endPosition)&&(this.currentBaseHistoryInfo.endPosition=this.currentBaseHistoryInfo.insertPosition),sf.base.isNullOrUndefined(this.currentHistoryInfo)?this.recordChanges(this.currentBaseHistoryInfo):this.currentHistoryInfo.addModifiedAction(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)},n.prototype.isHandledComplexHistory=function(){var n=!1;return this.isUndoing||this.isRedoing||(n=this.owner.editorModule.insertRemoveBookMarkElements()),this.documentHelper.owner.enableHistoryMode&&!sf.base.isNullOrUndefined(this.currentHistoryInfo)?(this.updateHistory(),n=!0):this.owner.editorModule.isHandledComplex&&(n=!0),n},n.prototype.updateComplexHistory=function(){var n=this.documentHelper.selection,t,i;this.currentHistoryInfo.hasAction&&(("AutoFormatHyperlink"===this.currentHistoryInfo.action||"SkipCommentInline"===this.currentHistoryInfo.action)&&(t=new l(n.owner),this.owner.editorModule.setPositionForCurrentIndex(t,this.currentHistoryInfo.insertPosition),n.owner.editorHistory.isUndoing?(this.owner.editorModule.setPositionForCurrentIndex(n.start,this.currentHistoryInfo.selectionStart),this.owner.editorModule.setPositionForCurrentIndex(n.end,this.currentHistoryInfo.selectionEnd)):(this.owner.editorModule.setPositionForCurrentIndex(n.start,this.currentHistoryInfo.endPosition),this.owner.editorModule.setPositionForCurrentIndex(n.end,this.currentHistoryInfo.endPosition))),"InsertHyperlink"===this.currentHistoryInfo.action&&(t=new l(n.owner),this.owner.editorModule.setPositionForCurrentIndex(t,this.currentHistoryInfo.insertPosition),i=new l(n.owner),this.owner.editorModule.setPositionForCurrentIndex(i,this.currentHistoryInfo.endPosition),this.documentHelper.layout.reLayoutParagraph(t.paragraph,0,0),i.paragraph!==t.paragraph&&this.documentHelper.layout.reLayoutParagraph(i.paragraph,0,0)),"ReplaceAll"===this.currentHistoryInfo.action?this.owner.editorModule.layoutWholeDocument():n.owner.isShiftingEnabled&&(this.documentHelper.layout.shiftLayoutedItems(!1),this.owner.enableHeaderAndFooter&&this.owner.editorModule.updateHeaderFooterWidget(),this.documentHelper.removeEmptyPages()));this.owner.showRevisions&&this.owner.trackChangesPane.updateTrackChanges();n.owner.isShiftingEnabled=!1;n.owner.isLayoutEnabled=!0;"ApplyStyle"===this.currentHistoryInfo.action?this.owner.editor.getOffsetValue(n):(n.start.updatePhysicalPosition(!0),n.isEmpty?n.end.setPositionInternal(n.start):n.end.updatePhysicalPosition(!0));n.upDownSelectionLength=n.end.location.x;this.documentHelper.isScrollHandler=!0;this.viewer.updateScrollBars();n.fireSelectionChanged(!0);this.documentHelper.isScrollHandler=!1;this.documentHelper.updateFocus();this.updateComplexHistoryInternal();this.owner.editorModule.fireContentChange()},n.prototype.updateComplexHistoryInternal=function(){sf.base.isNullOrUndefined(this.currentHistoryInfo)||((sf.base.isNullOrUndefined(this.currentHistoryInfo.endPosition)&&(this.currentHistoryInfo.endPosition=this.currentHistoryInfo.insertPosition),this.historyInfoStack.length>1)?this.historyInfoStack[this.historyInfoStack.length-2].addModifiedAction(this.currentHistoryInfo):this.recordChanges(this.currentHistoryInfo),this.currentHistoryInfo=void 0)},n.prototype.updateListChangesInHistory=function(n,t){var u,i,r,f;for(this.currentBaseHistoryInfo=new fr(this.documentHelper.owner),this.currentBaseHistoryInfo.action="List",this.currentBaseHistoryInfo.updateSelection(),u=new h,i=0;i<n.levels.length;i++)r=this.documentHelper.getAbstractListById(t.abstractListId).levels[i],this.currentBaseHistoryInfo.addModifiedPropertiesForList(r),f=new ki(r,n.levels[i]),sf.base.isNullOrUndefined(r)||this.documentHelper.owner.editorModule.copyListLevel(r,n.levels[i]),u.add(i,f);return u},n.prototype.applyListChanges=function(n,t){var f,r,u,o;for(sf.base.isNullOrUndefined(this.modifiedParaFormats)&&(this.modifiedParaFormats=new h),f=[],r=0;r<this.documentHelper.listParagraphs.length;r++){var i=this.documentHelper.listParagraphs[r].paragraphFormat,s=this.documentHelper.getListById(i.listFormat.listId),e=this.documentHelper.layout.getListLevel(s,i.listFormat.listLevelNumber);t.containsKey(i.listFormat.listLevelNumber)&&t.get(i.listFormat.listLevelNumber).ownerListLevel===e&&(u=new ut(null),u.leftIndent=i.leftIndent,u.firstLineIndent=i.firstLineIndent,o=new to(i,u),f.push(o),this.owner.editorModule.copyFromListLevelParagraphFormat(i,e.paragraphFormat))}this.modifiedParaFormats.add(this.currentBaseHistoryInfo,f)},n.prototype.updateListChanges=function(n){var r,u,i,t;for(this.documentHelper.owner.isLayoutEnabled=!1,this.owner.editorModule.updateListParagraphs(),r=0;r<n.keys.length;r++)u=n.keys[0],i=n.get(u),sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)||(i=this.currentBaseHistoryInfo.addModifiedPropertiesForList(i.ownerListLevel)),this.owner.editorModule.copyListLevel(i.ownerListLevel,i.modifiedListLevel);this.revertListChanges();this.documentHelper.owner.isLayoutEnabled=!0;this.documentHelper.renderedLists.clear();this.documentHelper.renderedLevelOverrides=[];this.documentHelper.pages=[];this.documentHelper.layout.layout();t=this.documentHelper.selection;t.start.updatePhysicalPosition(!0);t.isEmpty?t.end.setPositionInternal(t.start):t.end.updatePhysicalPosition(!0);t.upDownSelectionLength=t.end.location.x;t.fireSelectionChanged(!1);this.updateHistory()},n.prototype.revertListChanges=function(){var t,n,i;if(!sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)&&this.documentHelper.owner.editorHistory.modifiedParaFormats.containsKey(this.currentBaseHistoryInfo))for(t=this.modifiedParaFormats.get(this.currentBaseHistoryInfo),n=0;n<t.length;n++)i=new ut(null),i.leftIndent=t[n].ownerFormat.leftIndent,i.firstLineIndent=t[n].ownerFormat.firstLineIndent,t[n].ownerFormat.copyFormat(t[n].modifiedFormat),t[n].modifiedFormat.leftIndent=i.leftIndent,t[n].modifiedFormat.firstLineIndent=i.firstLineIndent},n.prototype.undo=function(){if((!this.owner.isReadOnlyMode||"FormFieldsOnly"===this.owner.documentHelper.protectionType)&&this.canUndo()&&this.owner.enableHistoryMode){var n=this.undoStack.pop();this.isUndoing=!0;n.revert();this.isUndoing=!1;this.owner.selection.checkForCursorVisibility();this.owner.editorModule.isBordersAndShadingDialog=!1}},n.prototype.redo=function(){if((!this.owner.isReadOnlyMode||"FormFieldsOnly"===this.owner.documentHelper.protectionType)&&this.canRedo()&&this.owner.enableHistoryMode){var n=this.redoStack.pop();"BordersAndShading"===n.action&&(this.owner.editorModule.isBordersAndShadingDialog=!0);this.isRedoing=!0;n.revert();this.isRedoing=!1;this.owner.selection.checkForCursorVisibility();this.owner.editorModule.isBordersAndShadingDialog=!1}},n.prototype.destroy=function(){this.clearHistory();this.undoStackIn=void 0;this.redoStackIn=void 0},n.prototype.clearHistory=function(){this.clearUndoStack();this.clearRedoStack()},n.prototype.clearUndoStack=function(){if(this.canUndo())for(;this.undoStack.length>0;){var n=this.undoStack.pop();n.destroy();n=void 0}},n.prototype.clearRedoStack=function(){if(this.canRedo())for(;this.redoStack.length>0;){var n=this.redoStack.pop();n.destroy();n=void 0}},n}(),oo=function(){function n(n){this.resizeNode=0;this.resizerPosition=-1;this.currentResizingTable=void 0;this.owner=n;this.documentHelper=this.owner.documentHelper;this.startingPoint=new d(0,0)}return Object.defineProperty(n.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),n.prototype.getModuleName=function(){return"TableResizer"},n.prototype.updateResizingHistory=function(n){this.owner.editorHistory&&this.owner.editorHistory.updateResizingHistory(n,this);this.documentHelper.isRowOrCellResizing=!1;this.resizerPosition=-1},n.prototype.handleResize=function(n){this.owner.documentHelper.isRowOrCellResizing=!0;this.startingPoint.x=n.x;this.startingPoint.y=n.y;this.owner.editorHistory.initResizingHistory(n,this)},n.prototype.isInRowResizerArea=function(n){var t=this.getRowReSizerPosition(void 0,n);return-1!==t&&(this.resizeNode=1,this.resizerPosition=t,!0)},n.prototype.isInCellResizerArea=function(n){var t=this.getCellReSizerPosition(n);return-1!==t&&(this.resizeNode=0,this.resizerPosition=t,!0)},n.prototype.getCellReSizerPosition=function(n){var r=this.getTableWidget(n),i=this.getTableCellWidget(n),o=sf.base.isNullOrUndefined(r)?0:r.tableFormat.cellSpacing,f,u,e;if(r&&o>0){if(this.currentResizingTable=r,this.documentHelper.isInsideRect(r.x-t.convertPointToPixel(r.leftBorderWidth)-.25,r.y,t.convertPointToPixel(r.leftBorderWidth)+.5,r.height,n))return 0;for(f=r.x,u=0;u<r.tableHolder.columns.length;u++){if(e=t.convertPointToPixel(r.tableHolder.columns[u].preferredWidth),this.documentHelper.isInsideRect(f-1,r.y,r.leftBorderWidth+2,r.height,n))return u>0?u:0;if(u>0&&this.documentHelper.isInsideRect(f+e-1,r.y,2,r.height,n))return u+1;f+=e}}else if(!sf.base.isNullOrUndefined(i)){if(this.currentResizingTable=i.ownerTable,this.documentHelper.isInsideRect(i.x-i.margin.left-1,i.y-i.margin.top,2,i.height+i.margin.top+i.margin.bottom,n))return i.columnIndex;if(sf.base.isNullOrUndefined(i.nextRenderedWidget)&&this.documentHelper.isInsideRect(i.x+i.margin.right+i.width-1,i.y-i.margin.top,2,i.height+i.margin.top+i.margin.bottom,n))return i.columnIndex+i.cellFormat.columnSpan;if(i.childWidgets.length>0)return this.getCellReSizerPositionInternal(i,n)}return-1},n.prototype.getCellReSizerPositionInternal=function(n,i){var u=this.getTableWidgetFromWidget(i,n),r=void 0,e,f,o;if(!sf.base.isNullOrUndefined(u)&&u.tableFormat.cellSpacing>0){if(this.currentResizingTable=u,this.documentHelper.isInsideRect(u.x-u.leftBorderWidth-.25,u.y,u.leftBorderWidth+.5,u.height,i))return 0;for(e=u.x,f=0;f<u.tableHolder.columns.length;f++){if(o=t.convertPointToPixel(u.tableHolder.columns[f].preferredWidth),this.documentHelper.isInsideRect(e-1,u.y,u.leftBorderWidth+2,u.height,i))return f>0?f:0;if(f>0&&this.documentHelper.isInsideRect(e+o-1,u.y,2,u.height,i))return f+1;e+=o}}else if(sf.base.isNullOrUndefined(u)||(r=u.getTableCellWidget(i)),!sf.base.isNullOrUndefined(r)){if(this.currentResizingTable=r.ownerTable,this.documentHelper.isInsideRect(r.x-r.margin.left-1,r.y-r.margin.top,2,r.height,i))return r.columnIndex;if(sf.base.isNullOrUndefined(r.nextRenderedWidget)&&this.documentHelper.isInsideRect(r.x+r.margin.right+r.width-1,r.y-r.margin.top,2,r.height,i))return r.columnIndex+r.cellFormat.columnSpan;if(r.childWidgets.length>0)return this.getCellReSizerPositionInternal(r,i)}return-1},n.prototype.getRowReSizerPosition=function(n,t){var i=void 0,u=void 0,f,e,r,o;if(sf.base.isNullOrUndefined(n)?(i=this.getTableWidget(t),u=this.getTableCellWidget(t)):i=this.getTableWidgetFromWidget(t,n),f=sf.base.isNullOrUndefined(i)?0:i.tableFormat.cellSpacing,i&&f>0){if(this.currentResizingTable=i,this.owner.documentHelper.isInsideRect(i.x,i.y+i.height-f,this.getActualWidth(i.lastChild),sf.base.isNullOrUndefined(i.nextSplitWidget)?i.bottomBorderWidth+f:0,t))return i.lastChild.rowIndex;for(e=0;e<i.childWidgets.length;e++)if(r=i.childWidgets[e],i.childWidgets.indexOf(r)>-1&&this.owner.documentHelper.isInsideRect(r.x,r.y+r.height+f/2,this.getActualWidth(r),f/2,t))return r.rowIndex}else if(i&&u&&(u=this.getTableCellWidget(t)),u){if(o=0,o=(r=u.containerWidget).rowIndex===r.ownerTable.childWidgets.length-1?r.bottomBorderWidth+2:r.nextRenderedWidget.topBorderWidth+2,this.owner.documentHelper.isInsideRect(r.x,r.y+r.height-o,r.width,2*o,t))return this.currentResizingTable=r.ownerTable,r.rowIndex;if(u.childWidgets.length>0)return this.getRowReSizerPosition(u,t)}return-1},n.prototype.handleResizing=function(n){var t=0;0===this.resizeNode?(t=n.x-this.startingPoint.x,this.resizeTableCellColumn(t)):(t=n.y-this.startingPoint.y,this.resizeTableRow(t))},n.prototype.resizeTableRow=function(n){var i=this.currentResizingTable,r,u,f;sf.base.isNullOrUndefined(i)||0===n||-1===this.resizerPosition||(r=this.owner.selection,i.isInsideTable&&(this.owner.isLayoutEnabled=!1),u=void 0,(this.resizerPosition>-1&&((u=i.childWidgets[this.resizerPosition])&&this.updateRowHeight(u,n),r.selectPosition(r.start,r.end)),i.isInsideTable)&&(f=this.owner.documentHelper.layout.getParentTable(i),this.owner.isLayoutEnabled=!0,i=f),this.startingPoint.y+=t.convertPointToPixel(n),this.owner.documentHelper.layout.reLayoutTable(i),this.owner.editorModule.reLayout(this.owner.selection),u&&this.getRowReSizerPosition(void 0,this.startingPoint),!this.currentResizingTable||void 0!==this.currentResizingTable.childWidgets&&void 0!==this.currentResizingTable.childWidgets[this.resizerPosition]||(this.resizerPosition=-1))},n.prototype.getTableWidget=function(n){var i=void 0,r=this.owner.documentHelper.currentPage,t,u;if(!sf.base.isNullOrUndefined(r))for(t=0;t<r.bodyWidgets.length;t++)if(u=r.bodyWidgets[t],i=this.getTableWidgetFromWidget(n,u),!sf.base.isNullOrUndefined(i))break;return i},n.prototype.getTableWidgetFromWidget=function(n,t){for(var i,u,r=0;r<t.childWidgets.length;r++)if(_instanceof(t.childWidgets[r],f)&&((i=t.childWidgets[r],u=0,i.wrapTextAround&&(u=i.getTableCellWidth()),!i.wrapTextAround&&i.y<=n.y&&i.y+i.height>=n.y)||i.wrapTextAround&&i.x<=n.x&&i.x+u>=n.x&&i.y<=n.y&&i.y+i.height>=n.y))return i},n.prototype.getTableCellWidget=function(n){var i=void 0,r=this.owner.documentHelper.currentPage,t;if(!sf.base.isNullOrUndefined(r))for(t=0;t<r.bodyWidgets.length;t++)if(i=r.bodyWidgets[t].getTableCellWidget(n),!sf.base.isNullOrUndefined(i))break;return i},n.prototype.updateRowHeight=function(n,t){var i=n.rowFormat,u,r;"Auto"===i.heightType?(i.heightType="AtLeast",u=i.ownerBase,r=this.owner.documentHelper.layout.getRowHeight(u,[u]),r+t>=2.7&&i.height!==r+t&&(i.height=r+t)):i.height+t>=2.7&&i.height!==i.height+t&&(i.height=i.height+t)},n.prototype.resizeTableCellColumn=function(n){var i=this.currentResizingTable,c,f,e,o,h;if(!(sf.base.isNullOrUndefined(i)||0===n||sf.base.isNullOrUndefined(i.childWidgets)||this.resizerPosition<0)){c=!0;f=this.owner.selection;this.owner.editor.setOffsetValue(f);i=i.combineWidget(this.viewer);this.owner.isLayoutEnabled=!1;this.setPreferredWidth(i);var s=i.getOwnerWidth(!0),r=i.leftIndent,l=i.tableFormat.tableAlignment;if(f.isEmpty||(c=this.resizeColumnWithSelection(f,i,n)),c){if(0===this.resizerPosition){var a=this.resizerPosition,u=i.tableHolder.columns[a],v=u.preferredWidth;if(n>0){e=n;do{if((o=t.round(u.preferredWidth-n,1))>=u.minWidth){u.preferredWidth=o;r=(r=i.leftIndent+n)>=-1440?r<=1440?r:1440:-1440;break}e=n;n+=o-u.minWidth}while(n!==e)}else{e=n;do{if((o=t.round(u.preferredWidth-n,1))<=2112){u.preferredWidth=o;r=(r=i.leftIndent+n)>=-1440?r<=1440?r:1440:-1440;break}e=n;n-=o-2112}while(n!==e)}h=n;"Left"!==l&&i.tableHolder.getTotalWidth(0)>s&&"Auto"===i.tableFormat.preferredWidthType&&(i.tableHolder.isFitColumns(s,i.tableHolder.tableWidth,"Auto"===i.tableFormat.preferredWidthType)?i.tableHolder.fitColumns(s,i.tableHolder.tableWidth,"Auto"===i.tableFormat.preferredWidthType):u.preferredWidth=v,h=0);"Center"===l&&(i.tableHolder.getTotalWidth(0)<s||"Auto"!==i.tableFormat.preferredWidthType)&&(h/=2);i.tableFormat.leftIndent="Left"===l?r:0;i.tableHolder.tableWidth=i.tableHolder.getTotalWidth(0);this.updateCellPreferredWidths(i);this.updateGridValue(i,!0,h)}else if(null!==i&&this.resizerPosition===i.tableHolder.columns.length)this.resizeColumnAtLastColumnIndex(i,n,s);else{if(-1===this.resizerPosition)return void(this.owner.isLayoutEnabled=!0);this.resizeCellAtMiddle(i,n)}this.owner.isLayoutEnabled=!0;f.selectPosition(f.start,f.end)}else this.owner.isLayoutEnabled=!0}},n.prototype.resizeColumnWithSelection=function(n,t,i){var s=this.getTableCellWidget(this.startingPoint),o,u,r,e;if(s&&(n.selectedWidgets.containsKey(s)||s.previousWidget&&n.selectedWidgets.containsKey(s.previousWidget))){if(o=n.getSelectedCells(),0===this.resizerPosition)this.resizeColumnAtStart(t,i,o);else if(null!==t&&this.resizerPosition===t.tableHolder.columns.length){for(u=this.getColumnCells(t,this.resizerPosition,!0),r=0;r<u.length;r++)e=u[r],-1!==o.indexOf(e)&&this.increaseOrDecreaseWidth(e,i,!0);this.updateRowsGridAfterWidth(t);t.updateWidth(i);t.tableFormat.allowAutoFit=!1;this.updateGridValue(t,!0,i)}else{if(-1===this.resizerPosition)return!1;var h=this.resizerPosition,f=(u=this.getColumnCells(t,h,!0),this.getColumnCells(t,h,!1)),c=this.isColumnSelected(t,h);if(u.length>0&&!c)for(r=0;r<u.length;r++)-1===o.indexOf(u[r])&&(u.splice(r,1),r--);if(f.length>0&&!c)for(r=0;r<f.length;r++)-1===o.indexOf(f[r])&&(f.splice(r,1),r--);if(0===u.length&&f.length>0)for(r=0;r<f.length;r++)(e=f[r]).previousWidget&&u.push(e.previousWidget);else if(0===f.length&&u.length>0)for(r=0;r<u.length;r++)(e=u[r]).nextWidget&&f.push(e.nextWidget);this.changeWidthOfCells(t,u,f,i);t.tableFormat.allowAutoFit&&t.updateWidth(i);t.tableFormat.allowAutoFit=!1;this.updateGridValue(t,!0,i)}n.selectPosition(n.start,n.end)}return!1},n.prototype.resizeColumnAtStart=function(n,t,i){var r=n.leftIndent,s=i[0].ownerRow,h=s.rowFormat,e,u,o,f;if(h.beforeWidth>0){if(e=h.beforeWidth+t,e>0)this.updateGridBefore(s,t);else if(e<(o=this.getLeastGridBefore(n,s))&&0!==e)for(r=n.leftIndent+e,n.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440,u=0;u<n.childWidgets.length;u++)s!==(f=n.childWidgets[u])&&this.updateGridBefore(f,-e)}else if(t<0)r=n.leftIndent+t,n.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440,this.updateWidthForCells(n,i,t);else if(o=this.getLeastGridBefore(n,s),0===n.tableFormat.leftIndent)for(u=0;u<n.childWidgets.length;u++)f=n.childWidgets[u],-1!==i.indexOf(f.childWidgets[0])&&(this.updateGridBefore(f,t),this.increaseOrDecreaseWidth(f.childWidgets[0],t,!1));else if(o-t>0)r=n.leftIndent+t,n.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440,this.updateWidthForCells(n,i,t);else for(r=n.leftIndent+o,n.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440,u=0;u<n.childWidgets.length;u++)f=n.childWidgets[u],-1!==i.indexOf(f.childWidgets[0])?(this.increaseOrDecreaseWidth(f.childWidgets[0],t,!1),this.updateGridBefore(f,t-o)):this.updateGridBefore(f,-o);n.tableFormat.allowAutoFit=!1;this.updateGridValue(n,!0,t)},n.prototype.updateWidthForCells=function(n,t,i){for(var u,r=0;r<n.childWidgets.length;r++)u=n.childWidgets[r],-1!==t.indexOf(u.childWidgets[0])?this.increaseOrDecreaseWidth(u.childWidgets[0],i,!1):this.updateGridBefore(u,-i)},n.prototype.resizeColumnAtLastColumnIndex=function(n,i,r){for(var f,e,s=n.tableFormat.tableAlignment,h=n.tableFormat.preferredWidth,c=this.resizerPosition,u=n.tableHolder.columns[c-1],o=0;i!==o;)f=t.round(u.preferredWidth+i,1),f>=u.minWidth?(u.preferredWidth=f,o=i):(o=i,i-=f-u.minWidth);this.updateCellPreferredWidths(n);(h||n.tableHolder.getTotalWidth(0)>r)&&(n.tableFormat.allowAutoFit=!1,n.updateWidth(i),n.tableHolder.tableWidth=n.tableHolder.getTotalWidth(0));e=i;"Right"===s?e=0:"Center"===s&&(e/=2);this.updateGridValue(n,!0,e)},n.prototype.resizeCellAtMiddle=function(n,i){var o=this.resizerPosition,r=n.tableHolder.columns[o-1],u=n.tableHolder.columns[o],f,e;if(i>0)for(f=!0;f;)(e=t.round(u.preferredWidth-i,1))>=u.minWidth?(u.preferredWidth=e,r.preferredWidth=r.preferredWidth+i,f=!1):i+=e-u.minWidth;else for(f=!0;f;)(e=t.round(r.preferredWidth+i,1))>=r.minWidth?(r.preferredWidth=e,u.preferredWidth=u.preferredWidth-i,f=!1):i-=e-r.minWidth;this.updateCellPreferredWidths(n);n.tableFormat.allowAutoFit&&n.updateWidth(i);n.tableFormat.allowAutoFit=!1;n.tableHolder.tableWidth=n.tableHolder.getTotalWidth(0);this.updateGridValue(n,!1,i)},n.prototype.updateGridValue=function(n,i,r){if(i&&(n.calculateGrid(),n.isGridUpdated=!1),n.buildTableColumns(),n.isGridUpdated=!0,this.viewer.owner.isLayoutEnabled=!0,n.isInsideTable){var u=this.documentHelper.layout.getParentTable(n);this.documentHelper.layout.reLayoutTable(u)}else this.documentHelper.layout.reLayoutTable(n);this.owner.editor.getOffsetValue(this.documentHelper.selection);this.owner.editorModule.reLayout(this.owner.selection);r&&(this.startingPoint.x+=t.convertPointToPixel(r),this.resizerPosition=this.getCellReSizerPosition(this.startingPoint))},n.prototype.getColumnCells=function(n,t,i){for(var o,e,r,u=[],f=0;f<n.childWidgets.length;f++)for(o=n.childWidgets[f],e=0;e<o.childWidgets.length;e++)r=o.childWidgets[e],i?r.columnIndex+r.cellFormat.columnSpan===t&&u.push(r):r.columnIndex===t&&u.push(r);return u},n.prototype.updateGridBefore=function(n,t){n.rowFormat.beforeWidth+t!==n.rowFormat.beforeWidth&&(n.rowFormat.beforeWidth=n.rowFormat.beforeWidth+t,n.rowFormat.gridBeforeWidth=n.rowFormat.beforeWidth)},n.prototype.getLeastGridBefore=function(n,t){for(var i,r=0,f=0,u=0;u<n.childWidgets.length;u++)i=n.childWidgets[u],i!==t&&(0===f&&(r=i.rowFormat.beforeWidth,f++),i.rowFormat.beforeWidth<=r&&(r=i.rowFormat.beforeWidth));return r},n.prototype.increaseOrDecreaseWidth=function(n,t,i){var u=n.cellFormat.preferredWidth,r;"Auto"===n.cellFormat.preferredWidthType&&(u=n.cellFormat.cellWidth,n.cellFormat.preferredWidthType="Point");r=n.ownerColumn.minWidth;"Percent"===n.cellFormat.preferredWidthType&&(r=n.convertPointToPercent(r));n.cellFormat.preferredWidth=i?u+t>r?u+t:r:u-t>r?u-t:r},n.prototype.changeWidthOfCells=function(n,t,i,r){var c,f,u,e,o,s,h,l;if(t.length>0){for(c=!1,f=0;f<t.length;f++)u=t[f],this.increaseOrDecreaseWidth(u,r,!0),u.cellIndex===u.ownerRow.childWidgets.length-1&&(c=!0);c&&this.updateRowsGridAfterWidth(n)}if(i.length>0){for(e=0,f=0;f<i.length;f++)0===(u=i[f]).cellIndex&&(o=u.ownerRow.rowFormat.beforeWidth+r,o>=0?this.updateGridBefore(u.ownerRow,r):(e!==o&&(e=o),u.ownerRow.rowFormat.gridBeforeWidth=0,u.ownerRow.rowFormat.gridBeforeWidthType="Auto")),this.increaseOrDecreaseWidth(u,r,!1);if(0!==e)for(s=n.leftIndent+e,n.tableFormat.leftIndent=s>=-1440?s<=1440?s:1440:-1440,h=0;h<n.childWidgets.length;h++)l=n.childWidgets[h],-1===i.indexOf(l.childWidgets[0])&&this.updateGridBefore(l,e>0?e:-e)}},n.prototype.updateRowsGridAfterWidth=function(n){for(var t,u,f,i=this.getMaxRowWidth(n,!0),r=0;r<n.childWidgets.length;r++)t=n.childWidgets[r],u=this.getRowWidth(t,!0),i>=u&&t.rowFormat.afterWidth!==i-u&&(f=i-u,t.rowFormat.gridAfterWidth=f,t.rowFormat.afterWidth=f)},n.prototype.getRowWidth=function(n,t){var r=0,i;for(t&&(r+=n.rowFormat.beforeWidth),i=0;i<n.childWidgets.length;i++)r+=n.childWidgets[i].cellFormat.cellWidth;return r},n.prototype.getMaxRowWidth=function(n,t){for(var f,i,e,r=0,u=0;u<n.childWidgets.length;u++){for(f=n.childWidgets[u],i=0,t&&(i+=f.rowFormat.beforeWidth),e=0;e<f.childWidgets.length;e++)i+=f.childWidgets[e].cellFormat.cellWidth;r<i&&(r=i)}return r},n.prototype.isColumnSelected=function(n,t){for(var u,f=this.owner.selection.getSelectedCells(),e=this.getColumnCells(n,t,!0),o=this.getColumnCells(n,t,!1),r=!1,i=0;i<e.length;i++)u=e[i],r=-1!==f.indexOf(u);if(!r)for(i=0;i<o.length;i++)u=o[i],r=-1!==f.indexOf(u);return r},n.prototype.applyProperties=function(n,t){var u,i,r,f,e,o,s,h;if(!sf.base.isNullOrUndefined(t)){for(t.tableHolder&&(n.tableHolder=t.tableHolder.clone()),null!==t.tableFormat&&(n.tableFormat.leftIndent=t.tableFormat.leftIndent,n.tableFormat.preferredWidth=t.tableFormat.preferredWidth,n.tableFormat.preferredWidthType=t.tableFormat.preferredWidthType,n.tableFormat.allowAutoFit=t.tableFormat.allowAutoFit),u=0;u<n.childWidgets.length;u++)for(i=n.childWidgets[u],r=t.rows[u],i.rowFormat.gridBefore=r.gridBefore,i.rowFormat.gridBeforeWidth=r.gridBeforeWidth,i.rowFormat.gridBeforeWidthType=r.gridBeforeWidthType,i.rowFormat.gridAfter=r.gridAfter,i.rowFormat.gridAfterWidth=r.gridAfterWidth,i.rowFormat.gridAfterWidthType=r.gridAfterWidthType,f=0;f<i.childWidgets.length;f++)e=i.childWidgets[f],o=r.cells[f],e.columnIndex=o.columnIndex,e.cellFormat.columnSpan=o.columnSpan,e.cellFormat.preferredWidth=o.preferredWidth,e.cellFormat.preferredWidthType=o.preferredWidthType;s=n.getOwnerWidth(!0);h=n.getTableClientWidth(s);n.setWidthToCells(h,"Auto"===n.tableFormat.preferredWidthType)}},n.prototype.getActualWidth=function(n){var i=0,t;if(n.childWidgets.length>0)for(t=0;t<n.childWidgets.length;t++)i+=n.childWidgets[t].cellFormat.cellWidth;return i},n.prototype.setPreferredWidth=function(n){for(var r,t,u,f,i=0;i<n.childWidgets.length;i++){for(r=n.childWidgets[i],t=r.rowFormat,t.gridBefore>0&&(t.gridBeforeWidth=t.beforeWidth,t.gridBeforeWidthType="Point"),u=0;u<r.childWidgets.length;u++)f=r.childWidgets[u],f.cellFormat.preferredWidth=f.cellFormat.cellWidth,f.cellFormat.preferredWidthType="Point";t.gridAfter>0&&(t.gridAfterWidth=t.afterWidth,t.gridAfterWidthType="Point")}},n.prototype.updateCellPreferredWidths=function(n){for(var t,e,u,f,i=n.tableHolder.tableWidth,r=0;r<n.childWidgets.length;r++){for(t=n.childWidgets[r],t.rowFormat.gridBefore>0&&(e=n.tableHolder.getCellWidth(0,t.rowFormat.gridBefore,i),this.updateGridBeforeWidth(e,t)),u=0;u<t.childWidgets.length;u++)f=t.childWidgets[u],f.updateWidth(n.tableHolder.getCellWidth(f.columnIndex,f.cellFormat.columnSpan,i));t.rowFormat.gridAfter>0&&this.updateGridAfterWidth(n.tableHolder.getCellWidth(t.childWidgets.length,t.rowFormat.gridAfter,i),t)}},n.prototype.updateGridBeforeWidth=function(n,t){var i=t.rowFormat,r,u;n!==i.beforeWidth&&((i.beforeWidth=n,"Auto"===i.gridBeforeWidthType&&(i.gridBeforeWidthType="Point"),"Point"===i.gridBeforeWidthType)?i.gridBeforeWidth=i.beforeWidth:(r=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),u=t.ownerTable.convertPointToPercent(i.beforeWidth,r),i.gridBeforeWidth=u))},n.prototype.updateGridAfterWidth=function(n,t){var i=t.rowFormat,r,u;(n!==i.afterWidth&&(i.afterWidth=n),"Auto"===i.gridAfterWidthType&&(i.gridAfterWidthType="Point"),"Point"===i.gridAfterWidthType)?i.gridAfterWidth=i.afterWidth:(r=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),u=t.ownerTable.convertPointToPercent(i.afterWidth,r),i.gridAfterWidth=u)},n}(),so=function(){function n(n){var t=this;this.nodes=[];this.editHyperlinkInternal=!1;this.startParagraph=void 0;this.endParagraph=void 0;this.removeEditRange=!1;this.formFieldCounter=1;this.skipFieldDeleteTracking=!1;this.isForHyperlinkFormat=!1;this.isTrackingFormField=!1;this.isCmtDeleteStarted=!1;this.removeCommentCharacters=[];this.isRemoveRevision=!1;this.isHandledComplex=!1;this.tableResize=void 0;this.tocStyles={};this.chartType=!1;this.refListNumber=void 0;this.incrementListNumber=-1;this.removedBookmarkElements=[];this.tocBookmarkId=0;this.triggerPageSpellCheck=!0;this.copiedData=void 0;this.pageRefFields={};this.delBlockContinue=!1;this.delBlock=void 0;this.delSection=void 0;this.isInsertingTOC=!1;this.editStartRangeCollection=[];this.skipReplace=!1;this.skipTableElements=!1;this.listNumberFormat="";this.listLevelNumber=0;this.isXmlMapped=!1;this.copiedContent="";this.copiedTextContent="";this.previousParaFormat=void 0;this.previousCharFormat=void 0;this.previousSectionFormat=void 0;this.pasteTextPosition=void 0;this.isSkipHistory=!1;this.isPaste=!1;this.isPasteListUpdated=!1;this.isInsertField=!1;this.isBordersAndShadingDialog=!1;this.onTextInputInternal=function(){var r,i;if(sf.base.Browser.isDevice){var n=t.documentHelper,u=new RegExp(String.fromCharCode(160),"g"),f=new RegExp(String.fromCharCode(10),"g");if(n.prefix=n.prefix.replace(u," ").replace(f," "),r=(i=n.editableDiv.textContent.replace(u," ").replace(f," ")).substring(2),n.isCompositionStart&&n.isCompositionUpdated)return n.isCompositionUpdated=!1,void(!n.owner.isReadOnlyMode&&n.owner.isDocumentLoaded&&t.canEditContentControl&&n.prefix.substring(2)!==r&&(t.selection.isEmpty?(t.selection.start.setPositionForLineWidget(n.selection.start.currentWidget,t.selection.start.offset-(n.prefix.length-2)),t.handleTextInput(r),n.prefix="@"+String.fromCharCode(160)+r):(t.handleTextInput(r),n.prefix="@"+String.fromCharCode(160)+r)));if(n.isCompositionStart&&n.isCompositionEnd&&""===n.suffix)return n.prefix.substring(2)!==r?t.selection.isEmpty&&n.isCompositionStart?(n.isCompositionStart=!1,t.selection.start.setPositionForLineWidget(n.selection.start.currentWidget,t.selection.start.offset-n.prefix.substring(2).length),t.selection.retrieveCurrentFormatProperties(),""!==n.suffix&&""!==r||t.handleTextInput(r)):t.selection.isEmpty||(n.isCompositionStart=!1,t.handleTextInput(r)):""===r?(n.isCompositionStart=!1,t.handleBackKey()):n.prefix.substring(2)===r&&""===n.suffix&&(n.isCompositionStart=!1,t.handleTextInput(" ")),void(n.isCompositionEnd=!1);if(n.isCompositionEnd||n.isCompositionStart&&!n.isCompositionUpdated){if(r.length<n.prefix.length&&r===n.prefix.substring(2,n.prefix.length-1)||n.editableDiv.innerText.length<2)return void t.handleBackKey();if(""!==n.suffix&&n.editableDiv.innerText[n.editableDiv.innerText.length-1]!==String.fromCharCode(160))return n.isCompositionStart=!1,t.selection.start.setPositionForLineWidget(n.selection.start.currentWidget,t.selection.start.offset-(n.prefix.length-2)),t.selection.end.setPositionForLineWidget(n.selection.end.currentWidget,t.selection.end.offset+n.suffix.length),t.selection.retrieveCurrentFormatProperties(),void t.handleTextInput(r)}"\r"!==i&&"\b"!==i&&"\x1b"!==i&&!n.owner.isReadOnlyMode&&!1===n.isControlPressed&&t.canEditContentControl&&("@"===i||"@"!==i[0]||""===i||i.length<n.prefix.length&&r===n.prefix.substring(2,n.prefix.length-1)?(t.handleBackKey(),n.editableDiv.innerText.length<2&&t.predictText()):0===i.indexOf(n.prefix)&&i.length>n.prefix.length?t.handleTextInput(i.substring(n.prefix.length)):-1===i.indexOf(n.prefix)&&i[i.length-1]!==String.fromCharCode(160)&&" "!==i[i.length-1]?(r.charAt(0).toLowerCase()+r.slice(1)===n.prefix.substring(2)&&t.selection.start.setPositionParagraph(n.selection.start.currentWidget,t.selection.start.offset-(n.prefix.length-2)),t.handleTextInput(r)):2!==i.length&&t.handleTextInput(" "))}else(i=t.documentHelper.editableDiv.innerText)!==String.fromCharCode(160)?"\r"!==i&&"\b"!==i&&"\x1b"!==i&&!t.owner.isReadOnlyMode&&!1===t.documentHelper.isControlPressed&&t.canEditContentControl&&t.handleTextInput(i):t.handleTextInput(" "),t.documentHelper.editableDiv.innerText=""};this.onPaste=function(n){!t.owner.isReadOnlyMode&&t.canEditContentControl&&t.pasteInternal(n);n.preventDefault()};this.documentHelper=n;this.tableResize=new oo(this.documentHelper.owner);this.base64=new gu}return Object.defineProperty(n.prototype,"restrictFormatting",{get:function(){return this.documentHelper.isDocumentProtected&&(this.documentHelper.restrictFormatting||!this.documentHelper.restrictFormatting&&!this.selection.isSelectionInEditRegion())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"restrictEditing",{get:function(){return this.documentHelper.isDocumentProtected&&("ReadOnly"===this.documentHelper.protectionType&&!this.selection.isSelectionInEditRegion()||"FormFieldsOnly"===this.documentHelper.protectionType)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canEditContentControl",{get:function(){return!this.owner.isReadOnlyMode&&!this.selection.checkContentControlLocked()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewer",{get:function(){if(!sf.base.isNullOrUndefined(this.owner))return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"editorHistory",{get:function(){return this.documentHelper.owner.editorHistory},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selection",{get:function(){if(this.documentHelper)return this.documentHelper.selection},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"owner",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),n.prototype.getModuleName=function(){return"Editor"},n.prototype.insertField=function(n,f){var e,d,b,l,v,h,a;if(this.isInsertField=!0,e=n,"NUMPAGES"===(e=t.trimStart(e)).substring(0,8))this.insertPageCount(f);else if("PAGE"===e.substring(0,4))this.insertPageNumber(f);else{sf.base.isNullOrUndefined(f)&&"MERGEFIELD"===e.substring(0,10)&&(d=(e=e.substring(10).trim()).indexOf("\\*"),f=""+e.substring(0,d).trim()+"");var y=new u,g=new p,w=this.copyInsertFormat(g,!1),s=new k(y),o=new r(0);o.characterFormat.mergeFormat(w);s.children.push(o);b=new i;b.text=n;s.children.push(b);l=new r(2);l.fieldBegin=o;o.fieldSeparator=l;s.children.push(l);v=new i;v.text=f;v.characterFormat.mergeFormat(w);s.children.push(v);h=new r(1);h.characterFormat.mergeFormat(w);h.fieldSeparator=l;h.fieldBegin=o;o.fieldEnd=h;l.fieldEnd=h;s.children.push(h);o.line=s;y.childWidgets.push(s);this.documentHelper.fields.push(o);a=new c;a.sectionFormat=new dt(a);a.childWidgets.push(y);this.pasteContentsInternal([a],!1)}this.isInsertField=!1},n.prototype.applyStyle=function(n,t){var r=void 0,u=void 0,f,i;(t=!sf.base.isNullOrUndefined(t)&&t)&&(this.initComplexHistory("ApplyStyle"),this.setOffsetValue(this.selection),r=this.startOffset,u=this.endOffset,f=this.selection.isEmpty,this.clearFormatting(),f&&!this.selection.isEmpty&&this.selection.end.setPositionInternal(this.selection.start));i=this.documentHelper.styles.findByName(n);void 0!==i?this.onApplyParagraphFormat("styleName",i,!1,!0):(this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(n)),this.documentHelper.styles),this.applyStyle(n));this.editorHistory&&this.editorHistory.currentHistoryInfo&&"ApplyStyle"===this.editorHistory.currentHistoryInfo.action&&(this.startOffset=r,this.endOffset=u,this.editorHistory.updateComplexHistory());this.startParagraph=void 0;this.endParagraph=void 0},n.prototype.cut=function(){this.owner.isReadOnlyMode||this.selection.isEmpty||!this.canEditContentControl||(this.selection.copySelectedContent(!0),this.documentHelper.owner.parser.isCutPerformed=!0)},n.prototype.insertEditingRegion=function(n){this.insertEditRangeElement(n&&""!==n?n:"Everyone")},n.prototype.enforceProtection=function(n,t,i){var r,u;"boolean"==typeof t?(r=i?"ReadOnly":this.documentHelper.protectionType,u=t):(u=!0,r=t);this.documentHelper.restrictFormatting=u;this.documentHelper.protectionType=r;this.selection.isHighlightEditRegion=!0;this.addProtection(n,this.documentHelper.protectionType)},n.prototype.getCommentHierarchicalIndex=function(n){for(var t="";n.ownerComment;)t=n.ownerComment.replyComments.indexOf(n)+";"+t,n=n.ownerComment;return"C;"+this.documentHelper.comments.indexOf(n)+";"+t},n.prototype.alertBox=function(){},n.prototype.insertComment=function(n){sf.base.isNullOrUndefined(this.selection.start)||this.owner.isReadOnlyMode||this.viewer.owner.enableHeaderAndFooter||!this.viewer.owner.enableComment||(sf.base.isNullOrUndefined(n)&&(n=""),this.insertCommentInternal(n))},n.prototype.insertCommentInternal=function(n){var e,h,r,c,a,t;this.selection.isEmpty&&(this.selection.start.isAtSamePosition(this.selection.end)&&this.selection.start.isAtParagraphEnd&&(e=this.selection.start.offset,this.selection.start.offset=e-1!=-1?e-1:e),this.selection.selectCurrentWord(),this.selection.isParagraphLastLine(this.selection.end.currentWidget)&&this.selection.end.offset===this.selection.getLineLength(this.selection.end.currentWidget)+1&&(this.selection.end.offset-=1));h=this.selection.getParagraphInfo(this.selection.start);r=(this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString()),this.selection.getParagraphInfo(this.selection.end));this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());this.initComplexHistory("InsertComment");var o=this.selection.start,u=this.selection.end,i=new l(this.owner);this.selection.isForward||(o=this.selection.end,u=this.selection.start);i.setPositionInternal(u);var f=new g(0),s=new g(1),v=o.isInSameParagraphIndex(u);return(u.setPositionInternal(o),this.initInsertInline(f),sf.base.isNullOrUndefined(i.paragraph))&&(c=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),a=this.selection.getTextPosBasedOnLogicalIndex(c),i.setPositionInternal(a)),v&&i.setPositionParagraph(i.currentWidget,i.offset+f.length),o.setPositionInternal(i),u.setPositionInternal(i),this.initInsertInline(s),t=new rr((new Date).toISOString()),this.owner.editorHistory&&(this.initHistory("InsertCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(t)),t.author=this.owner.currentUser?this.owner.currentUser:"Guest user",t.initial=this.constructCommentInitial(t.author),t.text=n,t.commentId=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),f.comment=t,f.commentId=t.commentId,s.comment=t,s.commentId=t.commentId,t.commentStart=f,t.commentEnd=s,this.addCommentWidget(t,!0,!0,!0),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(t),this.editorHistory.updateHistory()),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.reLayout(this.selection,!1),t},n.prototype.deleteAllComments=function(){var n,t;if(0!==this.documentHelper.comments.length){for(this.initComplexHistory("DeleteAllComments"),this.owner.isLayoutEnabled=!1,this.editorHistory&&this.editorHistory.currentHistoryInfo&&(n=this.editorHistory.currentHistoryInfo);this.documentHelper.comments.length>0;)t=this.documentHelper.comments[0],this.initComplexHistory("DeleteComment"),this.deleteCommentInternal(t),this.editorHistory&&this.editorHistory.currentHistoryInfo&&n.addModifiedAction(this.editorHistory.currentHistoryInfo);this.selection.selectContent(this.owner.documentStart,!0);this.editorHistory&&(this.editorHistory.currentHistoryInfo=n,this.editorHistory.updateComplexHistory())}},n.prototype.deleteComment=function(){this.owner.isReadOnlyMode||sf.base.isNullOrUndefined(this.owner)||sf.base.isNullOrUndefined(this.owner.viewer)||sf.base.isNullOrUndefined(this.owner.documentHelper.currentSelectedComment)||this.owner.enableHeaderAndFooter||!this.viewer.owner.enableComment||this.deleteCommentInternal(this.owner.documentHelper.currentSelectedComment)},n.prototype.deleteCommentInternal=function(n){var t,r,i;if(this.initComplexHistory("DeleteComment"),n){if(t=n.commentStart,r=n.commentEnd,-1!==r.indexInOwner&&this.removeInline(r),-1!==t.indexInOwner&&this.removeInline(t),t.removeCommentMark(),n.replyComments.length>0)for(i=n.replyComments.length-1;i>=0;i--)this.deleteCommentInternal(n.replyComments[i]);this.owner.editorHistory&&(this.initHistory("DeleteCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(n),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(n));this.deleteCommentWidget(n);this.editorHistory&&this.editorHistory.updateHistory()}this.editorHistory&&this.editorHistory.updateComplexHistory()},n.prototype.deleteCommentWidget=function(n){var r,t=this.documentHelper.comments.indexOf(n),i;-1!==t?this.documentHelper.comments.splice(t,1):n.isReply&&n.ownerComment&&(t=n.ownerComment.replyComments.indexOf(n),n.ownerComment.replyComments.splice(t,1));i={};i.comment=this.getCommentObj(n);r=JSON.stringify(i);this.owner.dotNetRef.invokeMethodAsync("DeleteCommentWidget",r)},n.prototype.resolveComment=function(n){this.owner.isReadOnlyMode||this.resolveOrReopenComment(n,!0)},n.prototype.reopenComment=function(n){this.owner.isReadOnlyMode||this.resolveOrReopenComment(n,!1)},n.prototype.resolveOrReopenComment=function(n,t){n.isResolved=t;for(var i=0;i<n.replyComments.length;i++)n.replyComments[i].isResolved=t},n.prototype.replyComment=function(n,t){var e,a,r,u,i;if(!this.owner.isReadOnlyMode&&(e=n,n)){this.initComplexHistory("InsertComment");var h=e.commentStart,c=e.commentEnd,v=h.line.getOffset(h,1),f=new l(this.documentHelper.owner);f.setPositionParagraph(h.line,v);a=c.line.getOffset(c,1);r=new l(this.documentHelper.owner);r.setPositionParagraph(c.line,a);this.selection.start.setPositionInternal(f);this.selection.end.setPositionInternal(r);f=this.selection.start;r=this.selection.end;u=new l(this.owner);u.setPositionInternal(r);var o=new g(0),s=new g(1),y=f.isInSameParagraph(r);r.setPositionInternal(f);this.initInsertInline(o);y&&u.setPositionParagraph(u.currentWidget,u.offset+o.length);f.setPositionInternal(u);r.setPositionInternal(u);this.initInsertInline(s);i=new rr((new Date).toISOString());i.author=this.owner.currentUser?this.owner.currentUser:"Guest user";i.text=t||"";i.commentId=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);i.isReply=!0;e.replyComments.push(i);i.ownerComment=e;this.owner.editorHistory&&(this.initHistory("InsertCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(i));o.comment=i;o.commentId=i.commentId;s.comment=i;s.commentId=i.commentId;i.commentStart=o;i.commentEnd=s;this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(i),this.editorHistory.updateHistory());this.editorHistory&&this.editorHistory.updateComplexHistory();this.reLayout(this.selection)}},n.prototype.removeInline=function(n){this.selection.start.setPositionParagraph(n.line,n.line.getOffset(n,0));this.selection.end.setPositionParagraph(this.selection.start.currentWidget,this.selection.start.offset+n.length);this.initHistory("RemoveInline");this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.updateHistoryPosition(this.selection.start,!0);this.removeSelectedContents(this.documentHelper.selection);this.editorHistory&&this.editorHistory.updateHistory();this.fireContentChange()},n.prototype.addCommentWidget=function(n,t){var u,f,i,e,o,r;if(-1===this.documentHelper.comments.indexOf(n)){if(u=!1,this.documentHelper.comments.length>0)for(f=this.selection.getElementPosition(n.commentStart).startPosition,i=0;i<this.documentHelper.comments.length;i++)if(e=this.selection.getElementPosition(this.documentHelper.comments[i].commentStart).startPosition,f.isExistBefore(e)){u=!0;this.documentHelper.comments.splice(i,0,n);break}u||this.documentHelper.comments.push(n);r={};r.comment=this.getCommentObj(n);r.index=this.documentHelper.comments.indexOf(n);r.isNewComment=t;o=JSON.stringify(r);this.owner.dotNetRef.invokeMethodAsync("AddCommentWidget",o)}},n.prototype.addReplyComment=function(n,t){var f,r=t.split(";"),u=this.documentHelper.comments[parseInt(r[1],10)],i;""!==r[2]&&(u.replyComments.splice(parseInt(r[2],10),0,n),n.ownerComment=u);i={};i.comment=this.getCommentObj(n);i.index=u.replyComments.indexOf(n);f=JSON.stringify(i);this.owner.dotNetRef.invokeMethodAsync("AddReplyComment",f)},n.prototype.getCommentObj=function(n){var t={};return t.date=n.date,t.text=n.text,t.isReply=n.isReply,t.isResolved=n.isResolved,t.author=n.author,t.initial=n.initial,t.commentId=n.commentId,t.userColor=this.documentHelper.getAuthorColor(n.author),n.ownerComment&&n.ownerComment.commentId&&(t.ownerCommentId=n.ownerComment.commentId),t},n.prototype.addProtection=function(n,t){if(""===n)this.protectDocument(t);else{this.currentProtectionType=t;var i=new bi,r={passwordBase64:this.base64.encodeString(n),saltBase64:"",spinCount:1e5},u=this.owner.serviceUrl+this.owner.serverActionSettings.restrictEditing;i.url=u;i.contentType="application/json;charset=UTF-8";i.onSuccess=this.enforceProtectionInternal.bind(this);i.onFailure=this.protectionFailureHandler.bind(this);i.onError=this.protectionFailureHandler.bind(this);i.customHeaders=this.owner.headers;i.send(r)}},n.prototype.protectionFailureHandler=function(){},n.prototype.enforceProtectionInternal=function(n,t){var i=JSON.parse(n.data);this.documentHelper.saltValue=i[0];this.documentHelper.hashValue=i[1];t&&(this.currentProtectionType=t);this.protectDocument(this.currentProtectionType)},n.prototype.protectDocument=function(n){this.protect(n)},n.prototype.stopProtection=function(n){if(this.documentHelper.isDocumentProtected){var t=new bi,i={passwordBase64:this.base64.encodeString(n),saltBase64:this.documentHelper.saltValue,spinCount:1e5};t.url=this.owner.serviceUrl+this.owner.serverActionSettings.restrictEditing;t.contentType="application/json;charset=UTF-8";t.customHeaders=this.owner.headers;t.onSuccess=this.onUnProtectionSuccess.bind(this);t.onFailure=this.protectionFailureHandler.bind(this);t.onError=this.protectionFailureHandler.bind(this);t.send(i)}},n.prototype.onUnProtectionSuccess=function(n){var t=JSON.parse(n.data);this.validateHashValue(t[1])},n.prototype.validateHashValue=function(n){var i=this.base64.decodeString(n),f=this.documentHelper.hashValue,u=this.base64.decodeString(f),r=!0,t;if(i.length===u.length){for(t=0;t<i.length;t++)if(i[t]!==u[t]){r=!1;break}}else r=!1;r&&this.unProtectDocument()},n.prototype.unProtectDocument=function(){this.documentHelper.isDocumentProtected=!1;this.documentHelper.restrictFormatting=!1;this.documentHelper.selection.highlightEditRegion()},n.prototype.fireContentChange=function(){this.selection.isHighlightEditRegion&&this.selection.onHighlight();this.selection.highlightFormFields();this.isPaste||(this.copiedContent=void 0,this.copiedTextContent="",this.previousSectionFormat=void 0,this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.selection.isViewPasteOptions=!1,this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.selection.showHidePasteOptions(void 0,void 0));this.documentHelper.owner.isLayoutEnabled&&!this.documentHelper.owner.isShiftingEnabled&&this.documentHelper.owner.fireContentChange();sf.base.isNullOrUndefined(this.selection.editPosition)||(this.triggerPageSpellCheck=!1)},n.prototype.updateSelectionTextPosition=function(n){this.getOffsetValue(this.selection);this.selection.start.updatePhysicalPosition(!0);this.selection.isEmpty?this.selection.end.setPositionInternal(this.selection.start):this.selection.end.updatePhysicalPosition(!0);this.selection.upDownSelectionLength=this.selection.end.location.x;this.selection.fireSelectionChanged(n)},n.prototype.predictText=function(){this.documentHelper.suffix="";this.selection.start.paragraph.isEmpty()||0===this.selection.start.offset&&this.selection.start.currentWidget.isFirstLine()||0===this.selection.end.offset&&this.selection.end.currentWidget.isFirstLine()?this.documentHelper.prefix="":this.getPrefixAndSuffix();this.documentHelper.prefix="@"+String.fromCharCode(160)+this.documentHelper.prefix;this.documentHelper.editableDiv.innerText=this.documentHelper.prefix;this.documentHelper.selection.setEditableDivCaretPosition(this.documentHelper.prefix.length)},n.prototype.getPrefixAndSuffix=function(){var n=this.owner.documentHelper,h,r,u,c,l;if(""===this.selection.text){var e=0,a=this.selection.start.currentWidget.getInline(this.selection.start.offset,e),t=a.element;if((e=a.index,void 0!==t)&&(h=this.selection.getElementBoxInternal(t,e),r=h.element,e=h.index,u=0,!sf.base.isNullOrUndefined(r))){for(c=!1,_instanceof(r,i)&&e>0&&r.line.isFirstLine()&&(n.prefix=""),_instanceof(t,i)||(t=this.selection.getPreviousTextElement(t));(u=n.prefix.lastIndexOf(" "))<0&&_instanceof(t,i);)if(_instanceof(t.previousNode,i)&&-1===n.prefix.indexOf(" ")){if(c?n.prefix=t.text+n.prefix:(n.prefix=t.text.substring(0,e),c=!0),_instanceof(t=t.previousNode,o))break;_instanceof(t,i)||(t=this.selection.getPreviousTextElement(t))}else if(!_instanceof(t.previousNode,i)){c?n.prefix=t.text+n.prefix:(n.prefix=t.text.substring(0,e),c=!0);break}n.prefix.length>1&&" "===n.prefix[n.prefix.length-1]&&"."===n.prefix[n.prefix.length-2]?(u=-1,n.prefix=""):u=n.prefix.lastIndexOf(" ");n.prefix=u<0?n.prefix:n.prefix.substring(u);0===n.prefix.indexOf(" ")&&n.prefix.length>=1&&(n.prefix=n.prefix.substring(1));var s=0,v=this.selection.end.currentWidget.getInline(this.selection.end.offset,s),f=v.element;if(s=v.index,r=(h=this.selection.getElementBoxInternal(f,s)).element,s=h.index,r){for(l=!1,_instanceof(r,i)&&s<r.length&&(n.suffix="");(u=n.suffix.indexOf(" "))<0&&_instanceof(f,i);)if(_instanceof(f.nextNode,i)&&-1===n.suffix.indexOf(" "))l?n.suffix=n.suffix+f.text:(n.suffix=r.text.substring(s),l=!0),f=f.nextNode;else if(!_instanceof(f.nextNode,i)){l?n.suffix=n.suffix+f.text:(n.suffix=r.text.substring(s),l=!0);break}u=n.suffix.indexOf(" ");n.suffix=u<0?n.suffix:n.suffix.substring(0,u)}}}else n.prefix=""},n.prototype.onKeyDownInternal=function(n,t,i,r){var u=n.which||n.keyCode,f;if(!t||i||r)if(!i||t||r)if(i&&t&&!r)switch(u){case 68:this.owner.isReadOnlyMode||this.owner.selection.toggleUnderline("Double");break;case 77:this.owner.isReadOnlyMode||this.owner.selection.decreaseIndent();n.preventDefault();break;case 188:n.preventDefault();this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 190:n.preventDefault();this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:n.preventDefault();this.owner.isReadOnlyMode||this.toggleBaselineAlignment("Superscript");break;case 69:(n.preventDefault(),this.owner.isReadOnlyMode)||this.owner.enableTrackChanges}else if(!i&&t&&r)switch(u){case 72:n.preventDefault();!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.toggleHighlightColor();break;case 70:n.preventDefault();!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.insertFootnote();break;case 68:n.preventDefault();!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.insertEndnote()}else switch(u){case 8:n.preventDefault();this.handleBackKey();break;case 9:n.preventDefault();this.owner.acceptTab&&this.selection.handleTabKey(!0,!1);break;case 13:n.preventDefault();this.documentHelper.triggerSpellCheck=!0;this.handleEnterKey();this.documentHelper.triggerSpellCheck=!1;break;case 27:n.preventDefault();this.isPaste||(this.copiedContent=void 0,this.copiedTextContent="",this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.previousSectionFormat=void 0,this.selection.isViewPasteOptions=!1,this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.selection.showHidePasteOptions(void 0,void 0));break;case 46:this.handleDelete();n.preventDefault();break;case 32:this.selection.handleSpaceBarKey();break;case 120:f=this.selection.getDocumentEnd();f.offset=this.selection.getDocumentEnd().offset+1;this.selection.start.isAtSamePosition(this.selection.getDocumentStart())&&this.selection.end.isAtSamePosition(f)?this.owner.updateFields():this.selection.updateRefField()}else switch(u){case 9:n.preventDefault();this.owner.acceptTab&&this.selection.handleTabKey(!1,!0);break;case 13:this.handleShiftEnter();n.preventDefault()}else switch(this.documentHelper.isControlPressed=!0,u){case 8:n.preventDefault();this.handleCtrlBackKey();break;case 46:n.preventDefault();this.handleCtrlDelete();break;case 9:n.preventDefault();this.owner.acceptTab&&this.selection.handleTabKey(!1,!1);break;case 13:n.preventDefault();this.insertPageBreak();break;case 48:n.preventDefault();this.onApplyParagraphFormat("beforeSpacing",0,!1,!1);break;case 49:n.preventDefault();this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",1,!1,!1);break;case 50:n.preventDefault();this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",2,!1,!1);break;case 53:n.preventDefault();this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",1.5,!1,!1);break;case 66:n.preventDefault();this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleBold();break;case 68:n.preventDefault();this.owner.showDialog("Font");break;case 69:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Center");n.preventDefault();break;case 72:n.preventDefault();this.owner.isReadOnly||this.owner.showDialog("ReplacePane");break;case 73:n.preventDefault();this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleItalic();break;case 74:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Justify");n.preventDefault();break;case 75:n.preventDefault();this.owner.showDialog("Hyperlink");break;case 76:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Left");n.preventDefault();break;case 77:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.owner.selection.increaseIndent();n.preventDefault();break;case 78:n.preventDefault();this.owner.isReadOnlyMode||this.owner.openBlank();break;case 82:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Right");n.preventDefault();break;case 85:n.preventDefault();this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.owner.selection.toggleUnderline("Single");break;case 88:n.preventDefault();this.owner.isReadOnlyMode||this.owner.editor.cut();break;case 89:this.owner.enableEditorHistory&&(this.editorHistory.redo(),n.preventDefault());break;case 90:this.owner.enableEditorHistory&&(this.editorHistory.undo(),n.preventDefault());break;case 219:n.preventDefault();this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 221:n.preventDefault();this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:n.preventDefault();this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleBaselineAlignment("Subscript")}},n.prototype.handleShiftEnter=function(){this.owner.isReadOnlyMode||this.handleTextInput("\v");this.selection.checkForCursorVisibility()},n.prototype.handleBackKey=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&this.owner.editorModule.onBackSpace();this.selection.checkForCursorVisibility()},n.prototype.handleDelete=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&this.owner.editorModule.delete();this.selection.checkForCursorVisibility()},n.prototype.handleEnterKey=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&(sf.base.Browser.isDevice&&(this.documentHelper.isCompositionStart=!1),this.owner.editorModule.onEnter());this.selection.checkForCursorVisibility()},n.prototype.handleCtrlBackKey=function(){var n=this.selection.start,t=this.selection.end;if(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())if(this.selection.isForward||(n=t),this.selection.isEmpty)this.selection.handleControlShiftLeftKey(),this.owner.editorModule.onBackSpace();else{if((sf.base.isNullOrUndefined(n.paragraph.previousRenderedWidget)||_instanceof(n.paragraph.previousRenderedWidget,f))&&0===n.offset)return;this.selection.handleLeftKey();this.selection.handleControlShiftLeftKey();this.owner.editorModule.onBackSpace()}},n.prototype.handleCtrlDelete=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())if(this.selection.isEmpty)this.selection.handleControlShiftRightKey(),this.owner.editorModule.delete();else{this.selection.handleLeftKey();this.selection.handleControlShiftRightKey();var n=this.selection.text;t.endsWith(n)&&this.selection.handleShiftLeftKey();this.owner.editorModule.delete()}},n.prototype.handleTextInput=function(n){var t=this;(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&(this.animationTimer&&clearTimeout(this.animationTimer),sf.base.classList(this.selection.caret,[],["e-de-cursor-animation"]),this.owner.editorModule.insertText(n),this.animationTimer=setTimeout(function(){t.animationTimer&&clearTimeout(t.animationTimer);t.selection&&t.selection.caret&&sf.base.classList(t.selection.caret,["e-de-cursor-animation"],[])},600));this.selection.checkForCursorVisibility()},n.prototype.copyInsertFormat=function(n,t){var r=new p,i=this.selection.characterFormat;return t&&r.copyFormat(n),sf.base.isNullOrUndefined(i.bold)||n.bold===i.bold||(r.bold=i.bold),sf.base.isNullOrUndefined(i.italic)||n.italic===i.italic||(r.italic=i.italic),i.fontSize>0&&n.fontSize!==i.fontSize&&(r.fontSize=i.fontSize),sf.base.isNullOrUndefined(i.fontFamily)||n.fontFamily===i.fontFamily||(r.fontFamily=i.fontFamily),sf.base.isNullOrUndefined(i.highlightColor)||n.highlightColor===i.highlightColor||(r.highlightColor=i.highlightColor),sf.base.isNullOrUndefined(i.baselineAlignment)||n.baselineAlignment===i.baselineAlignment||(r.baselineAlignment=i.baselineAlignment),sf.base.isNullOrUndefined(i.fontColor)||n.fontColor===i.fontColor||(r.fontColor=i.fontColor),sf.base.isNullOrUndefined(i.underline)||n.underline===i.underline||(r.underline=i.underline),sf.base.isNullOrUndefined(i.strikethrough)||n.strikethrough===i.strikethrough||(r.strikethrough=i.strikethrough),r},n.prototype.getResultContentControlText=function(n){for(var t=n.nextNode,r="";!(_instanceof(t,w)||(_instanceof(t,i)&&(r+=t.text),sf.base.isNullOrUndefined(t)));)if(sf.base.isNullOrUndefined(t.nextNode)){if(!t.paragraph.nextRenderedWidget)break;t=t.paragraph.nextRenderedWidget.firstChild.children[0]}else t=t.nextNode;return r},n.prototype.updateXmlMappedContentControl=function(){if(this.isXmlMapped){var n=this.getContentControl();n&&n.contentControlProperties&&this.updateCustomXml(n.contentControlProperties.xmlMapping.storeItemId,n.contentControlProperties.xmlMapping.xPath,this.getResultContentControlText(n))}},n.prototype.updateCustomXml=function(n,t,i){var f,e;if(this.documentHelper.customXmlData.containsKey(n)){var o=this.documentHelper.customXmlData.get(n),u=(new DOMParser).parseFromString(o,"text/xml"),r=t.substring(t.lastIndexOf("/")+1);if(r=(r=(r=r.split("[")[0]).substring(r.lastIndexOf(":")+1)).substring(r.lastIndexOf("@")+1),f=u.getElementsByTagName(r),f.length>0)f[0].childNodes[0].nodeValue=i;else{if(!(u.documentElement.attributes.length>0&&null!==u.documentElement.attributes.getNamedItem(r)))return;u.documentElement.attributes.getNamedItem(r).value=i}e=(new XMLSerializer).serializeToString(u);this.documentHelper.customXmlData.set(n,e)}},n.prototype.insertText=function(n){sf.base.isNullOrUndefined(n)||""===n||this.insertTextInternal(n,!1)},n.prototype.insertTextInternal=function(n,t,u){var rt,v,s,it,y,ct,g,p,lt,h,w,c,ut,l,ft,pt,o,et,st,a,ht;if("FormFieldsOnly"===this.documentHelper.protectionType&&this.selection.isInlineFormFillMode()){var f=this.selection.getCurrentFormField(),tt=this.getFormFieldText(),wt=new RegExp(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),"gi");if(tt.length>0&&""===tt.replace(wt,"")&&(tt="",this.selection.selectFieldInternal(f)),rt=f.formFieldData.maxLength,0!==rt&&tt.length>=rt)return}if(s=this.documentHelper.selection,it=!0,u=this.owner.enableTrackChanges&&sf.base.isNullOrUndefined(u)?"Insertion":u,this.isListTextSelected(),(sf.base.isNullOrUndefined(u)||"Insertion"===u)&&this.initHistory("Insert"),y=this.selection.getParagraphInfo(s.start),ct=y.paragraph.paragraphFormat,s.editPosition=s.getHierarchicalIndex(y.paragraph,y.offset.toString()),g=s.start.paragraph.paragraphFormat.bidi,(s.isEmpty||s.isImageSelected)&&(!this.documentHelper.isListTextSelected||"List"!==s.contextType)?!s.isEmpty||this.documentHelper.isListTextSelected||t||(this.documentHelper.isTextInput=!0):(s.isSkipLayouting=!0,s.skipFormatRetrieval=!0,p=void 0,this.owner.enableTrackChanges&&(p=this.selection.start.isExistBefore(this.selection.end)?this.selection.end.clone():this.selection.start.clone(),this.skipReplace=!0),it=this.removeSelectedContents(s),this.skipReplace=!1,!sf.base.isNullOrUndefined(p)&&this.owner.search.isRepalceTracking?(this.owner.search.isRepalceTracking=!1,this.selection.start.setPositionInternal(this.selection.start),this.selection.end.setPositionInternal(p)):sf.base.isNullOrUndefined(p)||(this.selection.start.setPositionInternal(p),this.selection.end.setPositionInternal(p)),s.skipFormatRetrieval=!1,s.isSkipLayouting=!1),(y=this.selection.getParagraphInfo(s.start)).paragraph.paragraphFormat.copyFormat(ct),lt=this.documentHelper.textHelper.containsSpecialCharAlone(n),it){if(s.owner.isShiftingEnabled=!0,this.updateInsertPosition(),(v=s.start).paragraph.isEmpty())h=new i,w=this.copyInsertFormat(v.paragraph.characterFormat,!0),h.characterFormat.copyFormat(w),h.text=n,c=this.documentHelper.textHelper.getRtlLanguage(n).isRtl,(h.characterFormat.bidi=c,h.isRightToLeft=c,h.line=v.paragraph.childWidgets[0],h.margin=new hi(0,0,0,0),h.line.children.push(h),this.owner.enableTrackChanges)&&(h.paragraph.characterFormat.revisions.length>0?(ut=this.getMatchedRevisionsToCombine(h.paragraph.characterFormat.revisions,u),ut.length>0&&this.mapMatchedRevisions(ut,h.paragraph.characterFormat,h,!0)):this.checkToCombineRevisionWithPrevPara(h,u)||this.insertRevision(h,u)),"Center"!==v.paragraph.paragraphFormat.textAlignment&&"Right"!==v.paragraph.paragraphFormat.textAlignment||-1!==v.paragraph.paragraphFormat.listFormat.listId||(v.paragraph.x=this.owner.viewer.clientActiveArea.x),this.documentHelper.layout.reLayoutParagraph(v.paragraph,0,0);else{l=0;ft=v.currentWidget.getInline(v.offset,l,g,!t);f=ft.element;l=ft.index;f.ischangeDetected=!0;_instanceof(f,i)&&" "!==n&&this.documentHelper.owner.isSpellCheck&&(this.owner.spellChecker.removeErrorsFromCollection({element:f,text:f.text}),t||(f.ignoreOnceItems=[]));f.canTrigger&&f.text.length<=1&&(f.canTrigger=!1);w=this.copyInsertFormat(f.characterFormat,!0);c=this.documentHelper.textHelper.getRtlLanguage(n).isRtl;var bt=this.documentHelper.textHelper.getRtlLanguage(n).id,at=0,d=!1,vt=!1;if(_instanceof(f,i)&&(at=this.documentHelper.textHelper.getRtlLanguage(f.text).id,d=this.documentHelper.textHelper.getRtlLanguage(f.text).isRtl,vt=this.documentHelper.textHelper.containsSpecialCharAlone(f.text)),!c&&this.documentHelper.owner.isSpellCheck||(w.bidi=c),(!this.documentHelper.owner.isSpellCheck||" "!==n&&" "!==f.text)&&w.isSameFormat(f.characterFormat)&&this.canInsertRevision(f,u)&&bt===at||""===n.trim()&&!c&&f.characterFormat.bidi||d&&w.isSameFormat(f.characterFormat)&&lt)this.insertTextInline(f,s,n,l);else{pt=this.documentHelper.layout.isContainsRtl(s.start.currentWidget);o=new i;o.text=n;o.line=f.line;o.isRightToLeft=d;o.characterFormat.copyFormat(w);_instanceof(f,yt)&&(o.characterFormat.baselineAlignment="Normal");var b=!1,k=f.indexInOwner,nt=o.revisions.length;l===f.length?(et=f.line.paragraph.bidi,et&&_instanceof(f,r)&&1===f.fieldType&&(k=(f=f.fieldBegin).indexInOwner),st=-1,st=et||_instanceof(f,ot)||pt&&vt||d&&c?k:k+1,!this.owner.enableTrackChanges||_instanceof(f,e)||(b=this.checkToMapRevisionWithInlineText(f,l,o,c,u))||o.revisions.length!==nt||(b=this.checkToMapRevisionWithNextNode(f.nextNode,o,c,u)),b||(f.line.children.splice(st,0,o),this.checkToCombineRevisionsinBlocks(o,nt===o.revisions.length,!0,u))):0===l?(this.owner.enableTrackChanges&&((b=this.checkToMapRevisionWithInlineText(f,l,o,c,u))||0!==o.revisions.length||this.checkToMapRevisionWithPreviousNode(f.previousNode,o,c,u)),b||(d&&!c?f.line.children.splice(k+1,0,o):f.line.children.splice(k,0,o),this.checkToCombineRevisionsinBlocks(o,nt===o.revisions.length,!0,u))):(_instanceof(f,i)&&(a=new i,a.line=f.line,a.characterFormat.copyFormat(f.characterFormat),g&&d&&!c?(a.text=f.text.slice(0,l),this.owner.enableTrackChanges||this.updateRevisionForSpittedTextElement(f,a),f.text=f.text.substring(l)):(a.text=f.text.substring(l),this.owner.enableTrackChanges||this.selection.isInField||this.updateRevisionForSpittedTextElement(f,a),f.text=f.text.slice(0,l)),this.owner.enableTrackChanges?(b=this.checkToMapRevisionWithInlineText(f,l,o,c,u))||o.revisions.length>nt?this.copyElementRevision(f,a,!0):o.revisions.length===nt&&(this.updateRevisionForSpittedTextElement(f,a),this.insertRevision(o,u)):this.selection.isInField&&(this.copyElementRevision(f,a,!1),this.updateElementInFieldRevision(f,o,f.revisions,!0)),this.owner.isSpellCheck&&this.owner.spellChecker.updateSplittedElementError(f,a),f.line.children.splice(k+1,0,a)),b||f.line.children.splice(k+1,0,o));!g&&this.documentHelper.layout.isContainsRtl(s.start.currentWidget)&&this.documentHelper.layout.reArrangeElementsForRtl(s.start.currentWidget,g);this.documentHelper.layout.reLayoutParagraph(v.paragraph,f.line.indexInOwner,0)}}this.setPositionParagraph(y.paragraph,y.offset+n.length,!0);this.updateEndPosition();sf.base.isNullOrUndefined(this.editorHistory)||sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||"ListSelect"!==this.editorHistory.currentHistoryInfo.action||!this.documentHelper.isListTextSelected||(this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory());(sf.base.isNullOrUndefined(u)||"Insertion"===u)&&this.reLayout(s);this.documentHelper.isTextInput=!1}if((this.updateXmlMappedContentControl(),!t&&it&&(" "===n||"\t"===n||"\v"===n))&&(ht=!1,"\v"!==n&&(ht=this.checkAndConvertList(s,"\t"===n)),!ht)){if(!sf.base.isNullOrUndefined(s.getHyperlinkField()))return;this.checkAndConvertToHyperlink(s,!1)}},n.prototype.updateElementInFieldRevision=function(n,t,i,r){for(var f,e,u=0;u<i.length;u++)f=i[u],e=f.range.indexOf(n),f.range.splice(r?e+1:e,0,t)},n.prototype.retrieveFieldResultantText=function(n){var r="",t;if(1===n.fieldType)for(t=n.previousElement;!sf.base.isNullOrUndefined(t)&&_instanceof(t,i);)r=t.text+r,t=sf.base.isNullOrUndefined(t.previousNode)?void 0:t.previousNode.previousValidNodeForTracking;return r},n.prototype.checkToCombineRevisionsinBlocks=function(n,t,i,r){!t||!this.owner.enableTrackChanges||_instanceof(n,e)||_instanceof(n,g)||_instanceof(n,ht)||_instanceof(n,ot)||(i?this.combineRevisionWithNextPara(n,r):this.combineRevisionWithPrevPara(n,r))||this.insertRevision(n,r)},n.prototype.checkToMapRevisionWithNextNode=function(n,t,i,r){if(sf.base.isNullOrUndefined(n))return!1;var u=n.nextValidNodeForTracking;return!sf.base.isNullOrUndefined(u)&&this.checkToMapRevisionWithInlineText(u,0,t,i,r)},n.prototype.checkToMapRevisionWithPreviousNode=function(n,t,i,r){if(sf.base.isNullOrUndefined(n))return!1;var u=n.previousValidNodeForTracking;return!sf.base.isNullOrUndefined(u)&&this.checkToMapRevisionWithInlineText(u,u.length,t,i,r)},n.prototype.checkToMapRevisionWithInlineText=function(n,t,i,r,u){if(!sf.base.isNullOrUndefined(n))if("Deletion"===u&&this.updateLastElementRevision(i),n.length===t){if(t=(n=n.previousValidNodeForTracking).length,n.revisions.length>0)return this.applyMatchedRevisionInorder(n,i,t,!1,r,u)}else if(0===t&&(n=n.nextValidNodeForTracking,!sf.base.isNullOrUndefined(n)&&n.revisions.length>0))return this.applyMatchedRevisionInorder(n,i,t,!0,r,u);return!1},n.prototype.combineElementRevisions=function(n,t){var r,i,u,f;if(0!==n.revisions.length&&0!==t.revisions.length)for(r=0;r<n.revisions.length;r++)for(i=n.revisions[r],u=0;u<t.revisions.length;u++)f=t.revisions[r],-1===i.range.indexOf(t)&&f.revisionType===i.revisionType&&f.author===i.author&&(t.revisions.splice(u,1),i.range.push(t),t.revisions.splice(u,0,i))},n.prototype.applyMatchedRevisionInorder=function(n,t,i,r,u,f){var e=this.getMatchedRevisionsToCombine(n.revisions,f);return e.length>0&&this.mapMatchedRevisions(e,n,t,r),!1},n.prototype.copyElementRevision=function(n,t,i){var r,u,f;if(!this.isTrackingFormField)for(r=0;r<n.revisions.length;r++)u=n.revisions[r],f=u.range.indexOf(n),t.revisions.splice(0,0,u),u.range.splice(f+(i?2:1),0,t)},n.prototype.mapMatchedRevisions=function(n,t,i,r){for(var u,e,f=0;f<n.length;f++)u=n[f],(!this.isRevisionAlreadyIn(i,u)||_instanceof(i,p))&&(i.revisions.splice(0,0,u),e=u.range.indexOf(t),u.range.splice(r?e:e+1,0,i))},n.prototype.isRevisionAlreadyIn=function(n,t){if(n.revisions.length>0)for(var i=0;i<n.revisions.length;i++)if(n.revisions[i].revisionID===t.revisionID)return!0;return!1},n.prototype.getMatchedRevisionsToCombine=function(n,t){for(var r=[],i=0;i<n.length;i++)this.isRevisionMatched(n[i],t)&&r.push(n[i]);return r},n.prototype.decideInlineForTrackChanges=function(n,t){var r=!1,i;return this.owner.enableTrackChanges&&!this.canInsertRevision(n,t)&&(i=n.nextValidNodeForTracking,!sf.base.isNullOrUndefined(i)&&this.canInsertRevision(i,t)&&(n=i,r=!0)),{element:n,isMatched:r}},n.prototype.insertIMEText=function(n,t){var u,f,i,r;this.documentHelper.lastComposedText===n&&t||(u=this.selection.getParagraphInfo(this.selection.start),f=this.selection.getHierarchicalIndex(u.paragraph,u.offset.toString()),this.insertText(n),this.documentHelper.lastComposedText=n,i=this.selection.start,this.setPositionForCurrentIndex(i,f),r=new l(this.owner),r.setPositionForLineWidget(i.currentWidget,i.offset+n.length),this.selection.selectPosition(t?i:r,r))},n.prototype.insertSectionBreak=function(){var n=this.documentHelper.selection;sf.base.isNullOrUndefined(n)||this.owner.isReadOnlyMode||n.start.paragraph.isInHeaderFooter||(this.initHistory("SectionBreak"),n.isEmpty||n.selectContent(n.isForward?n.start:n.end,!0),this.documentHelper.owner.isShiftingEnabled=!0,this.updateInsertPosition(),this.insertSection(n,!0),this.updateEndPosition(),this.reLayout(n,!0),"Continuous"===this.owner.layoutType&&this.layoutWholeDocument())},n.prototype.combineRevisionWithBlocks=function(n,t){var u,s,r,c,l,h,i,o,a;if(this.owner.enableTrackChanges&&!sf.base.isNullOrUndefined(n)){for(;_instanceof(n,e)||_instanceof(n,g);)n=n.nextElement;if(!sf.base.isNullOrUndefined(n)&&(u=n.paragraph.previousRenderedWidget,!_instanceof(u,f))){if(!sf.base.isNullOrUndefined(u)&&!u.isEmpty()&&u.characterFormat.revisions.length>0){if(s=u.lastChild,sf.base.isNullOrUndefined(s)||0===s.children.length)return;for(r=s.children[s.children.length-1];_instanceof(r,e)||_instanceof(r,g);)r=r.previousElement;r.revisions.length>0&&this.compareElementRevision(u.characterFormat,n)&&(c=n.revisions[n.revisions.length-1],this.compareElementRevision(r,n)&&c!==(o=r.revisions[r.revisions.length-1])&&this.clearAndUpdateRevisons(c.range,o,o.range.indexOf(r)+1))}if(u=null,l=n.paragraph.lastChild,h=(n=l.children[l.children.length-1]).paragraph.nextRenderedWidget,!_instanceof(h,f)){if(!sf.base.isNullOrUndefined(h)&&!h.isEmpty()&&n.paragraph.characterFormat.revisions.length>0){for(i=h.firstChild.children[0];_instanceof(i,e)||_instanceof(i,g);)i=i.previousElement;if(sf.base.isNullOrUndefined(i))return;i.revisions.length>0&&(a=i.revisions[i.revisions.length-1],this.compareElementRevision(n.paragraph.characterFormat,i)&&this.compareElementRevision(n,i)&&a!==(o=n.revisions[n.revisions.length-1])&&this.clearAndUpdateRevisons(a.range,o,o.range.indexOf(n)+1))}0===n.revisions.length&&this.insertRevision(n,t)}}}},n.prototype.checkToCombineRevisionWithNextPara=function(n,t){var r=n.paragraph.nextRenderedWidget,i,u;if(_instanceof(r,f))return!1;if(!sf.base.isNullOrUndefined(r)&&!r.isEmpty()){for(i=r.firstChild.children[0];_instanceof(i,e)||_instanceof(i,g);)i=i.previousElement;if(sf.base.isNullOrUndefined(i))return!1;if(i.revisions.length>0&&(u=this.getMatchedRevisionsToCombine(i.revisions,t),u.length>0))return this.mapMatchedRevisions(u,i,n,!0),!0}return!1},n.prototype.checkToCombineRevisionWithPrevPara=function(n,t){var i=n.paragraph.previousRenderedWidget,r;if(_instanceof(i,f))return!1;if(!sf.base.isNullOrUndefined(i)&&i.characterFormat.revisions.length>0){if(!this.isRevisionMatched(i.characterFormat,t))return!1;if(r=this.getMatchedRevisionsToCombine(i.characterFormat.revisions,t),r.length>0)return this.mapMatchedRevisions(r,i.characterFormat,n,!1),!0}return!1},n.prototype.combineRevisionWithNextPara=function(n,t){var i=n.line.isLastLine(),r=n.nextNode;return!(!i||!sf.base.isNullOrUndefined(r))&&this.checkToCombineRevisionWithNextPara(n,t)},n.prototype.combineRevisionWithPrevPara=function(n,t){var i=n.line.isFirstLine(),r=n.previousNode;return!(!i||!sf.base.isNullOrUndefined(r))&&this.checkToCombineRevisionWithPrevPara(n,t)},n.prototype.removeRevision=function(n){var f=this.selection.start.currentWidget.getInline(this.selection.start.offset+1,0),i=f.element,t;if(f.element.revisions.length>0)for(t=0;t<i.revisions.length;t++)if(i.revisions[t].revisionType===n.revisionType)for(var r=i.revisions[t],u=r.range.indexOf(i),e=u;u<r.range.length;u++)r.range[e].revisions.splice(t,1),r.range.splice(e,1)},n.prototype.clearElementRevision=function(n){var t,i;if(!sf.base.isNullOrUndefined(n))for(t=0;t<n.range.length;t++)_instanceof(n.range[t],tt)&&(i=n.range[t],i.revisions.splice(i.revisions.length-1,1),n.range.splice(t,1))},n.prototype.insertRevision=function(n,t,i,r,f){var c,o,l,s,h,e;if(i=sf.base.isNullOrUndefined(i)?this.owner.currentUser?this.owner.currentUser:"Guest user":i,c=sf.base.isNullOrUndefined(r)?(new Date).toISOString():r,(_instanceof(n,tt)&&!sf.base.isNullOrUndefined(n.line)&&n.line.paragraph.associatedCell||_instanceof(n,p)&&_instanceof(n.ownerBase,u)&&n.ownerBase.associatedCell)&&(o=void 0,(_instanceof(n,tt)?o=n.line.paragraph.associatedCell:_instanceof(n,p)&&(o=n.ownerBase.associatedCell),o.ownerRow.rowFormat.revisions.length>0)&&(l=o.ownerRow.rowFormat,s=this.getMatchedRevisionsToCombine(l.revisions,t),s.length>0))){for(h=0;h<s.length;h++)n.revisions.splice(0,0,s[h]),s[h].range.push(n);return}e=new ii(this.owner,i,c);e.revisionType=t;e.revisionID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);!sf.base.isNullOrUndefined(f)&&f.length>0?this.clearAndUpdateRevisons(f,e,f.indexOf(n)):(n.revisions.push(e),e.range.push(n));this.updateRevisionCollection(e)},n.prototype.clearAndUpdateRevisons=function(n,t,i){for(var u,r=0;r<n.length;r++)_instanceof(n[r],tt)&&(u=n[r],u.revisions.splice(u.revisions.length-1,1),u.revisions.push(t),t.range.splice(i+r,0,u))},n.prototype.splitRevisionByElement=function(n,t){if(n.revisions.length>0){var i=t.range,r=i.indexOf(n);return t.range=i.splice(0,r+1),i}},n.prototype.updateRevisionForSpittedTextElement=function(n,t){for(var i,u,r=0;r<n.revisions.length;r++)i=n.revisions[r],u=this.splitRevisionByElement(n,i),this.insertRevision(t,i.revisionType,i.author,i.date,u)},n.prototype.isRevisionMatched=function(n,t){var u=this.owner.currentUser?this.owner.currentUser:"Guest user",i,r;if(_instanceof(n,ii)){if((sf.base.isNullOrUndefined(t)||t===n.revisionType)&&n.author===u)return!0}else if(n.revisions.length>0)for(i=0;i<n.revisions.length;i++)if(r=n.revisions[i],(sf.base.isNullOrUndefined(t)||t===r.revisionType)&&r.author===u)return!0;return!1},n.prototype.compareElementRevision=function(n,t){var i,r,u;if(0===n.revisions.length||0===t.revisions.length)return!1;for(i=0;i<n.revisions.length;i++)for(r=n.revisions[i],u=0;u<t.revisions.length;u++)if(r.author===t.revisions[i].author&&r.revisionType===t.revisions[i].revisionType)return!0;return!1},n.prototype.canInsertRevision=function(n,t){var i=sf.base.isNullOrUndefined(t)?"Insertion":t;return"Deletion"!==i&&(this.owner.enableTrackChanges?this.isRevisionMatched(n,i):!(n.revisions.length>0))},n.prototype.insertRevisionAtEnd=function(n,t,i){return!(_instanceof(t,e)||_instanceof(t,g)||_instanceof(t,ht)||_instanceof(t,ot))&&(n=n.previousValidNodeForTracking,!sf.base.isNullOrUndefined(n)&&this.insertRevisionAtPosition(n,t,!0,i))},n.prototype.insertRevisionAtPosition=function(n,t,i,r){var f=t.revisions.length,u=this.checkToMapRevisionWithInlineText(n,i?n.length:0,t,!1,r);return i?u||t.revisions.length!==f||(u=this.checkToMapRevisionWithNextNode(n.nextNode,t,!1,r)):u||t.revisions.length!==f||(u=this.checkToMapRevisionWithPreviousNode(n.previousNode,t,!1,r)),u},n.prototype.insertRevisionAtBegining=function(n,t,i){return!(_instanceof(t,e)||_instanceof(t,g)||_instanceof(t,ht)||_instanceof(t,ot))&&(n=n.nextValidNodeForTracking,!sf.base.isNullOrUndefined(n)&&this.insertRevisionAtPosition(n,t,!1,i))},n.prototype.splitRevisionForSpittedElement=function(n,t){for(var i,u,r=n.revisions.length-1;r>=0;r--)i=n.revisions[r],u=this.splitRevisionByElement(n,i),this.insertRevision(t,i.revisionType,i.author,i.date,u)},n.prototype.combineElementRevision=function(n,t){for(var e,u,i,s,o,f,r=0;r<n.length;r++)for(e=0;e<t.length;e++)if(u=n[r],i=t[r],u.author===i.author&&u.revisionType===i.revisionType){for(s=i.range.length,o=0;o<s;o++)f=i.range[0],f.revisions.splice(f.revisions.indexOf(i),1),i.range.splice(0,1),u.range.push(f),f.revisions.push(u);0===i.range.length&&this.owner.revisions.remove(i)}},n.prototype.combineRevisions=function(n,t){var i,r,u,f;this.owner.enableTrackChanges&&(i=this.selection.getLineInfo(n,t.offset).line.getInline(t.offset,0).element,i.revisions.length>0&&this.isRevisionMatched(i,"Insertion")&&(r=i.nextElement,!sf.base.isNullOrUndefined(r)&&r.revisions.length>0&&(u=i.revisions[i.revisions.length-1],f=r.revisions[r.revisions.length-1].range,this.clearAndUpdateRevisons(f,u,u.range.indexOf(i)+1))))},n.prototype.insertRevisionForBlock=function(n,t,i,r){var h,c,v,y,e,l,o,a,s,p;if(0!==n.childWidgets.length&&this.owner.enableTrackChanges)if("Deletion"===t){for(var w=this.selection.editPosition,b=this.selection.start.clone(),k=this.selection.end.clone(),f=0;f<n.childWidgets.length;f++)h=n.childWidgets[f],this.removeContent(h,0,this.documentHelper.selection.getLineLength(h));this.selection.editPosition=w;this.selection.start.setPositionInternal(b);this.selection.end.setPositionInternal(k);this.removeEmptyLine(n)}else{for(c=!1,sf.base.isNullOrUndefined(r)&&(v=this.owner.currentUser?this.owner.currentUser:"Guest user",y=(new Date).toISOString(),(r=new ii(this.owner,v,y)).revisionID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),r.revisionType=t),f=0;f<n.childWidgets.length;f++)for(e=n.childWidgets[f].children,0===e.length&&(l=n.containerWidget.childWidgets.indexOf(n),o=void 0,(l>0&&(o=n.containerWidget.childWidgets[l-1]),!sf.base.isNullOrUndefined(o)&&_instanceof(o,u)&&o.characterFormat.revisions.length>0&&this.isRevisionMatched(o.characterFormat,t))&&(a=this.getMatchedRevisionsToCombine(o.characterFormat.revisions,t),a.length>0&&(this.mapMatchedRevisions(a,o.characterFormat,n.characterFormat,!1),c=!0,r=void 0))),s=0;s<e.length;s++)0!==s||i?(e[s].revisions.push(r),r.range.push(e[s])):(p=e[f].revisions.length,this.checkToCombineRevisionsinBlocks(e[f],!0,!1,"Insertion"),e[f].revisions.length>p?r=e[f].revisions[e[f].revisions.length-1]:(e[s].revisions.push(r),r.range.push(e[s])));i||c||(n.characterFormat.revisions.push(r),r.range.push(n.characterFormat));sf.base.isNullOrUndefined(r)||this.updateRevisionCollection(r)}},n.prototype.updateRevisionCollection=function(n){var h=!1,r=void 0,f,i,t,e,o,u,c,s;if(this.owner.revisions.changes.indexOf(n)<0){if(this.documentHelper.revisionsInternal.containsKey(n.revisionID)||this.documentHelper.revisionsInternal.add(n.revisionID,n),this.owner.revisions.changes.length>0)for(f=this.owner.selection.start,i=0;i<this.owner.revisions.changes.length;i++)if(t=this.owner.revisions.changes[i].range[0],_instanceof(t,tt)&&!sf.base.isNullOrUndefined(t.line)&&t.line.paragraph.bodyWidget?r=this.selection.getElementPosition(this.owner.revisions.changes[i].range[0]).startPosition:_instanceof(t,ti)?(e=t.ownerBase.childWidgets[0],this.selection.getFirstParagraph(e).bodyWidget&&(o=this.documentHelper.selection,this.updateEditPosition(e,o),r=this.selection.getTextPosBasedOnLogicalIndex(o.editPosition))):_instanceof(t,p)&&(u=t.ownerBase,u.lastChild&&u.lastChild.paragraph.bodyWidget&&(c=u.getLength(),s=new l(this.owner),s.setPositionParagraph(u.lastChild,c),r=s)),!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(f)&&f.isExistBefore(r)){h=!0;this.owner.revisions.changes.splice(i,0,n);break}h||this.owner.revisions.changes.push(n);this.documentHelper.updateAuthorIdentity()}},n.prototype.insertSection=function(n,t){var i,r,v=this.selection.start.paragraph.bodyWidget.sectionFormat.cloneFormat(),o,s,e,c,h,l,a;return n.start.paragraph.isInsideTable?(o=this.documentHelper.layout.getParentTable(n.start.paragraph),o=o.combineWidget(this.owner.viewer),s=!1,0===n.start.paragraph.associatedCell.rowIndex&&(s=!0),e=new u,c=o.previousRenderedWidget,s?i=o:(i=this.splitTable(o,n.start.paragraph.associatedCell.ownerRow),this.documentHelper.layout.layoutBodyWidgetCollection(i.index,i.containerWidget,i,!1),i=i.getSplitWidgets().pop()),h=0,!sf.base.isNullOrUndefined(c)&&c.bodyWidget.equals(i.bodyWidget)||!s?(h=i.indexInOwner+1,e.index=i.index+1):(h=0,e.index=0),i.containerWidget.childWidgets.splice(h,0,e),e.containerWidget=i.containerWidget,this.updateNextBlocksIndex(e,!0),this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),i=e):(l=this.selection.getParagraphInfo(n.start),a=this.selection.getHierarchicalIndex(l.paragraph,l.offset.toString()),this.splitParagraphInternal(n,n.start.paragraph,n.start.currentWidget,n.start.offset),this.setPositionForCurrentIndex(n.start,a),i=n.start.paragraph.getSplitWidgets().pop()),_instanceof(r=this.splitBodyWidget(i.bodyWidget,v,i).firstChild,f)&&r.updateRowIndex(0),this.documentHelper.layout.layoutBodyWidgetCollection(r.index,r.containerWidget,r,!1),_instanceof(r,f)&&(r=n.getFirstParagraphInFirstCell(r)),t&&n.selectParagraphInternal(r,!0),r},n.prototype.splitBodyWidget=function(n,t,i){var r=this.documentHelper.layout.moveBlocksToNextPage(i);return this.updateSectionIndex(t,r,!0),this.insertRemoveHeaderFooter(r.sectionIndex,!0),_instanceof(this.documentHelper.viewer,rt)&&this.documentHelper.layout.layoutHeaderFooter(r,this.owner.viewer,r.page),this.updateBlockIndex(0,r.firstChild),this.owner.viewer.updateClientArea(r.sectionFormat,r.page),r},n.prototype.insertRemoveHeaderFooter=function(n){this.documentHelper.headersFooters[n]||(this.documentHelper.headersFooters[n]={})},n.prototype.updateBlockIndex=function(n,t){var i,u=t.bodyWidget.sectionIndex,r;do{for(i=t.getSplitWidgets(),r=0;r<i.length;r++)i[r].index=n;n++;t=i.pop().nextRenderedWidget}while(!sf.base.isNullOrUndefined(t)&&t.bodyWidget.sectionIndex===u)},n.prototype.updateSectionIndex=function(n,t,i){var u=t.sectionIndex,r=t;do r.index===u&&n&&(r.sectionFormat=n),i?r.index++:r.index--,r=r.nextRenderedWidget;while(r)},n.prototype.checkAndConvertList=function(n,r){var ut=n.paragraphFormat.getList(),l,a,g,b,rt,nt,e,v;if(!sf.base.isNullOrUndefined(ut)||_instanceof(n.start.paragraph.containerWidget,it))return!1;var h=!1,y=!1,o=0,tt=n.start.currentWidget.getInline(n.start.offset-1,o),c=tt.element;if(o=tt.index,!_instanceof(c,i))return!1;for(var f=c,u=f.text.substring(0,o),k=0,d=0;!sf.base.isNullOrUndefined(f.previousNode);){if(!_instanceof(f.previousNode,i)||"\t"!==f.previousNode.text&&0!==f.previousNode.text.trim().length)return!1;"\t"===f.previousNode.text?k+=36:d=2.5*f.previousNode.text.length;f=f.previousNode}for(f=c,l=0,a=u.lastIndexOf("\t"),l=a>=0?a+1:u.lastIndexOf(" ")+1;_instanceof(f.previousNode,i)&&0===l;)g=(f=f.previousNode).text,l=(a=g.lastIndexOf("\t"))>=0?a+1:g.lastIndexOf(" ")+1,u=(u=f.text+u).substring(l);var p=(u=t.trimStart(u)).substring(1,2),w=void 0,s=this.getListLevelPattern(u.substring(0,1));return("None"!==s&&this.checkNumberFormat(p,"Bullet"===s,u)?h=!0:this.checkLeadingZero(u)?(y=!0,h=!0):(w=this.checkNextLevelAutoList(u),sf.base.isNullOrUndefined(w)||(h=!0)),h)&&(this.initComplexHistory("AutoList"),b=c.paragraph,n.start.setPositionParagraph(b.childWidgets[0],b.childWidgets[0].getOffset(c,o+1)),n.end.setPositionParagraph(b.childWidgets[0],0),this.initHistory("Delete"),this.deleteSelectedContents(n,!1),this.reLayout(n,!1),rt=r?"Tab":"Space",p=y?"%1"+u.substring(u.length-1,u.length):"%1"+p,nt=u.substring(u.length-3,u.length-1),s=y?this.getListLevelPattern(nt):s,e=new li(void 0),e.listLevelPattern=s,"Bullet"===s?"*"===u?(e.numberFormat="",e.characterFormat.fontFamily="Symbol"):"-"===u&&(e.numberFormat="-"):e.numberFormat=p,e.followCharacter=rt,v=n.paragraphFormat.leftIndent,e.paragraphFormat.leftIndent=0!==k||0!==d?v+18+k+d:o>2?v+2.5*(o-2)+18:v>0?v+18:36,e.paragraphFormat.firstLineIndent=-18,e.startAt=!y&&"0"===u.substring(0,1)||"00"===nt?0:1,sf.base.isNullOrUndefined(w)?this.autoConvertList(n,e):n.paragraphFormat.setList(w),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)?this.editorHistory.updateComplexHistory():this.reLayout(n)),h},n.prototype.checkNextLevelAutoList=function(n){for(var s,h,c=this.documentHelper.selection,l=void 0,r=!1,v=c.start.paragraph,i=c.getPreviousParagraphBlock(v),a=!1;!sf.base.isNullOrUndefined(i)&&_instanceof(i,u);){if(i.paragraphFormat.listFormat&&-1!==i.paragraphFormat.listFormat.listId){a=!0;break}i=c.getPreviousParagraphBlock(i)}if(a){var e=this.documentHelper.layout.getListNumber(i.paragraphFormat.listFormat,!0),t=e.substring(0,e.length-1),f=n.substring(0,n.length-1),o=void 0;e.substring(e.length-1)!==n.substring(n.length-1)?r=!1:f.match(/^[0-9]+$/)&&t.match(/^[0-9]+$/)?(o=parseInt(f,10),parseInt(t,10)!==o&&parseInt(t,10)+1!==o&&parseInt(t,10)+2!==o||(r=!0)):f.match(/^[a-zA-Z]+$/)&&t.match(/^[a-zA-Z]+$/)&&(t.charCodeAt(0)===n.charCodeAt(0)||t.charCodeAt(0)+1===n.charCodeAt(0)||t.charCodeAt(0)+2===n.charCodeAt(0)?r=!0:f.match(/^[MDCLXVImdclxvi]+$/)&&t.match(/^[MDCLXVImdclxvi]+$/)&&(s=this.getNumber(t.toUpperCase()),h=this.getNumber(f.toUpperCase()),s!==h&&s+1!==h&&s+2!==h||(r=!0)));r&&(l=this.documentHelper.getListById(i.paragraphFormat.listFormat.listId))}return l},n.prototype.getNumber=function(n){for(var i,f={M:1e3,D:500,C:100,L:50,X:10,V:5,I:1},r=n.split(""),u=0,t=0;t<r.length;t++)i=f[r[t]],i<f[r[t+1]]?u-=i:u+=i;return u},n.prototype.getListLevelPattern=function(n){switch(n){case"0":case"1":return"Arabic";case"I":return"UpRoman";case"i":return"LowRoman";case"A":return"UpLetter";case"a":return"LowLetter";case"*":case"-":return"Bullet";case"00":case"01":return"LeadingZero";default:return"None"}},n.prototype.autoConvertList=function(n,t){var r,i,u;n.start;n.isForward||n.end;r=new pi;r.listId=this.documentHelper.lists.length>0?this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1:0;i=new wi;u=this.documentHelper;i.abstractListId=u.abstractLists.length>0?u.abstractLists[u.abstractLists.length-1].abstractListId+1:0;r.abstractListId=i.abstractListId;r.abstractList=i;u.abstractLists.push(i);i.levels.push(t);t.ownerBase=i;n.paragraphFormat.setList(r);n.paragraphFormat.listLevelNumber=0},n.prototype.checkNumberFormat=function(n,t,i){if(t)return""===n;var r=i.indexOf(n);return("."===n||")"===n||">"===n||"-"===n)&&""===i.substring(r,i.length-1)},n.prototype.checkLeadingZero=function(n){for(var i,u,r=!1,t=0;t<=n.length-1;t++){if("0"!==n.charAt(t)){i=t;break}r=!0}return u=void 0,u="1"===n.charAt(i)?n.charAt(i+1):n.charAt(i),r&&this.checkNumberFormat(u,!1,n)},n.prototype.getPageFromBlockWidget=function(n){var t=void 0;return _instanceof(n.containerWidget,c)||_instanceof(n.containerWidget,ct)?t=n.containerWidget.page:_instanceof(n.containerWidget,s)&&(t=n.containerWidget.bodyWidget.page),t},n.prototype.insertTextInline=function(n,u,f,o,s){if(_instanceof(n,i)){n.text=t.insert(n.text,o,f);var h=n.line.paragraph,c=h.childWidgets.indexOf(n.line),l=n.line.children.indexOf(n);(n.line.paragraph.bidi||this.documentHelper.layout.isContainsRtl(n.line))&&this.documentHelper.layout.reArrangeElementsForRtl(n.line,n.line.paragraph.bidi);!sf.base.isNullOrUndefined(s)&&s||this.documentHelper.layout.reLayoutParagraph(h,c,l,n.line.paragraph.bidi)}else _instanceof(n,v)?this.insertImageText(n,u,f,o):_instanceof(n,r)?0===n.fieldType?this.insertFieldBeginText(n,u,f,o):2===n.fieldType?this.insertFieldSeparatorText(n,u,f,o):this.insertFieldEndText(n,u,f,o):(_instanceof(n,e)||_instanceof(n,ht)||_instanceof(n,ot))&&this.insertBookMarkText(n,f)},n.prototype.insertFieldBeginText=function(n,t,r){var u=new i,e,f;u.text=r;e=n.line.paragraph.childWidgets.indexOf(n.line);f=n.line.children.indexOf(n);u.characterFormat.copyFormat(n.characterFormat);n.line.children.splice(f,0,u);u.line=n.line;this.documentHelper.layout.reLayoutParagraph(n.line.paragraph,e,f)},n.prototype.insertBookMarkText=function(n,t){var r=new i,f,u;r.text=t;f=n.line.paragraph.childWidgets.indexOf(n.line);u=n.line.children.indexOf(n);r.characterFormat.copyFormat(n.characterFormat);_instanceof(n,ot)||_instanceof(n,e)?n.line.children.splice(u,0,r):n.line.children.splice(u+1,0,r);r.line=n.line;this.documentHelper.layout.reLayoutParagraph(n.line.paragraph,f,u)},n.prototype.insertFieldSeparatorText=function(n,t,r,u){var o=t.getPreviousTextInline(n),s=t.getNextTextInline(n),f=new i,e,h;f.text=r;e=n.line.children.indexOf(n);u===n.length&&e++;sf.base.isNullOrUndefined(o)&&sf.base.isNullOrUndefined(s)?f.characterFormat.copyFormat(n.line.paragraph.characterFormat):sf.base.isNullOrUndefined(o)?f.characterFormat.copyFormat(s.characterFormat):f.characterFormat.copyFormat(o.characterFormat);n.line.children.splice(e,0,f);f.line=n.line;h=n.line.paragraph.childWidgets.indexOf(n.line);this.documentHelper.layout.reLayoutParagraph(n.line.paragraph,h,e)},n.prototype.insertFieldEndText=function(n,t,r,u){var f=new i,e,h,o,s;f.text=r;e=n.line.children.indexOf(n);f.characterFormat.copyFormat(n.characterFormat);n.line.children.splice(e+1,0,f);f.line=n.line;h=n.line.paragraph.childWidgets.indexOf(n.line);this.owner.enableTrackChanges&&(o=this.documentHelper.textHelper.getRtlLanguage(r).isRtl,s=this.checkToMapRevisionWithInlineText(n,u,f,o,"Insertion"),s||0!==f.revisions.length||(s=this.checkToMapRevisionWithNextNode(n.nextNode,f,o,"Insertion")));this.documentHelper.layout.reLayoutParagraph(n.line.paragraph,h,e)},n.prototype.insertImageText=function(n,t,r,u){var s=t.getPreviousTextInline(n),c=t.getNextTextInline(n),e=n.line,f=new i,h=e.paragraph,l=h.childWidgets.indexOf(e),o;f.text=r;o=e.children.indexOf(n);u===n.length&&o++;sf.base.isNullOrUndefined(s)&&sf.base.isNullOrUndefined(c)?f.characterFormat.copyFormat(h.characterFormat):sf.base.isNullOrUndefined(s)?f.characterFormat.copyFormat(c.characterFormat):f.characterFormat.copyFormat(s.characterFormat);e.children.splice(o,0,f);f.line=e;this.documentHelper.layout.reLayoutParagraph(h,l,o)},n.prototype.isListTextSelected=function(){this.documentHelper.isListTextSelected&&(this.initComplexHistory("ListSelect"),this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat&&-1!==this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat.listId&&this.onApplyList(void 0))},n.prototype.checkAndConvertToHyperlink=function(n,t,r){var u,e,o,s,v,f,c,y,p,w,h,b;if(t)u=(e=r.lastChild.children[r.lastChild.children.length-1]).text;else{var a=0,k=n.start.currentWidget.getInline(n.start.offset-1,a),d=k.element;if(a=k.index,!_instanceof(d,i))return;u=(e=d).text.substring(0,a)}for(o=0,s=u.lastIndexOf("\t"),o=s>=0?s+1:u.lastIndexOf(" ")+1;_instanceof(e.previousElement,i)&&0===o;)v=(e=e.previousNode).text,o=(s=v.lastIndexOf("\t"))>=0?s+1:v.lastIndexOf(" ")+1,u=e.text+u;f=(u=u.substring(o)).toLowerCase();c=!1;"file:///"===f.substring(0,8)||"http://"===f.substring(0,7)&&f.length>7||"https://"===f.substring(0,8)&&f.length>8||"www."===f.substring(0,4)&&f.length>4||"\\"===f.substring(0,3)&&f.length>3||"mailto:"===f.substring(0,7)&&f.length>7?(c=!0,"www."===f.substring(0,4)&&f.length>4&&(u="http://"+u)):(y=u.indexOf("@"),p=u.indexOf("."),y>0&&y<p&&p<u.length-1&&(c=!0,u="mailto:"+u));c&&(w=new l(this.documentHelper.owner),w.setPositionParagraph(e.line,e.line.getOffset(e,o)),h=new l(this.documentHelper.owner),t?h.setPositionParagraph(e.line,e.line.getEndOffset()):0===n.end.currentWidget.children.length&&0===n.end.offset?(b=n.end.currentWidget.previousLine,h.setPositionParagraph(b,b.getEndOffset())):h.setPositionParagraph(n.end.currentWidget,n.end.offset-1),this.autoFormatHyperlink(n,u,w,h))},n.prototype.autoFormatHyperlink=function(n,t,i,r){var u,e,h,o,f,s;this.initComplexHistory("AutoFormatHyperlink");u=this.selection.getParagraphInfo(i);e=this.selection.getHierarchicalIndex(u.paragraph,u.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=e);n.start.setPositionInternal(i);n.end.setPositionInternal(r);h=this.getCharacterFormat(n);o=new p;o.copyFormat(h);f=this.createHyperlinkElement(t,i,r,o);n.start.setPositionParagraph(f.line,f.line.getOffset(f,1));n.start.moveNextPosition();n.end.setPositionInternal(n.start);u=this.selection.getParagraphInfo(n.end);s=this.selection.getHierarchicalIndex(u.paragraph,u.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=s,this.editorHistory.updateComplexHistory(),this.reLayout(n)):this.updateComplexWithoutHistory(0,e,s)},n.prototype.appylingHyperlinkFormat=function(n){this.initHistory("Underline");this.updateCharacterFormatWithUpdate(n,"underline","Single",!1);this.editorHistory&&this.editorHistory.updateHistory();this.reLayout(n,!1);this.initHistory("FontColor");this.isForHyperlinkFormat=!0;this.updateCharacterFormatWithUpdate(n,"fontColor","#0563c1",!1);this.isForHyperlinkFormat=!1;this.editorHistory&&this.editorHistory.updateHistory();this.reLayout(n,!1)},n.prototype.createHyperlinkElement=function(n,t,i,u){var f=this.selection,e;this.documentHelper.layout.allowLayout=!1;this.appylingHyperlinkFormat(f);this.documentHelper.layout.allowLayout=!0;e=new r(1);e.characterFormat.copyFormat(u);e.line=f.end.currentWidget;f.start.setPositionInternal(f.end);this.initInsertInline(e);f.start.setPositionInternal(t);f.end.setPositionInternal(f.start);var o=this.insertHyperlinkfield(f,u,n),s=f.start.paragraph.childWidgets.indexOf(o.line),h=o.line.children.indexOf(o);return e.linkFieldCharacter(this.documentHelper),this.documentHelper.layout.reLayoutParagraph(f.start.paragraph,s,h),e},n.prototype.insertHyperlinkfield=function(n,t,u,f){var o=new r(0),e,s;return o.characterFormat.copyFormat(t),o.line=n.start.currentWidget,this.initInsertInline(o),e=new i,e.characterFormat.copyFormat(t),e.text=f?' HYPERLINK \\l "'+u+'" ':' HYPERLINK "'+u+'" ',e.line=n.start.currentWidget,this.initInsertInline(e),s=new r(2),s.characterFormat.copyFormat(t),s.line=n.start.currentWidget,this.initInsertInline(s),o},n.prototype.unlinkRangeFromRevision=function(n,t){for(var i,u,r=0;r<n.revisions.length;r++)i=n.revisions[r],u=i.range.indexOf(n),u>=0&&i.range.splice(u,1),0===i.range.length&&t&&(this.owner.revisions.remove(i),this.isRemoveRevision&&this.documentHelper.revisionsInternal.containsKey(i.revisionID)&&this.documentHelper.revisionsInternal.remove(i.revisionID))},n.prototype.unlinkWholeRangeInRevision=function(n,t){var i=t,u,r;for(n.revisions.splice(n.revisions.indexOf(n),1),u=i.range.length,r=0;r<u;r++)i.range.splice(0,1);0===i.range.length&&(this.owner.revisions.remove(i),this.isRemoveRevision&&this.documentHelper.revisionsInternal.containsKey(i.revisionID)&&this.documentHelper.revisionsInternal.remove(i.revisionID))},n.prototype.unLinkFieldCharacter=function(n){var t,i;(_instanceof(n,r)&&0===n.fieldType&&n.fieldEnd&&(this.documentHelper&&(this.documentHelper.fieldToLayout=n,this.documentHelper.fieldEndParagraph=n.line.paragraph),n.fieldEnd&&(n.fieldEnd.fieldBegin=void 0),n.fieldEnd=void 0),_instanceof(n,r)&&2===n.fieldType)?sf.base.isNullOrUndefined(n.fieldEnd)||(this.documentHelper&&(this.documentHelper.fieldToLayout=n.fieldBegin,this.documentHelper.fieldEndParagraph=n.line.paragraph),n.fieldBegin.fieldSeparator=void 0,n.fieldEnd.fieldSeparator=void 0):_instanceof(n,r)&&1===n.fieldType&&n.fieldBegin&&(sf.base.isNullOrUndefined(this.documentHelper)||(this.documentHelper.fieldToLayout=n.fieldBegin,this.documentHelper.fieldEndParagraph=n.line.paragraph),t=this.documentHelper.fields.indexOf(n.fieldBegin),-1!==t&&this.documentHelper.fields.splice(t,1),i=this.documentHelper.formFields.indexOf(n.fieldBegin),-1!==i&&this.documentHelper.formFields.splice(i,1),n.fieldBegin.fieldEnd=void 0,n.fieldBegin=void 0)},n.prototype.getCharacterFormat=function(n){return n.start.paragraph.isEmpty()?n.start.paragraph.characterFormat:n.start.currentWidget.getInline(n.start.offset,0).element.characterFormat},n.prototype.insertHyperlink=function(n,t){sf.base.isNullOrUndefined(t)&&(t=n);this.insertHyperlinkInternal(n,t,this.owner.selection.text!==t,!1)},n.prototype.insertHyperlinkInternal=function(n,t,i,u){var f=this.documentHelper.selection,o,h,v,w,c,e,b,s,a,k,d,y,g;f.start.paragraph.associatedCell===f.end.paragraph.associatedCell&&(i?this.insertHyperlinkInternalInternal(f,n,t,u):(o=f.start,h=f.end,f.isForward||(o=f.end,h=f.start),v=new l(this.documentHelper.owner),v.setPositionInternal(o),w=this.getCharacterFormat(f),c=new p(void 0),c.copyFormat(w),this.initComplexHistory("InsertHyperlink"),e=this.selection.getParagraphInfo(o),b=this.selection.getHierarchicalIndex(e.paragraph,e.offset.toString()),this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=this.selection.getHierarchicalIndex(e.paragraph,e.offset.toString())),this.appylingHyperlinkFormat(f),this.documentHelper.layout.allowLayout=!0,o.setPositionInternal(h),s=new r(1),s.characterFormat.copyFormat(c),s.line=f.end.currentWidget,o.setPositionInternal(h),this.initInsertInline(s),o.setPositionInternal(v),h.setPositionInternal(o),a=this.insertHyperlinkfield(f,c,n,u),s.linkFieldCharacter(this.documentHelper),k=f.start.paragraph.childWidgets.indexOf(a.line),d=a.line.children.indexOf(a),this.documentHelper.layout.reLayoutParagraph(f.start.paragraph,k,d),y=s.line,f.selects(y,y.getOffset(s,s.length),!0),e=this.selection.getParagraphInfo(h),g=this.selection.getHierarchicalIndex(e.paragraph,e.offset.toString()),this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=this.selection.getHierarchicalIndex(e.paragraph,e.offset.toString()),this.editorHistory.updateComplexHistory()):this.updateComplexWithoutHistory(1,b,g)))},n.prototype.insertHyperlinkInternalInternal=function(n,t,i,r){var u,e,o,f;sf.base.isNullOrUndefined(n.start)||this.editHyperlink(n,t,i)||(this.initHistory("InsertHyperlink"),u=!0,n.isEmpty||(e=this.owner.enableTrackChanges,this.owner.enableTrackChanges=!1,u=this.removeSelectedContents(n),this.owner.enableTrackChanges=e),u&&(o=this.getCharacterFormat(n),f=new p,f.copyFormat(o),this.insertHyperlinkByFormat(n,t,i,f,r)))},n.prototype.insertHyperlinkByFormat=function(n,t,u,f,e){var o,c,s,l,h;this.updateInsertPosition();n.owner.isShiftingEnabled=!0;o=[];c=new r(0);o.push(c);s=new i;s.text=e?' HYPERLINK \\l "'+t+'" ':' HYPERLINK "'+t+'" ';o.push(s);l=new r(2);o.push(l);sf.base.isNullOrUndefined(u)||""===u||((s=new i).characterFormat.underline="Single",s.characterFormat.fontColor="#0563c1",s.text=u,o.push(s));h=new r(1);o.push(h);this.insertElement(o);h.linkFieldCharacter(this.documentHelper);-1===this.documentHelper.fields.indexOf(c)&&this.documentHelper.fields.push(c);n.selects(h.line,h.line.getOffset(h,h.length),!0);this.updateEndPosition();this.reLayout(n,!0)},n.prototype.initInsertInline=function(n){this.initHistory("InsertInline");this.insertInlineInSelection(this.documentHelper.selection,n);this.editorHistory&&this.editorHistory.updateHistory()},n.prototype.insertElementInCurrentLine=function(n,t){this.checkIsNotRedoing()&&(n.owner.isShiftingEnabled=!0);n.isEmpty||this.removeSelectedContents(n);this.updateInsertPosition();this.insertElement([t]);this.checkEndPosition(n)&&this.updateHistoryPosition(n.start,!1);this.fireContentChange()},n.prototype.editHyperlink=function(n,t,u,f){var e=n.getHyperlinkField(),l,a,s,o,h,w;if(sf.base.isNullOrUndefined(e))return!1;this.initHistory("InsertHyperlink");this.editHyperlinkInternal=sf.base.isNullOrUndefined(this.editorHistory)||this.editorHistory&&sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo);var y="",v=!1,b=this.getCharacterFormat(n),c=new p;if(c.copyFormat(b),l=void 0,sf.base.isNullOrUndefined(e.fieldSeparator)||(l=e.fieldSeparator,a=n.getHyperlinkDisplayText(e.fieldSeparator.line.paragraph,e.fieldSeparator,e.fieldEnd,v,c),y=a.displayText,v=a.isNestedField,c=a.format),s=e.line.getOffset(e,0),n.start.setPositionParagraph(e.line,s),s=e.fieldEnd.line.getOffset(e.fieldEnd,1),n.end.setPositionParagraph(e.fieldEnd.line,s),this.skipFieldDeleteTracking=!0,this.deleteSelectedContents(n,!1),!v&&y!==u||sf.base.isNullOrUndefined(l))this.insertHyperlinkByFormat(n,t,u,c,f);else{this.updateInsertPosition();o=new r(0);o.characterFormat.copyFormat(e.characterFormat);o.line=n.start.currentWidget;this.insertInlineInternal(o);h=new i;h.characterFormat.copyFormat(e.characterFormat);h.text=f?' HYPERLINK \\l "'+t+'" ':' HYPERLINK "'+t+'" ';h.line=n.start.currentWidget;this.insertInlineInternal(h);w=this.editorHistory&&this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo.removedNodes:this.nodes;this.insertClonedFieldResult(n,w,l);n.end.currentWidget.getInline(n.end.offset,0).element.linkFieldCharacter(this.documentHelper);this.skipFieldDeleteTracking=!1;var k=o.line.paragraph,d=o.line.paragraph.childWidgets.indexOf(o.line),g=o.line.children.indexOf(o);this.documentHelper.layout.reLayoutParagraph(k,d,g);n.selects(o.fieldEnd.line,s,!0);this.updateEndPosition();this.reLayout(n,!0)}return this.editHyperlinkInternal=!1,this.nodes=[],!0},n.prototype.insertClonedFieldResult=function(n,t,i){for(var r,e,s,o=!1,f=t.length-1;f>-1;f--){if(r=t[f],!o){if(i!==r){_instanceof(r,u)&&r===i.line.paragraph&&(o=!0,e=void 0,f===t.length-1?(e=n.start.paragraph,s=i.line.paragraph,this.getClonedFieldResultWithSel(s,n,i)):(e=this.getClonedFieldResult(i.line.paragraph,i),this.insertParagraph(e,!0)),n.selectParagraphInternal(n.getNextParagraphBlock(e),!0));continue}o=!0}_instanceof(r,tt)?this.insertInlineInternal(r.clone()):_instanceof(r,wt)&&this.insertBlock(r.clone())}},n.prototype.getClonedFieldResultWithSel=function(n,t,i){for(var e,u,f=n.childWidgets.indexOf(i.line),o=n.childWidgets[f].children.indexOf(i),r=f;r<n.childWidgets.length;r++)for(e=n.childWidgets[r],r!==f&&(o=0),u=o;u<e.children.length;u++)this.insertInlineInternal(e.children[u].clone())},n.prototype.getClonedFieldResult=function(n,t){var i=new u,o,f;i.characterFormat.copyFormat(n.characterFormat);i.paragraphFormat.copyFormat(n.paragraphFormat);for(var e=n.childWidgets.indexOf(t.line),s=n.childWidgets[e].children.indexOf(t),r=e;r<n.childWidgets.length;r++)for(o=n.childWidgets[r],r!==e&&(s=0),f=s;f<o.children.length;f++)i.childWidgets[0].children.push(o.children[f]);return i},n.prototype.removeHyperlink=function(){var n,i,o,s;if(!this.owner.isReadOnlyMode&&(n=this.selection,i=n.getHyperlinkField(),!sf.base.isNullOrUndefined(i))){var u=i.fieldEnd,r=i.fieldSeparator,f=new l(n.owner);f.setPositionParagraph(i.line,i.line.getOffset(i,0));var t=this.selection.getParagraphInfo(f),h=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString()),e=new l(n.owner);e.setPositionParagraph(r.line,r.line.getOffset(r,r.length));t=this.selection.getParagraphInfo(e);o=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString());this.initComplexHistory("RemoveHyperlink");n.start.setPositionParagraph(u.line,u.line.getOffset(u,0));t=this.selection.getParagraphInfo(n.start);s=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString());n.end.setPositionInternal(n.start);this.delete();n.start.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(o));this.initHistory("Underline");this.updateCharacterFormatWithUpdate(n,"underline","None",!1);this.editorHistory&&this.editorHistory.updateHistory();n.end.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(s));this.initHistory("FontColor");this.updateCharacterFormatWithUpdate(n,"fontColor",void 0,!1);this.editorHistory&&this.editorHistory.updateHistory();this.reLayout(n,!1);n.end.setPositionInternal(n.start);n.start.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(h));this.initHistory("Delete");this.deleteSelectedContents(n,!1);this.reLayout(n,!0);this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory()}},n.prototype.pasteInternal=function(n,t){var o,r;if(this.currentPasteOptions=this.owner.defaultPasteOption,this.documentHelper.owner.enableLocalPaste)this.paste();else{this.selection.isViewPasteOptions=!0;this.selection.pasteElement&&(this.selection.pasteElement.style.display="none");sf.base.isNullOrUndefined(t)&&(t=window);var u,f="",e="",i=t.clipboardData?t.clipboardData:n.clipboardData;("msie"!==sf.base.Browser.info.name&&(e=i.getData("Text/Rtf"),f=i.getData("Text/Html")),this.copiedTextContent=u=i.getData("Text"),this.previousCharFormat=new p,this.previousCharFormat.copyFormat(this.selection.start.paragraph.characterFormat),this.previousParaFormat=new ut,this.previousParaFormat.copyFormat(this.selection.start.paragraph.paragraphFormat),"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.selection.isInlineFormFillMode()&&(f="",e=""),""!==e)?this.pasteAjax(e,".rtf"):""!==f?(o=(new DOMParser).parseFromString(f,"text/html"),r=(new XMLSerializer).serializeToString(o),r=(r=(r=r.replace(/<!--StartFragment-->/gi,"")).replace(/<!--EndFragment-->/gi,"")).replace('xmlns="http://www.w3.org/1999/xhtml"',""),this.pasteAjax(r,".html")):null!==u&&""!==u?(this.pasteContents(u),this.applyPasteOptions(this.currentPasteOptions),this.documentHelper.editableDiv.innerHTML=""):"msie"!==sf.base.Browser.info.name&&void 0!==i.items&&0!==i.items.length&&"image/png"===i.items[0].type?this.pasteImage(i.items[0].getAsFile()):"msie"===sf.base.Browser.info.name&&void 0!==i.files&&0!==i.files.length&&"image/png"===i.files[0].type&&this.pasteImage(i.files[0])}},n.prototype.pasteImage=function(n){var i=this,t=new FileReader;t.onload=function(){i.onPasteImage(t.result)};t.readAsDataURL(n)},n.prototype.onPasteImage=function(n){var t=document.createElement("img"),i=this;t.addEventListener("load",function(){i.insertImage(n,this.width,this.height)});t.src=n},n.prototype.pasteAjax=function(n,t){var i={content:n,type:t};this.pasteRequestHandler=new bi;this.owner.documentHelper.viewerContainer.focus();this.pasteRequestHandler.url=this.owner.serviceUrl+this.owner.serverActionSettings.systemClipboard;this.pasteRequestHandler.responseType="json";this.pasteRequestHandler.contentType="application/json;charset=UTF-8";this.pasteRequestHandler.customHeaders=this.owner.headers;this.pasteRequestHandler.onSuccess=this.pasteFormattedContent.bind(this);this.pasteRequestHandler.onFailure=this.onPasteFailure.bind(this);this.pasteRequestHandler.onError=this.onPasteFailure.bind(this);this.pasteRequestHandler.send(i)},n.prototype.pasteFormattedContent=function(n){var t=this;this.isPasteListUpdated&&(this.isPasteListUpdated=!1);this.pasteContents(sf.base.isNullOrUndefined(n.data)?this.copiedTextContent:n.data);"KeepSourceFormatting"!==this.currentPasteOptions&&this.applyPasteOptions(this.currentPasteOptions);setTimeout(function(){sf.base.isNullOrUndefined(t.viewer)||t.viewer.updateScrollBars()},0)},n.prototype.onPasteFailure=function(n){this.owner.fireServiceFailure(n);console.error(n.status,n.statusText);this.documentHelper.updateFocus()},n.prototype.paste=function(n,t){var i=this,r;(sf.base.isNullOrUndefined(n)&&(n=this.owner.enableLocalPaste?this.copiedData:void 0),sf.base.isNullOrUndefined(t)||(this.currentPasteOptions=t),n)&&(r=JSON.parse(n),this.pasteContents(r),this.applyPasteOptions(this.currentPasteOptions),this.chartType&&(setTimeout(function(){sf.base.isNullOrUndefined(i.viewer)||i.viewer.updateScrollBars()},30),this.chartType=!1))},n.prototype.getUniqueListOrAbstractListId=function(n){var t,i;return n&&this.documentHelper.lists.length?(t=this.documentHelper.lists.slice().sort(function(n,t){return n.listId-t.listId}),t[t.length-1].listId+1):this.documentHelper.abstractLists.length?(i=this.documentHelper.abstractLists.slice().sort(function(n,t){return n.abstractListId-t.abstractListId}),i[i.length-1].abstractListId+1):0},n.prototype.checkSameLevelFormat=function(n,t,i){return t.levels[n].listLevelPattern===i.abstractList.levels[n].listLevelPattern&&t.levels[n].numberFormat===i.abstractList.levels[n].numberFormat&&("Bullet"===t.levels[n].listLevelPattern||t.levels[n].startAt===i.abstractList.levels[n].startAt)},n.prototype.listLevelPatternInCollection=function(n,t){var i=this;return this.documentHelper.lists.filter(function(r){return r.abstractList.levels[n].listLevelPattern===t.listLevelPattern&&r.abstractList.levels[n].numberFormat===t.numberFormat&&("Bullet"===t.listLevelPattern||r.abstractList.levels[n].startAt===t.startAt)&&i.isEqualParagraphFormat(r.abstractList.levels[n].paragraphFormat,t.paragraphFormat)})[0]},n.prototype.isEqualParagraphFormat=function(n,t){return!(sf.base.isNullOrUndefined(t.leftIndent)&&0!==n.leftIndent||!sf.base.isNullOrUndefined(t.leftIndent)&&Math.round(n.leftIndent)!==Math.round(t.leftIndent))&&!(sf.base.isNullOrUndefined(t.rightIndent)&&0!==n.rightIndent||!sf.base.isNullOrUndefined(t.rightIndent)&&Math.round(n.rightIndent)!==Math.round(t.rightIndent))&&!(sf.base.isNullOrUndefined(t.firstLineIndent)&&0!==n.firstLineIndent||!sf.base.isNullOrUndefined(t.firstLineIndent)&&Math.round(n.firstLineIndent)!==Math.round(t.firstLineIndent))&&!(sf.base.isNullOrUndefined(t.beforeSpacing)&&0!==n.beforeSpacing||!sf.base.isNullOrUndefined(t.beforeSpacing)&&Math.round(n.beforeSpacing)!==Math.round(t.beforeSpacing))&&!(sf.base.isNullOrUndefined(t.afterSpacing)&&0!==n.afterSpacing||!sf.base.isNullOrUndefined(t.afterSpacing)&&Math.round(n.afterSpacing)!==Math.round(t.afterSpacing))&&!(sf.base.isNullOrUndefined(t.textAlignment)&&"Left"!==n.textAlignment||!sf.base.isNullOrUndefined(t.textAlignment)&&n.textAlignment!==t.textAlignment)&&!(sf.base.isNullOrUndefined(t.bidi)&&!1!==n.bidi||!sf.base.isNullOrUndefined(t.bidi)&&n.bidi!==t.bidi)&&!(sf.base.isNullOrUndefined(t.contextualSpacing)&&!1!==n.contextualSpacing||!sf.base.isNullOrUndefined(t.contextualSpacing)&&n.contextualSpacing!==t.contextualSpacing)&&!(sf.base.isNullOrUndefined(t.keepWithNext)&&!1!==n.keepWithNext||!sf.base.isNullOrUndefined(t.keepWithNext)&&n.keepWithNext!==t.keepWithNext)&&!(sf.base.isNullOrUndefined(t.keepLinesTogether)&&!1!==n.keepLinesTogether||!sf.base.isNullOrUndefined(t.keepLinesTogether)&&n.keepLinesTogether!==t.keepLinesTogether)&&!(sf.base.isNullOrUndefined(t.widowControl)&&!1!==n.widowControl||!sf.base.isNullOrUndefined(t.widowControl)&&n.widowControl!==t.widowControl)&&!(sf.base.isNullOrUndefined(t.outlineLevel)&&"BodyText"!==n.outlineLevel||!sf.base.isNullOrUndefined(t.outlineLevel)&&n.outlineLevel!==t.outlineLevel)&&!(sf.base.isNullOrUndefined(t.lineSpacing)&&1!==n.lineSpacing||!sf.base.isNullOrUndefined(t.lineSpacing)&&Math.round(n.lineSpacing)!==Math.round(t.lineSpacing))&&!(sf.base.isNullOrUndefined(t.lineSpacingType)&&"Multiple"!==n.lineSpacingType||!sf.base.isNullOrUndefined(t.lineSpacingType)&&n.lineSpacingType!==t.lineSpacingType)},n.prototype.getBlocksToUpdate=function(n){for(var t,u,e,f,o,i=[],r=0;r<n.length;r++)if(t=n[r],t.paragraphFormat&&t.paragraphFormat.listFormat&&Object.keys(t.paragraphFormat.listFormat).length>0)i.push(t);else if(t.rows)for(u=0;u<t.rows.length;u++)for(e=t.rows[u],f=0;f<e.cells.length;f++)o=e.cells[f],i=i.concat(this.getBlocksToUpdate(o.blocks));return i},n.prototype.updateListIdForBlocks=function(n,t,i,r,u){for(var e,f,s,c,a,l,v,y,o=!1,h=0;h<n.length;h++)if(e=n[h],e.paragraphFormat&&e.paragraphFormat.listFormat&&Object.keys(e.paragraphFormat.listFormat).length>0)f=e.paragraphFormat.listFormat,s=this.listLevelPatternInCollection(f.listLevelNumber,t.levels[f.listLevelNumber]),f.listId===r&&(sf.base.isNullOrUndefined(s)&&(!i||i&&!this.checkSameLevelFormat(f.listLevelNumber,t,i))?(o=!0,f.listId=u):!sf.base.isNullOrUndefined(s)&&this.checkSameLevelFormat(f.listLevelNumber,t,s)&&(f.isUpdated||(f.listId=s.listId,f.isUpdated=!0),o=!1));else if(e.rows)for(c=0;c<e.rows.length;c++)for(a=e.rows[c],l=0;l<a.cells.length;l++)v=a.cells[l],y=this.updateListIdForBlocks(v.blocks,t,i,r,u),o||(o=y);return o},n.prototype.updatePasteContent=function(n,t){var r=this.getUniqueListOrAbstractListId(!0),e,i,o,s,f;n.lists.filter(function(n){return n.listId===r}).length>0&&(e=n.lists.slice().sort(function(n,t){return n.listId-t.listId}),r=e[e.length-1].listId+1);i=this.getUniqueListOrAbstractListId(!1);n.abstractLists.filter(function(n){return n.abstractListId===i}).length>0&&(o=n.abstractLists.slice().sort(function(n,t){return n.abstractListId-t.abstractListId}),i=o[o.length-1].abstractListId+1);for(var h,l=function(u){var f=n.lists[u],e=n.abstractLists.filter(function(n){return n.abstractListId===f.abstractListId})[0],o=c.documentHelper.lists.filter(function(n){return n.listId===f.listId});sf.base.isNullOrUndefined(e)||(c.updateListIdForBlocks(n.sections[t].blocks,e,o[0],f.listId,r)?(e.abstractListId=i,f.listId=r,f.abstractListId=i,r++,i++):(n.lists.splice(u,1),n.abstractLists.splice(n.abstractLists.indexOf(e),1),u--));h=u},c=this,u=0;u<n.lists.length;u++)l(u),u=h;for(s=this.getBlocksToUpdate(n.sections[t].blocks),f=0;f<s.length;f++)delete s[f].paragraphFormat.listFormat.isUpdated},n.prototype.getBlocks=function(n,t,r,f,e){var nt=[],tt,a,b,ut,s,d,v,ft,et,y,it,g,l,o,p,ot,w,st,rt,ht;if("string"==typeof n){for(tt=this.selection.start.paragraph,this.selection.isForward||(tt=this.selection.end.paragraph),a=[],b=n,b=b.replace(/\r\n/g,"\r"),a=-1!==navigator.userAgent.indexOf("Firefox")?b.split("\n"):b.split("\r"),ut=[],(l=new c).sectionFormat=new dt(l),l.childWidgets=ut,s=0;s<a.length;s++)(s!==a.length-1||0!==a[s].length)&&(d=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),v=this.selection.getPreviousValidElement(d.element),v!==d.element&&(v=this.selection.getNextValidElement(d.element)),ft=v&&v===d.element?tt.characterFormat:v?v.characterFormat:this.copyInsertFormat(tt.characterFormat,!1),sf.base.isNullOrUndefined(this.previousCharFormat)||(ft=this.previousCharFormat),et=this.documentHelper.selection.copySelectionParagraphFormat(),sf.base.isNullOrUndefined(this.previousParaFormat)||(et=this.previousParaFormat),y=new u,y.paragraphFormat.copyFormat(et),it=new k(y),a[s].length>0&&(g=new i,g.characterFormat.copyFormat(ft),g.text=a[s],it.children.push(g),g.line=it),y.childWidgets.push(it),y.containerWidget=l,ut.push(y));nt.push(l)}else for(this.viewer.owner.parser.addCustomStyles(n),!t&&n.comments.length>0&&(this.documentHelper.owner.parser.commentsCollection=new h,this.documentHelper.owner.parser.parseComments(n,f)),s=0;s<n.sections.length;s++){if(o=this.documentHelper.owner.parser,o.isPaste=t,this.isPasteListUpdated||sf.base.isNullOrUndefined(n.lists)||(this.documentHelper.lists.length>0&&this.updatePasteContent(n,s),this.isPasteListUpdated=!0,sf.base.isNullOrUndefined(n.abstractLists)||o.parseAbstractList(n,this.documentHelper.abstractLists),sf.base.isNullOrUndefined(n.lists)||o.parseList(n,this.documentHelper.lists)),!sf.base.isNullOrUndefined(n.revisions))if(t){if(p=this.viewer.owner.revisionsInternal.changes,sf.base.isNullOrUndefined(o.revisionCollection)||(o.revisionCollection=void 0),o.revisionCollection=new h,ot=o.revisionCollection,(!this.documentHelper.owner.sfdtExportModule.copyWithTrackChange||!o.isCutPerformed)&&n.revisions.length>=1)for(w=0;w<n.revisions.length;w++)if(st=!0,ot.containsKey(n.revisions[w].revisionId)){if(p.length>0)for(rt=0;rt<p.length;rt++)p[rt].revisionID===n.revisions[w].revisionId&&(st=!1);st&&(ht=ot.get(n.revisions[w].revisionId),p.push(ht))}else o.parseRevisions(n,p);this.documentHelper.owner.sfdtExportModule.copyWithTrackChange=!1}else o.revisionCollection=this.documentHelper.revisionsInternal,o.parseRevisions(n,e);(l=new c).sectionFormat=new dt(l);o.parseSectionFormat(n.sections[s].sectionFormat,l.sectionFormat);t?nt.push(l):r.unshift(l);o.parseBody(n.sections[s].blocks,l.childWidgets);o.isPaste=!1}return"MergeWithExistingFormatting"===this.currentPasteOptions&&this.applyMergeFormat(nt),nt},n.prototype.applyMergeFormat=function(n){for(var s,i,t,r,h,f,c,e,v=this.selection.start.paragraph,y=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),l=this.selection.getPreviousValidElement(y.element),a=l?l.characterFormat:this.copyInsertFormat(v.characterFormat,!1),p=this.documentHelper.selection.copySelectionParagraphFormat(),o=0;o<n.length;o++)for(s=n[o].childWidgets,i=0;i<s.length;i++)if(t=s[i],_instanceof(t,u))t.paragraphFormat.copyFormat(p),this.applyFormatInternal(t,a);else for(r=0;r<t.childWidgets.length;r++)for(h=t.childWidgets[r],f=0;f<h.childWidgets.length;f++)for(c=h.childWidgets[f],e=0;e<c.childWidgets.length;e++)this.applyFormatInternal(c.childWidgets[e],a)},n.prototype.applyFormatInternal=function(n,t){var f,r,i,e,s,h,o;if(_instanceof(n,u))for(f=0;f<n.childWidgets.length;f++)for(r=n.childWidgets[f],i=0;i<r.children.length;i++)e=r.children[i].characterFormat.cloneFormat(),sf.base.isNullOrUndefined(t.uniqueCharacterFormat)?r.children[i].characterFormat=t:(r.children[i].characterFormat.uniqueCharacterFormat=void 0,r.children[i].characterFormat.copyFormat(t)),e.bold&&(r.children[i].characterFormat.bold=e.bold),e.italic&&(r.children[i].characterFormat.italic=e.italic),"None"!==e.underline&&(r.children[i].characterFormat.underline=e.underline);else for(f=0;f<n.childWidgets.length;f++)for(s=n.childWidgets[f],i=0;i<s.childWidgets.length;i++)for(h=s.childWidgets[i],o=0;o<h.childWidgets.length;o++)this.applyFormatInternal(h.childWidgets[o],t)},n.prototype.applyPasteOptions=function(n){if(!sf.base.isNullOrUndefined(this.copiedContent)&&""!==this.copiedTextContent){switch(this.isSkipHistory=!0,this.currentPasteOptions=n,this.selection.start.setPositionInternal(this.pasteTextPosition.startPosition),this.selection.end.setPositionInternal(this.pasteTextPosition.endPosition),n){case"KeepSourceFormatting":this.pasteContents(""!==this.copiedContent?this.copiedContent:this.copiedTextContent);break;case"MergeWithExistingFormatting":var t=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.paragraphFormat;this.pasteContents(""!==this.copiedContent?this.copiedContent:this.copiedTextContent,t);break;case"KeepTextOnly":this.pasteContents(this.copiedTextContent)}this.isSkipHistory=!1}},n.prototype.pasteContents=function(n,t){var u;if("string"!=typeof n&&(this.copiedContent=n),"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.selection.isInlineFormFillMode()){var f=this.selection.getCurrentFormField(),e=this.getFormFieldText(),r=f.formFieldData.maxLength,i=this.documentHelper.selection.text.length;r>0&&(0===i?(u=r-e.length,n=n.substring(0,u)):i>0&&(n=n.substring(0,i)))}this.pasteContentsInternal(this.getBlocks(n,!0),!0,t);this.isInsertField=!1},n.prototype.pasteContentsInternal=function(n,t,i){var r,u,f;this.isPaste=t;r=this.documentHelper.selection;u=!0;(this.isSkipHistory||this.initComplexHistory("Paste"),this.documentHelper.isListTextSelected)&&(f=r.start.paragraph,f.paragraphFormat.listFormat&&-1!==f.paragraphFormat.listFormat.listId&&this.onApplyList(void 0));this.isSkipHistory||this.initHistory("Paste");r.isEmpty&&!this.documentHelper.isListTextSelected||(u=this.removeSelectedContentInternal(r,r.start,r.end));u?this.pasteContent(n,i):this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0);this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory()):this.reLayout(r,r.isEmpty);this.isPaste=!1},n.prototype.pasteContent=function(n,t){var r,f,i,u,e,o;this.documentHelper.owner.isShiftingEnabled=!0;r="";(this.updateInsertPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo)?r=this.editorHistory.currentBaseHistoryInfo.insertPosition:(f=this.selection.start,this.selection.isForward||(f=this.selection.end),i=this.selection.getParagraphInfo(f),r=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString()));this.documentHelper.owner.isLayoutEnabled=!0;this.documentHelper.owner.isPastingContent=!0;this.pasteCopiedData(n,t);u="";(this.updateEndPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo)?u=this.editorHistory.currentBaseHistoryInfo.endPosition:(i=this.selection.getParagraphInfo(this.selection.start),u=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString()));e=new l(this.documentHelper.owner);this.setPositionForCurrentIndex(e,r);o=new l(this.documentHelper.owner);this.setPositionForCurrentIndex(o,u);this.pasteTextPosition={startPosition:e,endPosition:o};this.documentHelper.owner.isPastingContent=!1;this.documentHelper.selection.fireSelectionChanged(!0)},n.prototype.pasteCopiedData=function(n,t){var h,c,l,e,i,v,o,s,y,r,a,p;for((this.documentHelper.layout.isBidiReLayout&&(this.documentHelper.layout.isBidiReLayout=!1),this.isPaste&&this.isSectionEmpty(this.selection)&&!this.selection.start.paragraph.isInHeaderFooter&&(this.previousSectionFormat=new dt,this.previousSectionFormat.copyFormat(this.selection.start.paragraph.bodyWidget.sectionFormat),this.selection.start.paragraph.bodyWidget.sectionFormat.copyFormat(n[0].sectionFormat),this.selection.start.paragraph.bodyWidget.sectionFormat.footerDistance=this.previousSectionFormat.footerDistance,this.selection.start.paragraph.bodyWidget.sectionFormat.headerDistance=this.previousSectionFormat.headerDistance,_instanceof(this.owner.viewer,rt)))&&(h=this.selection.start.paragraph.bodyWidget.page,this.owner.viewer.updatePageBoundingRectangle(this.selection.start.paragraph.bodyWidget,h,h.boundingRectangle.y),this.owner.viewer.updateClientArea(this.selection.start.paragraph.bodyWidget.sectionFormat,h)),c=0;c<n.length;c++)for(l=n[c].childWidgets,e=0;e<l.length;e++)if(i=l[e],(_instanceof(i,u)&&0===i.childWidgets.length&&(i.childWidgets[0]=new k(i)),_instanceof(i,u)&&!sf.base.isNullOrUndefined(t))&&(i.paragraphFormat.copyFormat(t),v=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!1),i.characterFormat.mergeFormat(v)),e===l.length-1&&_instanceof(i,u))o=i,o.childWidgets.length>0&&o.childWidgets[0].children.length>0&&(s=this.selection.start,("Center"!==s.paragraph.paragraphFormat.textAlignment&&"Right"!==s.paragraph.paragraphFormat.textAlignment||-1!==s.paragraph.paragraphFormat.listFormat.listId||(s.paragraph.x=this.owner.viewer.clientActiveArea.x),"KeepTextOnly"===this.currentPasteOptions)&&(y=new ut,this.selection.start.paragraph.paragraphFormat=y),this.insertElement(o.childWidgets[0].children,o.paragraphFormat));else if(_instanceof(i,wt)){if(r=this.selection.start.paragraph,_instanceof(i,f)&&(a=i,(this.generateTableRevision(a),r.isInsideTable)&&(p=r.getContainerWidth(),a.fitCellsToClientArea(p)),r.isEmpty()&&_instanceof(r.previousWidget,f)))return this.insertTableRows(a,r.previousWidget);this.insertBlockInternal(i)}},n.prototype.generateTableRevision=function(n){var t,i,r,f,u,e;if(this.owner.enableTrackChanges&&!sf.base.isNullOrUndefined(n))for(t=0;t<n.childWidgets.length;t++)for(i=n.childWidgets[t],this.insertRevision(i.rowFormat,"Insertion"),r=0;r<i.childWidgets.length;r++)for(f=i.childWidgets[r],u=0;u<f.childWidgets.length;u++)e=f.childWidgets[u],sf.base.isNullOrUndefined(e)||this.insertRevisionForBlock(e,"Insertion")},n.prototype.isSectionEmpty=function(n){var t=n.start.paragraph,r,i;if(t){if(t.isInsideTable||t.isInHeaderFooter||t!==n.end.paragraph)return!1;if(r=t.bodyWidget,r&&(i=r.page,i&&(sf.base.isNullOrUndefined(i.previousPage)||i.previousPage.sectionIndex!==i.sectionIndex)&&sf.base.isNullOrUndefined(i.nextPage)&&t.isEmpty()&&1===r.childWidgets.length))return!0}return!1},n.prototype.insertTableInternal=function(n,t,i){var o=n.getIndex(),r,f,e,u;if(i)for(r=0,f=0;r<n.childWidgets.length;r++,f++)e=n.childWidgets[r],t.childWidgets.splice(f,0,e),e.containerWidget=t,n.childWidgets.splice(r,1),r--;u=n.containerWidget;this.constructRevisionsForTable(n,!1);this.removeBlock(n,!0);u.childWidgets.splice(o,0,t);t.index=n.index;n.containerWidget=void 0;t.containerWidget=u;this.documentHelper.layout.clearTableWidget(t,!0,!0,!0);t.buildTableColumns();this.constructRevisionsForTable(t,!0);t.isGridUpdated=!0;this.updateNextBlocksIndex(t,!0);this.documentHelper.layout.linkFieldInTable(t);this.documentHelper.layout.layoutBodyWidgetCollection(t.index,u,t,!1)},n.prototype.canConstructRevision=function(n){return n.revisions.length>0&&0===n.revisions[0].range.length||n.removedIds.length>0},n.prototype.constructRevisionsForTable=function(n,t){for(var i,e,o,r,f=0;f<n.childWidgets.length;f++)if(i=n.childWidgets[f],t)for(this.canConstructRevision(i.rowFormat)&&this.constructRevisionFromID(i.rowFormat,!0),e=0;e<i.childWidgets.length;e++)for(o=i.childWidgets[e],r=0;r<o.childWidgets.length;r++)_instanceof(o.childWidgets[r],u)&&this.constructRevisionsForBlock(o.childWidgets[r],t);else this.removeDeletedCellRevision(i)},n.prototype.constructRevisionsForBlock=function(n,t){for(var r,i,u=0;u<n.childWidgets.length;u++)for(r=n.childWidgets[u],i=0;i<r.children.length;i++)t&&_instanceof(r.children[i],tt)&&this.canConstructRevision(r.children[i])&&this.constructRevisionFromID(r.children[i],!0);this.canConstructRevision(n.characterFormat)&&this.constructRevisionFromID(n.characterFormat,!0)},n.prototype.applyRevisionForCurrentPara=function(n,t,i,r,u){var f=n.getInline(t+1,0).element,o=!1,e;if(t===n.getLength()&&(o=!0),e=n.getInline(i,0).element,i>n.getLength()&&(u=!0),sf.base.isNullOrUndefined(f)||sf.base.isNullOrUndefined(e))sf.base.isNullOrUndefined(f)||o?sf.base.isNullOrUndefined(e)||(e.removedIds.push(r),this.constructRevisionFromID(e,!0)):(f.removedIds.push(r),this.constructRevisionFromID(f,!0));else if(o||f!==e){for(;!sf.base.isNullOrUndefined(f)&&f!==e;)o||(f.removedIds.push(r),this.constructRevisionFromID(f,!0)),sf.base.isNullOrUndefined(f.nextNode)||(f=f.nextNode.nextValidNodeForTracking),o=!1;sf.base.isNullOrUndefined(f)||o||(f.removedIds.push(r),this.constructRevisionFromID(f,!0))}else f.removedIds.push(r),this.constructRevisionFromID(f,!0);u&&(n.characterFormat.removedIds.push(r),this.constructRevisionFromID(n.characterFormat,!0))},n.prototype.insertBlockTable=function(n,t,i){var r=n.start.offset,o,e;n.start.paragraph.childWidgets.indexOf(n.start.currentWidget);_instanceof(t,u)&&r>0&&(this.moveInlines(n.start.paragraph,t,0,0,n.start.paragraph.firstChild,r,n.start.currentWidget),n.selectParagraphInternal(n.start.paragraph,!0),this.checkInsertPosition(n)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(t,r.toString()),!0));r>0&&this.checkInsertPosition(n)&&this.updateHistoryPosition(n.start,!0);o=i.indexInOwner;(i.containerWidget.childWidgets.splice(o,0,t),t.containerWidget=i.containerWidget,t.index=i.index,this.updateNextBlocksIndex(t,!0),this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.checkInsertPosition(n))&&(e=void 0,_instanceof(t,u)&&(e=t),_instanceof(t,f)&&(e=n.getFirstParagraphInFirstCell(t)),this.updateHistoryPosition(this.selection.getHierarchicalIndex(e,"0"),!0))},n.prototype.handleCut=function(n){var t=n.start,i=n.end,r,u;n.isForward||(t=n.end,i=n.start);r=this.selection.getParagraphInfo(t);(n.editPosition=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),t.paragraph===i.paragraph&&t.offset+1===i.offset)&&t.paragraph.getInline(i.offset,0).element;this.initHistory("Cut");n.owner.isShiftingEnabled=!0;this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(n)&&this.updateHistoryPosition(n.editPosition,!0);this.deleteSelectedContent(i.paragraph,n,t,i,3);u=new l(n.owner);this.setPositionForCurrentIndex(u,n.editPosition);n.selectContent(u,!0);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkEndPosition(n)&&this.updateHistoryPosition(n.end,!1);this.reLayout(n)},n.prototype.insertInlineInternal=function(n,t){var r=this.selection,s=n.length,e=this.selection.getParagraphInfo(r.start),i,u;if(t=sf.base.isNullOrUndefined(t)?"Insertion":t,r.start.paragraph.isEmpty())i=r.start.paragraph,"Center"!==i.paragraphFormat.textAlignment&&"Right"!==i.paragraphFormat.textAlignment||-1!==i.paragraphFormat.listFormat.listId||(i.x=this.owner.viewer.clientActiveArea.x),u=!sf.base.isNullOrUndefined(this.editorHistory)&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing),i.childWidgets[0].children.push(n),n.line=i.childWidgets[0],this.owner.enableTrackChanges&&n.isValidNodeForTracking&&!u&&this.insertRevision(n,t),(n.removedIds.length>0||u)&&this.constructRevisionFromID(n,!0),n.linkFieldCharacter(this.documentHelper),_instanceof(n,yt)&&("Footnote"===n.footnoteType&&this.updateFootnoteCollection(n),"Endnote"===n.footnoteType&&this.updateEndnoteCollection(n)),this.documentHelper.layout.reLayoutParagraph(i,0,0,void 0,void 0);else{var f=0,o=r.start.currentWidget.getInline(r.start.offset,f),h=o.element;f=o.index;this.insertElementInternal(h,n,f,t,!0)}this.setPositionParagraph(e.paragraph,e.offset+s,!0)},n.prototype.insertElement=function(n,t){var h=this.selection,b=0,e=void 0,v=-1,c=void 0,o=0,y=void 0,k=this.selection.getParagraphInfo(h.start),g=this.owner.enableTrackChanges,r=void 0,s=void 0,f=0,l,p,a,u,w,d;for(h.start.paragraph.isEmpty()?(c=(e=h.start.paragraph).childWidgets[0],v=0):(l=h.start.paragraph.paragraphFormat.bidi,p=h.start.currentWidget.getInline(h.start.offset,f,l),r=p.element,f=p.index,v=(e=r.line.paragraph).childWidgets.indexOf(r.line),o=r.indexInOwner,c=r.line,a=!1,_instanceof(r,i)&&(a=this.documentHelper.textHelper.getRtlLanguage(r.text).isRtl),f===r.length?(l||o++,y=!1):0===f?(a&&l&&this.isInsertField?o++:sf.base.isNullOrUndefined(r.previousNode)&&(o=0),y=!0):(o++,(s=new i).characterFormat.copyFormat(r.characterFormat),l&&this.isInsertField&&a?(s.text=r.text.slice(0,f),r.text=r.text.substring(f)):(s.text=r.text.substring(f),r.text=r.text.slice(0,f)),r.revisions.length>0&&!this.owner.enableTrackChanges&&this.splitRevisionForSpittedElement(r,s),c.children.splice(o,0,s),s.line=r.line)),u=0;u<n.length;u++)b+=n[u].length,_instanceof(n[u],i)&&n[u].text.indexOf(" ")>=0&&(this.documentHelper.triggerSpellCheck=!0),w=n[u].revisions.length,n[u].ischangeDetected=!0,c.children.splice(o,0,n[u]),n[u].line=c,n[u].linkFieldCharacter(this.documentHelper),d=this.updateRevisionForElement(r,n[u],f,0===u,s,y),g&&!d&&n[u].revisions.length===w&&this.checkToCombineRevisionsinBlocks(n[u],w===n[u].revisions.length,u>0&&u===n.length-1,"Insertion"),r=n[u],o++;t&&(sf.base.isNullOrUndefined(e.paragraphFormat.listFormat.list)||!sf.base.isNullOrUndefined(e.paragraphFormat.listFormat)&&-1===e.paragraphFormat.listFormat.listId)&&e.paragraphFormat.copyFormat(t);this.documentHelper.layout.reLayoutParagraph(e,v,0,this.isInsertField?void 0:e.paragraphFormat.bidi);this.setPositionParagraph(k.paragraph,k.offset+b,!0)},n.prototype.updateRevisionForElement=function(n,t,i,r,u,f){if(!this.owner.enableTrackChanges||sf.base.isNullOrUndefined(n)&&sf.base.isNullOrUndefined(u))return!1;var e=!!sf.base.isNullOrUndefined(f),o=t.revisions.length;return r?e?(this.checkToMapRevisionWithInlineText(n,i,t,!1,"Insertion")||t.revisions.length>o?this.copyElementRevision(n,u,!0):0===t.revisions.length&&(this.splitRevisionForSpittedElement(n,u),this.insertRevision(t,"Insertion")),!1):f?this.insertRevisionAtBegining(n,t,"Insertion"):this.insertRevisionAtEnd(n,t,"Insertion"):this.insertRevisionAtEnd(n,t,"Insertion")},n.prototype.insertElementInternal=function(n,t,u,f,o){var a=n.line,c=a.paragraph,d=a.indexInOwner,s=n.indexInOwner,v=c.paragraphFormat.bidi&&n.isRightToLeft,k=!1,h;f=sf.base.isNullOrUndefined(f)?"Insertion":f;var l=this.skipTracking(),y=this.owner.enableTrackChanges,p=!1,b=t.revisions.length;(this.owner.editorHistory&&(this.owner.editorHistory.isUndoing||this.owner.editorHistory.isRedoing)&&_instanceof(t,i)&&(k=n.characterFormat.isEqualFormat(t.characterFormat)&&this.documentHelper.textHelper.isRTLText(t.text)),k)?n.text=n.text.substring(0,u)+t.text+n.text.substring(u):u===n.length?(v||s++,t.removedIds.length>0||l?this.constructRevisionFromID(t,!0,n):!y||l||this.skipFieldDeleteTracking||(p=this.insertRevisionAtEnd(n,t,f)),a.children.splice(s,0,t)):0===u?(t.removedIds.length>0?this.constructRevisionFromID(t,!1):!y||l||this.skipFieldDeleteTracking||(p=this.insertRevisionAtBegining(n,t,f)),sf.base.isNullOrUndefined(n.previousNode)?(n.line.children.splice(0,0,t),s=0):n.line.children.splice(s,0,t)):(v||s++,h=new i,(h.characterFormat.copyFormat(n.characterFormat),h.text=n.text.substring(u),n.revisions.length>0&&!y&&!l&&0===t.removedIds.length&&this.splitRevisionForSpittedElement(n,h),n.text=n.text.substr(0,u),a.children.splice(s,0,h),h.line=n.line,p=!0,this.isTrackingFormField=_instanceof(n.previousElement,r),t.removedIds.length>0&&!this.isTrackingFormField)?(this.constructRevisionFromID(t,!1),this.copyElementRevision(n,h,!0)):this.owner.enableTrackChanges&&(_instanceof(t,e)||_instanceof(t,g)||_instanceof(t,ht)||_instanceof(t,ot)?this.copyElementRevision(n,h,!1):this.checkToMapRevisionWithInlineText(n,u,t,v,f)||t.revisions.length>b?this.copyElementRevision(n,h,!0):t.revisions.length===b&&(this.splitRevisionForSpittedElement(n,h),this.insertRevision(t,f))),a.children.splice(v?s+1:s,0,t),s-=1);t.line=n.line;t.linkFieldCharacter(this.documentHelper);_instanceof(t,w)&&0===t.type&&this.documentHelper.contentControlCollection.push(t);_instanceof(t,lt)&&"Inline"!==t.textWrappingStyle&&(-1===c.floatingElements.indexOf(t)&&c.floatingElements.push(t),-1===c.bodyWidget.floatingElements.indexOf(t)&&c.bodyWidget.floatingElements.push(t));!y||p||l||this.skipFieldDeleteTracking||this.checkToCombineRevisionsinBlocks(t,b===t.revisions.length,u===n.length,f);_instanceof(t,yt)&&(l&&(t.isLayout=!1),"Footnote"===t.footnoteType&&this.updateFootnoteCollection(t),"Endnote"===t.footnoteType&&this.updateEndnoteCollection(t));o&&this.documentHelper.layout.reLayoutParagraph(c,d,s,void 0,void 0)},n.prototype.constructRevisionFromID=function(n,t,i){var u,r,e,f;if(n.removedIds.length>0){for(u=0;u<n.removedIds.length;u++)r=void 0,this.documentHelper.revisionsInternal.containsKey(n.removedIds[u])&&((r=this.documentHelper.revisionsInternal.get(n.removedIds[u]),n.revisions.push(r),(t=!!t||this.skipTracking())&&this.editorHistory.isRedoing&&this.owner.editorHistory.currentBaseHistoryInfo&&"BackSpace"===this.owner.editorHistory.currentBaseHistoryInfo.action&&(t=!1),sf.base.isNullOrUndefined(i))?r.range.splice(t?r.range.length:0,0,n):(e=r.range.indexOf(i),e>=0?r.range.splice(e+(t?1:0),0,n):r.range.splice(t?r.range.length:0,0,n)),this.updateRevisionCollection(r));n.removedIds=[]}else for(u=0;u<n.revisions.length;u++)f=n.revisions[u],this.documentHelper.revisionsInternal.containsKey(f.revisionID)&&((f=this.documentHelper.revisionsInternal.get(f.revisionID)).range.splice(t?f.range.length:0,0,n),this.updateRevisionCollection(f))},n.prototype.insertBlock=function(n){var r=!0,t=this.selection,i;(t.isEmpty||(r=this.removeSelectedContents(t)),r||t.selectContent(t.start,!1),this.insertBlockInternal(n),this.addOrRemoveCommentsInBlock(n,!0),this.checkInsertPosition(t))&&(i=void 0,i=_instanceof(n,u)?n:this.selection.getFirstParagraphInFirstCell(n),this.updateHistoryPosition(this.selection.getHierarchicalIndex(i,"0"),!0));this.fireContentChange()},n.prototype.insertBlockInternal=function(n){var t=this.selection,r=this.selection.start.paragraph,e;if(!t.start.isAtParagraphStart){if(_instanceof(n,u))return e=t.start.clone(),this.insertNewParagraphWidget(n,!1),void(this.isInsertingTOC||this.combineRevisions(n,e,this.selection.end));this.updateInsertPosition();r=r.combineWidget(this.owner.viewer);this.splitParagraph(r,r.firstChild,0,t.start.currentWidget,t.start.offset,!1);t.selectParagraphInternal(this.selection.start.paragraph,!0)}var i=t.start.paragraph.containerWidget,o=t.start.paragraph.index,s=i.childWidgets.indexOf(t.start.paragraph);sf.base.isNullOrUndefined(i)||(i.childWidgets.splice(s,0,n),n.containerWidget=i,n.index=o,n.height=0,_instanceof(n,f)&&(n.isGridUpdated=!1,n.buildTableColumns(),n.isGridUpdated=!0),this.updateNextBlocksIndex(n,!0),!this.isInsertingTOC&&this.owner.enableTrackChanges&&!this.skipTracking()&&_instanceof(n,u)?this.insertRevisionForBlock(n,"Insertion"):_instanceof(n,u)?this.constructRevisionsForBlock(n,!0):_instanceof(n,f)&&this.constructRevisionsForTable(n,!0),this.documentHelper.layout.layoutBodyWidgetCollection(o,i,n,!1))},n.prototype.insertImage=function(n,t,i){var r=this;!this.owner.isReadOnlyMode&&this.canEditContentControl&&(sf.base.isNullOrUndefined(t)&&(t=100),sf.base.isNullOrUndefined(i)&&(i=100),this.insertPicture(n,t,i),setTimeout(function(){sf.base.isNullOrUndefined(r.viewer)||r.viewer.updateScrollBars()},30))},n.prototype.insertTable=function(n,t){var r=this.selection.start,i,o,u,s,e,h;if(!this.owner.isReadOnlyMode&&this.canEditContentControl){if(n=n||1,t=t||1,i=this.createTable(n,t),o=r.paragraph.getContainerWidth()-i.tableFormat.leftIndent,i.splitWidthToTableCells(o),u=r.paragraph.previousWidget,r.currentWidget.isFirstLine()&&0===r.offset&&_instanceof(u,f))return this.insertTableRows(i,u),void i.destroy();this.initHistory("InsertTable");this.documentHelper.owner.isShiftingEnabled=!0;this.insertBlock(i);s=this.selection.getFirstParagraphInFirstCell(i).childWidgets[0];r.setPosition(s,!0);this.selection.end.setPositionInternal(r);e=this.selection.getLastParagraphInLastCell(i.getSplitWidgets().pop());h=e.getLength()+1;this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(e,h.toString()));this.reLayout(this.selection)}},n.prototype.insertRow=function(n,t){var e=n?"Above":"Below",w,d,c,y,o,p,l,v;if(!this.owner.isReadOnlyMode&&this.canEditContentControl){if(w=this.selection.isForward?this.selection.start:this.selection.end,this.selection.isForward?this.selection.end:this.selection.start,w.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("Above"===e?"InsertRowAbove":"InsertRowBelow");this.documentHelper.owner.isShiftingEnabled=!0;var s=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],i=this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0],u=s.ownerTable.combineWidget(this.owner.viewer),r="Below"===e?i.ownerRow:s.ownerRow;this.editorHistory&&this.cloneTableToHistoryInfo(u);var b=t||this.getRowCountToInsert(),k=[],h=r.rowIndex;for("Below"===e&&(h++,d=sf.base.isNullOrUndefined(i.previousWidget)||i.columnIndex===i.previousWidget.columnIndex+1,i.cellIndex!==i.columnIndex&&d&&r.rowIndex+s.cellFormat.rowSpan-1===i.ownerRow.rowIndex||i.cellFormat.rowSpan>1&&!sf.base.isNullOrUndefined(r.nextWidget)&&_instanceof(r.nextWidget,a)&&(i.cellFormat.rowSpan+=b,r=r.nextWidget),r.bottomBorderWidth=0),c=0;c<b;c++)y=this.updateRowspan(r,"Below"===e?i:s,e),o=this.createRowAndColumn(y.count,c),o.rowFormat.copyFormat(r.rowFormat),this.owner.enableTrackChanges&&this.insertRevision(o.rowFormat,"Insertion"),this.updateCellFormatForInsertedRow(o,y.cellFormats),k.push(o);if(u.insertTableRowsInternal(k,h),p=void 0,l=void 0,_instanceof(u.childWidgets[h],a))p=u.childWidgets[h].firstChild,l=this.selection.getFirstParagraph(p);else{for(v=void 0;!_instanceof(v,f);)v=u.nextRenderedWidget;l=this.selection.getFirstParagraphInFirstCell(v)}this.documentHelper.layout.reLayoutTable(u);this.selection.selectParagraphInternal(l,!0)}this.reLayout(this.selection,!0)}},n.prototype.autoFitTable=function(n){var r,u,t,i;!this.documentHelper.owner.isReadOnlyMode&&this.canEditContentControl&&(r=this.selection.start,u=this.selection.end,this.selection.isForward||(r=this.selection.end,u=this.selection.start),t=this.selection.getTable(r,u),t=t.getSplitWidgets()[0],i=this.documentHelper.layout.getParentTable(t),sf.base.isNullOrUndefined(i)||(this.setOffsetValue(this.selection),i=i.combineWidget(this.owner.viewer),this.initHistory("FitToContents"===n?"TableAutoFitToContents":"FitToWindow"===n?"TableAutoFitToWindow":"TableFixedColumnWidth"),this.documentHelper.owner.editorHistoryModule&&this.cloneTableToHistoryInfo(i),i.updateProperties(!0,t,n),this.documentHelper.owner.isShiftingEnabled=!0,this.documentHelper.layout.reLayoutTable(t),this.reLayout(this.selection,!0)))},n.prototype.updateCellFormatForInsertedRow=function(n,t){for(var i=0;i<n.childWidgets.length;i++)n.childWidgets[i].cellFormat.copyFormat(t[i]),n.childWidgets[i].cellFormat.rowSpan=1},n.prototype.updateRowspan=function(n,t,i){for(var u,o,e=n.getPreviousRowSpannedCells(!0),s=0,h=[],c=0;c<n.childWidgets.length;c++){for(var r=n.childWidgets[c],l=!1,a=sf.base.isNullOrUndefined(r.previousWidget)||r.columnIndex!==r.previousWidget.columnIndex+1,f=0;f<e.length;f++)if(a)if(u=e[f],o=u.ownerRow.rowIndex+u.cellFormat.rowSpan-1,r.columnIndex<u.columnIndex&&r.cellIndex!==r.columnIndex&&(l=!0,s++,h.push(r.cellFormat)),1===t.cellFormat.rowSpan)if(o>r.ownerRow.rowIndex){if("Above"===i&&u.ownerRow===t.ownerRow)continue;u.cellFormat.rowSpan+=1;e.splice(f,1);f--}else r.cellIndex!==r.columnIndex&&a&&o===r.ownerRow.rowIndex&&("Above"===i?(u.cellFormat.rowSpan+=1,e.splice(f,1),f--):(s++,h.push(u.cellFormat),e.splice(f,1),f--));else if(u!==t){if("Above"===i&&(u.ownerRow===t.ownerRow||u.columnIndex===t.columnIndex))continue;u.columnIndex!==t.columnIndex&&u.ownerRow.rowIndex!==r.ownerRow.rowIndex&&(o>t.ownerRow.rowIndex||"Above"===i&&o===t.ownerRow.rowIndex)&&(u.cellFormat.rowSpan+=1,e.splice(f,1),f--)}-1===e.indexOf(r)&&r.cellFormat.rowSpan>1&&(l=!0);l||(s++,h.push(r.cellFormat))}return{count:s,cellFormats:h}},n.prototype.insertTableRows=function(n,t){var r,i;this.initHistory("InsertTableBelow");n.containerWidget=t.containerWidget;r=(t=t.combineWidget(this.owner.viewer)).childWidgets[t.childWidgets.length-1];t.insertTableRowsInternal(n.childWidgets,t.childWidgets.length);i=this.selection.getFirstParagraph(r.nextWidget.childWidgets[0]);this.checkInsertPosition(this.selection)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(i,"0"),!0);t.isDefaultFormatUpdated=!1;this.documentHelper.layout.reLayoutTable(t);this.selection.start.setPosition(i.firstChild,!0);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.updateHistoryPosition(this.selection.end,!1);this.selection.end.setPosition(i.firstChild,!0);this.reLayout(this.selection)},n.prototype.insertColumn=function(n,t){var y,f,h,i,s,a,e,v,r,w;if(!this.owner.isReadOnlyMode&&this.canEditContentControl&&(y=n?"Left":"Right",this.selection.start.paragraph.isInsideTable)){this.checkIsNotRedoing()&&this.initHistory("Left"===y?"InsertColumnLeft":"InsertColumnRight");this.selection.owner.isShiftingEnabled=!0;var c=this.getOwnerCell(this.selection.isForward),b=this.getOwnerCell(!this.selection.isForward),o=c.ownerRow.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.cloneTableToHistoryInfo(o);this.selection.owner.isLayoutEnabled=!1;f=c.columnIndex;"Right"===y&&(f=b.columnIndex+b.cellFormat.columnSpan);for(var p=void 0,u=void 0,d=t||this.getColumnCountToInsert(),l=[],k=0;k<d;k++)for(h=0;h<o.childWidgets.length;h++)if(i=o.childWidgets[h],(u=this.createColumn(this.selection.getLastParagraph(c))).index=h,u.rowIndex=i.rowIndex,u.containerWidget=i,u.cellFormat.copyFormat(c.cellFormat),u.cellFormat.rowSpan=1,sf.base.isNullOrUndefined(p)&&(p=this.selection.getFirstParagraph(u)),0===f)i.childWidgets.splice(f,0,u);else{for(s=!1,a=0;a<i.childWidgets.length;a++)if(e=i.childWidgets[a],e.cellFormat.rowSpan>1&&l.push(e),e.columnIndex+e.cellFormat.columnSpan===f?(i.childWidgets.splice(e.cellIndex+1,0,u),s=!0):f>e.columnIndex&&e.columnIndex+e.cellFormat.columnSpan>f&&f<e.columnIndex+e.cellFormat.columnSpan&&(i.childWidgets.splice(e.cellIndex,0,u),s=!0),s)break;if(!s&&l.length>0)for(v=0;v<l.length;v++)if(r=l[v],r.ownerRow!==i&&i.rowIndex<=r.ownerRow.rowIndex+r.cellFormat.rowSpan-1&&(r.columnIndex+r.cellFormat.columnSpan===f?(r.cellIndex>i.childWidgets.length?i.childWidgets.push(u):i.childWidgets.splice(r.cellIndex,0,u),s=!0):f>r.columnIndex&&r.columnIndex+r.cellFormat.columnSpan>f&&f<r.columnIndex+r.cellFormat.columnSpan&&(i.childWidgets.splice(r.columnIndex,0,u),s=!0)),s)break}o.updateRowIndex(0);w=this.documentHelper.layout.getParentTable(o);w?w.fitChildToClientArea():o.fitChildToClientArea();this.selection.owner.isLayoutEnabled=!0;o.isGridUpdated=!1;o.buildTableColumns();o.isGridUpdated=!0;this.documentHelper.skipScrollToPosition=!0;this.documentHelper.layout.reLayoutTable(o);this.selection.start.setPosition(p.firstChild,!0);this.selection.end.setPosition(this.selection.getLastParagraph(u).firstChild,!1);(this.checkIsNotRedoing()||sf.base.isNullOrUndefined(this.editorHistory))&&this.reLayout(this.selection)}},n.prototype.createTable=function(n,t){var i,u,r;for(this.selection.start.paragraph,i=new f,i.tableFormat=new pt(i),i.tableFormat.preferredWidthType="Auto",i.tableFormat.leftIndent=this.selection.start.paragraph.leftIndent,i.tableFormat.initializeTableBorders(),u=0;u<n;)r=this.createRowAndColumn(t,u),r.rowFormat.heightType="Auto",this.owner.enableTrackChanges&&this.insertRevision(r.rowFormat,"Insertion"),r.containerWidget=i,i.childWidgets.push(r),u++;return i},n.prototype.createRowAndColumn=function(n,t){var f=this.selection.start.paragraph,i=new a,u,r;for(i.rowFormat=new ti(i),i.index=t,u=0;u<n;u++)r=this.createColumn(f),r.index=u,r.rowIndex=t,r.containerWidget=i,i.childWidgets.push(r);return i},n.prototype.createColumn=function(n){var t=new s,i=new u;return i.paragraphFormat.copyFormat(n.paragraphFormat),i.paragraphFormat.leftIndent=0,i.characterFormat.copyFormat(n.characterFormat),i.containerWidget=t,t.childWidgets.push(i),t.cellFormat=new si(t),t},n.prototype.getColumnCountToInsert=function(){var i=1,n=this.selection.start,t=this.selection.end,u,r;if(this.selection.isForward||(n=this.selection.end,t=this.selection.start),n&&t&&this.selection.getTable(n,t)){if(n.paragraph.associatedCell===t.paragraph.associatedCell)return 1;if(n.paragraph.associatedCell.ownerRow===t.paragraph.associatedCell.ownerRow)return i+t.paragraph.associatedCell.cellIndex-n.paragraph.associatedCell.cellIndex;for(i=0,u=n.paragraph.associatedCell.ownerTable.getColumnCellsForSelection(n.paragraph.associatedCell,t.paragraph.associatedCell),r=0;r<u.length;r++)n.paragraph.associatedCell.ownerRow===u[r].ownerRow&&i++}return 0===i?1:i},n.prototype.getRowCountToInsert=function(){var i=1,n=this.selection.start,t=this.selection.end;return this.selection.isForward||(n=this.selection.end,t=this.selection.start),sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(this.selection.getTable(n,t))?0===i?1:i:n.paragraph.associatedCell===t.paragraph.associatedCell||n.paragraph.associatedCell.ownerRow===t.paragraph.associatedCell.ownerRow?1:i+this.getOwnerRow(!this.selection.isForward).rowIndex-this.getOwnerRow(this.selection.isForward).rowIndex},n.prototype.getOwnerCell=function(n){for(var i=void 0,r=n?this.selection.start.paragraph.associatedCell:this.selection.end.paragraph.associatedCell,u=n?this.selection.end.paragraph.associatedCell:this.selection.start.paragraph.associatedCell,t=(i=r).ownerTable;!sf.base.isNullOrUndefined(t)&&_instanceof(t.containerWidget,s)&&t!==u.ownerTable;)t=(i=t.containerWidget).ownerTable;return i},n.prototype.getOwnerRow=function(n){for(var i,r=n?this.selection.start.paragraph.associatedCell.ownerRow:this.selection.end.paragraph.associatedCell.ownerRow,u=n?this.selection.end.paragraph.associatedCell.ownerRow:this.selection.start.paragraph.associatedCell.ownerRow,t=(i=r).ownerTable;!sf.base.isNullOrUndefined(t)&&_instanceof(t.containerWidget,s)&&t!==u.ownerTable;)t=(i=t.containerWidget.ownerRow).ownerTable;return i},n.prototype.getOwnerTable=function(n){for(var t=void 0,i=this.selection.start.paragraph.associatedCell.ownerTable,r=this.selection.end.paragraph.associatedCell.ownerTable,t=n?i:r;_instanceof(t.containerWidget,s)&&t!==(n?r:i);)t=t.containerWidget.ownerTable;return t},n.prototype.mergeSelectedCellsInTable=function(){this.canMergeCells()&&(this.owner.enableTrackChanges||this.confirmCellMerge())},n.prototype.confirmCellMerge=function(){var r,u,e,f,o,s;this.checkIsNotRedoing()&&this.initHistory("MergeCells");this.selection.owner.isShiftingEnabled=!0;r=this.selection.start;u=this.selection.end;this.selection.isForward||(r=this.selection.end,u=this.selection.start);var t=this.getOwnerCell(this.selection.isForward),n=this.getOwnerCell(!this.selection.isForward),i=this.selection.getContainerCellOf(t,n);i.ownerTable.contains(n)&&!this.selection.containsCell(i,n)&&(e=t.ownerTable.combineWidget(this.owner.viewer),t=this.selection.getSelectedCell(t,i),n=this.selection.getSelectedCell(n,i),f=this.mergeSelectedCells(e,t,n),o=this.selection.getFirstParagraph(f),r.setPosition(o.firstChild,!0),s=this.selection.getLastParagraph(f),u.setPosition(s.lastChild,!1));(this.checkIsNotRedoing()||sf.base.isNullOrUndefined(this.editorHistory))&&this.reLayout(this.selection,!1)},n.prototype.mergeSelectedCells=function(n,i,r){var s,h,o,d,p,w,l,tt;this.cloneTableToHistoryInfo(n);this.selection.owner.isLayoutEnabled=!1;var a=this.selection.getCellLeft(i.ownerRow,i),b=a+i.cellFormat.cellWidth,g=this.selection.getCellLeft(r.ownerRow,r),it=g+r.cellFormat.cellWidth,nt=this.updateSelectedCellsInTable(a,b,g,it);a=nt.start;b=nt.end;for(var k,v=n.childWidgets.indexOf(r.ownerRow),y=n.childWidgets.indexOf(i.ownerRow),e=void 0,c=y;c<=v;c++){for(s=n.childWidgets[c],h=0;h<s.childWidgets.length;h++)if(o=s.childWidgets[h],d=this.selection.getCellLeft(s,o),t.round(a,2)<=t.round(d,2)&&t.round(d,2)<t.round(b,2))if(p=o.lastChild,_instanceof(p,u)&&p.isEmpty()&&o.childWidgets.pop(),sf.base.isNullOrUndefined(e))e=o,k=p;else{for(c===y&&(e.cellFormat.preferredWidth+=o.cellFormat.preferredWidth,e.cellFormat.columnSpan+=o.cellFormat.columnSpan,this.mergeBorders(e,o)),w=0;w<o.childWidgets.length;w++)(l=o.childWidgets[w].clone()).containerWidget=e,e.childWidgets.push(l);s.childWidgets.splice(h,1);o.destroy();h--}(0===e.childWidgets.length||1===e.childWidgets.length&&_instanceof(e.childWidgets[0],f))&&k&&(l=k.clone(),e.childWidgets.push(l),l.containerWidget=e);0===s.childWidgets.length&&(tt=n.childWidgets.indexOf(s),s.updateRowBySpannedCells(),n.childWidgets.splice(tt,1),s.destroy(),v--,c--)}return!sf.base.isNullOrUndefined(e)&&y<v&&(e.cellFormat.rowSpan=v-y+1),this.updateBlockIndexAfterMerge(e),n.updateRowIndex(0),n.calculateGrid(),n.isGridUpdated=!1,n.buildTableColumns(),n.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(n),this.selection.owner.isLayoutEnabled=!0,e},n.prototype.mergeBorders=function(n,t){var i=void 0,r=null;if(sf.base.isNullOrUndefined(n.cellFormat.borders)||(i=n.cellFormat.borders),sf.base.isNullOrUndefined(t.cellFormat.borders)||(r=t.cellFormat.borders),!sf.base.isNullOrUndefined(i)||!sf.base.isNullOrUndefined(r))if(sf.base.isNullOrUndefined(i))(i=new ni(n.cellFormat)).copyFormat(r);else{if(sf.base.isNullOrUndefined(r))return;n.ownerRow.rowIndex===t.ownerRow.rowIndex&&(i.top=n.getBorderBasedOnPriority(i.top,r.bottom),i.bottom=n.getBorderBasedOnPriority(i.bottom,r.bottom))}},n.prototype.updateBlockIndexAfterMerge=function(n){for(var t=0;t<n.childWidgets.length;t++)n.childWidgets[t].index=t},n.prototype.canMergeCells=function(){var e,o,i,r,f;if(this.selection.isEmpty||!this.selection.start.paragraph.isInsideTable||!this.selection.end.paragraph.isInsideTable)return!1;this.selection.start;this.selection.end;this.selection.isForward||(this.selection.end,this.selection.start);var n=this.getOwnerCell(this.selection.isForward),t=this.getOwnerCell(!this.selection.isForward),u=this.selection.getContainerCellOf(n,t);if(u.ownerTable.contains(t)&&!this.selection.containsCell(u,t)){if(n=this.selection.getSelectedCell(n,u),t=this.selection.getSelectedCell(t,u),e=1,n.ownerRow===t.ownerRow){for(o=n.ownerRow.childWidgets.indexOf(n),i=o;i<=n.ownerRow.childWidgets.indexOf(t);i++){if(r=n.ownerRow.childWidgets[i],f=r.previousWidget,i!==o&&(r.cellFormat.rowSpan!==e||!sf.base.isNullOrUndefined(f)&&r.columnIndex!==f.cellFormat.columnSpan+f.columnIndex))return!1;e=r.cellFormat.rowSpan}return!0}return this.canMergeSelectedCellsInTable(n.ownerTable,n,t)}return!1},n.prototype.canMergeSelectedCellsInTable=function(n,i,r){var y=n.childWidgets.indexOf(r.ownerRow),b=n.childWidgets.indexOf(i.ownerRow),h=this.selection.getCellLeft(i.ownerRow,i),c=h+i.cellFormat.cellWidth,nt=this.selection.getCellLeft(r.ownerRow,r),et=nt+r.cellFormat.cellWidth,tt=this.updateSelectedCellsInTable(h,c,nt,et),u,l,v,s,w;h=tt.start;c=tt.end;for(var it=0,rt=0,k=!1,d=!1,f=[],e=b;e<=y;e++){for(var a=n.childWidgets[e],p=0,o=0,ut=!1,g=0;g<a.childWidgets.length;g++)if(u=a.childWidgets[g],l=this.selection.getCellLeft(a,u),this.checkCellWithInSelection(h,c,l)){k=!1;d=!1;u.cellFormat.rowSpan>1&&f.push(u);ut||(p=l,o=l,ut=!0);v=u.previousWidget;0!==o&&t.round(o,0)!==t.round(l,0)&&(o=l);o+=t.convertPointToPixel(u.cellFormat.cellWidth);var ft=this.checkPrevOrNextCellIsWithinSel(h,c,u,!0),ot=this.checkPrevOrNextCellIsWithinSel(h,c,u,!1),st=0===f.length||1===f.length&&f[0]===u,ht=this.checkCurrentCell(f,u,ft,ot);if(e===y&&!sf.base.isNullOrUndefined(v)&&u.cellFormat.rowSpan>v.cellFormat.rowSpan&&!ht)return!1;if(e!==b)for(s=0;s<f.length;s++)if(w=f[s].ownerRow.rowIndex+f[s].cellFormat.rowSpan-1,w>=a.rowIndex){if(f[s].columnIndex>u.columnIndex?d=!0:k=!0,e===y&&f[s]!==u&&w>u.ownerRow.rowIndex+u.cellFormat.rowSpan-1)return!1;w!==a.rowIndex||this.checkPrevOrNextCellIsWithinSel(h,c,u,!1)||f.splice(f.indexOf(f[s]),1)}if(ft&&!sf.base.isNullOrUndefined(v)&&st&&u.columnIndex!==v.columnIndex+1&&this.checkCellWidth(u))return!1}if(e===b)it=p,rt=o;else{if(o>0&&p>0&&(!k&&Math.round(it)!==Math.round(p)||!d&&Math.round(rt)!==Math.round(o)))return!1;if(e===y)return!0}}return!1},n.prototype.checkCellWidth=function(n){var i=n.previousWidget,r=this.documentHelper.selection.getCellLeft(n.ownerRow,n),u=this.documentHelper.selection.getCellLeft(n.ownerRow,i)+t.convertPointToPixel(i.cellFormat.cellWidth);return t.round(u,2)!==t.round(r,2)},n.prototype.checkCellWithInSelection=function(n,i,r){return t.round(n,2)<=t.round(r,2)&&t.round(r,2)<t.round(i,2)},n.prototype.checkPrevOrNextCellIsWithinSel=function(n,t,i,r){var f,u=r?i.previousWidget:i.nextWidget;return!sf.base.isNullOrUndefined(u)&&(f=this.documentHelper.selection.getCellLeft(u.ownerRow,u),this.checkCellWithInSelection(n,t,f))},n.prototype.checkCurrentCell=function(n,t,i,r){var e=t.ownerRow,u,f,o;if(n.length>0)for(u=0;u<n.length;u++)if((f=n[u].ownerRow,o=f.rowIndex+n[u].cellFormat.rowSpan-1,n[u]===t&&(1===n.length||this.checkRowSpannedCells(n,t))&&!r&&!i)||n[u]!==t&&f.rowIndex<e.rowIndex&&o===e.rowIndex+t.cellFormat.rowSpan-1)return!0;return!1},n.prototype.checkRowSpannedCells=function(n,t){for(var i=0;i<n.length;i++)if(n[i]!==t&&n[i].columnIndex===t.columnIndex)return!0;return!1},n.prototype.insertNewParagraphWidget=function(n,t){if(this.updateInsertPosition(),this.insertParagraph(n,t),!t){var i=void 0,r=n;do r=i=this.selection.getNextParagraphBlock(r);while(i&&i.equals(n));sf.base.isNullOrUndefined(i)?this.selection.selectParagraphInternal(n,!0):this.selection.selectParagraphInternal(i,!0)}this.fireContentChange()},n.prototype.insertParagraph=function(n,t){var o=this.selection.start.currentWidget,r=this.selection.start.offset,i,s,h,u,e,f;this.editorHistory&&this.editorHistory.isUndoing&&"InsertTextParaReplace"===this.editorHistory.currentBaseHistoryInfo.action&&(r=0);i=this.selection.start.paragraph;(i=i.combineWidget(this.owner.viewer),t)?(s=this.selection.getLineLength(i.lastChild),h=n.firstChild?n.firstChild.children.length:0,this.moveInlines(i,n,h,r,o,s,i.lastChild)):r>0&&this.moveInlines(i,n,0,0,i.firstChild,r,o);u=i.getSplitWidgets();e=(i=t?u[u.length-1]:u[0]).containerWidget.childWidgets.indexOf(i);t&&e++;f=i.containerWidget;n.index=i.index;n.containerWidget=f;f.childWidgets.splice(e,0,n);this.constructRevisionsForBlock(n,!0);this.updateNextBlocksIndex(t?i:n,!0);n.height=0;this.documentHelper.layout.layoutBodyWidgetCollection(n.index,f,n,!1)},n.prototype.moveInlines=function(n,t,i,r,u,f,e){var c,h,s,o;for(0===t.childWidgets.length&&(c=new k(t),t.childWidgets.push(c)),h=!1,this.documentHelper.layout.clearListElementBox(n),this.documentHelper.layout.clearListElementBox(t),s=0;s<n.childWidgets.length;s++){if(o=n.childWidgets[s],u===o&&e===o){i=this.moveContent(o,r,f,i,t);break}if(e===o){i=this.moveContent(o,0,f,i,t);break}u===o?(h=!0,i=this.moveContent(o,r,this.documentHelper.selection.getLineLength(o),i,t)):h&&(i=this.moveContent(o,0,this.documentHelper.selection.getLineLength(o),i,t))}this.removeEmptyLine(n);n.isInsideTable||this.documentHelper.layout.reLayoutParagraph(n,0,0)},n.prototype.moveContent=function(n,t,r,u,f){for(var e,s,c,v,l,h=0,a=0;a<n.children.length;a++)if(e=n.children[a],t>=h+e.length||_instanceof(e,o))_instanceof(e,o)||(h+=e.length);else{if(s=0,t>h&&(s=t-h),c=r-h,(c>e.length&&(c=e.length),s>0&&(h+=s),0===s&&c===e.length)?(_instanceof(e,nt)&&(v=n.paragraph.floatingElements.indexOf(e),-1!==v&&n.paragraph.floatingElements.splice(v,1)),f.firstChild.children.splice(u,0,e),e.line=f.firstChild,u++,n.children.splice(a,1),a--):_instanceof(e,i)&&(l=new i,l.characterFormat.copyFormat(e.characterFormat),l.text=e.text.substr(s,c-s),e.ischangeDetected=!0,l.ischangeDetected=!0,f.firstChild.children.splice(u,0,l),l.line=f.firstChild,u++,this.updateRevisionForMovedContent(e,l),e.text=e.text.slice(0,s)+e.text.slice(c),e.ischangeDetected=!0),r<=h+c-s)break;h+=c-s}return u},n.prototype.updateRevisionForMovedContent=function(n,t){for(var r,u,i=0;i<n.revisions.length;i++)r=n.revisions[i],u=r.range.indexOf(n),t.revisions.splice(0,0,r),r.range.splice(u,0,t)},n.prototype.updateComplexWithoutHistory=function(n,t,i){var r=this.documentHelper.selection,u,f;0===n&&(u=new l(r.owner),this.setPositionForCurrentIndex(u,t),this.documentHelper.layout.reLayoutParagraph(u.paragraph,0,0),this.setPositionForCurrentIndex(r.start,i),this.setPositionForCurrentIndex(r.end,i));1===n&&(u=new l(r.owner),this.setPositionForCurrentIndex(u,t),f=new l(r.owner),this.setPositionForCurrentIndex(f,i),this.documentHelper.layout.reLayoutParagraph(u.paragraph,0,0),f.paragraph!==u.paragraph&&this.documentHelper.layout.reLayoutParagraph(f.paragraph,0,0));r.owner.isShiftingEnabled&&(this.documentHelper.layout.shiftLayoutedItems(!1),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget());r.owner.isShiftingEnabled=!1;r.start.updatePhysicalPosition(!0);r.isEmpty?r.end.setPositionInternal(r.start):r.end.updatePhysicalPosition(!0);r.upDownSelectionLength=r.end.location.x;r.fireSelectionChanged(!0);this.documentHelper.updateFocus();this.owner.viewer.updateScrollBars();this.fireContentChange();this.isHandledComplex=!0},n.prototype.reLayout=function(n,t){if(!sf.base.isNullOrUndefined(this.previousBlockToLayout)){var i=this.previousBlockToLayout;this.documentHelper.layout.layoutBodyWidgetCollection(i.index,i.bodyWidget,i,!1,!1);this.previousBlockToLayout=void 0}if(!this.documentHelper.isComposingIME&&this.editorHistory&&this.editorHistory.isHandledComplexHistory())return this.editorHistory.currentHistoryInfo&&"ClearFormat"!==this.editorHistory.currentHistoryInfo.action&&"ApplyStyle"!==this.editorHistory.currentHistoryInfo.action&&(this.startParagraph=void 0,this.endParagraph=void 0),void(this.isHandledComplex=!1);sf.base.isNullOrUndefined(this.documentHelper.blockToShift)&&(this.documentHelper.removeEmptyPages(),this.documentHelper.layout.updateFieldElements(),this.owner.viewer.updateScrollBars(),n.owner.isShiftingEnabled||(n.fireSelectionChanged(!0),this.startParagraph=void 0,this.endParagraph=void 0));sf.base.isNullOrUndefined(t)&&(t=n.isEmpty);this.owner.showRevisions&&this.owner.trackChangesPane.updateTrackChanges();n.owner.isShiftingEnabled&&(n.owner.isShiftingEnabled=!1,n.owner.isLayoutEnabled=!0,this.documentHelper.layout.shiftLayoutedItems(!0),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget(),sf.base.isNullOrUndefined(n.start.paragraph)||_instanceof(n.start.paragraph.containerWidget,it)&&("Footnote"===n.start.paragraph.containerWidget.footNoteType?(this.documentHelper.layout.isRelayoutFootnote=!0,this.shiftFootnotePageContent(n.start.paragraph.containerWidget)):(this.documentHelper.layout.isRelayoutFootnote=!1,this.shiftFootnotePageContent())),this.getOffsetValue(n),n.upDownSelectionLength=n.end.location.x,n.fireSelectionChanged(!0),this.documentHelper.updateFocus(),this.startParagraph=void 0,this.endParagraph=void 0,this.documentHelper.layout.allowLayout=!0);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&("RowResizing"!==this.editorHistory.currentBaseHistoryInfo.action&&"CellResizing"!==this.editorHistory.currentBaseHistoryInfo.action||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(this.editorHistory.currentBaseHistoryInfo.modifiedProperties.length>0&&this.editorHistory.currentBaseHistoryInfo.updateSelection(),this.editorHistory.undoStack&&this.editorHistory.undoStack.length>0&&_instanceof(this.editorHistory.undoStack[this.editorHistory.undoStack.length-1],kr)&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions[this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions.length-1]===this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo=void 0:this.editorHistory.updateHistory());this.fireContentChange();this.owner.documentHelper.layout.isRelayout=!1},n.prototype.updateHeaderFooterWidget=function(n){sf.base.isNullOrUndefined(n)&&(n=this.selection.start.paragraph.bodyWidget);this.updateHeaderFooterWidgetToPage(n);this.shiftPageContent(n.headerFooterType,n.sectionFormat)},n.prototype.updateHeaderFooterWidgetToPage=function(n){for(var t,u=n.page,r="EvenHeader"===(n=this.documentHelper.layout.updateHeaderFooterToParent(n)).headerFooterType||"EvenFooter"===n.headerFooterType,i=0;i<this.documentHelper.pages.length;i++){if(t=this.documentHelper.pages[i],i+1===1&&t.bodyWidgets[0].sectionFormat.differentFirstPage&&-1!==n.headerFooterType.indexOf("FirstPage"))return;0===t.index&&t.bodyWidgets[0].sectionFormat.differentFirstPage&&-1===n.headerFooterType.indexOf("FirstPage")||u!==t&&(t.bodyWidgets[0].sectionFormat.differentOddAndEvenPages?r&&(i+1)%2==0?this.updateHeaderFooterWidgetToPageInternal(t,n,-1!==n.headerFooterType.indexOf("Header")):r||(i+1)%2==0||(i>0||!t.bodyWidgets[0].sectionFormat.differentFirstPage)&&this.updateHeaderFooterWidgetToPageInternal(t,n,-1!==n.headerFooterType.indexOf("Header")):this.updateHeaderFooterWidgetToPageInternal(t,n,-1!==n.headerFooterType.indexOf("Header")))}},n.prototype.updateHeaderFooterWidgetToPageInternal=function(n,t,i){var r,u;t.page!==n&&(r=t.clone(),r.page=n,this.owner.viewer.updateHFClientArea(r.sectionFormat,i),r=this.documentHelper.layout.layoutHeaderFooterItems(this.owner.viewer,r),u=void 0,i?(u=n.headerWidget,n.headerWidget=r):(u=n.footerWidget,n.footerWidget=r),this.removeFieldInWidget(u),this.removeFieldInWidget(u,void 0,!0),u.destroy())},n.prototype.removeFieldInWidget=function(n,t,i){sf.base.isNullOrUndefined(t)&&(t=!1);for(var r=0;r<n.childWidgets.length;r++)this.removeFieldInBlock(n.childWidgets[r],t,i)},n.prototype.removeFieldInBlock=function(n,t,i){if(_instanceof(n,f)){if(n.wrapTextAround&&!sf.base.isNullOrUndefined(n.bodyWidget)){var r=n.bodyWidget.floatingElements.indexOf(n);-1!==r&&n.bodyWidget.floatingElements.splice(r,1)}this.removeFieldTable(n,t,i)}else this.removeField(n,t,i)},n.prototype.removeFieldTable=function(n,t,i){for(var f,u,r=0;r<n.childWidgets.length;r++)for(f=n.childWidgets[r],u=0;u<f.childWidgets.length;u++)this.removeFieldInWidget(f.childWidgets[u],t,i)},n.prototype.shiftFootnotePageContent=function(n){var t=this.documentHelper.pages[0].bodyWidgets[0],i;sf.base.isNullOrUndefined(n)||(i=this.documentHelper.pages.indexOf(n.page),t=this.documentHelper.pages[i].bodyWidgets[0]);sf.base.isNullOrUndefined(t.page.footnoteWidget)||this.checkAndShiftFromBottom(t.page,t.page.footnoteWidget);sf.base.isNullOrUndefined(t.page.endnoteWidget);this.documentHelper.blockToShift&&(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.layout.shiftLayoutedItems(!1))},n.prototype.shiftPageContent=function(n,i){var u,s,r,f,c,o;-1!==n.indexOf("First")?u=0:i.differentOddAndEvenPages?(s=-1!==n.indexOf("Even"),u=i.differentFirstPage?s?1:2:s?1:0):1==(u=i.differentFirstPage?1:0)&&1===this.documentHelper.pages.length&&(u=0);r=this.documentHelper.pages[u].bodyWidgets[0];do{if(-1!==n.indexOf("Header")){var l=r.page.headerWidget,a=!l.isEmpty||l.isEmpty&&this.owner.enableHeaderAndFooter,e=r.firstChild,h=t.convertPointToPixel(i.topMargin),v=t.convertPointToPixel(i.headerDistance);(a&&(h=Math.max(v+r.page.headerWidget.height,h)),e.y!==h)&&(this.owner.viewer.updateClientArea(r.sectionFormat,r.page),f=(e=e.combineWidget(this.owner.viewer)).previousRenderedWidget,f&&e.containerWidget.equals(f.containerWidget)&&(this.owner.viewer.cutFromTop(f.y+f.height),this.documentHelper.layout.updateContainerWidget(e,f.containerWidget,f.indexInOwner+1,!1)),this.documentHelper.blockToShift=e)}else this.checkAndShiftFromBottom(r.page,r.page.footerWidget);for(this.documentHelper.blockToShift&&(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.layout.shiftLayoutedItems(!1));r;)if(c=r.getSplitWidgets(),r=c[c.length-1].nextRenderedWidget){if(0===u)break;if(r.page.index+1===0&&1===u||r.page.index+1!==0&&2===u)break;if(o=r.page.nextPage,!sf.base.isNullOrUndefined(o)&&o.bodyWidgets[0].equals(r)){r=o.bodyWidgets[0];break}}}while(r)},n.prototype.checkAndShiftFromBottom=function(n,t){for(var f,i,r=n.bodyWidgets[0],u=0;u<r.childWidgets.length;u++){if(i=r.childWidgets[u],i.y+i.height>t.y){f=i;break}if(r.childWidgets.length-1===u&&i.y+i.height<t.y){f=i;break}}this.owner.viewer.updateClientArea(r.sectionFormat,n,!0);this.owner.viewer.cutFromTop(f.y);this.documentHelper.blockToShift=f},n.prototype.allowFormattingInFormFields=function(n){if("FormFieldsOnly"===this.documentHelper.protectionType&&this.selection.isInlineFormFillMode()&&!sf.base.isNullOrUndefined(this.owner.documentEditorSettings.formFieldSettings.formattingExceptions))for(var t=0;t<this.owner.documentEditorSettings.formFieldSettings.formattingExceptions.length;t++)if(n.toLowerCase()===this.owner.documentEditorSettings.formFieldSettings.formattingExceptions[t].toLowerCase())return!0;return!1},n.prototype.getContentControl=function(){for(var n=0;n<this.documentHelper.contentControlCollection.length;n++){var r=this.documentHelper.contentControlCollection[n],u=this.selection.getPosition(r),f=u.startPosition,e=u.endPosition,t=this.selection.start,i=this.selection.end;if(this.selection.isForward||(t=this.selection.end,i=this.selection.start),(t.isExistAfter(f)||t.isAtSamePosition(f))&&(i.isExistBefore(e)||i.isAtSamePosition(e)))return r}},n.prototype.checkPlainTextContentControl=function(){var i=this.selection.start,r=this.selection.end,u,f,n,t,c,a;this.selection.isForward||(r=this.selection.start,i=this.selection.end);var e=0,o=0,s=i.currentWidget.getInline(i.offset,e),h=r.currentWidget.getInline(r.offset,o);e=s.index;o=h.index;n=s.element;t=h.element;n&&n.contentControlProperties&&"Text"===n.contentControlProperties.type||t&&t.contentControlProperties&&"Text"===t.contentControlProperties.type?((n=this.getContentControl()).contentControlProperties&&!sf.base.isNullOrUndefined(n)?(c=n.line.getOffset(n,1),(u=new l(this.owner)).setPositionParagraph(n.line,c)):u=i,t.contentControlProperties&&n.reference?(a=(t=n.reference).line.getOffset(t,t.length),(f=new l(this.owner)).setPositionParagraph(t.line,a)):f=r,this.selection.selectRange(u,f)):i.paragraph.contentControlProperties&&"Text"===i.paragraph.contentControlProperties.type&&this.selection.selectParagraph()},n.prototype.onApplyCharacterFormat=function(n,t,i){var s=this.documentHelper.isFormFillProtectedMode&&this.documentHelper.selection.isInlineFormFillMode()&&this.allowFormattingInFormFields(n),r,e,f,o,u;if(!(this.restrictFormatting&&!s||this.selection.checkContentControlLocked(!0))&&(this.documentHelper.layout.isBidiReLayout=!0,r=this.documentHelper.selection,(!r.owner.isReadOnlyMode||s)&&r.owner.isDocumentLoaded)){if(i=!sf.base.isNullOrUndefined(i)&&i,e=n[0].toUpperCase()+n.slice(1),f=r.start.paragraph,f.childWidgets[f.childWidgets.length-1],this.checkPlainTextContentControl(),r.isEmpty&&"List"!==r.contextType)return r.skipFormatRetrieval=!0,r.end.isAtParagraphEnd?(this.initHistory(e),this.documentHelper.owner.isShiftingEnabled=!0,this.applyCharFormatValue(f.characterFormat,n,t,i),this.reLayout(this.documentHelper.selection),this.documentHelper.updateFocus()):r.fireSelectionChanged(!0),void(r.skipFormatRetrieval=!1);if("highlightColor"===n&&r.start.isInSameParagraph(r.end)&&(o=r.start,u=r.end,this.selection.isForward||(u=r.start,o=r.end),u.offset===r.getLineLength(u.currentWidget)+1&&u.offset-1===o.offset))return;this.setOffsetValue(r);this.initHistory(e);"List"===r.contextType?this.applyCharacterFormatForListText(r,n,t,i):this.updateSelectionCharacterFormatting(n,t,i);this.documentHelper.layout.isBidiReLayout=!1}},n.prototype.applyCharacterFormatForListText=function(n,t,i){var u=n.getListLevel(n.start.paragraph),r;if(!sf.base.isNullOrUndefined(u)){r=u.characterFormat;switch(t){case"bold":this.applyListCharacterFormatByValue(n,r,"bold",!r.bold);break;case"italic":this.applyListCharacterFormatByValue(n,r,"italic",!r.italic);break;case"fontColor":this.applyListCharacterFormatByValue(n,r,"fontColor",i);break;case"fontFamily":this.applyListCharacterFormatByValue(n,r,"fontFamily",i);break;case"fontSize":this.applyListCharacterFormatByValue(n,r,"fontSize",i);break;case"highlightColor":this.applyListCharacterFormatByValue(n,r,"highlightColor",i);break;case"baselineAlignment":r.baselineAlignment===i&&(i="Normal");this.applyListCharacterFormatByValue(n,r,"baselineAlignment",i);break;case"strikethrough":r.strikethrough===i&&(i="None");this.applyListCharacterFormatByValue(n,r,"strikethrough",i);break;case"underline":r.underline===i&&(i="None");this.applyListCharacterFormatByValue(n,r,"underline",i);break;case"characterFormat":this.applyListCharacterFormatByValue(n,r,void 0,i)}}},n.prototype.applyListCharacterFormatByValue=function(n,t,i,r){this.initHistory("ListCharacterFormat");this.applyCharFormatValue(t,i,r,!1);this.editorHistory.updateHistory();this.reLayout(n);this.fireContentChange()},n.prototype.updateListCharacterFormat=function(n,t,i){this.updateListTextSelRange(n,t,i,!1)},n.prototype.updateListTextSelRange=function(n,t,i,r){var u,f,e;this.documentHelper.owner.isShiftingEnabled=!0;u=n.start;f=n.end;n.isForward||(u=n.end,f=n.start);this.initHistoryPosition(n,u);e=n.getListLevel(n.start.paragraph);this.applyCharFormatValue(e.characterFormat,t,i,r);this.startSelectionReLayouting(u.paragraph,n,u,f)},n.prototype.updateInsertPosition=function(){var n=this.documentHelper.selection,t=n.start;n.isForward||(t=n.end);!this.editorHistory||sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&this.updateHistoryPosition(t,!0)},n.prototype.setOffsetValue=function(n){var t=this.selection.getParagraphInfo(n.start);this.startParagraph=t.paragraph;this.startOffset=t.offset;t=this.selection.getParagraphInfo(n.end);this.endParagraph=t.paragraph;this.endOffset=t.offset},n.prototype.toggleHighlightColor=function(n){var t=this.documentHelper.selection;(sf.base.isNullOrUndefined(n)||"NoColor"===n)&&(n="Yellow");t.characterFormat.highlightColor===n&&(n="NoColor");this.selection.characterFormat.highlightColor=n},n.prototype.toggleSubscript=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting){var n="Subscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Subscript";this.selection.characterFormat.baselineAlignment=n}},n.prototype.toggleSuperscript=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting){var n="Superscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Superscript";this.selection.characterFormat.baselineAlignment=n}},n.prototype.increaseIndent=function(){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("leftIndent",this.documentHelper.defaultTabWidth,!0,!1)},n.prototype.decreaseIndent=function(){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("leftIndent",-this.documentHelper.defaultTabWidth,!0,!1)},n.prototype.clearList=function(){this.selection.owner.editorModule.onApplyList(void 0)},n.prototype.applyBullet=function(n,t){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.applyBulletOrNumbering(n,"Bullet",t)},n.prototype.applyNumbering=function(n,t){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.applyBulletOrNumbering(n,t,"Verdana")},n.prototype.toggleBaselineAlignment=function(n){this.updateProperty(2,n)},n.prototype.clearFormatting=function(){var n=this.documentHelper.selection;this.setPreviousBlockToLayout();this.initComplexHistory("ClearFormat");n.isEmpty&&(n.start.moveToParagraphStartInternal(n,!1),n.end.moveToParagraphEndInternal(n,!1));this.setOffsetValue(n);this.editorHistory&&this.editorHistory.initializeHistory("ClearCharacterFormat");this.updateSelectionCharacterFormatting("ClearCharacterFormat",void 0,!1);this.getOffsetValue(n);this.editorHistory&&this.editorHistory.updateHistory();this.setOffsetValue(n);this.editorHistory&&this.editorHistory.initializeHistory("ClearParagraphFormat");this.updateParagraphFormatInternal("ClearParagraphFormat",void 0,!1);this.editorHistory&&this.editorHistory.updateHistory();this.getOffsetValue(n);this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory();this.startParagraph=void 0;this.endParagraph=void 0},n.prototype.updateProperty=function(n,t){var r=this.selection,u,f,e,o;if((!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())&&r.owner.isDocumentLoaded){u=r.start;r.end;r.isForward||(u=r.end,r.start);var s=0,h=u.currentWidget.getInline(u.offset,s),i=h.element;s=h.index;f=u.paragraph;(sf.base.isNullOrUndefined(i)||i.length!==s||this.selection.isEmpty||(i=i.nextNode),1===n)?(e="None",sf.base.isNullOrUndefined(i)?sf.base.isNullOrUndefined(f)||(e=f.characterFormat.underline):e=i.characterFormat.underline,this.selection.characterFormat.underline=t===e?"None":t):(o="Normal",sf.base.isNullOrUndefined(i)?sf.base.isNullOrUndefined(f)||(o=f.characterFormat.baselineAlignment):o=i.characterFormat.baselineAlignment,o===t&&(t="Normal"),this.selection.characterFormat.baselineAlignment=t)}},n.prototype.getCompleteStyles=function(){for(var r,t='{"styles":[',n=0,i=this.documentHelper.preDefinedStyles.keys;n<i.length;n++)r=i[n],t+=this.documentHelper.preDefinedStyles.get(r)+",";return t.slice(0,-1)+"]}"},n.prototype.intializeDefaultStyles=function(){for(var i,r=this.owner.getStyleNames("Paragraph"),n=0,t=["Normal","Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6"].filter(function(n){return-1===r.indexOf(n)});n<t.length;n++)i=t[n],this.createStyle(this.documentHelper.preDefinedStyles.get(i))},n.prototype.createStyle=function(n){this.createStyleIn(n)},n.prototype.createStyleIn=function(n){var t=JSON.parse(n);return void 0!==this.documentHelper.styles.findByName(t.name)&&(t.name=this.getUniqueStyleName(t.name)),this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),t,this.documentHelper.styles),this.documentHelper.styles.findByName(t.name)},n.prototype.getUniqueStyleName=function(n){for(var t=this.getUniqueName(n),i=this.documentHelper.styles.findByName(t);!sf.base.isNullOrUndefined(i);)t=this.getUniqueStyleName(i.name),i=this.documentHelper.styles.findByName(t);return t},n.prototype.getUniqueName=function(n){var t=n.match(/\d+$/);return!sf.base.isNullOrUndefined(t)&&t.length>0?n.replace(t[0],(parseInt(t[0],10)+1).toString()):n+"_1"},n.prototype.updateSelectionCharacterFormatting=function(n,t,i){switch(sf.base.isNullOrUndefined(n)&&(n="CharacterFormat"),n){case"bold":this.updateCharacterFormat("bold",t);break;case"italic":this.updateCharacterFormat("italic",t);break;case"fontColor":this.updateCharacterFormat("fontColor",t);break;case"fontFamily":this.updateCharacterFormat("fontFamily",t);break;case"fontSize":this.documentHelper.layout.isBidiReLayout=!1;this.updateCharacterFormatWithUpdate(this.documentHelper.selection,"fontSize",t,i);break;case"highlightColor":this.updateCharacterFormat("highlightColor",t);break;case"baselineAlignment":this.updateCharacterFormat("baselineAlignment",t);break;case"strikethrough":this.updateCharacterFormat("strikethrough",t);break;case"underline":this.updateCharacterFormat("underline",t);break;case"styleName":this.updateCharacterFormatWithUpdate(this.documentHelper.selection,"styleName",t,!0);break;case"CharacterFormat":case"ClearCharacterFormat":this.updateCharacterFormat(void 0,t);break;case"allCaps":this.updateCharacterFormat("allCaps",t)}this.reLayout(this.documentHelper.selection)},n.prototype.updateCharacterFormat=function(n,t){this.updateCharacterFormatWithUpdate(this.documentHelper.selection,n,t,!1)},n.prototype.updateCharacterFormatWithUpdate=function(n,t,i,r){this.documentHelper.owner.isShiftingEnabled=!0;var u=n.start,f=n.end;n.isForward||(u=n.end,f=n.start);this.applyCharFormatSelectedContent(u.paragraph,n,u,f,t,i,r)},n.prototype.applyCharFormatSelectedContent=function(n,t,i,r,u,f,e){var s,o;i.paragraph.isInsideTable&&(!r.paragraph.isInsideTable||i.paragraph.associatedCell!==r.paragraph.associatedCell||t.isCellSelected(i.paragraph.associatedCell,i,r))?(i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),s=i.paragraph.associatedCell,this.applyCharFormatCell(s,t,i,r,u,f,e),o=s.ownerTable,this.documentHelper.layout.layoutBodyWidgetCollection(o.index,o.containerWidget,o,!1)):this.applyCharFormat(n,t,i,r,u,f,e)},n.prototype.applyCharFormatForSelectedPara=function(n,t,i,r,u){for(var o,e,s,f=0;f<n.childWidgets.length;f++)for(o=n.childWidgets[f],e=0;e<o.children.length;e++)s=o.children[e],this.applyCharFormatValue(s.characterFormat,i,r,u);this.applyCharFormatValue(n.characterFormat,i,r,u)},n.prototype.splittedLastParagraph=function(n){var t=n.getSplitWidgets();return t[t.length-1]},n.prototype.getNextParagraphForCharacterFormatting=function(n,t,i,r,f,e){var o=n.getSplitWidgets();n=o[o.length-1];n=this.documentHelper.selection.getNextRenderedBlock(n);sf.base.isNullOrUndefined(n)||(_instanceof(n,u)?this.applyCharFormat(n,this.documentHelper.selection,t,i,r,f,e):this.applyCharFormatForTable(0,n,this.documentHelper.selection,t,i,r,f,e))},n.prototype.applyCharFormat=function(n,t,r,u,f,e,s){var a,b,c,h,rt,it,g,ut,ot;n=n.combineWidget(this.owner.viewer);var y=0,st=t.getParagraphLength(n),p=-1!==n.childWidgets.indexOf(r.currentWidget)?n.childWidgets.indexOf(r.currentWidget):0,w=u.offset,ht=-1!==n.childWidgets.indexOf(u.currentWidget)?n.childWidgets.indexOf(u.currentWidget):n.childWidgets.length-1;for((sf.base.isNullOrUndefined(t)||n===r.paragraph&&(y=r.offset),n.equals(u.paragraph))?(a=n.childWidgets[n.childWidgets.length-1],t.isParagraphLastLine(a)&&u.currentWidget===a&&(w===t.getLineLength(a)+1||t.isEmpty&&t.end.isAtParagraphEnd)&&this.applyCharFormatValue(n.characterFormat,f,e,s)):(a=n.childWidgets[n.childWidgets.length-1],"highlightColor"===f&&t.isParagraphLastLine(a)&&r.currentWidget===a&&r.offset===t.getLineLength(a)||this.applyCharFormatValue(n.characterFormat,f,e,s),w=st),b=p;b<=ht;b++){c=n.childWidgets[b];b!==p&&(y=t.getStartLineOffset(c));w=c===u.currentWidget?u.offset:t.getLineLength(c);for(var v=0,k=c.paragraph.paragraphFormat.bidi,ft=this.documentHelper.layout.isContainsRtl(c),et=!0,d=void 0,nt=-1,tt=!0,l=k?c.children.length-1:0;k?l>=0:l<c.children.length;k?l--:tt?l++:l--){if(h=c.children[l],!k&&ft)for(;(et||sf.base.isNullOrUndefined(d))&&_instanceof(h,i)&&(this.documentHelper.textHelper.isRTLText(h.text)||this.documentHelper.textHelper.containsSpecialCharAlone(h.text))&&h.nextElement;)d||(d=h),-1===nt&&(nt=c.children.indexOf(h)),l=h.line.children.indexOf(h),h=h.nextElement,tt=!1;if(et=!1,!_instanceof(h,o))if(d===h&&(d=void 0,l=nt,nt=-1,tt=!0),y>=v+h.length)v+=h.length;else{if(rt=0,y>v&&(rt=y-v),it=w-v,g=h.length,it>g&&(it=g),ut=this.applyCharFormatInline(h,t,rt,it,f,e,s),k||ft&&!tt?l-=ut:l+=ut,w<=v+g)break;v+=g}}}ot=u.paragraph;!n.bidi&&this.documentHelper.layout.isContainsRtl(n.childWidgets[p])?this.documentHelper.layout.reLayoutParagraph(n,p,0,!1,!0):this.documentHelper.layout.reLayoutParagraph(n,p,0);n.equals(ot)||this.getNextParagraphForCharacterFormatting(n,r,u,f,e,s)},n.prototype.toggleBold=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode()){var n=this.getCurrentSelectionValue("bold");this.selection.characterFormat.bold=n}},n.prototype.toggleItalic=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode()){var n=this.getCurrentSelectionValue("italic");this.selection.characterFormat.italic=n}},n.prototype.changeCase=function(n){if(!this.selection.isEmpty&&(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())){this.initHistory("Uppercase");this.documentHelper.owner.isShiftingEnabled=!0;var t=this.selection,i=t.start,r=t.end;t.isForward||(i=t.end,r=t.start);this.changeSelectedTextCase(t,i,r,n);this.reLayout(t)}},n.prototype.changeSelectedTextCase=function(n,t,i,r,u){var o=this.selection.getParagraphInfo(t),f,e;n.editPosition=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(n)&&this.updateHistoryPosition(t,!0);f=this.editorHistory.isUndoing;f&&!sf.base.isNullOrUndefined(u)&&u.length>0&&(this.removedTextNodes=u);e=i.selection.endOffset;this.changeTextCase(t.paragraph,n,t,i,r,f);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(i.selection.endOffset!==e&&(i=n.getTextPosBasedOnLogicalIndex(e)),this.checkEndPosition(n)&&this.updateHistoryPosition(i,!1),n.selectPosition(t,i))},n.prototype.changeTextCase=function(n,t,i,r,u,f){var o,e;i.paragraph.isInsideTable&&(!r.paragraph.isInsideTable||i.paragraph.associatedCell!==r.paragraph.associatedCell||t.isCellSelected(i.paragraph.associatedCell,i,r))?(i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),o=i.paragraph.associatedCell,this.changeCaseParaFormatInCell(o,i,r,u,f),e=o.ownerTable,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1)):this.changeCaseParagraph(n,t,i,r,u,f)},n.prototype.changeCaseParagraph=function(n,t,r,u,f,e){var y,h,s,tt,nt,b,it,ft;n=n.combineWidget(this.owner.viewer);var a=0,et=t.getParagraphLength(n),v=-1!==n.childWidgets.indexOf(r.currentWidget)?n.childWidgets.indexOf(r.currentWidget):0,k=u.offset,ot=-1!==n.childWidgets.indexOf(u.currentWidget)?n.childWidgets.indexOf(u.currentWidget):n.childWidgets.length-1;for(sf.base.isNullOrUndefined(t)||n===r.paragraph&&(a=r.offset),n.equals(u.paragraph)||(k=et),y=v;y<=ot;y++){h=n.childWidgets[y];y!==v&&(a=t.getStartLineOffset(h));k=h===u.currentWidget?u.offset:t.getLineLength(h);for(var l=0,p=h.paragraph.paragraphFormat.bidi,rt=this.documentHelper.layout.isContainsRtl(h),ut=!0,w=void 0,d=-1,g=!0,c=p?h.children.length-1:0;p?c>=0:c<h.children.length;p?c--:g?c++:c--){if(s=h.children[c],!p&&rt)for(;(ut||sf.base.isNullOrUndefined(w))&&_instanceof(s,i)&&(this.documentHelper.textHelper.isRTLText(s.text)||this.documentHelper.textHelper.containsSpecialCharAlone(s.text))&&s.nextElement;)w||(w=s),-1===d&&(d=h.children.indexOf(s)),c=s.line.children.indexOf(s),s=s.nextElement,g=!1;if(ut=!1,!_instanceof(s,o))if(w===s&&(w=void 0,c=d,d=-1,g=!0),a>=l+s.length)l+=s.length;else{if(tt=0,a>l&&(tt=a-l),nt=k-l,b=s.length,nt>b&&(nt=b),it=this.changeCaseInline(s,t,tt,nt,f,e),p||rt&&!g?c-=it:c+=it,k<=l+b)break;l+=b}}}ft=u.paragraph;!n.bidi&&this.documentHelper.layout.isContainsRtl(n.childWidgets[v])?this.documentHelper.layout.reLayoutParagraph(n,v,0,!1,!0):this.documentHelper.layout.reLayoutParagraph(n,v,0);n.equals(ft)||this.changeCaseNextBlock(n,r,u,f,e)},n.prototype.changeCaseInline=function(n,t,r,u,f,e){if(_instanceof(n,i)){if(0!==r||u!==n.length)return this.changeCaseInlineInternal(n,t,r,u,f,e);this.changeCaseInlineInternal(n,t,r,u,f,e)}return 0},n.prototype.addRemovedTextNodes=function(n,t){if(_instanceof(n,i)&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)){var r=this.editorHistory.currentBaseHistoryInfo.removedNodes[0];sf.base.isNullOrUndefined(r)&&((r=new i).text="",this.editorHistory.currentBaseHistoryInfo.removedNodes.push(r));r.text+=t}},n.prototype.changeCaseInlineInternal=function(n,t,r,u,f,e){var o,c=0,h=n.line.children.indexOf(n),l=n.paragraph,a,s,v,y;return l.childWidgets.indexOf(n.line),r>0&&(a=n.text.substr(r,u-r),this.addRemovedTextNodes(n,a),(o=new i).characterFormat.copyFormat(n.characterFormat),o.line=n.line,o.text=this.getChangeCaseText(a,f,e),o.isRightToLeft=n.isRightToLeft,l.paragraphFormat.bidi||this.documentHelper.layout.isContainsRtl(n.line)||h++,n.line.children.splice(h,0,o),c++),u<n.length&&((o=new i).characterFormat.copyFormat(n.characterFormat),o.text=n.text.substring(u),o.line=n.line,o.isRightToLeft=n.isRightToLeft,l.paragraphFormat.bidi||this.documentHelper.layout.isContainsRtl(n.line)||h++,n.line.children.splice(h,0,o),c++),s=n,0===r?(v=s.text.substr(0,u),this.addRemovedTextNodes(n,v),s.text=this.getChangeCaseText(v,f,e)):(y=s.text.substr(0,r),s.text=y),c},n.prototype.changeCaseNextBlock=function(n,t,i,r,f){n=this.getNextBlockForChangeCase(n,t,i,r,f);sf.base.isNullOrUndefined(n)||(_instanceof(n,u)?this.changeCaseParagraph(n,this.documentHelper.selection,t,i,r,f):this.changeCaseForTable(0,n,this.documentHelper.selection,t,i,r,f))},n.prototype.getNextBlockForChangeCase=function(n){var t=n.getSplitWidgets();return n=t[t.length-1],n=this.documentHelper.selection.getNextRenderedBlock(n)},n.prototype.getChangeCaseText=function(n,t,i){if(i){if(!sf.base.isNullOrUndefined(this.removedTextNodes)&&this.removedTextNodes.length>0){var r=this.removedTextNodes[0],u=r.text.substr(0,n.length);r.text=r.text.substr(u.length,r.length-u.length);n=u;""===r.text&&this.removedTextNodes.splice(0,1)}}else switch(t){case"Uppercase":n=n.toUpperCase()}return n},n.prototype.changeCaseForTable=function(n,t,i,r,u,f,e){var o,s,h;for(t=t.combineWidget(this.owner.viewer),o=n;o<t.childWidgets.length;o++){for(s=t.childWidgets[o],h=0;h<s.childWidgets.length;h++)this.changeCaseForSelectedCell(s.childWidgets[h],i,f,e);if(u.paragraph.isInsideTable&&i.containsRow(s,u.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1);this.changeCaseNextBlock(t,r,u,f,e)},n.prototype.changeCaseForSelectedCell=function(n,t,i,r){for(var e,f=0;f<n.childWidgets.length;f++)e=n.childWidgets[f],_instanceof(e,u)?this.changeCaseForSelectedPara(e,t,i,r):this.changeCaseForSelTable(e,t,i,r)},n.prototype.changeCaseForSelectedPara=function(n,t,r,u){for(var s,o,f,e=0;e<n.childWidgets.length;e++)for(s=n.childWidgets[e],o=0;o<s.children.length;o++)f=s.children[o],!sf.base.isNullOrUndefined(f)&&_instanceof(f,i)&&(this.addRemovedTextNodes(f,f.text),f.text=this.getChangeCaseText(f.text,r,u))},n.prototype.changeCaseForSelTable=function(n,t,i,r){for(var e,f,u=0;u<n.childWidgets.length;u++)for(e=n.childWidgets[u],f=0;f<e.childWidgets.length;f++)this.changeCaseForSelectedCell(e.childWidgets[f],t,i,r)},n.prototype.changeCaseParaFormatInCell=function(n,t,i,r,u){var f=this.documentHelper.selection,e,o,s,h;i.paragraph.isInsideTable?(e=f.getContainerCellOf(n,i.paragraph.associatedCell),e.ownerTable.contains(i.paragraph.associatedCell)?(o=f.getSelectedCell(n,e),s=f.getSelectedCell(i.paragraph.associatedCell,e),f.containsCell(e,i.paragraph.associatedCell)?f.isCellSelected(e,t,i)?this.changeCaseParaForCellInternal(e,f,r,u):o===e?this.changeCaseParagraph(t.paragraph,f,t,i,r,u):this.changeCaseParaForRow(o.ownerRow,f,t,i,r,u):this.changeCaseParaForTableCell(e.ownerTable,e,s,r,u)):this.changeCaseParaForRow(e.ownerRow,f,t,i,r,u)):(h=f.getContainerCell(n),this.changeCaseParaForRow(h.ownerRow,f,t,i,r,u))},n.prototype.changeCaseParaForTableCell=function(n,t,i,r,u){var o=this.documentHelper.selection,s=o.getCellLeft(t.ownerRow,t),c=s+t.cellFormat.cellWidth,a=o.getCellLeft(i.ownerRow,i),p=a+i.cellFormat.cellWidth,v=this.updateSelectedCellsInTable(s,c,a,p),y,h,f,e,l;for(s=v.start,c=v.end,y=n.childWidgets.indexOf(i.ownerRow),h=n.childWidgets.indexOf(t.ownerRow);h<=y;h++)for(f=n.childWidgets[h],e=0;e<f.childWidgets.length;e++)l=o.getCellLeft(f,f.childWidgets[e]),Math.round(s)<=Math.round(l)&&Math.round(l)<Math.round(c)&&this.changeCaseParaForCellInternal(f.childWidgets[e],o,r,u)},n.prototype.changeCaseParaForCellInternal=function(n,t,i,r){for(var e,f=0;f<n.childWidgets.length;f++)e=n.childWidgets[f],_instanceof(e,u)?this.changeCaseForSelectedPara(e,t,i,r):this.changeCaseParaFormatTableInternal(e,t,i,r)},n.prototype.changeCaseParaFormatTableInternal=function(n,t,i,r){for(var e,f,u=0;u<n.childWidgets.length;u++)for(e=n.childWidgets[u],f=0;f<e.childWidgets.length;f++)this.changeCaseParaForCellInternal(e.childWidgets[f],t,i,r)},n.prototype.changeCaseParaForRow=function(n,t,i,r,u,f){for(var o,s,e=n.rowIndex;e<n.ownerTable.childWidgets.length;e++){for(o=n.ownerTable.childWidgets[e],s=0;s<o.childWidgets.length;s++)this.changeCaseParaForCellInternal(o.childWidgets[s],t,u,f);if(r.paragraph.isInsideTable&&this.documentHelper.selection.containsRow(o,r.paragraph.associatedCell))return}this.changeCaseNextBlock(n.ownerTable,i,r,u,f)},n.prototype.toggleAllCaps=function(){if(!this.documentHelper.owner.isReadOnlyMode||this.selection.isInlineFormFillMode()){var n=this.getCurrentSelectionValue("allCaps");this.selection.characterFormat.allCaps=n}},n.prototype.getCurrentSelectionValue=function(n){var t=!1,i;return("bold"===n||"italic"===n)&&(i=this.getSelectedCharacterFormat(),"bold"===n&&(t=!i.bold),"italic"===n&&(t=!i.italic)),t},n.prototype.getSelectedCharacterFormat=function(){var i=0,r=this.selection.start,t,f;this.selection.isForward||(r=this.selection.end);var u=r.currentWidget,e=u.getInline(r.offset,i),n=e.element;return i=e.index,t=u.paragraph.characterFormat,sf.base.isNullOrUndefined(n)||(this.selection.isEmpty&&"List"===this.selection.contextType?(f=this.selection.getListLevel(this.selection.start.paragraph),f.characterFormat.uniqueCharacterFormat&&(t=f.characterFormat)):t=this.selection.isEmpty||i!==n.length?n.characterFormat:sf.base.isNullOrUndefined(n.nextNode)?u.paragraph.characterFormat:n.nextNode.characterFormat),t},n.prototype.toggleUnderline=function(n){(this.owner.isReadOnlyMode||this.restrictFormatting)&&!this.selection.isInlineFormFillMode()||this.updateProperty(1,n)},n.prototype.toggleStrikethrough=function(n){if(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode()){var t=void 0;t=sf.base.isNullOrUndefined(n)?"SingleStrike"===this.selection.characterFormat.strikethrough?"None":"SingleStrike":n;this.selection.characterFormat.strikethrough=t}},n.prototype.updateFontSize=function(n,t){var r,i;if("number"==typeof t&&!(t<0&&1===n.fontSize))return n.fontSize+t;if(r=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72],"string"==typeof t&&"increment"===t){if(n.fontSize<8)return n.fontSize+1;if(n.fontSize>=72&&n.fontSize<80)return 80;if(n.fontSize>=80)return n.fontSize+10;for(i=0;i<r.length;i++)if(n.fontSize<r[i])return r[i]}else if("string"==typeof t&&"decrement"===t&&n.fontSize>1){if(n.fontSize<=8)return n.fontSize-1;if(n.fontSize>72&&n.fontSize<=80)return 72;if(n.fontSize>80)return n.fontSize-10;for(i=0;i<r.length;i++)if(n.fontSize<=r[i])return r[i-1]}return n.fontSize},n.prototype.applyCharFormatInline=function(n,t,r,u,f,e,o){return 0===r&&u===n.length?(this.applyCharFormatValue(n.characterFormat,f,e,o),0):_instanceof(n,i)?this.formatInline(n,t,r,u,f,e,o):0},n.prototype.formatInline=function(n,t,r,u,f,e,o){var s,l=0,h=n,c=n.line.children.indexOf(h),a=n.paragraph;return a.childWidgets.indexOf(n.line),r>0&&((s=new i).characterFormat.copyFormat(n.characterFormat),s.line=n.line,s.text=n.text.substr(r,u-r),s.isRightToLeft=n.isRightToLeft,this.applyCharFormatValue(s.characterFormat,f,e,o),a.paragraphFormat.bidi||this.documentHelper.layout.isContainsRtl(n.line)||c++,h.line.children.splice(c,0,s),l++),u<h.length&&((s=new i).characterFormat.copyFormat(n.characterFormat),s.text=h.text.substring(u),s.line=n.line,s.isRightToLeft=n.isRightToLeft,a.paragraphFormat.bidi||this.documentHelper.layout.isContainsRtl(n.line)||c++,h.line.children.splice(c,0,s),l++),0===r?(n.text=n.text.substr(0,u),this.applyCharFormatValue(n.characterFormat,f,e,o)):n.text=n.text.substr(0,r),l},n.prototype.applyCharFormatCell=function(n,t,i,r,u,f,e){var o,s,h,c;r.paragraph.isInsideTable?(o=t.getContainerCellOf(n,r.paragraph.associatedCell),o.ownerTable.contains(r.paragraph.associatedCell)?(s=t.getSelectedCell(n,o),h=t.getSelectedCell(r.paragraph.associatedCell,o),t.containsCell(o,r.paragraph.associatedCell)?t.isCellSelected(o,i,r)?(f=this.getCharacterFormatValueOfCell(n,t,f,u),this.applyCharFormatForSelectedCell(o,t,u,f,e)):s===o?this.applyCharFormat(i.paragraph,t,i,r,u,f,e):this.applyCharFormatRow(s.ownerRow,t,i,r,u,f,e):this.applyCharFormatForTableCell(o.ownerTable,t,o,h,u,f,e)):this.applyCharFormatRow(o.ownerRow,t,i,r,u,f,e)):(c=t.getContainerCell(n),this.applyCharFormatRow(c.ownerRow,t,i,r,u,f,e))},n.prototype.applyCharFormatForSelectedCell=function(n,t,i,r,f){for(var o,e=0;e<n.childWidgets.length;e++)o=n.childWidgets[e],_instanceof(o,u)?this.applyCharFormatForSelectedPara(o,t,i,r,f):this.applyCharFormatForSelTable(o,t,i,r,f)},n.prototype.applyCharFormatRow=function(n,t,i,r,u,f,e){f=this.getCharacterFormatValueOfCell(n.childWidgets[0],t,f,u);this.applyCharFormatForTable(n.rowIndex,n.ownerTable,t,i,r,u,f,e)},n.prototype.applyCharFormatForTable=function(n,t,i,r,u,f,e,o){var s,h,c;for(t=t.combineWidget(this.owner.viewer),s=n;s<t.childWidgets.length;s++){for(h=t.childWidgets[s],c=0;c<h.childWidgets.length;c++)this.applyCharFormatForSelectedCell(h.childWidgets[c],i,f,e,o);if(u.paragraph.isInsideTable&&i.containsRow(h,u.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1);this.getNextParagraphForCharacterFormatting(t,r,u,f,e,o)},n.prototype.applyCharFormatForSelTable=function(n,t,i,r,u){for(var o,e,f=0;f<n.childWidgets.length;f++)for(o=n.childWidgets[f],e=0;e<o.childWidgets.length;e++)this.applyCharFormatForSelectedCell(o.childWidgets[e],t,i,r,u)},n.prototype.applyCharFormatForTableCell=function(n,i,r,u,f,e,o){var c=i.getCellLeft(r.ownerRow,r),l=c+r.cellFormat.cellWidth,y=i.getCellLeft(u.ownerRow,u),b=y+u.cellFormat.cellWidth,p=this.updateSelectedCellsInTable(c,l,y,b),s,h,v;c=p.start;l=p.end;for(var k=n.childWidgets.indexOf(u.ownerRow),w=!1,a=n.childWidgets.indexOf(r.ownerRow);a<=k;a++)for(s=n.childWidgets[a],h=0;h<s.childWidgets.length;h++)v=i.getCellLeft(s,s.childWidgets[h]),t.round(c,2)<=t.round(v,2)&&t.round(v,2)<t.round(l,2)&&(w||(e=this.getCharacterFormatValueOfCell(s.childWidgets[h],i,e,f),w=!0),this.applyCharFormatForSelectedCell(s.childWidgets[h],i,f,e,o))},n.prototype.updateSelectedCellsInTable=function(n,t,i,r){var u=this.documentHelper.selection;return n>i&&(n=i),t<r&&(t=r),n>u.upDownSelectionLength&&(n=u.upDownSelectionLength),t<u.upDownSelectionLength&&(t=u.upDownSelectionLength),{start:n,end:t}},n.prototype.getCharacterFormatValueOfCell=function(n,t,i,r){if("boolean"==typeof i||void 0===i&&("bold"===r||"italic"===r)){var u=t.getFirstParagraph(n),f=u.characterFormat;u.childWidgets.length>0&&u.childWidgets[0].children.length>0&&(f=u.childWidgets[0].children[0].characterFormat);i=!f.getPropertyValue(r)}return i},n.prototype.applyCharFormatValueInternal=function(n,t,i,r){this.applyCharFormatValue(t,i,r,!1)},n.prototype.copyInlineCharacterFormat=function(n,t){t.uniqueCharacterFormat=n.uniqueCharacterFormat;t.baseCharStyle=n.baseCharStyle},n.prototype.applyCharFormatValue=function(n,t,r,u){var e,f,o,h,s;if(u&&"fontSize"===t&&(r=this.updateFontSize(n,r)),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(r=this.editorHistory.currentBaseHistoryInfo.addModifiedProperties(n,t,r)),_instanceof(r,p))this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)?this.copyInlineCharacterFormat(r,n):n.copyFormat(r);else{if(this.isForHyperlinkFormat&&this.owner.enableTrackChanges&&_instanceof(n.ownerBase,tt)){for(e=n.ownerBase,f=e.previousNode,sf.base.isNullOrUndefined(f)&&(o=e.paragraph.previousWidget,sf.base.isNullOrUndefined(o)||o.isEmpty()||(h=o.lastChild,f=h.children[h.children.length-1]));!(sf.base.isNullOrUndefined(f)||_instanceof(f,i));)f=f.previousNode;!sf.base.isNullOrUndefined(f)&&f.revisions.length>0?(s=f.revisions[f.revisions.length-1],this.isRevisionAlreadyIn(e,s)||(e.revisions.push(s),s.range.push(e))):this.insertRevision(e,"Insertion")}sf.base.isNullOrUndefined(r)?n.clearFormat():"bold"===t?n.bold=r:"italic"===t?n.italic=r:"fontColor"===t?n.fontColor=r:"fontFamily"===t?n.fontFamily=r:"fontSize"===t?n.fontSize=r:"highlightColor"===t?n.highlightColor=r:"baselineAlignment"===t?n.baselineAlignment=r:"strikethrough"===t?n.strikethrough=r:"underline"===t?n.underline=r:"styleName"===t?n.baseCharStyle=r:"allCaps"===t&&(n.allCaps=r)}},n.prototype.onImageFormat=function(n,t,i){var r=new wr(n);this.editorHistory&&(this.editorHistory.initializeHistory("ImageResizing"),this.editorHistory.currentBaseHistoryInfo.modifiedProperties.push(r));this.setOffsetValue(this.selection);n.width=t;n.height=i;this.documentHelper.layout.reLayoutParagraph(n.line.paragraph,n.line.indexInOwner,0);this.reLayout(this.selection,!1);this.documentHelper.owner.imageResizerModule&&this.documentHelper.owner.imageResizerModule.positionImageResizer(n)},n.prototype.toggleTextAlignment=function(n){(!this.documentHelper.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.documentHelper.owner.isDocumentLoaded&&(sf.base.isNullOrUndefined(this.documentHelper.selection.paragraphFormat.textAlignment)||this.documentHelper.selection.paragraphFormat.textAlignment!==n?this.onApplyParagraphFormat("textAlignment",n,!1,!0):"Left"===n?this.onApplyParagraphFormat("textAlignment","Justify",!1,!0):this.onApplyParagraphFormat("textAlignment","Left",!1,!0))},n.prototype.setPreviousBlockToLayout=function(){var r=this.documentHelper.selection.start,t,n,i;this.documentHelper.selection.isForward||(r=this.documentHelper.selection.end);t=r.paragraph;t.paragraphFormat.keepWithNext&&(n=t.bodyWidget,!sf.base.isNullOrUndefined(n)&&_instanceof(n,c)&&n.page&&(i=n.page.previousPage,i&&(this.previousBlockToLayout=i.bodyWidgets[0].lastChild)))},n.prototype.onApplyParagraphFormat=function(n,t,i){var h=this.documentHelper.isFormFillProtectedMode&&this.documentHelper.selection.isInlineFormFillMode()&&this.allowFormattingInFormFields(n),e,r,o;if((!this.restrictFormatting||h)&&(this.setPreviousBlockToLayout(),e="bidi"===n?"ParagraphBidi":n[0].toUpperCase()+n.slice(1),this.documentHelper.owner.isShiftingEnabled=!0,r=this.documentHelper.selection,this.initHistory(e),(!this.owner.isReadOnlyMode||h)&&this.owner.isDocumentLoaded))if("leftIndent"===n&&-1!==r.paragraphFormat.listId&&i)this.updateListLevel(t>0);else{if(r.isEmpty){this.setOffsetValue(r);o=r.paragraphFormat.bidi&&("listFormat"===n||-1!==r.paragraphFormat.listId);o||(this.documentHelper.layout.isBidiReLayout=!0);i&&"leftIndent"===n&&(t=this.getIndentIncrementValue(r.start.paragraph,t));var u=r.start.paragraph,s=this.documentHelper.layout,f=s.getFootNodeWidgetsToShiftToPage(u);u=u.combineWidget(this.owner.viewer);this.applyParaFormatProperty(u,n,t,i);this.layoutItemBlock(u,!1);f.footNoteWidgets.length>0&&(s.moveFootNotesToPage(f.footNoteWidgets,f.fromBodyWidget,f.toBodyWidget),s.layoutfootNote(f.toBodyWidget.page.footnoteWidget));o||(this.documentHelper.layout.isBidiReLayout=!1)}else"ParagraphBidi"!==e&&this.setOffsetValue(r),this.updateSelectionParagraphFormatting(n,t,i);this.reLayout(r)}},n.prototype.updateListLevel=function(n){var r,t=this.documentHelper,i=(this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat,this.documentHelper.selection.start.paragraph.paragraphFormat),u=t.getListById(i.listFormat.listId),f;t.layout.getListLevel(u,i.listFormat.listLevelNumber);r=n?i.listFormat.listLevelNumber+1:i.listFormat.listLevelNumber-1;f=t.layout.getListLevel(u,r);sf.base.isNullOrUndefined(f)||(this.onApplyListInternal(u,r),t.selection.start.updatePhysicalPosition(!0),t.selection.end.updatePhysicalPosition(!0),t.selection.updateCaretPosition())},n.prototype.onApplyListInternal=function(n,t){var i=new ai;!sf.base.isNullOrUndefined(n)&&t>=0&&t<9&&(i.listId=n.listId,i.listLevelNumber=t);this.onApplyParagraphFormat("listFormat",i,!1,!1)},n.prototype.updateSelectionParagraphFormatting=function(n,t,i){var r=this.documentHelper.selection;"leftIndent"===n&&i&&(t=!sf.base.isNullOrUndefined(r.start)&&r.start.isExistBefore(r.end)?this.getIndentIncrementValue(r.start.paragraph,t):this.getIndentIncrementValue(r.end.paragraph,t));this.updateParagraphFormatInternal(n,t,i)},n.prototype.getIndentIncrementValue=function(n,t){var i=n.paragraphFormat.leftIndent,r;return i<0?t<0||i+t>=0?-i:(r=-this.getIndentIncrementValueInternal(-i,-t),r%t==0?r:r+t):this.getIndentIncrementValueInternal(i,t)},n.prototype.getIndentIncrementValueInternal=function(n,t){var i=Math.abs(t),u,r;return 0===n||0===i?t>0?i:0:(u=100*Math.round(n)%(100*Math.round(i))/100,r=(Math.round(n)-u)/Math.round(i)*i,t>0&&(r+=i),r-n==0?t:r-n)},n.prototype.updateParagraphFormatInternal=function(n,t,i){switch(sf.base.isNullOrUndefined(n)&&(n="ParagraphFormat"),n){case"afterSpacing":this.updateParagraphFormat("afterSpacing",t,!1);break;case"beforeSpacing":this.updateParagraphFormat("beforeSpacing",t,!1);break;case"rightIndent":this.updateParagraphFormat("rightIndent",t,!1);break;case"leftIndent":this.updateParagraphFormat("leftIndent",t,i);break;case"firstLineIndent":this.updateParagraphFormat("firstLineIndent",t,!1);break;case"lineSpacing":this.updateParagraphFormat("lineSpacing",t,!1);break;case"lineSpacingType":this.updateParagraphFormat("lineSpacingType",t,!1);break;case"textAlignment":this.updateParagraphFormat("textAlignment",t,!1);break;case"listFormat":this.updateParagraphFormat("listFormat",t,!1);break;case"ParagraphFormat":this.updateParagraphFormat(void 0,t,!1);break;case"styleName":this.updateParagraphFormat("styleName",t,!1);break;case"ClearParagraphFormat":this.updateParagraphFormat(void 0,t,!1);break;case"bidi":var r=-1!==this.selection.paragraphFormat.listId;r||(this.documentHelper.layout.isBidiReLayout=!0);this.updateParagraphFormat("bidi",t,!1);r||(this.documentHelper.layout.isBidiReLayout=!1);break;case"contextualSpacing":this.updateParagraphFormat("contextualSpacing",t,!1)}},n.prototype.updateParagraphFormat=function(n,t,i){var r=this.documentHelper.selection,u=r.start,f=r.end;r.isForward||(u=r.end,f=r.start);this.applyParaFormatSelectedContent(u,f,n,t,i)},n.prototype.applyParaFormatSelectedContent=function(n,t,i,r,u){var o=this.documentHelper.selection,e,f;if(n.paragraph.isInsideTable&&(!t.paragraph.isInsideTable||n.paragraph.associatedCell!==t.paragraph.associatedCell||o.isCellSelected(n.paragraph.associatedCell,n,t)))n.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(o)&&this.updateHistoryPosition(n,!0),e=n.paragraph.associatedCell,this.applyParaFormatInCell(e,n,t,i,r,u),f=e.ownerTable,this.documentHelper.layout.layoutBodyWidgetCollection(f.index,f.containerWidget,f,!1);else{if(!sf.base.isNullOrUndefined(r)&&!this.selection.isEmpty&&"styleName"===i&&this.applyCharacterStyle(n.paragraph,n,t,i,r,u))return;this.applyParaFormat(n.paragraph,n,t,i,r,u)}},n.prototype.applyParaFormatProperty=function(n,t,i,r){var u=n.paragraphFormat,f;if((r&&"leftIndent"===t&&(i=u.leftIndent+i),"listFormat"===t&&_instanceof(i,ai))&&(f=i,f.hasValue("listLevelNumber")||(f.listLevelNumber=u.listFormat.listLevelNumber)),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(i=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForParagraphFormat(u,t,i)),_instanceof(i,ut)&&(sf.base.isNullOrUndefined(t)?this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)?this.copyParagraphFormat(i,u):u.copyFormat(i):"listFormat"===t&&(u.listFormat=i.listFormat)),sf.base.isNullOrUndefined(i))return u.clearFormat(),void this.documentHelper.layout.reLayoutParagraph(u.ownerBase,0,0);if("afterSpacing"===t)u.afterSpacing=i;else if("beforeSpacing"===t)u.beforeSpacing=i;else if("leftIndent"===t)u.leftIndent=i;else if("lineSpacingType"===t)u.lineSpacingType=i;else if("lineSpacing"===t)u.lineSpacing=i;else if("rightIndent"===t)u.rightIndent=i;else if("firstLineIndent"===t)u.firstLineIndent=i;else if("textAlignment"===t)u.textAlignment=i,this.documentHelper.layout.allowLayout=!1;else if("styleName"===t)"string"==typeof i&&(i=this.documentHelper.styles.findByName(i)),u.applyStyle(i);else{if("listFormat"===t)return _instanceof(i,ut)&&(this.copyFromListLevelParagraphFormat(u,i),i=i.listFormat),u.listFormat.copyFormat(i),this.documentHelper.layout.clearListElementBox(u.ownerBase),this.onListFormatChange(u.ownerBase,i,u),void this.layoutItemBlock(u.ownerBase,!1);"bidi"===t?u.bidi=i:"keepWithNext"===t?u.keepWithNext=i:"keepLinesTogether"===t?u.keepLinesTogether=i:"widowControl"===t?u.widowControl=i:"contextualSpacing"===t&&(u.contextualSpacing=i)}},n.prototype.copyParagraphFormat=function(n,t){t.uniqueParagraphFormat=n.uniqueParagraphFormat;t.listFormat=n.listFormat;t.baseStyle=n.baseStyle},n.prototype.onListFormatChange=function(n,t){_instanceof(t,ai)&&this.updateListParagraphFormat(n,t)},n.prototype.updateListParagraphFormat=function(n,t){var r=this.documentHelper.getListById(t.listId),i=void 0;sf.base.isNullOrUndefined(r)||(i=this.documentHelper.layout.getListLevel(r,t.listLevelNumber));this.editorHistory&&(!this.editorHistory||this.editorHistory.isUndoing)||(_instanceof(n,u)&&!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.paragraphFormat)&&!sf.base.isNullOrUndefined(n.containerWidget)?this.copyFromListLevelParagraphFormat(n.paragraphFormat,i.paragraphFormat):sf.base.isNullOrUndefined(r)&&(n.paragraphFormat.leftIndent=void 0,n.paragraphFormat.firstLineIndent=void 0))},n.prototype.copyFromListLevelParagraphFormat=function(n,t){sf.base.isNullOrUndefined(t.leftIndent)||(n.leftIndent=t.leftIndent);sf.base.isNullOrUndefined(t.firstLineIndent)||(n.firstLineIndent=t.firstLineIndent)},n.prototype.applyContinueNumbering=function(){var n=this.selection;this.editorHistory&&this.editorHistory.initializeHistory("ContinueNumbering");this.applyContinueNumberingInternal(n)},n.prototype.applyContinueNumberingInternal=function(n){var i=n.start.paragraph,t=this.getContinueNumberingInfo(i),r=this.getParagraphFormat(i,t.listLevelNumber,t.listPattern);this.changeListId(t.currentList,i,r,t.listLevelNumber,t.listPattern);this.reLayout(n,!1);this.documentHelper.updateFocus()},n.prototype.getContinueNumberingInfo=function(n){var t=void 0,i=0,f="None",r,u;return sf.base.isNullOrUndefined(n.paragraphFormat)||sf.base.isNullOrUndefined(n.paragraphFormat.listFormat)||(t=this.documentHelper.getListById(n.paragraphFormat.listFormat.listId),i=n.paragraphFormat.listFormat.listLevelNumber),r=this.documentHelper,0===i||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(r.getAbstractListById(t.abstractListId))||sf.base.isNullOrUndefined(r.getAbstractListById(t.abstractListId).levels[i])||(u=this.documentHelper.layout.getListLevel(t,i),sf.base.isNullOrUndefined(u)||(f=u.listLevelPattern)),{currentList:t,listLevelNumber:i,listPattern:f}},n.prototype.revertContinueNumbering=function(n,t){var r=n.start.paragraph,i=this.getContinueNumberingInfo(r);this.changeListId(i.currentList,r,t,i.listLevelNumber,i.listPattern);this.reLayout(n,!1);this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.updateHistory()},n.prototype.changeListId=function(n,t,i,r,f){if(!sf.base.isNullOrUndefined(t)){if(_instanceof(t,u)&&n.listId===t.paragraphFormat.listFormat.listId&&r===t.paragraphFormat.listFormat.listLevelNumber){if(this.editorHistory){var e=this.editorHistory.currentBaseHistoryInfo;sf.base.isNullOrUndefined(e)||(i=e.addModifiedPropertiesForContinueNumbering(t.paragraphFormat,i))}t.paragraphFormat.copyFormat(i);this.documentHelper.layout.reLayoutParagraph(t,0,0)}return this.changeListId(n,t.nextRenderedWidget,i,r,f)}},n.prototype.getParagraphFormat=function(n,t,i){if(!sf.base.isNullOrUndefined(n.previousRenderedWidget)&&_instanceof(n.previousRenderedWidget,u)){if(sf.base.isNullOrUndefined(n.previousRenderedWidget.paragraphFormat.listFormat)||-1===n.previousRenderedWidget.paragraphFormat.listFormat.listId)return this.getParagraphFormat(n.previousRenderedWidget,t,i);var r=this.selection.getListLevel(n.previousRenderedWidget);return 0===t||i===r.listLevelPattern||this.checkNumberArabic(i,r.listLevelPattern)?n.previousRenderedWidget.paragraphFormat:this.getParagraphFormat(n.previousRenderedWidget,t,i)}},n.prototype.checkNumberArabic=function(n,t){return"Number"===n&&"Arabic"===t||"Number"===t&&"Arabic"===n},n.prototype.applyRestartNumbering=function(n){this.editorHistory&&this.editorHistory.initializeHistory("RestartNumbering");this.restartListAt(n)},n.prototype.restartListAt=function(n){var r=n.paragraphFormat.getList(),t=r.clone(),i;t.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1;this.documentHelper.lists.push(t);i=r.abstractList.clone();i.abstractListId=this.documentHelper.abstractLists[this.documentHelper.abstractLists.length-1].abstractListId+1;t.abstractListId=i.abstractListId;t.abstractList=i;this.documentHelper.abstractLists.push(i);this.restartListAtInternal(n,t.listId)},n.prototype.restartListAtInternal=function(n,t){var i=this.getContinueNumberingInfo(n.start.paragraph);this.changeRestartNumbering(i.currentList,n.start.paragraph,t);this.reLayout(n,!1);this.incrementListNumber=-1;this.refListNumber=void 0;this.documentHelper.updateFocus()},n.prototype.changeRestartNumbering=function(n,t,i){if(!sf.base.isNullOrUndefined(t)){if(_instanceof(t,u)&&n.listId===t.paragraphFormat.listFormat.listId){if(this.editorHistory){var r=this.editorHistory.currentBaseHistoryInfo;sf.base.isNullOrUndefined(r)||(i=r.addModifiedPropertiesForRestartNumbering(t.paragraphFormat.listFormat,i))}t.paragraphFormat.listFormat.listId=i;void 0===this.refListNumber&&-1===this.incrementListNumber&&(this.incrementListNumber=t.paragraphFormat.listFormat.listLevelNumber-1);this.refListNumber!==t.paragraphFormat.listFormat.listLevelNumber&&(this.incrementListNumber+=1,this.refListNumber=t.paragraphFormat.listFormat.listLevelNumber);t.paragraphFormat.listFormat.listLevelNumber=this.incrementListNumber;this.documentHelper.layout.reLayoutParagraph(t,0,0)}return this.changeRestartNumbering(n,t.nextRenderedWidget,i)}},n.prototype.applyParaFormat=function(n,t,i,r,u,f){this.setOffsetValue(this.selection);n=n.combineWidget(this.owner.viewer);this.applyParaFormatProperty(n,r,u,f);this.layoutItemBlock(n,!1);this.getOffsetValue(this.selection);n.equals(i.paragraph)||this.getNextParagraphForFormatting(n,t,i,r,u,f)},n.prototype.applyCharacterStyle=function(n,t,i,r,u,f){var h=n.getSplitWidgets(),o=i.owner.selection,e=i.currentWidget,s;return!(0===t.offset&&(o.isParagraphLastLine(e)&&i.currentWidget===e&&i.offset===o.getLineLength(e)+1||i.isAtParagraphEnd))&&(i.paragraph===n||-1!==h.indexOf(i.paragraph))&&("Paragraph"===u.type&&_instanceof(u.link,ur)||"Character"===u.type)?(s="Character"===u.type?u:u.link,this.updateSelectionCharacterFormatting(r,s,f),!0):!1},n.prototype.applyParaFormatInCell=function(n,t,i,r,u,f){var o=this.documentHelper.selection,e,s,h,c;i.paragraph.isInsideTable?(e=o.getContainerCellOf(n,i.paragraph.associatedCell),e.ownerTable.contains(i.paragraph.associatedCell)?(s=o.getSelectedCell(n,e),h=o.getSelectedCell(i.paragraph.associatedCell,e),o.containsCell(e,i.paragraph.associatedCell)?o.isCellSelected(e,t,i)?(u=this.getParaFormatValueInCell(e,r,u),this.applyParaFormatCellInternal(e,r,u,f)):s===e?this.applyParaFormat(t.paragraph,t,i,r,u,f):this.applyParagraphFormatRow(s.ownerRow,t,i,r,u,f):this.applyParaFormatTableCell(e.ownerTable,e,h,r,u,f)):this.applyParagraphFormatRow(e.ownerRow,t,i,r,u,f)):(c=o.getContainerCell(n),this.applyParagraphFormatRow(c.ownerRow,t,i,r,u,f))},n.prototype.applyParaFormatCellInternal=function(n,t,i,r){for(var e,f=0;f<n.childWidgets.length;f++)e=n.childWidgets[f],_instanceof(e,u)?this.applyParaFormatProperty(e,t,i,r):this.applyParagraphFormatTableInternal(e,t,i,r)},n.prototype.getParaFormatValueInCell=function(n,t,i){return"boolean"==typeof i&&(i=!this.documentHelper.selection.getFirstParagraph(n).paragraphFormat.getPropertyValue(t)),i},n.prototype.applyParagraphFormatRow=function(n,t,i,r,u,f){var e,o,s;for(u=this.getParaFormatValueInCell(n.childWidgets[0],r,u),e=n.rowIndex;e<n.ownerTable.childWidgets.length;e++){for(o=n.ownerTable.childWidgets[e],s=0;s<o.childWidgets.length;s++)this.applyParaFormatCellInternal(o.childWidgets[s],r,u,f);if(i.paragraph.isInsideTable&&this.documentHelper.selection.containsRow(o,i.paragraph.associatedCell))return}this.getNextParagraphForFormatting(n.ownerTable,t,i,r,u,f)},n.prototype.applyParaFormatTableCell=function(n,t,i,r,u,f){var h=this.documentHelper.selection,s=h.getCellLeft(t.ownerRow,t),c=s+t.cellFormat.cellWidth,v=h.getCellLeft(i.ownerRow,i),w=v+i.cellFormat.cellWidth,y=this.updateSelectedCellsInTable(s,c,v,w),e,o,a;s=y.start;c=y.end;for(var b=n.childWidgets.indexOf(i.ownerRow),p=!1,l=n.childWidgets.indexOf(t.ownerRow);l<=b;l++)for(e=n.childWidgets[l],o=0;o<e.childWidgets.length;o++)a=h.getCellLeft(e,e.childWidgets[o]),Math.round(s)<=Math.round(a)&&Math.round(a)<Math.round(c)&&(p||(u=this.getParaFormatValueInCell(e.childWidgets[o],r,u),p=!0),this.applyParaFormatCellInternal(e.childWidgets[o],r,u,f))},n.prototype.applyParaFormatTable=function(n,t,i,r,u,f){var h,e,o,s;for(n=n.combineWidget(this.owner.viewer),h=this.documentHelper.selection,e=0;e<n.childWidgets.length;e++){for(o=n.childWidgets[e],s=0;s<o.childWidgets.length;s++)this.applyParaFormatCellInternal(o.childWidgets[s],r,u,f);if(i.paragraph.isInsideTable&&h.containsRow(o,i.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(n.index,n.containerWidget,n,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(n.index,n.containerWidget,n,!1);this.getNextParagraphForFormatting(n,t,i,r,u,f)},n.prototype.getNextParagraphForFormatting=function(n,t,i,r,f,e){var o=n.getSplitWidgets();n=o[o.length-1];n=this.documentHelper.selection.getNextRenderedBlock(n);sf.base.isNullOrUndefined(n)||(_instanceof(n,u)?this.applyParaFormat(n,t,i,r,f,e):this.applyParaFormatTable(n,t,i,r,f,e))},n.prototype.applyParagraphFormatTableInternal=function(n,t,i,r){for(var e,f,u=0;u<n.childWidgets.length;u++)for(e=n.childWidgets[u],f=0;f<e.childWidgets.length;f++)this.applyParaFormatCellInternal(e.childWidgets[f],t,i,r)},n.prototype.onApplySectionFormat=function(n,t){if(!this.restrictFormatting){if(sf.base.isNullOrUndefined(n))this.initHistory("SectionFormat");else{var i=n[0].toUpperCase()+n.slice(1);this.initHistory(i)}this.updateSectionFormat(n,t)}},n.prototype.updateSectionFormat=function(n,t){var r=this.documentHelper.selection,e,o,s,h,f,u,l;r.owner.isShiftingEnabled=!0;s=r.start;h=r.end;r.isForward||(s=r.end,h=r.start);this.documentHelper.clearContent();for(var c=s.paragraph.bodyWidget.sectionIndex,a=h.paragraph.bodyWidget.sectionIndex,i=0;i<this.documentHelper.pages.length;i++)if(this.documentHelper.pages[i].bodyWidgets[0].index===c){e=i;break}for(i=e;i<this.documentHelper.pages.length;i++)if(f=this.documentHelper.pages[i].bodyWidgets[0],o=i,f.index!==c&&!(f.index>=c&&f.index<=a)){o=i-1;break}for(u=!0,l=0,i=e;i<=o;i++)l===this.documentHelper.pages[i].bodyWidgets[0].index||u||(u=!0),this.applyPropertyValueForSection(this.documentHelper.pages[i].bodyWidgets[0].sectionFormat,n,t,u),l=this.documentHelper.pages[i].bodyWidgets[0].index,u=!1;this.layoutWholeDocument();this.fireContentChange()},n.prototype.onApplyTableFormat=function(n,t){var u,r,i;this.restrictFormatting||(u=this.getTableFormatAction(n),this.viewer.owner.isShiftingEnabled=!0,r=this.documentHelper.selection,i=r.start.paragraph.associatedCell.ownerTable,i=i.combineWidget(this.owner.viewer),r.isEmpty?(this.initHistory(u),this.applyTablePropertyValue(r,n,t,i)):this.updateSelectionTableFormat(this.selection,u,t),i.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(i),this.reLayout(r,!1))},n.prototype.getTableFormatAction=function(n){switch(n){case"tableAlignment":return"TableAlignment";case"leftIndent":return"TableLeftIndent";case"leftMargin":return"DefaultCellLeftMargin";case"rightMargin":return"DefaultCellRightMargin";case"bottomMargin":return"DefaultCellBottomMargin";case"topMargin":return"DefaultCellTopMargin";case"preferredWidth":return"TablePreferredWidth";case"preferredWidthType":return"TablePreferredWidthType";case"shading":return"Shading";case"bidi":return"TableBidi";default:return"DefaultCellSpacing"}},n.prototype.onApplyTableRowFormat=function(n,t){var r,i;this.restrictFormatting||(r=this.getRowAction(n),this.documentHelper.owner.isShiftingEnabled=!0,i=this.documentHelper.selection,i.isEmpty?(this.initHistory(r),i.start.paragraph.associatedCell.ownerRow.ownerTable,this.applyRowPropertyValue(i,n,t,i.start.paragraph.associatedCell.ownerRow)):this.updateSelectionTableFormat(this.selection,r,t),this.reLayout(i,!1))},n.prototype.getRowAction=function(n){switch(n){case"height":return"RowHeight";case"heightType":return"RowHeightType";case"isHeader":return"RowHeader";default:return"AllowBreakAcrossPages"}},n.prototype.onApplyTableCellFormat=function(n,t){var u,i,r;this.restrictFormatting||(u=this.getTableCellAction(n),this.documentHelper.owner.isShiftingEnabled=!0,i=this.documentHelper.selection,r=i.start.paragraph.associatedCell.ownerTable,r=r.combineWidget(this.owner.viewer),i.isEmpty?(this.initHistory(u),this.applyCellPropertyValue(i,n,t,i.start.paragraph.associatedCell.cellFormat),r.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(r)):this.updateSelectionTableFormat(this.selection,u,t),this.reLayout(i,!1))},n.prototype.getTableCellAction=function(n){switch(n){case"verticalAlignment":return"CellContentVerticalAlignment";case"leftMargin":return"CellLeftMargin";case"rightMargin":return"CellRightMargin";case"bottomMargin":return"CellBottomMargin";case"topMargin":return"CellTopMargin";case"preferredWidth":return"CellPreferredWidth";case"shading":return"Shading";default:return"CellPreferredWidthType"}},n.prototype.applyPropertyValueForSection=function(n,t,i,r){r&&this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(i=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(n,t,i));sf.base.isNullOrUndefined(i)||(_instanceof(i,dt)?sf.base.isNullOrUndefined(t)&&n.copyFormat(i,this.editorHistory):"pageHeight"===t?n.pageHeight=i:"pageWidth"===t?n.pageWidth=i:"leftMargin"===t?n.leftMargin=i:"rightMargin"===t?n.rightMargin=i:"topMargin"===t?n.topMargin=i:"bottomMargin"===t?n.bottomMargin=i:"differentFirstPage"===t?n.differentFirstPage=i:"differentOddAndEvenPages"===t?n.differentOddAndEvenPages=i:"headerDistance"===t?n.headerDistance=i:"footerDistance"===t?n.footerDistance=i:"pageStartingNumber"===t?n.pageStartingNumber=i:"restartPageNumbering"===t?n.restartPageNumbering=i:"endnoteNumberFormat"===t?n.endnoteNumberFormat=i:"footNoteNumberFormat"===t?n.footNoteNumberFormat=i:"restartIndexForEndnotes"===t?n.restartIndexForEndnotes=i:"restartIndexForFootnotes"===t?n.restartIndexForFootnotes=i:"initialFootNoteNumber"===t?n.initialFootNoteNumber=i:"initialEndNoteNumber"===t&&(n.initialEndNoteNumber=i))},n.prototype.layoutWholeDocument=function(){var n,t,u;this.documentHelper.layout.isLayoutWhole=!0;n=this.documentHelper.selection.start;t=this.documentHelper.selection.end;n.isExistAfter(t)&&(n=this.documentHelper.selection.end,t=this.documentHelper.selection.start);var i=this.selection.getParagraphInfo(n),r=this.selection.getParagraphInfo(t),f=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString()),e=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());this.documentHelper.renderedLists.clear();this.documentHelper.renderedLevelOverrides=[];u=this.combineSection();this.documentHelper.clearContent();this.documentHelper.layout.layoutItems(u,!0);this.documentHelper.owner.isShiftingEnabled=!1;this.setPositionForCurrentIndex(n,f);this.setPositionForCurrentIndex(t,e);this.documentHelper.selection.selectPosition(n,t);this.reLayout(this.documentHelper.selection);this.documentHelper.layout.isLayoutWhole=!1},n.prototype.combineSection=function(){var t=[],n=this.documentHelper.pages[0].bodyWidgets[0];do n=this.combineSectionChild(n,t);while(n);return t},n.prototype.combineSectionChild=function(n,t){var r=n,e=new c,u,i;e.sectionFormat=n.sectionFormat;e.index=r.index;do{for(r=n,n.lastChild&&n.lastChild.combineWidget(this.owner.viewer),n=n.nextRenderedWidget,u=0;u<r.childWidgets.length;u++)i=r.childWidgets[u],_instanceof(i,f)?this.documentHelper.layout.clearTableWidget(i,!0,!0,!0):(i.x=0,i.y=0,i.width=0,i.height=0),e.childWidgets.push(i),r.childWidgets.splice(u,1),u--,i.containerWidget=e;r.page.destroy()}while(n&&r.equals(n));return t.push(e),n},n.prototype.updateSelectionTableFormat=function(n,t,i){switch(t){case"TableAlignment":this.editorHistory.initializeHistory("TableAlignment");this.updateTableFormat(n,"tableAlignment",i);break;case"TableLeftIndent":this.editorHistory.initializeHistory("TableLeftIndent");this.updateTableFormat(n,"leftIndent",i);break;case"DefaultCellSpacing":this.editorHistory.initializeHistory("DefaultCellSpacing");this.updateTableFormat(n,"cellSpacing",i);break;case"DefaultCellLeftMargin":this.editorHistory.initializeHistory("DefaultCellLeftMargin");this.updateTableFormat(n,"leftMargin",i);break;case"DefaultCellRightMargin":this.editorHistory.initializeHistory("DefaultCellRightMargin");this.updateTableFormat(n,"rightMargin",i);break;case"DefaultCellTopMargin":this.editorHistory.initializeHistory("DefaultCellTopMargin");this.updateTableFormat(n,"topMargin",i);break;case"TablePreferredWidth":this.editorHistory.initializeHistory("TablePreferredWidth");this.updateTableFormat(n,"preferredWidth",i);break;case"TablePreferredWidthType":this.editorHistory.initializeHistory("TablePreferredWidthType");this.updateTableFormat(n,"preferredWidthType",i);break;case"DefaultCellBottomMargin":this.editorHistory.initializeHistory("DefaultCellBottomMargin");this.updateTableFormat(n,"bottomMargin",i);break;case"CellContentVerticalAlignment":this.editorHistory.initializeHistory("CellContentVerticalAlignment");this.updateCellFormat(n,"verticalAlignment",i);break;case"CellLeftMargin":this.editorHistory.initializeHistory("CellLeftMargin");this.updateCellFormat(n,"leftMargin",i);break;case"CellRightMargin":this.editorHistory.initializeHistory("CellRightMargin");this.updateCellFormat(n,"rightMargin",i);break;case"CellTopMargin":this.editorHistory.initializeHistory("CellTopMargin");this.updateCellFormat(n,"topMargin",i);break;case"CellBottomMargin":this.editorHistory.initializeHistory("CellBottomMargin");this.updateCellFormat(n,"bottomMargin",i);break;case"CellPreferredWidth":this.editorHistory.initializeHistory("CellPreferredWidth");this.updateCellFormat(n,"preferredWidth",i);break;case"CellPreferredWidthType":this.editorHistory.initializeHistory("CellPreferredWidthType");this.updateCellFormat(n,"preferredWidthType",i);break;case"Shading":this.editorHistory.initializeHistory("Shading");this.updateCellFormat(n,"shading",i);break;case"RowHeight":this.editorHistory.initializeHistory("RowHeight");this.updateRowFormat(n,"height",i);break;case"RowHeightType":this.editorHistory.initializeHistory("RowHeightType");this.updateRowFormat(n,"heightType",i);break;case"RowHeader":this.editorHistory.initializeHistory("RowHeader");this.updateRowFormat(n,"isHeader",i);break;case"AllowBreakAcrossPages":this.editorHistory.initializeHistory("AllowBreakAcrossPages");this.updateRowFormat(n,"allowBreakAcrossPages",i);break;case"TableBidi":this.editorHistory.initializeHistory(t);this.updateTableFormat(n,"bidi",i)}},n.prototype.updateTableFormat=function(n,t,i){var r=n.start;n.end;n.isForward||(r=n.end,n.start);this.initHistoryPosition(n,r);this.applyTablePropertyValue(n,t,i,r.paragraph.associatedCell.ownerTable);this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&this.documentHelper.layout.reLayoutTable(r.paragraph.associatedCell.ownerTable)},n.prototype.updateCellFormat=function(n,t,i){n.owner.isShiftingEnabled=!0;var r=n.start;n.end;n.isForward||(r=n.end,n.start);this.initHistoryPosition(n,r);this.updateFormatForCell(n,t,i)},n.prototype.updateRowFormat=function(n,t,i){var r=n.start,u=n.end;n.isForward||(r=n.end,u=n.start);this.initHistoryPosition(n,r);this.applyRowFormat(r.paragraph.associatedCell.ownerRow,r,u,t,i)},n.prototype.initHistoryPosition=function(n,t){this.documentHelper.owner.editorHistoryModule&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(sf.base.isNullOrUndefined(t)?sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=n.start.getHierarchicalIndexInternal()):sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=t.getHierarchicalIndexInternal()))},n.prototype.startSelectionReLayouting=function(n,t,i,r){if(t.owner.isLayoutEnabled=!0,i.paragraph.isInsideTable){for(var u=i.paragraph.associatedCell.ownerTable;u.isInsideTable;)u=u.associatedCell.ownerTable;this.reLayoutSelectionOfTable(u,t,i,r)}else this.reLayoutSelection(n,t,i,r)},n.prototype.reLayoutSelectionOfTable=function(n,t,i,r){var f=!1,u;return(this.documentHelper.layout.layoutBodyWidgetCollection(n.index,n.containerWidget,n,!1),!sf.base.isNullOrUndefined(r.paragraph.associatedCell)&&n.contains(r.paragraph.associatedCell))?!0:(u=t.getNextRenderedBlock(n),sf.base.isNullOrUndefined(u)||(f=this.reLayoutSelectionOfBlock(u,t,i,r)),f)},n.prototype.reLayoutSelection=function(n,t,r,u){var o,h;if(r.paragraph===n){r.offset;t.getParagraphLength(n);var s=0,e=0,c=n.getInline(r.offset,s),f=c.element;s=c.index;sf.base.isNullOrUndefined(f)||(s!==f.length||sf.base.isNullOrUndefined(f.nextNode)||(f=f.nextNode),e=f.line.children.indexOf(f));o=0;r.currentWidget.paragraph===n&&(o=n.childWidgets.indexOf(r.currentWidget),e=r.currentWidget.children.indexOf(f));_instanceof(f,i)&&!f.line&&e>0?this.documentHelper.layout.reLayoutParagraph(n,o,e-1):this.documentHelper.layout.reLayoutParagraph(n,o,e)}else this.documentHelper.layout.reLayoutParagraph(n,0,0);return u.paragraph===n?!0:(h=t.getNextRenderedBlock(n),!sf.base.isNullOrUndefined(h)&&this.reLayoutSelectionOfBlock(h,t,r,u))},n.prototype.reLayoutSelectionOfBlock=function(n,t,i,r){if(_instanceof(n,u))return this.reLayoutSelection(n,t,i,r)},n.prototype.layoutItemBlock=function(n){var i=void 0,t;_instanceof(n.containerWidget,ri)?!sf.base.isNullOrUndefined(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled&&(i=(n=n.combineWidget(this.viewer)).containerWidget,this.documentHelper.layout.layoutBodyWidgetCollection(n.index,i,n,!1)):_instanceof(n.containerWidget,s)&&(t=n.containerWidget,t=this.documentHelper.selection.getContainerCell(t),!sf.base.isNullOrUndefined(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled&&this.documentHelper.layout.reLayoutTable(n))},n.prototype.removeSelectedContents=function(n){return this.removeSelectedContentInternal(n,n.start,n.end)},n.prototype.removeSelectedContentInternal=function(n,t,i){var r=t,u=i,f,o,e;return(t.isExistBefore(i)||(r=i,u=t),r.paragraph===u.paragraph&&r.paragraph.childWidgets.indexOf(r.currentWidget)===r.paragraph.childWidgets.length-1&&r.offset===n.getParagraphLength(r.paragraph)&&r.offset+1===u.offset)?(n.owner.isShiftingEnabled=!0,n.selectContent(r,!0),!0):(f=this.selection.getParagraphInfo(r),n.editPosition=this.selection.getHierarchicalIndex(f.paragraph,f.offset.toString()),o=this.removeSelectedContent(u.paragraph,n,r,u),e=new l(n.owner),this.setPositionForCurrentIndex(e,n.editPosition),n.selectContent(e,!0),o)},n.prototype.removeSelectedContent=function(n,t,i,r){return!(r.paragraph.isInsideTable&&r.paragraph!==t.getLastParagraphInLastCell(r.paragraph.associatedCell.ownerTable)&&(!i.paragraph.isInsideTable||i.paragraph.associatedCell.ownerTable.index!==r.paragraph.associatedCell.ownerTable.index))&&(t.owner.isShiftingEnabled=!0,this.deleteSelectedContent(n,t,i,r,2),!0)},n.prototype.deleteSelectedContent=function(n,t,i,r,u){var o=0,s=i.currentWidget.getInline(i.offset,o),l,h,f,e;if(s.element,o=s.index,o=0,(s=r.currentWidget.getInline(r.offset,o)).element,o=s.index,r.paragraph===n){if(r.paragraph.isInsideTable&&(!i.paragraph.isInsideTable||i.paragraph.associatedCell!==r.paragraph.associatedCell||t.isCellSelected(r.paragraph.associatedCell,i,r))?(r.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.deleteTableCell(r.paragraph.associatedCell,t,i,r,u)):(this.deletePara(n,i,r,u),this.delBlockContinue&&this.delBlock)&&(this.delSection&&(l=_instanceof(n.bodyWidget,c)?n.bodyWidget:void 0,this.deleteSection(t,this.delSection,l,u),this.delSection=void 0),this.deleteBlock(this.delBlock,t,i,r,u),this.delBlockContinue=!1,this.delBlock=void 0),this.removeCommentCharacters.length>0&&!this.isCmtDeleteStarted){for(h=0;h<this.removeCommentCharacters.length;h++)f=this.editorHistory.currentBaseHistoryInfo,e=this.removeCommentCharacters[h],this.isCmtDeleteStarted=!0,e.commentMark&&e.removeCommentMark(),e.line&&e.line.paragraph&&e.line.paragraph.bodyWidget&&f&&(this.removeInline(e),this.selection.editPosition=f.insertPosition,this.isCmtDeleteStarted=!1,this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=f.insertPosition,this.editorHistory.currentHistoryInfo.endPosition=f.insertPosition,this.editorHistory.currentHistoryInfo.selectionStart=f.selectionStart,this.editorHistory.currentHistoryInfo.selectionEnd=f.selectionEnd,f.endPosition=f.insertPosition,this.editorHistory.updateComplexHistory(),this.editorHistory.currentBaseHistoryInfo=void 0));this.isCmtDeleteStarted=!1;this.removeCommentCharacters=[];this.editorHistory.currentHistoryInfo&&(this.editorHistory.updateComplexHistory(),this.editorHistory.currentBaseHistoryInfo=void 0);this.selection.owner.isShiftingEnabled=!1}}else this.deleteSelectedContent(r.paragraph,t,i,r,u)},n.prototype.mergeCells=function(){!this.owner.isReadOnlyMode&&this.canEditContentControl&&this.owner.isDocumentLoaded&&(sf.base.isNullOrUndefined(this.documentHelper)||this.selection.isEmpty||this.mergeSelectedCellsInTable())},n.prototype.deleteTable=function(){var i,n,r,t,u;if(!this.owner.isReadOnlyMode&&this.canEditContentControl&&(i=this.selection.isForward?this.selection.start:this.selection.end,i.paragraph.isInsideTable)){if(n=this.getOwnerTable(this.selection.isForward).combineWidget(this.owner.viewer),this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&(this.initHistory("DeleteTable"),this.updateHistoryPosition(i,!0)),r=this.getParagraphForSelection(n),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.push(n.clone()),this.owner.enableTrackChanges)for(t=0;t<n.childWidgets.length;t++)0===t&&(u=n.childWidgets[0],r=this.selection.getFirstParagraph(u)),this.trackRowDeletion(n.childWidgets[t]);else this.removeBlock(n);this.selection.selectParagraphInternal(r,!0);(this.checkIsNotRedoing()||sf.base.isNullOrUndefined(this.editorHistory))&&this.reLayout(this.selection)}},n.prototype.deleteColumn=function(){!this.owner.isReadOnlyMode&&this.canEditContentControl&&(this.owner.enableTrackChanges||this.onDeleteColumnConfirmed())},n.prototype.onDeleteColumnConfirmed=function(){var l=this.selection.isForward?this.selection.start:this.selection.end,i,h,c,o,r,t,u,s;if(this.selection.isForward?this.selection.end:this.selection.start,l.paragraph.isInsideTable){this.selection.owner.isShiftingEnabled=!0;this.checkIsNotRedoing()&&this.initHistory("DeleteColumn");var f=this.getOwnerCell(this.selection.isForward),e=this.getOwnerCell(!this.selection.isForward),n=f.ownerTable.combineWidget(this.owner.viewer);for(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(n),i=void 0,e.nextWidget?(h=e.nextWidget,i=this.selection.getFirstParagraph(h)):f.previousWidget&&(c=f.previousWidget,i=this.selection.getFirstParagraph(c)),sf.base.isNullOrUndefined(i)&&(i=this.getParagraphForSelection(n)),o=n.getColumnCellsForSelection(f,e),r=0;r<n.childWidgets.length;r++)if(t=n.childWidgets[r],1===t.childWidgets.length)o.indexOf(t.childWidgets[0])>=0&&(n.childWidgets.splice(n.childWidgets.indexOf(t),1),t.destroy(),r--);else{for(u=0;u<t.childWidgets.length;u++)s=t.childWidgets[u],o.indexOf(s)>=0&&(t.childWidgets.splice(u,1),s.destroy(),u--);0===t.childWidgets.length&&(n.childWidgets.splice(n.childWidgets.indexOf(t),1),t.destroy(),r--)}0===n.childWidgets.length?(i=this.getParagraphForSelection(n),this.removeBlock(n),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),n.destroy()):(n.isGridUpdated=!1,n.buildTableColumns(),n.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(n));this.selection.selectParagraphInternal(i,!0);(sf.base.isNullOrUndefined(this.editorHistory)||this.checkIsNotRedoing())&&this.reLayout(this.selection,!0)}},n.prototype.deleteRow=function(){var r,u,n,t,i,h,e,c,f,o,a;if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var s=this.selection.isForward?this.selection.start:this.selection.end,l=(this.selection.isForward?this.selection.end:this.selection.start,this.selection.getParagraphInfo(s)),v=this.selection.getHierarchicalIndex(l.paragraph,l.offset.toString());if(s.paragraph.isInsideTable){if(r=this.getOwnerCell(this.selection.isForward),u=this.getOwnerCell(!this.selection.isForward),this.checkIsNotRedoing()&&this.initHistory("DeleteRow"),this.selection.owner.isShiftingEnabled=!0,n=r.ownerTable.combineWidget(this.owner.viewer),t=this.getOwnerRow(!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(n),i=void 0,t.nextWidget&&(h=t.nextWidget.childWidgets[0],i=this.selection.getFirstParagraph(h)),sf.base.isNullOrUndefined(i)&&(i=this.getParagraphForSelection(n)),s=s.clone(),this.selection.isEmpty)this.owner.enableTrackChanges?this.trackRowDeletion(t,!0,!1):this.removeRow(t);else if(e=this.selection.getContainerCellOf(r,u),e.ownerTable.contains(u))if(r=this.selection.getSelectedCell(r,e),u=this.selection.getSelectedCell(u,e),this.selection.containsCell(e,u))t=r.ownerRow,this.removeRow(t);else{for(t=r.ownerRow,c=u.ownerRow,(i=void 0,c.nextWidget)&&(h=c.nextWidget.childWidgets[0],i=this.selection.getFirstParagraph(h)),sf.base.isNullOrUndefined(i)&&(i=this.getParagraphForSelection(n)),f=0;f<n.childWidgets.length;f++)o=n.childWidgets[f],o.rowIndex>=t.rowIndex&&o.rowIndex<=c.rowIndex&&(this.owner.enableTrackChanges&&this.checkIsNotRedoing()?this.trackRowDeletion(o,!0,!1):(n.childWidgets.splice(f,1),o.destroy(),f--));0===n.childWidgets.length?(this.removeBlock(n),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),n.destroy()):this.updateTable(n)}!this.owner.enableTrackChanges||sf.base.isNullOrUndefined(n.childWidgets)?this.selection.selectParagraphInternal(i,!0):(a=this.selection.getTextPosBasedOnLogicalIndex(v),this.selection.selectContent(a,!0));(sf.base.isNullOrUndefined(this.editorHistory)||this.checkIsNotRedoing())&&this.reLayout(this.selection,!0)}}},n.prototype.trackRowDeletion=function(n,t,i){var r=n.rowFormat,s,u,e,o,h;if(!sf.base.isNullOrUndefined(r)){if(r.revisions.length>0)if(s=this.retrieveRevisionInOder(r),"Insertion"===s.revisionType){if(this.isRevisionMatched(r,void 0))return sf.base.isNullOrUndefined(t)||t?this.removeRow(n):this.removeRevisionsInRow(n),!0}else"Deletion"===s.revisionType&&this.unlinkWholeRangeInRevision(r,s);for((sf.base.isNullOrUndefined(i)||i)&&this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack"),this.insertRevision(r,"Deletion"),u=0;u<n.childWidgets.length;u++)for(e=n.childWidgets[u],o=0;o<e.childWidgets.length;o++)_instanceof(e.childWidgets[o],f)?this.trackInnerTable(e.childWidgets[u],t,i):(h=e.childWidgets[o],this.skipTableElements=!0,this.insertRevisionForBlock(h,"Deletion"),this.skipTableElements=!1)}return!1},n.prototype.trackInnerTable=function(n,t,i){for(var r=0;r<n.childWidgets.length;r++)this.trackRowDeletion(n.childWidgets[r],t,i)},n.prototype.returnDeleteRevision=function(n){for(var t=0;t<n.length;t++)if("Deletion"===n[t].revisionType)return n[t]},n.prototype.removeRow=function(n){var t=n.ownerTable;n.rowFormat.revisions.length>0&&this.removeRevisionsInRow(n);1===t.childWidgets.length?(this.removeBlock(t),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="Delete"),t.destroy()):(t.childWidgets.splice(t.childWidgets.indexOf(n),1),n.destroy(),this.updateTable(t))},n.prototype.updateTable=function(n){n.updateRowIndex(0);n.isGridUpdated=!1;n.buildTableColumns();n.isGridUpdated=!0;this.documentHelper.layout.reLayoutTable(n)},n.prototype.getParagraphForSelection=function(n){var r=void 0,t=n.nextWidget?n.nextWidget:n.nextRenderedWidget,i=n.previousWidget?n.previousWidget:n.previousRenderedWidget;return t?r=_instanceof(t,u)?t:this.selection.getFirstParagraphInFirstCell(t):i&&(r=_instanceof(i,u)?i:this.selection.getLastParagraphInLastCell(i)),r},n.prototype.deletePara=function(n,t,i,r){var o,g,y,rt,p,tt,nt;n=n.combineWidget(this.owner.viewer);var s=this.documentHelper.selection,b=s.getStartOffset(n),ft=s.getStartOffset(i.paragraph),e=b,k=0,a=!1,et=this.selection.getLineLength(n.lastChild),v=n,it=_instanceof(n.bodyWidget,c)?n.bodyWidget:void 0,h=void 0,d=void 0;if(n===t.paragraph?(e=t.offset,h=t.currentWidget,i.paragraph.isInsideTable&&(a=this.isEndInAdjacentTable(n,i.paragraph))):h=n.firstChild,n!==t.paragraph&&s.isSkipLayouting&&(s.isSkipLayouting=!1),n===i.paragraph?(d=i.currentWidget,k=i.offset):(d=n.lastChild,k=this.documentHelper.selection.getLineLength(n.lastChild)),o=n.previousRenderedWidget?n.previousRenderedWidget.combineWidget(this.documentHelper.viewer):void 0,(e>b&&t.currentWidget===n.lastChild&&e===et&&(n===i.paragraph&&i.offset===e+1||n.nextRenderedWidget===i.paragraph&&i.offset===ft)||this.editorHistory&&this.editorHistory.isUndoing&&this.editorHistory.currentHistoryInfo&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&o&&o.isPageBreak()&&(0===e&&!t.currentWidget.isFirstLine||e>0))&&(a=!0),g=i.clone(),g.offset=g.offset-1,y=t.paragraph===n&&t.isAtParagraphStart&&g.isAtParagraphEnd&&this.editorHistory&&"Insert"===this.editorHistory.currentBaseHistoryInfo.action,y&&(this.editorHistory.currentBaseHistoryInfo.action="InsertTextParaReplace"),i.paragraph===n&&i.currentWidget!==n.lastChild||i.currentWidget===n.lastChild||y)rt=t.paragraph===n,((i.currentWidget.isFirstLine()&&i.offset>b||!i.currentWidget.isFirstLine()||y)&&this.removeInlines(n,h,e,d,k,r),sf.base.isNullOrUndefined(o)||rt||y)?(this.delBlockContinue=!1,this.delBlock=void 0):(this.delBlockContinue=!0,this.delBlock=o,p=_instanceof(o.bodyWidget,c)?o.bodyWidget:void 0,this.delSection=p&&!it.equals(p)&&it.index!==p.index?p:void 0);else{if(t.paragraph===n&&(t.currentWidget!==n.firstChild||t.currentWidget===n.firstChild&&e>b))return this.delBlockContinue=!1,this.delBlock=void 0,4===r?void 0:void(this.skipTracking()&&"ParaMarkTrack"===this.editorHistory.currentBaseHistoryInfo.action?(this.addRemovedNodes(n.characterFormat.cloneFormat()),n.characterFormat.revisions.length>0&&this.unlinkRangeFromRevision(n.characterFormat,!0),n.characterFormat.revisions=[]):this.owner.enableTrackChanges&&!this.skipTracking()&&"TOC"!==this.editorHistory.currentBaseHistoryInfo.action&&"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action?a?(v=this.splitParagraph(n,n.firstChild,0,h,e,!0),this.deleteParagraphMark(v,s,r,!0),this.addRemovedNodes(n)):this.removeInlines(n,h,e,d,k,r):(v=this.splitParagraph(n,n.firstChild,0,h,e,!0),this.insertParagraphPaste(n,v,t,i,a,r),this.removeRevisionForBlock(n,void 0,!1,!0),this.addRemovedNodes(n)));var l=void 0,ut=n.previousWidget,w=_instanceof(ut,u)?ut:void 0,ot=n.nextRenderedWidget;if(r<4){if(this.owner.enableTrackChanges&&!this.skipTracking()&&this.editorHistory.currentBaseHistoryInfo&&"TOC"!==this.editorHistory.currentBaseHistoryInfo.action){if((this.insertRevisionForBlock(n,"Deletion"),!n.isEmpty()||_instanceof(i.paragraph.previousRenderedWidget,f)?this.combineRevisionWithBlocks(n.firstChild.children[0]):(l=this.checkAndInsertBlock(n,t,i,r,w),this.removeBlock(n)),n===i.paragraph&&"Delete"===this.editorHistory.currentBaseHistoryInfo.action)&&(tt=this.selection.getParagraphInfo(i),this.selection.editPosition=this.selection.getHierarchicalIndex(tt.paragraph,tt.offset.toString())),t.paragraph!==n&&!sf.base.isNullOrUndefined(o))return this.delBlockContinue=!0,void(this.delBlock=o)}else l=this.checkAndInsertBlock(n,t,i,r,w),this.removeRevisionForBlock(n,void 0,!1,!0),this.addRemovedNodes(n),this.removeBlock(n);(this.documentHelper.blockToShift===n&&(this.documentHelper.blockToShift=void 0),sf.base.isNullOrUndefined(l))?n===t.paragraph&&sf.base.isNullOrUndefined(ot)&&!sf.base.isNullOrUndefined(w)&&(nt=this.selection.getParagraphLength(w),s.editPosition=this.selection.getHierarchicalIndex(w,nt.toString()),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(s.editPosition,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=s.editPosition)):(s.editPosition=this.selection.getHierarchicalIndex(l,"0"),nt=s.getParagraphLength(l)+1,this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(l,nt.toString())))}t.paragraph===n||sf.base.isNullOrUndefined(o)?(this.delBlockContinue=!1,this.delBlock=void 0):(this.delBlockContinue=!0,this.delBlock=o)}this.insertParagraphPaste(n,v,t,i,a,r)},n.prototype.deleteSection=function(n,t,i,r){r<4&&this.combineSectionInternal(n,t,i);r>2&&t.sectionFormat.copyFormat(i.sectionFormat)},n.prototype.combineSectionInternal=function(n,t,i){var u=t.getSplitWidgets()[0],o=[],s,r;this.combineSectionChild(u,o);s=(u=o[0]).lastChild.index;this.updateBlockIndex(s+1,i.firstChild);for(var h=0,e=i,f=0;f<u.childWidgets.length;f++)r=u.childWidgets.splice(f,1)[0],e.childWidgets.splice(h,0,r),r.containerWidget=e,this.documentHelper.layout.layoutBodyWidgetCollection(r.index,r.bodyWidget,r,!1),e=(r=r.getSplitWidgets().pop()).containerWidget,h=r.indexInOwner+1,f--;this.updateSectionIndex(void 0,i,!1);this.addRemovedNodes(u)},n.prototype.checkAndInsertBlock=function(n,t,i,r,e){var o,s;if(_instanceof(n,u)&&n===t.paragraph||_instanceof(n,f))return o=void 0,sf.base.isNullOrUndefined(n.nextWidget)&&(sf.base.isNullOrUndefined(e)||_instanceof(e.nextRenderedWidget,f))&&((o=new u,1===r&&_instanceof(n,u)&&!sf.base.isNullOrUndefined(n.paragraphFormat.baseStyle)&&"Normal"===n.paragraphFormat.baseStyle.name&&(o.characterFormat.copyFormat(n.characterFormat),o.paragraphFormat.copyFormat(n.paragraphFormat)),o.index=n.index+1,o.containerWidget=n.containerWidget,_instanceof(n,u))&&(o.paragraphFormat.lineSpacing=n.paragraphFormat.lineSpacing,o.paragraphFormat.lineSpacingType=n.paragraphFormat.lineSpacingType,s=this.documentHelper.styles.findByName("Normal"),sf.base.isNullOrUndefined(s)||(o.paragraphFormat.baseStyle=new fi,o.paragraphFormat.baseStyle.copyStyle(s))),this.documentHelper.layout.layoutBodyWidgetCollection(o.index,o.bodyWidget,o,!1),_instanceof(n.containerWidget,gt)&&n.containerWidget.childWidgets.push(o)),o},n.prototype.splitParagraph=function(n,t,i,r,f,e){var o=new u,h,s,c;return o.paragraphFormat=new ut(o),o.characterFormat=new p(o),o.paragraphFormat.copyFormat(n.paragraphFormat),o.characterFormat.copyFormat(n.characterFormat),h=new k(o),o.childWidgets.push(h),s=n.index,c=n.indexInOwner,this.moveInlines(n,o,0,i,t,f,r),n.containerWidget.childWidgets.splice(c,0,o),o.index=s,o.containerWidget=n.containerWidget,this.updateNextBlocksIndex(o,!0),e&&this.removeBlock(n),this.documentHelper.layout.layoutBodyWidgetCollection(s,o.containerWidget,o,!1),o},n.prototype.addOrRemoveCommentsInBlock=function(n,t){var i,e,r,o,u,s;if(_instanceof(n,f))for(i=0;i<n.childWidgets.length;i++)for(e=n.childWidgets[i],r=0;r<e.childWidgets.length;r++)for(o=e.childWidgets[r],u=0;u<o.childWidgets.length;u++)s=o.childWidgets[u],this.addOrRemoveCommentsInBlock(s,t);else this.addOrRemoveCommentInPara(n,t)},n.prototype.addOrRemoveCommentInPara=function(n,t){for(var u,r,i=0;i<n.childWidgets.length;i++)for(u=n.childWidgets[i],r=0;r<u.children.length;r++)this.addOrRemoveCommentsInline(u.children[r],t)},n.prototype.addOrRemoveCommentsInline=function(n,t){if(_instanceof(n,g)&&0===n.commentType&&!sf.base.isNullOrUndefined(n.comment)){var i=n.comment.ownerComment?n.comment.ownerComment:n.comment;t?this.addCommentWidget(i,!1,!1,!1):(n.commentMark&&n.removeCommentMark(),this.deleteCommentWidget(i))}},n.prototype.removeBlock=function(n,t){var u,i,r,f,e;if(this.removeFieldInBlock(n),this.removeFieldInBlock(n,!0),this.removeFieldInBlock(n,void 0,!0),this.addOrRemoveCommentsInBlock(n),n.isInsideTable)i=n.associatedCell,u=n.associatedCell.childWidgets.indexOf(n),n.associatedCell.childWidgets,this.updateNextBlocksIndex(n,!1),n.associatedCell.childWidgets.splice(u,1),n.containerWidget=void 0,this.documentHelper.layout.layoutBodyWidgetCollection(n.index,i,n,!1);else{for(i=n.containerWidget,r=0;r<n.childWidgets.length;r++)f=void 0,(this.isPasteRevertAction()||(f=this.skipTracking()),_instanceof(n.childWidgets[r],a)&&!f)&&(e=n.childWidgets[r],this.removeDeletedCellRevision(e));u=i.childWidgets.indexOf(n);i.childWidgets;this.updateNextBlocksIndex(n,!1);i.childWidgets.splice(u,1);n.containerWidget=void 0;i.height-=n.height;this.documentHelper.layout.layoutBodyWidgetCollection(n.index,i,n,!1,t)}},n.prototype.isPasteRevertAction=function(){return!(sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Paste"!==this.editorHistory.currentBaseHistoryInfo.action)},n.prototype.toCheckForTrack=function(n){if(this.owner.enableTrackChanges&&!this.skipTracking()&&_instanceof(n,f)&&n.childWidgets.length>0){var t=n.childWidgets[0].rowFormat;if(t.revisions.length>0&&"Insertion"!==t.revisions[0].revisionType&&t.revisions[0].author===(""===this.owner.currentUser?"Guest user":this.owner.currentUser)||0===t.revisions.length)return!0}return!1},n.prototype.removeFootnote=function(n){if(n.paragraph.bodyWidget.page.footnoteWidget){for(var t=n.paragraph.bodyWidget.page.footnoteWidget,i=0;i<t.childWidgets.length;i++)n===t.childWidgets[i].footNoteReference&&(t.height-=t.childWidgets[i].height,t.childWidgets.splice(i,1),i--);1===t.childWidgets.length&&(n.paragraph.bodyWidget.page.footnoteWidget=void 0)}this.documentHelper.footnoteCollection.splice(this.documentHelper.footnoteCollection.indexOf(n),1)},n.prototype.removeEndnote=function(n){if(n.paragraph.bodyWidget.page.endnoteWidget){for(var t=n.paragraph.bodyWidget.page.endnoteWidget,i=0;i<t.childWidgets.length;i++)n===t.childWidgets[i].footNoteReference&&(t.height-=t.childWidgets[i].height,t.childWidgets.splice(i,1),i--);1===t.childWidgets.length&&(n.paragraph.bodyWidget.page.endnoteWidget=void 0)}this.documentHelper.endnoteCollection.splice(this.documentHelper.endnoteCollection.indexOf(n),1)},n.prototype.removeAutoShape=function(n){var t=n.line.paragraph.floatingElements.indexOf(n);n.line.paragraph.bodyWidget.floatingElements.splice(n.line.paragraph.bodyWidget.floatingElements.indexOf(n),1);n.line.paragraph.floatingElements.splice(t,1)},n.prototype.removeField=function(n,t,i){var s=this.documentHelper.fields,h,c,r,e,u,f,o;if(t?s=this.documentHelper.bookmarks.keys:i&&(s=this.documentHelper.contentControlCollection),n.floatingElements.length>0)for(h=0;h<n.floatingElements.length;h++)c=n.floatingElements[h],this.removeAutoShape(c);for(r=0;r<s.length;r++)(f=t?this.documentHelper.bookmarks.get(s[r]):s[r]).line.paragraph===n&&(t?this.documentHelper.bookmarks.remove(s[r]):i?this.documentHelper.contentControlCollection.splice(r,1):(this.documentHelper.fields.splice(r,1),-1!==this.documentHelper.formFields.indexOf(f)&&this.documentHelper.formFields.splice(this.documentHelper.formFields.indexOf(f),1)),r--);if(this.documentHelper.footnoteCollection.length>0)for(r=0;r<this.documentHelper.footnoteCollection.length;r++)if((f=this.documentHelper.footnoteCollection[r]).line.paragraph===n){if(f.paragraph.bodyWidget.page.footnoteWidget){for(e=f.paragraph.bodyWidget.page.footnoteWidget,u=0;u<e.childWidgets.length;u++)f===e.childWidgets[u].footNoteReference&&(e.height-=e.childWidgets[u].height,e.childWidgets.splice(u,1),u--);1===e.childWidgets.length&&(f.paragraph.bodyWidget.page.footnoteWidget=void 0)}this.documentHelper.footnoteCollection.splice(r,1);r--}if(this.documentHelper.endnoteCollection.length>0)for(r=0;r<this.documentHelper.endnoteCollection.length;r++)if((f=this.documentHelper.endnoteCollection[r]).line.paragraph===n){if(f.paragraph.bodyWidget.page.endnoteWidget){for(o=f.paragraph.bodyWidget.page.endnoteWidget,u=0;u<o.childWidgets.length;u++)f===o.childWidgets[u].footNoteReference&&(o.height-=o.childWidgets[u].height,o.childWidgets.splice(u,1),u--);1===o.childWidgets.length&&(f.paragraph.bodyWidget.page.endnoteWidget=void 0)}this.documentHelper.endnoteCollection.splice(r,1);r--}},n.prototype.addRemovedNodes=function(n){_instanceof(n,g)&&0===n.commentType&&n.commentMark&&n.removeCommentMark();_instanceof(n,w)&&0===n.type&&this.documentHelper.contentControlCollection.splice(this.documentHelper.contentControlCollection.indexOf(n),1);_instanceof(n,r)&&0===n.fieldType&&(-1!==this.documentHelper.fields.indexOf(n)&&this.documentHelper.fields.splice(this.documentHelper.fields.indexOf(n),1),-1!==this.documentHelper.formFields.indexOf(n)&&this.documentHelper.formFields.splice(this.documentHelper.formFields.indexOf(n),1));this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)?this.editorHistory.currentBaseHistoryInfo.removedNodes.push(n):this.editHyperlinkInternal&&this.nodes.push(n)},n.prototype.deleteBlock=function(n,t,i,r,f){if(_instanceof(n,u)){if(this.deletePara(n,i,r,f),this.delBlockContinue&&this.delBlock){if(this.delSection){var e=_instanceof(n.bodyWidget,c)?n.bodyWidget:void 0;this.deleteSection(t,this.delSection,e,f);this.delSection=void 0}-1!==this.delBlock.indexInOwner&&this.deleteBlock(this.delBlock,t,i,r,f);this.delBlockContinue=!1;this.delBlock=void 0}}else this.deleteTableBlock(n,t,i,r,f)},n.prototype.deleteTableCell=function(n,t,i,r,u){var v=!(i.paragraph.isInsideTable&&n.ownerTable.contains(i.paragraph.associatedCell)),e=n.ownerTable.previousRenderedWidget,f,o,s,h,l,a;i.paragraph.isInsideTable?(f=t.getContainerCellOf(n,i.paragraph.associatedCell),f.ownerTable.contains(i.paragraph.associatedCell)?(o=t.getSelectedCell(n,f),t.getSelectedCell(i.paragraph.associatedCell,f),t.containsCell(f,i.paragraph.associatedCell)?t.isCellSelected(f,i,r)?(this.updateEditPosition(f,t),1===u)?this.deleteCellsInTable(n.ownerRow.ownerTable,t,i,r,u):(s=this.deleteCell(f,t,u,!0),!s&&2!==u&&this.editorHistory?this.editorHistory.currentBaseHistoryInfo=void 0:s&&this.documentHelper.layout.reLayoutTable(f.ownerRow.ownerTable)):o===f?(this.deletePara(r.paragraph,i,r,u),this.delBlockContinue&&this.delBlock)&&(this.delSection&&(h=r.paragraph,l=_instanceof(h.bodyWidget,c)?h.bodyWidget:void 0,this.deleteSection(t,this.delSection,l,u),this.delSection=void 0),this.deleteBlock(this.delBlock,t,i,r,u),this.delBlockContinue=!1,this.delBlock=void 0):this.deleteContainer(o,t,i,r,u):2===u?this.deleteCell(n,t,2,!1):this.deleteCellsInTable(f.ownerTable,t,i,r,u)):this.deleteContainer(f,t,i,r,u)):(a=t.getContainerCell(n),this.deleteContainer(a,t,i,r,u));v&&(_instanceof(e.bodyWidget,c)&&e.bodyWidget,sf.base.isNullOrUndefined(e)||this.deleteBlock(e,t,i,r,u))},n.prototype.deleteCellsInTable=function(n,t,i,r,u,f){var h="Delete",o=!1,s=i.paragraph.associatedCell,e=r.paragraph.associatedCell;if(sf.base.isNullOrUndefined(f)||(e=f),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)){if(h=this.editorHistory.currentBaseHistoryInfo.action,o="BackSpace"===this.editorHistory.currentBaseHistoryInfo.action||"DeleteCells"===this.editorHistory.currentBaseHistoryInfo.action||"InsertTable"===this.editorHistory.currentBaseHistoryInfo.action||"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action||sf.base.isNullOrUndefined(s.ownerRow.previousWidget)&&sf.base.isNullOrUndefined(e.ownerRow.nextWidget)&&"Cut"===this.editorHistory.currentBaseHistoryInfo.action,this.cloneTableToHistoryInfo(n),"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)return;this.editorHistory.currentBaseHistoryInfo.action=o?"DeleteCells":"ClearCells";t.owner.isLayoutEnabled=!1}var c=s.columnIndex,l=e.columnIndex+e.cellFormat.columnSpan-1,v=s.rowIndex,y=e.rowIndex,a=this.isWholeRowSelected(s.ownerRow,c,l);this.owner.enableTrackChanges&&!this.skipTracking()?a&&this.onConfirmedTableCellsDeletion(n,t,v,y,c,l,o,u,a,h):this.onConfirmedTableCellsDeletion(n,t,v,y,c,l,o,u,a,h)},n.prototype.removeDeletedCellRevision=function(n){var i,s,r,t,f,e,o,h;for(n.rowFormat.revisions.length>0&&this.unlinkRangeFromRevision(n.rowFormat,!0),i=0;i<n.childWidgets.length;i++)for(s=n.childWidgets[i],r=0;r<s.childWidgets.length;r++)if(t=s.childWidgets[r],!sf.base.isNullOrUndefined(t)&&_instanceof(t,u)){for(f=0;f<t.childWidgets.length;f++)if(e=t.childWidgets[f],!sf.base.isNullOrUndefined(e.children))for(o=0;o<e.children.length;o++)h=e.children[o],h.revisions.length>0&&this.unlinkRangeFromRevision(h,!0);this.unlinkRangeFromRevision(t.characterFormat,!0)}},n.prototype.onConfirmedTableCellsDeletion=function(n,t,i,r,u,f,e,o,s,h){for(var l,w,v,a,y,p,c=0;c<n.childWidgets.length;c++)if(l=n.childWidgets[c],w=!1,l.index>=i&&l.index<=r&&(this.owner.enableTrackChanges&&!this.skipTracking()&&s?(w=this.trackRowDeletion(l,!1))&&this.onConfirmedCellDeletion(l,t,i,r,u,f,e,o):this.onConfirmedCellDeletion(l,t,i,r,u,f,e,o)),!w&&0===l.childWidgets.length){for(v=n.childWidgets[c],a=v.previousRenderedWidget;!sf.base.isNullOrUndefined(a);){for(y=0;y<a.childWidgets.length;y++)p=a.childWidgets[y],v.rowIndex<p.ownerRow.rowIndex+p.cellFormat.rowSpan&&p.cellFormat.rowSpan--;a=a.previousRenderedWidget}this.updateNextBlocksIndex(v,!1);n.childWidgets.splice(c,1);c--;r--}t.owner.isLayoutEnabled=!0;0===n.childWidgets.length?(t.editPosition=this.selection.getHierarchicalIndex(n,"0"),this.setActionInternal(t,h),this.removeBlock(n)):(n.isGridUpdated=!1,n.buildTableColumns(),n.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(n))},n.prototype.onConfirmedCellDeletion=function(n,t,i,r,u,f,e,o){var c=!1,s,h,l;for(this.removeDeletedCellRevision(n),s=0;s<n.childWidgets.length;s++)h=n.childWidgets[s],h.columnIndex>=u&&h.columnIndex<=f&&((c||(this.updateEditPosition(h,t),c=!0),e)?(l=n.childWidgets[s],this.updateNextBlocksIndex(l,!1),n.childWidgets.splice(s,1),s--):o<4&&this.deleteCell(h,t,o,!1))},n.prototype.removeRevisionForRow=function(n){n.rowFormat.revisions.length>0&&this.skipTracking()&&(this.unlinkRangeFromRevision(n.rowFormat,!0),this.addRemovedRevisionInfo(n.rowFormat,void 0))},n.prototype.removeRevisionsInRow=function(n){var t,i;if(n.rowFormat.revisions.length>0)for(t=0;t<n.rowFormat.revisions.length;t++)i=n.rowFormat.revisions[t],this.unlinkWholeRangeInRevision(n.rowFormat,i)},n.prototype.removeRevisionForCell=function(n,t){for(var s,e,h,o,r,i=0;i<n.childWidgets.length;i++)if(_instanceof(n.childWidgets[i],u))for(s=n.childWidgets[i],e=0;e<s.childWidgets.length;e++)for(h=s.childWidgets[e],o=0;o<h.children.length;o++)r=h.children[o],!sf.base.isNullOrUndefined(r)&&r.revisions.length>0&&(this.unlinkRangeFromRevision(r,t),this.addRemovedRevisionInfo(r,void 0));else _instanceof(n.childWidgets[i],f)&&this.removeRevisionForInnerTable(n.childWidgets[i])},n.prototype.removeRevisionForInnerTable=function(n){var t,i;if(n.childWidgets.length>0)for(t=0;t<n.childWidgets.length;t++)i=n.childWidgets[t],sf.base.isNullOrUndefined(i)||this.removeRevisionForRow(i)},n.prototype.removeRevisionForBlock=function(n,t,i,r){var f,o,e,u;if(n.characterFormat.revisions.length>0&&!i&&(r&&this.addRemovedRevisionInfo(n.characterFormat,void 0,!1),sf.base.isNullOrUndefined(t)?this.unlinkRangeFromRevision(n.characterFormat,!0):this.unlinkRangeByRevision(n.characterFormat,t),n.characterFormat.revisions=[]),!sf.base.isNullOrUndefined(n))for(f=0;f<n.childWidgets.length;f++)for(o=n.childWidgets[f],e=0;e<o.children.length;e++)u=o.children[e],!sf.base.isNullOrUndefined(u)&&u.revisions.length>0&&(r&&this.addRemovedRevisionInfo(u,void 0,!1),sf.base.isNullOrUndefined(t)?this.unlinkRangeFromRevision(u,!0):this.unlinkRangeByRevision(u,t),u.revisions=[])},n.prototype.unlinkRangeByRevision=function(n,t){for(var r,u,i=0;i<n.revisions.length;i++)r=n.revisions[i],r.author===t.author&&r.revisionType===t.revisionType&&(n.revisions.splice(n.revisions.indexOf(t),1),u=t.range.indexOf(n),t.range.splice(u,1))},n.prototype.isWholeRowSelected=function(n,t,i){var r=t+i;return 0===t&&n.childWidgets.length-1===r},n.prototype.deleteCell=function(n,t,i){var e=n.childWidgets[0],f=[],h,o,r,c,s,l;if(1===n.childWidgets.length&&_instanceof(e,u)&&e.isEmpty())return!1;for(h=0;h<n.childWidgets.length;h++)if(e=n.childWidgets[h],i<4){if(_instanceof(e,u)&&1===n.childWidgets.length){for(o=e,f=this.paragrapghBookmarkCollection(o,f),r=0;r<o.childWidgets.length;r++){for(c=o.childWidgets[r],s=0;s<c.children.length;s++)l=c.children[s],this.unLinkFieldCharacter(l),c.children.splice(s,1),s--,this.checkClearCells(t)&&this.addRemovedNodes(l);o.childWidgets.length>1&&(o.childWidgets.splice(r,1),r--)}this.checkClearCells(t)&&(t.editPosition=this.selection.getHierarchicalIndex(o,"0"),this.updateHistoryPosition(t.editPosition,!0));break}_instanceof(e,u)&&(f=this.paragrapghBookmarkCollection(e,f));this.removeBlock(e);h--;this.checkClearCells(t)&&this.addRemovedNodes(e)}for(r=0;r<f.length;r++)n.childWidgets[0].childWidgets[0].children.push(f[r]),n.childWidgets[0].childWidgets[0].children.push(f[r].reference),f[r].line=n.childWidgets[0].childWidgets[0],f[r].reference.line=n.childWidgets[0].childWidgets[0],this.documentHelper.bookmarks.add(f[r].name,f[r]);return!0},n.prototype.paragrapghBookmarkCollection=function(n,t){for(var u,r=this.documentHelper.bookmarks,i=0;i<r.length;i++)u=this.documentHelper.bookmarks.get(r.keys[i]),u.paragraph===n&&t.push(u);return t},n.prototype.deleteContainer=function(n,t,i,r,u){var f=n.ownerTable,e,s,o;if(t.containsRow(f.lastChild,r.paragraph.associatedCell))this.deleteContent(f,t,u);else if(this.toCheckForTrack(f)){for(e=0;e<f.childWidgets.length;e++)if(s=f.childWidgets[e],this.trackRowDeletion(s),r.paragraph.isInsideTable&&t.containsRow(s,r.paragraph.associatedCell))return void this.documentHelper.layout.reLayoutTable(f)}else for(e=0;e<f.childWidgets.length;e++)if(o=f.childWidgets[e],u<4&&(this.updateNextBlocksIndex(o,!1),f.childWidgets.splice(e,1),this.addRemovedNodes(o),e--),r.paragraph.isInsideTable&&t.containsRow(o,r.paragraph.associatedCell))return void this.documentHelper.layout.reLayoutTable(f)},n.prototype.deleteTableBlock=function(n,t,i,r,f){var s,h,a,e,l,o;if(n=n.combineWidget(this.owner.viewer),i.paragraph.isInsideTable&&n.contains(i.paragraph.associatedCell))s=n.previousRenderedWidget,h=this.checkAndInsertBlock(n,i,r,f,_instanceof(s,u)?s:void 0),t.containsRow(n.firstChild,i.paragraph.associatedCell)?this.deleteContent(n,t,f):this.owner.enableTrackChanges?sf.base.isNullOrUndefined(r.paragraph.associatedCell)&&!r.paragraph.isInsideTable&&(a=r.paragraph.previousRenderedWidget.lastChild.lastChild,this.deleteCellsInTable(n,t,i,r,f,a)):(e=this.splitTable(n,i.paragraph.associatedCell.ownerRow),this.deleteContent(n,t,f),this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1)),sf.base.isNullOrUndefined(h)||(t.editPosition=this.selection.getHierarchicalIndex(h,"0"),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=t.editPosition));else{if(l=n.previousRenderedWidget,_instanceof(n.bodyWidget,c)&&n.bodyWidget,this.owner.enableTrackChanges)for(o=0;o<n.childWidgets.length;o++)this.trackRowDeletion(n.childWidgets[o]);else this.deleteContent(n,t,f);sf.base.isNullOrUndefined(l)||this.deleteBlock(l,t,i,r,f)}},n.prototype.splitTable=function(n,t){var i=new f,r,u,e;for(i.tableFormat.copyFormat(n.tableFormat),i.index=n.index,r=0;r<n.childWidgets.length;r++){if(u=n.childWidgets[r],u===t)break;i.childWidgets.push(u);u.containerWidget=i;n.childWidgets.splice(r,1);r--}return e=n.getIndex(),n.containerWidget.childWidgets.splice(e,0,i),i.containerWidget=n.containerWidget,this.updateNextBlocksIndex(i,!0),i},n.prototype.updateEditPosition=function(n,t){var i=t.getFirstParagraphInCell(n);t.editPosition=this.selection.getHierarchicalIndex(i,"0")},n.prototype.deleteContent=function(n,t,i){i<4&&(this.removeBlock(n),this.addRemovedNodes(n))},n.prototype.setActionInternal=function(n,t){this.documentHelper.owner.enableHistoryMode&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.action=t)},n.prototype.checkClearCells=function(){return this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&"ClearCells"!==this.editorHistory.currentBaseHistoryInfo.action},n.prototype.isEndInAdjacentTable=function(n,t){var i=this.selection.getHierarchicalIndex(n,""),r=this.selection.getHierarchicalIndex(t,""),u=i.split(";"),f=r.split(";");return u.length<f.length},n.prototype.cloneTableToHistoryInfo=function(n){if(this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)){var t=n.clone();return this.editorHistory.currentBaseHistoryInfo.removedNodes.push(t),this.documentHelper.selection.start.paragraph.isInsideTable&&this.documentHelper.selection.start.paragraph.associatedCell.ownerTable===n&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(n,"0"),!0),t}},n.prototype.insertParagraphPaste=function(n,t,i,r,u,f){var e,s,o,h,c;if(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action&&(e=this.selection.getNextParagraphBlock(t),e&&i.offset>0&&e===r.paragraph&&n===i.paragraph&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action)){for(s=0,this.removeBlock(t),this.documentHelper.layout.clearListElementBox(e),this.documentHelper.layout.clearListElementBox(t),o=0;o<t.childWidgets.length;o++)h=t.childWidgets[o],e.childWidgets.splice(s,0,h),t.childWidgets.splice(o,1),o--,s++,h.paragraph=e;this.documentHelper.layout.reLayoutParagraph(e,0,0);u=!1;c=this.selection.editPosition.substring(this.selection.editPosition.lastIndexOf(";")+1);this.selection.editPosition=this.selection.getHierarchicalIndex(e,c)}u&&this.deleteParagraphMark(t,this.selection,f)},n.prototype.removeInlines=function(n,t,i,r,u,f){var o=!1,e,l;this.documentHelper.layout.clearListElementBox(n);n.childWidgets.indexOf(t);for(var h=this.selection.start.clone(),s=this.selection.end.clone(),a=this.selection.editPosition,c=n.childWidgets.length-1;c>=0;c--){if(e=n.childWidgets[c],t===e&&r===e){this.removeContent(e,i,u,f);o=!0;break}if(r===e)o=!0,this.removeContent(e,0,u,f);else{if(t===e){this.removeContent(e,i,this.documentHelper.selection.getLineLength(e),f);break}o&&this.removeContent(e,0,this.documentHelper.selection.getLineLength(e),f)}}this.owner.enableTrackChanges&&!this.skipTracking()&&((this.selection.start.setPositionInternal(h),this.selection.end.setPositionInternal(s),this.editorHistory.currentBaseHistoryInfo&&"Delete"===this.editorHistory.currentBaseHistoryInfo.action)&&(h.offset>s.offset&&(s=h),l=this.selection.getParagraphInfo(s),a=this.selection.getHierarchicalIndex(l.paragraph,l.offset.toString())),this.skipReplace&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=void 0,this.updateInsertPosition()),this.selection.editPosition=a);o&&(this.removeEmptyLine(n),this.documentHelper.layout.reLayoutParagraph(n,0,0))},n.prototype.skipTracking=function(){return!(sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing)||!(sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action&&"Accept Change"!==this.editorHistory.currentBaseHistoryInfo.action)},n.prototype.canHandleDeletion=function(){return!(sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"DeleteRow"!==this.editorHistory.currentBaseHistoryInfo.action)},n.prototype.removeContent=function(n,t,u,f){for(var o,b,k,l,a,y,v,d,s=this.selection.getLineLength(n),p=n.paragraph.paragraphFormat.bidi,w=void 0,c=0,nt=void 0,h=p?0:n.children.length-1;p?h<n.children.length:h>=0;p?h++:h--){if(o=n.children[h],sf.base.isNullOrUndefined(f)||2!==f)for(b=0;b<n.children.length;b++)k=n.children[b],_instanceof(k,i)&&(l=k.text,l.length+c>t&&!(c>t)&&(w=l[t-c-1],sf.base.isNullOrUndefined(w)&&t-c==0&&(w=nt)),l.length+c>u&&(" "===l[u-c]&&0===t||" "===w&&" "===l[u-c])&&(u+=1),nt=l[l.length-1]),c+=k.length;if(u<=s-o.length)s-=o.length;else{if(a=o.length,s>u&&s-a<u&&(a=u-(s-o.length)),y=0,(s-o.length<t&&(y=t-(s-o.length)),s>u&&(s-=o.length-a),0===y&&a===o.length)?((this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)||_instanceof(o,e)&&this.removedBookmarkElements.push(o),_instanceof(o,g)&&0===o.commentType&&(o.comment.ownerComment?this.deleteCommentWidget(o.comment.ownerComment):this.deleteCommentWidget(o.comment)),_instanceof(o,e)&&this.documentHelper.bookmarks.containsKey(o.name)&&this.documentHelper.bookmarks.remove(o.name),_instanceof(o,lt)&&"Inline"!==o.textWrappingStyle&&this.removeAutoShape(o),this.skipFieldDeleteTracking&&o.revisions.length>0)&&(v=o,_instanceof(v,r)&&(1!==v.fieldType&&2!==v.fieldType||(v=v.fieldBegin),this.clearFieldElementRevisions(v,o.revisions))),this.canHandleDeletion()||this.owner.enableTrackChanges&&!this.skipTracking()&&!this.skipFieldDeleteTracking?(this.skipTableElements||this.addRemovedNodes(o.clone()),this.handleDeleteTracking(o,t,u,h)):(this.unLinkFieldCharacter(o),this.unlinkRangeFromRevision(o,!0),this.addRemovedRevisionInfo(o,void 0),this.addRemovedNodes(o),n.children.splice(h,1),p&&this.isSkipHistory&&h--),p&&this.isSkipHistory&&h--):_instanceof(o,i)&&(d=this.handleDeleteTracking(o,y,a),sf.base.isNullOrUndefined(d)||this.skipTableElements||(o.revisions.length>0&&this.addRemovedRevisionInfo(o,d),this.addRemovedNodes(d))),_instanceof(o,yt)&&("Footnote"===o.footnoteType?this.removeFootnote(o):this.removeEndnote(o)),t>=s-(a-y))break;s-=a-y}}},n.prototype.skipCommentCharacter=function(n){var t=this.editorHistory.currentBaseHistoryInfo,e=t.insertPosition,o=t.selectionStart,s=t.selectionEnd,f,u,r,i;(!this.editorHistory.currentBaseHistoryInfo||this.editorHistory.currentHistoryInfo||this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.initComplexHistory("SkipCommentInline"),this.editorHistory.updateHistory(),this.initHistory(t.action)),!this.editorHistory.currentHistoryInfo||"DeleteComment"===this.editorHistory.currentHistoryInfo.action||this.editorHistory.isUndoing||this.editorHistory.isRedoing)||(f=n.line.getOffset(n,1),u=new l(this.owner),u.setPositionParagraph(n.line,f),r=this.selection.getHierarchicalIndexByPosition(u),this.selection.isForward?(this.editorHistory.currentBaseHistoryInfo.selectionEnd=r,t.selectionStart=r,this.editorHistory.currentHistoryInfo.selectionEnd=t.selectionEnd):(this.editorHistory.currentBaseHistoryInfo.selectionStart=r,t.selectionEnd=r,this.editorHistory.currentHistoryInfo.selectionStart=t.selectionStart),t.insertPosition=this.selection.isForward?t.selectionStart:t.selectionEnd,t.endPosition=t.insertPosition,this.editorHistory.currentHistoryInfo.insertPosition=t.insertPosition,i=this.editorHistory.currentBaseHistoryInfo,i.insertPosition=this.selection.isForward?i.selectionStart:i.selectionEnd,i.endPosition=i.insertPosition,this.editorHistory.currentHistoryInfo.addModifiedAction(i),this.editorHistory.currentBaseHistoryInfo.insertPosition=e,this.editorHistory.currentBaseHistoryInfo.selectionStart=o,this.editorHistory.currentBaseHistoryInfo.selectionEnd=s)},n.prototype.clearFieldElementRevisions=function(n,t){for(var i,u,o,e=t,f=0;f<e.length;f++)for(i=e[f],u=0;u<i.range.length;u++)if(i.range[u]===n)for(o=u;o<i.range.length;o){if(_instanceof(i.range[u],r)&&1===i.range[u].fieldType&&i.range[u].fieldBegin===n){i.removeRangeRevisionForItem(i.range[u]);0===i.range.length&&this.owner.revisions.remove(i);break}i.removeRangeRevisionForItem(i.range[u])}},n.prototype.addRemovedRevisionInfo=function(n,t,i){for(var u,r=0;r<n.revisions.length;r++)u=n.revisions[r].revisionID,sf.base.isNullOrUndefined(t)?n.removedIds.push(u):t.removedIds.push(u);sf.base.isNullOrUndefined(t)&&(sf.base.isNullOrUndefined(i)||i)&&(n.revisions=[])},n.prototype.removeEmptyLine=function(n){if(n.childWidgets.length>1)for(var t=0;t<n.childWidgets.length;t++)0===n.childWidgets[t].children.length&&n.childWidgets.length>1&&(n.childWidgets.splice(t,1),t--)},n.prototype.cloneListLevel=function(n){var t=new li(void 0);return this.copyListLevel(t,n),t},n.prototype.copyListLevel=function(n,t){sf.base.isNullOrUndefined(t.paragraphFormat)||(n.paragraphFormat=new ut(n),n.paragraphFormat.copyFormat(t.paragraphFormat));sf.base.isNullOrUndefined(t.characterFormat)||(n.characterFormat=new p(n),n.characterFormat.copyFormat(t.characterFormat));sf.base.isNullOrUndefined(t.followCharacter)||(n.followCharacter=t.followCharacter);sf.base.isNullOrUndefined(t.listLevelPattern)||(n.listLevelPattern=t.listLevelPattern);sf.base.isNullOrUndefined(t.numberFormat)||(n.numberFormat=t.numberFormat);sf.base.isNullOrUndefined(t.restartLevel)||(n.restartLevel=t.restartLevel);sf.base.isNullOrUndefined(t.startAt)||(n.startAt=t.startAt)},n.prototype.cloneLevelOverride=function(n){var t=new nr;return sf.base.isNullOrUndefined(n.startAt)||(t.startAt=n.startAt),sf.base.isNullOrUndefined(n.overrideListLevel)||(t.overrideListLevel=n.overrideListLevel),sf.base.isNullOrUndefined(n.levelNumber)||(t.levelNumber=n.levelNumber),t},n.prototype.updateListParagraphs=function(){var n,i,t;for(this.documentHelper.listParagraphs=[],n=0;n<this.documentHelper.pages.length;n++)for(i=this.documentHelper.pages[n].bodyWidgets[0],t=0;t<i.childWidgets.length;t++)this.updateListParagraphsInBlock(i.childWidgets[t])},n.prototype.updateListParagraphsInBlock=function(n){var t,i,e,r;if(_instanceof(n,u))sf.base.isNullOrUndefined(n.paragraphFormat)||sf.base.isNullOrUndefined(n.paragraphFormat.listFormat)||sf.base.isNullOrUndefined(n.paragraphFormat.listFormat.listId)||(sf.base.isNullOrUndefined(this.documentHelper.listParagraphs)&&(this.documentHelper.listParagraphs=[]),this.documentHelper.listParagraphs.push(n));else if(_instanceof(n,f))for(t=0;t<n.childWidgets.length;t++)for(i=0;i<n.childWidgets[t].childWidgets.length;i++)for(e=n.childWidgets[t].childWidgets[i],r=0;r<e.childWidgets.length;r++)this.updateListParagraphsInBlock(e.childWidgets[r])},n.prototype.onApplyList=function(n){var t=this.documentHelper.selection,i;this.setOffsetValue(this.documentHelper.selection);this.initHistory("ListFormat");i=new ai;sf.base.isNullOrUndefined(n)||(i.listId=n.listId);this.documentHelper.owner.isShiftingEnabled=!0;t.isEmpty?(this.applyParaFormatProperty(t.start.paragraph,"listFormat",i,!1),this.layoutItemBlock(t.start.paragraph,!1)):this.updateSelectionParagraphFormatting("listFormat",i,!1);this.reLayout(t)},n.prototype.applyBulletOrNumbering=function(n,t,i){var o=this.documentHelper.selection,e=o.paragraphFormat.getList(),a=!1,v=o.start,r,l,s,f,w;if(o.isForward||(v=o.end),r=v.paragraph,sf.base.isNullOrUndefined(e)){for(;!sf.base.isNullOrUndefined(r.previousWidget)&&_instanceof(r.previousWidget,u)&&r.previousWidget.isEmpty()&&-1===r.previousWidget.paragraphFormat.listFormat.listId;)r=r.previousWidget;if(r.previousWidget&&_instanceof(r.previousWidget,u)&&-1!==r.previousWidget.paragraphFormat.listFormat.listId&&(r=r.previousWidget,e=this.documentHelper.getListById(r.paragraphFormat.listFormat.listId),a=!0),!a){for(;!sf.base.isNullOrUndefined(r.nextWidget)&&_instanceof(r.nextWidget,u)&&r.nextWidget.isEmpty()&&-1===r.nextWidget.paragraphFormat.listFormat.listId;)r=r.nextWidget;r.nextWidget&&_instanceof(r.nextWidget,u)&&-1!==r.nextWidget.paragraphFormat.listFormat.listId&&(r=r.nextWidget,e=this.documentHelper.getListById(r.paragraphFormat.listFormat.listId),a=!0)}}var h=void 0,c=-1,y=void 0,p=!1;if((-1===r.paragraphFormat.listFormat.listId||sf.base.isNullOrUndefined(r.paragraphFormat.listFormat.listLevel)||(this.listNumberFormat=r.paragraphFormat.listFormat.listLevel.numberFormat,this.listLevelPattern=r.paragraphFormat.listFormat.listLevel.listLevelPattern,this.listLevelNumber=r.paragraphFormat.listFormat.listLevelNumber),!sf.base.isNullOrUndefined(e))&&(c=r.paragraphFormat.listFormat.listLevelNumber,l=this.documentHelper.getListById(r.paragraphFormat.listFormat.listId),h=this.documentHelper.layout.getListLevel(l,c),c>0&&(y=this.documentHelper.layout.getListLevel(l,0),p=!sf.base.isNullOrUndefined(y)&&c>0&&o.start.isInSameParagraph(o.end)),(s=l.abstractList)||(s=this.documentHelper.getAbstractListById(e.abstractListId)),0===s.levels.length&&(h=this.documentHelper.layout.getListLevel(l,r.paragraphFormat.listFormat.listLevelNumber)),a)){if("Bullet"!==t&&h.listLevelPattern===t&&(h.numberFormat===n||-1!==h.numberFormat.indexOf(n)))return o.paragraphFormat.listId=e.listId,o.paragraphFormat.listLevelNumber=c,void o.paragraphFormat.setList(e);h=s.levels[0]}sf.base.isNullOrUndefined(e)||!sf.base.isNullOrUndefined(e)&&0===c&&(h.listLevelPattern!==t||h.numberFormat!==n||h.characterFormat.fontFamily!==i&&"Bullet"===h.listLevelPattern)?(a=!1,e=new pi,e.listId=this.documentHelper.lists.length>0?this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1:0,s=new wi,(s.abstractListId=this.documentHelper.abstractLists.length>0?this.documentHelper.abstractLists[this.documentHelper.abstractLists.length-1].abstractListId+1:0,e.abstractListId=s.abstractListId,e.abstractList=s,this.documentHelper.abstractLists.push(s),"bullet"===n||"multiLevel"===n||"numbering"===n)?this.addListLevels(s,n,o):((f=new li(s)).listLevelPattern=t,f.numberFormat=n,"Bullet"!==t?f.startAt=1:f.characterFormat.fontFamily=i,f.paragraphFormat.leftIndent=36,f.paragraphFormat.firstLineIndent=-18,s.levels.push(f),o.paragraphFormat.listLevelNumber=0),o.paragraphFormat.setList(e)):p&&!sf.base.isNullOrUndefined(e)?(l=this.documentHelper.getListById(r.paragraphFormat.listFormat.listId),f=this.documentHelper.layout.getListLevel(l,c),"Bullet"===t?(f.numberFormat=n,f.characterFormat.fontFamily=i):(f.listLevelPattern=t,f.characterFormat.fontFamily=i,w=f.numberFormat.substring(f.numberFormat.length-1),f.numberFormat.length!==n.length&&c>0?f.numberFormat=n:n.substring(n.length-1)!==f.numberFormat.substring(f.numberFormat.length-1)&&(f.numberFormat=f.numberFormat.replace(w,n.substring(n.length-1)))),o.paragraphFormat.setList(l)):!sf.base.isNullOrUndefined(e)&&a?o.paragraphFormat.setList(e):o.paragraphFormat.setList(void 0)},n.prototype.addListLevels=function(n,t,i){for(var u,f,e=["","","","",""],r=n.levels.length;r<9;r++){if(u=new li(n),t.match("bullet"))u.listLevelPattern="Bullet",u.numberFormat=e[r<5?r%5:r%5+1],u.characterFormat.fontFamily=r<3||5===r?"Wingdings":"Symbol";else{if(t.match("multiLevel")){for(f=0;f<r+1;f++)u.numberFormat+="%"+(f+1).toString()+".";u.listLevelPattern="Number"}else u.numberFormat="%"+(r+1).toString()+")",u.listLevelPattern=r%3==0?"Number":r%3==1?"LowLetter":"LowRoman";u.startAt=1;u.restartLevel=r}u.paragraphFormat.leftIndent=0===r?36:36*r;u.paragraphFormat.firstLineIndent=-18;n.levels.push(u);i.paragraphFormat.listLevelNumber=r}},n.prototype.insertPageBreak=function(){if(!this.owner.isReadOnlyMode){if(this.documentHelper.selection.start.paragraph.isInsideTable||this.documentHelper.selection.start.paragraph.isInHeaderFooter)return;this.initComplexHistory("PageBreak");this.onEnter(!0);this.editorHistory&&null!==this.editorHistory.currentHistoryInfo&&this.editorHistory.updateComplexHistory();this.selection.checkForCursorVisibility()}},n.prototype.onEnter=function(n){var a,t=this.documentHelper.selection,v,y,p,b,o,r,s,h,w,c,e,l,f;if((sf.base.isNullOrUndefined(t.start.paragraph.paragraphFormat.baseStyle)||"Normal"===t.start.paragraph.paragraphFormat.baseStyle.name)&&(a=new au(void 0)).cloneFormat(this.selection.characterFormat),!this.isXmlMapped){if(t.isEmpty){if(v=t.getHyperlinkField(),!sf.base.isNullOrUndefined(v))return void t.fireRequestNavigate(v);if((f=t.start.paragraph).isEmpty()&&-1!==f.paragraphFormat.listFormat.listId)return void this.onApplyListInternal(this.documentHelper.getListById(f.paragraphFormat.listFormat.listId),f.paragraphFormat.listFormat.listLevelNumber-1)}if(this.initHistory("Enter"),y=!0,t.isEmpty||(y=this.removeSelectedContents(t)),y){if(t.owner.isShiftingEnabled=!0,this.updateInsertPosition(),p=this.selection.getParagraphInfo(t.start),b=this.selection.getHierarchicalIndex(p.paragraph,p.offset.toString()),(this.splitParagraphInternal(t,t.start.paragraph,t.start.currentWidget,t.start.offset),this.setPositionForCurrentIndex(t.start,b),n)&&(o=t.start.paragraph,r=new u,r.characterFormat.copyFormat(o.characterFormat),r.paragraphFormat.copyFormat(o.paragraphFormat),s=new i,s.text="\f",h=new k(r),(h.children.push(s),s.line=h,r.childWidgets.push(h),this.owner.enableTrackChanges&&o.characterFormat.revisions.length>0)&&(w=this.retrieveRevisionInOder(o.characterFormat),w.range.push(r.characterFormat),r.characterFormat.revisions.push(w),r.characterFormat.removedIds=[]),this.insertParagraph(r,!0),t.selectParagraphInternal(r,!0)),c=t.start.paragraph.nextWidget,sf.base.isNullOrUndefined(c)&&(c=t.getNextRenderedBlock(t.start.paragraph)),t.selectParagraphInternal(c,!0),this.updateEndPosition(),n&&this.editorHistory&&this.owner.editorHistory.updateHistory(),this.reLayout(t),e=this.selection.start.paragraph.containerWidget.firstChild,!sf.base.isNullOrUndefined(e))for(e.isChangeDetected=!1,l=e.nextRenderedWidget;this.owner.isSpellCheck&&!sf.base.isNullOrUndefined(l);)(e=l).isChangeDetected=!1,l=e.nextRenderedWidget;f=t.start.paragraph.previousWidget;sf.base.isNullOrUndefined(f)||f.isEmpty()||!_instanceof(f.lastChild.children[f.lastChild.children.length-1],i)||this.checkAndConvertToHyperlink(t,!0,f)}sf.base.isNullOrUndefined(a)||sf.base.isNullOrUndefined(t.start.paragraph)||!t.start.paragraph.isEmpty()||(this.selection.isRetrieveFormatting=!0,this.selection.characterFormat.cloneFormat(a),this.selection.isRetrieveFormatting=!1)}},n.prototype.splitParagraphInternal=function(n,t,i,r){var h=0,c=t.index,o=t,f,l,e,a,v,s;for(o.isChangeDetected=0===r;this.owner.isSpellCheck&&!sf.base.isNullOrUndefined(o.nextRenderedWidget);)(o=o.nextRenderedWidget).isChangeDetected=!0;f=new u;l=new k(f);(f.childWidgets.push(l),f.paragraphFormat.ownerBase=f,f.footNoteReference=t.footNoteReference,i===t.lastChild&&r===n.getLineLength(i))?((t.paragraphFormat.baseStyle&&"Normal"!==t.paragraphFormat.baseStyle.name&&_instanceof(t.paragraphFormat.baseStyle.next,fi)?(t.paragraphFormat.baseStyle.name===t.paragraphFormat.baseStyle.next.name?(f.paragraphFormat.copyFormat(t.paragraphFormat),f.characterFormat.copyFormat(t.characterFormat)):f.paragraphFormat.baseStyle=t.paragraphFormat.baseStyle.next,this.selection.skipFormatRetrieval=!1):(f.paragraphFormat.copyFormat(t.paragraphFormat),f.characterFormat.copyFormat(t.characterFormat)),t.lastChild.children.length>0&&t.characterFormat.copyFormat(t.lastChild.children[t.lastChild.children.length-1].characterFormat),this.owner.enableTrackChanges)&&(e=t.lastChild,!sf.base.isNullOrUndefined(e)&&e.children.length>0&&(a=e.children[e.children.length-1].previousValidNodeForTracking,this.checkParaMarkMatchedWithElement(a,t.characterFormat,!1,"Insertion")||this.insertParaRevision(t))),h++,c++):((f.paragraphFormat.copyFormat(t.paragraphFormat),f.characterFormat.copyFormat(t.characterFormat),r>0||!i.isFirstLine())?(t=t.combineWidget(this.owner.viewer),this.moveInlines(t,f,0,0,t.firstChild,r,i),this.insertParaRevision(f,t.firstChild)):this.owner.enableTrackChanges&&(v=t.firstChild.children[0].previousValidNodeForTracking,this.checkParaMarkMatchedWithElement(v,f.characterFormat,!0,"Insertion")||this.insertParaRevision(f)),t=t.getSplitWidgets()[0]);h+=t.getIndex();s=t.containerWidget;s.childWidgets.splice(h,0,f);this.owner.enableTrackChanges&&0===f.characterFormat.revisions.length&&0===t.characterFormat.revisions.length&&(this.checkToMatchEmptyParaMark(t)||this.insertParaRevision(t));f.containerWidget=s;f.index=c;this.updateNextBlocksIndex(f,!0);this.documentHelper.layout.layoutBodyWidgetCollection(c,s,f,!1)},n.prototype.insertParaRevision=function(n,t){if(this.owner.enableTrackChanges&&sf.base.isNullOrUndefined(t)&&!this.isRevisionMatched(n.characterFormat,"Insertion")&&(n.characterFormat.revisions=[],this.insertRevision(n.characterFormat,"Insertion")),!sf.base.isNullOrUndefined(t)){if(t.paragraph.isInsideTable)return void this.insertRevision(n.characterFormat,"Insertion");this.applyRevisionForParaMark(n,t,"Insertion",!0)}},n.prototype.applyRevisionForParaMark=function(n,t,i,r){var u=t.children[0];if(!sf.base.isNullOrUndefined(u)){u=u.nextValidNodeForTracking;var s=n.lastChild,f=0===s.children.length?void 0:s.children[s.children.length-1].previousValidNodeForTracking,e=!1,l=n.characterFormat.revisions.length;if(sf.base.isNullOrUndefined(f)||(e=this.checkParaMarkMatchedWithElement(f,n.characterFormat,!1,i)),!sf.base.isNullOrUndefined(u))if(n.characterFormat.revisions.length>l){if(this.isRevisionMatched(u,i))for(var h=n.characterFormat.revisions[0],c=this.getMatchedRevisionsToCombine(u.revisions,i),o=0;o<c.length;o++)c[o]!==h&&(e=!0,this.clearAndUpdateRevisons(c[o].range,h,h.range.indexOf(n.characterFormat)+1))}else e=this.checkParaMarkMatchedWithElement(u,n.characterFormat,!0,i);!e&&(this.owner.enableTrackChanges||t.paragraph.characterFormat.revisions.length>0)&&(this.insertRevision(n.characterFormat,i),r&&f.revisions.length>0&&u.revisions.length>0&&this.updateRevisionForSpittedTextElement(f,u))}},n.prototype.checkParaMarkMatchedWithElement=function(n,t,i,r){var u=this.getMatchedRevisionsToCombine(n.revisions,r);return u.length>0&&(this.mapMatchedRevisions(u,n,t,i),!0)},n.prototype.checkToMatchEmptyParaMark=function(n){var t=n.previousRenderedWidget,i;return!sf.base.isNullOrUndefined(t)&&_instanceof(t,u)&&t.characterFormat.revisions.length>0&&(i=this.getMatchedRevisionsToCombine(t.characterFormat.revisions,"Insertion"),i.length>0)?(this.mapMatchedRevisions(i,t.characterFormat,n.characterFormat,!1),!0):!1},n.prototype.updateNextBlocksIndex=function(n,t){var u=n.containerWidget.childWidgets.indexOf(n)+1,b,r,o,h,k,w,l,i,e,v,g;if(_instanceof(n.containerWidget,c))for(b=n.containerWidget.index,r=this.documentHelper.pages.indexOf(n.containerWidget.page);r<this.documentHelper.pages.length;r++){if(o=this.documentHelper.pages[r],o.bodyWidgets[0].index!==b)return;for(h=u;h<o.bodyWidgets[0].childWidgets.length;h++)k=o.bodyWidgets[0].childWidgets[h],this.updateIndex(k,t);u=0}else if(_instanceof(n.containerWidget,s))for(var y=n.containerWidget.getSplitWidgets(),d=y.indexOf(n.containerWidget),p=d;p<y.length;p++){for(w=y[p].childWidgets,l=u;l<w.length;l++)this.updateIndex(w[l],t);d=0;u=0}else if(_instanceof(n.containerWidget,a))for(i=u;i<n.containerWidget.childWidgets.length;i++)(v=n.containerWidget.childWidgets[i]).rowIndex===n.containerWidget.index&&this.updateIndex(v,t);else if(_instanceof(n.containerWidget,f))for(i=u;i<n.containerWidget.childWidgets.length;i++)for(e=n.containerWidget.childWidgets[i],this.updateIndex(e,t),r=0;r<e.childWidgets.length;r++)(v=e.childWidgets[r]).rowIndex=e.index,v.index=r;else if(_instanceof(n.containerWidget,ct)||_instanceof(n.containerWidget,et)||_instanceof(n.containerWidget,it))for(i=u;i<n.containerWidget.childWidgets.length;i++)g=n.containerWidget.childWidgets[i],this.updateIndex(g,t)},n.prototype.updateIndex=function(n,t){t?n.index++:n.index--},n.prototype.updateEndPosition=function(){var n=this.documentHelper.selection;this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.updateHistoryPosition(n.start,!1)},n.prototype.onBackSpace=function(){var n,t;this.removeEditRange=!0;n=this.documentHelper.selection;(this.documentHelper.triggerSpellCheck=!0,n.isEmpty)?this.singleBackspace(n,!1):(this.initHistory("BackSpace"),t=this.deleteSelectedContents(n,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(t?this.editorHistory.currentBaseHistoryInfo=void 0:(this.checkEndPosition(n)&&this.updateHistoryPosition(n.end,!1),this.reLayout(n),this.insertSpaceInFormField())),this.documentHelper.triggerSpellCheck=!1);this.removeEditRange=!1;this.updateXmlMappedContentControl()},n.prototype.insertRemoveBookMarkElements=function(){for(var n,t,f,e,i,u=!1,r=0;r<this.removedBookmarkElements.length;r++)n=this.removedBookmarkElements[r],0===n.bookmarkType?(this.documentHelper.bookmarks.containsKey(n.name)||this.documentHelper.bookmarks.add(n.name,n),t=n,t&&t.reference&&-1!==this.removedBookmarkElements.indexOf(t.reference)?(f=this.removedBookmarkElements.indexOf(t.reference),e=this.removedBookmarkElements.indexOf(t),this.removedBookmarkElements.splice(f,1),this.removedBookmarkElements.splice(e,1),r--):(this.editorHistory.currentBaseHistoryInfo&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(t.clone()),this.editorHistory.currentHistoryInfo&&(this.editorHistory.updateComplexHistory(),u=!0))):(i=n,i&&i.reference&&-1!==this.removedBookmarkElements.indexOf(i.reference)?(f=this.removedBookmarkElements.indexOf(i.reference),e=this.removedBookmarkElements.indexOf(i),this.removedBookmarkElements.splice(f,1),this.removedBookmarkElements.splice(e,1),r--):(this.editorHistory.currentBaseHistoryInfo&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(i.clone()),this.editorHistory.currentHistoryInfo&&(this.editorHistory.updateComplexHistory(),u=!0)));return this.removedBookmarkElements=[],u},n.prototype.deleteSelectedContents=function(n,t){var i=this.deleteSelectedContentInternal(n,t,n.start,n.end),r=n.getTextPosBasedOnLogicalIndex(n.editPosition);return n.selectContent(r,!0),i},n.prototype.removeWholeElement=function(n){this.initHistory("BackSpace");this.deleteSelectedContents(n,!0);this.checkEndPosition(n)&&this.updateHistoryPosition(n.end,!1);this.reLayout(n)},n.prototype.singleBackspace=function(n,f){var p=this.editorHistory,a,h,c,rt,k,d,v,b,at,vt,ut,nt;if(p&&!f&&!p.canRedo()&&p.canUndo()){var tt=p.undoStack[p.undoStack.length-1],ft=this.selection.getParagraphInfo(n.start),et=this.selection.getParagraphInfo(n.end);if("AutoFormatHyperlink"===tt.action&&tt.insertPosition===this.selection.getHierarchicalIndex(ft.paragraph,ft.offset.toString())&&tt.endPosition===this.selection.getHierarchicalIndex(et.paragraph,et.offset.toString()))return void p.undo()}var it=!1,s=n.start.paragraph,pt=n.start.currentWidget,l=n.start.offset,st=0,ct=pt.getInline(l,st),o=ct.element;if(this.selection.isInlineFormFillMode()){if(_instanceof(o,r)&&2===o.fieldType)return;if(1===this.getFormFieldText().length)return this.selection.selectFieldInternal(this.selection.getCurrentFormField()),this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),void this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField())}if(st=ct.index,_instanceof(o,i)&&(o.ignoreOnceItems=[]),_instanceof(o,i)&&(o.ignoreOnceItems=[]),_instanceof(o,r)&&2===o.fieldType&&t.isLinkedFieldCharacter(o))return a=o.fieldBegin,h=o.fieldEnd,_instanceof(a.nextNode,e)&&(h=a.nextNode.reference),n.start.setPositionParagraph(a.line,a.line.getOffset(a,0)),n.end.setPositionParagraph(h.line,h.line.getOffset(h,0)+1),void n.fireSelectionChanged(!0);if((_instanceof(o,yt)&&("Footnote"===o.footnoteType?this.removeFootnote(o):this.removeEndnote(o)),o&&(_instanceof(o,w)||_instanceof(o.previousNode,w))&&(_instanceof(o,w)&&o.previousNode&&(s=(o=o.previousNode).line.paragraph,l=o.line.getOffset(o,o.length)),o&&1===o.length&&_instanceof(o.nextNode,w)&&_instanceof(o.previousNode,w)))&&(c=o.previousNode,h=o.nextNode,!c.contentControlProperties.lockContentControl))return n.start.setPositionParagraph(c.line,c.line.getOffset(c,0)),n.end.setPositionParagraph(h.line,h.line.getOffset(h,0)+1),void this.removeWholeElement(n);if(o&&(_instanceof(o,e)||_instanceof(o.previousNode,e))){if(_instanceof(o,e)&&1===o.bookmarkType){if(o.previousNode)s=(o=o.previousNode).line.paragraph,l=o.line.getOffset(o,o.length);else if(_instanceof(s.previousRenderedWidget,u))return rt=s.previousRenderedWidget.lastChild,n.start.setPositionParagraph(o.line,o.line.getOffset(o,0)),n.end.setPositionParagraph(rt,rt.getEndOffset()),void this.removeWholeElement(n)}else if(_instanceof(o.nextNode,e)&&_instanceof(o,e)&&0===o.bookmarkType&&o.reference===o.nextNode)return void this.deleteBookmark(o.name);if(1===o.length&&_instanceof(o.nextNode,e)&&_instanceof(o.previousNode,e))return a=o.previousNode,h=o.nextNode,n.start.setPositionParagraph(a.line,a.line.getOffset(a,0)),n.end.setPositionParagraph(h.line,h.line.getOffset(h,0)+1),void this.removeWholeElement(n)}if(_instanceof(o,g)&&1===o.commentType){for(k=o.comment,k.isReply&&(k=k.ownerComment);_instanceof(o,g);)o=o.previousNode;this.deleteCommentInternal(k);s=o.line.paragraph;l=o.line.getOffset(o,o.length);n.start.setPositionParagraph(o.line,l);n.end.setPositionParagraph(o.line,l);it=!0}if(_instanceof(o,r)&&1===o.fieldType){if(d=n.getPreviousValidElement(o),_instanceof(d,r))return(s=(o=d.fieldBegin).line.paragraph,l=o.line.getOffset(o,0),_instanceof(o.nextNode,e))&&(c=o.nextNode.reference,n.start.setPositionParagraph(c.line,c.line.getOffset(c,0))),n.end.setPositionParagraph(o.line,l),void n.fireSelectionChanged(!0);d!==o&&(s=(o=d).line.paragraph,l=o.line.getOffset(o,o.length))}if(_instanceof(o,ht)||_instanceof(o,ot)){if(_instanceof(o.nextNode,ot)&&o.editRangeEnd===o.nextNode||_instanceof(o.previousNode,ht)&&o.editRangeStart===o.previousNode)return;if(_instanceof(o,ht)&&!_instanceof(o.previousNode,ot))return;if(_instanceof(o,ot)&&(sf.base.isNullOrUndefined(o.previousNode)||(s=(o=o.previousNode).line.paragraph,l=o.line.getOffset(o,o.length))),1===o.length&&_instanceof(o.nextNode,ot)&&_instanceof(o.previousNode,ht))return c=o.previousNode,h=o.nextNode,n.start.setPositionParagraph(c.line,c.line.getOffset(c,0)),n.end.setPositionParagraph(h.line,h.line.getOffset(h,0)+1),void this.removeWholeElement(n)}if(f||this.initHistory("BackSpace"),l===n.getStartOffset(s)&&n.start.currentWidget.isFirstLine()){if(s.paragraphFormat.listFormat&&-1!==s.paragraphFormat.listFormat.listId)return void this.onApplyList(void 0);if(0!==s.paragraphFormat.firstLineIndent)return void this.onApplyParagraphFormat("firstLineIndent",0,!1,!1);if(0!==s.paragraphFormat.leftIndent)return void this.onApplyParagraphFormat("leftIndent",0,!1,!1);if(!s.paragraphFormat.bidi&&"Left"!==s.paragraphFormat.textAlignment)return void this.onApplyParagraphFormat("textAlignment","Left",!1,!0);if(_instanceof(s.previousRenderedWidget,u)){if(n.owner.isShiftingEnabled=!0,v=s.previousRenderedWidget,v.isEmpty())this.removeBlock(v),this.addRemovedNodes(v);else{this.removeBlock(s);var wt=this.documentHelper.selection.getLineLength(v.lastChild),lt=v.childWidgets.length-1,y=void 0;if(!s.isEmpty())for(b=0;b<s.childWidgets.length;b++)y=s.childWidgets[b],v.childWidgets.push(y),s.childWidgets.splice(b,1),b--,y.paragraph=v;this.documentHelper.layout.reLayoutParagraph(v,lt,0);n.selects(v.childWidgets[lt],wt,!0);this.addRemovedNodes(s)}(this.setPositionForHistory(),this.documentHelper.layout.getFootNoteWidgetsOf(s).length>0)&&(at=this.documentHelper.layout,vt=s.containerWidget,at.layoutfootNote(vt.page.footnoteWidget));this.reLayout(n)}else this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0)}else f||(n.owner.isShiftingEnabled=!0),ut=this.selection.getParagraphInfo(n.start),nt=(y=n.start.currentWidget,l-1),nt<0&&(y=y.previousLine,nt=this.documentHelper.selection.getLineLength(y)+nt),this.removeAtOffset(y,n,nt),this.setPositionParagraph(ut.paragraph,ut.offset-1,!1),this.setPositionForHistory(),f?this.fireContentChange():(this.reLayout(n),it&&(this.owner.editorHistory.undoStack[this.owner.editorHistory.undoStack.length-2].modifiedActions.push(this.owner.editorHistory.undoStack[this.owner.editorHistory.undoStack.length-1]),this.owner.editorHistory.undoStack.splice(this.owner.editorHistory.undoStack.length-1,1),it=!1))},n.prototype.setPositionForHistory=function(n){var t=this.documentHelper.selection;this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(sf.base.isNullOrUndefined(n)?(this.updateHistoryPosition(t.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition):(this.editorHistory.currentBaseHistoryInfo.insertPosition=n,this.editorHistory.currentBaseHistoryInfo.endPosition=n))},n.prototype.removeAtOffset=function(n,t,r){var h=0,l=n.paragraph.childWidgets.indexOf(n),c=n.paragraph.paragraphFormat.bidi,a=n.children.length,y,f;if(!c&&this.viewer.documentHelper.layout.isContainsRtl(n))for(var u=n.children[0],e=void 0,s=-1,v=!0;u;){for(;(v||sf.base.isNullOrUndefined(e))&&_instanceof(u,i)&&(this.documentHelper.textHelper.isRTLText(u.text)||this.documentHelper.textHelper.containsSpecialCharAlone(u.text))&&u.nextElement;)e||(e=u),-1===s&&(s=n.children.indexOf(u)),u=u.nextElement;if(v=!1,y=n.children.indexOf(u),this.removeCharacter(u,r,h,n,l,y,!0))break;h+=u.length;e===u?(-1!==s&&(u=n.children[s+1]),e=void 0,s=-1):u=e?u.previousElement:u.nextElement}else for(f=c?a-1:0;c?f>=0:f<a;c?f--:f++)if(!_instanceof(u=n.children[f],o)){if(this.removeCharacter(u,r,h,n,l,f))break;h+=u.length}},n.prototype.removeCharacter=function(n,t,i,r,u,f,o){var c=!1,h,s;return _instanceof(n,e)&&n.line!==n.reference.line?(sf.base.isNullOrUndefined(n.line.previousLine)?sf.base.isNullOrUndefined(n.line.paragraph.previousRenderedWidget)?sf.base.isNullOrUndefined(n.line.paragraph.nextRenderedWidget)||(n.line.paragraph.nextRenderedWidget.firstChild.children.splice(n.line.paragraph.nextRenderedWidget.firstChild.children.length,0,n),n.line=n.line.paragraph.nextRenderedWidget.firstChild):(n.line.paragraph.previousRenderedWidget.lastChild.children.splice(n.line.paragraph.previousRenderedWidget.lastChild.children.length,0,n),n.line=n.line.paragraph.previousRenderedWidget.lastChild):(n.line.previousLine.children.splice(n.line.previousLine.children.length,0,n),n.line=n.line.previousLine),r.children.splice(f,1),!0):(t<i+n.length&&(h=t-i,(n.ischangeDetected=!0,this.owner.isSpellCheck&&this.owner.spellChecker.removeErrorsFromCollection({element:n,text:n.text}),n.canTrigger||(this.documentHelper.triggerSpellCheck=!1),t===i&&1===n.length)?(this.owner.enableTrackChanges&&!this.skipTracking()?(this.addRemovedNodes(n.clone()),this.handleDeleteTracking(n,h,1,f)):(this.unLinkFieldCharacter(n),this.unlinkRangeFromRevision(n,!0),this.addRemovedRevisionInfo(n,void 0),this.addRemovedNodes(n),r.children.splice(f,1)),this.documentHelper.layout.reLayoutParagraph(r.paragraph,u,f,void 0,o)):(s=this.handleDeleteTracking(n,h,1),this.documentHelper.layout.reLayoutParagraph(r.paragraph,u,f,void 0,o),sf.base.isNullOrUndefined(s)||(n.revisions.length>0&&this.addRemovedRevisionInfo(n,s),this.addRemovedNodes(s))),c=!0),c)},n.prototype.removeCharacterInLine=function(n,t,r){var u=new i,e,f;return _instanceof(n,i)&&(u.characterFormat.copyFormat(n.characterFormat),e=1===r?1:r-t,u.text=n.text.substr(t,e),f=n.text,n.text=f.substring(0,t)+f.substring(t+e,f.length),n.contentControlProperties&&(u.contentControlProperties=n.contentControlProperties.clone())),u},n.prototype.removeRevisionsInformation=function(n,t,i,r){var u=n.previousElement;"Insertion"===this.retrieveRevisionInOder(u).revisionType&&this.isRevisionMatched(u,void 0)&&n.line.children.splice(r,1)},n.prototype.handleDeleteTracking=function(n,t,u,f){var ft=this.owner.enableTrackChanges,p=(!sf.base.isNullOrUndefined(this.editorHistory)&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing),void 0),a,o,w,d,s,nt,v,b,it,c;if(this.canHandleDeletion()||ft&&!this.skipTracking()){if(_instanceof(n,e)||_instanceof(n,g)||_instanceof(n,ht)||_instanceof(n,ot))return void(_instanceof(n,e)&&_instanceof(n.previousElement,r)&&n.previousElement.formFieldData?n.previousElement.revisions.length>0&&this.removeRevisionsInformation(n,t,u,f):n.line.children.splice(n.indexInOwner,1));if(a=!1,this.owner.editorHistory&&(a=!sf.base.isNullOrUndefined(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),this.skipTableElements||this.updateEndRevisionIndex(),n.revisions.length>0){if(o=this.retrieveRevisionInOder(n),w=this.owner.revisions.changes.indexOf(o),"Insertion"===o.revisionType)if(this.isRevisionMatched(n,void 0))sf.base.isNullOrUndefined(f)?p=this.removeCharacterInLine(n,t,u):(d=o.range.indexOf(n),o.range.splice(d,1),0===o.range.length&&this.owner.revisionsInternal.remove(o),this.unLinkFieldCharacter(n),n.line.children.splice(f,1));else if(sf.base.isNullOrUndefined(f))if(s=this.removeCharacterInLine(n,t,u),0===t)nt=n.previousElement,this.handleDeletionForInsertRevision(nt,n,s,u,t,!0);else if(n.length!==t)for(v=n.revisions.length-1;v>=0;v--){var l=n.revisions[v],tt=l.range.indexOf(n),h=new i;h.characterFormat.copyFormat(n.characterFormat);h.line=n.line;h.text=n.text.substr(t);h.revisions.splice(0,0,l);l.range.splice(tt+1,0,h);s.revisions.splice(0,0,l);s.line=n.line;l.range.splice(tt+1,0,s);n.text=n.text.substr(0,t);b=n.indexInOwner;n.line.children.splice(b+1,0,h);n.line.children.splice(b+1,0,s);this.addRemovedNodes(s.clone());this.insertRevision(s,"Deletion");this.updateLastElementRevision(s)}else n.length===t?(it=n.nextElement,this.handleDeletionForInsertRevision(it,n,s,u,t,!1)):(1===u?a||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)):this.updateCursorForInsertRevision(n,t,u),this.addRemovedNodes(s.clone()),this.insertInlineInternal(s,"Deletion"));else this.checkToCombineRevisionsInSides(n,"Deletion")||this.insertRevision(n,"Deletion"),this.updateLastElementRevision(n);else if("Deletion"===o.revisionType){if(-1!==w&&o.author!==this.owner.currentUser){var y=o.range,rt=y[0].line.getOffset(y[0],0),k=y[y.length-1],ut=k.line.getOffset(k,k.length);rt===t&&ut===u&&(n.revisions.splice(n.revisions.indexOf(o),1),this.checkToCombineRevisionsInSides(n,"Deletion")?this.combineElementRevision(n.revisions,n.revisions):(this.insertRevision(n,"Deletion"),this.updateLastElementRevision(n)),n.line.getOffset(n,0)===rt&&this.owner.revisions.changes.splice(w,1))}1===u?a?(this.selection.start.moveNextPosition(),this.selection.end.setPositionInternal(this.selection.start)):(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)):this.isRevisionMatched(n,"Deletion")?this.updateCursorForInsertRevision(n,t,u):(c=o.range.indexOf(n),(ut=n.line.getOffset(n,n.length))>=u&&o.range.length>c+1?(this.updateRevisionForSpittedTextElement(n,o.range[c+1]),o.range.splice(o.range.indexOf(n),1),this.toCombineOrInsertRevision(n,"Deletion")):1===o.range.length||0===t?(this.handleDeleteBySplitting(n,t,u),-1!==c&&1!==o.range.length&&(this.updateRevisionForSpittedTextElement(o.range[c-1],o.range[c]),o.range.splice(o.range.indexOf(n),1))):(o.range.splice(o.range.indexOf(n),1),this.toCombineOrInsertRevision(n,"Deletion")));this.updateLastElementRevision(n)}}else sf.base.isNullOrUndefined(f)?this.handleDeleteBySplitting(n,t,u):(this.checkToCombineRevisionsInSides(n,"Deletion")||this.insertRevision(n,"Deletion"),this.updateLastElementRevision(n))}else p=this.removeCharacterInLine(n,t,u);return p},n.prototype.toCombineOrInsertRevision=function(n,t){this.checkToCombineRevisionsInSides(n,t)?this.combineElementRevision(n.revisions,n.revisions):(this.insertRevision(n,t),this.updateLastElementRevision(n))},n.prototype.updateLastElementRevision=function(n){this.skipTableElements||!this.editorHistory||!this.editorHistory.currentBaseHistoryInfo||this.skipReplace||!sf.base.isNullOrUndefined(this.owner.search)&&this.owner.search.isRepalceTracking||sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.lastElementRevision)&&(this.editorHistory.currentBaseHistoryInfo.lastElementRevision=n,n.isMarkedForRevision=!0)},n.prototype.updateEndRevisionIndex=function(){if(!sf.base.isNullOrUndefined(this.editorHistory.undoStack)&&this.editorHistory.undoStack.length>0){var n=this.editorHistory.undoStack[this.editorHistory.undoStack.length-1];n.lastElementRevision&&sf.base.isNullOrUndefined(n.endRevisionLogicalIndex)&&n.updateEndRevisionInfo()}},n.prototype.retrieveRevisionInOder=function(n){if(1===n.revisions.length)return n.revisions[0];for(var t=0;t<n.revisions.length;t++)if("Deletion"===n.revisions[t].revisionType)return n.revisions[t];return n.revisions[n.revisions.length-1]},n.prototype.handleDeletionForInsertRevision=function(n,t,i,r,u,f){var e,o,s;!sf.base.isNullOrUndefined(n)&&0===t.revisions.length&&this.isRevisionMatched(n,"Deletion")?(this.addRemovedNodes(i.clone()),this.insertTextInline(n,this.selection,i.text,0)):(e=t.revisions[t.revisions.length-1],o=e.range.indexOf(t),e.range.splice(f?o:o+1,0,i),i.revisions.splice(0,0,e),s=!1,this.owner.editorHistory&&(s=!sf.base.isNullOrUndefined(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),1!==r||s?this.updateCursorForInsertRevision(t,u,r):(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)),this.addRemovedNodes(i.clone()),this.insertInlineInternal(i,"Deletion"))},n.prototype.handleDeleteBySplitting=function(n,t,i){var e=!1,r,u,f;(this.owner.editorHistory&&(e=!sf.base.isNullOrUndefined(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),1===i)?(r=n.line.getOffset(n,0),r>0?(u=new l(this.owner),u.setPositionForLineWidget(n.line,r+t),this.selection.start.setPositionInternal(u),this.selection.end.setPositionInternal(this.selection.start)):e||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start))):this.updateCursorForInsertRevision(n,t,i);f=this.removeCharacterInLine(n,t,i);this.addRemovedNodes(f.clone());this.insertTextInternal(f.text,!1,"Deletion")},n.prototype.updateCursorForInsertRevision=function(n,t,i){var f=n.line.getOffset(n,0),r,u;f>0&&(t=f+t,i=f+i);r=new l(this.owner);r.setPositionFromLine(n.line,t);u=new l(this.owner);u.setPositionFromLine(n.line,i);r.isExistBefore(u)?(this.selection.end.setPositionInternal(r),this.selection.start.setPositionInternal(r)):(this.selection.start.setPositionInternal(u),this.selection.end.setPositionInternal(u))},n.prototype.checkToCombineRevisionsInSides=function(n,t){var u,r=n.previousNode,i=n.nextNode,f=!1;return sf.base.isNullOrUndefined(r)||(r=r.previousValidNodeForTracking,sf.base.isNullOrUndefined(r)||(u=this.getMatchedRevisionsToCombine(r.revisions,t)).length>0&&(this.mapMatchedRevisions(u,r,n,!1),f=!0)),sf.base.isNullOrUndefined(i)||(i=i.nextValidNodeForTracking,sf.base.isNullOrUndefined(i)||(u=this.getMatchedRevisionsToCombine(i.revisions,t)).length>0&&(f?this.combineElementRevision(n.revisions,i.revisions):this.mapMatchedRevisions(u,i,n,!0),f=!0)),f},n.prototype.delete=function(){var n,t;this.removeEditRange=!0;n=this.documentHelper.selection;n.isEmpty?this.singleDelete(n,!1):(this.initHistory("Delete"),this.deleteSelectedContentInternal(n,!1,n.start,n.end),t=new l(n.owner),this.setPositionForCurrentIndex(t,n.editPosition),n.selectContent(t,!0),this.reLayout(n),this.insertSpaceInFormField());this.removeEditRange=!1;this.updateXmlMappedContentControl()},n.prototype.deleteEditElement=function(n){this.initHistory("Delete");this.deleteSelectedContentInternal(n,!1,n.start,n.end);var t=new l(n.owner);this.setPositionForCurrentIndex(t,n.editPosition);n.selectContent(t,!0);this.reLayout(n)},n.prototype.removeContentControlMark=function(n,t){return!n.contentControlProperties.lockContentControl&&(this.selection.start.setPositionParagraph(n.line,n.line.getOffset(n,0)),this.selection.end.setPositionParagraph(t.line,t.line.getOffset(t,0)+1),this.deleteEditElement(this.selection),!0)},n.prototype.singleDelete=function(n,t){var ct=n.start.currentWidget,s=n.start.paragraph,h=n.start.offset,l=0,rt=ct.getInline(n.start.offset,l),o=rt.element,ut,c,g,v,y,p,b,a,k,d,ft,nt,et,st;if(this.selection.isInlineFormFillMode()){if(_instanceof(o,r)&&1===o.fieldType)return;if(ut=this.getFormFieldText(),_instanceof(o,i)||(o=o.nextElement),1===ut.length&&_instanceof(o,i))return this.selection.selectFieldInternal(this.selection.getCurrentFormField()),this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),void this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField());if(_instanceof(o,r)&&1===o.fieldType)return}if(l=rt.index,s.paragraphFormat.listFormat&&-1!==s.paragraphFormat.listFormat.listId&&this.documentHelper.isListTextSelected&&"List"===n.contextType)this.onApplyList(void 0);else{if(!sf.base.isNullOrUndefined(o)&&l===o.length&&!sf.base.isNullOrUndefined(o.nextNode)){if(_instanceof(o=o.nextNode,r)&&1===o.fieldType&&!sf.base.isNullOrUndefined(o.fieldBegin.formFieldData))return;l=0}if(!sf.base.isNullOrUndefined(o)&&l===o.length&&!sf.base.isNullOrUndefined(o.nextNode)){if(_instanceof(o=o.nextNode,yt))return;l=0}if(_instanceof(o,yt)&&("Footnote"===o.footnoteType?this.removeFootnote(o):this.removeEndnote(o)),!sf.base.isNullOrUndefined(o)){if(c=void 0,g=n.getNextValidElement(o),_instanceof(g,tt)&&(c=g),!sf.base.isNullOrUndefined(c)&&_instanceof(c,r)&&0===c.fieldType)return s=(o=c.fieldEnd).line.paragraph,h=o.line.getOffset(o,1),n.end.setPositionParagraph(o.line,h),void n.fireSelectionChanged(!0);o!==c&&(s=(o=c).line.paragraph,h=o.line.getOffset(o,0),_instanceof(o,r)&&1===o.fieldType&&h++)}if(_instanceof(o,ht)||_instanceof(o,ot)){if(_instanceof(o.nextNode,ot)&&o.editRangeEnd===o.nextNode||_instanceof(o.previousNode,ht)&&o.editRangeStart===o.previousNode)return;if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType){if(_instanceof(o,ht)||_instanceof(o,ot))return}else _instanceof(o,ht)?(h=(o=o.nextNode).line.getOffset(o,0),s=o.line.paragraph):_instanceof(o,ot)&&h++;if(1===o.length&&_instanceof(o.nextNode,ot)&&_instanceof(o.previousNode,ht))return v=o.previousNode,y=o.nextNode,n.start.setPositionParagraph(v.line,v.line.getOffset(v,0)),n.end.setPositionParagraph(y.line,y.line.getOffset(y,0)+1),void this.deleteEditElement(n)}if(o&&(_instanceof(o,w)||_instanceof(o.nextNode,w))){if(_instanceof(o,w)&&o.nextNode)return s=(o=o.nextNode).line.paragraph,h=o.line.getOffset(o,0),n.start.setPositionParagraph(o.line,h),void n.end.setPositionParagraph(o.line,h);if(o&&1===o.length&&_instanceof(o.nextNode,w)&&_instanceof(o.previousNode,w)&&this.removeContentControlMark(o.previousNode,o.nextNode))return;if(_instanceof(o,w)&&_instanceof(o.previousNode,w)&&o.previousNode.reference===o&&this.removeContentControlMark(o.previousNode,o))return}if(o&&(_instanceof(o,e)&&0===o.bookmarkType||_instanceof(o.nextNode,e))){if(o.nextNode&&_instanceof(o,e)&&(s=(o=o.nextNode).line.paragraph,h=o.line.getOffset(o,0)),1===o.length&&_instanceof(o.nextNode,e)&&_instanceof(o.previousNode,e))return p=o.previousNode,b=o.nextNode,n.start.setPositionParagraph(p.line,p.line.getOffset(p,0)),n.end.setPositionParagraph(b.line,b.line.getOffset(b,0)+1),void this.deleteEditElement(n);_instanceof(o,e)&&(h=o.line.getOffset(o,1))}if(n.start.currentWidget.isLastLine()&&h===this.documentHelper.selection.getLineLength(n.start.currentWidget)){if(s.isInsideTable&&sf.base.isNullOrUndefined(s.nextWidget))return;if(a=void 0,k=n.getNextParagraphBlock(s),sf.base.isNullOrUndefined(k)){if(h>0)return;if(_instanceof(s.previousWidget,u)&&(a=s.previousWidget),_instanceof(s.previousWidget,it))return;if(_instanceof(s.previousWidget,f))return;if(sf.base.isNullOrUndefined(a))return}(t||this.initHistory("Delete"),s.isEndsWithPageBreak)&&(d=s.lastChild,ft=d.children[d.children.length-1],this.selection.start.setPositionForSelection(d,ft,0,this.selection.start.location));nt=this.selection.getParagraphInfo(n.start);(n.editPosition=this.selection.getHierarchicalIndex(nt.paragraph,nt.offset.toString()),this.checkInsertPosition(n)&&this.setPositionForHistory(n.editPosition),n.owner.isShiftingEnabled=!0,s.isEmpty())?(this.removeBlock(s),this.addRemovedNodes(s),sf.base.isNullOrUndefined(k))?sf.base.isNullOrUndefined(a)?(et=n.getParagraphLength(void 0)+1,this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(n.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(void 0,et.toString()))):(n.selectParagraphInternal(a,!1),this.setPositionForHistory()):n.selectParagraphInternal(k,!0):(s=s.combineWidget(this.owner.viewer),st=this.splitParagraph(s,s.firstChild,0,n.start.currentWidget,n.start.offset,!0),this.deleteParagraphMark(st,n,0),this.addRemovedNodes(s),this.setPositionForCurrentIndex(n.start,n.editPosition),n.selectContent(n.start,!0));this.reLayout(n)}else this.singleDeleteInternal(n,t,s)}},n.prototype.singleDeleteInternal=function(n,t){t||(n.owner.isShiftingEnabled=!0,this.initHistory("Delete"));this.checkInsertPosition(n)&&(this.updateHistoryPosition(n.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition);var i=this.selection.getParagraphInfo(n.start),r=n.start.currentWidget,u=n.start.offset,f=n.getLineLength(n.start.currentWidget);u>=f&&(r=r.nextLine,u-=f);this.removeAtOffset(r,n,u);this.owner.enableTrackChanges&&!this.skipTracking()?this.setPositionParagraph(i.paragraph,i.offset+1,!1):this.setPositionParagraph(i.paragraph,i.offset,!1);t?this.fireContentChange():this.reLayout(n)},n.prototype.deleteParagraphMark=function(n,t,i,r){var u,h,l,e,v,o,a,p,w,y,s;if(!sf.base.isNullOrUndefined(n.containerWidget)&&(n=n.combineWidget(this.owner.viewer),u=t.getNextParagraphBlock(n),!(n.isInsideTable&&sf.base.isNullOrUndefined(n.nextWidget)||sf.base.isNullOrUndefined(u))))if(_instanceof(n.containerWidget,c)&&n.containerWidget,h=void 0,h=_instanceof(t.getNextRenderedBlock(n),f)?t.getNextRenderedBlock(n):void 0,u.isInsideTable&&!sf.base.isNullOrUndefined(h)&&h.contains(u.associatedCell)){if(i<4){for(l=0,this.removeBlock(n),this.documentHelper.layout.clearListElementBox(u),this.documentHelper.layout.clearListElementBox(n),e=n.childWidgets.length-1;e>=0;e--)for(v=n.childWidgets[e],o=v.children.length-1;o>=0;o--)a=v.children[o],l+=a.length,u.firstChild.children.unshift(a),a.line=u.firstChild;this.documentHelper.layout.reLayoutParagraph(u,0,0);l>0&&(t.editPosition=this.selection.getHierarchicalIndex(u,l.toString()))}}else if(i<4&&(n.childWidgets.length,p=u.getSplitWidgets(),u=u.combineWidget(this.owner.viewer),this.documentHelper.layout.clearListElementBox(u),this.documentHelper.layout.clearListElementBox(n),this.updateEditPositionOnMerge(n,u),!(!sf.base.isNullOrUndefined(r)&&r)||this.handleDeleteParaMark(n,p[0]))){for(w=n.childWidgets.length-1,n.childWidgets[w].children.length,e=0;e<u.childWidgets.length;e++){if(y=u.childWidgets[e],u.characterFormat.revisions.length>0)for(s=0;s<u.characterFormat.revisions.length;s++){for(o=0;o<u.characterFormat.revisions[s].range.length;o++)u.characterFormat.revisions[s].range[o].ownerBase=n;n.characterFormat.revisions.push(u.characterFormat.revisions[s])}u.childWidgets.splice(e,1);n.childWidgets.push(y);y.paragraph=n;e--}0===u.childWidgets.length&&u.childWidgets.push(new k(u));this.removeBlock(u);this.documentHelper.layout.reLayoutParagraph(n,0,0);this.addRemovedNodes(u)}},n.prototype.handleDeleteParaMark=function(n,t){var f,u,e,o,i,s,r;if(!this.owner.enableTrackChanges&&n.characterFormat.revisions.length>0)for(f=0;f<n.characterFormat.revisions.length;f++)return u=n.characterFormat.revisions[f],e=u.range.indexOf(n.characterFormat),u.range.splice(e,1),0===u.range.length&&this.owner.revisions.remove(u),!0;return this.owner.enableTrackChanges?(o=!1,n.characterFormat.revisions.length>0)?(i=this.retrieveRevisionByType(n.characterFormat,"Deletion"),!sf.base.isNullOrUndefined(i)&&this.isRevisionMatched(i,"Deletion")&&(s=n.characterFormat.revisions.indexOf(i),n.characterFormat.revisions.splice(s,1),i.range.splice(i.range.indexOf(n.characterFormat),1),0===i.range.length&&this.owner.revisions.remove(i),o=!0),r=this.retrieveRevisionByType(n.characterFormat,"Insertion"),!sf.base.isNullOrUndefined(r)&&this.isRevisionMatched(n.characterFormat,"Insertion")&&(e=r.range.indexOf(n.characterFormat),r.range.splice(e,1),0===r.range.length&&this.owner.revisions.remove(r),o=!0),!!o||(this.applyRevisionForParaMark(n,t.firstChild,"Deletion",!1),!1)):(this.applyRevisionForParaMark(n,t.firstChild,"Deletion",!1),!1):!0},n.prototype.insertDeleteParaMarkRevision=function(n,t){var i=n.lastChild,r=i.children.length>0?i.children[i.children.length-1].previousValidNodeForTracking:void 0,u;sf.base.isNullOrUndefined(r)||(u=this.getMatchedRevisionsToCombine(r.revisions,"Deletion"),u.length>0&&this.mapMatchedRevisions(u,r,n.characterFormat,!1));t.firstChild.children[0].nextValidNodeForTracking},n.prototype.retrieveRevisionByType=function(n,t){for(var i=0;i<n.revisions.length;i++)if(n.revisions[i].revisionType===t)return n.revisions[i]},n.prototype.combineRevisionOnDeleteParaMark=function(n,t,i){var r=n.childWidgets[t].children[i],u=r.nextNode;u=u.nextValidNodeForTracking;r=r.nextValidNodeForTracking;u.revisions.length>0&&r.revisions.length>0&&this.combineElementRevisions(r,u)},n.prototype.updateEditPositionOnMerge=function(n,t){this.documentHelper.selection.editPosition===this.selection.getHierarchicalIndex(t,"0")&&void 0===t.nextRenderedWidget&&(this.documentHelper.selection.editPosition=this.selection.getHierarchicalIndex(n,this.documentHelper.selection.getLineLength(n.lastChild).toString()))},n.prototype.checkEndPosition=function(){return this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.endPosition)},n.prototype.checkInsertPosition=function(){return this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)},n.prototype.checkIsNotRedoing=function(){return this.documentHelper.owner.enableHistoryMode&&!this.editorHistory.isRedoing},n.prototype.deleteSelectedContentInternal=function(n,t,i,r){var e=i,u=r,s,o,h;return i.isExistBefore(r)||(e=r,u=i),s=this.selection.getParagraphInfo(e),n.editPosition=this.selection.getHierarchicalIndex(s.paragraph,s.offset.toString()),o=!1,t&&e.isInSameParagraph(u)&&(e.offset<u.offset&&e.offset===n.getParagraphLength(u.paragraph)&&(o=_instanceof(n.getNextRenderedBlock(e.paragraph),f)),1===u.offset&&u.offset>n.getParagraphLength(u.paragraph)&&(!u.paragraph.isInsideTable||!sf.base.isNullOrUndefined(u.paragraph.nextWidget))&&(t=!1)),o||(n.owner.isShiftingEnabled=!0,this.checkInsertPosition(n)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=n.editPosition),h=t?1:0,this.deleteSelectedContent(u.paragraph,n,e,u,h)),o},n.prototype.initHistory=function(n){this.documentHelper.owner.enableHistoryMode&&this.editorHistory.initializeHistory(n)},n.prototype.initComplexHistory=function(n){this.documentHelper.owner.enableHistoryMode&&this.editorHistory.initComplexHistory(this.documentHelper.selection,n)},n.prototype.insertPicture=function(n,t,i){var r=new v(!0);r.imageString=n;r.width=t;r.height=i;r.textWrappingStyle="Inline";this.insertPictureInternal(r)},n.prototype.insertPictureInternal=function(n){var t=this.documentHelper.selection;this.initHistory("InsertInline");this.fitImageToPage(t,n);this.insertInlineInSelection(t,n);this.reLayout(t)},n.prototype.fitImageToPage=function(n,t){var i=n.start.paragraph.bodyWidget,r=i.sectionFormat.pageWidth-i.sectionFormat.leftMargin-i.sectionFormat.rightMargin,u=i.sectionFormat.pageHeight-i.sectionFormat.topMargin-i.sectionFormat.topMargin;t.width>r&&(t.height=t.height*r/t.width,t.width=r);t.height>u&&(t.width=t.width*u/t.height,t.height=u)},n.prototype.insertInlineInSelection=function(n,t){this.checkIsNotRedoing()&&(n.owner.isShiftingEnabled=!0);n.isEmpty||this.removeSelectedContents(n);this.updateInsertPosition();this.insertInlineInternal(t);this.addOrRemoveCommentsInline(t,!0);this.checkEndPosition(n)&&this.updateHistoryPosition(n.start,!1);this.fireContentChange()},n.prototype.onPortrait=function(){var n=new dt,t=this.documentHelper.selection.sectionFormat.pageWidth,i=this.documentHelper.selection.sectionFormat.pageHeight;t>i&&(n.pageWidth=i,n.pageHeight=t);this.onApplySectionFormat(void 0,n)},n.prototype.onLandscape=function(){var n=new dt,t=this.documentHelper.selection.sectionFormat.pageWidth,i=this.documentHelper.selection.sectionFormat.pageHeight;t<i&&(n.pageWidth=i,n.pageHeight=t);this.onApplySectionFormat(void 0,n)},n.prototype.copyValues=function(){var n=new dt;return n.bottomMargin=this.documentHelper.selection.sectionFormat.bottomMargin,n.topMargin=this.documentHelper.selection.sectionFormat.topMargin,n.leftMargin=this.documentHelper.selection.sectionFormat.leftMargin,n.rightMargin=this.documentHelper.selection.sectionFormat.rightMargin,n.pageHeight=this.documentHelper.selection.sectionFormat.pageHeight,n.pageWidth=this.documentHelper.selection.sectionFormat.pageWidth,n.footerDistance=this.documentHelper.selection.sectionFormat.footerDistance,n.headerDistance=this.documentHelper.selection.sectionFormat.headerDistance,n},n.prototype.changeMarginValue=function(n){var t=this.copyValues();"lastCustomSetting"===n||"normal"===n?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=72,t.rightMargin=72):"narrow"===n?(t.topMargin=36,t.bottomMargin=36,t.leftMargin=36,t.rightMargin=36):"moderate"===n?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=54,t.rightMargin=54):"wide"===n?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=144,t.rightMargin=144):"mirrored"===n?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=72):"office2003Default"===n&&(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=90);this.onApplySectionFormat(void 0,t)},n.prototype.onPaperSize=function(n){var t=this.copyValues(),i=this.documentHelper.selection.sectionFormat.pageWidth,r=this.documentHelper.selection.sectionFormat.pageHeight;"letter"===n?i<r?(t.pageWidth=611.9,t.pageHeight=791.9):(t.pageWidth=791.9,t.pageHeight=611.9):"tabloid"===n?i<r?(t.pageWidth=791.9,t.pageHeight=1223.9):(t.pageWidth=1223.9,t.pageHeight=791.9):"legal"===n?i<r?(t.pageWidth=611.9,t.pageHeight=1007.9):(t.pageWidth=1007.9,t.pageHeight=611.9):"statement"===n?i<r?(t.pageWidth=396,t.pageHeight=611.9):(t.pageWidth=611.9,t.pageHeight=396):"executive"===n?i<r?(t.pageWidth=521.9,t.pageHeight=755.9):(t.pageWidth=755.9,t.pageHeight=521.9):"a3"===n?i<r?(t.pageWidth=841.8,t.pageHeight=1190.4):(t.pageWidth=1190.4,t.pageHeight=841.8):"a4"===n?i<r?(t.pageWidth=595.2,t.pageHeight=841.8):(t.pageWidth=841.8,t.pageHeight=595.2):"a5"===n?i<r?(t.pageWidth=419.5,t.pageHeight=595.2):(t.pageWidth=595.2,t.pageHeight=419.5):"b4"===n?i<r?(t.pageWidth=728.4,t.pageHeight=1031.7):(t.pageWidth=1031.7,t.pageHeight=728.4):"b5"===n&&(i<r?(t.pageWidth=515.8,t.pageHeight=728.4):(t.pageWidth=728.4,t.pageHeight=515.8));this.onApplySectionFormat(void 0,t)},n.prototype.updateListItemsTillEnd=function(n,t){for(var i=t?this.documentHelper.selection.getNextRenderedBlock(n):n;!sf.base.isNullOrUndefined(i)&&!this.documentHelper.isTextInput;)this.updateRenderedListItems(i),i=i.getSplitWidgets().pop().nextRenderedWidget},n.prototype.updateWholeListItems=function(n){var t,u,i,r;for(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],u=n.bodyWidget.index,i=0;i<this.documentHelper.pages.length;i++)if(r=this.documentHelper.pages[i],r.bodyWidgets[0].index===u&&(t=this.getNextBlockForList(r.bodyWidgets[0].firstChild),!sf.base.isNullOrUndefined(t)))break;do{if(this.updateListItems(t,n))break;t=t.getSplitWidgets().pop().nextRenderedWidget;sf.base.isNullOrUndefined(t)||(t=this.getNextBlockForList(t))}while(t)},n.prototype.getNextBlockForList=function(n){if(_instanceof(n,u)&&this.documentHelper.layout.isFirstElementWithPageBreak(n)){var t=n.nextRenderedWidget;if(t.equals(n))return t}return n},n.prototype.updateListItems=function(n,t){return _instanceof(n,u)?this.updateListItemsForPara(n,t):this.updateListItemsForTable(n,t)},n.prototype.updateListItemsForTable=function(n,t){if(_instanceof(t,f)&&n.equals(t))return!0;var i=n.firstChild;do{if(this.updateListItemsForRow(i,t))return!0;i=i.getSplitWidgets().pop().nextRenderedWidget}while(i);return!1},n.prototype.updateListItemsForRow=function(n,t){if(t.isInsideTable&&-1!==n.childWidgets.indexOf(this.documentHelper.selection.getContainerCell(t.associatedCell)))return!0;var i=n.firstChild;do this.updateListItemsForCell(i,t),i=i.nextRenderedWidget;while(i);return!1},n.prototype.updateListItemsForCell=function(n,t){if(0!==n.childWidgets.length){var i=n.firstChild;do this.updateListItems(i,t),i=i.getSplitWidgets().pop().nextRenderedWidget;while(i)}},n.prototype.updateRenderedListItems=function(n){_instanceof(n,u)?this.updateRenderedListItemsForPara(n):this.updateRenderedListItemsForTable(n)},n.prototype.updateRenderedListItemsForTable=function(n){var t=n.firstChild;do this.updateRenderedListItemsForRow(t),t=t.getSplitWidgets().pop().nextRenderedWidget;while(t)},n.prototype.updateRenderedListItemsForRow=function(n){var t=n.firstChild;do this.updateRenderedListItemsForCell(t),t=t.nextRenderedWidget;while(t)},n.prototype.updateRenderedListItemsForCell=function(n){if(0!==n.childWidgets.length){var t=n.firstChild;do this.updateRenderedListItems(t),t=t.getSplitWidgets().pop().nextRenderedWidget;while(t)}},n.prototype.updateListItemsForPara=function(n,t){var i,r,u;return n.equals(t)?!0:(i=void 0,r=0,(sf.base.isNullOrUndefined(n.paragraphFormat)||sf.base.isNullOrUndefined(n.paragraphFormat.listFormat)||(i=this.documentHelper.getListById(n.paragraphFormat.listFormat.listId),r=n.paragraphFormat.listFormat.listLevelNumber),sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(i.abstractListId))||sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(i.abstractListId).levels[r]))||(u=this.documentHelper.layout.getListLevel(i,r),this.updateListNumber(u,n,!1)),!1)},n.prototype.updateRenderedListItemsForPara=function(n){var t,i,r;sf.base.isNullOrUndefined(this.documentHelper.getListById(n.paragraphFormat.listFormat.listId))||(t=this.documentHelper.getListById(n.paragraphFormat.listFormat.listId),i=n.paragraphFormat.listFormat.listLevelNumber,sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId))||sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId).levels[n.paragraphFormat.listFormat.listLevelNumber])||(r=this.documentHelper.layout.getListLevel(t,i),this.updateListNumber(r,n,!0)))},n.prototype.updateListNumber=function(n,t,i){var r,u,e,s,f;"Bullet"!==n.listLevelPattern&&(r=void 0,t.childWidgets.length>0&&(u=t.childWidgets[0],u.children.length>0&&(r=t.paragraphFormat.bidi?u.children[u.children.length-1]:u.children[0])),!sf.base.isNullOrUndefined(r)&&_instanceof(r,o)&&(e=this.documentHelper.layout.getListNumber(t.paragraphFormat.listFormat),i&&(s=r.width,r.text=e,f=this.documentHelper.textHelper.getTextSize(r,r.characterFormat),f>s&&(r.width=f))))},n.prototype.getOffsetValue=function(n){if(this.startParagraph){var t=n.getLineInfoBasedOnParagraph(this.startParagraph,this.startOffset);n.start.setPositionFromLine(t.line,t.offset)}(n.start.updatePhysicalPosition(!0),n.isEmpty)?n.end.setPositionInternal(n.start):(this.endParagraph&&(t=n.getLineInfoBasedOnParagraph(this.endParagraph,this.endOffset),n.end.setPositionFromLine(t.line,t.offset)),n.end.updatePhysicalPosition(!0))},n.prototype.setPositionParagraph=function(n,t,i){var r=this.documentHelper.selection,u=r.getLineInfoBasedOnParagraph(n,t);r.start.setPositionFromLine(u.line,u.offset);r.end.setPositionInternal(r.start);i||r.fireSelectionChanged(!0)},n.prototype.setPositionForCurrentIndex=function(n,t){var i=this.selection.getParagraph({index:t}),r=this.selection.getLineInfoBasedOnParagraph(i.paragraph,i.offset);n.setPositionForLineWidget(r.line,r.offset)},n.prototype.insertPageNumber=function(n){var t="PAGE "+(n=sf.base.isNullOrUndefined(n)?"":" \\*"+n)+" \\* MERGEFORMAT";this.createFields(t)},n.prototype.insertPageCount=function(n){var t="NUMPAGES "+(n=sf.base.isNullOrUndefined(n)?"":" *"+n)+" * MERGEFORMAT";this.createFields(t)},n.prototype.createFields=function(n){var l=new u,f=new k(l),t=new r(0),h,a,e,o,s;f.children.push(t);h=new ci;h.fieldBegin=t;h.text="1";a=new i;a.text=n;f.children.push(a);e=new r(2);e.fieldBegin=t;t.fieldSeparator=e;f.children.push(e);f.children.push(h);o=new r(1);o.fieldBegin=t;o.fieldSeparator=e;e.fieldEnd=o;t.fieldEnd=o;f.children.push(o);t.line=f;l.childWidgets.push(f);this.documentHelper.fields.push(t);s=new c;s.sectionFormat=new dt(s);s.childWidgets.push(l);this.pasteContentsInternal([s],!1)},n.prototype.insertBookmark=function(n){var i,t,r;this.documentHelper.bookmarks.containsKey(n)&&(i=this.documentHelper.bookmarks.get(n),i.line.children.splice(i.line.children.indexOf(i),1),i.reference.line.children.splice(i.reference.line.children.indexOf(i.reference),1),this.documentHelper.bookmarks.remove(n));t=new e(0);t.name=n;r=new e(1);r.name=n;t.reference=r;r.reference=t;this.initComplexHistory("InsertBookmark");this.insertElements([r],[t]);this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget();this.documentHelper.bookmarks.add(n,t);this.selection.start.setPositionForSelection(t.line,t,1,this.selection.start.location);this.selection.end.setPositionForSelection(r.line,r,0,this.selection.end.location);this.selection.fireSelectionChanged(!0);this.fireContentChange()},n.prototype.deleteBookmark=function(n){var t=this.documentHelper.bookmarks.get(n);_instanceof(t,e)&&(t.reference,this.initHistory("DeleteBookmark"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setBookmarkInfo(t),this.editorHistory.updateHistory()),this.deleteBookmarkInternal(t));this.fireContentChange()},n.prototype.deleteBookmarkInternal=function(n){var i=n.previousNode,t,u;_instanceof(i,r)&&0===i.fieldType&&!sf.base.isNullOrUndefined(i.formFieldData)&&(i.formFieldData.name="");this.documentHelper.bookmarks.remove(n.name);n.line.children.splice(n.indexInOwner,1);sf.base.isNullOrUndefined(n.reference)||n.reference.line.children.splice(n.reference.indexInOwner,1);t=n.line.paragraph;n.line.paragraph.isInHeaderFooter&&(u=void 0,_instanceof(t.containerWidget,s)?u=t.containerWidget.getContainerTable().containerWidget:_instanceof(t.containerWidget,ct)&&(u=t.containerWidget),this.updateHeaderFooterWidget(u))},n.prototype.getSelectionInfo=function(){var i=this.selection.start,n=this.selection.end,t,r;return this.selection.isForward||(i=this.selection.end,n=this.selection.start),n.offset===this.selection.getLineLength(n.currentWidget)+1&&this.selection.isParagraphLastLine(n.currentWidget)||(n.offset+=1),t=this.selection.getParagraphInfo(i),r=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString()),t=this.selection.getParagraphInfo(n),{start:r,end:this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString())}},n.prototype.insertElements=function(n,t){var i=this.getSelectionInfo();sf.base.isNullOrUndefined(t)||this.insertElementsInternal(this.selection.getTextPosBasedOnLogicalIndex(i.start),t);sf.base.isNullOrUndefined(n)||this.insertElementsInternal(this.selection.getTextPosBasedOnLogicalIndex(i.end),n)},n.prototype.insertElementsInternal=function(n,t){var u,o,f,s,h,i;if(this.selection.selectPosition(n,n),this.initHistory("InsertElements"),this.updateInsertPosition(),u=0,o=this.selection.getParagraphInfo(this.selection.start),this.selection.start.paragraph.isEmpty())f=this.selection.start.paragraph,f.childWidgets[0].children.push(t[0]),t[0].line=f.childWidgets[0],t[0].linkFieldCharacter(this.documentHelper),this.documentHelper.layout.reLayoutParagraph(f,0,0),this.setPositionParagraph(o.paragraph,o.offset+length,!0),n.setPositionForSelection(t[0].line,t[0],t[0].length,this.selection.start.location),this.selection.selectPosition(n,n);else{s=this.selection.start.currentWidget.getInline(this.documentHelper.selection.start.offset,u);h=s.element;u=s.index;i=t[0];this.insertElementInternal(h,i,u,void 0,!0);for(var c=i.indexInOwner,r=i,e=1;e<t.length;e++)r=t[e],i.line.children.splice(c+e,0,r);n.setPositionForSelection(r.line,r,r.length,this.selection.start.location);this.selection.selectPosition(n,n)}this.editorHistory&&(this.checkEndPosition()&&this.updateHistoryPosition(this.selection.start,!1),this.editorHistory.updateHistory())},n.prototype.getCommentElementBox=function(n){var t=n.split(";"),i=this.documentHelper.comments[parseInt(t[1],10)];return t.length>2&&""!==t[2]?i.replyComments[parseInt(t[2],10)]:i},n.prototype.getBlock=function(n){var t=this.selection.getBodyWidget(n);return this.getBlockInternal(t,n)},n.prototype.getBlockInternal=function(n,t){var r,s,e,o,i,f;if(""!==t.index&&!sf.base.isNullOrUndefined(t))return(r=t.index.indexOf(";"),s=t.index.substring(0,r),t.index=t.index.substring(r).replace(";",""),e=n,r=parseInt(s,10),o=this.selection.getBlockByIndex(n,r),!o)?{node:e,position:t}:(i=o,!(t.index.indexOf(";")>=0))?{node:i,position:t}:_instanceof(i,u)?(t.index.indexOf(";")>=0&&(t.index="0"),{node:i,position:t}):_instanceof(i,gt)?(f=this.getBlockInternal(i,t),{node:sf.base.isNullOrUndefined(f)?void 0:f.node,position:sf.base.isNullOrUndefined(f)?void 0:f.position}):{node:e,position:t}},n.prototype.updateHistoryPosition=function(n,t){var i,r;this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(i=void 0,_instanceof(n,l)?(r=this.selection.getParagraphInfo(n),i=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())):i=n,t?this.editorHistory.currentBaseHistoryInfo.insertPosition=i:this.editorHistory.currentBaseHistoryInfo.endPosition=i)},n.prototype.applyBorders=function(n){var f,u,i,r,t,e;this.initHistory("Borders");var s=this.selection.isForward?this.selection.start:this.selection.end,h=this.selection.isForward?this.selection.end:this.selection.start,o=s.paragraph.associatedCell.ownerTable;if((o=o.combineWidget(this.owner.viewer),this.editorHistory)&&this.cloneTableToHistoryInfo(o),s.paragraph.associatedCell,u=h.paragraph.associatedCell,i=this.getBorder(n.borderColor,n.lineWidth,n.borderStyle),this.selection.isEmpty)"OutsideBorders"!==n.type&&"AllBorders"!==n.type&&"LeftBorder"!==n.type||u.cellFormat.borders.left.copyFormat(i),"OutsideBorders"!==n.type&&"AllBorders"!==n.type&&"TopBorder"!==n.type||u.cellFormat.borders.top.copyFormat(i),"OutsideBorders"!==n.type&&"AllBorders"!==n.type&&"RightBorder"!==n.type||u.cellFormat.borders.right.copyFormat(i),"OutsideBorders"!==n.type&&"AllBorders"!==n.type&&"BottomBorder"!==n.type||u.cellFormat.borders.bottom.copyFormat(i),"AllBorders"!==n.type&&"InsideBorders"!==n.type&&"InsideVerticalBorder"!==n.type||u.cellFormat.borders.vertical.copyFormat(i),"AllBorders"!==n.type&&"InsideBorders"!==n.type&&"InsideHorizontalBorder"!==n.type||u.cellFormat.borders.horizontal.copyFormat(i),"NoBorder"===n.type&&this.clearAllBorderValues(u.cellFormat.borders);else{if("OutsideBorders"===n.type||"TopBorder"===n.type)for(r=this.getTopBorderCellsOnSelection(),t=0;t<r.length;t++)r[t].cellFormat.borders.top.copyFormat(i);if("OutsideBorders"===n.type||"LeftBorder"===n.type)for(r=this.getLeftBorderCellsOnSelection(),t=0;t<r.length;t++)r[t].cellFormat.borders.left.copyFormat(i);if("OutsideBorders"===n.type||"RightBorder"===n.type)for(r=this.getRightBorderCellsOnSelection(),t=0;t<r.length;t++)r[t].cellFormat.borders.right.copyFormat(i);if("OutsideBorders"===n.type||"BottomBorder"===n.type)for(r=this.getBottomBorderCellsOnSelection(),t=0;t<r.length;t++)r[t].cellFormat.borders.bottom.copyFormat(i)}if("BottomBorder"===n.type||"AllBorders"===n.type||"OutsideBorders"===n.type||"NoBorder"===n.type)for(f=this.getAdjacentCellToApplyBottomBorder(),t=0;t<f.length;t++)e=f[t],"NoBorder"===n.type?e.cellFormat.borders.top.copyFormat(this.clearBorder()):e.cellFormat.borders.top.copyFormat(i);if("AllBorders"===n.type||"OutsideBorders"===n.type||"RightBorder"===n.type||"NoBorder"===n.type)for(f=this.getAdjacentCellToApplyRightBorder(),t=0;t<f.length;t++)e=f[t],"NoBorder"===n.type?e.cellFormat.borders.left.copyFormat(this.clearBorder()):e.cellFormat.borders.left.copyFormat(i);"AllBorders"!==n.type&&"NoBorder"!==n.type||this.applyAllBorders(i,n.type);"InsideBorders"!==n.type&&"InsideVerticalBorder"!==n.type&&"InsideHorizontalBorder"!==n.type&&"NoBorder"!==n.type||this.applyInsideBorders(i,n.type,o);this.updateGridForTableDialog(o,!1);this.reLayout(this.selection,!1);this.editorHistory.updateHistory()},n.prototype.applyAllBorders=function(n,t){for(var r=this.selection.getSelectedCells(),i=0;i<r.length;i++)"NoBorder"===t?(r[i].cellFormat.borders.left.copyFormat(this.clearBorder()),r[i].cellFormat.borders.right.copyFormat(this.clearBorder()),r[i].cellFormat.borders.top.copyFormat(this.clearBorder()),r[i].cellFormat.borders.bottom.copyFormat(this.clearBorder())):(r[i].cellFormat.borders.left.copyFormat(n),r[i].cellFormat.borders.right.copyFormat(n),r[i].cellFormat.borders.top.copyFormat(n),r[i].cellFormat.borders.bottom.copyFormat(n))},n.prototype.applyInsideBorders=function(n,t,i){for(var v,c,s,f,h,e,u=this.selection.getSelectedCells(),o=0;o<u.length;o++){var r=u[o],l=r.ownerRow===u[u.length-1].ownerRow,a=r.columnIndex+r.cellFormat.columnSpan-1===u[u.length-1].columnIndex;if(("NoBorder"===t?(r.cellFormat.borders.right.copyFormat(this.clearBorder()),r.cellFormat.borders.bottom.copyFormat(this.clearBorder())):(a||"InsideHorizontalBorder"===t||r.cellFormat.borders.right.copyFormat(n),l||"InsideVerticalBorder"===t||r.cellFormat.borders.bottom.copyFormat(n)),!l&&"InsideVerticalBorder"!==t)&&(v=r.ownerRow.rowIndex+r.cellFormat.rowSpan,c=i.childWidgets[v],c))for(s=this.getAdjacentBottomBorderOnEmptyCells(c,r,!0),f=0;f<s.length;f++)"NoBorder"===t?s[f].cellFormat.borders.top.copyFormat(this.clearBorder()):s[f].cellFormat.borders.top.copyFormat(n);if(!a&&"InsideHorizontalBorder"!==t)for(h=this.getSelectedCellsNextWidgets(r,i),e=0;e<h.length;e++)"NoBorder"===t?h[e].cellFormat.borders.left.copyFormat(this.clearBorder()):h[e].cellFormat.borders.left.copyFormat(n)}},n.prototype.getTopBorderCellsOnSelection=function(){for(var r=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell,i=[],t=this.selection.getSelectedCells(),n=0;n<t.length;n++)t[n].ownerRow===r.ownerRow&&i.push(t[n]);return i},n.prototype.getLeftBorderCellsOnSelection=function(){for(var r=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell,t=this.selection.getSelectedCells(),i=[],n=0;n<t.length;n++)t[n].columnIndex===r.columnIndex&&i.push(t[n]);return i},n.prototype.getRightBorderCellsOnSelection=function(){for(var n=this.selection.getSelectedCells(),i=[],t=0;t<n.length;t++)n[t].columnIndex+n[t].cellFormat.columnSpan-1===n[n.length-1].columnIndex&&i.push(n[t]);return i},n.prototype.getBottomBorderCellsOnSelection=function(){for(var r=(this.selection.isForward?this.selection.end:this.selection.start).paragraph.associatedCell,t=this.selection.getSelectedCells(),i=[],n=0;n<t.length;n++)t[n].ownerRow===r.ownerRow&&i.push(t[n]);return i},n.prototype.clearAllBorderValues=function(n){var t=this.clearBorder();n.bottom.copyFormat(t);n.left.copyFormat(t);n.right.copyFormat(t);n.top.copyFormat(t);n.vertical.copyFormat(t);n.horizontal.copyFormat(t)},n.prototype.clearBorder=function(){var n=new ft;return n.lineStyle="Cleared",n},n.prototype.getAdjacentCellToApplyBottomBorder=function(){var r=[],f=this.selection.start,o=this.selection.end,u,n,e;this.selection.isForward||(f=this.selection.end,o=this.selection.start);u=f.paragraph.associatedCell.ownerTable;u=u.combineWidget(this.owner.viewer);var s=f.paragraph.associatedCell,t=o.paragraph.associatedCell,h=t.ownerRow.rowIndex+t.cellFormat.rowSpan,i=u.childWidgets[h];if(i)if(t.cellFormat.columnSpan>1)for(n=t.columnIndex;n<t.columnIndex+t.cellFormat.columnSpan;n++)r.push(i.childWidgets[n]);else if(r=this.getAdjacentBottomBorderOnEmptyCells(i,t),!this.selection.isEmpty)for(n=0;n<i.childWidgets.length;n++)e=i.childWidgets[n].columnIndex,e>=s.columnIndex&&e<=t.columnIndex&&r.push(i.childWidgets[n]);return r},n.prototype.getAdjacentBottomBorderOnEmptyCells=function(n,t,i){var u=[],r;if(t.cellFormat.columnSpan>1)for(r=t.columnIndex;r<t.columnIndex+t.cellFormat.columnSpan;r++)u.push(n.childWidgets[r]);else if(this.selection.isEmpty||i)for(r=0;r<n.childWidgets.length;r++)n.childWidgets[r].columnIndex===t.columnIndex&&u.push(n.childWidgets[r]);return u},n.prototype.getAdjacentCellToApplyRightBorder=function(){var t=[],i=this.selection.start,f=this.selection.end,n,e,u,r,o;if(this.selection.isForward||(i=this.selection.end,f=this.selection.start),n=i.paragraph.associatedCell.ownerTable,n=n.combineWidget(this.owner.viewer),i.paragraph.associatedCell,f.paragraph.associatedCell,this.selection.isEmpty)e=i.paragraph.associatedCell,t=this.getSelectedCellsNextWidgets(e,n);else for(u=this.getRightBorderCellsOnSelection(),r=0;r<u.length;r++)o=u[r],t=t.concat(this.getSelectedCellsNextWidgets(o,n));return t},n.prototype.getSelectedCellsNextWidgets=function(n,t){var f=[],e,u,i,r;if(!sf.base.isNullOrUndefined(n.nextWidget)&&(f.push(n.nextWidget),n.cellFormat.rowSpan>1))for(e=n.ownerRow.rowIndex+n.cellFormat.rowSpan,u=n.ownerRow.rowIndex+1;u<e;u++)if(i=t.childWidgets[u],i)for(r=0;r<i.childWidgets.length;r++)i.childWidgets[r].columnIndex===n.nextWidget.columnIndex&&f.push(i.childWidgets[r]);return f},n.prototype.getBorder=function(n,t,i){var r=new ft;return r.color=n||"#000000",r.lineWidth=t||1,r.lineStyle=i||"Single",r},n.prototype.applyBordersInternal=function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(n.top)||this.applyBorder(n.top,t.top),sf.base.isNullOrUndefined(n.bottom)||this.applyBorder(n.bottom,t.bottom),sf.base.isNullOrUndefined(n.left)||this.applyBorder(n.left,t.left),sf.base.isNullOrUndefined(n.right)||this.applyBorder(n.right,t.right),sf.base.isNullOrUndefined(n.horizontal)||this.applyBorder(n.horizontal,t.horizontal),sf.base.isNullOrUndefined(n.vertical)||this.applyBorder(n.vertical,t.vertical),sf.base.isNullOrUndefined(n.diagonalUp)||this.applyBorder(n.diagonalUp,t.diagonalUp),sf.base.isNullOrUndefined(n.diagonalDown)||this.applyBorder(n.diagonalDown,t.diagonalDown))},n.prototype.applyShading=function(n,t){sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(t.backgroundColor)||n.backgroundColor===t.backgroundColor||(n.backgroundColor=t.backgroundColor),sf.base.isNullOrUndefined(t.foregroundColor)||n.foregroundColor===t.foregroundColor||(n.foregroundColor=t.foregroundColor),sf.base.isNullOrUndefined(t.textureStyle)||n.textureStyle===t.textureStyle||(n.textureStyle=t.textureStyle))},n.prototype.applyBorder=function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(t)||(sf.base.isNullOrUndefined(t.color)||n.color===t.color||(n.color=t.color),sf.base.isNullOrUndefined(t.lineStyle)||n.lineStyle===t.lineStyle||(n.lineStyle=t.lineStyle),sf.base.isNullOrUndefined(t.lineWidth)||n.lineWidth===t.lineWidth||(n.lineWidth=t.lineWidth),sf.base.isNullOrUndefined(t.shadow)||n.shadow===t.shadow||(n.shadow=t.shadow),sf.base.isNullOrUndefined(t.space)||n.space===t.space||(n.space=t.space))},n.prototype.onTableFormat=function(n,t){var i,r,f,u;if(!sf.base.isNullOrUndefined(this.selection.tableFormat)){if(sf.base.isNullOrUndefined(t)&&(t=!1),this.documentHelper.owner.isShiftingEnabled=!0,this.editorHistory.initializeHistory("TableFormat"),i=this.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),t)for(r=0;r<i.childWidgets.length;r++)for(f=i.childWidgets[r],u=0;u<f.childWidgets.length;u++)f.childWidgets[u].cellFormat.shading.copyFormat(n.shading);this.applyTableFormat(i,void 0,n);this.reLayout(this.selection,!1)}},n.prototype.applyTableFormat=function(n,t,i){this.applyTablePropertyValue(this.documentHelper.selection,void 0,i,n)},n.prototype.applyTablePropertyValue=function(n,t,i,r){var u=r.tableFormat;sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedTableProperties(u,t,i));_instanceof(i,pt)?sf.base.isNullOrUndefined(t)&&this.handleTableFormat(u,i):("preferredWidth"===t?u.preferredWidth=i:"leftIndent"===t?u.leftIndent=i:"tableAlignment"===t?u.tableAlignment=i:"cellSpacing"===t?u.cellSpacing=i:"leftMargin"===t?u.leftMargin=i:"rightMargin"===t?u.rightMargin=i:"topMargin"===t?u.topMargin=i:"bottomMargin"===t?u.bottomMargin=i:"preferredWidthType"===t?u.preferredWidthType=i:"bidi"===t&&(u.bidi=i),"shading"===t?u.shading=i:"borders"===t&&(u.borders=i))},n.prototype.handleTableFormat=function(n,t){(this.isBordersAndShadingDialog||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(sf.base.isNullOrUndefined(n.borders)||this.applyBordersInternal(n.borders,t.borders),sf.base.isNullOrUndefined(n.shading)||this.applyShading(n.shading,t.shading));this.isBordersAndShadingDialog||(t.hasValue("bidi")&&t.bidi!==n.bidi&&(n.bidi=t.bidi),t.hasValue("preferredWidth")&&t.preferredWidth!==n.preferredWidth&&(n.preferredWidth=t.preferredWidth),t.hasValue("preferredWidthType")&&t.preferredWidthType!==n.preferredWidthType&&(n.preferredWidthType=t.preferredWidthType),t.hasValue("tableAlignment")&&t.tableAlignment!==n.tableAlignment&&(n.tableAlignment=t.tableAlignment),t.hasValue("leftIndent")&&t.leftIndent!==n.leftIndent&&(n.leftIndent=t.leftIndent),t.hasValue("topMargin")&&t.topMargin!==n.topMargin&&(n.topMargin=t.topMargin),t.hasValue("bottomMargin")&&t.bottomMargin!==n.bottomMargin&&(n.bottomMargin=t.bottomMargin),t.hasValue("leftMargin")&&t.leftMargin!==n.leftMargin&&(n.leftMargin=t.leftMargin),t.hasValue("rightMargin")&&t.rightMargin!==n.rightMargin&&(n.rightMargin=t.rightMargin),t.hasValue("cellSpacing")&&t.cellSpacing!==n.cellSpacing&&(n.cellSpacing=t.cellSpacing));this.updateGridForTableDialog(n.ownerBase,!1)},n.prototype.updateGridForTableDialog=function(n){n.tableHolder&&(n.updateRowIndex(0),n.calculateGrid(),n.isGridUpdated=!1);this.documentHelper.layout.reLayoutTable(n)},n.prototype.onRowFormat=function(n){if(!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(n)){this.editorHistory.initializeHistory("RowFormat");this.documentHelper.owner.isShiftingEnabled=!0;var t=this.selection.isForward?this.selection.start:this.selection.end,i=this.selection.isForward?this.selection.end:this.selection.start;t.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer);this.applyRowFormat(t.paragraph.associatedCell.ownerRow,t,i,void 0,n);this.reLayout(this.selection,!1)}},n.prototype.applyRowFormat=function(n,t,i,r,u){if(this.applyRowPropertyValue(this.documentHelper.selection,r,u,n),i.paragraph.associatedCell.ownerRow!==n){var f=n.nextWidget;sf.base.isNullOrUndefined(f)||this.applyRowFormat(f,t,i,r,u)}},n.prototype.applyRowPropertyValue=function(n,t,i,r){var u=r.rowFormat;sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedRowProperties(u,t,i));_instanceof(i,ti)?sf.base.isNullOrUndefined(t)&&this.handleRowFormat(i,u):("heightType"===t?u.heightType=i:"height"===t?u.height=i:"isHeader"===t?u.isHeader=i:"allowBreakAcrossPages"===t&&(u.allowBreakAcrossPages=i),sf.base.isNullOrUndefined(r.ownerTable)||this.layoutItemBlock(r.ownerTable,!0))},n.prototype.handleRowFormat=function(n,t){n.hasValue("allowBreakAcrossPages")&&n.allowBreakAcrossPages!==t.allowBreakAcrossPages&&(t.allowBreakAcrossPages=n.allowBreakAcrossPages);n.hasValue("isHeader")&&n.isHeader!==t.isHeader&&(t.isHeader=n.isHeader);n.hasValue("heightType")&&n.heightType!==t.heightType&&(t.heightType=n.heightType);n.hasValue("height")&&n.height!==t.height&&(t.height=n.height);this.updateGridForTableDialog(t.ownerBase.ownerTable,!0)},n.prototype.onCellFormat=function(n){sf.base.isNullOrUndefined(this.selection)||sf.base.isNullOrUndefined(n)||(this.editorHistory.initializeHistory("CellFormat"),this.updateFormatForCell(this.selection,void 0,n),this.reLayout(this.selection,!1))},n.prototype.updateCellMargins=function(n){var t=n.start;n.end;n.isForward||(t=n.end,n.start);this.initHistoryPosition(n,t)},n.prototype.updateFormatForCell=function(n,t,i){var o=n.start,s=n.end,u;n.isForward||(o=n.end,s=n.start);for(var f,r=o.paragraph.associatedCell,h=s.paragraph.associatedCell,c=r.ownerTable.combineWidget(this.owner.viewer),e=r.columnIndex;e<=h.columnIndex;e++)for(f=this.getSelectedCellInColumn(r.ownerTable,r.ownerRow.rowIndex,e,h.ownerRow.rowIndex),u=0;u<f.length;u++)this.applyCellPropertyValue(this.documentHelper.selection,t,i,f[u].cellFormat);this.updateGridForTableDialog(c,!1)},n.prototype.getSelectedCellInColumn=function(n,t,i,r){for(var e,u,o=[],f=t;f<=r;f++)for(e=n.childWidgets[f],u=0;u<e.childWidgets.length;u++)e.childWidgets[u].columnIndex===i&&o.push(e.childWidgets[u]);return o},n.prototype.getColumnCells=function(n,t,i){for(var o,e,r,u=[],f=0;f<n.childWidgets.length;f++)for(o=n.childWidgets[f],e=0;e<o.childWidgets.length;e++)r=o.childWidgets[e],i?r.columnIndex+r.cellFormat.columnSpan===t&&u.push(r):r.columnIndex===t&&u.push(r);return u},n.prototype.getTableWidth=function(n){return 0!==n.tableFormat.preferredWidth||"Percent"===n.tableFormat.preferredWidthType?"Auto"===n.tableFormat.preferredWidthType||"Point"===n.tableFormat.preferredWidthType?n.tableFormat.preferredWidth:0===n.tableFormat.preferredWidth?0:t.convertPixelToPoint(this.owner.viewer.clientArea.width)/100*n.tableFormat.preferredWidth:t.convertPixelToPoint(this.documentHelper.layout.getTableWidth(n))},n.prototype.applyCellPropertyValue=function(n,t,i,r){if(sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedCellProperties(r,t,i)),_instanceof(i,si))return sf.base.isNullOrUndefined(t)&&this.handleCellFormat(i,r),i;"leftMargin"===t?r.leftMargin=i:"topMargin"===t?r.topMargin=i:"rightMargin"===t?r.rightMargin=i:"bottomMargin"===t?r.bottomMargin=i:"preferredWidth"===t?(r.preferredWidth=i,r.cellWidth=i):"cellWidth"===t?r.cellWidth=i:"columnSpan"===t?r.columnSpan=i:"rowSpan"===t?r.rowSpan=i:"preferredWidthType"===t?r.preferredWidthType=i:"verticalAlignment"===t&&(r.verticalAlignment=i);"shading"===t?r.shading=i:"borders"===t&&(r.borders=i)},n.prototype.handleCellFormat=function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(t)||(this.isBordersAndShadingDialog?(sf.base.isNullOrUndefined(n.borders)||this.applyBordersInternal(t.borders,n.borders),sf.base.isNullOrUndefined(n.shading)||this.applyShading(t.shading,n.shading)):(n.hasValue("preferredWidth")&&t.preferredWidth!==n.preferredWidth&&(t.preferredWidth=n.preferredWidth),n.hasValue("preferredWidthType")&&t.preferredWidthType!==n.preferredWidthType&&(t.preferredWidthType=n.preferredWidthType),n.hasValue("verticalAlignment")&&t.verticalAlignment!==n.verticalAlignment&&(t.verticalAlignment=n.verticalAlignment),n.hasValue("leftMargin")&&t.leftMargin!==n.leftMargin&&(t.leftMargin=n.leftMargin),n.hasValue("rightMargin")&&t.rightMargin!==n.rightMargin&&(t.rightMargin=n.rightMargin),n.hasValue("topMargin")&&t.topMargin!==n.topMargin&&(t.topMargin=n.topMargin),n.hasValue("bottomMargin")&&t.bottomMargin!==n.bottomMargin&&(t.bottomMargin=n.bottomMargin)))},n.prototype.destroy=function(){this.documentHelper=void 0;this.nodes=[]},n.prototype.updateToc=function(n){if(sf.base.isNullOrUndefined(n)&&(n=this.selection.getTocFieldInternal()),this.documentHelper.layout.isTocField(n)){var t=this.selection.getFieldCode(n);-1!==t.toLocaleLowerCase().indexOf("toc")&&this.insertTableOfContents(this.validateTocSettings(this.getTocSettings(t,n)))}},n.prototype.getTocSettings=function(n,t){var i={includePageNumber:!0,rightAlign:!0},e,u,r,o,f;if("toc \\mergeformat"===n.toLowerCase())i.startLevel=1,i.endLevel=3;else for(e=n.split("\\"),u=0;u<e.length;u++)if(r=e[u],0!==r.length)switch(r[0]){case"o":sf.base.isNullOrUndefined(r.match(/\d+/g))?(i.startLevel=1,i.endLevel=9):(o=r.match(/\d+/g).map(Number),i.startLevel=o[0],i.endLevel=o[1]);break;case"h":i.includeHyperlink=!0;break;case"n":i.includePageNumber=!1;break;case"p":i.rightAlign=!1;break;case"u":i.includeOutlineLevels=!0;break;case"t":this.decodeTSwitch(i,r)}return f=t.paragraph.paragraphFormat.getUpdatedTabs(),f.length>0&&(i.tabLeader=f[f.length-1].tabLeader),i.rightAlign&&sf.base.isNullOrUndefined(i.tabLeader)&&(i.tabLeader="Dot"),i},n.prototype.decodeTSwitch=function(n,t){n.levelSettings={};for(var r=(t=(t=(t=(t=t.replace("t","")).replace('"',"")).replace('"',"")).trim()).split(","),i=0;i<r.length;i++)n.levelSettings[r[i]]=parseInt(r[i+1],10),i++},n.prototype.insertTableOfContents=function(n){var l,t,o,e,s,h,y,f;this.isInsertingTOC=!0;this.initComplexHistory("TOC");sf.base.isNullOrUndefined(n)&&((n={}).startLevel=1,n.endLevel=3,n.includeHyperlink=!0,n.includeOutlineLevels=!0,n.includePageNumber=!0,n.rightAlign=!0,n.tabLeader="Dot");t=void 0;("TableOfContents"===this.selection.contextType&&(t=this.selection.getTocFieldInternal()),_instanceof(t,r))&&(this.selection.start.setPositionForSelection(t.line,t,0,this.selection.start.location),o=2,t.fieldEnd.paragraph===t.fieldEnd.paragraph.bodyWidget.lastChild&&o--,this.selection.end.setPositionForSelection(t.fieldEnd.line,t.fieldEnd,o,this.selection.end.location),this.delete());l=this.constructTocFieldCode(n);var a=this.selection.start.isAtParagraphStart,v=this.selection.getParagraphInfo(this.selection.start),p=this.selection.getHierarchicalIndex(v.paragraph,v.offset.toString()),i=this.buildToc(this.validateTocSettings(n),l,!0,a);i.length>0&&(e=new u,s=new k(e),e.childWidgets.push(s),h=0,a||(h=1),y=i[h].childWidgets[0].children[0],this.appendEndField(y,s),i.push(e),this.appendEmptyPara(i));this.setPositionForCurrentIndex(this.selection.start,p);this.selection.end.setPositionInternal(this.selection.start);f=new c;f.sectionFormat=new dt(f);f.childWidgets=i;this.pasteContentsInternal([f],!1);this.isInsertingTOC=!1;this.updatePageRef();this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();0===i.length&&(this.owner.editorHistory.undo(),this.owner.editorHistory.redoStack.pop())},n.prototype.appendEmptyPara=function(n){var t=new u,i=new k(t);t.childWidgets.push(i);n.push(t)},n.prototype.constructTocFieldCode=function(n){var t="TOC",i;return sf.base.isNullOrUndefined(n.startLevel)||0===n.startLevel||sf.base.isNullOrUndefined(n.endLevel)||0===n.endLevel||(t=t+' \\o "'+n.startLevel+"-"+n.endLevel+'"'),n.includePageNumber&&!n.rightAlign&&(t+=' \\p " "'),n.includePageNumber||(t+=" \\n"),n.includeHyperlink&&(t+=" \\h \\z"),n.includeOutlineLevels&&(t+=" \\u"),i=this.constructTSwitch(n),i.length>6&&(t+=i),t},n.prototype.constructTSwitch=function(n){var t="",i,r,u;if(!sf.base.isNullOrUndefined(n.levelSettings))for(i=0,r=Object.keys(n.levelSettings);i<r.length;i++)u=r[i],t=t+u+","+n.levelSettings[u].toString()+",";return' \\t "'+(t=t.slice(0,-1))+'"'},n.prototype.appendEndField=function(n,t){var i=new r(1),u;(i.fieldSeparator=n.fieldSeparator,n.fieldSeparator.fieldEnd=i,i.fieldBegin=n,i.fieldBegin.fieldEnd=i,i.line=t,n.revisions.length>0)&&(u=n.revisions[n.revisions.length-1],u.range.push(i),i.revisions.push(u));t.children.push(i)},n.prototype.validateTocSettings=function(n){return(sf.base.isNullOrUndefined(n.startLevel)||n.startLevel<1)&&(n.startLevel=1),(sf.base.isNullOrUndefined(n.endLevel)||n.endLevel<n.endLevel)&&(n.endLevel=n.startLevel>3?n.startLevel:3),sf.base.isNullOrUndefined(n.includeHyperlink)&&(n.includeHyperlink=!1),sf.base.isNullOrUndefined(n.includePageNumber)&&(n.includePageNumber=!1),sf.base.isNullOrUndefined(n.rightAlign)&&(n.rightAlign=!1),sf.base.isNullOrUndefined(n.levelSettings)&&(n.levelSettings={}),n},n.prototype.buildToc=function(n,t,i,r){var h=this.documentHelper.pages[0].bodyWidgets[0],e=[],o,f,s;for(this.createHeadingLevels(n),n.includeOutlineLevels&&this.createOutlineLevels(n),o=this.selection.start.paragraph.bodyWidget.sectionFormat,f=h.childWidgets[0];void 0!==f;)_instanceof(f,u)&&(this.isHeadingStyle(f)||n.includeOutlineLevels&&this.isOutlineLevelStyle(f))&&(s=this.insertTocBookmark(f),this.createTOCWidgets(f,e,t,s,n,i,r,o),i=!1),f=this.selection.getNextParagraphBlock(f.getSplitWidgets().pop());return this.tocStyles={},e},n.prototype.createOutlineLevels=function(n){for(var i,t=n.startLevel;t<=n.endLevel;t++)i="Level"+t.toString(),sf.base.isNullOrUndefined(this.tocStyles[i])&&(this.tocStyles[i]=t)},n.prototype.createHeadingLevels=function(n){for(var r,i,u,f,t=n.startLevel;t<=n.endLevel;t++)r="Heading "+t.toString(),sf.base.isNullOrUndefined(this.tocStyles[r])&&(this.tocStyles[r]=t);if(!sf.base.isNullOrUndefined(n.levelSettings))for(i=0,u=Object.keys(n.levelSettings);i<u.length;i++)f=u[i],this.tocStyles[f]=n.levelSettings[f]},n.prototype.isHeadingStyle=function(n){var t=n.paragraphFormat.baseStyle;return void 0!==t&&!sf.base.isNullOrUndefined(this.tocStyles[t.name])},n.prototype.isOutlineLevelStyle=function(n){var t=n.paragraphFormat.outlineLevel;return!sf.base.isNullOrUndefined(this.tocStyles[t])},n.prototype.createTocFieldElement=function(n,t){var f=new r(0),e,u;return f.hasFieldEnd=!0,f.line=n,n.children.push(f),e=new i,e.text=t,e.line=n,n.children.push(e),u=new r(2),u.fieldBegin=f,u.fieldBegin.fieldSeparator=u,u.line=n,n.children.push(u),f},n.prototype.createTOCWidgets=function(n,t,f,s,h,c,l,a){var et=void 0,y=void 0,v=void 0,lt=!1,ot,st,nt,tt,w,it,ct,rt,p,g,ut,ft,at,vt;1!==t.length||3!==t[0].childWidgets[0].children.length||sf.base.isNullOrUndefined(c)||c?(y=new u,ot=void 0,st=n.paragraphFormat.baseStyle.name,ot=h.includeOutlineLevels&&sf.base.isNullOrUndefined(this.tocStyles[st])?n.paragraphFormat.outlineLevel:st,nt="Toc"+this.tocStyles[ot],tt=this.documentHelper.styles.findByName(nt,"Paragraph"),(sf.base.isNullOrUndefined(tt)&&(this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(nt)),this.documentHelper.styles),tt=this.documentHelper.styles.findByName(nt,"Paragraph")),y.paragraphFormat.applyStyle(tt),h.rightAlign&&h.includePageNumber)&&(w=new hu,w.position=a.pageWidth-(a.leftMargin+a.rightMargin),w.tabLeader=h.tabLeader,w.deletePosition=0,w.tabJustification="Right",y.paragraphFormat.tabs.push(w)),v=new k(y),y.childWidgets.push(v)):v=t[0].childWidgets[0];void 0!==c&&c&&(sf.base.isNullOrUndefined(l)||l||(this.appendEmptyPara(t),lt=!0),this.createTocFieldElement(v,f));for(var b="",ht=!1,d=n;_instanceof(d,u);){for(it=0;it<d.childWidgets.length;it++)for(ct=d.childWidgets[it],rt=0;rt<ct.children.length;rt++)p=ct.children[rt],p.isPageBreak||(_instanceof(p,r)||_instanceof(p,e)||ht?_instanceof(p,r)&&(0===p.fieldType?ht=!0:2===p.fieldType&&(ht=!1)):(_instanceof(p,i)||_instanceof(p,o))&&(g=p.text,-1!==g.indexOf("\t")&&(g=g.replace(new RegExp("\t","g")," ")),b+=g));d=d.nextSplitWidget}""!==b&&(h.includeHyperlink&&void 0!==s?et=this.insertTocHyperlink(v,s,b):(ut=new i,ut.text=b,ut.line=v,v.children.push(ut)),h.includePageNumber&&void 0!==s&&(h.rightAlign&&(ft=new oi,ft.text="\t",ft.line=v,v.children.push(ft)),at=this.insertTocPageNumber(s,v,h.rightAlign,n),this.appendEndField(at,v)),h.includeHyperlink&&void 0!==et&&this.appendEndField(et,v));(sf.base.isNullOrUndefined(y)||""===b&&!c||t.push(y),this.owner.enableTrackChanges&&!sf.base.isNullOrUndefined(y))&&(1===t.length||lt?this.insertRevisionForBlock(y,"Insertion",!0):(vt=this.owner.revisionsInternal.changes[0],this.insertRevisionForBlock(y,"Insertion",!0,vt)))},n.prototype.insertTocHyperlink=function(n,t,r){var f=' HYPERLINK \\l "'+t+'" ',e=this.createTocFieldElement(n,f,!0),u=new i;return u.text=r,u.line=n,n.children.push(u),e},n.prototype.insertTocPageNumber=function(n,t,i,r){var o=" PAGEREF"+n+" \\h ",e=this.createTocFieldElement(t,o,!0),f=(this.documentHelper.pages.indexOf(r.bodyWidget.page)+1).toString(),u=new ci;return u.fieldBegin=e,i||(f=" "+f),u.text=f,u.line=t,t.children.push(u),this.pageRefFields[n]=u,e},n.prototype.updatePageRef=function(){for(var i,u,n,t=0,r=Object.keys(this.pageRefFields);t<r.length;t++)if(i=r[t],this.documentHelper.bookmarks.containsKey(i)&&(u=(this.documentHelper.bookmarks.get(i).paragraph.bodyWidget.page.index+1).toString(),n=this.pageRefFields[i],u!==n.text)){n.text=u;var f=n.paragraph,e=f.childWidgets.indexOf(n.line),o=n.line.children.indexOf(n);this.documentHelper.layout.reLayoutParagraph(f,e,o)}},n.prototype.insertTocBookmark=function(n){var u=void 0,t,r;if(n.childWidgets.length>0){var s=n.getSplitWidgets(),c=s[0],h=s.pop(),f=c.childWidgets[0],i=h.childWidgets[h.childWidgets.length-1];if(void 0!==f&&void 0!==i){if(t=f.children[0],_instanceof(t,o)||_instanceof(t,g))do t=t.nextNode;while(_instanceof(t,o)||_instanceof(t,g));if(!sf.base.isNullOrUndefined(t)&&_instanceof(t,e)&&0===t.bookmarkType&&t.name.toLowerCase().match("^_toc"))return t.name;r=i.children[i.children.length-1];void 0!==t&&void 0!==r&&(this.selection.start.setPositionForSelection(f,t,0,this.selection.start.location),this.selection.end.setPositionForSelection(i,r,r.length,this.selection.end.location),u=this.generateBookmarkName(),this.insertBookmark(u))}}return u},n.prototype.generateBookmarkName=function(){this.tocBookmarkId++;for(var t=10-this.tocBookmarkId.toString().length,n="";t-1>0;)n="0"+n,t--;return"_Toc"+n+this.tocBookmarkId},n.prototype.onCellContentAlignment=function(n,t){var i,r;this.owner.isShiftingEnabled=!0;i=this.owner.selection;i.isEmpty&&i.start.paragraph.isInsideTable?(this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(i,"MultiSelection"),i.selectTableCell(),this.initHistory("CellContentVerticalAlignment"),r=i.start.paragraph.associatedCell.cellFormat,this.applyCellPropertyValue(i,"verticalAlignment",n,r),this.reLayout(i,!1),this.initHistory("TextAlignment"),this.updateParagraphFormat("textAlignment",t,!1),this.reLayout(this.owner.selection,!1),this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory()):(this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(i,"MultiSelection"),sf.base.isNullOrUndefined(i.getTable(i.start,i.end))||(this.updateSelectionTableFormat(i,"CellContentVerticalAlignment",n),this.reLayout(this.owner.selection,!1),this.initHistory("TextAlignment"),this.updateSelectionParagraphFormatting("textAlignment",t,!1),this.reLayout(i,!1)),this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory())},n.prototype.insertEditRangeElement=function(n){var i,r,f,u,l,t,h,c;if(!this.documentHelper.isDocumentProtected&&!this.documentHelper.selection.isEmpty){if(this.initComplexHistory("RestrictEditing"),this.selection.skipEditRangeRetrieval=!0,i=this.documentHelper.selection,this.selection.start,this.selection.end,this.selection.isForward||(this.selection.end,this.selection.start),i.start.paragraph.isInsideTable&&i.end.paragraph.isInsideTable&&i.start.paragraph.associatedCell.ownerTable.contains(i.end.paragraph.associatedCell))if(r=this.getOwnerCell(this.selection.isForward),f=this.getOwnerCell(!this.selection.isForward),r.rowIndex===f.rowIndex){for(var a=r.ownerRow.childWidgets.indexOf(r),v=r.ownerRow.childWidgets.indexOf(f),e=[],o=[],s=a;s<=v;s++)u=this.addEditElement(n),u.columnFirst=s,u.columnLast=s,u.line=i.start.currentWidget,l=u.editRangeEnd,l.line=i.end.currentWidget,e.push(u),o.push(l);this.insertElements(o,e);t=e[0].line.getOffset(e[0],1);this.selection.start.setPositionParagraph(e[0].line,t);t=o[0].line.getOffset(o[0],1);this.selection.end.setPositionParagraph(o[0].line,t);this.selection.fireSelectionChanged(!0);this.fireContentChange()}else this.insertEditRangeInsideTable(r,f,n),h=this.selection.getFirstParagraphInCell(r).childWidgets[0],c=this.selection.getLastParagraph(f).childWidgets[0],t=h.getOffset(h.children[0],1),this.selection.start.setPositionParagraph(h,t),t=c.getOffset(c.children[0],1),this.selection.end.setPositionParagraph(c,t),this.selection.fireSelectionChanged(!0),this.fireContentChange();else this.addRestrictEditingForSelectedArea(n);this.selection.skipEditRangeRetrieval=!1}},n.prototype.insertEditRangeInsideTable=function(n,t,i){var p=n.ownerTable,k=p.childWidgets.indexOf(t.ownerRow),et=p.childWidgets.indexOf(n.ownerRow),a=this.selection.getCellLeft(n.ownerRow,n),w=a+n.cellFormat.cellWidth,d=this.selection.getCellLeft(t.ownerRow,t),ot=d+t.cellFormat.cellWidth,g=this.updateSelectedCellsInTable(a,w,d,ot),r,s,nt,tt,b,e,f,ut,u,ft,y;for(a=g.start,w=g.end,r=[],s=et;s<=k;s++){for(var h=p.childWidgets[s],c=-1,v=-1,l=0;l<h.childWidgets.length;l++)nt=h.childWidgets[l],tt=this.selection.getCellLeft(h,nt),this.checkCellWithInSelection(a,w,tt)&&(-1===c&&(c=l),v=l);for(b=[],e=c;e<=v;e++){var o=0,it=void 0,rt=void 0;if(e===c&&(it=h.childWidgets[c],rt=this.selection.getFirstParagraphInCell(it).childWidgets[0]),f=this.addEditElement(i),f.columnFirst=e,f.columnLast=e,f.line=rt,f.line.children.splice(o,0,f),o++,ut=f.editRangeEnd,b.push(ut),r.length>0&&e===v){for(u=0;u<r.length;u++)r[u].line=f.line,f.line.children.splice(o,0,r[u]),o++;r=[]}}if(r=b,s===k&&r.length>0)for(ft=h.childWidgets[v],y=this.selection.getLastParagraph(ft).lastChild,o=y.children.length-1,u=0;u<r.length;u++)r[u].line=y,y.children.splice(o,0,r[u]),o++}},n.prototype.addRestrictEditingForSelectedArea=function(n){var t=this.addEditElement(n),i=t.editRangeEnd,r;this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=t);this.insertElements([i],[t]);this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();r=t.line.getOffset(t,1);this.selection.start.setPositionParagraph(t.line,r);r=i.line.getOffset(i,1);this.selection.end.setPositionParagraph(i.line,r);this.selection.fireSelectionChanged(!0);this.fireContentChange()},n.prototype.addEditElement=function(n){var t=new ht,i;return"everyone"===n.toLocaleLowerCase()?t.group=n:t.user=n,i=new ot,i.editRangeStart=t,t.editRangeEnd=i,this.editStartRangeCollection.push(t),this.addEditCollectionToDocument(),this.editStartRangeCollection=[],t},n.prototype.protect=function(n){this.documentHelper.isDocumentProtected=!0;this.documentHelper.protectionType=n;this.selection.highlightEditRegion();this.editorHistory&&this.editorHistory.destroy()},n.prototype.addEditCollectionToDocument=function(){for(var n,i,r,t=0;t<this.editStartRangeCollection.length;t++)n=this.editStartRangeCollection[t],i=""===n.user?n.group:n.user,this.documentHelper.editRanges.length>0&&this.documentHelper.editRanges.containsKey(i)?this.documentHelper.editRanges.get(i).push(n):(r=[],r.push(n),this.documentHelper.editRanges.add(i,r));this.selection.updateEditRangeCollection()},n.prototype.updateRangeCollection=function(n,t){if(this.documentHelper.editRanges.length>0&&this.documentHelper.editRanges.containsKey(t))this.documentHelper.editRanges.get(t).push(n);else{var i=[];i.push(n);this.documentHelper.editRanges.add(t,i)}},n.prototype.removeUserRestrictions=function(n){if(this.selection.checkSelectionIsAtEditRegion()){this.selection.skipEditRangeRetrieval=!0;var t=this.selection.getEditRangeStartElement();this.initHistory("RemoveEditRange");this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setEditRangeInfo(t),this.editorHistory.updateHistory());t.user!==n&&t.group!==n||this.removeUserRestrictionsInternal(t,n);this.selection.updateEditRangeCollection();this.fireContentChange();this.selection.skipEditRangeRetrieval=!1}},n.prototype.removeUserRestrictionsInternal=function(n,t){var i=t,r;sf.base.isNullOrUndefined(t)&&(i=""===n.user?n.group:n.user);r=this.documentHelper.editRanges.get(i).indexOf(n);this.documentHelper.editRanges.get(i).splice(r,1);0===this.documentHelper.editRanges.get(i).length&&this.documentHelper.editRanges.remove(i);n.removeEditRangeMark();n.editRangeEnd.line.children.splice(n.editRangeEnd.indexInOwner,1);n.line.children.splice(n.indexInOwner,1)},n.prototype.removeAllEditRestrictions=function(){var n;this.selection.skipEditRangeRetrieval=!0;for(var u=this.selection.start,f=this.selection.end,t=[],r=this.documentHelper.editRanges.keys,i=0;i<r.length;i++)for(t=this.documentHelper.editRanges.get(r[i]),n=0;n<t.length;n++)t[n].editRangeEnd.line.children.splice(t[n].editRangeEnd.indexInOwner,1),t[n].line.children.splice(t[n].indexInOwner,1);this.documentHelper.editRanges.clear();this.selection.updateEditRangeCollection();this.selection.start.setPositionInternal(u);this.selection.end.setPositionInternal(f);this.selection.editRegionHighlighters.clear();this.owner.viewer.updateScrollBars();this.selection.fireSelectionChanged(!1);this.selection.skipEditRangeRetrieval=!1},n.prototype.insertFormField=function(n){if(!sf.base.isNullOrUndefined(this.selection.start)&&!this.owner.enableHeaderAndFooter){this.initHistory("InsertHyperlink");var t=!0;this.selection.isEmpty||(t=this.removeSelectedContents(this.selection));t&&this.insertFormFieldInternal(n)}},n.prototype.insertFormFieldInternal=function(n){var t,s,l,a,h,c,u,v;this.updateInsertPosition();var f=[],y=this.getCharacterFormat(this.selection),o=new p(void 0);o.copyFormat(y);t=new r(0);t.formFieldData=this.getFormFieldData(n);t.characterFormat.copyFormat(o);f.push(t);s=new e(0);s.characterFormat.copyFormat(o);t.formFieldData.name=this.getBookmarkName(n,"Insert",this.formFieldCounter);s.name=t.formFieldData.name;f.push(s);l=new i;l.text=this.getFormFieldCode(n);f.push(l);a=new r(2);f.push(a);h=new i;h.text="CheckBox"===n?String.fromCharCode(9744):this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5);h.characterFormat.copyFormat(o);f.push(h);c=new r(1);c.characterFormat.copyFormat(o);f.push(c);u=new e(1);u.characterFormat.copyFormat(o);u.name=t.formFieldData.name;u.reference=s;s.reference=u;f.push(u);this.insertElement(f);this.selection.start.paragraph;c.linkFieldCharacter(this.documentHelper);-1===this.documentHelper.fields.indexOf(t)&&this.documentHelper.fields.push(t);-1===this.documentHelper.formFields.indexOf(t)&&this.documentHelper.formFields.push(t);v=u.line.getOffset(u,1);this.selection.selects(u.line,v,!0);this.updateEndPosition();this.reLayout(this.selection,!0)},n.prototype.getFormFieldData=function(n){switch(n){case"Text":return new vt;case"CheckBox":return new bt;case"DropDown":return new kt}},n.prototype.setFormField=function(n,t){var r,i;sf.base.isNullOrUndefined(t.format)?sf.base.isNullOrUndefined(t.sizeType)?sf.base.isNullOrUndefined(t.dropdownItems)||(r="DropDown",i=new kt):(r="CheckBox",i=new bt):(r="Text",i=new vt);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(i)||(i.name=n.formFieldData.name,i.copyFieldInfo(t),this.editFormField(r,i))},n.prototype.editFormField=function(n,u){var l,c,f=this.selection.getCurrentFormField(),d,a,g,b,v,o,h,s,k,y,w,nt;return sf.base.isNullOrUndefined(f)||sf.base.isNullOrUndefined(f.formFieldData)?!1:(this.initComplexHistory("FormField"),""!==u.name&&(f.formFieldData.name!==u.name&&this.documentHelper.bookmarks.containsKey(u.name)&&this.deleteBookmark(u.name),(l=new e(0)).name=u.name,(c=new e(1)).name=u.name,l.reference=c,c.reference=l),this.initHistory("InsertHyperlink"),this.editHyperlinkInternal=sf.base.isNullOrUndefined(this.editorHistory)||this.editorHistory&&sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo),d=f.characterFormat.cloneFormat(),a=new p,a.copyFormat(d),g=f.fieldSeparator.nextElement.characterFormat.cloneFormat(),b=f.line.getOffset(f,0),this.selection.start.setPositionParagraph(f.line,b),v=f.fieldEnd,f.nextNode&&_instanceof(f.nextNode,e)&&(v=f.nextNode.reference),b=v.line.getOffset(v,1),this.selection.end.setPositionParagraph(v.line,b),this.skipFieldDeleteTracking=!0,this.deleteSelectedContents(this.selection,!1),this.skipFieldDeleteTracking=!1,this.updateInsertPosition(),o=[],h=new r(0),h.formFieldData=u,o.push(h),h.characterFormat.copyFormat(a),sf.base.isNullOrUndefined(l)||o.push(l),s=new i,s.text=this.getFormFieldCode(n),o.push(s),k=new r(2),k.characterFormat.copyFormat(a),o.push(k),(s=new i).characterFormat.copyFormat(g),s.text=this.getDefaultText(u),"CheckBox"===n?(s.characterFormat.copyFormat(h.characterFormat),"Exactly"===u.sizeType&&(s.characterFormat.fontSize=u.size)):_instanceof(u,vt)&&""!==u.defaultValue&&(s.text="Text"===u.type?t.formatText(u.format,u.defaultValue):"Number"===u.type?t.formatNumber(u.format,u.defaultValue):t.formatDate(u.format,u.defaultValue)),o.push(s),y=new r(1),y.characterFormat.copyFormat(a),o.push(y),w=y,sf.base.isNullOrUndefined(c)||(w=c,o.push(c)),this.insertElement(o),this.selection.start.paragraph,y.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(h)&&this.documentHelper.fields.push(h),nt=w.line.getOffset(w,1),this.selection.selects(w.line,nt,!0),this.updateEndPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.updateHistory(),this.editorHistory&&this.editorHistory.currentHistoryInfo&&this.editorHistory.updateComplexHistory(),this.reLayout(this.selection,!0),this.editHyperlinkInternal=!1,this.nodes=[],!0)},n.prototype.getDefaultText=function(n){var t="";return _instanceof(n,bt)?t=n.defaultValue?String.fromCharCode(9745):String.fromCharCode(9744):_instanceof(n,kt)?t=n.dropdownItems.length>0?n.dropdownItems[0]:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5):_instanceof(n,vt)&&(t=""!==n.defaultValue?n.defaultValue:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5)),t},n.prototype.getFormFieldCode=function(n){switch(n){case"Text":return"FORMTEXT";case"CheckBox":return"FORMCHECKBOX";case"DropDown":return"FORMDROPDOWN"}},n.prototype.toggleCheckBoxFormField=function(n,t,i){var r=n.formFieldData,u,f;_instanceof(r,bt)&&r.enabled&&((this.initHistory("UpdateFormField"),this.editorHistory)&&(u=void 0,_instanceof(r,bt)&&(u=r.checked),this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(n,u),this.editorHistory.updateHistory()),r.checked=t?i:!r.checked,f=n.fieldSeparator.nextNode,f.text=r.checked?String.fromCharCode(9745):String.fromCharCode(9744),this.owner.documentHelper.layout.reLayoutParagraph(n.line.paragraph,0,0),this.reLayout(this.selection,!1))},n.prototype.updateFormField=function(n,t,i){var r=n.formFieldData,u;r&&((this.initHistory("UpdateFormField"),this.editorHistory)&&(u=void 0,_instanceof(r,vt)?u=n.resultText:_instanceof(r,kt)&&(u=r.selectedIndex),this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(n,u),this.editorHistory.updateHistory()),this.updateFormFieldInternal(n,r,t,i))},n.prototype.updateFormFieldInternal=function(n,i,r,u){var e,o,s,f;_instanceof(i,vt)?(""===r&&(r=u?this.getDefaultText(i):this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5)),e=r,"Text"===i.type&&""!==i.format&&(e=t.formatText(i.format,r)),this.updateFormFieldResult(n,e)):_instanceof(i,kt)&&(o=i.dropdownItems[r],i.selectedIndex=r,this.updateFormFieldResult(n,o));s=n.fieldEnd.line.getOffset(n.fieldEnd,1);f=new l(this.owner);f.setPositionParagraph(n.fieldEnd.line,s);this.documentHelper.selection.selectRange(f,f);this.reLayout(this.selection,!1)},n.prototype.updateFormFieldResult=function(n,t){for(var f,e,u,r=n.fieldSeparator.nextNode;!_instanceof(r,i)&&(r=r.nextNode)!==n.fieldEnd;);if(_instanceof(r,i)){r.text=t;r=r.nextNode;do if(f=n.line.children.indexOf(r),_instanceof(r,i))r=r.nextNode,n.line.children.splice(f,1);else{if(r===n.fieldEnd)break;r=r.nextNode}while(r!==n.fieldEnd)}this.owner.documentHelper.layout.reLayoutParagraph(n.line.paragraph,0,0);e=n.fieldEnd.line.getOffset(n.fieldEnd,1);u=new l(this.owner);u.setPositionParagraph(n.fieldEnd.line,e);this.documentHelper.selection.selectRange(u,u);this.reLayout(this.selection,!1)},n.prototype.checkBookmarkAvailability=function(n){for(var t=this.documentHelper.bookmarks,i=0;i<t.length;i++)if(t.containsKey(n))return!1;return!0},n.prototype.getBookmarkName=function(n,t,i){for(var r,u=!1;!1===u;)r=n+i,u=this.checkBookmarkAvailability(r,t),i+=1;return r},n.prototype.applyFormTextFormat=function(n){if(!sf.base.isNullOrUndefined(n)){var i=this.getFormFieldText(n),r=i;i=t.formatText(n.formFieldData.format,i);this.applyTextFormatInternal(n,i);this.initHistory("FormTextFormat");this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(n,r),this.editorHistory.updateHistory())}},n.prototype.insertSpaceInFormField=function(){if(this.documentHelper.isInlineFormFillProtectedMode&&this.selection.isInlineFormFillMode()){var n=this.getFormFieldText();0!==n.length&&"\r"!==n||(this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField()))}},n.prototype.getFormFieldText=function(n){sf.base.isNullOrUndefined(n)&&(n=this.selection.getCurrentFormField());var t=n.fieldSeparator;return this.getNextRenderedWidgetText(t)},n.prototype.getNextRenderedWidgetText=function(n){var e="",t,u;if(_instanceof(n,r)&&2===n.fieldType){t=n;do if(!sf.base.isNullOrUndefined(t)&&_instanceof(t,i)&&(e+=t.text),sf.base.isNullOrUndefined(t.nextNode)){if(e+="\r",u=t.paragraph.nextRenderedWidget,sf.base.isNullOrUndefined(u))break;for(_instanceof(u,f)&&(u=this.selection.getFirstParagraphBlock(u));u.isEmpty();)e+="\r",u=u.nextRenderedWidget;t=u.childWidgets[0].children[0]}else t=t.nextNode;while(!(_instanceof(t,r)&&1===t.fieldType&&t===n.fieldEnd))}return e},n.prototype.applyTextFormatInternal=function(n,t){var u=n.fieldSeparator.nextElement,o=0,e;t=t.replace(/\r/g,"");do if(!sf.base.isNullOrUndefined(u)&&_instanceof(u,i)&&(u.text=t.slice(o,o+u.text.length),o+=u.length),sf.base.isNullOrUndefined(u.nextElement))if(sf.base.isNullOrUndefined(u.line.nextLine)){if(this.documentHelper.layout.layoutBodyWidgetCollection(u.paragraph.index,u.paragraph.bodyWidget,u.paragraph,!0),e=u.paragraph.nextRenderedWidget,sf.base.isNullOrUndefined(e))break;for(_instanceof(e,f)&&(e=this.selection.getFirstParagraphBlock(e));e.isEmpty();)e=e.nextRenderedWidget;u=e.childWidgets[0].children[0]}else u=u.line.nextLine.children[0];else u=u.nextElement;while(!(_instanceof(u,r)&&1===u.fieldType&&_instanceof(u.fieldBegin.formFieldData,vt)));this.documentHelper.layout.layoutBodyWidgetCollection(u.paragraph.index,u.paragraph.bodyWidget,u.paragraph,!0);this.selection.isFormatUpdated=!0;this.reLayout(this.selection,!1);this.selection.isFormatUpdated=!1},n.prototype.constructCommentInitial=function(n){for(var i=n.split(" "),r="",t=0;t<i.length;t++)i[t].length>0&&""!==i[t]&&(r+=i[t][0]);return r},n.prototype.insertFootnote=function(){var n,s,t,f;if(!this.selection.isinFootnote&&!this.selection.isinEndnote){n=new yt;n.characterFormat.baselineAlignment="Superscript";n.footnoteType="Footnote";n.text="s";var e=new u,r=new k(e),o=new i;if(o.characterFormat.baselineAlignment="Superscript",o.line=r,o.text="?",r.children.push(o),t=new i,t.text=" ",t.line=r,r.children.push(t),e.childWidgets.push(r),e.footNoteReference=n,n.blocks.push(e),this.selection.isEmpty||this.selection.handleRightKey(),this.initInsertInline(n),n.paragraph.bodyWidget.page.footnoteWidget)for(f=0;f<n.paragraph.bodyWidget.page.footnoteWidget.childWidgets.length;f++)n.paragraph.bodyWidget.page.footnoteWidget.childWidgets[f].footNoteReference===n&&(s=n.paragraph.bodyWidget.page.footnoteWidget.childWidgets[f]);this.selection.start.setPositionForLineWidget(s.childWidgets[0],t.line.getOffset(t,n.text.length));this.selection.end.setPositionInternal(this.selection.start);this.reLayout(this.selection,!1);this.separator("footnote");this.continuationSeparator("footnote")}},n.prototype.updateFootnoteCollection=function(n){var i,r,t,u;if(-1===this.documentHelper.footnoteCollection.indexOf(n)){if(i=!1,this.documentHelper.footnoteCollection.length>0)for(r=this.selection.getElementPosition(n).startPosition,t=0;t<this.documentHelper.footnoteCollection.length;t++)if(u=this.selection.getElementPosition(this.documentHelper.footnoteCollection[t]).startPosition,r.isExistBefore(u)){i=!0;this.documentHelper.footnoteCollection.splice(t,0,n);break}i||this.documentHelper.footnoteCollection.push(n)}},n.prototype.insertEndnote=function(){var n,f,h,c,e,o;if(!this.selection.isinFootnote&&!this.selection.isinEndnote){this.documentHelper.layout.isEndnoteContentChanged=!0;n=new yt;n.characterFormat.baselineAlignment="Superscript";n.footnoteType="Endnote";n.text="s";var s=new u,t=new k(s),r=new i;if(r.characterFormat.baselineAlignment="Superscript",r.line=t,r.text="?",t.children.push(r),f=new i,f.text=" ",f.line=t,t.children.push(f),s.childWidgets.push(t),s.footNoteReference=n,n.blocks.push(s),this.selection.isEmpty||this.selection.handleRightKey(),this.initInsertInline(n),c=this.documentHelper.pages.length,e=this.documentHelper.pages[c-1].bodyWidgets[0],e.page.endnoteWidget)for(o=0;o<e.page.endnoteWidget.childWidgets.length;o++)e.page.endnoteWidget.childWidgets[o].footNoteReference===n&&(h=e.page.endnoteWidget.childWidgets[o]);this.selection.start.setPositionForLineWidget(h.childWidgets[0],r.line.getOffset(f,n.text.length));this.selection.end.setPositionInternal(this.selection.start);this.reLayout(this.selection,!1);this.separator("endnote");this.continuationSeparator("endnote");this.documentHelper.layout.isEndnoteContentChanged=!1}},n.prototype.updateEndnoteCollection=function(n){var s,l,e,a,v,t,c,f,d;if(-1===this.documentHelper.endnoteCollection.indexOf(n)){if(s=!1,this.documentHelper.endnoteCollection.length>0)for(l=this.selection.getElementPosition(n).startPosition,e=0;e<this.documentHelper.endnoteCollection.length;e++)if(a=this.selection.getElementPosition(this.documentHelper.endnoteCollection[e]).startPosition,l.isExistBefore(a)){s=!0;this.documentHelper.endnoteCollection.splice(e,0,n);break}if(s||this.documentHelper.endnoteCollection.push(n),v=this.documentHelper.pages.length,this.documentHelper.endnoteCollection.length>0){var o,y=!1,i=void 0,w=this.documentHelper.endnoteCollection.indexOf(n),h=1,b=void 0,r=this.documentHelper.pages[v-1].bodyWidgets[0];if(r.page.endnoteWidget)for(t=0;t<r.page.endnoteWidget.childWidgets.length;t++)if(c=this.documentHelper.endnoteCollection.indexOf(r.page.endnoteWidget.childWidgets[t].footNoteReference),c>w&&c-w==1){h=t;y=!0;break}for((o=n,_instanceof(r.page.endnoteWidget,it)&&"Endnote"===r.page.endnoteWidget.footNoteType)?i=r.page.endnoteWidget:(b=!0,(i=new it).footNoteType="Endnote",i.page=r.page,f=new u,f.characterFormat=new p,f.paragraphFormat=new ut,f.index=0,d=new k(f),f.childWidgets.push(d),i.childWidgets.push(f)),t=0;t<o.blocks.length;t++)o.blocks[t];y?i.childWidgets.splice(h,0,o.blocks[0]):i.childWidgets.push(o.blocks[0]);h++;b&&(r.page.endnoteWidget=i);i.height+=0}}},n.prototype.separator=function(n){var t=new u,f=new k(t),r=new i;r.characterFormat.fontColor="#00000000";r.line=f;r.text="\x03";f.children.push(r);t.childWidgets.push(f);"footnote"===n&&this.documentHelper.footnotes.separator.length<1?this.documentHelper.footnotes.separator.push(t):"endnote"===n&&this.documentHelper.endnotes.separator.length<1&&this.documentHelper.endnotes.separator.push(t)},n.prototype.continuationSeparator=function(n){var t=new u,f=new k(t),r=new i;r.characterFormat.fontColor="#00000000";r.line=f;r.text="\x04";f.children.push(r);t.childWidgets.push(f);"footnote"===n&&this.documentHelper.footnotes.continuationSeparator.length<1?this.documentHelper.footnotes.continuationSeparator.push(t):"endnote"===n&&this.documentHelper.endnotes.continuationSeparator.length<1&&this.documentHelper.endnotes.continuationSeparator.push(t)},n.prototype.onParagraphFormat=function(n){var t=this.documentHelper.selection,i=n.bidi&&-1!==t.paragraphFormat.listId;i||(this.documentHelper.layout.isBidiReLayout=!0);this.setPreviousBlockToLayout();this.initHistory("ParagraphFormat");this.documentHelper.owner.isShiftingEnabled=!0;this.documentHelper.selection.isEmpty?(this.applyParaFormatProperty(t.start.paragraph,void 0,n,!1),this.layoutItemBlock(t.start.paragraph,!1)):this.updateSelectionParagraphFormatting("ParagraphFormat",n,!1);this.reLayout(t);i||(this.documentHelper.layout.isBidiReLayout=!1)},n}(),ho=function(){function n(n,t){this.resizeContainerDiv=void 0;this.topLeftRect=void 0;this.topMiddleRect=void 0;this.topRightRect=void 0;this.bottomLeftRect=void 0;this.bottomMiddleRect=void 0;this.bottomRightRect=void 0;this.leftMiddleRect=void 0;this.rightMiddleRect=void 0;this.topLeftRectParent=void 0;this.topMiddleRectParent=void 0;this.topRightRectParent=void 0;this.bottomLeftRectParent=void 0;this.bottomMiddleRectParent=void 0;this.bottomRightRectParent=void 0;this.leftMiddleRectParent=void 0;this.rightMiddleRectParent=void 0;this.resizeMarkSizeIn=7;this.selectedImageWidget=void 0;this.baseHistoryInfo=void 0;this.isImageResizing=!1;this.isImageResizerVisible=!1;this.isImageMoveToNextPage=!1;this.selectedResizeElement=void 0;this.topValue=void 0;this.leftValue=void 0;this.owner=n;this.selectedImageWidget=new h;this.documentHelper=t;this.imageResizerPoints=new co;sf.base.isNullOrUndefined(this.imageResizerDiv)&&this.viewer&&this.documentHelper.pageContainer&&this.initializeImageResizer()}return Object.defineProperty(n.prototype,"currentImageElementBox",{get:function(){return this.currentImageElementBoxIn},set:function(n){this.currentImageElementBoxIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"resizeMarkSize",{get:function(){return this.resizeMarkSizeIn},set:function(n){this.resizeMarkSizeIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isShapeResize",{get:function(){return _instanceof(this.currentImageElementBox,nt)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),n.prototype.getModuleName=function(){return"ImageResizer"},n.prototype.setImageResizerPositions=function(n,t,i,r){this.imageResizerDivElement.style.top=t.toString()+"px";this.imageResizerDivElement.style.left=n.toString()+"px";this.imageResizerDivElement.style.borderWidth="0px";this.imageResizerDivElement.style.height=r+"px";this.imageResizerDivElement.style.width=_instanceof(this.owner.viewer,at)?i-n-this.documentHelper.scrollbarWidth+"px":i+"px";this.imageResizerDivElement.style.backgroundColor="transparent";this.imageResizerDivElement.style.overflow="hidden";this.imageResizerDivElement.style.position="absolute"},n.prototype.initializeImageResizer=function(){this.imageResizerDivElement=document.createElement("div");this.imageResizerDivElement.style.zIndex="1";this.imageResizerDivElement.style.display="none";this.documentHelper.pageContainer.appendChild(this.imageResizerDivElement)},n.prototype.positionImageResizer=function(n){var t,u,r,f,i,h,c,p;this.selectedImageWidget.clear();sf.base.isNullOrUndefined(this.documentHelper.currentPage)||(t=this.imageResizerDivElement);sf.base.isNullOrUndefined(t)||t.contains(this.imageResizerDiv)||(this.imageResizerDiv=this.initResizeMarks(t,this));this.imageResizerDiv.style.width=n.width+"px";this.imageResizerDiv.style.height=n.height+"px";this.currentImageElementBox=n;f=n.line;_instanceof(n,v)&&"Inline"!==n.textWrappingStyle?(u=n.y,r=n.x):(u=this.documentHelper.selection.getTop(f)+n.margin.top,r=this.documentHelper.selection.getLeftInternal(f,n,0));i=this.documentHelper.selection.getPage(f.paragraph);this.currentPage=i;sf.base.isNullOrUndefined(t)||(_instanceof(this.owner.viewer,at)&&(this.imageResizerDivElement.style.width=i.boundingRectangle.width-i.boundingRectangle.x-r-this.documentHelper.scrollbarWidth+"px"),this.imageResizerDivElement.style.display="block",t.style.width=_instanceof(this.owner.viewer,at)?i.boundingRectangle.width-this.documentHelper.scrollbarWidth-i.boundingRectangle.x-r+"px":i.boundingRectangle.width+"px",t.style.height=i.boundingRectangle.height+"px",t.style.left=i.boundingRectangle.x+"px",t.style.top=i.boundingRectangle.y+"px",t.style.borderWidth="0px",t.style.backgroundColor="transparent",t.style.overflow="hidden",t.style.position="absolute");c=this.documentHelper.getPageWidth(i);h=parseFloat(this.imageResizerDivElement.style.width);this.documentHelper.visibleBounds.width;this.documentHelper.zoomFactor;c<h&&this.documentHelper.zoomFactor;var l=this.imageResizerDivElement,a=parseFloat(l.style.width),y=parseFloat(l.style.height),w=parseFloat(this.imageResizerDiv.style.width),b=parseFloat(this.imageResizerDiv.style.height),e=(this.resizeMarkSize-1)/2,o=w+2*e,s=b+2*e;(o>(a-r)*this.documentHelper.zoomFactor+e&&(o=(a-r)*this.documentHelper.zoomFactor),s>(y-u)*this.documentHelper.zoomFactor+e&&(s=(y-u)*this.documentHelper.zoomFactor),this.imageResizerDivElement.style.width=parseInt(this.imageResizerDivElement.style.width.replace("px",""),10)*this.documentHelper.zoomFactor+"px",this.imageResizerDivElement.style.height=parseInt(this.imageResizerDivElement.style.height.replace("px",""),10)*this.documentHelper.zoomFactor+"px",s=this.documentHelper.render.getScaledValue(n.height),o=this.documentHelper.render.getScaledValue(n.width),_instanceof(n,v)?(r=this.documentHelper.render.getScaledValue(r),u=this.documentHelper.render.getScaledValue(u)):(r=n.x*this.documentHelper.zoomFactor,u=n.y*this.documentHelper.zoomFactor),this.setImageResizerPosition(r,u,o,s,this),this.resizeContainerDiv.style.borderStyle=this.owner.selection.isInShape?"dashed":"solid",this.selectedImageWidget.containsKey(f))||(p=new lo(n.height,n.width),this.selectedImageWidget.add(f,p))},n.prototype.showImageResizer=function(){sf.base.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display="");sf.base.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display="");sf.base.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.style.display="",this.bottomLeftRectParent.style.display="");sf.base.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.style.display="",this.bottomRightRectParent.style.display="");sf.base.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="",this.bottomMiddleRectParent.style.display="");sf.base.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.style.display="",this.rightMiddleRectParent.style.display="");sf.base.isNullOrUndefined(this.topRightRect)||(this.topRightRect.style.display="",this.topRightRectParent.style.display="");sf.base.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.style.display="",this.topLeftRectParent.style.display="");sf.base.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.style.display="",this.leftMiddleRectParent.style.display="");sf.base.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.style.display="",this.topMiddleRectParent.style.display="");this.isImageResizerVisible=!0},n.prototype.hideImageResizer=function(){sf.base.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display="none");sf.base.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display="none");sf.base.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.style.display="none",this.bottomLeftRectParent.style.display="none");sf.base.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.style.display="none",this.bottomRightRectParent.style.display="none");sf.base.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="none",this.bottomMiddleRectParent.style.display="none");sf.base.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.style.display="none",this.rightMiddleRectParent.style.display="none");sf.base.isNullOrUndefined(this.topRightRect)||(this.topRightRect.style.display="none",this.topRightRectParent.style.display="none");sf.base.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.style.display="none",this.topLeftRectParent.style.display="none");sf.base.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.style.display="none",this.leftMiddleRectParent.style.display="none");sf.base.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.style.display="none",this.topMiddleRectParent.style.display="none");this.isImageResizerVisible=!1;this.currentPage=void 0},n.prototype.initResizeMarks=function(n,t){return this.initResizeContainerDiv(t),n.appendChild(t.resizeContainerDiv),t.topRightRectParent=document.createElement("div"),t.topRightRectParent.style.cursor="ne-resize",t.topRightRectParent.id=this.documentHelper.owner.containerId+"_TopRightRectParent",this.applyProperties(t.topRightRectParent),t.topRightRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topRightRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topRightRectParent.style.opacity="-1",n.appendChild(t.topRightRectParent),t.topRightRect=document.createElement("div"),t.topRightRect.id=this.documentHelper.owner.containerId+"_TopRightRect",t.topRightRect.style.cursor="ne-resize",this.applyProperties(t.topRightRect),n.appendChild(t.topRightRect),t.topLeftRectParent=document.createElement("div"),t.topLeftRectParent.style.cursor="nw-resize",t.topLeftRectParent.id=this.documentHelper.owner.containerId+"_TopLeftRectParent",this.applyProperties(t.topLeftRectParent),t.topLeftRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topLeftRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topLeftRectParent.style.opacity="-1",n.appendChild(t.topLeftRectParent),t.topLeftRect=document.createElement("div"),t.topLeftRect.id=this.documentHelper.owner.containerId+"_TopLeftRect",t.topLeftRect.style.cursor="nw-resize",this.applyProperties(t.topLeftRect),n.appendChild(t.topLeftRect),t.topMiddleRectParent=document.createElement("div"),t.topMiddleRectParent.style.cursor="n-resize",t.topMiddleRectParent.id=this.documentHelper.owner.containerId+"_TopMiddleRectParent",this.applyProperties(t.topMiddleRectParent),t.topMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.opacity="-1",n.appendChild(t.topMiddleRectParent),t.topMiddleRect=document.createElement("div"),t.topMiddleRect.id=this.documentHelper.owner.containerId+"_TopMiddleRect",t.topMiddleRect.style.cursor="n-resize",this.applyProperties(t.topMiddleRect),n.appendChild(t.topMiddleRect),t.bottomRightRectParent=document.createElement("div"),t.bottomRightRectParent.style.cursor="se-resize",t.bottomRightRectParent.id=this.documentHelper.owner.containerId+"_BottomRightRectParent",this.applyProperties(t.bottomRightRectParent),t.bottomRightRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.opacity="-1",n.appendChild(t.bottomRightRectParent),t.bottomRightRect=document.createElement("div"),t.bottomRightRect.id=this.documentHelper.owner.containerId+"_BottomRightRect",t.bottomRightRect.style.cursor="se-resize",this.applyProperties(t.bottomRightRect),n.appendChild(t.bottomRightRect),t.bottomLeftRectParent=document.createElement("div"),t.bottomLeftRectParent.style.cursor="sw-resize",t.bottomLeftRectParent.id=this.documentHelper.owner.containerId+"_BottomLeftRectParent",this.applyProperties(t.bottomLeftRectParent),t.bottomLeftRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.opacity="-1",n.appendChild(t.bottomLeftRectParent),t.bottomLeftRect=document.createElement("div"),t.bottomLeftRect.id=this.documentHelper.owner.containerId+"_BottomLeftRect",t.bottomLeftRect.style.cursor="sw-resize",this.applyProperties(t.bottomLeftRect),n.appendChild(t.bottomLeftRect),t.bottomMiddleRectParent=document.createElement("div"),t.bottomMiddleRectParent.style.cursor="s-resize",t.bottomMiddleRectParent.id=this.documentHelper.owner.containerId+"_BottomMiddleRectParent",this.applyProperties(t.bottomMiddleRectParent),t.bottomMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.opacity="-1",n.appendChild(t.bottomMiddleRectParent),t.bottomMiddleRect=document.createElement("div"),t.bottomMiddleRect.id=this.documentHelper.owner.containerId+"_BottomMiddleRect",t.bottomMiddleRect.style.cursor="s-resize",this.applyProperties(t.bottomMiddleRect),n.appendChild(t.bottomMiddleRect),t.rightMiddleRectParent=document.createElement("div"),t.rightMiddleRectParent.style.cursor="e-resize",t.rightMiddleRectParent.id=this.documentHelper.owner.containerId+"_RightMiddleRectParent",this.applyProperties(t.rightMiddleRectParent),t.rightMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.opacity="-1",n.appendChild(t.rightMiddleRectParent),t.rightMiddleRect=document.createElement("div"),t.rightMiddleRect.id=this.documentHelper.owner.containerId+"_RightMiddleRect",t.rightMiddleRect.style.cursor="e-resize",this.applyProperties(t.rightMiddleRect),n.appendChild(t.rightMiddleRect),t.leftMiddleRectParent=document.createElement("div"),t.leftMiddleRectParent.style.cursor="w-resize",t.leftMiddleRectParent.id=this.documentHelper.owner.containerId+"_LeftMiddleRectParent",this.applyProperties(t.leftMiddleRectParent),t.leftMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.opacity="-1",n.appendChild(t.leftMiddleRectParent),t.leftMiddleRect=document.createElement("div"),t.leftMiddleRect.id=this.documentHelper.owner.containerId+"_LeftMiddleRect",t.leftMiddleRect.style.cursor="w-resize",this.applyProperties(t.leftMiddleRect),n.appendChild(t.leftMiddleRect),t.resizeContainerDiv},n.prototype.setImageResizerPosition=function(n,t,i,r,u){u.resizeContainerDiv.style.width=i+"px";u.resizeContainerDiv.style.height=r+"px";u.resizeContainerDiv.style.left=n+"px";u.resizeContainerDiv.style.top=t+"px";u.topRightRect.style.left=n+i-5+"px";u.topRightRect.style.top=t-4+"px";u.topLeftRect.style.left=n-5+"px";u.topLeftRect.style.top=t-4+"px";u.topMiddleRect.style.left=parseFloat(u.topLeftRect.style.left)+i/2-4+"px";u.topMiddleRect.style.top=t-4+"px";u.bottomRightRect.style.left=u.topRightRect.style.left;u.bottomRightRect.style.top=parseFloat(u.topRightRect.style.top)+r+"px";u.bottomLeftRect.style.left=u.topLeftRect.style.left;u.bottomLeftRect.style.top=parseFloat(u.topLeftRect.style.top)+r+"px";u.bottomMiddleRect.style.left=u.topMiddleRect.style.left;u.bottomMiddleRect.style.top=parseFloat(u.topMiddleRect.style.top)+r+"px";u.rightMiddleRect.style.left=n+i-4+"px";u.rightMiddleRect.style.top=parseFloat(u.topRightRect.style.top)+r/2+"px";u.leftMiddleRect.style.left=u.topLeftRect.style.left;u.leftMiddleRect.style.top=parseFloat(u.topLeftRect.style.top)+r/2+"px";u.topRightRectParent.style.left=this.documentHelper.isTouchInput?n+i-15+"px":n+i-8+"px";u.topRightRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px";u.topLeftRectParent.style.left=this.documentHelper.isTouchInput?n-15+"px":n-8+"px";u.topLeftRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px";u.topMiddleRectParent.style.left=parseFloat(u.topLeftRectParent.style.left)+i/2-4+"px";u.topMiddleRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px";u.bottomRightRectParent.style.left=u.topRightRectParent.style.left;u.bottomRightRectParent.style.top=parseFloat(u.topRightRectParent.style.top)+r+"px";u.bottomLeftRectParent.style.left=u.topLeftRectParent.style.left;u.bottomLeftRectParent.style.top=parseFloat(u.topLeftRectParent.style.top)+r+"px";u.bottomMiddleRectParent.style.left=u.topMiddleRectParent.style.left;u.bottomMiddleRectParent.style.top=parseFloat(u.topMiddleRectParent.style.top)+r+"px";u.rightMiddleRectParent.style.left=this.documentHelper.isTouchInput?n+i-15+"px":n+i-7+"px";u.rightMiddleRectParent.style.top=parseFloat(u.topRightRectParent.style.top)+r/2+"px";u.leftMiddleRectParent.style.left=u.topLeftRectParent.style.left;u.leftMiddleRectParent.style.top=parseFloat(u.topLeftRectParent.style.top)+r/2+"px";this.setImageResizingPoints(u);this.documentHelper.isTouchInput?this.applyPropertiesForTouch():this.applyPropertiesForMouse()},n.prototype.setImageResizingPoints=function(n){this.imageResizerPoints.resizeContainerDiv.x=parseFloat(n.resizeContainerDiv.style.left);this.imageResizerPoints.resizeContainerDiv.y=parseFloat(n.resizeContainerDiv.style.top);this.imageResizerPoints.bottomLeftRectParent.x=parseFloat(n.bottomLeftRectParent.style.left);this.imageResizerPoints.bottomLeftRectParent.y=parseFloat(n.bottomLeftRectParent.style.top);this.imageResizerPoints.bottomRightRectParent.x=parseFloat(n.bottomRightRectParent.style.left);this.imageResizerPoints.bottomRightRectParent.y=parseFloat(n.bottomRightRectParent.style.top);this.imageResizerPoints.bottomMiddleRectParent.x=parseFloat(n.bottomMiddleRectParent.style.left);this.imageResizerPoints.bottomMiddleRectParent.y=parseFloat(n.bottomMiddleRectParent.style.top);this.imageResizerPoints.topLeftRectParent.x=parseFloat(n.topLeftRectParent.style.left);this.imageResizerPoints.topLeftRectParent.y=parseFloat(n.topLeftRectParent.style.top);this.imageResizerPoints.topRightRectParent.x=parseFloat(n.topRightRectParent.style.left);this.imageResizerPoints.topRightRectParent.y=parseFloat(n.topRightRectParent.style.top);this.imageResizerPoints.topMiddleRectParent.x=parseFloat(n.topMiddleRectParent.style.left);this.imageResizerPoints.topMiddleRectParent.y=parseFloat(n.topMiddleRectParent.style.top);this.imageResizerPoints.leftMiddleRectParent.x=parseFloat(n.leftMiddleRectParent.style.left);this.imageResizerPoints.leftMiddleRectParent.y=parseFloat(n.leftMiddleRectParent.style.top);this.imageResizerPoints.rightMiddleRectParent.x=parseFloat(n.rightMiddleRectParent.style.left);this.imageResizerPoints.rightMiddleRectParent.y=parseFloat(n.rightMiddleRectParent.style.top)},n.prototype.initResizeContainerDiv=function(n){n.resizeContainerDiv=document.createElement("div");n.resizeContainerDiv.id=this.documentHelper.owner.containerId+"_ResizeDivElement";n.resizeContainerDiv.style.position="absolute";n.resizeContainerDiv.style.border="1px solid #bfbfbf";n.resizeContainerDiv.style.zIndex="30";n.resizeContainerDiv.style.backgroundColor="transparent";n.resizeContainerDiv.style.display="block"},n.prototype.applyProperties=function(n){n.style.position="absolute";n.style.width="8px";n.style.height="8px";n.style.fontSize="0px";n.style.zIndex=" 551";n.style.backgroundColor="#ffffff";n.style.border="1px solid #bfbfbf";n.style.boxShadow="0 1px 2px 0 #bfbfbf 0.35";n.style.color="#000000"},n.prototype.handleImageResizing=function(n,i,r){var u,h,f,e,l,c,o,s;i/=this.documentHelper.zoomFactor;r/=this.documentHelper.zoomFactor;this.leftValue=sf.base.isNullOrUndefined(this.leftValue)?i:this.leftValue;this.topValue=sf.base.isNullOrUndefined(this.topValue)?r:this.topValue;h=this.selectedResizeElement.id.split("_");f=h[h.length-1];switch(f){case"TopRightRectParent":i=(u=this.topRightResizing(n)).left;r=u.top;break;case"TopLeftRectParent":i=-(u=this.topLeftResizing(n)).left;r=-u.top;break;case"TopMiddleRectParent":i=0;r=this.topMiddleResizing(n);break;case"BottomRightRectParent":i=(u=this.bottomRightResizing(n)).left;r=u.top;break;case"BottomLeftRectParent":i=-(u=this.bottomLeftResizing(n)).left;r=-u.top;break;case"BottomMiddleRectParent":r=n.y-r;i=0;break;case"RightMiddleRectParent":i=n.x-i;r=0;break;case"LeftMiddleRectParent":i=this.leftMiddleResizing(n);r=0}if(0!==i||0!==r){if(e=this.currentImageElementBox.line.paragraph,l=this.currentImageElementBox,!sf.base.isNullOrUndefined(e)&&e.isInsideTable&&(c=e.containerWidget,!sf.base.isNullOrUndefined(c))){var a=c.containerWidget,v=t.convertPointToPixel(l.height),y=a.height-v;r>0&&a.y+y+v+r>this.viewer.clientArea.bottom&&(this.isImageMoveToNextPage=!0)}(this.owner.enableHistoryMode&&this.initHistoryForImageResizer(this.currentImageElementBox),sf.base.isNullOrUndefined(this.currentImageElementBox))||(o=this.currentImageElementBox.width+i>10?this.currentImageElementBox.width+i:10,s=this.currentImageElementBox.height+r>10?this.currentImageElementBox.height+r:10,"BottomRightRectParent"!==f&&"TopRightRectParent"!==f&&"BottomLeftRectParent"!==f&&"TopLeftRectParent"!==f||(s=this.currentImageElementBox.height/this.currentImageElementBox.width*o,o=this.currentImageElementBox.width/this.currentImageElementBox.height*s),this.currentImageElementBox.width=o,this.currentImageElementBox.height=s,this.currentImageElementBox.line.paragraph,this.positionImageResizer(this.currentImageElementBox));this.isImageResizing=!0}},n.prototype.handleImageResizingOnMouse=function(n){if(!sf.base.isNullOrUndefined(this.selectedResizeElement)){var t=parseFloat(this.selectedResizeElement.style.left),i=parseFloat(this.selectedResizeElement.style.top),r=new d(n.offsetX,n.offsetY),u=this.viewer.findFocusedPage(r,!0);this.handleImageResizing(u,t,i)}},n.prototype.topMiddleResizing=function(n){var t;return this.topValue>=n.y?(t=this.topValue/n.y,this.topValue=n.y,_instanceof(this.viewer,rt)&&this.topValue<=this.viewer.pageGap&&(t=1)):(t=-n.y/this.topValue,this.topValue=n.y,0===this.topValue&&(t=-1)),t},n.prototype.leftMiddleResizing=function(n){var t;return this.leftValue>=n.x?(t=this.leftValue/n.x,this.leftValue=n.x,0===this.leftValue&&(t=1,this.leftValue=parseFloat(this.selectedResizeElement.style.left))):(t=-n.x/this.leftValue,this.leftValue=n.x),t},n.prototype.topRightResizing=function(n){return this.leftValue<=n.x&&this.topValue>=n.y?this.getOuterResizingPoint(n):this.getInnerResizingPoint(n)},n.prototype.topLeftResizing=function(n){return this.leftValue>=n.x&&this.topValue>=n.y?this.getOuterResizingPoint(n):this.getInnerResizingPoint(n)},n.prototype.bottomRightResizing=function(n){return this.leftValue<=n.x&&this.topValue<=n.y?this.getOuterResizingPoint(n):this.getInnerResizingPoint(n)},n.prototype.bottomLeftResizing=function(n){return this.leftValue>=n.x&&this.topValue<=n.y?this.getOuterResizingPoint(n):this.getInnerResizingPoint(n)},n.prototype.getOuterResizingPoint=function(n){var t,i;return t=n.x-this.leftValue,this.leftValue=n.x,i=n.y-this.topValue,this.topValue=n.y,{left:t,top:i}},n.prototype.getInnerResizingPoint=function(n){var t,i;return t=-(this.leftValue-n.x),this.leftValue=n.x,i=-(this.topValue-n.y),this.topValue=n.y,{left:t,top:i}},n.prototype.handleImageResizingOnTouch=function(n){if(!sf.base.isNullOrUndefined(this.selectedResizeElement)){var i=parseFloat(this.selectedResizeElement.style.left)+24,r=parseFloat(this.selectedResizeElement.style.top)+24,t=n.touches,u=new d(t[0].clientX,t[0].clientY),f=this.viewer.findFocusedPage(u,!0);if(sf.base.isNullOrUndefined(this.currentImageElementBox)||sf.base.isNullOrUndefined(this.currentImageElementBox))return;this.handleImageResizing(f,i,r)}},n.prototype.getImagePoint=function(n){var a=this.documentHelper.render.getScaledValue(n.x,1),v=this.documentHelper.render.getScaledValue(n.y,2);n=new d(a,v);var r=this.imageResizerPoints,t="",i=void 0,u=r.bottomMiddleRectParent,f=r.bottomRightRectParent,e=r.bottomLeftRectParent,o=r.topMiddleRectParent,s=r.topRightRectParent,h=r.topLeftRectParent,c=r.rightMiddleRectParent,l=r.leftMiddleRectParent;return sf.base.isNullOrUndefined(this.bottomMiddleRectParent)||"none"===this.bottomMiddleRectParent.style.display||(n.x>u.x&&n.x<=u.x+15&&n.y>u.y&&n.y<=u.y+15?(i=this.bottomMiddleRectParent,t="s-resize"):n.x>f.x&&n.x<=f.x+15&&n.y>f.y&&n.y<=f.y+15?(i=this.bottomRightRectParent,t="se-resize"):n.x>e.x&&n.x<=e.x+15&&n.y>e.y&&n.y<=e.y+15?(i=this.bottomLeftRectParent,t="sw-resize"):n.x>o.x&&n.x<=o.x+15&&n.y>o.y&&n.y<=o.y+15?(i=this.topMiddleRectParent,t="n-resize"):n.x>s.x&&n.x<=s.x+15&&n.y>s.y&&n.y<=s.y+15?(i=this.topRightRectParent,t="ne-resize"):n.x>h.x&&n.x<=h.x+15&&n.y>h.y&&n.y<=h.y+15?(i=this.topLeftRectParent,t="nw-resize"):n.x>l.x&&n.x<=l.x+15&&n.y>l.y&&n.y<=l.y+15?(i=this.leftMiddleRectParent,t="w-resize"):n.x>c.x&&n.x<=c.x+15&&n.y>c.y&&n.y<=c.y+15?(i=this.rightMiddleRectParent,t="e-resize"):!sf.base.isNullOrUndefined(this.resizeContainerDiv)&&n.x>parseFloat(this.resizeContainerDiv.style.left)&&n.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&n.y>parseFloat(this.resizeContainerDiv.style.top)&&n.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(t="move")),{selectedElement:i,resizePosition:t}},n.prototype.applyPropertiesForMouse=function(){sf.base.isNullOrUndefined(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="14px",this.bottomMiddleRectParent.style.height="14px",this.bottomRightRectParent.style.width="14px",this.bottomRightRectParent.style.height="14px",this.bottomLeftRectParent.style.width="14px",this.bottomLeftRectParent.style.height="14px",this.topMiddleRectParent.style.width="14px",this.topMiddleRectParent.style.height="14px",this.topRightRectParent.style.width="14px",this.topRightRectParent.style.height="14px",this.topLeftRectParent.style.width="14px",this.topLeftRectParent.style.height="14px",this.leftMiddleRectParent.style.width="14px",this.leftMiddleRectParent.style.height="14px",this.rightMiddleRectParent.style.width="14px",this.rightMiddleRectParent.style.height="14px")},n.prototype.getImagePointOnTouch=function(n){var a=this.documentHelper.render.getScaledValue(n.x,1),v=this.documentHelper.render.getScaledValue(n.y,2);n=new d(a,v);var r=this.imageResizerPoints,t="",i=void 0,u=r.bottomMiddleRectParent,f=r.bottomRightRectParent,e=r.bottomLeftRectParent,o=r.topMiddleRectParent,s=r.topRightRectParent,h=r.topLeftRectParent,c=r.rightMiddleRectParent,l=r.leftMiddleRectParent;return sf.base.isNullOrUndefined(this.bottomMiddleRectParent)||"none"===this.bottomMiddleRectParent.style.display||(n.x>u.x&&n.x<=u.x+25&&n.y>u.y&&n.y<=u.y+25?(i=this.bottomMiddleRectParent,t="s-resize"):n.x>f.x&&n.x<=f.x+25&&n.y>f.y&&n.y<=f.y+25?(i=this.bottomRightRectParent,t="se-resize"):n.x>e.x&&n.x<=e.x+25&&n.y>e.y&&n.y<=e.y+25?(i=this.bottomLeftRectParent,t="sw-resize"):n.x>o.x&&n.x<=o.x+25&&n.y>o.y&&n.y<=o.y+25?(i=this.topMiddleRectParent,t="n-resize"):n.x>s.x&&n.x<=s.x+25&&n.y>s.y&&n.y<=s.y+25?(i=this.topRightRectParent,t="ne-resize"):n.x>h.x&&n.x<=h.x+25&&n.y>h.y&&n.y<=h.y+25?(i=this.topLeftRectParent,t="nw-resize"):n.x>l.x&&n.x<=l.x+25&&n.y>l.y&&n.y<=l.y+25?(i=this.leftMiddleRectParent,t="w-resize"):n.x>c.x&&n.x<=c.x+25&&n.y>c.y&&n.y<=c.y+25?(i=this.rightMiddleRectParent,t="e-resize"):!sf.base.isNullOrUndefined(this.resizeContainerDiv)&&n.x>parseFloat(this.resizeContainerDiv.style.left)&&n.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&n.y>parseFloat(this.resizeContainerDiv.style.top)&&n.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(t="move")),{selectedElement:i,resizePosition:t}},n.prototype.applyPropertiesForTouch=function(){sf.base.isNullOrUndefined(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="30px",this.bottomMiddleRectParent.style.height="30px",this.bottomRightRectParent.style.width="30px",this.bottomRightRectParent.style.height="30px",this.bottomLeftRectParent.style.width="30px",this.bottomLeftRectParent.style.height="30px",this.topMiddleRectParent.style.width="30px",this.topMiddleRectParent.style.height="30px",this.topRightRectParent.style.width="30px",this.topRightRectParent.style.height="30px",this.topLeftRectParent.style.width="30px",this.topLeftRectParent.style.height="30px",this.leftMiddleRectParent.style.width="30px",this.leftMiddleRectParent.style.height="30px",this.rightMiddleRectParent.style.width="30px",this.rightMiddleRectParent.style.height="30px")},n.prototype.mouseUpInternal=function(){this.currentImageElementBox.width=parseFloat(this.imageResizerDiv.style.width)/this.documentHelper.zoomFactor;this.currentImageElementBox.height=parseFloat(this.imageResizerDiv.style.height)/this.documentHelper.zoomFactor;this.owner.isShiftingEnabled=!0;this.owner.editorModule.setOffsetValue(this.owner.selection);this.documentHelper.layout.reLayoutParagraph(this.currentImageElementBox.line.paragraph,0,0);this.updateHistoryForImageResizer();this.owner.editorModule.reLayout(this.owner.selection,!0);this.viewer.updateScrollBars()},n.prototype.initHistoryForImageResizer=function(n){!sf.base.isNullOrUndefined(this.owner)&&sf.base.isNullOrUndefined(this.baseHistoryInfo)&&(this.baseHistoryInfo=new fr(this.owner),this.baseHistoryInfo.action="ImageResizing",this.baseHistoryInfo.updateSelection(),this.baseHistoryInfo.modifiedProperties.push(new wr(n)))},n.prototype.updateHistoryForImageResizer=function(){if(!sf.base.isNullOrUndefined(this.owner)&&!sf.base.isNullOrUndefined(this.baseHistoryInfo)){var n=this.baseHistoryInfo.modifiedProperties[0];this.currentImageElementBox.width===n.width&&this.currentImageElementBox.height===n.height?this.baseHistoryInfo.modifiedProperties.pop():this.owner.editorHistory.recordChanges(this.baseHistoryInfo);this.baseHistoryInfo=void 0}},n.prototype.updateImageResizerPosition=function(){var e,o;if(!sf.base.isNullOrUndefined(this.currentImageElementBox)){var r,n=(this.currentImageElementBox,this.currentImageElementBox),u=n.line,f=void 0,t=void 0,i=void 0;_instanceof(this.currentImageElementBox,v)?(r=this.documentHelper.selection.getTop(u)+n.margin.top,f=this.documentHelper.selection.getLeftInternal(u,n,0),t=r*this.documentHelper.zoomFactor,i=f*this.documentHelper.zoomFactor):(i=n.x*this.documentHelper.zoomFactor,t=n.y*this.documentHelper.zoomFactor);e=this.documentHelper.render.getScaledValue(n.height,2);o=this.documentHelper.render.getScaledValue(n.width,1);this.setImageResizerPosition(i,t,o,e,this)}},n.prototype.destroy=function(){sf.base.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.innerHTML="");sf.base.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.innerHTML="");sf.base.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.innerHTML="");sf.base.isNullOrUndefined(this.topRightRect)||(this.topRightRect.innerHTML="");sf.base.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.innerHTML="");sf.base.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.innerHTML="");sf.base.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.innerHTML="");sf.base.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.innerHTML="");sf.base.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.innerHTML="");sf.base.isNullOrUndefined(this.imageResizerDiv)||(this.imageResizerDiv.innerHTML="");sf.base.isNullOrUndefined(this.selectedImageWidget)||this.selectedImageWidget.destroy();sf.base.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.innerHTML="");this.imageResizerDivElement=void 0;this.resizeContainerDiv=void 0;this.topLeftRect=void 0;this.topMiddleRect=void 0;this.topRightRect=void 0;this.bottomLeftRect=void 0;this.bottomMiddleRect=void 0;this.bottomRightRect=void 0;this.leftMiddleRect=void 0;this.rightMiddleRect=void 0;this.imageResizerDiv=void 0;this.selectedImageWidget=void 0;this.isImageResizing=!1;this.isImageResizerVisible=!1;this.currentImageElementBoxIn=void 0;this.resizeMarkSizeIn=void 0;this.documentHelper=void 0;this.owner=void 0},n}(),co=function(){this.resizeContainerDiv=new d(0,0);this.topLeftRectParent=new d(0,0);this.topMiddleRectParent=new d(0,0);this.topRightRectParent=new d(0,0);this.bottomLeftRectParent=new d(0,0);this.bottomMiddleRectParent=new d(0,0);this.bottomRightRectParent=new d(0,0);this.leftMiddleRectParent=new d(0,0);this.rightMiddleRectParent=new d(0,0)},lo=function(){function n(n,t){this.heightIn=0;this.widthIn=0;this.heightIn=n;this.widthIn=t}return Object.defineProperty(n.prototype,"height",{get:function(){return this.heightIn},set:function(n){this.heightIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.widthIn},set:function(n){this.widthIn=n},enumerable:!0,configurable:!0}),n}(),ao=function(){function n(){this.customXMLItemsPath="customXml/item";this.customXMLItemsPropspath="customXml/itemProps";this.itemPropsPath="itemProps";this.documentPath="word/document.xml";this.stylePath="word/styles.xml";this.chartPath="word/charts";this.numberingPath="word/numbering.xml";this.settingsPath="word/settings.xml";this.headerPath="word/header";this.footerPath="word/footer";this.imagePath="word/media/image";this.footnotesPath="word/footnotes.xml";this.endnotesPath="word/endnotes.xml";this.appPath="docProps/app.xml";this.corePath="docProps/core.xml";this.contentTypesPath="[Content_Types].xml";this.defaultEmbeddingPath="word/embeddings/";this.commentsPath="word/comments.xml";this.commentsExtendedPath="word/commentsExtended.xml";this.generalRelationPath="_rels/.rels";this.wordRelationPath="word/_rels/document.xml.rels";this.customXMLRelPath="customXml/_rels/item";this.excelRelationPath="xl/_rels/workbook.xml.rels";this.footnotesRelationPath="word/_rels/footnotes.xml.rels";this.endnotesRelationPath="word/_rels/endnotes.xml.rels";this.headerRelationPath="word/_rels/header";this.footerRelationPath="word/_rels/footer";this.xmlContentType="application/xml";this.fontContentType="application/vnd.openxmlformats-officedocument.obfuscatedFont";this.documentContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml";this.settingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml";this.commentsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml";this.commentsExContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.commentsExtended+xml";this.endnoteContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml";this.footerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml";this.footnoteContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml";this.headerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml";this.numberingContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml";this.stylesContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml";this.webSettingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml";this.appContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml";this.coreContentType="application/vnd.openxmlformats-package.core-properties+xml";this.customContentType="application/vnd.openxmlformats-officedocument.custom-properties+xml";this.customXmlContentType="application/vnd.openxmlformats-officedocument.customXmlProperties+xml";this.relationContentType="application/vnd.openxmlformats-package.relationships+xml";this.chartsContentType="application/vnd.openxmlformats-officedocument.drawingml.chart+xml";this.tableStyleContentType="application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml";this.chartColorStyleContentType="application/vnd.ms-office.chartcolorstyle+xml";this.commentsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments";this.commentsExRelType="http://schemas.microsoft.com/office/2011/relationships/commentsExtended";this.settingsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings";this.endnoteRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes";this.footerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer";this.footnoteRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes";this.headerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header";this.documentRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument";this.numberingRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering";this.stylesRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles";this.chartRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart";this.fontRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/font";this.tableStyleRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles";this.coreRelType="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties";this.appRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties";this.customRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties";this.imageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image";this.hyperlinkRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink";this.controlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/control";this.packageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/package";this.customXmlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml";this.customUIRelType="http://schemas.microsoft.com/office/2006/relationships/ui/extensibility";this.attachedTemplateRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate";this.chartColorStyleRelType="http://schemas.microsoft.com/office/2011/relationships/chartColorStyle";this.wNamespace="http://schemas.openxmlformats.org/wordprocessingml/2006/main";this.wpNamespace="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing";this.pictureNamespace="http://schemas.openxmlformats.org/drawingml/2006/picture";this.aNamespace="http://schemas.openxmlformats.org/drawingml/2006/main";this.a14Namespace="http://schemas.microsoft.com/office/drawing/2010/main";this.rNamespace="http://schemas.openxmlformats.org/officeDocument/2006/relationships";this.rpNamespace="http://schemas.openxmlformats.org/package/2006/relationships";this.vNamespace="urn:schemas-microsoft-com:vml";this.oNamespace="urn:schemas-microsoft-com:office:office";this.xmlNamespace="http://www.w3.org/XML/1998/namespace";this.w10Namespace="urn:schemas-microsoft-com:office:word";this.cpNamespace="http://schemas.openxmlformats.org/package/2006/metadata/core-properties";this.dcNamespace="http://purl.org/dc/elements/1.1/";this.docPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties";this.veNamespace="http://schemas.openxmlformats.org/markup-compatibility/2006";this.mNamespace="http://schemas.openxmlformats.org/officeDocument/2006/math";this.wneNamespace="http://schemas.microsoft.com/office/word/2006/wordml";this.customPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties";this.vtNamespace="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes";this.chartNamespace="http://schemas.openxmlformats.org/drawingml/2006/chart";this.slNamespace="http://schemas.openxmlformats.org/schemaLibrary/2006/main";this.dtNamespace="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882";this.wmlNamespace="http://schemas.microsoft.com/office/word/2003/wordml";this.w14Namespace="http://schemas.microsoft.com/office/word/2010/wordml";this.wpCanvasNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas";this.wpDrawingNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing";this.wpGroupNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup";this.wpInkNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingInk";this.wpShapeNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingShape";this.w15Namespace="http://schemas.microsoft.com/office/word/2012/wordml";this.diagramNamespace="http://schemas.openxmlformats.org/drawingml/2006/diagram";this.eNamespace="http://schemas.microsoft.com/office/2006/encryption";this.pNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/password";this.certNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/certificate";this.cxNamespace="http://schemas.microsoft.com/office/drawing/2014/chartex";this.c15Namespace="http://schemas.microsoft.com/office/drawing/2015/06/chart";this.c7Namespace="http://schemas.microsoft.com/office/drawing/2007/8/2/chart";this.csNamespace="http://schemas.microsoft.com/office/drawing/2012/chartStyle";this.spreadSheetNamespace="http://schemas.openxmlformats.org/spreadsheetml/2006/main";this.spreadSheet9="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main";this.cRelationshipsTag="Relationships";this.cRelationshipTag="Relationship";this.cIdTag="Id";this.cTypeTag="Type";this.cTargetTag="Target";this.cUserShapesTag="userShapes";this.cExternalData="externalData";this.twipsInOnePoint=20;this.twentiethOfPoint=20;this.borderMultiplier=8;this.percentageFactor=50;this.emusPerPoint=12700;this.cConditionalTableStyleTag="tblStylePr";this.cTableFormatTag="tblPr";this.cTowFormatTag="trPr";this.cCellFormatTag="tcPr";this.cParagraphFormatTag="pPr";this.cCharacterFormatTag="rPr";this.packageType="http://schemas.microsoft.com/office/2006/xmlPackage";this.relsPartPath="/_rels/.rels";this.documentRelsPartPath="/word/_rels/document.xml.rels";this.webSettingsPath="/word/webSettings.xml";this.wordMLDocumentPath="/word/document.xml";this.wordMLStylePath="/word/styles.xml";this.wordMLNumberingPath="/word/numbering.xml";this.wordMLSettingsPath="/word/settings.xml";this.wordMLHeaderPath="/word/header";this.wordMLFooterPath="/word/footer";this.wordMLCommentsPath="/word/comments.xml";this.wordMLImagePath="/word/media/image";this.wordMLFootnotesPath="/word/footnotes.xml";this.wordMLEndnotesPath="/word/endnotes.xml";this.wordMLAppPath="/docProps/app.xml";this.wordMLCorePath="/docProps/core.xml";this.wordMLCustomPath="/docProps/custom.xml";this.wordMLFontTablePath="/word/fontTable.xml";this.wordMLChartsPath="/word/charts/";this.wordMLDefaultEmbeddingPath="/word/embeddings/";this.wordMLEmbeddingPath="/word/embeddings/";this.wordMLDrawingPath="/word/drawings/";this.wordMLThemePath="/word/theme/theme1.xml";this.wordMLFontsPath="/word/fonts/";this.wordMLDiagramPath="/word/diagrams/";this.wordMLControlPath="/word/activeX/";this.wordMLVbaProject="/vbaProject.bin";this.wordMLVbaData="/vbaData.xml";this.wordMLVbaProjectPath="/word/vbaProject.bin";this.wordMLVbaDataPath="/word/vbaData.xml";this.wordMLWebSettingsPath="/word/webSettings.xml";this.wordMLCustomItemProp1Path="/customXml/itemProps1.xml";this.wordMLFootnoteRelPath="/word/_rels/footnotes.xml.rels";this.wordMLEndnoteRelPath="/word/_rels/endnotes.xml.rels";this.wordMLSettingsRelPath="/word/_rels/settings.xml.rels";this.wordMLNumberingRelPath="/word/_rels/numbering.xml.rels";this.wordMLFontTableRelPath="/word/_rels/fontTable.xml.rels";this.wordMLCustomXmlPropsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps";this.wordMLControlRelType="http://schemas.microsoft.com/office/2006/relationships/activeXControlBinary";this.wordMLDiagramContentType="application/vnd.ms-office.drawingml.diagramDrawing+xml";this.dsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/customXml";this.excelFiles=void 0;this.lastSection=!1;this.mRelationShipID=0;this.cRelationShipId=0;this.eRelationShipId=0;this.efRelationShipId=0;this.mDocPrID=1;this.chartCount=0;this.seriesCount=0;this.chartStringCount=0;this.mDifferentFirstPage=!1;this.mBookmarks=void 0;this.mComments=[];this.revisions=[];this.customXMLProps=[];this.paraID=0;this.commentParaID=0;this.commentParaIDInfo={};this.isInsideComment=!1;this.commentId={};this.currentCommentId=0;this.trackChangesId=0;this.prevRevisionIds=[];this.isRevisionContinuous=!1}return n.prototype.getModuleName=function(){return"WordExport"},Object.defineProperty(n.prototype,"bookmarks",{get:function(){return sf.base.isNullOrUndefined(this.mBookmarks)&&(this.mBookmarks=[]),this.mBookmarks},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"documentImages",{get:function(){return void 0===this.mDocumentImages&&(this.mDocumentImages=new h),this.mDocumentImages},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"externalImages",{get:function(){return void 0===this.mExternalLinkImages&&(this.mExternalLinkImages=new h),this.mExternalLinkImages},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"headerFooterImages",{get:function(){return void 0===this.mHeaderFooterImages&&(this.mHeaderFooterImages=new h),this.mHeaderFooterImages},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"documentCharts",{get:function(){return void 0===this.mDocumentCharts&&(this.mDocumentCharts=new h),this.mDocumentCharts},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"headersFooters",{get:function(){return void 0===this.mHeaderFooterColl&&(this.mHeaderFooterColl=new h),this.mHeaderFooterColl},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"endnotesFootnotes",{get:function(){return void 0===this.mFootEndnotesColl&&(this.mFootEndnotesColl=new h),this.mFootEndnotesColl},enumerable:!0,configurable:!0}),n.prototype.save=function(n,t){var r=this,i;this.fileName=t;this.serialize(n);i=this.serializeExcelFiles();i&&i.length>0?Promise.all(i).then(function(){r.saveInternal(t)}):this.saveInternal(t);this.close()},n.prototype.saveInternal=function(n){this.mArchive.save(n+".docx").then(function(n){n.destroy()})},n.prototype.saveAsBlob=function(n){var t=this,i;return this.serialize(n),i=this.serializeExcelFiles(),new Promise(function(n){i.length>0?Promise.all(i).then(function(){t.mArchive.saveAsBlob().then(function(i){t.mArchive.destroy();i=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});n(i)})}):t.mArchive.saveAsBlob().then(function(i){t.mArchive.destroy();i=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});n(i)})})},n.prototype.serializeExcelFiles=function(){var u=this,n=this.excelFiles,i=[],r,t;if(n&&n.length>0){for(r=function(t){var r=n.keys[t],f=n.get(r).saveAsBlob();i.push(f);f.then(function(n){var t=new sf.compression.ZipArchiveItem(n,r);u.mArchive.addItem(t)})},t=0;t<n.length;t++)r(t);this.excelFiles.clear()}return i},n.prototype.saveExcel=function(){var n=this.defaultEmbeddingPath+"Microsoft_Excel_Worksheet"+this.chartCount+".xlsx";this.excelFiles.add(n,this.mArchiveExcel);this.mArchiveExcel=void 0},n.prototype.destroy=function(){this.clearDocument();this.mRelationShipID=void 0;this.mDocPrID=void 0;this.mDifferentFirstPage=void 0;this.fileName=void 0;this.mArchive&&(this.mArchive.destroy(),this.mArchive=void 0);this.mArchiveExcel&&(this.mArchiveExcel.destroy(),this.mArchiveExcel=void 0)},n.prototype.serialize=function(n){var t=n.owner.sfdtExportModule.write();this.setDocument(t);this.mComments=n.comments;this.mCustomXML=n.customXmlData;this.revisions=n.owner.revisions.changes;this.mArchive=new sf.compression.ZipArchive;this.mArchive.compressionLevel="Normal";this.commentParaIDInfo={};this.commentParaID=0;this.currentCommentId=0;this.commentId={};this.mVerticalMerge=new h;this.mGridSpans=new h;this.serializeDocument();this.serializeStyles();this.serializeNumberings();this.serializeComments();this.serializeCommentsExtended();this.serializeSettings();this.serializeCoreProperties();this.serializeAppProperties();this.serializeFontTable(void 0);this.serializeSettingsRelation();this.serializeHeaderFooters();this.serializeFootnotes();this.serializeEndnotes();this.serializeDocumentRelations();this.serializeGeneralRelations();this.serializeContentTypes(void 0);this.clearDocument()},n.prototype.setDocument=function(n){this.document=n;this.mSections=n.sections;this.mLists=n.lists;this.mAbstractLists=n.abstractLists;this.defCharacterFormat=n.characterFormat;this.defParagraphFormat=n.paragraphFormat;this.defaultTabWidthValue=n.defaultTabWidth;this.dontUseHtmlParagraphAutoSpacing=n.dontUseHTMLParagraphAutoSpacing;this.mStyles=n.styles;this.formatting=n.formatting;this.enforcement=n.enforcement;this.hashValue=n.hashValue;this.saltValue=n.saltValue;this.protectionType=n.protectionType;this.formFieldShading=n.formFieldShading;this.trackChanges=n.trackChanges;this.compatibilityMode=n.compatibilityMode},n.prototype.clearDocument=function(){this.section=void 0;this.lastSection=void 0;this.blockOwner=void 0;this.paragraph=void 0;this.table=void 0;this.row=void 0;this.headerFooter=void 0;this.commentParaIDInfo={};this.commentParaID=0;this.currentCommentId=0;this.commentId={};this.document=void 0;this.mSections=void 0;this.mLists=void 0;this.mAbstractLists=void 0;this.defCharacterFormat=void 0;this.defParagraphFormat=void 0;this.defaultTabWidthValue=void 0;this.trackChanges=void 0;this.customXMLProps=[];this.mRelationShipID=0;this.eRelationShipId=0;this.cRelationShipId=0;this.efRelationShipId=0;this.mDocPrID=1;this.chartCount=0;this.mDifferentFirstPage=!1;this.mHeaderFooterColl&&(this.mHeaderFooterColl.destroy(),this.mHeaderFooterColl=void 0);this.mVerticalMerge&&(this.mVerticalMerge.destroy(),this.mVerticalMerge=void 0);this.mGridSpans&&(this.mGridSpans.destroy(),this.mGridSpans=void 0);this.mDocumentImages&&(this.mDocumentImages.destroy(),this.mDocumentImages=void 0);this.mExternalLinkImages&&(this.mExternalLinkImages.destroy(),this.mExternalLinkImages=void 0);this.mHeaderFooterImages&&(this.mHeaderFooterImages.destroy(),this.mHeaderFooterImages=void 0);this.mDocumentCharts&&(this.mDocumentCharts.destroy(),this.mDocumentCharts=void 0);this.mFootEndnotesColl&&(this.mFootEndnotesColl.destroy(),this.mFootEndnotesColl=void 0)},n.prototype.serializeDocument=function(){var n=new sf.fileutils.XmlWriter,t;n.writeStartElement("w","document",this.wNamespace);this.writeCommonAttributeStrings(n);this.serializeDocumentBody(n);n.writeEndElement();t=new sf.compression.ZipArchiveItem(n.buffer,this.documentPath);this.mArchive.addItem(t)},n.prototype.writeCommonAttributeStrings=function(n){n.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace);this.writeCustom(n);n.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace);n.writeAttributeString("xmlns","wp",void 0,this.wpNamespace);n.writeAttributeString("xmlns","w10",void 0,this.w10Namespace);n.writeAttributeString("xmlns","w",void 0,this.wNamespace);this.writeDup(n);n.writeAttributeString("xmlns","wne",void 0,this.wneNamespace);n.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace);n.writeAttributeString("mc","Ignorable",void 0,"w14 w15 wp14")},n.prototype.writeDup=function(n){n.writeAttributeString("xmlns","w14",void 0,this.w14Namespace);n.writeAttributeString("xmlns","w15",void 0,this.w15Namespace);n.writeAttributeString("xmlns","wpg",void 0,this.wpGroupNamespace);n.writeAttributeString("xmlns","wpi",void 0,this.wpInkNamespace)},n.prototype.writeCustom=function(n){n.writeAttributeString("xmlns","mc",void 0,this.veNamespace);n.writeAttributeString("xmlns","o",void 0,this.oNamespace);n.writeAttributeString("xmlns","r",void 0,this.rNamespace);n.writeAttributeString("xmlns","m",void 0,this.mNamespace);n.writeAttributeString("xmlns","v",void 0,this.vNamespace)},n.prototype.serializeDocumentBody=function(n){n.writeStartElement(void 0,"body",this.wNamespace);for(var i=this.document.sections.length,t=0;t<i;t++)this.section=this.document.sections[t],this.lastSection=t===i-1,this.serializeSection(n,this.section,t===i-1),this.section=void 0;n.writeEndElement()},n.prototype.serializeSection=function(n,t,i){this.blockOwner=t;this.serializeBodyItems(n,t.blocks,i);i&&this.serializeSectionProperties(n,t);this.blockOwner=void 0},n.prototype.serializeComments=function(){var n,t;0!==this.mComments.length&&(1!==this.mComments.length||""!==this.mComments[0].text)&&(n=new sf.fileutils.XmlWriter,n.writeStartElement("w","comments",this.wNamespace),this.serializeCommentCommonAttribute(n),this.serializeCommentInternal(n,this.mComments),n.writeEndElement(),t=new sf.compression.ZipArchiveItem(n.buffer,this.commentsPath),this.mArchive.addItem(t))},n.prototype.serializeCommentCommonAttribute=function(n){n.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace);n.writeAttributeString("xmlns","cx",void 0,this.cxNamespace);n.writeAttributeString("xmlns","mc",void 0,this.veNamespace);n.writeAttributeString("xmlns","o",void 0,this.oNamespace);n.writeAttributeString("xmlns","r",void 0,this.rNamespace);n.writeAttributeString("xmlns","m",void 0,this.mNamespace);n.writeAttributeString("xmlns","v",void 0,this.vNamespace);n.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace);n.writeAttributeString("xmlns","wp",void 0,this.wpNamespace);n.writeAttributeString("xmlns","w10",void 0,this.w10Namespace);n.writeAttributeString("xmlns","w",void 0,this.wNamespace);n.writeAttributeString("xmlns","w14",void 0,this.w14Namespace);n.writeAttributeString("xmlns","w15",void 0,this.w15Namespace);n.writeAttributeString("mc","Ignorable",void 0,"w14 w15")},n.prototype.serializeCommentInternal=function(n,t){for(var i,u,f,r=0;r<t.length;r++){for(i=t[r],n.writeStartElement("w","comment",this.wNamespace),n.writeAttributeString("w","id",this.wNamespace,this.commentId[i.commentId].toString()),i.author&&" "!==i.author&&n.writeAttributeString("w","author",this.wNamespace,i.author),i.date&&n.writeAttributeString("w","date",this.wNamespace,i.date),i.initial&&""!==i.initial&&n.writeAttributeString("w","initials",this.wNamespace,i.initial),u=this.retrieveCommentText(i.text),f=0;f<u.length;f++)this.isInsideComment=!0,this.commentParaID++,this.serializeBodyItem(n,u[f],!0),this.isInsideComment=!1;0===u.length&&(this.isInsideComment=!0,this.commentParaID++);this.commentParaIDInfo[i.commentId]=this.commentParaID;this.isInsideComment=!1;n.writeEndElement();i.replyComments.length>0&&this.serializeCommentInternal(n,i.replyComments)}},n.prototype.retrieveCommentText=function(n){var r=[],t=n.split("\n"),i={};if(0===(t=t.filter(function(n){return""!==n})).length)i.inlines=[{text:""}],r.push(i);else for(;t.length>0;)i.inlines=[{text:t[0]}],r.push(i),t.splice(0,1);return r},n.prototype.serializeCommentsExtended=function(){var n,t;0!==this.mComments.length&&(1!==this.mComments.length||""!==this.mComments[0].text)&&(n=new sf.fileutils.XmlWriter,n.writeStartElement("w15","commentsEx",this.wNamespace),this.serializeCommentCommonAttribute(n),this.serializeCommentsExInternal(n,this.mComments,!1),n.writeEndElement(),t=new sf.compression.ZipArchiveItem(n.buffer,this.commentsExtendedPath),this.mArchive.addItem(t))},n.prototype.serializeCommentsExInternal=function(n,t,i){for(var r,f,e,o,u=0;u<t.length;u++)r=t[u],n.writeStartElement("w15","commentEx",this.wNamespace),f=this.commentParaIDInfo[r.commentId],i&&(e=this.commentParaIDInfo[r.ownerComment.commentId],n.writeAttributeString("w15","paraIdParent",this.wNamespace,e.toString())),n.writeAttributeString("w15","paraId",this.wNamespace,f.toString()),o=r.done?1:0,n.writeAttributeString("w15","done",this.wNamespace,o.toString()),n.writeEndElement(),r.replyComments.length>0&&this.serializeCommentsExInternal(n,r.replyComments,!0)},n.prototype.serializeSectionProperties=function(n,t){n.writeStartElement("w","sectPr",this.wNamespace);t.headersFooters&&this.serializeHFReference(n,t.headersFooters);this.serializeSectionType(n,"nextPage");this.serializePageSetup(n,t.sectionFormat);this.serializeColumns(n);this.serializeFootNotesPr(n,t.sectionFormat);this.serializeEndNotesPr(n,t.sectionFormat);void 0!==t.sectionFormat&&t.sectionFormat.differentFirstPage&&(n.writeStartElement(void 0,"titlePg",this.wNamespace),n.writeEndElement());!sf.base.isNullOrUndefined(t.sectionFormat)&&t.sectionFormat.bidi&&(n.writeStartElement(void 0,"bidi",this.wNamespace),n.writeEndElement());n.writeEndElement()},n.prototype.serializeFootNotesPr=function(n,t){(t.footNoteNumberFormat||t.restartIndexForFootnotes)&&(n.writeStartElement(void 0,"footnotePr",this.wNamespace),n.writeStartElement(void 0,"pos",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,"pageBottom"),n.writeEndElement(),void 0!==t.footNoteNumberFormat&&(n.writeStartElement(void 0,"numFmt",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberFormat(t.footNoteNumberFormat)),n.writeEndElement()),void 0!==t.restartIndexForFootnotes&&(n.writeStartElement(void 0,"numRestart",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberRestart(t.restartIndexForFootnotes)),n.writeEndElement()),void 0!==t.initialFootNoteNumber&&(n.writeStartElement(void 0,"numStart",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,t.initialFootNoteNumber.toString()),n.writeEndElement()),n.writeEndElement())},n.prototype.getFootNoteNumberFormat=function(n){var t;switch(n){case"UpperCaseRoman":t="upperRoman";break;case"LowerCaseRoman":t="lowerRoman";break;case"UpperCaseLetter":t="upperLetter";break;case"LowerCaseLetter":t="lowerLetter";break;default:t="decimal"}return t},n.prototype.getFootNoteNumberRestart=function(n){switch(n){case"RestartForEachSection ":return"eachSect";case"RestartForEachPage":return"eachPage";default:return"continuous"}},n.prototype.serializeEndNotesPr=function(n,t){(t.endnoteNumberFormat||t.restartIndexForEndnotes)&&(n.writeStartElement(void 0,"endnotePr",this.wNamespace),n.writeStartElement(void 0,"pos",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,"docEnd"),n.writeEndElement(),void 0!==t.endnoteNumberFormat&&(n.writeStartElement(void 0,"numFmt",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberFormat(t.endnoteNumberFormat)),n.writeEndElement()),void 0!==t.restartIndexForEndnotes&&(n.writeStartElement(void 0,"numRestart",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberRestart(t.restartIndexForEndnotes)),n.writeEndElement()),void 0!==t.initialEndNoteNumber&&(n.writeStartElement(void 0,"numStart",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,t.initialEndNoteNumber.toString()),n.writeEndElement()),n.writeEndElement())},n.prototype.serializeColumns=function(n){n.writeStartElement(void 0,"cols",this.wNamespace);n.writeAttributeString(void 0,"equalWidth",this.wNamespace,"1");n.writeAttributeString(void 0,"space",this.wNamespace,"0");n.writeEndElement()},n.prototype.serializePageSetup=function(n,t){void 0!==t&&(this.serializePageSize(n,t),this.serializePageMargins(n,t));t.restartPageNumbering&&(n.writeStartElement(void 0,"pgNumType",this.wNamespace),n.writeAttributeString(void 0,"start",this.wNamespace,t.pageStartingNumber.toString()),n.writeEndElement());n.writeStartElement(void 0,"pgBorders",this.wNamespace);n.writeEndElement()},n.prototype.serializePageSize=function(n,t){n.writeStartElement(void 0,"pgSz",this.wNamespace);n.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t.pageWidth*this.twentiethOfPoint).toString());n.writeAttributeString(void 0,"h",this.wNamespace,this.roundToTwoDecimal(t.pageHeight*this.twentiethOfPoint).toString());n.writeEndElement()},n.prototype.serializePageMargins=function(n,t){n.writeStartElement(void 0,"pgMar",this.wNamespace);var i=Math.round(t.topMargin*this.twentiethOfPoint);n.writeAttributeString(void 0,"top",this.wNamespace,i.toString());i=Math.round(t.rightMargin*this.twentiethOfPoint);n.writeAttributeString(void 0,"right",this.wNamespace,i.toString());i=Math.round(t.bottomMargin*this.twentiethOfPoint);n.writeAttributeString(void 0,"bottom",this.wNamespace,i.toString());i=Math.round(t.leftMargin*this.twentiethOfPoint);n.writeAttributeString(void 0,"left",this.wNamespace,i.toString());n.writeAttributeString(void 0,"header",this.wNamespace,this.roundToTwoDecimal(t.headerDistance*this.twentiethOfPoint).toString());n.writeAttributeString(void 0,"footer",this.wNamespace,this.roundToTwoDecimal(t.footerDistance*this.twentiethOfPoint).toString());n.writeAttributeString(void 0,"gutter",this.wNamespace,"0");n.writeEndElement()},n.prototype.serializeSectionType=function(n,t){n.writeStartElement("w","type",this.wNamespace);n.writeAttributeString("w","val",this.wNamespace,t);n.writeEndElement()},n.prototype.serializeHFReference=function(n,t){var r="",i;void 0!==t&&(this.mDifferentFirstPage=this.section.sectionFormat.differentOddAndEvenPages,i=t.firstPageHeader,i&&i.blocks&&i.blocks.length>0&&(n.writeStartElement(void 0,"headerReference",this.wNamespace),n.writeAttributeString(void 0,"type",this.wNamespace,"first"),r=this.getNextRelationShipID(),n.writeAttributeString(void 0,"id",this.rNamespace,r),this.addHeaderFooter(i,"FirstPageHeader",r),n.writeEndElement()),(i=t.firstPageFooter)&&i.blocks&&i.blocks.length>0&&(n.writeStartElement(void 0,"footerReference",this.wNamespace),n.writeAttributeString(void 0,"type",this.wNamespace,"first"),r=this.getNextRelationShipID(),n.writeAttributeString(void 0,"id",this.rNamespace,r),this.addHeaderFooter(i,"FirstPageFooter",r),n.writeEndElement()),(i=t.evenHeader)&&i.blocks&&i.blocks.length>0&&(n.writeStartElement(void 0,"headerReference",this.wNamespace),n.writeAttributeString(void 0,"type",this.wNamespace,"even"),r=this.getNextRelationShipID(),n.writeAttributeString(void 0,"id",this.rNamespace,r),this.addHeaderFooter(i,"EvenHeader",r),n.writeEndElement()),(i=t.evenFooter)&&i.blocks&&i.blocks.length>0&&(n.writeStartElement(void 0,"footerReference",this.wNamespace),n.writeAttributeString(void 0,"type",this.wNamespace,"even"),r=this.getNextRelationShipID(),n.writeAttributeString(void 0,"id",this.rNamespace,r),this.addHeaderFooter(i,"EvenFooter",r),n.writeEndElement()),(i=t.header)&&i.blocks&&i.blocks.length>0&&(n.writeStartElement(void 0,"headerReference",this.wNamespace),n.writeAttributeString(void 0,"type",this.wNamespace,"default"),r=this.getNextRelationShipID(),n.writeAttributeString(void 0,"id",this.rNamespace,r),this.addHeaderFooter(i,"OddHeader",r),n.writeEndElement()),(i=t.footer)&&i.blocks&&i.blocks.length>0&&(n.writeStartElement(void 0,"footerReference",this.wNamespace),n.writeAttributeString(void 0,"type",this.wNamespace,"default"),r=this.getNextRelationShipID(),n.writeAttributeString(void 0,"id",this.rNamespace,r),this.addHeaderFooter(i,"OddFooter",r),n.writeEndElement()))},n.prototype.addHeaderFooter=function(n,t,i){var r=new h;this.headersFooters.add(t,r);this.headersFooters.get(t).add(i,n)},n.prototype.serializeBodyItems=function(n,t,i){for(var r=0;r<t.length;r++)this.serializeBodyItem(n,t[r],i)},n.prototype.serializeContentControl=function(n,t,i,r,u){if(sf.base.isNullOrUndefined(t))throw new Error("contentCOntrol should not be undefined");n.writeStartElement("w","sdt",this.wNamespace);n.writeStartElement(void 0,"sdtPr",this.wNamespace);sf.base.isNullOrUndefined(t)||this.serializeContentProperties(n,t,i,r,u)},n.prototype.serializeContentProperties=function(n,t,i,r,u){var s,c,o,f,e,l;if((sf.base.isNullOrUndefined(t.title)||(n.writeStartElement(void 0,"alias",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,t.title),n.writeEndElement(),n.writeStartElement(void 0,"tag",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,t.tag),n.writeEndElement()),sf.base.isNullOrUndefined(t.characterFormat)||this.serializeCharacterFormat(n,i.contentControlProperties.characterFormat),(t.lockContents||t.lockContentControl)&&(n.writeStartElement(void 0,"lock",this.wNamespace),t.lockContentControl&&t.lockContents?n.writeAttributeString("w","val",this.wNamespace,"sdtContentLocked"):t.lockContentControl?n.writeAttributeString("w","val",this.wNamespace,"sdtLocked"):t.lockContents&&n.writeAttributeString("w","val",this.wNamespace,"contentLocked"),n.writeEndElement()),t.hasPlaceHolderText&&sf.base.isNullOrUndefined(void 0)&&(n.writeStartElement("w","placeholder",void 0),n.writeAttributeString("w","docPart",this.wNamespace,void 0),n.writeEndElement(),n.writeStartElement("w","showingPlcHdr",void 0),n.writeEndElement()),t.isTemporary&&(n.writeStartElement("w","temporary",void 0),n.writeEndElement()),sf.base.isNullOrUndefined(t.appearance)||(n.writeStartElement("w15","appearance",void 0),n.writeAttributeString("w15","val",void 0,t.appearance.toLowerCase()),n.writeEndElement()),sf.base.isNullOrUndefined(t.color)||(n.writeStartElement("w15","color",void 0),n.writeAttributeString("w","val",void 0,this.getColor(t.color)),n.writeEndElement()),t.multiline&&(n.writeStartElement(void 0,"text",this.wNamespace),n.writeAttributeString("w","multiLine",this.wNamespace,"1"),n.writeEndElement()),sf.base.isNullOrUndefined(t.xmlMapping)||t.xmlMapping.isMapped&&(n.writeStartElement("w","dataBinding",this.wNamespace),n.writeAttributeString("w","xpath",void 0,t.xmlMapping.xPath),n.writeAttributeString("w","storeItemID",void 0,t.xmlMapping.storeItemId),n.writeEndElement()),t.picture&&(n.writeStartElement("w","picture",this.wNamespace),n.writeEndElement()),sf.base.isNullOrUndefined(t.uncheckedState||t.checkedState)||(n.writeStartElement("w14","checkbox",void 0),t.isChecked?(n.writeStartElement("w14","checked",void 0),n.writeAttributeString("w14","val",void 0,"1"),n.writeEndElement()):(n.writeStartElement("w14","checked",void 0),n.writeAttributeString("w14","val",void 0,"0"),n.writeEndElement()),n.writeStartElement("w14","uncheckedState",void 0),n.writeAttributeString("w14","val",void 0,this.toUnicode(t.uncheckedState.value)),n.writeAttributeString("w14","font",void 0,t.uncheckedState.font),n.writeEndElement(),n.writeStartElement("w14","checkedState",void 0),n.writeAttributeString("w14","val",void 0,this.toUnicode(t.checkedState.value)),n.writeAttributeString("w14","font",void 0,t.checkedState.font),n.writeEndElement(),n.writeEndElement()),sf.base.isNullOrUndefined(t.contentControlListItems)||"DropDownList"!==t.type)||(s=t.contentControlListItems,n.writeStartElement(void 0,"dropDownList",this.wNamespace),this.serializeContentControlList(n,s),n.writeEndElement()),sf.base.isNullOrUndefined(t.contentControlListItems)||"ComboBox"!==t.type||(c=t.contentControlListItems,n.writeStartElement(void 0,"comboBox",this.wNamespace),this.serializeContentControlList(n,c),n.writeEndElement()),this.serializeContentControlDate(n,t),sf.base.isNullOrUndefined(t.type)||"Picture"===t.type&&(n.writeStartElement(void 0,"picture",this.wNamespace),n.writeEndElement()),n.writeEndElement(),n.writeStartElement("w","sdtContent",this.wNamespace),!u){if(i.hasOwnProperty("blocks")&&sf.base.isNullOrUndefined(i.cellFormat))for(o=0;o<i.blocks.length;o++)f=i.blocks[o],f.hasOwnProperty("inlines")?(this.paragraph=f,this.serializeParagraph(n,f,r),this.paragraph=void 0):f.hasOwnProperty("rowFormat")?(e=new h,this.serializeRow(n,f,e)):f.hasOwnProperty("contentControlProperties")?this.serializeContentControl(n,f.contentControlProperties,f,r):(l=f,this.serializeTable(n,l));else i.hasOwnProperty("rowFormat")?i.cells.length>0&&(e=new h,this.serializeRow(n,i,e)):i.hasOwnProperty("cellFormat")&&(e=new h,this.serializeCell(n,i,e));n.writeEndElement();n.writeEndElement()}},n.prototype.toUnicode=function(n){return n.charCodeAt(0).toString(16)},n.prototype.serializeContentControlList=function(n,t){for(var i=0;i<t.length;i++)n.writeStartElement(void 0,"listItem",this.wNamespace),sf.base.isNullOrUndefined(t[i].displayText)||n.writeAttributeString("w","displayText",this.wNamespace,t[i].displayText),n.writeAttributeString("w","value",this.wNamespace,t[i].value),n.writeEndElement()},n.prototype.serializeContentParagraph=function(n,t){for(var r,u,f,i=0;i<t.blocks.length;i++)if(r=t.blocks[i],r.hasOwnProperty("inlines"))for(u=0;u<r.inlines.length;u++)f=r.inlines[u],sf.base.isNullOrUndefined(f.characterFormat)||this.serializeCharacterFormat(n,f.characterFormat)},n.prototype.serializeContentControlDate=function(n,t){"Date"===t.type&&(n.writeStartElement("w","date",this.wNamespace),sf.base.isNullOrUndefined(t.dateDisplayFormat)||(n.writeStartElement("w","calender",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,t.dateCalendarType),n.writeEndElement()),sf.base.isNullOrUndefined(t.dateDisplayLocale)||(n.writeStartElement("w","lid",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,t.dateDisplayLocale),n.writeEndElement()),sf.base.isNullOrUndefined(t.dateStorageFormat)||(n.writeStartElement("w","storeMappedDataAs",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,t.dateStorageFormat),n.writeEndElement()),sf.base.isNullOrUndefined(t.dateCalendarType)||(n.writeStartElement("w","dateFormat",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,t.dateDisplayFormat),n.writeEndElement()),n.writeEndElement())},n.prototype.serializeBodyItem=function(n,t,i){var u,f,r;if(sf.base.isNullOrUndefined(t))throw new Error("BodyItem should not be undefined");if(t.hasOwnProperty("contentControlProperties"))this.serializeContentControl(n,t.contentControlProperties,t,i);else if(t.hasOwnProperty("inlines"))this.paragraph=t,this.serializeParagraph(n,t,i),this.paragraph=void 0;else for(u=t,f=0;f<u.rows.length;f++)if(u.rows[f].cells.length>0){this.serializeTable(n,u);break}r=this.blockOwner;!i&&r.hasOwnProperty("sectionFormat")&&r.blocks.indexOf(t)===r.blocks.length-1&&(n.writeStartElement("w","p",this.wNamespace),n.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeSectionProperties(n,r),n.writeEndElement(),n.writeEndElement())},n.prototype.serializeParagraph=function(n,t){if(sf.base.isNullOrUndefined(t))throw new Error("Paragraph should not be undefined");n.writeStartElement("w","p",this.wNamespace);this.isInsideComment&&n.writeAttributeString("w14","paraId",void 0,this.commentParaID.toString());n.writeStartElement(void 0,"pPr",this.wNamespace);sf.base.isNullOrUndefined(t.paragraphFormat)||this.serializeParagraphFormat(n,t.paragraphFormat,t);sf.base.isNullOrUndefined(t.characterFormat)||this.serializeCharacterFormat(n,t.characterFormat);n.writeEndElement();this.prevRevisionIds=[];this.serializeParagraphItems(n,t.inlines);n.writeEndElement()},n.prototype.serializeRevisionStart=function(n,t,i){var f,u,r;if(t.hasOwnProperty("revisionIds")){if(!sf.base.isNullOrUndefined(i)&&i.hasOwnProperty("fieldType")&&0===i.fieldType)return;if(t.hasOwnProperty("fieldType")&&1===t.fieldType)return;if(!sf.base.isNullOrUndefined(i)&&i.hasOwnProperty("bookmarkType")&&0===i.bookmarkType&&!(i.name.indexOf("_Toc")>=0))return;for(f=t.revisionIds,u=0;u<f.length;u++)r=this.retrieveRevision(f[u]),"Insertion"===r.revisionType&&this.serializeTrackChanges(n,"ins",r.author,r.date),"Deletion"===r.revisionType&&this.serializeTrackChanges(n,"del",r.author,r.date)}},n.prototype.serializeTrackChanges=function(n,t,i,r){n.writeStartElement("w",t,this.wNamespace);n.writeAttributeString("w","id",this.wNamespace,(this.trackChangesId++).toString());n.writeAttributeString("w","author",this.wNamespace,i);n.writeAttributeString("w","date",this.wNamespace,r)},n.prototype.retrieveRevision=function(n){for(var t=0;t<this.revisions.length;t++)if(this.revisions[t].revisionID===n)return this.revisions[t]},n.prototype.serializeParagraphItems=function(n,t){for(var i,o,s,u,f=void 0,r=!1,e=0;e<t.length;e++)i=t[e],i.hasOwnProperty("contentControlProperties")&&(u=!0,this.serializeContentControl(n,i.contentControlProperties,i,void 0,u),this.serializeParagraphItems(n,i.inlines)),i.hasOwnProperty("inlines")&&this.serializeParagraphItems(n,i),this.serializeRevisionStart(n,i,f),o=!1,(i.characterFormat&&(o=!sf.base.isNullOrUndefined(i.characterFormat.bdo)&&"None"!==i.characterFormat.bdo)&&!r&&(this.serializeBiDirectionalOverride(n,i.characterFormat),r=!0),r&&!o&&(n.writeEndElement(),r=!1),i.hasOwnProperty("fieldType"))?this.serializeFieldCharacter(n,i):i.hasOwnProperty("imageString")?this.serializePicture(n,i):i.hasOwnProperty("shapeId")?(s=this.paragraph,this.serializeShape(n,i),this.paragraph=s):i.hasOwnProperty("bookmarkType")?this.serializeBookMark(n,i):i.hasOwnProperty("editRangeId")?this.serializeEditRange(n,i):i.hasOwnProperty("chartType")?(this.chart=i,this.serializeChart(n,i),this.serializeChartStructure()):i.hasOwnProperty("commentCharacterType")?this.serializeComment(n,i):i.hasOwnProperty("footnoteType")?this.serializeEFReference(n,i):this.serializeTextRange(n,i,f),this.serializeRevisionEnd(n,i,f),f=i,u&&(n.writeEndElement(),n.writeEndElement(),u=!1);r&&n.writeEndElement()},n.prototype.serializeEFReference=function(n,t){var i="",r=t.blocks;"Footnote"===t.footnoteType?(n.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(n,t.characterFormat),n.writeStartElement(void 0,"footnoteReference",this.wNamespace),i=this.getEFNextRelationShipID(),n.writeAttributeString(void 0,"id",this.wNamespace,i),this.addFootnotesEndnotes(r,"footnote",i),n.writeEndElement(),n.writeEndElement()):(n.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(n,t.characterFormat),n.writeStartElement(void 0,"endnoteReference",this.wNamespace),i=this.getEFNextRelationShipID(),n.writeAttributeString(void 0,"id",this.wNamespace,i),this.addFootnotesEndnotes(r,"endnote",i),n.writeEndElement(),n.writeEndElement())},n.prototype.addFootnotesEndnotes=function(n,t,i){var r=new h;this.endnotesFootnotes.add(t,r);this.endnotesFootnotes.get(t).add(i,n)},n.prototype.serializeEndnotesFootnote=function(n,t){var i;if(0!==this.endnotesFootnotes.length&&this.endnotesFootnotes.containsKey(t))for(var r=this.endnotesFootnotes.get(t),u=void 0,f=0;f<r.keys.length;f++)i=r.keys[f],u=r.get(i),"endnote"===t?(this.endnotesPath,this.endnotesRelationPath,this.serializeInlineEndnotes(n,u,i)):(this.footnotesPath,this.footnotesRelationPath,this.serializeInlineFootnotes(n,u,i))},n.prototype.serializeInlineEndnotes=function(n,t,i){this.endNoteFootnote=t;var r=this.blockOwner;this.blockOwner=t;n.writeStartElement("w","endnote",this.wNamespace);n.writeAttributeString(void 0,"id",this.wNamespace,i);this.serializeBodyItems(n,t,!0);n.writeEndElement();this.blockOwner=r;this.endNoteFootnote=void 0},n.prototype.serializeInlineFootnotes=function(n,t,i){this.endNoteFootnote=t;var r=this.blockOwner;this.blockOwner=t;n.writeStartElement("w","footnote",this.wNamespace);n.writeAttributeString(void 0,"id",this.wNamespace,i);this.serializeBodyItems(n,t,!0);n.writeEndElement();this.blockOwner=r;this.endNoteFootnote=void 0},n.prototype.writeEFCommonAttributes=function(n){n.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace);n.writeAttributeString("xmlns","cx",void 0,this.cxNamespace);n.writeAttributeString("xmlns","aink",void 0,"http://schemas.microsoft.com/office/drawing/2016/ink");n.writeAttributeString("xmlns","am3d",void 0,"http://schemas.microsoft.com/office/drawing/2017/,odel3d");this.writeCustom(n);n.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace);n.writeAttributeString("xmlns","wp",void 0,this.wpNamespace);n.writeAttributeString("xmlns","w",void 0,this.wNamespace);this.writeDup(n);n.writeAttributeString("xmlns","wne",void 0,this.wneNamespace);n.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace);n.writeAttributeString("mc","Ignorable",void 0,"w14 w15")},n.prototype.serializeFootnotes=function(){var n,t;sf.base.isNullOrUndefined(this.document.footnotes)||(n=new sf.fileutils.XmlWriter,n.writeStartElement("w","footnotes",this.wNamespace),this.writeEFCommonAttributes(n),n.writeStartElement("w","footnote",this.wNamespace),n.writeAttributeString(void 0,"type",this.wNamespace,"separator"),n.writeAttributeString(void 0,"id",this.wNamespace,"-1"),this.serializeBodyItems(n,this.document.footnotes.separator,!0),n.writeEndElement(),n.writeStartElement("w","footnote",this.wNamespace),n.writeAttributeString(void 0,"type",this.wNamespace,"continuationSeparator"),n.writeAttributeString(void 0,"id",this.wNamespace,"0"),this.serializeBodyItems(n,this.document.footnotes.continuationSeparator,!0),n.writeEndElement(),this.document.footnotes.continuationNotice&&(n.writeStartElement("w","endnote",this.wNamespace),n.writeAttributeString(void 0,"type",this.wNamespace,"continuationNotice"),n.writeAttributeString(void 0,"id",this.wNamespace,"1"),this.serializeBodyItems(n,this.document.footnotes.continuationNotice,!0),n.writeEndElement()),this.serializeEndnotesFootnote(n,"footnote"),n.writeEndElement(),t=new sf.compression.ZipArchiveItem(n.buffer,this.footnotesPath),this.mArchive.addItem(t))},n.prototype.serializeEndnotes=function(){var n,t;sf.base.isNullOrUndefined(this.document.endnotes)||(n=new sf.fileutils.XmlWriter,n.writeStartElement("w","endnotes",this.wNamespace),this.writeEFCommonAttributes(n),n.writeStartElement("w","endnote",this.wNamespace),n.writeAttributeString(void 0,"type",this.wNamespace,"separator"),n.writeAttributeString(void 0,"id",this.wNamespace,"-1"),this.serializeBodyItems(n,this.document.endnotes.separator,!0),n.writeEndElement(),n.writeStartElement("w","endnote",this.wNamespace),n.writeAttributeString(void 0,"type",this.wNamespace,"continuationSeparator"),n.writeAttributeString(void 0,"id",this.wNamespace,"0"),this.serializeBodyItems(n,this.document.endnotes.continuationSeparator,!0),n.writeEndElement(),this.document.endnotes.continuationNotice&&(n.writeStartElement("w","endnote",this.wNamespace),n.writeAttributeString(void 0,"type",this.wNamespace,"continuationNotice"),n.writeAttributeString(void 0,"id",this.wNamespace,"1"),this.serializeBodyItems(n,this.document.endnotes.continuationNotice,!0),n.writeEndElement()),this.serializeEndnotesFootnote(n,"endnote"),n.writeEndElement(),t=new sf.compression.ZipArchiveItem(n.buffer,this.endnotesPath),this.mArchive.addItem(t))},n.prototype.serializeRevisionEnd=function(n,t,i){var r,u;if(t.hasOwnProperty("revisionIds")){if(t.hasOwnProperty("fieldType")&&0===t.fieldType)return;if(!sf.base.isNullOrUndefined(i)&&i.hasOwnProperty("fieldType")&&(2===i.fieldType||0===i.fieldType&&t.text.indexOf("TOC")>=0))return;for(r=0;r<t.revisionIds.length;r++)u=this.retrieveRevision(t.revisionIds[r]),"Insertion"!==u.revisionType&&"Deletion"!==u.revisionType||n.writeEndElement()}},n.prototype.serializeComment=function(n,t){if(1!==this.mComments.length||""!==this.mComments[0].text){0===t.commentCharacterType?n.writeStartElement("w","commentRangeStart",this.wNamespace):1===t.commentCharacterType&&n.writeStartElement("w","commentRangeEnd",this.wNamespace);var i=this.commentId[t.commentId];sf.base.isNullOrUndefined(i)&&(i=this.commentId[t.commentId]=this.currentCommentId++);n.writeAttributeString("w","id",this.wNamespace,i.toString());n.writeEndElement();1===t.commentCharacterType&&this.serializeCommentItems(n,i)}},n.prototype.serializeCommentItems=function(n,t){n.writeStartElement("w","r",this.wNamespace);n.writeStartElement("w","commentReference",this.wNamespace);n.writeAttributeString("w","id",this.wNamespace,t.toString());n.writeEndElement();n.writeEndElement()},n.prototype.serializeBiDirectionalOverride=function(n,t){n.writeStartElement(void 0,"bdo",this.wNamespace);n.writeAttributeString(void 0,"val",this.wNamespace,t.bdo.toLowerCase())},n.prototype.serializeEditRange=function(n,t){t.hasOwnProperty("editableRangeStart")?n.writeStartElement("w","permEnd",this.wNamespace):(n.writeStartElement("w","permStart",this.wNamespace),t.user&&""!==t.user&&n.writeAttributeString("w","ed",this.wNamespace,t.user),t.group&&""!==t.group&&n.writeAttributeString("w","edGrp",this.wNamespace,t.group.toLowerCase()),t.columnFirst&&-1!==t.columnFirst&&n.writeAttributeString("w","colFirst",this.wNamespace,t.columnFirst.toString()),t.columnLast&&-1!==t.columnLast&&n.writeAttributeString("w","colLast",this.wNamespace,t.columnLast.toString()));n.writeAttributeString("w","id",this.wNamespace,t.editRangeId);n.writeEndElement()},n.prototype.serializeBookMark=function(n,t){var i=this.getBookmarkId(t.name),r=t.name;0===t.bookmarkType?(n.writeStartElement("w","bookmarkStart",this.wNamespace),n.writeAttributeString("w","name",this.wNamespace,r)):1===t.bookmarkType&&n.writeStartElement("w","bookmarkEnd",this.wNamespace);n.writeAttributeString("w","id",this.wNamespace,i.toString());n.writeEndElement()},n.prototype.getBookmarkId=function(n){var t=this.bookmarks.indexOf(n);return t<0&&(t=this.bookmarks.length,this.bookmarks.push(n)),t},n.prototype.serializePicture=function(n,t){t.width>=0&&t.height>=0&&(n.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(n,t.characterFormat),this.serializeDrawing(n,t),n.writeEndElement())},n.prototype.serializeShape=function(n,t){t.width>=0&&t.height>=0&&(n.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(n,t.characterFormat),this.serializeDrawing(n,t),n.writeEndElement())},n.prototype.serializeDrawing=function(n,t){n.writeStartElement(void 0,"drawing",this.wNamespace);t.hasOwnProperty("chartType")?this.serializeInlineCharts(n,t):"Inline"===t.textWrappingStyle?this.serializeInlinePictureAndShape(n,t):this.serializeWrappingPictureAndShape(n,t);n.writeEndElement()},n.prototype.serializeWrappingPictureAndShape=function(n,i){var r,u,f,e,o,s,h,c,l,a;n.writeStartElement("wp","anchor",this.wpNamespace);this.serializePictureAndShapeDistance(n,i);n.writeAttributeString(void 0,"simplePos",void 0,"0");n.writeAttributeString(void 0,"relativeHeight",void 0,i.zOrderPosition?Math.abs(i.zOrderPosition).toString():"0");r=i.textWrappingStyle&&"Behind"===i.textWrappingStyle;n.writeAttributeString(void 0,"behindDoc",void 0,r?"1":"0");u=i.LockAnchor?"1":"0";n.writeAttributeString(void 0,"locked",void 0,u);f=i.layoutInCell?"1":"0";n.writeAttributeString(void 0,"layoutInCell",void 0,f);e=i.allowOverlap?"1":"0";(n.writeAttributeString(void 0,"allowOverlap",void 0,e),n.writeStartElement("wp","simplePos",this.wpNamespace),n.writeAttributeString(void 0,"x",void 0,"0"),n.writeAttributeString(void 0,"y",void 0,"0"),n.writeEndElement(),n.writeStartElement("wp","positionH",this.wpNamespace),n.writeAttributeString(void 0,"relativeFrom",void 0,t.formatText("firstlower",i.horizontalOrigin.toString())),"None"===i.horizontalAlignment)?(n.writeStartElement("wp","posOffset",this.wpNamespace),o=Math.round(i.horizontalPosition*this.emusPerPoint),n.writeString(o.toString()),n.writeEndElement()):(n.writeStartElement("wp","align",this.wpNamespace),s=i.horizontalAlignment.toString().toLowerCase(),n.writeString(s),n.writeEndElement());(n.writeEndElement(),n.writeStartElement("wp","positionV",this.wpNamespace),n.writeAttributeString(void 0,"relativeFrom",void 0,t.formatText("firstlower",i.verticalOrigin.toString())),"None"===i.verticalAlignment)?(n.writeStartElement("wp","posOffset",this.wpNamespace),h=Math.round(i.verticalPosition*this.emusPerPoint),n.writeString(h.toString()),n.writeEndElement()):(n.writeStartElement("wp","align",this.wpNamespace),c=i.verticalAlignment.toString().toLowerCase(),n.writeString(c),n.writeEndElement());n.writeEndElement();n.writeStartElement(void 0,"extent",this.wpNamespace);l=Math.round(i.width*this.emusPerPoint);n.writeAttributeString(void 0,"cx",void 0,l.toString());a=Math.round(i.height*this.emusPerPoint);n.writeAttributeString(void 0,"cy",void 0,a.toString());n.writeEndElement();sf.base.isNullOrUndefined(i.imageString)?this.serializeShapeDrawingGraphics(n,i):(this.serializeShapeWrapStyle(n,i),this.serializeDrawingGraphics(n,i));n.writeEndElement()},n.prototype.serializeInlinePictureAndShape=function(n,t){var i,r;n.writeStartElement(void 0,"inline",this.wpNamespace);this.writeDefaultDistAttribute(n);n.writeStartElement(void 0,"extent",this.wpNamespace);i=Math.round(t.width*this.emusPerPoint);n.writeAttributeString(void 0,"cx",void 0,i.toString());r=Math.round(t.height*this.emusPerPoint);n.writeAttributeString(void 0,"cy",void 0,r.toString());n.writeEndElement();sf.base.isNullOrUndefined(t.imageString)?this.serializeShapeDrawingGraphics(n,t):(this.serializeShapeWrapStyle(n,t),this.serializeDrawingGraphics(n,t));n.writeEndElement()},n.prototype.serializePictureAndShapeDistance=function(n,t){var f=t.distanceTop?Math.round(t.distanceTop*this.emusPerPoint).toString():"0",i,r,u;n.writeAttributeString(void 0,"distT",void 0,f);i=t.distanceBottom?Math.round(t.distanceBottom*this.emusPerPoint).toString():"0";n.writeAttributeString(void 0,"distB",void 0,i);r=t.distanceLeft?Math.round(t.distanceLeft*this.emusPerPoint).toString():"114300";n.writeAttributeString(void 0,"distL",void 0,r);u=t.distanceRight?Math.round(t.distanceRight*this.emusPerPoint).toString():"114300";n.writeAttributeString(void 0,"distR",void 0,u)},n.prototype.writeDefaultDistAttribute=function(n){n.writeAttributeString(void 0,"distT",void 0,"0");n.writeAttributeString(void 0,"distB",void 0,"0");n.writeAttributeString(void 0,"distL",void 0,"0");n.writeAttributeString(void 0,"distR",void 0,"0")},n.prototype.serializeInlineCharts=function(n,t){var i,r;n.writeStartElement(void 0,"inline",this.wpNamespace);this.writeDefaultDistAttribute(n);n.writeStartElement(void 0,"extent",this.wpNamespace);i=Math.round(t.width*this.emusPerPoint);n.writeAttributeString(void 0,"cx",void 0,i.toString());r=Math.round(t.height*this.emusPerPoint);n.writeAttributeString(void 0,"cy",void 0,r.toString());n.writeEndElement();n.writeStartElement(void 0,"effectExtent",this.wpNamespace);n.writeAttributeString(void 0,"l",void 0,"0");n.writeAttributeString(void 0,"t",void 0,"0");n.writeAttributeString(void 0,"r",void 0,"0");n.writeAttributeString(void 0,"b",void 0,"0");n.writeEndElement();this.serializeDrawingGraphicsChart(n,t);n.writeEndElement()},n.prototype.serializeDrawingGraphicsChart=function(n,t){var i;i=this.updatechartId(t);n.writeStartElement("wp","docPr",this.wpNamespace);n.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString());n.writeAttributeString(void 0,"name",void 0,this.getNextChartName());n.writeEndElement();n.writeStartElement("wp","cNvGraphicFramePr",this.wpNamespace);n.writeEndElement();n.writeStartElement("a","graphic",this.aNamespace);n.writeStartElement("a","graphicData",this.aNamespace);n.writeAttributeString(void 0,"uri",void 0,this.chartNamespace);n.writeStartElement("c","chart",this.chartNamespace);n.writeAttributeString("xmlns","r",void 0,this.rNamespace);n.writeAttributeString("r","id",void 0,i);n.writeEndElement();n.writeEndElement();n.writeEndElement()},n.prototype.getNextChartName=function(){return"Chart"+ ++this.chartCount},n.prototype.serializeChart=function(n,t){n.writeStartElement("w","r",this.wNamespace);this.serializeCharacterFormat(n,t.characterFormat);this.serializeDrawing(n,t);n.writeEndElement()},n.prototype.serializeChartStructure=function(){this.serializeChartXML();this.serializeChartColors();this.serializeChartExcelData();this.serializeChartRelations();this.chart=void 0;this.saveExcel()},n.prototype.serializeChartXML=function(){var t,n=new sf.fileutils.XmlWriter,i;n.writeStartElement("c","chartSpace",this.chartNamespace);n.writeAttributeString("xmlns","a",void 0,this.aNamespace);n.writeAttributeString("xmlns","r",void 0,this.rNamespace);n.writeAttributeString("xmlns","c16r2",void 0,this.c15Namespace);this.serializeChartData(n,this.chart);n.writeStartElement("c","externalData",this.chartNamespace);n.writeAttributeString("r","id",void 0,"rId1");n.writeStartElement("c","autoUpdate",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"0");n.writeEndElement();n.writeEndElement();n.writeEndElement();t=this.chartPath+"/chart"+this.chartCount+".xml";i=new sf.compression.ZipArchiveItem(n.buffer,t);this.mArchive.addItem(i)},n.prototype.serializeChartColors=function(){var n=new sf.fileutils.XmlWriter,t="",i;n.writeStartElement("cs","colorStyle",this.csNamespace);n.writeAttributeString("xmlns","a",void 0,this.aNamespace);n.writeAttributeString(void 0,"meth",void 0,"cycle");n.writeAttributeString(void 0,"id",void 0,"10");this.serializeChartColor(n);t=this.chartPath+"/colors"+this.chartCount+".xml";n.writeEndElement();i=new sf.compression.ZipArchiveItem(n.buffer,t);this.mArchive.addItem(i);t=""},n.prototype.serializeChartColor=function(n){for(var t=1;t<=6;t++)n.writeStartElement("a","schemeClr",this.aNamespace),n.writeAttributeString(void 0,"val",void 0,"accent"+t),n.writeEndElement();n.writeStartElement("cs","variation",this.csNamespace);n.writeEndElement();n.writeStartElement("cs","variation",this.csNamespace);n.writeStartElement("a","lumMod",this.aNamespace);n.writeAttributeString(void 0,"val",void 0,"60000");n.writeEndElement();n.writeEndElement();n.writeStartElement("cs","variation",this.csNamespace);n.writeStartElement("a","lumMod",this.aNamespace);n.writeAttributeString(void 0,"val",void 0,"80000");n.writeEndElement();n.writeStartElement("a","lumOff",this.aNamespace);n.writeAttributeString(void 0,"val",void 0,"20000");n.writeEndElement();n.writeEndElement();n.writeStartElement("cs","variation",this.csNamespace);n.writeStartElement("a","lumMod",this.aNamespace);n.writeAttributeString(void 0,"val",void 0,"80000");n.writeEndElement();n.writeEndElement();n.writeStartElement("cs","variation",this.csNamespace);n.writeStartElement("a","lumMod",this.aNamespace);n.writeAttributeString(void 0,"val",void 0,"60000");n.writeEndElement();n.writeStartElement("a","lumOff",this.aNamespace);n.writeAttributeString(void 0,"val",void 0,"40000");n.writeEndElement();n.writeEndElement();n.writeStartElement("cs","variation",this.csNamespace);n.writeStartElement("a","lumMod",this.aNamespace);n.writeAttributeString(void 0,"val",void 0,"50000");n.writeEndElement();n.writeEndElement();n.writeStartElement("cs","variation",this.csNamespace);n.writeStartElement("a","lumMod",this.aNamespace);n.writeAttributeString(void 0,"val",void 0,"70000");n.writeEndElement();n.writeStartElement("a","lumOff",this.aNamespace);n.writeAttributeString(void 0,"val",void 0,"30000");n.writeEndElement();n.writeEndElement();n.writeStartElement("cs","variation",this.csNamespace);n.writeStartElement("a","lumMod",this.aNamespace);n.writeAttributeString(void 0,"val",void 0,"70000");n.writeEndElement();n.writeEndElement();n.writeStartElement("cs","variation",this.csNamespace);n.writeStartElement("a","lumMod",this.aNamespace);n.writeAttributeString(void 0,"val",void 0,"50000");n.writeEndElement();n.writeStartElement("a","lumOff",this.aNamespace);n.writeAttributeString(void 0,"val",void 0,"50000");n.writeEndElement();n.writeEndElement()},n.prototype.serializeChartExcelData=function(){sf.base.isNullOrUndefined(this.excelFiles)&&(this.excelFiles=new h);this.mArchiveExcel=new sf.compression.ZipArchive;this.mArchiveExcel.compressionLevel="Normal";var n=this.chart.chartType,t="Scatter_Markers"===n||"Bubble"===n;this.serializeWorkBook();this.serializeSharedString(t);this.serializeExcelContentTypes();this.serializeExcelData(t);this.serializeExcelStyles();this.serializeExcelRelation();this.serializeExcelGeneralRelations();this.chartStringCount=0},n.prototype.serializeWorkBook=function(){var n=new sf.fileutils.XmlWriter,t;this.resetExcelRelationShipId();n.writeStartElement(void 0,"workbook",void 0);n.writeAttributeString("xmlns","r",void 0,this.rNamespace);n.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace);n.writeStartElement(void 0,"sheets",void 0);n.writeStartElement(void 0,"sheet",void 0);n.writeAttributeString(void 0,"name",void 0,"Sheet1");n.writeAttributeString(void 0,"sheetId",void 0,"1");n.writeAttributeString("r","id",void 0,this.getNextExcelRelationShipID());n.writeEndElement();n.writeEndElement();n.writeEndElement();t=new sf.compression.ZipArchiveItem(n.buffer,"xl/workbook.xml");this.mArchiveExcel.addItem(t)},n.prototype.serializeExcelStyles=function(){var n=new sf.fileutils.XmlWriter,t;n.writeStartElement(void 0,"styleSheet",void 0);n.writeAttributeString("xmlns","mc",void 0,this.veNamespace);n.writeAttributeString("mc","Ignorable",void 0,"x14ac");n.writeAttributeString("xmlns","x14ac",void 0,"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac");n.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace);n.writeEndElement();t=new sf.compression.ZipArchiveItem(n.buffer,"xl/styles.xml");this.mArchiveExcel.addItem(t)},n.prototype.serializeExcelData=function(n){var t=new sf.fileutils.XmlWriter,i;t.writeStartElement(void 0,"worksheet",void 0);t.writeAttributeString("xmlns","r",void 0,this.rNamespace);t.writeAttributeString("xmlns","x14",void 0,this.spreadSheet9);t.writeAttributeString("xmlns","mc",void 0,this.veNamespace);t.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace);this.serializeExcelSheet(t,n);t.writeEndElement();i=new sf.compression.ZipArchiveItem(t.buffer,"xl/worksheets/sheet1.xml");this.mArchiveExcel.addItem(i)},n.prototype.serializeSharedString=function(n){for(var o,s,e,h,l,c,u,a,r=this.chart,t=new sf.fileutils.XmlWriter,i=[],v=this.chart.chartType,y=r.chartSeries.length,f=0;f<y;f++)o=r.chartSeries[f],s=o.seriesName.match(/[a-z]/i),n&&0===f&&i.push("X-Values"),s&&(i.push(o.seriesName),this.chartStringCount++);for("Bubble"===v&&i.push("Size"),e=0;e<r.chartCategory.length;e++)h=r.chartCategory[e],l=r.chartPrimaryCategoryAxis.numberFormat,((s=h.categoryXName.match(/[a-z]/i))||"m/d/yyyy"===l)&&(i.push(h.categoryXName),this.chartStringCount++);for(c=this.chartStringCount+1,t.writeStartElement(void 0,"sst",void 0),t.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),t.writeAttributeString(void 0,"count",void 0,c.toString()),t.writeAttributeString(void 0,"uniqueCount",void 0,c.toString()),u=0;u<=i.length;u++)t.writeStartElement(void 0,"si",void 0),t.writeStartElement(void 0,"t",void 0),u!==i.length?t.writeString(i[u]):n||(t.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),t.writeString(" ")),t.writeEndElement(),t.writeEndElement();t.writeEndElement();a=new sf.compression.ZipArchiveItem(t.buffer,"xl/sharedStrings.xml");this.mArchiveExcel.addItem(a)},n.prototype.serializeExcelSheet=function(n,t){var u,e=this.chart,f="s",h="Bubble"===e.chartType,w=e.chartCategory.length+1,b=e.chartPrimaryCategoryAxis.numberFormat,c=e.chartSeries.length+1,r,i,v,o,y,p;h&&(u=c,c+=1);var s=void 0,l=void 0,a=0;for(n.writeStartElement(void 0,"sheetData",void 0),r=0;r<w;r++){for(n.writeStartElement(void 0,"row",void 0),n.writeAttributeString(void 0,"r",void 0,(r+1).toString()),i=0;i<c;i++)v=String.fromCharCode("A".charCodeAt(0)+i)+(r+1).toString(),(n.writeStartElement(void 0,"c",void 0),n.writeAttributeString(void 0,"r",void 0,v),0!==r&&0===i)?(o=(s=e.chartCategory[r-1]).categoryXName.match(/[a-z]/i),f=sf.base.isNullOrUndefined(o)&&"m/d/yyyy"===b?"s":!o&&!sf.base.isNullOrUndefined(o)||t?"n":"s"):f=0===r&&0!==i&&i!==u?(o=(l=e.chartSeries[i-1]).seriesName.match(/[a-z]/i))?"s":"n":0===r&&h&&i===u||0===r&&0===i?"s":"n",(n.writeAttributeString(void 0,"t",void 0,f),n.writeStartElement(void 0,"v",void 0),0!==r||0!==i||t)?"s"===f?(n.writeString(a.toString()),a++):0!==r&&"s"!==f&&0===i&&i!==u?n.writeString(s.categoryXName):0!==i&&"s"!==f&&0===r&&i!==u?n.writeString(l.seriesName):0!==i&&i!==u?(y=s.chartData[i-1].yValue,n.writeString(y.toString())):h&&i===u&&(p=s.chartData[i-2].size,n.writeString(p.toString())):n.writeString(this.chartStringCount.toString()),n.writeEndElement(),n.writeEndElement(),f="";n.writeEndElement()}n.writeEndElement()},n.prototype.serializeExcelContentTypes=function(){var n=new sf.fileutils.XmlWriter,t;n.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types");this.serializeDefaultContentType(n,"xml",this.xmlContentType);this.serializeDefaultContentType(n,"rels",this.relationContentType);this.serializeOverrideContentType(n,"xl/styles.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml");this.serializeOverrideContentType(n,"xl/workbook.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml");this.serializeOverrideContentType(n,"xl/sharedStrings.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml");this.serializeOverrideContentType(n,"xl/worksheets/sheet1.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml");n.writeEndElement();t=new sf.compression.ZipArchiveItem(n.buffer,this.contentTypesPath);this.mArchiveExcel.addItem(t)},n.prototype.serializeExcelRelation=function(){var n=new sf.fileutils.XmlWriter,t;this.resetExcelRelationShipId();n.writeStartElement(void 0,"Relationships",this.rpNamespace);this.serializeRelationShip(n,this.getNextExcelRelationShipID(),"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","worksheets/sheet1.xml");this.serializeRelationShip(n,this.getNextExcelRelationShipID(),this.stylesRelType,"styles.xml");this.serializeRelationShip(n,this.getNextExcelRelationShipID(),"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","sharedStrings.xml");n.writeEndElement();t=new sf.compression.ZipArchiveItem(n.buffer,this.excelRelationPath);this.mArchiveExcel.addItem(t)},n.prototype.serializeExcelGeneralRelations=function(){var n=new sf.fileutils.XmlWriter,t;this.resetExcelRelationShipId();n.writeStartElement(void 0,"Relationships",this.rpNamespace);this.serializeRelationShip(n,this.getNextExcelRelationShipID(),this.documentRelType,"xl/workbook.xml");n.writeEndElement();t=new sf.compression.ZipArchiveItem(n.buffer,this.generalRelationPath);this.mArchiveExcel.addItem(t)},n.prototype.getNextExcelRelationShipID=function(){return"rId"+ ++this.eRelationShipId},n.prototype.getNextChartRelationShipID=function(){return"rId"+ ++this.cRelationShipId},n.prototype.serializeChartData=function(n,t){n.writeStartElement("c","date1904",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"0");n.writeEndElement();n.writeStartElement("c","lang",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"en-US");n.writeEndElement();n.writeStartElement("c","roundedCorners",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"0");n.writeEndElement();n.writeStartElement("mc","AlternateContent",this.veNamespace);n.writeStartElement("mc","Choice",this.veNamespace);n.writeAttributeString("xmlns","c14",void 0,this.c7Namespace);n.writeAttributeString(void 0,"Requires",void 0,"c14");n.writeStartElement("c14","style",void 0);n.writeAttributeString(void 0,"val",void 0,"102");n.writeEndElement();n.writeEndElement();n.writeStartElement("mc","Fallback",this.veNamespace);n.writeStartElement("c","style",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"2");n.writeEndElement();n.writeEndElement();n.writeEndElement();n.writeStartElement("c","chart",this.chartNamespace);sf.base.isNullOrUndefined(this.chart.chartTitle)||(n.writeStartElement("c","title",this.chartNamespace),this.serializeTextProperties(n,this.chart.chartTitleArea,this.chart.chartTitle),n.writeEndElement());this.serializeChartPlotArea(n,t);n.writeEndElement();this.serializeShapeProperties(n,"D9D9D9",!0);n.writeStartElement("c","txPr",this.chartNamespace);n.writeAttributeString("xmlns","c",void 0,this.chartNamespace);n.writeStartElement("a","bodyPr",this.aNamespace);n.writeAttributeString("xmlns","a",void 0,this.aNamespace);n.writeEndElement();n.writeStartElement("a","lstStyle",this.aNamespace);n.writeAttributeString("xmlns","a",void 0,this.aNamespace);n.writeEndElement();n.writeStartElement("a","p",this.aNamespace);n.writeAttributeString("xmlns","a",void 0,this.aNamespace);n.writeStartElement("a","pPr",this.aNamespace);n.writeStartElement("a","defRPr",this.aNamespace);n.writeEndElement();n.writeEndElement();n.writeStartElement("a","endParaRPr",this.aNamespace);n.writeAttributeString(void 0,"lang",void 0,"en-US");n.writeEndElement();n.writeEndElement();n.writeEndElement()},n.prototype.serializeChartPlotArea=function(n,t){var c,w,f,u,r,l,b,a,v,e,y,p;n.writeStartElement("c","autoTitleDeleted",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"0");n.writeEndElement();n.writeStartElement("c","plotArea",this.chartNamespace);n.writeStartElement("c","layout",this.chartNamespace);n.writeEndElement();var i=this.chartType(t),o="pieChart"===i||"doughnutChart"===i,h="scatterChart"===i||"bubbleChart"===i;for((n.writeStartElement("c",i,this.chartNamespace),"barChart"===i)&&(c="",c="Column_Clustered"===t.chartType||"Column_Stacked"===t.chartType||"Column_Stacked_100"===t.chartType?"col":"bar",n.writeStartElement("c","barDir",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,c),n.writeEndElement()),o||h||(w=this.chartGrouping(t.chartType),n.writeStartElement("c","grouping",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,w),n.writeEndElement()),"scatterChart"===i&&(n.writeStartElement("c","scatterStyle",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"marker"),n.writeEndElement()),n.writeStartElement("c","varyColors",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"0"),n.writeEndElement(),f="",u=0;u<t.chartSeries.length;u++){r=t.chartSeries[u];this.seriesCount=u;n.writeStartElement("c","ser",this.chartNamespace);n.writeStartElement("c","idx",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,u.toString());n.writeEndElement();n.writeStartElement("c","order",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,u.toString());n.writeEndElement();n.writeStartElement("c","tx",this.chartNamespace);n.writeStartElement("c","strRef",this.chartNamespace);n.writeStartElement("c","f",this.chartNamespace);l=String.fromCharCode("B".charCodeAt(0)+u);(f="Sheet1!$"+l,n.writeString(f+"$1"),f=f+"$2:$"+l+"$",n.writeEndElement(),n.writeStartElement("c","strCache",this.chartNamespace),n.writeStartElement("c","ptCount",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"1"),n.writeEndElement(),n.writeStartElement("c","pt",this.chartNamespace),n.writeAttributeString(void 0,"idx",void 0,"0"),n.writeStartElement("c","v",this.chartNamespace),n.writeString(r.seriesName),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),"Pie"===t.chartType||"Doughnut"===t.chartType?(this.parseChartDataPoint(n,r),n.writeStartElement("c","explosion",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"0"),n.writeEndElement()):h||this.parseChartSeriesColor(n,r.dataPoints,i),"scatterChart"===i)&&(b=r.dataPoints[0].fill.foreColor,n.writeStartElement("c","marker",this.chartNamespace),n.writeStartElement("c","symbol",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"circle"),n.writeEndElement(),n.writeStartElement("c","size",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"5"),n.writeEndElement(),this.serializeShapeProperties(n,b,!1),n.writeEndElement());r.dataLabel&&this.parseChartDataLabels(n,r.dataLabel);r.trendLines&&this.parseChartTrendLines(n,r);r.errorBar&&this.serializeChartErrorBar(n,r);"scatterChart"===i?this.serializeDefaultShapeProperties(n):"bubbleChart"===i&&this.serializeShapeProperties(n,r.dataPoints[u].fill.foreColor,!1);var k="cat",d="strRef",g="strCache";"scatterChart"===i&&(k="xVal",d="numRef",g="numCache");n.writeStartElement("c",k,this.chartNamespace);n.writeStartElement("c",d,this.chartNamespace);this.serializeChartCategory(n,t,g);n.writeEndElement();n.writeEndElement();this.serializeChartValue(n,f,i);n.writeEndElement()}if((n.writeStartElement("c","dLbls",this.chartNamespace),o&&(n.writeStartElement("c","dLblPos",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"bestFit"),n.writeEndElement()),n.writeStartElement("c","showLegendKey",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"0"),n.writeEndElement(),n.writeStartElement("c","showVal",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"0"),n.writeEndElement(),n.writeStartElement("c","showCatName",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"0"),n.writeEndElement(),n.writeStartElement("c","showSerName",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"0"),n.writeEndElement(),n.writeStartElement("c","showPercent",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"0"),n.writeEndElement(),n.writeStartElement("c","showBubbleSize",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"0"),n.writeEndElement(),n.writeStartElement("c","showLeaderLines",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"1"),n.writeEndElement(),n.writeEndElement(),o)&&(a=0,v=0,(r=this.chart.chartSeries[0]).hasOwnProperty("firstSliceAngle")&&(a=r.firstSliceAngle),n.writeStartElement("c","firstSliceAng",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,a.toString()),n.writeEndElement(),"Doughnut"===t.chartType&&(v=r.holeSize,n.writeStartElement("c","holeSize",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,v.toString()),n.writeEndElement())),"lineChart"===i||h?"bubbleChart"!==i&&(n.writeStartElement("c","smooth",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"0"),n.writeEndElement()):(n.writeStartElement("c","gapWidth",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,this.chart.gapWidth.toString()),n.writeEndElement(),n.writeStartElement("c","overlap",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,this.chart.overlap.toString()),n.writeEndElement()),"bubbleChart"===i&&(n.writeStartElement("c","sizeRepresents",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"area"),n.writeEndElement()),e=this.chart.chartType,o||(n.writeStartElement("c","axId",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"335265000"),n.writeEndElement(),n.writeStartElement("c","axId",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"335263360"),n.writeEndElement()),n.writeEndElement(),y="Column_Stacked_100"===e||"Area_Stacked_100"===e||"Bar_Stacked_100"===e||"Line_Stacked_100"===e||"Line_Markers_Stacked_100"===e,p=this.chart.chartPrimaryCategoryAxis.categoryType,o||(this.serializeCategoryAxis(n,p,y),this.serializeValueAxis(n,p,y)),this.chart.hasOwnProperty("chartDataTable")){var s=this.chart.chartDataTable,nt=0,tt=0,it=0,rt=0;s.showSeriesKeys&&(rt=1);s.hasHorzBorder&&(nt=1);s.hasVertBorder&&(tt=1);s.hasBorders&&(it=1);n.writeStartElement("c","dTable",this.chartNamespace);n.writeStartElement("c","showHorzBorder",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,nt.toString());n.writeEndElement();n.writeStartElement("c","showVertBorder",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,tt.toString());n.writeEndElement();n.writeStartElement("c","showOutline",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,it.toString());n.writeEndElement();n.writeStartElement("c","showKeys",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,rt.toString());n.writeEndElement();n.writeEndElement()}this.serializeDefaultShapeProperties(n);n.writeEndElement();sf.base.isNullOrUndefined(this.chart.chartLegend.position)||this.serializeChartLegend(n);n.writeStartElement("c","plotVisOnly",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"1");n.writeEndElement();n.writeStartElement("c","dispBlanksAs",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"gap");n.writeEndElement()},n.prototype.serializeChartLegend=function(n){var i=this.chartLegendPosition(this.chart.chartLegend),t=this.chart.chartLegend.chartTitleArea,r=t.dataFormat.fill.foreColor;n.writeStartElement("c","legend",this.chartNamespace);n.writeStartElement("c","legendPos",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,i);n.writeEndElement();n.writeStartElement("c","overlay",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"0");n.writeEndElement();this.serializeDefaultShapeProperties(n);n.writeStartElement("c","txPr",this.chartNamespace);n.writeStartElement("a","bodyPr",this.aNamespace);n.writeEndElement();n.writeStartElement("a","lstStyle",this.aNamespace);n.writeEndElement();n.writeStartElement("a","p",this.aNamespace);this.serializeChartTitleFont(n,t.fontSize,r,t.fontName);n.writeEndElement();n.writeEndElement();n.writeEndElement()},n.prototype.serializeChartErrorBar=function(n,t){var i=t.errorBar,u=this.errorBarValueType(i.type),r=0;"Cap"!==i.endStyle&&(r=1);n.writeStartElement("c","errBars",this.chartNamespace);n.writeStartElement("c","errBarType",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,i.direction.toLowerCase());n.writeEndElement();n.writeStartElement("c","errValType",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,u);n.writeEndElement();n.writeStartElement("c","noEndCap",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,r.toString());n.writeEndElement();n.writeStartElement("c","val",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,i.numberValue.toString());n.writeEndElement();this.serializeShapeProperties(n,"595959",!0);n.writeEndElement()},n.prototype.errorBarValueType=function(n){var t="";switch(n){case"StandardError":t="stdErr";break;case"StandardDeviation":t="stdDev";break;case"Percentage":t="percentage";break;case"Fixed":t="fixedVal";break;default:t="stdErr"}return t},n.prototype.serializeCategoryAxis=function(n,t,i){var r="catAx",e=this.chart.chartPrimaryCategoryAxis.numberFormat,u=this.chart.chartType,f="Scatter_Markers"===u||"Bubble"===u;"Time"===t&&(r="dateAx");f&&(r="valAx");n.writeStartElement("c",r,this.chartNamespace);n.writeStartElement("c","axId",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"335265000");n.writeEndElement();this.serializeAxis(n,"335263360",this.chart.chartPrimaryCategoryAxis,e,i);f||(n.writeStartElement("c","auto",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"1"),n.writeEndElement(),n.writeStartElement("c","lblAlgn",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"ctr"),n.writeEndElement(),n.writeStartElement("c","lblOffset",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"100"),n.writeEndElement());"Time"===t?(n.writeStartElement("c","baseTimeUnit",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"days"),n.writeEndElement()):"Bubble"!==this.chart.chartType&&(n.writeStartElement("c","noMultiLvlLbl",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"0"),n.writeEndElement());n.writeEndElement()},n.prototype.serializeValueAxis=function(n,t,i){var r=this.chart.chartPrimaryValueAxis,u="between";"Time"===t&&(u="midCat");n.writeStartElement("c","valAx",this.chartNamespace);n.writeStartElement("c","axId",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"335263360");n.writeEndElement();this.serializeAxis(n,"335265000",r,"General",i);n.writeStartElement("c","crossBetween",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,u);n.writeEndElement();0===r.majorUnit||i||(n.writeStartElement("c","majorUnit",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,r.majorUnit.toString()),n.writeEndElement());n.writeEndElement()},n.prototype.serializeAxis=function(n,t,i,r,u){n.writeStartElement("c","scaling",this.chartNamespace);n.writeStartElement("c","orientation",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"minMax");n.writeEndElement();0===i.maximumValue||u||(n.writeStartElement("c","max",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,i.maximumValue.toString()),n.writeEndElement(),n.writeStartElement("c","min",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,i.minimumValue.toString()),n.writeEndElement());n.writeEndElement();n.writeStartElement("c","delete",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"0");n.writeEndElement();n.writeStartElement("c","axPos",this.chartNamespace);"335265000"===t?n.writeAttributeString(void 0,"val",void 0,"l"):n.writeAttributeString(void 0,"val",void 0,"b");n.writeEndElement();i.hasMajorGridLines&&(n.writeStartElement("c","majorGridlines",this.chartNamespace),this.serializeShapeProperties(n,"D9D9D9",!0),n.writeEndElement());i.hasMinorGridLines&&(n.writeStartElement("c","minorGridlines",this.chartNamespace),this.serializeShapeProperties(n,"F2F2F2",!0),n.writeEndElement());i.chartTitle&&(n.writeStartElement("c","title",this.chartNamespace),this.serializeTextProperties(n,i.chartTitleArea,i.chartTitle),n.writeEndElement());n.writeStartElement("c","numFmt",this.chartNamespace);n.writeAttributeString(void 0,"formatCode",void 0,r);n.writeAttributeString(void 0,"sourceLinked",void 0,"1");n.writeEndElement();n.writeStartElement("c","majorTickMark",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"none");n.writeEndElement();n.writeStartElement("c","minorTickMark",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"none");n.writeEndElement();n.writeStartElement("c","tickLblPos",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"nextTo");n.writeEndElement();"Bubble"===this.chart.chartType?this.serializeShapeProperties(n,"BFBFBF",!0):this.serializeDefaultShapeProperties(n);n.writeStartElement("c","txPr",this.chartNamespace);n.writeStartElement("a","bodyPr",this.aNamespace);n.writeEndElement();n.writeStartElement("a","p",this.aNamespace);this.serializeChartTitleFont(n,i.fontSize,"595959",i.fontName);n.writeEndElement();n.writeEndElement();n.writeStartElement("c","crossAx",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,t);n.writeEndElement();n.writeStartElement("c","crosses",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"autoZero");n.writeEndElement()},n.prototype.parseChartTrendLines=function(n,t){for(var e,r=0;r<t.trendLines.length;r++){var i=t.trendLines[r],o=this.chartTrendLineType(i.type),u=0,f=0;i.isDisplayEquation?f=1:i.isDisplayRSquared&&(u=1);e=t.dataPoints[r];n.writeStartElement("c","trendline",this.chartNamespace);n.writeStartElement("c","spPr",this.chartNamespace);n.writeStartElement("a","ln",this.aNamespace);n.writeAttributeString(void 0,"w",void 0,"19050");this.serializeChartSolidFill(n,e.fill.foreColor,!1);n.writeStartElement("a","prstDash",this.aNamespace);n.writeAttributeString(void 0,"val",void 0,"sysDot");n.writeEndElement();n.writeStartElement("a","round",this.aNamespace);n.writeEndElement();n.writeEndElement();n.writeEndElement();n.writeStartElement("c","trendlineType",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,o);n.writeEndElement();n.writeStartElement("c","forward",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,i.forward.toString());n.writeEndElement();n.writeStartElement("c","backward",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,i.backward.toString());n.writeEndElement();"NaN"!==i.intercept&&(n.writeStartElement("c","intercept",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,i.intercept.toString()),n.writeEndElement());n.writeStartElement("c","dispRSqr",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,u.toString());n.writeEndElement();n.writeStartElement("c","dispEq",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,f.toString());n.writeEndElement();n.writeEndElement()}},n.prototype.chartTrendLineType=function(n){var t="";switch(n){case"Linear":t="linear";break;case"Exponential":t="exp"}return t},n.prototype.parseChartDataLabels=function(n,t){var i="",r=0,u=0,f=0,e=0,o=0,s=0,h=0;switch(t.position){case"Center":i="ctr";break;case"Left":i="l";break;case"Right":i="r";break;case"Outside":i="outEnd";break;case"BestFit":i="bestFit";break;case"Bottom":case"OutsideBase":i="inBase";break;case"Inside":i="inEnd";break;case"Above":i="t";break;case"Below":i="b";break;default:i="Automatic"}n.writeStartElement("c","dLbls",this.chartNamespace);this.serializeDefaultShapeProperties(n);n.writeStartElement("c","txPr",this.chartNamespace);n.writeStartElement("a","bodyPr",this.aNamespace);n.writeEndElement();n.writeStartElement("a","lstStyle",this.aNamespace);n.writeEndElement();n.writeStartElement("a","p",this.aNamespace);this.serializeChartTitleFont(n,t.fontSize,t.fontColor,t.fontName);n.writeEndElement();n.writeEndElement();t.isLegendKey?r=1:t.isBubbleSize?u=1:t.isCategoryName?f=1:t.isSeriesName?e=1:t.isValue?o=1:t.isPercentage?s=1:t.isLeaderLines&&(h=1);"Automatic"!==i&&(n.writeStartElement("c","dLblPos",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,i),n.writeEndElement());n.writeStartElement("c","showLegendKey",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,r.toString());n.writeEndElement();n.writeStartElement("c","showVal",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,o.toString());n.writeEndElement();n.writeStartElement("c","showCatName",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,f.toString());n.writeEndElement();n.writeStartElement("c","showSerName",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,e.toString());n.writeEndElement();n.writeStartElement("c","showPercent",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,s.toString());n.writeEndElement();n.writeStartElement("c","showBubbleSize",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,u.toString());n.writeEndElement();n.writeStartElement("c","showLeaderLines",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,h.toString());n.writeEndElement();n.writeEndElement()},n.prototype.serializeShapeProperties=function(n,t,i){var r=this.chart.chartType,u="Scatter_Markers"===r||"Bubble"===r;n.writeStartElement("c","spPr",this.chartNamespace);!u||i?(n.writeStartElement("a","ln",this.aNamespace),n.writeAttributeString(void 0,"w",void 0,"9525"),this.serializeChartSolidFill(n,t,!1),n.writeStartElement("a","prstDash",this.aNamespace),n.writeAttributeString(void 0,"val",void 0,"solid"),n.writeEndElement(),n.writeStartElement("a","round",this.aNamespace),n.writeEndElement(),n.writeEndElement()):"Scatter_Markers"===r?(this.serializeChartSolidFill(n,t,!1),this.serializeDefaultLineProperties(n)):"Bubble"===r&&(this.serializeChartSolidFill(n,t,!0),this.serializeDefaultLineProperties(n));n.writeStartElement("a","effectLst",this.aNamespace);n.writeEndElement();n.writeEndElement()},n.prototype.serializeDefaultShapeProperties=function(n){n.writeStartElement("c","spPr",this.chartNamespace);n.writeStartElement("a","noFill",this.aNamespace);n.writeEndElement();this.serializeDefaultLineProperties(n);n.writeStartElement("a","effectLst",this.aNamespace);n.writeEndElement();n.writeEndElement()},n.prototype.serializeDefaultLineProperties=function(n){n.writeStartElement("a","ln",this.aNamespace);n.writeStartElement("a","noFill",this.aNamespace);n.writeEndElement();n.writeStartElement("a","round",this.aNamespace);n.writeEndElement();n.writeEndElement()},n.prototype.serializeTextProperties=function(n,t,i){var r=t.dataFormat.fill.foreColor,u=100*t.fontSize;n.writeStartElement("c","tx",this.chartNamespace);n.writeStartElement("c","rich",this.chartNamespace);n.writeStartElement("a","bodyPr",this.aNamespace);n.writeAttributeString(void 0,"rot",void 0,"0");n.writeAttributeString(void 0,"vert",void 0,"horz");n.writeEndElement();n.writeStartElement("a","lstStyle",this.aNamespace);n.writeEndElement();n.writeStartElement("a","p",this.aNamespace);this.serializeChartTitleFont(n,t.fontSize,r,t.fontName);n.writeStartElement("a","r",this.aNamespace);n.writeStartElement("a","rPr",this.aNamespace);n.writeAttributeString(void 0,"lang",void 0,"en-US");n.writeAttributeString(void 0,"b",void 0,"0");n.writeAttributeString(void 0,"sz",void 0,u.toString());n.writeAttributeString(void 0,"baseline",void 0,"0");this.serializeChartSolidFill(n,r,!1);this.serializeFont(n,t.fontName);n.writeEndElement();n.writeStartElement("a","t",this.aNamespace);n.writeString(i);n.writeEndElement();n.writeEndElement();n.writeEndElement();n.writeEndElement();n.writeEndElement();n.writeStartElement("c","layout",this.chartNamespace);n.writeEndElement();n.writeStartElement("c","overlay",this.chartNamespace);n.writeAttributeString(void 0,"val",void 0,"0");n.writeEndElement();this.serializeDefaultShapeProperties(n);n.writeStartElement("c","txPr",this.chartNamespace);n.writeStartElement("a","bodyPr",this.aNamespace);n.writeEndElement();n.writeStartElement("a","lstStyle",this.aNamespace);n.writeEndElement();n.writeStartElement("a","p",this.aNamespace);n.writeEndElement();this.serializeChartTitleFont(n,t.fontSize,r,t.fontName);n.writeEndElement()},n.prototype.serializeChartTitleFont=function(n,t,i,r){var u=100*t;n.writeStartElement("a","pPr",this.aNamespace);n.writeStartElement("a","defRPr",this.aNamespace);n.writeAttributeString(void 0,"lang",void 0,"en-US");n.writeAttributeString(void 0,"b",void 0,"0");n.writeAttributeString(void 0,"sz",void 0,u.toString());n.writeAttributeString(void 0,"baseline",void 0,"0");this.serializeChartSolidFill(n,i,!1);this.serializeFont(n,r);n.writeEndElement();n.writeEndElement()},n.prototype.serializeChartSolidFill=function(n,t,i){n.writeStartElement("a","solidFill",this.aNamespace);n.writeStartElement("a","srgbClr",this.aNamespace);"000000"!==t?n.writeAttributeString(void 0,"val",void 0,t):n.writeAttributeString(void 0,"val",void 0,"595959");"Bubble"===this.chart.chartType&&i&&(n.writeStartElement("a","alpha",this.aNamespace),n.writeAttributeString(void 0,"val",void 0,"75000"),n.writeEndElement());n.writeEndElement();n.writeEndElement()},n.prototype.serializeFont=function(n,t){n.writeStartElement("a","latin",this.aNamespace);n.writeAttributeString(void 0,"typeface",void 0,t);n.writeEndElement();n.writeStartElement("a","ea",this.aNamespace);n.writeAttributeString(void 0,"typeface",void 0,t);n.writeEndElement();n.writeStartElement("a","cs",this.aNamespace);n.writeAttributeString(void 0,"typeface",void 0,t);n.writeEndElement()},n.prototype.parseChartSeriesColor=function(n,t,i){for(var u,f,e,r=0;r<t.length;r++)u=t[r],(n.writeStartElement("c","spPr",this.chartNamespace),"lineChart"===i&&(n.writeStartElement("a","ln",this.aNamespace),n.writeAttributeString(void 0,"w",void 0,"28575"),n.writeAttributeString(void 0,"cap",void 0,"rnd")),"lineChart"!==i?this.serializeChartSolidFill(n,u.fill.foreColor,!0):this.serializeChartSolidFill(n,u.line.color,!0),"lineChart"!==i&&(n.writeStartElement("a","ln",this.aNamespace),n.writeStartElement("a","noFill",this.aNamespace),n.writeEndElement()),n.writeStartElement("a","round",this.aNamespace),n.writeEndElement(),n.writeEndElement(),n.writeStartElement("a","effectLst",this.aNamespace),n.writeEndElement(),n.writeEndElement(),"lineChart"===i)&&(f="none",e=0,this.chart.chartSeries[r].hasOwnProperty("seriesFormat")&&(f=this.chart.chartSeries[r].seriesFormat.markerStyle,e=this.chart.chartSeries[r].seriesFormat.markerSize),n.writeStartElement("c","marker",this.chartNamespace),n.writeStartElement("c","symbol",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,f.toLowerCase()),n.writeEndElement(),this.chart.chartSeries[r].hasOwnProperty("seriesFormat")&&(n.writeStartElement("c","size",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,e.toString()),n.writeEndElement()),n.writeEndElement())},n.prototype.parseChartDataPoint=function(n,t){for(var u=t.dataPoints,r=[],i=0;i<u.length;i++)r.push(u[i]),n.writeStartElement("c","dPt",this.chartNamespace),n.writeStartElement("c","idx",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,i.toString()),n.writeEndElement(),n.writeStartElement("c","bubble3D",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"0"),n.writeEndElement(),this.parseChartSeriesColor(n,r,this.chart.chartType),n.writeEndElement(),r=[]},n.prototype.serializeChartCategory=function(n,t,i){var u=t.chartCategory,e=u.length,r,f;for(n.writeStartElement("c","f",this.chartNamespace),n.writeString("Sheet1!$A$2:$A$"+(e+1).toString()),n.writeEndElement(),n.writeStartElement("c",i,this.chartNamespace),"numCache"===i&&(n.writeStartElement("c","formatCode",this.chartNamespace),n.writeString("General"),n.writeEndElement()),n.writeStartElement("c","ptCount",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,e.toString()),n.writeEndElement(),r=0;r<u.length;r++)f=u[r],n.writeStartElement("c","pt",this.chartNamespace),n.writeAttributeString(void 0,"idx",void 0,r.toString()),n.writeStartElement("c","v",this.chartNamespace),""!==f.categoryXName&&n.writeString(f.categoryXName),n.writeEndElement(),n.writeEndElement();n.writeEndElement()},n.prototype.serializeChartValue=function(n,t,i){var r="val";("scatterChart"===i||"bubbleChart"===i)&&(r="yVal");this.serializeChartYValue(n,r,t);"bubbleChart"===i&&(r="bubbleSize",t="Sheet1!$C$2:$C$",this.serializeChartYValue(n,r,t));"lineChart"!==i&&"scatterChart"!==i||(n.writeStartElement("c","smooth",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,"0"),n.writeEndElement())},n.prototype.serializeChartYValue=function(n,t,i){var s=this.chart.chartCategory,f=s.length,r,e,u,o;for(n.writeStartElement("c",t,this.chartNamespace),n.writeStartElement("c","numRef",this.chartNamespace),n.writeStartElement("c","f",this.chartNamespace),n.writeString(i+(f+1).toString()),n.writeEndElement(),n.writeStartElement("c","numCache",this.chartNamespace),n.writeStartElement("c","formatCode",this.chartNamespace),n.writeString("General"),n.writeEndElement(),n.writeStartElement("c","ptCount",this.chartNamespace),n.writeAttributeString(void 0,"val",void 0,f.toString()),n.writeEndElement(),r=0;r<f;r++)for(e=s[r],u=0;u<e.chartData.length;u++)u===this.seriesCount&&(o=e.chartData[this.seriesCount],n.writeStartElement("c","pt",this.chartNamespace),n.writeAttributeString(void 0,"idx",void 0,r.toString()),n.writeStartElement("c","v",this.chartNamespace),"bubbleSize"!==t?n.writeString(o.yValue.toString()):n.writeString(o.size.toString()),n.writeEndElement(),n.writeEndElement());n.writeEndElement();n.writeEndElement();n.writeEndElement()},n.prototype.chartType=function(n){var t=n.chartType;switch(t){case"Pie":t="pieChart";break;case"Doughnut":t="doughnutChart";break;case"Scatter_Markers":t="scatterChart";break;case"Bubble":t="bubbleChart"}return"Area"!==t&&"Area_Stacked"!==t&&"Area_Stacked_100"!==t||(t="areaChart"),"Bar_Stacked_100"!==t&&"Bar_Stacked"!==t&&"Bar_Clustered"!==t&&"Column_Clustered"!==t&&"Column_Stacked"!==t&&"Column_Stacked_100"!==t||(t="barChart"),"Line"!==t&&"Line_Markers"!==t&&"Line_Markers_Stacked"!==t&&"Line_Stacked"!==t&&"Line_Markers_Stacked_100"!==t&&"Line_Stacked_100"!==t||(t="lineChart"),t},n.prototype.chartGrouping=function(n){var t="standard";return"Bar_Stacked"===n||"Column_Stacked"===n||"Area_Stacked"===n||"Line_Stacked"===n||"Line_Markers_Stacked"===n?t="stacked":"Bar_Stacked_100"===n||"Column_Stacked_100"===n||"Area_Stacked_100"===n||"Line_Stacked_100"===n||"Line_Markers_Stacked_100"===n?t="percentStacked":"Bar_Clustered"!==n&&"Column_Clustered"!==n||(t="clustered"),t},n.prototype.chartLegendPosition=function(n){var t=n.position;switch(t){case"Top":t="t";break;case"Bottom":t="b";break;case"Left":t="l";break;case"Right":t="r";break;case"Corner":t="tr";break;default:t="b"}return t},n.prototype.updatechartId=function(n){var t="";return""===t&&(t=this.addChartRelation(this.documentCharts,n)),t},n.prototype.addChartRelation=function(n,t){var i;return i=this.getNextRelationShipID(),n.add(i,t),i},n.prototype.startsWith=function(n,t){return t.length>0&&n.substring(0,t.length)===t},n.prototype.serializeShapeDrawingGraphics=function(n,t){var r=t.autoShapeType,u,f,e,i;t.shapeId;this.serializeShapeWrapStyle(n,t);n.writeStartElement("wp","docPr",this.wpNamespace);n.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString());n.writeAttributeString(void 0,"name",void 0,t.name);n.writeAttributeString(void 0,"title",void 0,t.title);n.writeEndElement();n.writeStartElement("a","graphic",this.aNamespace);n.writeStartElement("a","graphicData",this.aNamespace);n.writeAttributeString(void 0,"uri",void 0,this.wpShapeNamespace);n.writeStartElement("wps","wsp",this.wpShapeNamespace);n.writeStartElement("wps","cNvCnPr",this.wpShapeNamespace);n.writeStartElement("a","cxnSpLocks",this.aNamespace);n.writeAttributeString(void 0,"noChangeShapeType",void 0,"1");n.writeEndElement();n.writeEndElement();n.writeStartElement("wps","spPr",this.wpShapeNamespace);n.writeAttributeString(void 0,"bwMode",void 0,"auto");n.writeStartElement("a","xfrm",this.aNamespace);n.writeStartElement("a","off",this.aNamespace);n.writeAttributeString(void 0,"x",void 0,"0");n.writeAttributeString(void 0,"y",void 0,"0");n.writeEndElement();n.writeStartElement("a","ext",this.aNamespace);u=Math.round(t.width*this.emusPerPoint);n.writeAttributeString(void 0,"cx",void 0,u.toString());f=Math.round(t.height*this.emusPerPoint);n.writeAttributeString(void 0,"cy",void 0,f.toString());n.writeEndElement();n.writeEndElement();n.writeStartElement("a","prstGeom",this.aNamespace);"StraightConnector"===r?n.writeAttributeString(void 0,"prst",void 0,"straightConnector1"):"RoundedRectangle"===r?n.writeAttributeString(void 0,"prst",void 0,"roundRect"):n.writeAttributeString(void 0,"prst",void 0,"rect");n.writeStartElement("a","avLst",this.aNamespace);n.writeEndElement();n.writeEndElement();t.fillFormat&&t.fillFormat.color&&t.fillFormat.fill?(n.writeStartElement("a","solidFill",this.aNamespace),n.writeStartElement("a","srgbClr",this.aNamespace),n.writeAttributeString(void 0,"val",void 0,this.getColor(t.fillFormat.color)),n.writeEndElement(),n.writeEndElement()):(n.writeStartElement("a","noFill",this.aNamespace),n.writeEndElement());e=t.lineFormat.weight?t.lineFormat.weight*this.emusPerPoint:this.emusPerPoint;(n.writeStartElement("a","ln",this.aNamespace),n.writeAttributeString(void 0,"w",void 0,e.toString()),!sf.base.isNullOrUndefined(t.lineFormat.lineFormatType)&&"None"!==t.lineFormat.lineFormatType||t.lineFormat.line?(n.writeStartElement("a","solidFill",this.aNamespace),n.writeStartElement("a","srgbClr",this.aNamespace),n.writeAttributeString(void 0,"val",void 0,this.getColor(t.lineFormat.color)),n.writeEndElement(),n.writeEndElement(),n.writeStartElement("a","round",this.aNamespace),n.writeEndElement(),n.writeStartElement("a","headEnd",this.aNamespace),n.writeEndElement(),n.writeStartElement("a","tailEnd",this.aNamespace),n.writeEndElement()):(n.writeStartElement("a","noFill",this.aNamespace),n.writeEndElement()),n.writeEndElement(),n.writeEndElement(),"Rectangle"!==r&&"RoundedRectangle"!==r||(n.writeStartElement("wps","txbx",this.wpShapeNamespace),n.writeStartElement(void 0,"txbxContent",this.wNamespace),this.serializeBodyItems(n,t.textFrame.blocks,!0),n.writeEndElement(),n.writeEndElement()),n.writeStartElement("wps","bodyPr",this.wpShapeNamespace),sf.base.isNullOrUndefined(t.textFrame))||(i=void 0,t.textFrame.leftMargin>=0&&(i=Math.round(t.textFrame.leftMargin*this.emusPerPoint).toString(),n.writeAttributeString(void 0,"lIns",void 0,i)),t.textFrame.topMargin>=0&&(i=Math.round(t.textFrame.topMargin*this.emusPerPoint).toString(),n.writeAttributeString(void 0,"tIns",void 0,i)),t.textFrame.rightMargin>=0&&(i=Math.round(t.textFrame.rightMargin*this.emusPerPoint).toString(),n.writeAttributeString(void 0,"rIns",void 0,i)),t.textFrame.bottomMargin>=0&&(i=Math.round(t.textFrame.bottomMargin*this.emusPerPoint).toString(),n.writeAttributeString(void 0,"bIns",void 0,i)),n.writeAttributeString(void 0,"anchor",void 0,"t"),n.writeAttributeString(void 0,"anchorCtr",void 0,"0"));n.writeEndElement();n.writeEndElement();n.writeEndElement();n.writeEndElement()},n.prototype.serializeShapeWrapStyle=function(n,t){var i,r;"Inline"!==t.textWrappingStyle&&(i="wrapNone",(t.textWrappingStyle&&"InFrontOfText"!==t.textWrappingStyle&&"Behind"!==t.textWrappingStyle&&(i="wrap"+t.textWrappingStyle,"Tight"===t.textWrappingStyle&&(i="wrapSquare")),n.writeStartElement("wp",i,this.wpNamespace),t.textWrappingStyle&&"InFrontOfText"!==t.textWrappingStyle&&"Behind"!==t.textWrappingStyle&&t.textWrappingType)&&(r="Both"===t.textWrappingType?"bothSides":t.textWrappingType.toLowerCase(),n.writeAttributeString(void 0,"wrapText",void 0,r)),n.writeEndElement())},n.prototype.serializeDrawingGraphics=function(n,t){var i,r,u,f,e,o,s;(t.isMetaFile&&!sf.base.isNullOrUndefined(t.metaFileImageString)&&(t.imageString=t.metaFileImageString),i=this.updateShapeId(t),n.writeStartElement("wp","docPr",this.wpNamespace),n.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),sf.base.isNullOrUndefined(t.alternativeText)||n.writeAttributeString(void 0,"descr",void 0,t.alternativeText),n.writeAttributeString(void 0,"name",void 0,sf.base.isNullOrUndefined(t.name)?"":t.name),sf.base.isNullOrUndefined(t.title)||n.writeAttributeString(void 0,"title",void 0,t.title),n.writeEndElement(),n.writeStartElement("a","graphic",this.aNamespace),n.writeStartElement("a","graphicData",this.aNamespace),n.writeAttributeString(void 0,"uri",void 0,this.pictureNamespace),n.writeStartElement("pic","pic",this.pictureNamespace),n.writeStartElement("pic","nvPicPr",this.pictureNamespace),n.writeStartElement("pic","cNvPr",this.pictureNamespace),n.writeAttributeString(void 0,"id",void 0,"0"),n.writeAttributeString(void 0,"name",void 0,""),n.writeAttributeString(void 0,"descr",void 0,""),n.writeEndElement(),n.writeStartElement("pic","cNvPicPr",this.pictureNamespace),n.writeStartElement("a","picLocks",this.aNamespace),n.writeAttributeString(void 0,"noChangeAspect",void 0,"1"),n.writeAttributeString(void 0,"noChangeArrowheads",void 0,"1"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),n.writeStartElement("pic","blipFill",this.pictureNamespace),n.writeStartElement("a","blip",this.aNamespace),this.startsWith(t.imageString,"data:image")?n.writeAttributeString("r","embed",this.rNamespace,i):this.documentImages.containsKey(i)&&(this.documentImages.remove(i),this.externalImages.add(i,t.imageString),n.writeAttributeString(void 0,"link",this.rNamespace,i)),n.writeEndElement(),t.iscrop)&&(n.writeStartElement("a","srcRect",this.aNamespace),r=Math.round(1e3*t.left),n.writeAttributeString(void 0,"l",void 0,r.toString()),u=Math.round(1e3*t.top),n.writeAttributeString(void 0,"t",void 0,u.toString()),f=Math.round(1e3*t.right),n.writeAttributeString(void 0,"r",void 0,f.toString()),e=Math.round(1e3*t.bottom),n.writeAttributeString(void 0,"b",void 0,e.toString()),n.writeEndElement());n.writeStartElement("a","stretch",this.aNamespace);n.writeStartElement("a","fillRect",this.aNamespace);n.writeEndElement();n.writeEndElement();n.writeEndElement();n.writeStartElement("pic","spPr",this.pictureNamespace);n.writeAttributeString(void 0,"bwMode",void 0,"auto");n.writeStartElement("a","xfrm",this.aNamespace);n.writeStartElement("a","off",this.aNamespace);n.writeAttributeString(void 0,"x",void 0,"0");n.writeAttributeString(void 0,"y",void 0,"0");n.writeEndElement();n.writeStartElement("a","ext",this.aNamespace);o=Math.round(t.width*this.emusPerPoint);n.writeAttributeString(void 0,"cx",void 0,o.toString());s=Math.round(t.height*this.emusPerPoint);n.writeAttributeString(void 0,"cy",void 0,s.toString());n.writeEndElement();n.writeEndElement();n.writeStartElement("a","prstGeom",this.aNamespace);n.writeAttributeString(void 0,"prst",void 0,"rect");n.writeStartElement("a","avLst",this.aNamespace);n.writeEndElement();n.writeEndElement();n.writeEndElement();n.writeEndElement();n.writeEndElement();n.writeEndElement()},n.prototype.updateShapeId=function(n){var t="",i=this.paragraph;return this.headerFooter?t=this.updateHFImageRels(this.headerFooter,n):""===t&&(i.hasOwnProperty("sectionFormat")||i.hasOwnProperty("inlines"))&&(t=this.addImageRelation(this.documentImages,n)),t},n.prototype.addImageRelation=function(n,t){var i;return i=this.getNextRelationShipID(),n.add(i,t),i},n.prototype.updateHFImageRels=function(n,t){for(var i,f="",r="",s=this.headersFooters.keys,e=0;e<s.length;e++)for(var c=this.headersFooters.get(s[e]),o=c.keys,u=0;u<o.length;u++)c.get(o[u])===n&&(r=o[u],i=void 0,this.headerFooterImages.containsKey(r)?(i=this.headerFooterImages.get(r),f=this.addImageRelation(i,t)):(i=new h,f=this.addImageRelation(i,t),this.headerFooterImages.add(r,i)));return f},n.prototype.serializeTable=function(n,t){var w,b,y,s,k,e,c,o,i,nt,r,tt;if(!(t.rows.length<=0)){w=this.table;this.table=t;n.writeStartElement(void 0,"tbl",this.wNamespace);b=t.rows[0].rowFormat;this.serializeTableFormat(n,b,t);this.serializeTableGrid(n,t);var u=new h,f=new h,a=new h,p=t.rows;if(p.length>0)for(y=0;y<p.length;y++)if(s=p[y],s.cells.length>0){if(s.hasOwnProperty("contentControlProperties")){this.serializeContentControl(n,s.contentControlProperties,s);continue}k=this.row;this.row=s;n.writeStartElement(void 0,"tr",this.wNamespace);this.serializeRowFormat(n,s);for(var d=s.cells,g=d.length,l=0,v=0;v<g;v++)if(e=d[v],c=e.columnIndex,e.hasOwnProperty("contentControlProperties"))this.serializeContentControl(n,e.contentControlProperties,e);else{if(o=e.cellFormat,c-l>0)for(i=0===v?0:l+1;i<c;i++)u.containsKey(i)&&(nt=this.getMergeCellFormat(o,a.get(i),i<e.columnIndex),this.serializeTableCell(n,e,nt,!1),u.set(i,u.get(i)-1),1===u.get(i)&&(u.remove(i),a.remove(i),f.containsKey(i)&&f.remove(i)),f.containsKey(i)&&(l+=f.get(i)-1,i+=f.get(i)));for(l=c,o.rowSpan>1&&(u.add(c,o.rowSpan),a.add(c,o)),this.serializeTableCell(n,e,o,!0),o.columnSpan>1&&o.rowSpan>1&&f.add(c,o.columnSpan),r=c+1;;r++)if(u.containsKey(r))tt=this.getMergeCellFormat(o,a.get(r),r<e.columnIndex),this.serializeTableCell(n,e,tt,!1),u.set(r,u.get(r)-1),l++,1===u.get(r)&&(u.remove(r),a.remove(r),f.containsKey(r)&&f.remove(r)),f.containsKey(r)&&(l+=f.get(r)-1,r+=f.get(r));else if(!(v===g-1&&r<t.columnCount))break}n.writeEndElement();this.row=k}n.writeEndElement();this.table=w}},n.prototype.getMergeCellFormat=function(n,t,i){var r=t;return i?r.borders.right=n.borders.left:r.borders.left=n.borders.right,r},n.prototype.serializeTableCell=function(n,t,i,r){var o=this.blockOwner,e,u,f;if((this.blockOwner=t,n.writeStartElement(void 0,"tc",this.wNamespace),n.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(n,i),this.serializeCellMargins(n,i),n.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(n,i.borders,8),n.writeEndElement(),this.serializeShading(n,t.cellFormat.shading),this.serializeTableCellDirection(n,i),this.serializeCellVerticalAlign(n,i.verticalAlignment),i.columnSpan>1)&&(e=i.columnSpan,n.writeStartElement(void 0,"gridSpan",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,e.toString()),n.writeEndElement()),i.rowSpan>1&&(n.writeStartElement(void 0,"vMerge",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,r?"restart":"continue"),n.writeEndElement()),n.writeEndElement(),t&&t.blocks.length>0)for(u=0,f=void 0;u<t.blocks.length;)f=t.blocks[u],this.serializeBodyItem(n,f,!1),u+=1;else n.writeStartElement(void 0,"p",this.wNamespace),n.writeStartElement(void 0,"pPr",this.wNamespace),n.writeStartElement(void 0,"pStyle",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,"Normal"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement();n.writeEndElement();this.blockOwner=o},n.prototype.serializeTableGrid=function(n,t){n.writeStartElement(void 0,"tblGrid",this.wNamespace);0!==t.grid.length&&this.serializeGridColumns(n,t.grid);n.writeEndElement()},n.prototype.serializeTableRows=function(n,t){var u=new h,r,i;if(t.length>0)for(r=0;r<t.length;r++)if(i=t[r],i.cells.length>0){if(i.hasOwnProperty("contentControlProperties")){this.serializeContentControl(n,i.contentControlProperties,i);continue}this.serializeRow(n,i,u)}},n.prototype.serializeRow=function(n,t,i){var r=this.row;this.row=t;n.writeStartElement(void 0,"tr",this.wNamespace);this.serializeRowFormat(n,t);this.serializeCells(n,t.cells,i);n.writeEndElement();this.row=r},n.prototype.serializeRowFormat=function(n,t){var o,i,r,u,f,e;if((this.serializeRowMargins(n,t.rowFormat),n.writeStartElement(void 0,"trPr",this.wNamespace),t.rowFormat.height>0)&&(n.writeStartElement(void 0,"trHeight",this.wNamespace),"Exactly"===t.rowFormat.heightType?n.writeAttributeString("w","hRule",this.wNamespace,"exact"):"AtLeast"===t.rowFormat.heightType&&n.writeAttributeString("w","hRule",this.wNamespace,"atLeast"),o=this.roundToTwoDecimal(t.rowFormat.height*this.twentiethOfPoint).toString(),n.writeAttributeString("w","val",this.wNamespace,o),n.writeEndElement()),i=t.rowFormat,r=i.gridBefore,r>0&&(n.writeStartElement(void 0,"gridBefore",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,r.toString()),n.writeEndElement()),u=i.gridAfter,u>0&&(n.writeStartElement(void 0,"gridAfter",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,u.toString()),n.writeEndElement()),r>0){switch(n.writeStartElement(void 0,"wBefore",this.wNamespace),i.gridBeforeWidthType){case"Percent":f=this.roundToTwoDecimal(i.gridBeforeWidth*this.percentageFactor).toString();n.writeAttributeString("w","val",this.wNamespace,f);n.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":e=this.roundToTwoDecimal(i.gridBeforeWidth*this.twipsInOnePoint).toString();n.writeAttributeString("w","val",this.wNamespace,e);n.writeAttributeString("w","type",this.wNamespace,"dxa")}n.writeEndElement()}if(u>0){switch(n.writeStartElement(void 0,"wAfter",this.wNamespace),i.gridAfterWidthType){case"Percent":f=this.roundToTwoDecimal(i.gridAfterWidth*this.percentageFactor).toString();n.writeAttributeString("w","val",this.wNamespace,f);n.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":e=this.roundToTwoDecimal(i.gridAfterWidth*this.twipsInOnePoint).toString();n.writeAttributeString("w","val",this.wNamespace,e);n.writeAttributeString("w","type",this.wNamespace,"dxa")}n.writeEndElement()}i.allowBreakAcrossPages||(n.writeStartElement(void 0,"cantSplit",this.wNamespace),n.writeEndElement());i.isHeader&&(n.writeStartElement(void 0,"tblHeader",this.wNamespace),n.writeEndElement());!sf.base.isNullOrUndefined(i.revisionIds)&&i.revisionIds.length>0&&(this.serializeRevisionStart(n,i,void 0),this.serializeRevisionEnd(n,i,void 0));n.writeEndElement()},n.prototype.serializeCells=function(n,t,i){for(var r=0;r<t.length;r++)t[r].hasOwnProperty("contentControlProperties")?this.serializeContentControl(n,t[r].contentControlProperties,t[r]):this.serializeCell(n,t[r],i)},n.prototype.serializeCell=function(n,t,i){var o=this.blockOwner,u,f,r,e;if(this.blockOwner=t,n.writeStartElement(void 0,"tc",this.wNamespace),i=this.serializeCellFormat(n,t.cellFormat,!0,!0,i),t.blocks.length>0)for(u=0,f=void 0;u<t.blocks.length;)f=t.blocks[u],this.serializeBodyItem(n,f,!1),u+=1;else n.writeStartElement(void 0,"p",this.wNamespace),n.writeStartElement(void 0,"pPr",this.wNamespace),n.writeStartElement(void 0,"pStyle",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,"Normal"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement();if(n.writeEndElement(),r=1,i.containsKey(t.columnIndex+t.cellFormat.columnSpan-1+r)&&1===this.row.cells.length)for(e=i.keys[i.keys.length-1];r<=e;)r=this.createCellForMerge(n,t,i,r),r++;else this.createCellForMerge(n,t,i,r);this.blockOwner=o},n.prototype.createCellForMerge=function(n,t,i,r){for(var f,u;i.containsKey(t.columnIndex+t.cellFormat.columnSpan-1+r)&&(this.row.cells.indexOf(t)===this.row.cells.length-1||this.row.cells.indexOf(t)===t.columnIndex)&&void 0===t.nextNode;)f=t.columnIndex+t.cellFormat.columnSpan-1+r,n.writeStartElement(void 0,"tc",this.wNamespace),u=!0,sf.base.isNullOrUndefined(this.spanCellFormat)?(n.writeStartElement(void 0,"tcPr",this.wNamespace),u=!1):(u=!1,i=this.serializeCellFormat(n,this.spanCellFormat,!1,u,i)),this.serializeColumnSpan(f,n),n.writeStartElement(void 0,"vMerge",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,"continue"),n.writeEndElement(),sf.base.isNullOrUndefined(this.spanCellFormat)&&(n.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(n,t.cellFormat.borders,8),n.writeEndElement()),u||n.writeEndElement(),i=this.checkMergeCell(f,i),n.writeStartElement("w","p",this.wNamespace),n.writeEndElement(),n.writeEndElement(),r++;return r},n.prototype.serializeCellFormat=function(n,t,i,r,u){var f=this.blockOwner;return this.table.tableFormat,this.row.rowFormat,n.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(n,t),this.serializeCellMargins(n,t),i&&(u=this.serializeCellMerge(n,t,u),this.serializeGridSpan(n,f)),n.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(n,t.borders,8),n.writeEndElement(),this.serializeShading(n,f.cellFormat.shading),this.serializeTableCellDirection(n,t),this.serializeCellVerticalAlign(n,t.verticalAlignment),r&&n.writeEndElement(),u},n.prototype.serializeCellWidth=function(n,t){n.writeStartElement(void 0,"tcW",this.wNamespace);"Percent"===t.preferredWidthType?(n.writeAttributeString(void 0,"type",this.wNamespace,"pct"),n.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t.preferredWidth*this.percentageFactor).toString())):"Auto"===t.preferredWidthType?(n.writeAttributeString(void 0,"type",this.wNamespace,"auto"),n.writeAttributeString(void 0,"w",this.wNamespace,"0")):(n.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t.preferredWidth*this.twipsInOnePoint).toString()),n.writeAttributeString(void 0,"type",this.wNamespace,"dxa"));n.writeEndElement()},n.prototype.serializeCellMerge=function(n,t,i){var r,u=this.blockOwner,f=!1,h=u.columnIndex,e=this.row.cells.indexOf(u),o=e>0?this.row.cells[e-1].columnIndex:u.columnIndex,s;if(u.columnIndex===e?(r=u.columnIndex,f=!0):f=!1,!f)for(0===e&&(h=u.columnIndex,o=-1),s=o;s<h;s++)r=o+1,o+=1,0===r&&i.containsKey(r)&&(i=this.createMerge(n,r,u,i));return t.rowSpan>1?(n.writeStartElement(void 0,"vMerge",this.wNamespace),this.spanCellFormat=t,i.add(r,t.rowSpan-1),t.columnSpan>1&&this.mGridSpans.add(r,t.columnSpan),n.writeAttributeString("w","val",this.wNamespace,"restart"),n.writeEndElement()):i.containsKey(r)&&f&&(i=this.createMerge(n,r,u,i)),i},n.prototype.createMerge=function(n,t,i,r){return this.serializeColumnSpan(t,n),n.writeStartElement(void 0,"vMerge",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,"continue"),n.writeEndElement(),n.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(n,i.cellFormat.borders,8),n.writeEndElement(),n.writeEndElement(),n.writeStartElement("w","p",this.wNamespace),n.writeEndElement(),n.writeEndElement(),n.writeStartElement(void 0,"tc",this.wNamespace),n.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(n,i.cellFormat),r=this.checkMergeCell(t,r)},n.prototype.serializeColumnSpan=function(n,t){this.mGridSpans.keys.length>0&&this.mGridSpans.containsKey(n)&&(t.writeStartElement(void 0,"gridSpan",this.wNamespace),t.writeAttributeString("w","val",this.wNamespace,this.mGridSpans.get(n).toString()),t.writeEndElement())},n.prototype.checkMergeCell=function(n,t){return t.get(n)-1==0?(t.remove(n),this.spanCellFormat=void 0,this.mGridSpans.keys.length>0&&this.mGridSpans.containsKey(n)&&this.mGridSpans.remove(n)):t.set(n,t.get(n)-1),t},n.prototype.serializeGridSpan=function(n,t){if(t.cellFormat.columnSpan>1){var i=t.cellFormat.columnSpan;n.writeStartElement(void 0,"gridSpan",this.wNamespace);n.writeAttributeString("w","val",this.wNamespace,i.toString());n.writeEndElement()}},n.prototype.serializeTableCellDirection=function(){},n.prototype.serializeCellVerticalAlign=function(n,t){switch(n.writeStartElement(void 0,"vAlign",this.wNamespace),t){case"Center":n.writeAttributeString("w","val",this.wNamespace,"center");break;case"Bottom":n.writeAttributeString("w","val",this.wNamespace,"bottom");break;default:n.writeAttributeString("w","val",this.wNamespace,"top")}n.writeEndElement()},n.prototype.serializeGridColumns=function(n,t){for(var u,i=0,r=t.length;i<r;i++)u=Math.round(20*t[i]),n.writeStartElement(void 0,"gridCol",this.wNamespace),n.writeAttributeString(void 0,"w",this.wNamespace,u.toString()),n.writeEndElement()},n.prototype.serializeTableFormat=function(n,t,i){n.writeStartElement(void 0,"tblPr",this.wNamespace);this.serializeTablePositioning(n,i);this.serializeTableWidth(n,i);this.serializeTableAlignment(n,i.tableFormat);this.serializeCellSpacing(n,i.tableFormat);this.serializeTableIndentation(n,i.tableFormat);this.serializeTableMargins(n,i.tableFormat);this.serializeTableBorders(n,i.tableFormat);this.serializeShading(n,i.tableFormat.shading);i.tableFormat.bidi&&(n.writeStartElement(void 0,"bidiVisual",this.wNamespace),n.writeEndElement());this.serializeTblLayout(n,i.tableFormat);sf.base.isNullOrUndefined(i)||n.writeEndElement()},n.prototype.serializeTablePositioning=function(n,t){var i,r,u,f,e,o,s,h,c;t.wrapTextAround&&((n.writeStartElement("w","tblpPr",this.wNamespace),t.positioning.distanceLeft>0)&&(i=Math.round(t.positioning.distanceLeft*this.twipsInOnePoint).toString(),n.writeAttributeString("w","leftFromText",this.wNamespace,i)),t.positioning.distanceRight>0&&(r=Math.round(t.positioning.distanceRight*this.twipsInOnePoint).toString(),n.writeAttributeString("w","rightFromText",this.wNamespace,r)),t.positioning.distanceTop>0&&(u=Math.round(t.positioning.distanceTop*this.twipsInOnePoint).toString(),n.writeAttributeString("w","topFromText",this.wNamespace,u)),t.positioning.distanceBottom>0&&(f=Math.round(t.positioning.distanceBottom*this.twipsInOnePoint).toString(),n.writeAttributeString("w","bottomFromText",this.wNamespace,f)),t.positioning.verticalOrigin&&(e="Paragraph"===t.positioning.verticalOrigin?"text":t.positioning.verticalOrigin.toLowerCase(),n.writeAttributeString("w","vertAnchor",this.wNamespace,e)),(t.positioning.horizontalOrigin&&"Column"!==t.positioning.horizontalOrigin&&n.writeAttributeString("w","horzAnchor",this.wNamespace,t.positioning.horizontalOrigin.toLowerCase()),t.positioning.horizontalAlignment&&"Left"!==t.positioning.horizontalAlignment)&&(o=t.positioning.horizontalAlignment.toLowerCase(),n.writeAttributeString("w","tblpXSpec",this.wNamespace,o)),t.positioning.verticalAlignment&&(s=t.positioning.verticalAlignment.toLowerCase(),n.writeAttributeString("w","tblpYSpec",this.wNamespace,s)),(!sf.base.isNullOrUndefined(t.positioning.horizontalAlignment)&&"Left"===t.positioning.horizontalAlignment||!t.positioning.horizontalAlignment)&&t.positioning.horizontalPosition>0&&(h=Math.round(t.positioning.horizontalPosition*this.twipsInOnePoint).toString(),n.writeAttributeString("w","tblpX",this.wNamespace,h)),!t.positioning.verticalAlignment&&t.positioning.verticalPosition>0&&(c=Math.round(t.positioning.verticalPosition*this.twipsInOnePoint).toString(),n.writeAttributeString("w","tblpY",this.wNamespace,c)),n.writeEndElement(),t.positioning.allowOverlap||(n.writeStartElement("w","tblOverlap",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,"never"),n.writeEndElement()))},n.prototype.serializeTableMargins=function(n,t){this.serializeMargins(n,t,"tblCellMar")},n.prototype.serializeRowMargins=function(n,t){n.writeStartElement(void 0,"tblPrEx",this.wNamespace);this.serializeMargins(n,t,"tblCellMar");n.writeEndElement()},n.prototype.serializeCellMargins=function(n,t){this.serializeMargins(n,t,"tcMar")},n.prototype.serializeMargins=function(n,t,i){var r,u,f,e;(n.writeStartElement(void 0,i,this.wNamespace),sf.base.isNullOrUndefined(t.topMargin))||(r=Math.round(20*t.topMargin),n.writeStartElement(void 0,"top",this.wNamespace),n.writeAttributeString(void 0,"w",this.wNamespace,r.toString()),n.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),n.writeEndElement());sf.base.isNullOrUndefined(t.leftMargin)||(u=Math.round(20*t.leftMargin),n.writeStartElement(void 0,"left",this.wNamespace),n.writeAttributeString(void 0,"w",this.wNamespace,u.toString()),n.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),n.writeEndElement());sf.base.isNullOrUndefined(t.bottomMargin)||(f=Math.round(20*t.bottomMargin),n.writeStartElement(void 0,"bottom",this.wNamespace),n.writeAttributeString(void 0,"w",this.wNamespace,f.toString()),n.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),n.writeEndElement());sf.base.isNullOrUndefined(t.rightMargin)||(e=Math.round(20*t.rightMargin),n.writeStartElement(void 0,"right",this.wNamespace),n.writeAttributeString(void 0,"w",this.wNamespace,e.toString()),n.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),n.writeEndElement());n.writeEndElement()},n.prototype.serializeShading=function(n,t){n.writeStartElement(void 0,"shd",this.wNamespace);t.backgroundColor&&"empty"!==t.backgroundColor?n.writeAttributeString(void 0,"fill",this.wNamespace,this.getColor(t.backgroundColor)):n.writeAttributeString(void 0,"fill",this.wNamespace,"auto");"empty"===t.foregroundColor||sf.base.isNullOrUndefined(t.foregroundColor)?n.writeAttributeString(void 0,"color",this.wNamespace,"auto"):n.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t.foregroundColor));sf.base.isNullOrUndefined(t.textureStyle)||n.writeAttributeString("w","val",this.wNamespace,this.getTextureStyle(t.textureStyle));n.writeEndElement()},n.prototype.getTextureStyle=function(n){switch(n){case"Texture5Percent":case"Texture2Pt5Percent":case"Texture7Pt5Percent":return"pct5";case"Texture10Percent":return"pct10";case"Texture12Pt5Percent":return"pct12";case"Texture15Percent":case"Texture17Pt5Percent":return"pct15";case"Texture20Percent":case"Texture22Pt5Percent":return"pct20";case"Texture25Percent":case"Texture27Pt5Percent":return"pct25";case"Texture30Percent":case"Texture32Pt5Percent":return"pct30";case"Texture35Percent":return"pct35";case"Texture37Pt5Percent":return"pct37";case"Texture40Percent":case"Texture42Pt5Percent":return"pct40";case"Texture45Percent":case"Texture47Pt5Percent":return"pct45";case"Texture50Percent":case"Texture52Pt5Percent":return"pct50";case"Texture55Percent":case"Texture57Pt5Percent":return"pct55";case"Texture60Percent":return"pct60";case"Texture62Pt5Percent":return"pct62";case"Texture65Percent":case"Texture67Pt5Percent":return"pct65";case"Texture70Percent":case"Texture72Pt5Percent":return"pct70";case"Texture75Percent":case"Texture77Pt5Percent":return"pct75";case"Texture80Percent":case"Texture82Pt5Percent":return"pct80";case"Texture85Percent":return"pct85";case"Texture87Pt5Percent":return"pct87";case"Texture90Percent":case"Texture92Pt5Percent":return"pct90";case"Texture95Percent":case"Texture97Pt5Percent":return"pct95";case"TextureCross":return"thinHorzCross";case"TextureDarkCross":return"horzCross";case"TextureDarkDiagonalCross":return"diagCross";case"TextureDarkDiagonalDown":return"reverseDiagStripe";case"TextureDarkDiagonalUp":return"diagStripe";case"TextureDarkHorizontal":return"horzStripe";case"TextureDarkVertical":return"vertStripe";case"TextureDiagonalCross":return"thinDiagCross";case"TextureDiagonalDown":return"thinReverseDiagStripe";case"TextureDiagonalUp":return"thinDiagStripe";case"TextureHorizontal":return"thinHorzStripe";case"TextureSolid":return"solid";case"TextureVertical":return"thinVertStripe";default:return"clear"}},n.prototype.serializeTableBorders=function(n,t){t.borders;n.writeStartElement(void 0,"tblBorders",this.wNamespace);this.serializeBorders(n,t.borders,8);n.writeEndElement()},n.prototype.serializeBorders=function(n,t,i){this.serializeBorder(n,t.top,"top",i);this.serializeBorder(n,t.left,"left",i);this.serializeBorder(n,t.bottom,"bottom",i);this.serializeBorder(n,t.right,"right",i);this.serializeBorder(n,t.horizontal,"insideH",i);this.serializeBorder(n,t.vertical,"insideV",i);this.serializeBorder(n,t.diagonalDown,"tl2br",i);this.serializeBorder(n,t.diagonalUp,"tr2bl",i)},n.prototype.serializeTblLayout=function(n,t){t.allowAutoFit||(n.writeStartElement(void 0,"tblLayout",this.wNamespace),n.writeAttributeString(void 0,"type",this.wNamespace,"fixed"),n.writeEndElement())},n.prototype.serializeBorder=function(n,t,i,r){var u=t.lineStyle,f=(t.lineWidth?t.lineWidth:0)*r,e=t.space?t.space:0;if("Cleared"===u)return n.writeStartElement(void 0,i,this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,"nil"),void n.writeEndElement();("None"===u||sf.base.isNullOrUndefined(u))&&!t.hasNoneStyle||f<=0||(n.writeStartElement(void 0,i,this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,this.getBorderStyle(u)),t.color&&n.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t.color)),n.writeAttributeString(void 0,"sz",this.wNamespace,this.roundToTwoDecimal(f).toString()),n.writeAttributeString(void 0,"space",this.wNamespace,e.toString()),t.shadow&&n.writeAttributeString(void 0,"shadow",this.wNamespace,"on"),n.writeEndElement())},n.prototype.getBorderStyle=function(n){switch(n){case"Cleared":return"cleared";case"DashSmallGap":return"dashSmallGap";case"Triple":return"triple";case"Dot":return"dotted";case"DashDot":return"dotDash";case"DashLargeGap":return"dashed";case"DashDotDot":return"dotDotDash";case"Double":return"double";case"ThinThickSmallGap":return"thinThickSmallGap";case"ThickThinSmallGap":return"thickThinSmallGap";case"ThinThickThinSmallGap":return"thinThickThinSmallGap";case"ThickThinMediumGap":return"thickThinMediumGap";case"ThinThickMediumGap":return"thinThickMediumGap";case"ThinThickThinMediumGap":return"thinThickThinMediumGap";case"ThickThinLargeGap":return"thickThinLargeGap";case"ThinThickLargeGap":return"thinThickLargeGap";case"ThinThickThinLargeGap":return"thinThickThinLargeGap";case"Thick":return"thick";case"SingleWavy":return"wave";case"DoubleWavy":return"doubleWave";case"DashDotStroked":return"dashDotStroked";case"Engrave3D":return"threeDEngrave";case"Emboss3D":return"threeDEmboss";case"Outset":return"outset";case"Inset":return"inset";default:return"single"}},n.prototype.serializeTableIndentation=function(n,t){if(!sf.base.isNullOrUndefined(t.leftIndent)){n.writeStartElement(void 0,"tblInd",this.wNamespace);var i=Math.round(t.leftIndent*this.twipsInOnePoint);n.writeAttributeString(void 0,"w",this.wNamespace,i.toString());n.writeAttributeString(void 0,"type",this.wNamespace,"dxa");n.writeEndElement()}},n.prototype.serializeCellSpacing=function(n,t){!sf.base.isNullOrUndefined(t.cellSpacing)&&t.cellSpacing>0&&(n.writeStartElement(void 0,"tblCellSpacing",this.wNamespace),n.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t.cellSpacing/2*this.twentiethOfPoint).toString()),n.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),n.writeEndElement())},n.prototype.serializeTableWidth=function(n,t){if(n.writeStartElement(void 0,"tblW",this.wNamespace),"Percent"===t.tableFormat.preferredWidthType)n.writeAttributeString(void 0,"w",this.wNamespace,(t.tableFormat.preferredWidth*this.percentageFactor).toString()),n.writeAttributeString(void 0,"type",this.wNamespace,"pct");else if("Point"===t.tableFormat.preferredWidthType){var i=Math.round(t.tableFormat.preferredWidth*this.twipsInOnePoint);n.writeAttributeString(void 0,"w",this.wNamespace,i.toString());n.writeAttributeString(void 0,"type",this.wNamespace,"dxa")}else n.writeAttributeString(void 0,"w",this.wNamespace,"0"),n.writeAttributeString(void 0,"type",this.wNamespace,"auto");n.writeEndElement()},n.prototype.serializeTableAlignment=function(n,t){switch(n.writeStartElement(void 0,"jc",this.wNamespace),t.tableAlignment){case"Right":n.writeAttributeString("w","val",this.wNamespace,"right");break;case"Center":n.writeAttributeString("w","val",this.wNamespace,"center");break;default:n.writeAttributeString("w","val",this.wNamespace,"left")}n.writeEndElement()},n.prototype.serializeFieldCharacter=function(n,t){var u,i,r;if(n.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(n,t.characterFormat),n.writeStartElement(void 0,"fldChar",this.wNamespace),u=0===t.fieldType?"begin":1===t.fieldType?"end":"separate",n.writeAttributeString(void 0,"fldCharType",this.wNamespace,u),"begin"===u&&!sf.base.isNullOrUndefined(t.formFieldData)){if(i=t.formFieldData,n.writeStartElement(void 0,"ffData",this.wNamespace),n.writeStartElement(void 0,"name",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,i.name),n.writeEndElement(),n.writeStartElement(void 0,"enabled",this.wNamespace),n.writeEndElement(),i.hasOwnProperty("textInput"))n.writeStartElement(void 0,"textInput",this.wNamespace),i.textInput.type,n.writeStartElement(void 0,"type",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,i.textInput.type.toString().toLowerCase()),n.writeEndElement(),n.writeStartElement(void 0,"default",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,i.textInput.defaultValue),n.writeEndElement(),n.writeStartElement(void 0,"format",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,i.textInput.format),n.writeEndElement(),n.writeEndElement();else if(i.hasOwnProperty("checkBox"))n.writeStartElement(void 0,"checkBox",this.wNamespace),"Auto"===i.checkBox.sizeType?(n.writeStartElement(void 0,"sizeAuto",this.wNamespace),n.writeEndElement()):(n.writeStartElement(void 0,"size",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,this.roundToTwoDecimal(2*i.checkBox.size).toString()),n.writeEndElement()),n.writeStartElement(void 0,"defalut",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,i.checkBox.defaultValue?"1":"0"),n.writeEndElement(),i.checkBox.checked&&(n.writeStartElement(void 0,"checked",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,i.checkBox.checked?"1":"0"),n.writeEndElement()),n.writeEndElement();else{for(n.writeStartElement(void 0,"ddList",this.wNamespace),0!==i.dropDownList.selectedIndex&&(n.writeStartElement(void 0,"result",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,i.dropDownList.selectedIndex.toString()),n.writeEndElement()),r=0;r<i.dropDownList.dropDownItems.length;r++)n.writeStartElement(void 0,"listEntry",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,i.dropDownList.dropDownItems[r].toString()),n.writeEndElement();n.writeEndElement()}n.writeEndElement()}n.writeEndElement();n.writeEndElement();0===t.fieldType&&"FieldFormTextInput"===t.fieldCodeType&&(n.writeStartElement("w","r",this.wNamespace),n.writeStartElement(void 0,"instrText",this.wNamespace),n.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),n.writeString("FORMTEXT"),n.writeEndElement(),n.writeEndElement())},n.prototype.serializeTextRange=function(n,t,i,r){if(n.writeStartElement("w","r",this.wNamespace),sf.base.isNullOrUndefined(t.characterFormat)||this.serializeCharacterFormat(n,t.characterFormat),"\t"===t.text)n.writeElementString(void 0,"tab",this.wNamespace,void 0);else if("\v"===t.text)n.writeElementString(void 0,"br",this.wNamespace,void 0);else if("\f"===t.text)n.writeStartElement(void 0,"br",this.wNamespace),n.writeAttributeString("w","type",this.wNamespace,"page"),n.writeEndElement();else if("%02"===encodeURI(t.text))n.writeStartElement(void 0,"footnoteRef",this.wNamespace),n.writeEndElement();else if("%02"===encodeURI(t.text)&&"endnote"===r)n.writeStartElement(void 0,"endnoteRef",this.wNamespace),n.writeEndElement();else if("%03"===encodeURI(t.text))n.writeStartElement(void 0,"separator",this.wNamespace),n.writeEndElement();else if("%04"===encodeURI(t.text))n.writeStartElement(void 0,"continuationSeparator",this.wNamespace),n.writeEndElement();else{var u=this.retrieveDeleteRevision(t),f=!sf.base.isNullOrUndefined(i)&&i.hasOwnProperty("fieldType")&&2!==i.fieldType?u?"delInstrText":"instrText":u?"delText":"t";n.writeStartElement(void 0,f,this.wNamespace);n.writeAttributeString("xml","space",this.xmlNamespace,"preserve");n.writeString(t.text);n.writeEndElement()}n.writeEndElement()},n.prototype.retrieveDeleteRevision=function(n){if(n.hasOwnProperty("revisionIds")&&n.revisionIds.length>0)for(var t=0;t<n.revisionIds.length;t++)if("Deletion"===this.retrieveRevision(n.revisionIds[t]).revisionType)return!0;return!1},n.prototype.serializeParagraphFormat=function(n,t,i){sf.base.isNullOrUndefined(t)||(sf.base.isNullOrUndefined(t.styleName)||(n.writeStartElement(void 0,"pStyle",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,t.styleName),n.writeEndElement()),sf.base.isNullOrUndefined(i)?this.serializeListFormat(n,t.listFormat):this.serializeListFormat(n,i.paragraphFormat.listFormat),t.bidi&&(n.writeStartElement(void 0,"bidi",this.wNamespace),n.writeEndElement()),!sf.base.isNullOrUndefined(t.keepWithNext)&&t.keepWithNext&&(n.writeStartElement(void 0,"keepNext",this.wNamespace),n.writeEndElement()),!sf.base.isNullOrUndefined(t.keepLinesTogether)&&t.keepLinesTogether&&(n.writeStartElement(void 0,"keepLines",this.wNamespace),n.writeEndElement()),sf.base.isNullOrUndefined(t.outlineLevel)||(n.writeStartElement(void 0,"outlineLvl",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,this.getOutlineLevelValue(t.outlineLevel).toString()),n.writeEndElement()),this.serializeParagraphSpacing(n,t),sf.base.isNullOrUndefined(t.contextualSpacing)||(n.writeStartElement("w","contextualSpacing",this.wNamespace),t.contextualSpacing||n.writeAttributeString("w","val",this.wNamespace,"0"),n.writeEndElement()),sf.base.isNullOrUndefined(t.widowControl)||(n.writeStartElement("w","widowControl",this.wNamespace),t.widowControl?n.writeAttributeString("w","val",this.wNamespace,"1"):n.writeAttributeString("w","val",this.wNamespace,"0"),n.writeEndElement()),this.serializeIndentation(n,t),this.serializeParagraphAlignment(n,t.textAlignment,t.bidi),!sf.base.isNullOrUndefined(t.tabs)&&t.tabs.length>0&&this.serializeTabs(n,t.tabs))},n.prototype.getOutlineLevelValue=function(n){if(-1!==n.indexOf("Level")){var t=parseInt(n.substring(5),10);if(t>0)return t-1}return 9},n.prototype.serializeTabs=function(n,t){n.writeStartElement("w","tabs",this.wNamespace);for(var i=0;i<t.length;i++)this.serializeTab(n,t[i]);n.writeEndElement()},n.prototype.serializeTab=function(n,t){var i=0;n.writeStartElement("w","tab",this.wNamespace);0===t.position&&0!==t.deletePosition?(i=t.deletePosition*this.twentiethOfPoint,n.writeAttributeString("w","val",this.wNamespace,"clear")):(i=t.position*this.twentiethOfPoint,n.writeAttributeString("w","val",this.wNamespace,this.getTabJustification(t.tabJustification)));sf.base.isNullOrUndefined(t.tabLeader)||"None"===t.tabLeader||n.writeAttributeString("w","leader",this.wNamespace,this.getTabLeader(t.tabLeader));isNaN(i)||n.writeAttributeString("w","pos",this.wNamespace,i.toString()+"");n.writeEndElement()},n.prototype.getTabLeader=function(n){switch(n){case"Dot":return"dot";case"Hyphen":return"hyphen";case"Underscore":return"underscore";default:return"none"}},n.prototype.getTabJustification=function(n){switch(n){case"Bar":return"bar";case"Center":return"center";case"Decimal":return"decimal";case"Left":return"left";case"List":return"num";case"Right":return"right";default:return"clear"}},n.prototype.serializeListFormat=function(n,t){if(!sf.base.isNullOrUndefined(t.listId)||!sf.base.isNullOrUndefined(t.listLevelNumber)){if(n.writeStartElement(void 0,"numPr",this.wNamespace),sf.base.isNullOrUndefined(t.listLevelNumber)||-1===t.listLevelNumber||(n.writeStartElement(void 0,"ilvl",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,t.listLevelNumber.toString()),n.writeEndElement()),!sf.base.isNullOrUndefined(t.listId)){n.writeStartElement(void 0,"numId",this.wNamespace);var i=(t.listId+1).toString();-1===t.listId&&(i="");n.writeAttributeString("w","val",this.wNamespace,i);n.writeEndElement()}n.writeEndElement()}},n.prototype.serializeParagraphAlignment=function(n,t,i){if(i&&("Right"===t?t="Left":"Left"===t&&(t="Right")),!sf.base.isNullOrUndefined(t)){n.writeStartElement(void 0,"jc",this.wNamespace);var r=void 0;switch(t){case"Center":r="center";break;case"Right":r="right";break;case"Justify":r="both";break;default:r="left"}n.writeAttributeString("w","val",this.wNamespace,r);n.writeEndElement()}},n.prototype.serializeParagraphSpacing=function(n,t){var r,i;(n.writeStartElement(void 0,"spacing",this.wNamespace),sf.base.isNullOrUndefined(t.beforeSpacing)||n.writeAttributeString(void 0,"before",this.wNamespace,this.roundToTwoDecimal(t.beforeSpacing*this.twentiethOfPoint).toString()),sf.base.isNullOrUndefined(t.afterSpacing)||n.writeAttributeString(void 0,"after",this.wNamespace,this.roundToTwoDecimal(t.afterSpacing*this.twentiethOfPoint).toString()),sf.base.isNullOrUndefined(t.lineSpacing))||(r="AtLeast"===t.lineSpacingType||"Exactly"===t.lineSpacingType?this.roundToTwoDecimal(t.lineSpacing*this.twentiethOfPoint):this.roundToTwoDecimal(240*t.lineSpacing),n.writeAttributeString(void 0,"line",this.wNamespace,r.toString()));sf.base.isNullOrUndefined(t.lineSpacingType)||(i="auto","AtLeast"===t.lineSpacingType?i="atLeast":"Exactly"===t.lineSpacingType&&(i="exact"),n.writeAttributeString(void 0,"lineRule",this.wNamespace,i));n.writeEndElement()},n.prototype.serializeIndentation=function(n,t){n.writeStartElement(void 0,"ind",this.wNamespace);sf.base.isNullOrUndefined(t.leftIndent)||n.writeAttributeString(void 0,"left",this.wNamespace,this.roundToTwoDecimal(t.leftIndent*this.twipsInOnePoint).toString());sf.base.isNullOrUndefined(t.rightIndent)||n.writeAttributeString(void 0,"right",this.wNamespace,this.roundToTwoDecimal(t.rightIndent*this.twipsInOnePoint).toString());sf.base.isNullOrUndefined(t.firstLineIndent)||(t.firstLineIndent<0?n.writeAttributeString(void 0,"hanging",this.wNamespace,this.roundToTwoDecimal(-1*t.firstLineIndent*this.twipsInOnePoint).toString()):n.writeAttributeString(void 0,"firstLine",this.wNamespace,this.roundToTwoDecimal(t.firstLineIndent*this.twipsInOnePoint).toString()));n.writeEndElement()},n.prototype.serializeCustomXMLMapping=function(n,t){var u,i,r,o;if(n.length>0)for(u=n.keys,i=0;i<u.length;i++){r=new sf.fileutils.XmlWriter;r.writeStartElement(void 0,"Relationships",this.rpNamespace);var s=this.mCustomXML.get(u[i]),h=u[i],e=this.getNextRelationShipID(),f=i+1,c=this.createXMLItem(s,e,f),l=this.createXMLItemProps(h,f);this.serializeRelationShip(t,e,this.customXmlRelType,"../"+c);this.customXMLRelation(r,f,l);r.writeEndElement();o=new sf.compression.ZipArchiveItem(r.buffer,this.customXMLRelPath+f+".xml.rels");this.mArchive.addItem(o)}},n.prototype.customXMLRelation=function(n,t,i){this.serializeRelationShip(n,"rId1",this.wordMLCustomXmlPropsRelType,i)},n.prototype.createXMLItem=function(n,t,i){var u=new Blob([n],{type:"text/plain"}),r=this.customXMLItemsPath+i+".xml",f=new sf.compression.ZipArchiveItem(u,r);return this.mArchive.addItem(f),r},n.prototype.createXMLItemProps=function(n,t){var i=new sf.fileutils.XmlWriter,r=this.customXMLItemsPropspath+t+".xml",f=this.itemPropsPath+t+".xml",u;return i.writeStartElement("ds","datastoreItem",this.wNamespace),i.writeAttributeString("ds","itemID",void 0,n),i.writeAttributeString("xmlns","ds",void 0,this.dsNamespace),i.writeEndElement(),this.customXMLProps.push(r),u=new sf.compression.ZipArchiveItem(i.buffer,r),this.mArchive.addItem(u),f},n.prototype.serializeStyles=function(){var n=new sf.fileutils.XmlWriter,t;n.writeStartElement("w","styles",this.wNamespace);n.writeAttributeString("xmlns","mc",void 0,this.veNamespace);n.writeAttributeString("xmlns","r",void 0,this.rNamespace);n.writeAttributeString("xmlns","w",void 0,this.wNamespace);n.writeAttributeString("xmlns","w14",void 0,this.w14Namespace);n.writeAttributeString("xmlns","w15",void 0,this.w15Namespace);n.writeAttributeString("mc","Ignorable",void 0,"w14 w15");this.serializeDefaultStyles(n);this.serializeDocumentStyles(n);n.writeEndElement();t=new sf.compression.ZipArchiveItem(n.buffer,this.stylePath);this.mArchive.addItem(t)},n.prototype.serializeDefaultStyles=function(n){n.writeStartElement(void 0,"docDefaults",this.wNamespace);n.writeStartElement(void 0,"rPrDefault",this.wNamespace);this.serializeCharacterFormat(n,this.defCharacterFormat);n.writeEndElement();n.writeStartElement(void 0,"pPrDefault",this.wNamespace);sf.base.isNullOrUndefined(this.defParagraphFormat)||(n.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(n,this.defParagraphFormat,void 0),n.writeEndElement());n.writeEndElement();n.writeEndElement()},n.prototype.serializeDocumentStyles=function(n){for(var t,r,i=0;i<this.mStyles.length;i++)t=this.mStyles[i],n.writeStartElement(void 0,"style",this.wNamespace),r="Paragraph"===t.type?"paragraph":"character",n.writeAttributeString("w","type",this.wNamespace,r),n.writeAttributeString("w","styleId",this.wNamespace,t.name),n.writeStartElement(void 0,"name",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,t.name),n.writeEndElement(),sf.base.isNullOrUndefined(t.basedOn)||(n.writeStartElement(void 0,"basedOn",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,t.basedOn),n.writeEndElement()),sf.base.isNullOrUndefined(t.next)||(n.writeStartElement(void 0,"next",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,t.next),n.writeEndElement()),sf.base.isNullOrUndefined(t.link)||(n.writeStartElement(void 0,"link",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,t.link),n.writeEndElement()),"Paragraph"===t.type&&(n.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(n,t.paragraphFormat,void 0),n.writeEndElement()),this.serializeCharacterFormat(n,t.characterFormat),n.writeEndElement()},n.prototype.serializeCharacterFormat=function(n,t){if(n.writeStartElement(void 0,"rPr",this.wNamespace),sf.base.isNullOrUndefined(t.styleName)||(n.writeStartElement(void 0,"rStyle",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,t.styleName),n.writeEndElement()),sf.base.isNullOrUndefined(t.fontFamily)||(n.writeStartElement(void 0,"rFonts",this.wNamespace),n.writeAttributeString(void 0,"ascii",this.wNamespace,t.fontFamily),n.writeAttributeString(void 0,"hAnsi",this.wNamespace,t.fontFamily),n.writeAttributeString(void 0,"eastAsia",this.wNamespace,t.fontFamily),n.writeAttributeString(void 0,"cs",this.wNamespace,t.fontFamilyBidi),n.writeEndElement()),sf.base.isNullOrUndefined(t.bold)||this.serializeBoolProperty(n,"b",t.bold),t.boldBidi&&this.serializeBoolProperty(n,"bCs",t.boldBidi),sf.base.isNullOrUndefined(t.italic)||this.serializeBoolProperty(n,"i",t.italic),sf.base.isNullOrUndefined(t.italicBidi)||this.serializeBoolProperty(n,"iCs",t.italicBidi),t.bidi&&(n.writeStartElement(void 0,"rtl",this.wNamespace),n.writeEndElement()),t.allCaps&&this.serializeBoolProperty(n,"caps",t.allCaps),!sf.base.isNullOrUndefined(t.strikethrough))switch(t.strikethrough){case"SingleStrike":this.serializeBoolProperty(n,"strike",!0);break;case"DoubleStrike":this.serializeBoolProperty(n,"dstrike",!0);break;default:this.serializeBoolProperty(n,"strike",!1);this.serializeBoolProperty(n,"dstrike",!1)}if(sf.base.isNullOrUndefined(t.fontColor)||(n.writeStartElement(void 0,"color",this.wNamespace),"empty"===t.fontColor||"#00000000"===t.fontColor?n.writeAttributeString("w","val",this.wNamespace,"auto"):n.writeAttributeString("w","val",this.wNamespace,this.getColor(t.fontColor)),n.writeEndElement()),sf.base.isNullOrUndefined(t.fontSize)||(n.writeStartElement(void 0,"sz",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*t.fontSize).toString()),n.writeEndElement()),sf.base.isNullOrUndefined(t.fontSizeBidi)||(n.writeStartElement(void 0,"szCs",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*t.fontSizeBidi).toString()),n.writeEndElement()),sf.base.isNullOrUndefined(t.highlightColor)||"NoColor"===t.highlightColor||(n.writeStartElement(void 0,"highlight",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,this.getHighlightColor(t.highlightColor)),n.writeEndElement()),!sf.base.isNullOrUndefined(t.revisionIds)&&t.revisionIds.length>0&&(this.serializeRevisionStart(n,t,void 0),this.serializeRevisionEnd(n,t,void 0)),sf.base.isNullOrUndefined(t.underline)||"None"===t.underline||(n.writeStartElement(void 0,"u",this.wNamespace),n.writeAttributeString("w","val",this.wNamespace,this.getUnderlineStyle(t.underline)),n.writeEndElement()),!sf.base.isNullOrUndefined(t.baselineAlignment)){switch(n.writeStartElement(void 0,"vertAlign",this.wNamespace),t.baselineAlignment){case"Subscript":n.writeAttributeString("w","val",this.wNamespace,"subscript");break;case"Superscript":n.writeAttributeString("w","val",this.wNamespace,"superscript");break;default:n.writeAttributeString("w","val",this.wNamespace,"baseline")}n.writeEndElement()}n.writeEndElement()},n.prototype.getColor=function(n){return n.length>0&&("#"===n[0]&&(n=n.substr(1)),n.length>6&&(n=n.substr(0,6))),n},n.prototype.getUnderlineStyle=function(n){switch(n){case"DotDotDashHeavy":return"dashDotDotHeavy";case"DotDashHeavy":return"dashDotHeavy";case"DashHeavy":return"dashedHeavy";case"DashLong":return"dashLong";case"DashLongHeavy":return"dashLongHeavy";case"DotDash":return"dotDash";case"DotDotDash":return"dotDotDash";case"Dotted":return"dotted";case"DottedHeavy":return"dottedHeavy";case"Double":return"double";case"Single":return"single";case"Thick":return"thick";case"Wavy":return"wave";case"WavyDouble":return"wavyDouble";case"WavyHeavy":return"wavyHeavy";case"Words":return"words";default:return"dash"}},n.prototype.getHighlightColor=function(n){switch(n){case"BrightGreen":return"green";case"Turquoise":return"cyan";case"Pink":return"magenta";case"Blue":return"blue";case"Red":return"red";case"DarkBlue":return"darkBlue";case"Teal":return"darkCyan";case"Green":return"darkGreen";case"Violet":return"darkMagenta";case"DarkRed":return"darkRed";case"DarkYellow":return"darkYellow";case"Gray50":return"darkGray";case"Gray25":return"lightGray";case"Black":return"black";default:return"yellow"}},n.prototype.serializeBoolProperty=function(n,t,i){n.writeStartElement(void 0,t,this.wNamespace);i||n.writeAttributeString(void 0,"val",this.wNamespace,"0");n.writeEndElement()},n.prototype.serializeNumberings=function(){var n,t;0!==this.document.lists.length&&(n=new sf.fileutils.XmlWriter,n.writeStartElement("w","numbering",this.wNamespace),this.writeCommonAttributeStrings(n),this.serializeAbstractListStyles(n,this.document.abstractLists),this.serializeListInstances(n,this.document.lists),n.writeEndElement(),t=new sf.compression.ZipArchiveItem(n.buffer,this.numberingPath),this.mArchive.addItem(t))},n.prototype.serializeAbstractListStyles=function(n,t){for(var u,i,f,r=0;r<t.length;r++){for(u=t[r],n.writeStartElement(void 0,"abstractNum",this.wNamespace),n.writeAttributeString(void 0,"abstractNumId",this.wNamespace,u.abstractListId.toString()),n.writeStartElement(void 0,"nsid",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,this.generateHex()),n.writeEndElement(),i=0,f=u.levels.length;i<f;i++)this.serializeListLevel(n,u.levels[i],i);n.writeEndElement()}},n.prototype.serializeListInstances=function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n.writeStartElement(void 0,"num",this.wNamespace),n.writeAttributeString(void 0,"numId",this.wNamespace,(r.listId+1).toString()),n.writeStartElement(void 0,"abstractNumId",this.wNamespace),n.writeAttributeString(void 0,"val",this.wNamespace,r.abstractListId.toString()),n.writeEndElement(),n.writeEndElement()},n.prototype.generateHex=function(){return(Math.floor(373e7*Math.random())+27e7).toString(16).toUpperCase()},n.prototype.roundToTwoDecimal=function(n){return Math.round(n)},n.prototype.serializeListLevel=function(n,t,i){n.writeStartElement(void 0,"lvl",this.wNamespace);n.writeAttributeString(void 0,"ilvl",this.wNamespace,i.toString());n.writeStartElement(void 0,"start",this.wNamespace);n.writeAttributeString(void 0,"val",this.wNamespace,t.startAt.toString());n.writeEndElement();n.writeStartElement(void 0,"numFmt",this.wNamespace);n.writeAttributeString(void 0,"val",this.wNamespace,this.getLevelPattern(t.listLevelPattern));n.writeEndElement();this.serializeLevelFollow(n,t);this.serializeLevelText(n,t,i+1);n.writeStartElement(void 0,"pPr",this.wNamespace);this.serializeParagraphFormat(n,t.paragraphFormat,void 0);n.writeEndElement();this.serializeCharacterFormat(n,t.characterFormat);n.writeEndElement()},n.prototype.getLevelPattern=function(n){var t;switch(n){case"Arabic":t="decimal";break;case"UpRoman":t="upperRoman";break;case"LowRoman":t="lowerRoman";break;case"UpLetter":t="upperLetter";break;case"LowLetter":t="lowerLetter";break;default:t="bullet"}return t},n.prototype.serializeLevelText=function(n,t){n.writeStartElement(void 0,"lvlText",this.wNamespace);n.writeAttributeString(void 0,"val",this.wNamespace,t.numberFormat);n.writeEndElement()},n.prototype.serializeLevelFollow=function(n,t){var i;i="Tab"===t.followCharacter?"tab":"Space"===t.followCharacter?"space":"nothing";n.writeStartElement(void 0,"suff",this.wNamespace);n.writeAttributeString(void 0,"val",this.wNamespace,i);n.writeEndElement()},n.prototype.serializeDocumentProtectionSettings=function(n){if(n.writeStartElement("w","documentProtection",this.wNamespace),this.formatting&&n.writeAttributeString("w","formatting",this.wNamespace,"1"),this.protectionType&&"NoProtection"!==this.protectionType){var t="ReadOnly"===this.protectionType?"readOnly":"forms";n.writeAttributeString("w","edit",this.wNamespace,t)}n.writeAttributeString("w","cryptProviderType",this.wNamespace,"rsaAES");n.writeAttributeString("w","cryptAlgorithmClass",this.wNamespace,"hash");n.writeAttributeString("w","cryptAlgorithmType",this.wNamespace,"typeAny");n.writeAttributeString("w","cryptAlgorithmSid",this.wNamespace,"14");n.writeAttributeString("w","cryptSpinCount",this.wNamespace,"100000");this.enforcement&&n.writeAttributeString("w","enforcement",this.wNamespace,"1");this.hashValue&&n.writeAttributeString("w","hash",this.wNamespace,this.hashValue);this.saltValue&&n.writeAttributeString("w","salt",this.wNamespace,this.saltValue);n.writeEndElement()},n.prototype.serializeSettings=function(){var n=new sf.fileutils.XmlWriter,i,r,u;n.writeStartElement("w","settings",this.wNamespace);this.writeCustom(n);n.writeAttributeString("xmlns","w10",void 0,this.w10Namespace);n.writeAttributeString("xmlns","w14",void 0,this.w14Namespace);n.writeAttributeString("xmlns","w15",void 0,this.w15Namespace);n.writeAttributeString("xmlns","sl",void 0,this.slNamespace);n.writeAttributeString("mc","Ignorable",void 0,"w14 w15");this.serializeDocumentProtectionSettings(n);n.writeStartElement("w","zoom",this.wNamespace);n.writeAttributeString("w","val",this.wNamespace,"none");n.writeAttributeString("w","percent",this.wNamespace,"100");n.writeEndElement();n.writeStartElement(void 0,"displayBackgroundShape",this.wNamespace);n.writeEndElement();n.writeStartElement(void 0,"defaultTabStop",this.wNamespace);i=Math.round(this.defaultTabWidthValue*this.twipsInOnePoint);n.writeAttributeString(void 0,"val",this.wNamespace,i.toString());n.writeEndElement();this.trackChanges&&(n.writeStartElement(void 0,"trackRevisions",this.wNamespace),n.writeEndElement());this.mDifferentFirstPage&&(n.writeStartElement(void 0,"evenAndOddHeaders",this.wNamespace),n.writeEndElement());this.formFieldShading||(n.writeStartElement(void 0,"doNotShadeFormData",this.wNamespace),n.writeEndElement());n.writeStartElement(void 0,"compat",this.wNamespace);this.dontUseHtmlParagraphAutoSpacing&&this.serializeBoolProperty(n,"doNotUseHTMLParagraphAutoSpacing",this.dontUseHtmlParagraphAutoSpacing);n.writeStartElement(void 0,"compatSetting",this.wNamespace);n.writeAttributeString(void 0,"name",this.wNamespace,"compatibilityMode");n.writeAttributeString(void 0,"uri",this.wNamespace,"http://schemas.microsoft.com/office/word");r=t.getCompatibilityModeValue(this.compatibilityMode);n.writeAttributeString(void 0,"val",this.wNamespace,r);n.writeEndElement();n.writeEndElement();this.document.footnotes&&(n.writeStartElement(void 0,"footnotePr",this.wNamespace),n.writeStartElement(void 0,"footnote",this.wNamespace),n.writeAttributeString(void 0,"id",this.wNamespace,"-1"),n.writeEndElement(),n.writeStartElement(void 0,"footnote",this.wNamespace),n.writeAttributeString(void 0,"id",this.wNamespace,"0"),n.writeEndElement(),n.writeEndElement());this.document.endnotes&&(n.writeStartElement(void 0,"endnotePr",this.wNamespace),n.writeStartElement(void 0,"endnote",this.wNamespace),n.writeAttributeString(void 0,"id",this.wNamespace,"-1"),n.writeEndElement(),n.writeStartElement(void 0,"endnote",this.wNamespace),n.writeAttributeString(void 0,"id",this.wNamespace,"0"),n.writeEndElement(),n.writeEndElement());n.writeEndElement();u=new sf.compression.ZipArchiveItem(n.buffer,this.settingsPath);this.mArchive.addItem(u)},n.prototype.serializeCoreProperties=function(){},n.prototype.serializeAppProperties=function(){},n.prototype.serializeFontTable=function(){},n.prototype.serializeSettingsRelation=function(){},n.prototype.serializeHeaderFooters=function(){this.serializeHeaderFooter("EvenFooter");this.serializeHeaderFooter("EvenHeader");this.serializeHeaderFooter("FirstPageFooter");this.serializeHeaderFooter("FirstPageHeader");this.serializeHeaderFooter("OddFooter");this.serializeHeaderFooter("OddHeader")},n.prototype.serializeHeaderFooter=function(n){var i,r,t;if(0!==this.headersFooters.length&&this.headersFooters.containsKey(n))for(var u=this.headersFooters.get(n),f=void 0,e=0;e<u.keys.length;e++)t=u.keys[e],f=u.get(t),"EvenHeader"===n||"FirstPageHeader"===n||"OddHeader"===n?(i=this.headerPath+t.replace("rId","")+".xml",r=this.headerRelationPath+t.replace("rId","")+".xml.rels",this.serializeHeader(f,t,i,r)):(i=this.footerPath+t.replace("rId","")+".xml",r=this.footerRelationPath+t.replace("rId","")+".xml.rels",this.serializeFooter(f,t,i,r))},n.prototype.serializeHeader=function(n,t,i,r){var u,f,e;this.headerFooter=n;u=new sf.fileutils.XmlWriter;u.writeStartElement("w","hdr",this.wNamespace);this.writeHFCommonAttributes(u);f=this.blockOwner;this.blockOwner=n;this.serializeBodyItems(u,n.blocks,!0);this.blockOwner=f;u.writeEndElement();e=new sf.compression.ZipArchiveItem(u.buffer,i);this.mArchive.addItem(e);this.serializeHFRelations(t,r);this.headerFooter=void 0},n.prototype.serializeHFRelations=function(n,t){var i,r;this.headerFooterImages.containsKey(n)&&(i=new sf.fileutils.XmlWriter,i.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeImagesRelations(this.headerFooterImages.get(n),i),i.writeEndElement(),r=new sf.compression.ZipArchiveItem(i.buffer,t),this.mArchive.addItem(r))},n.prototype.writeHFCommonAttributes=function(n){n.writeAttributeString("xmlns","v",void 0,this.vNamespace);n.writeAttributeString("xmlns","w10",void 0,this.w10Namespace);n.writeAttributeString("xmlns","o",void 0,this.oNamespace);n.writeAttributeString("xmlns","ve",void 0,this.veNamespace);n.writeAttributeString("xmlns","r",void 0,this.rNamespace);n.writeAttributeString("xmlns","m",void 0,this.mNamespace);n.writeAttributeString("xmlns","wne",void 0,this.wneNamespace);n.writeAttributeString("xmlns","a",void 0,this.aNamespace);n.writeAttributeString("xmlns","pic",void 0,this.pictureNamespace);n.writeAttributeString("xmlns","wp",void 0,this.wpNamespace);n.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace);n.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace);this.writeDup(n);n.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace);n.writeAttributeString("ve","Ignorable",void 0,"w14 w15 wp14")},n.prototype.serializeFooter=function(n,t,i,r){var u,f;this.headerFooter=n;u=new sf.fileutils.XmlWriter;u.writeStartElement("w","ftr",this.wNamespace);this.writeHFCommonAttributes(u);this.serializeBodyItems(u,n.blocks,!0);u.writeEndElement();f=new sf.compression.ZipArchiveItem(u.buffer,i);this.mArchive.addItem(f);this.serializeHFRelations(t,r)},n.prototype.serializeDocumentRelations=function(){var n=new sf.fileutils.XmlWriter,t;n.writeStartElement(void 0,"Relationships",this.rpNamespace);this.serializeRelationShip(n,this.getNextRelationShipID(),this.stylesRelType,"styles.xml");this.serializeRelationShip(n,this.getNextRelationShipID(),this.settingsRelType,"settings.xml");this.document.endnotes&&this.serializeRelationShip(n,this.getNextRelationShipID(),this.endnoteRelType,"endnotes.xml");this.document.footnotes&&this.serializeRelationShip(n,this.getNextRelationShipID(),this.footnoteRelType,"footnotes.xml");this.mComments.length>0&&(1===this.mComments.length&&""===this.mComments[0].text||(this.serializeRelationShip(n,this.getNextRelationShipID(),this.commentsRelType,"comments.xml"),this.serializeRelationShip(n,this.getNextRelationShipID(),this.commentsExRelType,"commentsExtended.xml")));this.document.lists.length>0&&this.serializeRelationShip(n,this.getNextRelationShipID(),this.numberingRelType,"numbering.xml");this.serializeHeaderFooterRelations(n);this.serializeImagesRelations(this.documentImages,n);this.serializeCustomXMLMapping(this.mCustomXML,n);this.serializeChartDocumentRelations(this.documentCharts,n);n.writeEndElement();t=new sf.compression.ZipArchiveItem(n.buffer,this.wordRelationPath);this.mArchive.addItem(t);this.headerFooter=void 0},n.prototype.serializeChartDocumentRelations=function(n,t){if(n.length>0)for(var r=n.keys,i=1;i<=r.length;i++)this.serializeRelationShip(t,r[i-1],this.chartRelType,"charts/chart"+i+".xml")},n.prototype.serializeChartRelations=function(){var n=new sf.fileutils.XmlWriter,t;this.resetChartRelationShipId();n.writeStartElement(void 0,"Relationships",this.rpNamespace);var i="colors"+this.chartCount+".xml",r=this.chartPath+"/_rels/chart"+this.chartCount+".xml.rels",u="../embeddings/Microsoft_Excel_Worksheet"+this.chartCount+".xlsx";this.serializeRelationShip(n,this.getNextChartRelationShipID(),this.packageRelType,u);this.serializeRelationShip(n,this.getNextChartRelationShipID(),this.chartColorStyleRelType,i);n.writeEndElement();t=new sf.compression.ZipArchiveItem(n.buffer,r);this.mArchive.addItem(t)},n.prototype.serializeImagesRelations=function(n,i){var s,h;if(n.length>0)for(var u="",e=void 0,f=n.keys,r=0;r<f.length;r++)if(e=n.get(f[r]).imageString,sf.base.isNullOrUndefined(e))u=this.imagePath+"/0.jpeg",this.serializeRelationShip(i,f[r],this.imageRelType,u.replace("word/",""));else{var o=t.formatClippedString(e),c=o.extension,l=o.formatClippedString;u=this.imagePath+f[r]+c;this.serializeRelationShip(i,f[r],this.imageRelType,u.replace("word/",""));s=new Blob([this.encodedString(l)]);h=new sf.compression.ZipArchiveItem(s,u);this.mArchive.addItem(h)}},n.prototype.encodedString=function(n){var o,s,h,c,f,l,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0,e=0,u=3*(n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4,r;if(n.charAt(n.length-1)===t.charAt(64)&&u--,n.charAt(n.length-2)===t.charAt(64)&&u--,u%1!=0)throw new Error("Invalid base64 input, bad content length.");for(r=new Uint8Array(0|u);i<n.length;)o=t.indexOf(n.charAt(i++))<<2|(c=t.indexOf(n.charAt(i++)))>>4,s=(15&c)<<4|(f=t.indexOf(n.charAt(i++)))>>2,h=(3&f)<<6|(l=t.indexOf(n.charAt(i++))),r[e++]=o,64!==f&&(r[e++]=s),64!==l&&(r[e++]=h);return r},n.prototype.serializeExternalLinkImages=function(n){for(var i=this.externalImages.keys,t=0;t<this.externalImages.keys.length;t++)this.serializeRelationShip(n,i[t],this.imageRelType,this.externalImages.get(i[t]))},n.prototype.serializeHeaderFooterRelations=function(n){this.serializeHFRelation(n,"EvenFooter");this.serializeHFRelation(n,"EvenHeader");this.serializeHFRelation(n,"FirstPageFooter");this.serializeHFRelation(n,"FirstPageHeader");this.serializeHFRelation(n,"OddFooter");this.serializeHFRelation(n,"OddHeader")},n.prototype.serializeHFRelation=function(n,t){var u,f="",e,i,r;if(this.headersFooters.containsKey(t))for(e=this.headersFooters.get(t),i=0;i<e.keys.length;i++)r=e.keys[i],"EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(f="header"+r.replace("rId","")+".xml",u=this.headerRelType):(f="footer"+r.replace("rId","")+".xml",u=this.footerRelType),this.serializeRelationShip(n,r,u,f)},n.prototype.serializeRelationShip=function(n,t,i,r){n.writeStartElement(void 0,"Relationship",void 0);n.writeAttributeString(void 0,"Id",void 0,t);n.writeAttributeString(void 0,"Type",void 0,i);n.writeAttributeString(void 0,"Target",void 0,r.replace("\\","/").replace("\v",""));(i===this.hyperlinkRelType||this.startsWith(r,"http://")||this.startsWith(r,"https://")||this.startsWith(r,"file:///"))&&n.writeAttributeString(void 0,"TargetMode",void 0,"External");n.writeEndElement()},n.prototype.getNextRelationShipID=function(){return"rId"+ ++this.mRelationShipID},n.prototype.getEFNextRelationShipID=function(){return(++this.efRelationShipId).toString()},n.prototype.serializeGeneralRelations=function(){var n=new sf.fileutils.XmlWriter,t;this.resetRelationShipID();n.writeStartElement(void 0,"Relationships",this.rpNamespace);this.serializeRelationShip(n,this.getNextRelationShipID(),this.documentRelType,this.documentPath);n.writeEndElement();t=new sf.compression.ZipArchiveItem(n.buffer,this.generalRelationPath);this.mArchive.addItem(t)},n.prototype.serializeContentTypes=function(){var n=new sf.fileutils.XmlWriter,t,i,r;if(n.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types"),this.serializeDefaultContentType(n,"rels",this.relationContentType),this.serializeDefaultContentType(n,"xml",this.xmlContentType),(this.documentImages.length>0||this.externalImages.length>0||this.headerFooterImages.length>0)&&(this.serializeDefaultContentType(n,"png","image/png"),this.serializeDefaultContentType(n,"bmp","image/bmp"),this.serializeDefaultContentType(n,"emf","image/x-emf"),this.serializeDefaultContentType(n,"wmf","image/x-wmf"),this.serializeDefaultContentType(n,"gif","image/gif"),this.serializeDefaultContentType(n,"ico","image/x-icon"),this.serializeDefaultContentType(n,"tif","image/tiff"),this.serializeDefaultContentType(n,"tiff","image/tiff"),this.serializeDefaultContentType(n,"jpeg","image/jpeg"),this.serializeDefaultContentType(n,"jpg","image/jpeg"),this.serializeDefaultContentType(n,"svg","image/svg+xml")),this.serializeOverrideContentType(n,this.documentPath,this.documentContentType),this.serializeOverrideContentType(n,this.numberingPath,this.numberingContentType),this.serializeOverrideContentType(n,this.stylePath,this.stylesContentType),this.serializeOverrideContentType(n,this.settingsPath,this.settingsContentType),this.serializeOverrideContentType(n,this.commentsPath,this.commentsContentType),this.serializeOverrideContentType(n,this.commentsExtendedPath,this.commentsExContentType),this.chartCount>0)for(t=1,this.serializeDefaultContentType(n,"xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");t<=this.chartCount;)this.serializeOverrideContentType(n,"word/charts/chart"+t+".xml",this.chartsContentType),this.serializeOverrideContentType(n,"word/charts/colors"+t+".xml",this.chartColorStyleContentType),t++;if(this.customXMLProps.length>0)for(i=0;i<this.customXMLProps.length;i++)this.serializeOverrideContentType(n,this.customXMLProps[i],this.customXmlContentType);this.serializeHFContentTypes(n);this.SerializeEFContentTypes(n);n.writeEndElement();r=new sf.compression.ZipArchiveItem(n.buffer,this.contentTypesPath);this.mArchive.addItem(r)},n.prototype.serializeHFContentTypes=function(n){this.serializeHeaderFootersContentType(n,"EvenFooter");this.serializeHeaderFootersContentType(n,"EvenHeader");this.serializeHeaderFootersContentType(n,"FirstPageFooter");this.serializeHeaderFootersContentType(n,"FirstPageHeader");this.serializeHeaderFootersContentType(n,"OddFooter");this.serializeHeaderFootersContentType(n,"OddHeader")},n.prototype.serializeHeaderFootersContentType=function(n,t){var r,u,f,i,e;if(this.headersFooters.containsKey(t))for(f=this.headersFooters.get(t),i=0;i<f.keys.length;i++)e=f.keys[i],"EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(u=this.headerPath+e.replace("rId","")+".xml",r=this.headerContentType):(u=this.footerPath+e.replace("rId","")+".xml",r=this.footerContentType),this.serializeOverrideContentType(n,u,r)},n.prototype.SerializeEFContentTypes=function(n){this.serializeEFContentType(n)},n.prototype.serializeEFContentType=function(n){var t,i;i=this.endnotesPath;t=this.endnoteContentType;this.serializeOverrideContentType(n,i,t);i=this.footnotesPath;t=this.footnoteContentType;this.serializeOverrideContentType(n,i,t)},n.prototype.serializeOverrideContentType=function(n,t,i){n.writeStartElement(void 0,"Override",void 0);n.writeAttributeString(void 0,"PartName",void 0,"/"+t.replace("\\","/"));n.writeAttributeString(void 0,"ContentType",void 0,i);n.writeEndElement()},n.prototype.serializeDefaultContentType=function(n,t,i){n.writeStartElement(void 0,"Default",void 0);n.writeAttributeString(void 0,"Extension",void 0,t);n.writeAttributeString(void 0,"ContentType",void 0,i);n.writeEndElement()},n.prototype.resetRelationShipID=function(){this.mRelationShipID=0},n.prototype.resetExcelRelationShipId=function(){this.eRelationShipId=0},n.prototype.resetChartRelationShipId=function(){this.cRelationShipId=0},n.prototype.close=function(){},n}(),vo=function(){function n(){this.pageContent="";this.curSectionIndex=0;this.inField=!1}return n.prototype.getModuleName=function(){return"TextExport"},n.prototype.save=function(n,t){this.serialize(n);var i=new sf.fileutils.StreamWriter;this.writeInternal(i);i.save(t+".txt")},n.prototype.saveAsBlob=function(n){var t,i;return this.serialize(n),t=new sf.fileutils.StreamWriter,this.writeInternal(t),i=t.buffer,t.destroy(),new Promise(function(n){n(i)})},n.prototype.serialize=function(n){var t=n.owner.sfdtExportModule.write();this.setDocument(t)},n.prototype.setDocument=function(n){this.document=n;this.mSections=n.sections},n.prototype.writeInternal=function(n){var t=void 0,u=this.document.sections.length-1,f=!1,i,r;for(this.updateLastParagraph(),i=0;i<=u;i++)t=this.document.sections[i],f=i===u,this.writeBody(n,t.blocks),this.writeNewLine(n),this.writeSectionEnd(t,f);for(r=0;r<=u;r++)t=this.document.sections[r],this.writeHeadersFooters(n,t)},n.prototype.writeBody=function(n,t){for(var u,f=t.length-1,i=void 0,r=0;r<=f;r++)(i=t[r]).hasOwnProperty("inlines")?(u=i===this.lastPara,this.writeParagraph(n,i,u)):this.writeTable(n,i)},n.prototype.writeParagraph=function(n,t,i){for(var r,u=0;u<t.inlines.length;u++)r=t.inlines[u],r.hasOwnProperty("fieldType")?this.inField=0===r.fieldType:r.hasOwnProperty("text")&&!this.inField&&this.writeText(n,r.text);i||this.writeNewLine(n)},n.prototype.writeTable=function(n,t){for(var u,r,f,i=0;i<t.rows.length;i++)for(u=t.rows[i],r=0;r<u.cells.length;r++)f=u.cells[r],this.writeBody(n,f.blocks)},n.prototype.writeHeadersFooters=function(n,t){var i=t.headersFooters;sf.base.isNullOrUndefined(i)||(this.writeHeaderFooter(n,t.headersFooters.header),this.writeHeaderFooter(n,t.headersFooters.footer),this.writeHeaderFooter(n,t.headersFooters.evenFooter),this.writeHeaderFooter(n,t.headersFooters.evenHeader),this.writeHeaderFooter(n,t.headersFooters.firstPageHeader),this.writeHeaderFooter(n,t.headersFooters.firstPageFooter))},n.prototype.writeHeaderFooter=function(n,t){t&&t.blocks&&this.writeBody(n,t.blocks)},n.prototype.writeSectionEnd=function(){this.curSectionIndex++},n.prototype.writeNewLine=function(n){sf.base.isNullOrUndefined(n)?this.pageContent=this.pageContent+" ":n.writeLine("")},n.prototype.writeText=function(n,t){sf.base.isNullOrUndefined(n)?this.pageContent+=t:n.write(t)},n.prototype.updateLastParagraph=function(){var n,u=this.document.sections.length,i,t,r;if(u>0&&(n=this.document.sections[u-1]),!sf.base.isNullOrUndefined(n)){for(i=[],t=0;t<n.blocks.length;t++)n.blocks[t].hasOwnProperty("inlines")&&i.push(n.blocks[t]);r=i.length;r>0&&(this.lastPara=i[r-1])}},n.prototype.destroy=function(){this.document=void 0;this.lastPara=void 0;this.mSections=void 0;this.sections=void 0},n}(),wu=function(){function n(n){this.startLine=void 0;this.endLine=void 0;this.endOffset=void 0;this.endCell=void 0;this.startColumnIndex=void 0;this.endColumnIndex=void 0;this.lists=void 0;this.document=void 0;this.writeInlineStyles=void 0;this.blockContent=!1;this.startContent=!1;this.multipleLineContent=!1;this.nestedContent=!1;this.editRangeId=-1;this.selectedCommentsId=[];this.selectedRevisionId=[];this.nestedBlockContent=!1;this.nestedBlockEnabled=!1;this.blocks=[];this.contentInline=[];this.isContentControl=!1;this.isBlockClosed=!0;this.isExport=!0;this.isPartialExport=!1;this.checkboxOrDropdown=!1;this.copyWithTrackChange=!1;this.documentHelper=n}return Object.defineProperty(n.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"owner",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),n.prototype.getModuleName=function(){return"SfdtExport"},n.prototype.clear=function(){this.writeInlineStyles=void 0;this.startLine=void 0;this.endLine=void 0;this.lists=void 0;this.document=void 0;this.endCell=void 0;this.startColumnIndex=void 0;this.endColumnIndex=void 0;this.selectedCommentsId=[];this.selectedRevisionId=[];this.startBlock=void 0;this.endBlock=void 0;this.isPartialExport=!1},n.prototype.serialize=function(){return JSON.stringify(this.write())},n.prototype.saveAsBlob=function(){var n=new sf.fileutils.StreamWriter,t;return n.write(this.serialize()),t=n.buffer,n.destroy(),new Promise(function(n){n(t)})},n.prototype.updateEditRangeId=function(){for(var u,f,r,t,i=-1,n=0;n<this.documentHelper.editRanges.keys.length;n++)for(u=this.documentHelper.editRanges.keys,f=0;f<u[n].length;f++)for(r=this.documentHelper.editRanges.get(u[n]),t=0;t<r.length;t++)i++,r[t].editRangeId=i,r[t].editRangeEnd.editRangeId=i},n.prototype.write=function(n,t,i,r,u,f){var v,p,y,g,o,w,c,b,a,d,nt,tt;if(u&&(this.writeInlineStyles=!0),this.Initialize(),this.updateEditRangeId(),_instanceof(n,k)&&_instanceof(i,k)){this.isExport=!1;sf.base.isNullOrUndefined(f)||(this.isExport=f);v=n.paragraph;p=i.paragraph;this.isPartialExport&&(this.startBlock=this.getParentBlock(v),this.endBlock=this.getParentBlock(p));var e=v.associatedCell,l=p.associatedCell,h=(v.bodyWidget,this.createSection(n.paragraph.bodyWidget));if((this.document.sections.push(h),e===l||sf.base.isNullOrUndefined(l))?(this.startLine=n,this.endLine=i,this.endOffset=r):_instanceof(e,s)?(y=e.getContainerTable(),g=l.getContainerTable(),y.tableFormat===g.tableFormat&&(this.endCell=l,this.endCell.ownerTable!==e.ownerTable&&e.ownerTable.associatedCell&&e.ownerTable.associatedCell.ownerTable===this.endCell.ownerTable&&0===e.ownerTable.associatedCell.childWidgets.indexOf(e.ownerTable)&&(e=e.ownerTable.associatedCell),this.endColumnIndex=this.endCell.columnIndex+this.endCell.cellFormat.columnSpan,this.startColumnIndex=e.columnIndex)):this.endCell=l,o=void 0,e===l&&!this.isPartialExport||sf.base.isNullOrUndefined(e))for(w=this.createParagraph(n.paragraph),h.blocks.push(w),c=n.paragraph,o=this.writeParagraph(n.paragraph,w,h.blocks,n.indexInOwner,t),this.isPartialExport&&(o=this.getNextBlock(o,c),h=this.document.sections[this.document.sections.length-1]);o;)c=o,o=this.writeBlock(o,0,h.blocks),this.isPartialExport&&sf.base.isNullOrUndefined(o)&&(o=this.getNextBlock(o,c),h=this.document.sections[this.document.sections.length-1]);else{if(sf.base.isNullOrUndefined(l)&&e.ownerTable.associatedCell){if(b=(y=e.getContainerTable()).childWidgets[y.childWidgets.length-1],a=b.childWidgets[b.childWidgets.length-1],a.ownerTable!==e.ownerTable&&e.ownerTable.associatedCell&&0===e.ownerTable.associatedCell.childWidgets.indexOf(e.ownerTable))for(;e.ownerTable!==a.ownerTable;)e=e.ownerTable.associatedCell;this.endColumnIndex=a.columnIndex+a.cellFormat.columnSpan;this.startColumnIndex=e.columnIndex}for(d=this.createTable(e.ownerTable),h.blocks.push(d),c=e.ownerTable,o=this.writeTable(e.ownerTable,d,e.ownerRow.indexInOwner,h.blocks),this.isPartialExport&&(o=this.getNextBlock(o,c),h=this.document.sections[this.document.sections.length-1]);o;)c=o,o=this.writeBlock(o,0,h.blocks),this.isPartialExport&&(o=this.getNextBlock(o,c),h=this.document.sections[this.document.sections.length-1])}}else(this.isExport=!0,this.documentHelper.pages.length>0)&&(nt=this.documentHelper.pages[0],this.writePage(nt));return this.writeStyles(this.documentHelper),this.writeLists(this.documentHelper),this.writeComments(this.documentHelper),this.writeRevisions(this.documentHelper),this.writeCustomXml(this.documentHelper),this.footnotes(this.documentHelper),this.endnotes(this.documentHelper),tt=this.document,this.clear(),tt},n.prototype.getNextBlock=function(n,t){if(sf.base.isNullOrUndefined(n)&&this.isPartialExport&&this.endBlock&&!this.endBlock.equals(t))if((n=t.getSplitWidgets().pop().nextRenderedWidget)&&t.bodyWidget.index!==n.bodyWidget.index){var i=this.createSection(n.bodyWidget);this.document.sections.push(i)}else n=void 0;return n},n.prototype.Initialize=function(){this.lists=[];this.document={};this.document.sections=[];this.document.characterFormat=this.writeCharacterFormat(this.documentHelper.characterFormat);this.document.paragraphFormat=this.writeParagraphFormat(this.documentHelper.paragraphFormat);this.document.defaultTabWidth=this.documentHelper.defaultTabWidth;this.document.trackChanges=this.owner.enableTrackChanges;this.document.enforcement=this.documentHelper.isDocumentProtected;this.document.hashValue=this.documentHelper.hashValue;this.document.saltValue=this.documentHelper.saltValue;this.document.formatting=this.documentHelper.restrictFormatting;this.document.protectionType=this.documentHelper.protectionType;this.document.dontUseHTMLParagraphAutoSpacing=this.documentHelper.dontUseHtmlParagraphAutoSpacing;this.document.formFieldShading=this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading;this.document.compatibilityMode=this.documentHelper.compatibilityMode},n.prototype.writePage=function(n){if(n.bodyWidgets.length>0){var t=n.bodyWidgets[0];do t=this.writeBodyWidget(t,0);while(!sf.base.isNullOrUndefined(t))}return this.document},n.prototype.writeBodyWidget=function(n,t){var r,u,i;if(_instanceof(n,c)){r=this.createSection(n);this.document.sections.push(r);this.writeHeaderFooters(this.documentHelper.headersFooters[n.index],r);u=n.childWidgets[t];do u=this.writeBlock(u,0,r.blocks);while(u);i=n;do n=i,i=i.nextRenderedWidget,!sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(n.page.nextPage)||sf.base.isNullOrUndefined(n.page.nextPage)||(i=n.page.nextPage.bodyWidgets[0]);while(_instanceof(i,c)&&i.index===n.index);return i}},n.prototype.writeHeaderFooters=function(n,t){sf.base.isNullOrUndefined(n)||(t.headersFooters.header=this.writeHeaderFooter(n[0]),t.headersFooters.footer=this.writeHeaderFooter(n[1]),t.headersFooters.evenHeader=this.writeHeaderFooter(n[2]),t.headersFooters.evenFooter=this.writeHeaderFooter(n[3]),t.headersFooters.firstPageHeader=this.writeHeaderFooter(n[4]),t.headersFooters.firstPageFooter=this.writeHeaderFooter(n[5]))},n.prototype.writeHeaderFooter=function(n){var t,i;if(!sf.base.isNullOrUndefined(n)&&!n.isEmpty){if(t={},n&&n.childWidgets&&n.childWidgets.length>0){t.blocks=[];i=n.firstChild;do i=this.writeBlock(i,0,t.blocks);while(i)}return t}},n.prototype.createSection=function(n){var t={sectionFormat:{}};return t.sectionFormat.pageWidth=n.sectionFormat.pageWidth,t.sectionFormat.pageHeight=n.sectionFormat.pageHeight,t.sectionFormat.leftMargin=n.sectionFormat.leftMargin,t.sectionFormat.rightMargin=n.sectionFormat.rightMargin,t.sectionFormat.topMargin=n.sectionFormat.topMargin,t.sectionFormat.bottomMargin=n.sectionFormat.bottomMargin,t.sectionFormat.differentFirstPage=n.sectionFormat.differentFirstPage,t.sectionFormat.differentOddAndEvenPages=n.sectionFormat.differentOddAndEvenPages,t.sectionFormat.headerDistance=n.sectionFormat.headerDistance,t.sectionFormat.footerDistance=n.sectionFormat.footerDistance,t.sectionFormat.bidi=n.sectionFormat.bidi,n.sectionFormat.restartPageNumbering&&(t.sectionFormat.restartPageNumbering=n.sectionFormat.restartPageNumbering,t.sectionFormat.pageStartingNumber=n.sectionFormat.pageStartingNumber),sf.base.isNullOrUndefined(n.page.endnoteWidget||n.page.footnoteWidget)||(t.sectionFormat.endnoteNumberFormat=n.sectionFormat.endnoteNumberFormat,t.sectionFormat.footNoteNumberFormat=n.sectionFormat.footNoteNumberFormat,t.sectionFormat.restartIndexForFootnotes=n.sectionFormat.restartIndexForFootnotes,t.sectionFormat.restartIndexForEndnotes=n.sectionFormat.restartIndexForEndnotes,t.sectionFormat.initialFootNoteNumber=n.sectionFormat.initialFootNoteNumber,t.sectionFormat.initialEndNoteNumber=n.sectionFormat.initialEndNoteNumber),t.blocks=[],t.headersFooters={},t},n.prototype.writeBlock=function(n,t,i){var f,e,r,o;if(_instanceof(n,wt))return _instanceof(n,u)?n.hasOwnProperty("contentControlProperties")&&"BuildingBlockGallery"!==n.contentControlProperties.type?(f=this.blockContentControl(n),!sf.base.isNullOrUndefined(f)&&this.isBlockClosed&&(i.push(f),this.blocks=[]),this.nextBlock):(e=this.createParagraph(n),i.push(e),this.writeParagraph(n,e,i)):(r=n,r.hasOwnProperty("contentControlProperties")&&"BuildingBlockGallery"!==r.contentControlProperties.type)?(f=this.tableContentControl(r),this.isBlockClosed&&i.push(f),this.nextBlock):(o=this.createTable(r),i.push(o),this.writeTable(r,o,0,i))},n.prototype.writeParagraphs=function(n){var t=this.blocks,f=n.childWidgets[0],i=f.children[0],u=f.children[1],e,s,r;return((_instanceof(i,o)||_instanceof(u,o))&&(i=f.children[2],u=f.children[3]),this.nestedBlockEnabled&&(t=[]),_instanceof(i,w)&&_instanceof(u,w)&&!this.nestedBlockContent||this.blockContent&&_instanceof(i,w)&&!this.nestedBlockContent)?(e=!1,(_instanceof(u,w)&&"Block"===u.contentControlWidgetType&&(e=!0),e||this.blockContent&&_instanceof(i,w)&&!this.nestedBlockContent&&0===i.type&&"Block"===i.contentControlWidgetType)?(this.nestedBlockContent=!0,this.nestedBlockEnabled=!0,s=this.blockContentControl(n),sf.base.isNullOrUndefined(s)||this.blocks.push(s)):(r=this.createParagraph(n),t.push(r),this.nextBlock=this.writeParagraph(n,r,t))):(r=this.createParagraph(n),t.push(r),this.nextBlock=this.writeParagraph(n,r,t)),this.blockContent?!this.nestedBlockContent&&this.nestedBlockEnabled?(this.nestedBlockEnabled=!1,t):void 0:t},n.prototype.contentControlProperty=function(n){var t={};return t.lockContentControl=n.lockContentControl,t.lockContents=n.lockContents,t.tag=n.tag,t.color=n.color,t.title=n.title,sf.base.isNullOrUndefined(n.appearance)||(t.appearance=n.appearance),t.type=n.type,t.hasPlaceHolderText=n.hasPlaceHolderText,t.multiline=n.multiline,t.isTemporary=n.isTemporary,sf.base.isNullOrUndefined(n.isChecked)||(t.isChecked=n.isChecked),sf.base.isNullOrUndefined(n.uncheckedState)||(t.uncheckedState=this.tounCheckedState(n.uncheckedState)),sf.base.isNullOrUndefined(n.checkedState)||(t.checkedState=this.toCheckedState(n.checkedState)),sf.base.isNullOrUndefined(n.dateCalendarType)||(t.dateCalendarType=n.dateCalendarType),sf.base.isNullOrUndefined(n.dateStorageFormat)||(t.dateStorageFormat=n.dateStorageFormat),sf.base.isNullOrUndefined(n.dateDisplayLocale)||(t.dateDisplayLocale=n.dateDisplayLocale),sf.base.isNullOrUndefined(n.dateDisplayFormat)||(t.dateDisplayFormat=n.dateDisplayFormat),sf.base.isNullOrUndefined(n.xmlMapping)||(t.xmlMapping=n.xmlMapping),sf.base.isNullOrUndefined(n.characterFormat)||(t.characterFormat=this.writeCharacterFormat(n.characterFormat)),t.contentControlListItems=n.contentControlListItems,t},n.prototype.tounCheckedState=function(n){var t={};return t.font=n.font,t.value=n.value,t},n.prototype.toCheckedState=function(n){var t={};return t.font=n.font,t.value=n.value,t},n.prototype.blockContentControl=function(n){var t={};if(0!==n.childWidgets.length){if(t.blocks=this.writeParagraphs(n),!sf.base.isNullOrUndefined(t.blocks)){var u=n.childWidgets[0],r=u.children[0],i=u.children[1];if((_instanceof(r,o)||_instanceof(i,o))&&(r=u.children[2],i=u.children[3]),_instanceof(r,w)&&_instanceof(i,w)&&!this.nestedBlockContent||this.blockContent&&_instanceof(r,w)&&!this.nestedBlockContent){if(!_instanceof(i,w))return t.contentControlProperties=this.contentControlProperty(r.contentControlProperties),t;t.contentControlProperties="Block"===i.contentControlWidgetType?this.contentControlProperty(i.contentControlProperties):this.contentControlProperty(n.contentControlProperties)}else t.contentControlProperties=this.contentControlProperty(n.contentControlProperties);return t}}else this.nextBlock=n.nextWidget},n.prototype.tableContentControl=function(n){var t={};return t.blocks=this.tableContentControls(n),sf.base.isNullOrUndefined(this.nextBlock)||n.contentControlProperties!==this.nextBlock.contentControlProperties?(t.contentControlProperties=this.contentControlProperty(n.contentControlProperties),t):this.blocks=t.blocks},n.prototype.tableContentControls=function(n){var t=[],i;return this.isBlockClosed||(t=this.blocks),i=this.createTable(n),t.push(i),this.nextBlock=this.writeTable(n,i,0,t),t},n.prototype.writeParagraph=function(n,t,i,r,f){sf.base.isNullOrUndefined(r)&&(r=0);sf.base.isNullOrUndefined(f)&&(f=0);for(var e=n;_instanceof(e,u);){if(this.writeLines(e,r,f,t.inlines))return;r=0;f=0;e=(n=e).nextSplitWidget}return e=n.nextRenderedWidget,sf.base.isNullOrUndefined(e)&&_instanceof(n.containerWidget,c)&&!sf.base.isNullOrUndefined(n.containerWidget.page.nextPage)&&!sf.base.isNullOrUndefined(n.containerWidget.page.nextPage.bodyWidgets)&&(e=n.containerWidget.page.nextPage.bodyWidgets[0].childWidgets[0]),_instanceof(e,wt)&&n.containerWidget.index===e.containerWidget.index?e:void 0},n.prototype.writeInlines=function(n,t,u){var e,f,c;this.contentInline=[];var s=t.clone(),h=!1,l=n.paragraphFormat.bidi;for((l||this.documentHelper.layout.isContainsRtl(s))&&this.documentHelper.layout.reArrangeElementsForRtl(s,l),e=0;e<s.children.length;e++){if(f=s.children[e],this.isExport&&this.checkboxOrDropdown){if(h&&_instanceof(f,i))continue;_instanceof(f,r)&&2===f.fieldType&&(h=!0)}_instanceof(f,o)||(_instanceof(f,yt)?u.push(this.writeInlinesFootNote(n,f,t,u)):_instanceof(f,w)&&!sf.base.isNullOrUndefined(f.contentControlProperties)&&"BuildingBlockGallery"!==f.contentControlProperties.type||this.startContent||this.blockContent?u.length>0&&this.writeInlinesContentControl(f,t,u,e):(c=this.writeInline(f),sf.base.isNullOrUndefined(c)||u.push(c),this.isExport&&_instanceof(f,r)&&1===f.fieldType&&(h=!1,this.checkboxOrDropdown=!1)))}},n.prototype.inlineContentControl=function(n,t,i){var r={},f=[],u;if(sf.base.isNullOrUndefined(i)?this.nestedContent?(r.inlines=this.inlineContentControls(n,void 0,f),u=this.nestedContentProperty(t,r),sf.base.isNullOrUndefined(u)&&!this.multipleLineContent||(this.contentInline.push(r),f=[])):r.inlines=this.inlineContentControls(n,this.contentInline):this.nestedContent?(i=i[i.length-1].inlines,r=this.inlineContentControls(n,i[i.length-1].inlines),u=this.nestedContentProperty(t,i[i.length-1]),sf.base.isNullOrUndefined(u)||(this.contentInline.push(r),f=[])):this.inlineContentControls(n,i[i.length-1].inlines),sf.base.isNullOrUndefined(t)){if(this.startContent)return this.multipleLineContent=!0,r}else if(1===t.type&&!this.nestedContent)return this.multipleLineContent?(i[i.length-1].contentControlProperties=this.contentControlProperty(t.contentControlProperties),void(this.multipleLineContent=!1)):(r.contentControlProperties=this.contentControlProperty(t.contentControlProperties),r)},n.prototype.nestedContentProperty=function(n,t){if(sf.base.isNullOrUndefined(n)){if(this.startContent)return this.multipleLineContent=!0,t}else{if(1===n.type)return t.contentControlProperties=this.contentControlProperty(n.contentControlProperties),t;if(this.startContent)return this.multipleLineContent=!0,t}},n.prototype.inlineContentControls=function(n,t,i){var r=this.writeInline(n);return sf.base.isNullOrUndefined(i)?(t.push(r),t):(i.push(r),i)},n.prototype.writeInline=function(n){var u={},o,f,s;if(n.removedIds.length>0)for(o=0;o<n.removedIds.length;o++)n.revisions[o]=this.documentHelper.revisionsInternal.get(n.removedIds[o]);if(u.characterFormat=this.writeCharacterFormat(n.characterFormat),_instanceof(n,r))u.fieldType=n.fieldType,0===n.fieldType&&(u.hasFieldEnd=!0,n.formFieldData&&(u.formFieldData={},u.formFieldData.name=n.formFieldData.name,u.formFieldData.enabled=n.formFieldData.enabled,u.formFieldData.helpText=n.formFieldData.helpText,u.formFieldData.statusText=n.formFieldData.statusText,_instanceof(n.formFieldData,vt)?(u.formFieldData.textInput={},u.formFieldData.textInput.type=n.formFieldData.type,u.formFieldData.textInput.maxLength=n.formFieldData.maxLength,u.formFieldData.textInput.defaultValue=n.formFieldData.defaultValue,u.formFieldData.textInput.format=n.formFieldData.format):_instanceof(n.formFieldData,bt)?(u.formFieldData.checkBox={},this.checkboxOrDropdown=!0,u.formFieldData.checkBox.sizeType=n.formFieldData.sizeType,u.formFieldData.checkBox.size=n.formFieldData.size,u.formFieldData.checkBox.defaultValue=n.formFieldData.defaultValue,u.formFieldData.checkBox.checked=n.formFieldData.checked):(u.formFieldData.dropDownList={},this.checkboxOrDropdown=!0,u.formFieldData.dropDownList.dropDownItems=n.formFieldData.dropdownItems,u.formFieldData.dropDownList.selectedIndex=n.formFieldData.selectedIndex))),n.fieldCodeType&&""!==n.fieldCodeType&&(u.fieldCodeType=n.fieldCodeType);else if(_instanceof(n,ir))this.writeChart(n,u);else if(_instanceof(n,v))u.imageString=n.imageString,u.metaFileImageString=n.metaFileImageString,u.isMetaFile=n.isMetaFile,u.isCompressed=n.isCompressed,u.width=t.convertPixelToPoint(n.width),u.height=t.convertPixelToPoint(n.height),u.iscrop=n.isCrop,n.isCrop&&(u.bottom=n.bottom,u.right=n.right,u.left=n.left,u.top=n.top,u.getimagewidth=n.cropWidthScale,u.getimageheight=n.cropHeightScale),u.name=n.name,u.alternativeText=n.alternativeText,u.title=n.title,u.visible=n.visible,u.widthScale=n.widthScale,u.heightScale=n.heightScale,u.verticalPosition=t.convertPixelToPoint(n.verticalPosition),u.verticalOrigin=n.verticalOrigin,u.verticalAlignment=n.verticalAlignment,u.horizontalPosition=t.convertPixelToPoint(n.horizontalPosition),u.horizontalOrigin=n.horizontalOrigin,u.horizontalAlignment=n.horizontalAlignment,u.allowOverlap=n.allowOverlap,u.textWrappingStyle=n.textWrappingStyle,u.textWrappingType=n.textWrappingType,u.layoutInCell=n.layoutInCell,u.zOrderPosition=n.zOrderPosition;else if(_instanceof(n,e))u.bookmarkType=n.bookmarkType,u.name=n.name;else if(_instanceof(n,i))if(-1!==n.text.indexOf("\x1e"))u.text=n.text.replace(/\u001e/g,"-");else if(-1!==n.text.indexOf("\x1f"))u.text=n.text.replace(/\u001f/g,"");else if(0!==n.revisions.length)if(this.isExport||!this.owner.enableTrackChanges||this.isPartialExport)u.text=n.text;else for(this.copyWithTrackChange=!0,f=0;f<n.revisions.length;f++)s=n.revisions[f],-1===this.selectedRevisionId.indexOf(s.revisionID)&&this.selectedRevisionId.push(s.revisionID),"Deletion"===n.revisions[f].revisionType?n.revisions.pop():"Insertion"===n.revisions[f].revisionType?(n.revisions.pop(),u.text=n.text):u.text=n.text;else u.text=n.text;else _instanceof(n,ht)?(u.user=n.user,u.group=n.group,u.columnFirst=n.columnFirst,u.columnLast=n.columnLast,u.editRangeId=n.editRangeId.toString()):_instanceof(n,ot)?(u.editableRangeStart={user:n.editRangeStart.user,group:n.editRangeStart.group,columnFirst:n.editRangeStart.columnFirst,columnLast:n.editRangeStart.columnLast},u.editRangeId=n.editRangeId.toString()):_instanceof(n,g)?(this.isExport||0!==n.commentType||this.selectedCommentsId.push(n.commentId),u.commentCharacterType=n.commentType,u.commentId=n.commentId):_instanceof(n,nt)?this.writeShape(n,u):u=void 0;if(n.revisions.length>0)for(u.revisionIds=[],f=0;f<n.revisions.length;f++)-1===this.selectedRevisionId.indexOf(n.revisions[f].revisionID)&&this.selectedRevisionId.push(n.revisions[f].revisionID),u.revisionIds.push(n.revisions[f].revisionID);return u},n.prototype.writeShape=function(n,i){var r,u;if(i.shapeId=n.shapeId,i.name=n.name,i.alternativeText=n.alternativeText,i.title=n.title,i.visible=n.visible,i.width=t.convertPixelToPoint(n.width),i.height=t.convertPixelToPoint(n.height),i.widthScale=n.widthScale,i.heightScale=n.heightScale,i.verticalPosition=t.convertPixelToPoint(n.verticalPosition),i.verticalOrigin=n.verticalOrigin,i.verticalAlignment=n.verticalAlignment,i.verticalRelativePercent=n.verticalRelativePercent,i.horizontalPosition=t.convertPixelToPoint(n.horizontalPosition),i.horizontalOrigin=n.horizontalOrigin,i.horizontalAlignment=n.horizontalAlignment,i.horizontalRelativePercent=n.horizontalRelativePercent,i.zOrderPosition=n.zOrderPosition,i.allowOverlap=n.allowOverlap,i.textWrappingStyle=n.textWrappingStyle,i.textWrappingType=n.textWrappingType,i.distanceBottom=t.convertPixelToPoint(n.distanceBottom),i.distanceLeft=t.convertPixelToPoint(n.distanceLeft),i.distanceRight=t.convertPixelToPoint(n.distanceRight),i.distanceTop=t.convertPixelToPoint(n.distanceTop),i.layoutInCell=n.layoutInCell,i.lockAnchor=n.lockAnchor,i.autoShapeType=n.autoShapeType,n.fillFormat&&(i.fillFormat={},i.fillFormat.color=n.fillFormat.color,i.fillFormat.fill=n.fillFormat.fill),n.lineFormat&&(i.lineFormat={},i.lineFormat.lineFormatType=n.lineFormat.lineFormatType,i.lineFormat.color=n.lineFormat.color,i.lineFormat.weight=n.lineFormat.weight,i.lineFormat.lineStyle=n.lineFormat.dashStyle,i.lineFormat.line=n.lineFormat.line),n.textFrame)for(i.textFrame={},i.textFrame.textVerticalAlignment=n.textFrame.textVerticalAlignment,i.textFrame.leftMargin=t.convertPixelToPoint(n.textFrame.marginLeft),i.textFrame.rightMargin=t.convertPixelToPoint(n.textFrame.marginRight),i.textFrame.topMargin=t.convertPixelToPoint(n.textFrame.marginTop),i.textFrame.bottomMargin=t.convertPixelToPoint(n.textFrame.marginBottom),i.textFrame.blocks=[],r=0;r<n.textFrame.childWidgets.length;r++)u=n.textFrame.childWidgets[r],this.writeBlock(u,0,i.textFrame.blocks)},n.prototype.writeChart=function(n,i){i.chartLegend={};i.chartTitleArea={};i.chartArea={};i.plotArea={};i.chartCategory=[];i.chartSeries=[];i.chartPrimaryCategoryAxis={};i.chartPrimaryValueAxis={};this.writeChartTitleArea(n.chartTitleArea,i.chartTitleArea);this.writeChartArea(n.chartArea,i.chartArea);this.writeChartArea(n.chartPlotArea,i.plotArea);this.writeChartCategory(n,i.chartCategory);this.createChartSeries(n,i.chartSeries);this.writeChartLegend(n.chartLegend,i.chartLegend);this.writeChartCategoryAxis(n.chartPrimaryCategoryAxis,i.chartPrimaryCategoryAxis);this.writeChartCategoryAxis(n.chartPrimaryValueAxis,i.chartPrimaryValueAxis);void 0!==n.chartDataTable.showSeriesKeys&&(i.chartDataTable={},this.writeChartDataTable(n.chartDataTable,i.chartDataTable));i.chartTitle=n.title;i.chartType=n.type;i.gapWidth=n.chartGapWidth;i.overlap=n.chartOverlap;i.height=t.convertPixelToPoint(n.height);i.width=t.convertPixelToPoint(n.width)},n.prototype.writeChartTitleArea=function(n,t){t.fontName=n.chartfontName;t.fontSize=n.chartFontSize;t.layout={};t.dataFormat=this.writeChartDataFormat(n.dataFormat);this.writeChartLayout(n.layout,t.layout)},n.prototype.writeChartDataFormat=function(n){var t={fill:{},line:{}};return t.fill.foreColor=n.fill.color,t.fill.rgb=n.fill.rgb,t.line.color=n.line.color,t.line.rgb=n.line.rgb,t},n.prototype.writeChartLayout=function(n,t){t.layoutX=n.chartLayoutLeft;t.layoutY=n.chartLayoutTop},n.prototype.writeChartArea=function(n,t){t.foreColor=n.chartForeColor},n.prototype.writeChartLegend=function(n,t){t.position=n.chartLegendPostion;t.chartTitleArea={};this.writeChartTitleArea(n.chartTitleArea,t.chartTitleArea)},n.prototype.writeChartCategoryAxis=function(n,t){t.chartTitle=n.categoryAxisTitle;t.chartTitleArea={};this.writeChartTitleArea(n.chartTitleArea,t.chartTitleArea);t.categoryType=n.categoryAxisType;t.fontSize=n.axisFontSize;t.fontName=n.axisFontName;t.numberFormat=n.categoryNumberFormat;t.maximumValue=n.max;t.minimumValue=n.min;t.majorUnit=n.interval;t.hasMajorGridLines=n.majorGridLines;t.hasMinorGridLines=n.minorGridLines;t.majorTickMark=n.majorTick;t.minorTickMark=n.minorTick;t.tickLabelPosition=n.tickPosition},n.prototype.writeChartDataTable=function(n,t){t.showSeriesKeys=n.showSeriesKeys;t.hasHorzBorder=n.hasHorzBorder;t.hasVertBorder=n.hasVertBorder;t.hasBorders=n.hasBorders},n.prototype.writeChartCategory=function(n,t){var r=n.chartCategory,i,u,f;for(t.chartData=[],i=0;i<r.length;i++)u=r[i],f=this.createChartCategory(u,n.chartType),t.push(f)},n.prototype.createChartCategory=function(n,t){var i={chartData:[]};return this.writeChartData(n,i.chartData,t),i.categoryXName=n.categoryXName,i},n.prototype.writeChartData=function(n,t,i){for(var f,e,u=n.chartData,r=0;r<u.length;r++)f=u[r],e=this.createChartData(f,i),t.push(e)},n.prototype.createChartData=function(n,t){var i={};return i.yValue=n.yValue,"Bubble"===t&&(i.size=n.size),i},n.prototype.createChartSeries=function(n,t){for(var u,f,r=n.chartSeries,e=n.chartType,i=0;i<r.length;i++)u=r[i],f=this.writeChartSeries(u,e),t.push(f)},n.prototype.writeChartSeries=function(n,t){var c="Pie"===t||"Doughnut"===t,i={},o={},u=n.errorBar,s,e,f,r,h;if((i.dataPoints=[],i.seriesName=n.seriesName,c&&(sf.base.isNullOrUndefined(n.firstSliceAngle)||(i.firstSliceAngle=n.firstSliceAngle),"Doughnut"===t&&(i.holeSize=n.doughnutHoleSize)),sf.base.isNullOrUndefined(n.dataLabels.labelPosition))||(s=this.writeChartDataLabels(n.dataLabels),i.dataLabel=s),sf.base.isNullOrUndefined(n.seriesFormat.markerStyle)||(e={},f=n.seriesFormat,e.markerStyle=f.markerStyle,e.markerSize=f.numberValue,e.markerColor=f.markerColor,i.seriesFormat=e),sf.base.isNullOrUndefined(u.type)||(o.type=u.type,o.direction=u.direction,o.endStyle=u.endStyle,o.numberValue=u.numberValue,i.errorBar=u),n.trendLines.length>0)for(i.trendLines=[],r=0;r<n.trendLines.length;r++)h=this.writeChartTrendLines(n.trendLines[r]),i.trendLines.push(h);for(r=0;r<n.chartDataFormat.length;r++)f=this.writeChartDataFormat(n.chartDataFormat[r]),i.dataPoints.push(f);return i},n.prototype.writeChartDataLabels=function(n){var t={};return t.position=n.position,t.fontName=n.fontName,t.fontColor=n.fontColor,t.fontSize=n.fontSize,t.isLegendKey=n.isLegendKey,t.isBubbleSize=n.isBubbleSize,t.isCategoryName=n.isCategoryName,t.isSeriesName=n.isSeriesName,t.isValue=n.isValue,t.isPercentage=n.isPercentage,t.isLeaderLines=n.isLeaderLines,t},n.prototype.writeChartTrendLines=function(n){var t={};return t.name=n.trendLineName,t.type=n.trendLineType,t.forward=n.forwardValue,t.backward=n.backwardValue,t.intercept=n.interceptValue,t.isDisplayEquation=n.isDisplayEquation,t.isDisplayRSquared=n.isDisplayRSquared,t},n.prototype.writeLines=function(n,t,i,r){for(var u,o=t,e=_instanceof(this.endLine,k)&&this.endLine.paragraph===n,s=e?this.endLine.indexInOwner:n.childWidgets.length-1,f=o;f<=s;f++)u=n.childWidgets[f],this.endLine===u||t===f&&0!==i?this.writeLine(u,this.startLine!==this.endLine&&u!==this.startLine?0:i,r):this.writeInlines(n,u,r);return e},n.prototype.writeLine=function(n,t,r){var u,f;this.contentInline=[];var e=!1,h=!1,b=n===this.endLine,c=n.clone(),y=n.paragraph.paragraphFormat.bidi;(y||this.documentHelper.layout.isContainsRtl(c))&&this.documentHelper.layout.reArrangeElementsForRtl(c,y);for(var l=!1,s=!1,a=0,v=0;v<c.children.length;v++)if(u=c.children[v],!_instanceof(u,o)&&(f=void 0,l=(a+=u.length)>t,_instanceof(u,w)&&(l||(e=0===u.type),h=!0),_instanceof(u,i)&&u.hasOwnProperty("contentControlProperties")&&l&&!h&&(e=!0),_instanceof(u,w)&&(e&&1===u.type&&(e=!1),h&&1===u.type&&(h=!1)),s=b&&a>=this.endOffset,l&&!e))if(_instanceof(u,w)&&!sf.base.isNullOrUndefined(u.contentControlProperties)&&"BuildingBlockGallery"!==u.contentControlProperties.type||this.startContent||this.blockContent){if(s){this.startContent=!1;break}this.writeInlinesContentControl(u,n,r,v)}else{if(f=this.writeInline(u),r[r.length]=f,a>t||s){if(f.hasOwnProperty("text")){var p=a-u.length,k=t-p,d=s?this.endOffset-p:u.length;f.text=f.text.substring(k,d)}t=-1}if(s)break}},n.prototype.writeInlinesFootNote=function(n,t){var i={},r;for(i.footnoteType=t.footnoteType,i.characterFormat={},i.characterFormat=this.writeCharacterFormat(t.characterFormat),i.blocks=[],r=0;r<t.blocks.length;r++)this.writeBlock(t.blocks[r],0,i.blocks);return i.symbolCode=t.symbolCode,i.symbolFontName=t.symbolFontName,i.customMarker=t.customMarker,i},n.prototype.writeInlinesContentControl=function(n,t,i,r){var e,f,u;if(_instanceof(n,w)&&"Block"===n.contentControlWidgetType)return this.isBlockClosed=!1,this.blockContent&&0===n.type?(this.nestedBlockContent=!0,!0):this.nestedBlockContent&&1===n.type?(this.nestedBlockContent=!1,!0):(this.blockContent=0===n.type,_instanceof(t.children[r-1],w)&&"Block"===t.children[r-1].contentControlWidgetType&&(this.blockContent=!0),this.blockContent||(this.isBlockClosed=!0),!0);if(_instanceof(n,w))return this.startContent&&0===n.type?(this.nestedContent=!0,!0):this.startContent&&this.nestedContent?(((u={}).inlines=this.contentInline,this.contentInline.length>0)&&(e=this.nestedContentProperty(t.children[r+1],u),i.push(e),this.contentInline=[]),this.multipleLineContent&&(u=i[i.length-1],this.nestedContentProperty(t.children[r+1],u),this.multipleLineContent=!1),this.nestedContent=!1,!0):(this.contentType=n.contentControlWidgetType,this.startContent=0===n.type,!0);if(this.startContent&&"Inline"===this.contentType){if(this.multipleLineContent)this.inlineContentControl(n,t.children[r+1],i),this.contentInline=[];else if(f=this.inlineContentControl(n,t.children[r+1]),!sf.base.isNullOrUndefined(f)){if(!this.nestedContent||!this.multipleLineContent)return i.push(f),this.contentInline=[],!1;(u={}).inlines=this.contentInline;i.push(u)}}else u=this.writeInline(n),sf.base.isNullOrUndefined(u)||i.push(u)},n.prototype.createParagraph=function(n){var i={},r=!1,t,u;return!this.documentHelper.selection||this.documentHelper.selection.isEmpty||this.isExport?r=!0:(t=this.documentHelper.selection.end,this.documentHelper.selection.isForward||(t=this.documentHelper.selection.start),u=t.paragraph.childWidgets[t.paragraph.childWidgets.length-1],r=this.documentHelper.selection.isParagraphLastLine(u)&&t.currentWidget===u&&t.offset===this.documentHelper.selection.getLineLength(u)+1),i.paragraphFormat=this.writeParagraphFormat(r?n.paragraphFormat:new ut(n)),i.characterFormat=this.writeCharacterFormat(r?n.characterFormat:new p(n)),i.inlines=[],i},n.prototype.writeCharacterFormat=function(n,i){var r={};return t.writeCharacterFormat(r,i,n),r.boldBidi=i?n.bold:n.getValue("bold"),r.italicBidi=i?n.italic:n.getValue("italic"),r.fontSizeBidi=i?n.fontSize:n.getValue("fontSize"),r.fontFamilyBidi=i?n.fontFamily:n.getValue("fontFamily"),this.writeInlineStyles&&!i&&(r.inlineFormat=this.writeCharacterFormat(n,!0)),r},n.prototype.writeParagraphFormat=function(n,t){var i={};return i.leftIndent=t?n.leftIndent:n.getValue("leftIndent"),i.rightIndent=t?n.rightIndent:n.getValue("rightIndent"),i.firstLineIndent=t?n.firstLineIndent:n.getValue("firstLineIndent"),i.textAlignment=t?n.textAlignment:n.getValue("textAlignment"),i.beforeSpacing=t?n.beforeSpacing:n.getValue("beforeSpacing"),i.afterSpacing=t?n.afterSpacing:n.getValue("afterSpacing"),i.lineSpacing=t?n.lineSpacing:n.getValue("lineSpacing"),i.lineSpacingType=t?n.lineSpacingType:n.getValue("lineSpacingType"),i.styleName=sf.base.isNullOrUndefined(n.baseStyle)?void 0:n.baseStyle.name,i.outlineLevel=t?n.outlineLevel:n.getValue("outlineLevel"),i.listFormat=this.writeListFormat(n.listFormat,t),i.tabs=this.writeTabs(n.tabs),i.bidi=t?n.bidi:n.getValue("bidi"),i.keepLinesTogether=t?n.keepLinesTogether:n.getValue("keepLinesTogether"),i.keepWithNext=t?n.keepWithNext:n.getValue("keepWithNext"),i.widowControl=t?n.widowControl:n.getValue("widowControl"),i.contextualSpacing=t?n.contextualSpacing:n.getValue("contextualSpacing"),this.writeInlineStyles&&!t&&(i.inlineFormat=this.writeParagraphFormat(n,!0)),i},n.prototype.writeTabs=function(n){var u,r,i,t;if(!(sf.base.isNullOrUndefined(n)||n.length<1)){for(u=[],r=0;r<n.length;r++)i=n[r],t={},t.position=i.position,t.deletePosition=i.deletePosition,t.tabJustification=i.tabJustification,t.tabLeader=i.tabLeader,u.push(t);return u}},n.prototype.writeListFormat=function(n){var t={},r=n.getValue("listId"),i;return sf.base.isNullOrUndefined(r)||(t.listId=r,this.lists.indexOf(n.listId)<0&&this.lists.push(n.listId)),i=n.getValue("listLevelNumber"),sf.base.isNullOrUndefined(i)||(t.listLevelNumber=i),t},n.prototype.writeTable=function(n,t,i){var u=n.childWidgets[i],r;if(!(_instanceof(u,a)&&this.writeRow(u,t.rows))){r=n;do r=(n=r).nextSplitWidget;while(_instanceof(r,wt));return _instanceof(r=n.nextRenderedWidget,wt)&&r.containerWidget.index===n.containerWidget.index?r:void 0}},n.prototype.writeRow=function(n,t){var f,u,r,i;if(!_instanceof(n,a))return!1;for(f=this.createRow(n),t.push(f),u=0;u<n.childWidgets.length;u++)if(r=n.childWidgets[u],_instanceof(r,s)&&n.index===r.rowIndex&&(sf.base.isNullOrUndefined(this.startColumnIndex)||r.columnIndex>=this.startColumnIndex)&&(sf.base.isNullOrUndefined(this.endColumnIndex)||r.columnIndex<this.endColumnIndex)&&this.writeCell(r,f.cells))return!0;i=n;do i=(n=i).nextRenderedWidget,!sf.base.isNullOrUndefined(n.ownerTable.bodyWidget)&&i&&(n.ownerTable.index!==i.ownerTable.index&&n.ownerTable.bodyWidget.sectionIndex===i.ownerTable.bodyWidget.sectionIndex||n.ownerTable.bodyWidget.sectionIndex!==i.ownerTable.bodyWidget.sectionIndex)&&(i=void 0);while(_instanceof(i,a)&&i.index===n.index);return this.writeRow(i,t)},n.prototype.writeCell=function(n,t){var r=this.createCell(n),i;t.push(r);i=n.firstChild;do i=this.writeBlock(i,0,r.blocks);while(i);return _instanceof(this.endCell,s)&&this.endCell.cellFormat===n.cellFormat},n.prototype.createTable=function(n){for(var t={rows:[],grid:[]},i=0;i<n.tableHolder.columns.length;i++)t.grid[i]=n.tableHolder.columns[i].preferredWidth;return t.tableFormat=this.writeTableFormat(n.tableFormat),t.description=n.description,t.title=n.title,t.columnCount=n.tableHolder.columns.length,this.writeTablePositioning(t,n),t},n.prototype.writeTablePositioning=function(n,i){i.wrapTextAround&&(n.wrapTextAround=i.wrapTextAround,n.positioning={},n.positioning.allowOverlap=i.positioning.allowOverlap,n.positioning.distanceBottom=t.convertPixelToPoint(i.positioning.distanceBottom),n.positioning.distanceLeft=t.convertPixelToPoint(i.positioning.distanceLeft),n.positioning.distanceRight=t.convertPixelToPoint(i.positioning.distanceRight),n.positioning.distanceTop=t.convertPixelToPoint(i.positioning.distanceTop),sf.base.isNullOrUndefined(i.positioning.verticalAlignment)||(n.positioning.verticalAlignment=i.positioning.verticalAlignment),sf.base.isNullOrUndefined(i.positioning.verticalOrigin)||(n.positioning.verticalOrigin=i.positioning.verticalOrigin),n.positioning.verticalPosition=i.positioning.verticalPosition,sf.base.isNullOrUndefined(i.positioning.horizontalAlignment)||(n.positioning.horizontalAlignment=i.positioning.horizontalAlignment),sf.base.isNullOrUndefined(i.positioning.horizontalOrigin)||(n.positioning.horizontalOrigin=i.positioning.horizontalOrigin),n.positioning.horizontalPosition=i.positioning.horizontalPosition)},n.prototype.createRow=function(n){var t={cells:[]};return t.rowFormat=this.writeRowFormat(n.rowFormat),n.hasOwnProperty("contentControlProperties")&&(t.contentControlProperties=this.contentControlProperty(n.contentControlProperties)),t},n.prototype.createCell=function(n){var t={blocks:[]};return t.cellFormat=this.writeCellFormat(n.cellFormat),t.columnIndex=n.columnIndex,n.hasOwnProperty("contentControlProperties")&&(t.contentControlProperties=this.contentControlProperty(n.contentControlProperties)),t},n.prototype.writeShading=function(n){var t={};return t.backgroundColor=n.hasValue("backgroundColor")?n.backgroundColor:void 0,t.foregroundColor=n.hasValue("foregroundColor")?n.foregroundColor:void 0,t.textureStyle=n.hasValue("textureStyle")?n.textureStyle:void 0,t},n.prototype.writeBorder=function(n){var t={};return t.color=n.hasValue("color")?n.color:void 0,t.hasNoneStyle=n.hasValue("hasNoneStyle")?n.hasNoneStyle:void 0,t.lineStyle=n.hasValue("lineStyle")?n.lineStyle:void 0,t.lineWidth=n.hasValue("lineWidth")?n.lineWidth:void 0,t.shadow=n.hasValue("shadow")?n.shadow:void 0,t.space=n.hasValue("space")?n.space:void 0,t},n.prototype.writeBorders=function(n){var t={};return t.top=this.writeBorder(n.top),t.left=this.writeBorder(n.left),t.right=this.writeBorder(n.right),t.bottom=this.writeBorder(n.bottom),t.diagonalDown=this.writeBorder(n.diagonalDown),t.diagonalUp=this.writeBorder(n.diagonalUp),t.horizontal=this.writeBorder(n.horizontal),t.vertical=this.writeBorder(n.vertical),t},n.prototype.writeCellFormat=function(n){var t={};return t.borders=this.writeBorders(n.borders),t.shading=this.writeShading(n.shading),t.topMargin=n.hasValue("topMargin")?n.topMargin:void 0,t.rightMargin=n.hasValue("rightMargin")?n.rightMargin:void 0,t.leftMargin=n.hasValue("leftMargin")?n.leftMargin:void 0,t.bottomMargin=n.hasValue("bottomMargin")?n.bottomMargin:void 0,t.preferredWidth=n.hasValue("preferredWidth")?n.preferredWidth:void 0,t.preferredWidthType=n.hasValue("preferredWidthType")?n.preferredWidthType:void 0,t.cellWidth=n.hasValue("cellWidth")?n.cellWidth:void 0,t.columnSpan=n.columnSpan,t.rowSpan=n.rowSpan,t.verticalAlignment=n.hasValue("verticalAlignment")?n.verticalAlignment:void 0,t},n.prototype.writeRowFormat=function(n){var t={},r=[],i;for(t.height=n.hasValue("height")?n.height:void 0,t.allowBreakAcrossPages=n.hasValue("allowBreakAcrossPages")?n.allowBreakAcrossPages:void 0,t.heightType=n.hasValue("heightType")?n.heightType:void 0,t.isHeader=n.hasValue("isHeader")?n.isHeader:void 0,t.borders=this.writeBorders(n.borders),t.gridBefore=n.gridBefore,t.gridBeforeWidth=n.hasValue("gridBeforeWidth")?n.gridBeforeWidth:void 0,t.gridBeforeWidthType=n.hasValue("gridBeforeWidthType")?n.gridBeforeWidthType:void 0,t.gridAfter=n.gridAfter,t.gridAfterWidth=n.hasValue("gridAfterWidth")?n.gridAfterWidth:void 0,t.gridAfterWidthType=n.hasValue("gridAfterWidthType")?n.gridAfterWidthType:void 0,t.leftMargin=n.hasValue("leftMargin")?n.leftMargin:void 0,t.topMargin=n.hasValue("topMargin")?n.topMargin:void 0,t.rightMargin=n.hasValue("rightMargin")?n.rightMargin:void 0,t.bottomMargin=n.hasValue("bottomMargin")?n.bottomMargin:void 0,t.leftIndent=n.hasValue("leftIndent")?n.leftIndent:void 0,i=0;i<n.revisions.length;i++)t.revisionIds=this.writeRowRevisions(n.revisions[i],r);return t},n.prototype.writeRowRevisions=function(n,t){return-1===this.selectedRevisionId.indexOf(n.revisionID)&&this.selectedRevisionId.push(n.revisionID),t.push(n.revisionID),t},n.prototype.writeTableFormat=function(n){var t={};return t.borders=this.writeBorders(n.borders),t.shading=this.writeShading(n.shading),t.cellSpacing=n.hasValue("cellSpacing")?n.cellSpacing:void 0,t.leftIndent=n.hasValue("leftIndent")?n.leftIndent:void 0,t.tableAlignment=n.hasValue("tableAlignment")?n.tableAlignment:void 0,t.topMargin=n.hasValue("topMargin")?n.topMargin:void 0,t.rightMargin=n.hasValue("rightMargin")?n.rightMargin:void 0,t.leftMargin=n.hasValue("leftMargin")?n.leftMargin:void 0,t.bottomMargin=n.hasValue("bottomMargin")?n.bottomMargin:void 0,t.preferredWidth=n.hasValue("preferredWidth")?n.preferredWidth:void 0,t.preferredWidthType=n.hasValue("preferredWidthType")?n.preferredWidthType:void 0,t.bidi=n.hasValue("bidi")?n.bidi:void 0,t.allowAutoFit=n.hasValue("allowAutoFit")?n.allowAutoFit:void 0,t},n.prototype.footnotes=function(n){for(var t=0;t<n.footnotes.separator.length;t++)this.seprators(n)},n.prototype.seprators=function(n){if(n.footnotes.separator.length>0){this.document.footnotes={};this.document.footnotes.separator=[];for(var t=0;t<n.footnotes.separator.length;t++)this.writeBlock(n.footnotes.separator[t],0,this.document.footnotes.separator)}if(n.footnotes.continuationSeparator.length>0)for(this.document.footnotes.continuationSeparator=[],t=0;t<n.footnotes.continuationSeparator.length;t++)this.writeBlock(n.footnotes.continuationSeparator[t],0,this.document.footnotes.continuationSeparator);if(n.footnotes.continuationNotice.length>0)for(this.document.footnotes.continuationNotice=[],t=0;t<n.footnotes.continuationNotice.length;t++)this.writeBlock(n.footnotes.continuationNotice[t],0,this.document.footnotes.continuationNotice)},n.prototype.endnotes=function(n){for(var t=0;t<this.documentHelper.endnotes.separator.length;t++)this.endnoteSeparator(n)},n.prototype.endnoteSeparator=function(n){if(n.endnotes.separator.length>0){this.document.endnotes={};this.document.endnotes.separator=[];for(var t=0;t<n.endnotes.separator.length;t++)this.writeBlock(n.endnotes.separator[t],0,this.document.endnotes.separator)}if(n.endnotes.continuationSeparator.length>0)for(this.document.endnotes.continuationSeparator=[],t=0;t<n.endnotes.continuationSeparator.length;t++)this.writeBlock(n.endnotes.continuationSeparator[t],0,this.document.endnotes.continuationSeparator);if(n.endnotes.continuationNotice.length>0)for(this.document.endnotes.continuationNotice=[],t=0;t<n.endnotes.continuationNotice.length;t++)this.writeBlock(n.endnotes.continuationNotice[t],0,this.document.endnotes.continuationNotice)},n.prototype.writeStyles=function(n){this.document.styles=[];for(var t=0;t<n.styles.length;t++)this.document.styles.push(this.writeStyle(n.styles.getItem(t)))},n.prototype.writeStyle=function(n){var t={};return t.name=n.name,"Paragraph"===n.type&&(t.type="Paragraph",t.paragraphFormat=this.writeParagraphFormat(n.paragraphFormat),t.characterFormat=this.writeCharacterFormat(n.characterFormat)),"Character"===n.type&&(t.type="Character",t.characterFormat=this.writeCharacterFormat(n.characterFormat)),sf.base.isNullOrUndefined(n.basedOn)||(t.basedOn=n.basedOn.name),sf.base.isNullOrUndefined(n.link)||(t.link=n.link.name),sf.base.isNullOrUndefined(n.next)||(t.next=n.next.name),t},n.prototype.writeRevisions=function(n){this.document.revisions=[];for(var t=0;t<n.owner.revisions.changes.length;t++)(this.isExport||!this.isExport&&-1!==this.selectedRevisionId.indexOf(n.owner.revisions.changes[t].revisionID))&&this.document.revisions.push(this.writeRevision(n.owner.revisions.changes[t]))},n.prototype.writeRevision=function(n){var t={};return t.author=n.author,t.date=n.date,t.revisionType=n.revisionType,t.revisionId=n.revisionID,t},n.prototype.writeComments=function(n){this.document.comments=[];for(var t=0;t<n.comments.length;t++)(this.isExport||!this.isExport&&-1!==this.selectedCommentsId.indexOf(this.documentHelper.comments[t].commentId))&&this.document.comments.push(this.writeComment(this.documentHelper.comments[t]))},n.prototype.writeCustomXml=function(n){var t,i,r,u;for(this.document.customXml=[],t=0;t<n.customXmlData.length;t++)i={},r=n.customXmlData.keys[t],i.itemID=r,u=this.documentHelper.customXmlData.get(r),i.xml=u,this.document.customXml.push(i)},n.prototype.writeComment=function(n){var t={},i;for(t.commentId=n.commentId,t.author=n.author,t.date=n.date,t.blocks=[],t.blocks.push(this.commentInlines(n.text)),t.done=n.isResolved,t.replyComments=[],i=0;i<n.replyComments.length;i++)t.replyComments.push(this.writeComment(n.replyComments[i]));return t},n.prototype.commentInlines=function(n){var t={};return t.inlines=[{text:n}],t},n.prototype.writeLists=function(n){var r=[],t,i,u;for(this.document.lists=[],t=0;t<n.lists.length;t++)i=n.lists[t],this.lists.indexOf(i.listId)>-1&&(this.document.lists.push(this.writeList(i)),r.indexOf(i.abstractListId)<0&&r.push(i.abstractListId));for(this.document.abstractLists=[],t=0;t<n.abstractLists.length;t++)u=n.abstractLists[t],r.indexOf(u.abstractListId)>-1&&this.document.abstractLists.push(this.writeAbstractList(u))},n.prototype.writeAbstractList=function(n){var i={},t;for(i.abstractListId=n.abstractListId,i.levels=[],t=0;t<n.levels.length;t++)i.levels[t]=this.writeListLevel(n.levels[t]);return i},n.prototype.writeList=function(n){var t={},i;for(t.abstractListId=n.abstractListId,t.levelOverrides=[],i=0;i<n.levelOverrides.length;i++)t.levelOverrides.push(this.writeLevelOverrides(n.levelOverrides[i]));return t.listId=n.listId,t},n.prototype.writeLevelOverrides=function(n){var t={};return t.levelNumber=n.levelNumber,n.overrideListLevel&&(t.overrideListLevel=this.writeListLevel(n.overrideListLevel)),t.startAt=n.startAt,t},n.prototype.writeListLevel=function(n){var t={};return t.characterFormat=this.writeCharacterFormat(n.characterFormat),t.paragraphFormat=this.writeParagraphFormat(n.paragraphFormat),t.followCharacter=n.followCharacter,t.listLevelPattern=n.listLevelPattern,t.numberFormat=n.numberFormat,t.restartLevel=n.restartLevel,t.startAt=n.startAt,t},n.prototype.getParentBlock=function(n){return n.isInsideTable&&(n=this.owner.documentHelper.layout.getParentTable(n)),n},n.prototype.destroy=function(){this.lists=void 0;this.endLine=void 0;this.startLine=void 0;this.endOffset=void 0;this.documentHelper=void 0},n}(),bu=function(){function n(n){this.documentHelper=n;this.optimizedHeightCollection={}}return n.prototype.getModuleName=function(){return"Optimized"},n.prototype.getkeyFromCharFormat=function(n){var t=n.fontFamily.toLocaleLowerCase();return n.bold&&(t+=";bold"),n.italic&&(t+=";italic"),t},n.prototype.getFontInfo=function(n){var t=document.createElement("div"),i,r,u;return t.setAttribute("style","position:absolute;top:-1000px;left:-1000px;opacity:0;font-size:0px;line-height:normal;"),i=1/window.devicePixelRatio,t.style.transform="scale("+i.toString()+","+i.toString()+")",t.innerHTML='<span style="font-size:0; font-family: '+n.fontFamily+'; display: inline-block;">m<\/span><span style="font-size:288pt; font-family: '+n.fontFamily+";"+(n.bold?"font-weight:bold;":"")+(n.italic?"font-style:italic;":"")+' display: inline-block;">m<\/span>',document.body.appendChild(t),r=t.firstChild.offsetTop/t.lastChild.offsetHeight,u=parseFloat((t.lastChild.offsetHeight/288).toFixed(2)),document.body.removeChild(t),{HeightFactor:u,BaselineFactor:r}},n.prototype.getHeightInternal=function(n){var r=this.getkeyFromCharFormat(n),t,i,u;return sf.base.isNullOrUndefined(this.optimizedHeightCollection[r])?(t=this.getFontInfo(n),this.optimizedHeightCollection[r]=t,{Height:i=t.HeightFactor*n.fontSize,BaselineOffset:t.BaselineFactor*i}):(u=this.optimizedHeightCollection[r],{Height:i=u.HeightFactor*n.fontSize,BaselineOffset:u.BaselineFactor*i})},n.prototype.destroy=function(){this.documentHelper=void 0;this.optimizedHeightCollection=void 0},n}(),ku=function(){function n(n){this.documentHelper=n}return n.prototype.getModuleName=function(){return"Regular"},n.prototype.getHeightInternal=function(n){var f,e,i=document.createElement("span"),t,r,u,o;return i.innerText="m",t=sf.base.createElement("iframe"),document.body.appendChild(t),sf.base.isNullOrUndefined(t.contentDocument)||(t.contentDocument.open(),t.contentDocument.write("<!DOCTYPE html><html><head><\/head><body><\/body><\/html>"),t.contentDocument.close()),this.applyStyle(i,n),r=document.createElement("div"),r.setAttribute("style","display:inline-block;position:absolute;"),u=document.createElement("div"),u.setAttribute("style","display:inline-block;width: 1px; height: 0px;vertical-align: baseline;"),r.appendChild(i),r.appendChild(u),t.contentDocument.body.appendChild(r),f=i.offsetHeight,o=i.offsetTop,e=u.offsetTop-o,document.body.removeChild(t),{Height:f,BaselineOffset:e}},n.prototype.applyStyle=function(n,t){var i,r;sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(t)||(i="white-space:nowrap;",""!==t.fontFamily&&(i+="font-family:"+t.fontFamily+";"),r=t.fontSize,r<=.5&&(r=.5),i+="font-size:"+r.toString()+"pt;",t.bold&&(i+="font-weight:bold;"),t.italic&&(i+="font-style:italic;"),n.setAttribute("style",i))},n.prototype.destroy=function(){this.documentHelper=void 0},n}(),yo=function(){function n(n,t,i){this.enableHeaderFooterIn=!1;this.isShiftingEnabled=!1;this.isLayoutEnabled=!0;this.isPastingContent=!1;this.parser=void 0;this.disableHistoryIn=!1;this.findResultsList=void 0;this.defaultLocale={};this.imageResizerModule=void 0;this.zoomFactor=1;this.dotNetRef=t;sf.base.isNullOrUndefined(n)||(n.blazor__instance=this);this.element=n;this.documentHelper=new lf(this);sf.base.isNullOrUndefined(i)||(this.options=i,this.updateOptions(i));this.viewer="Pages"===this.layoutType?new rt(this):new at(this)}return Object.defineProperty(n.prototype,"enableHeaderAndFooter",{get:function(){return this.enableHeaderFooterIn},set:function(n){this.enableHeaderFooterIn=n;!n&&this.selection&&this.selection.isWebLayout&&(this.selection.isWebLayout=!1);this.viewer.updateScrollBars()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageCount",{get:function(){return!this.isDocumentLoaded||sf.base.isNullOrUndefined(this.viewer)||_instanceof(this.viewer,at)?1:this.documentHelper.pages.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selection",{get:function(){return this.selectionModule},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"editor",{get:function(){return this.editorModule},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"editorHistory",{get:function(){return this.editorHistoryModule},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"search",{get:function(){return this.searchModule},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"spellChecker",{get:function(){return this.spellCheckerModule},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"containerId",{get:function(){return this.element.id},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isDocumentLoaded",{get:function(){return this.isDocumentLoadedIn},set:function(n){this.isDocumentLoadedIn=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"revisions",{get:function(){return sf.base.isNullOrUndefined(this.revisionsInternal)&&(this.revisionsInternal=new tf(this)),this.revisionsInternal},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"enableHistoryMode",{get:function(){return this.enableEditorHistory&&!sf.base.isNullOrUndefined(this.editorHistoryModule)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"documentStart",{get:function(){if(!sf.base.isNullOrUndefined(this.selectionModule))return this.selection.getDocumentStart()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"documentEnd",{get:function(){if(!sf.base.isNullOrUndefined(this.selectionModule))return this.selection.getDocumentEnd()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isReadOnlyMode",{get:function(){return this.isReadOnly||sf.base.isNullOrUndefined(this.editorModule)||sf.base.isNullOrUndefined(this.selectionModule)||!sf.base.isNullOrUndefined(this.editor)&&this.editor.restrictEditing},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isSpellCheck",{get:function(){return this.enableSpellCheck&&this.spellChecker.enableSpellCheck},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"enableImageResizerMode",{get:function(){return this.enableImageResizer&&!sf.base.isNullOrUndefined(this.imageResizerModule)},enumerable:!0,configurable:!0}),n.prototype.updateOptions=function(n){this.acceptTab=n.acceptTab;this.currentUser=n.currentUser;this.documentName=n.documentName;this.enableBookmarkDialog=n.enableBookmarkDialog;this.enableBordersAndShadingDialog=n.enableBordersAndShadingDialog;this.enableComment=n.enableComment;this.enableContextMenu=n.enableContextMenu;this.enableCursorOnReadOnly=n.enableCursorOnReadOnly;this.enableEditor=n.enableEditor;this.enableEditorHistory=n.enableEditorHistory;this.enableFontDialog=n.enableFontDialog;this.enableFormField=n.enableFormField;this.enableHyperlinkDialog=n.enableHyperlinkDialog;this.enableImageResizer=n.enableImageResizer;this.enableListDialog=n.enableListDialog;this.enableLocalPaste=n.enableLocalPaste;this.enableOptionsPane=n.enableOptionsPane;this.enablePageSetupDialog=n.enablePageSetupDialog;this.enableParagraphDialog=n.enableParagraphDialog;this.enablePrint=n.enablePrint;this.enableSearch=n.enableSearch;this.enableSelection=n.enableSelection;this.enableSfdtExport=n.enableSfdtExport;this.enableSpellCheck=n.enableSpellCheck;this.enableStyleDialog=n.enableStyleDialog;this.enableTableDialog=n.enableTableDialog;this.enableTableOfContentsDialog=n.enableTableOfContentsDialog;this.enableTableOptionsDialog=n.enableTableOptionsDialog;this.enableTextExport=n.enableTextExport;this.enableTrackChanges=n.enableTrackChanges;this.enableWordExport=n.enableWordExport;this.headers=n.headers?n.headers:[];this.height=n.height;this.isReadOnly=n.isReadOnly;this.pageGap=n.pageGap;this.pageOutline=n.pageOutline;this.serviceUrl=n.serviceUrl;this.showComments=n.showComments;this.showRevisions=n.showRevisions;this.useCtrlClickToFollowHyperlink=n.useCtrlClickToFollowHyperlink;this.userColor=n.userColor;this.width=n.width;this.zIndex=n.zIndex;this.zoomFactor=n.zoomFactor;this.layoutType=n.layoutType;this.defaultPasteOption=n.defaultPasteOption;this.documentEditorSettings=n.documentEditorSettings;this.serverActionSettings=n.serverActionSettings;this.requiredModules()},n.prototype.setOptions=function(n,t,i){for(var f=this,r=0,u=Object.keys(n);r<u.length;r++)switch(u[r]){case"zoomFactor":t.zoomFactor!=n.zoomFactor&&(this.zoomFactor=n.zoomFactor,this.documentHelper&&(this.documentHelper.zoomFactor=n.zoomFactor));break;case"layoutType":if(this.selection&&this.selection.isWebLayout)break;t.layoutType!=n.layoutType&&(this.layoutType=n.layoutType,this.viewer.destroy(),"Pages"===this.layoutType?this.viewer=new rt(this):(!0===this.enableHeaderAndFooter&&this.selection.closeHeaderFooter(),this.viewer=new at(this)),this.editor.layoutWholeDocument(),setTimeout(function(){f.fireViewChange()},200));break;case"isReadOnly":this.isReadOnly=n.isReadOnly;break;case"currentUser":t.currentUser!=n.currentUser&&(this.currentUser=n.currentUser,this.selection&&this.documentHelper.isDocumentProtected&&this.selection.highlightEditRegion());break;case"userColor":t.userColor!=n.userColor&&(this.userColor=n.userColor,this.selection&&this.documentHelper.isDocumentProtected&&this.selection.highlightEditRegion());break;case"pageGap":t.pageGap!=n.pageGap&&(this.pageGap=n.pageGap,this.viewer.updateScrollBars());break;case"pageOutline":t.pageOutline!=n.pageOutline&&(this.pageOutline=n.pageOutline,this.viewer.updateScrollBars());break;case"showRevisions":this.isReadOnly||this.documentHelper.isDocumentProtected?(this.showRevisions=!1,this.documentHelper.showRevisions(!1)):this.viewer&&this.documentHelper.showRevisions(n.showRevisions);break;case"documentEditorSettings":this.documentEditorSettings=t.documentEditorSettings;this.textMeasureHelper=t.documentEditorSettings.enableOptimizedTextMeasuring?new bu(this.documentHelper):new ku(this.documentHelper);this.viewer.updateScrollBars();break;case"height":t.height!=n.height&&(this.height=n.height,this.element.style.height=sf.base.formatUnit(this.height),this.resize());break;case"width":t.width!=n.width&&(this.width=n.width,this.element.style.width=sf.base.formatUnit(this.width),this.resize())}i&&this.updateOptions(n)},n.prototype.preRender=function(){this.findResultsList=[]},n.prototype.render=function(){if(!sf.base.isNullOrUndefined(this.element)){var n=this.element;n.style.minHeight="200px";n.style.minWidth="200px";this.element.style.height=sf.base.formatUnit(this.height);""!==this.width&&(this.element.style.width=sf.base.formatUnit(this.width))}this.documentHelper.initializeComponents();this.openBlank()},n.prototype.onPropertyChanged=function(n){for(var r=this,t=0,i=Object.keys(n);t<i.length;t++)switch(i[t]){case"zoomFactor":this.viewer&&(this.documentHelper.zoomFactor=n.zoomFactor);break;case"layoutType":if(this.selection&&this.selection.isWebLayout)break;this.viewer.destroy();"Pages"===this.layoutType?this.viewer=new rt(this):(!0===this.enableHeaderAndFooter&&this.selection.closeHeaderFooter(),this.viewer=new at(this));this.editor.layoutWholeDocument();setTimeout(function(){r.fireViewChange()},200);break;case"isReadOnly":this.isReadOnly=n.isReadOnly;break;case"currentUser":case"userColor":this.selection&&this.documentHelper.isDocumentProtected&&this.selection.highlightEditRegion();break;case"pageGap":case"pageOutline":this.viewer.updateScrollBars();break;case"showComments":this.viewer&&this.documentHelper.showComments(n.showComments);break;case"enableComment":this.viewer&&this.showComments&&(this.showComments=!!this.showComments&&this.enableComment,this.documentHelper.showComments(n.enableComment));this.viewer.updateScrollBars();break;case"showRevisions":this.viewer&&this.documentHelper.showRevisions(n.showRevisions);this.viewer.updateScrollBars();break;case"documentEditorSettings":this.viewer.updateScrollBars();break;case"height":this.element.style.height=sf.base.formatUnit(this.height);this.resize();break;case"width":this.element.style.width=sf.base.formatUnit(this.width);this.resize()}},n.prototype.setDefaultCharacterFormat=function(n){this.characterFormat=n},n.prototype.setDefaultParagraphFormat=function(n){this.paragraphFormat=n},n.prototype.setDefaultSectionFormat=function(n){this.sectionFormat=n},n.prototype.getPersistData=function(){return"documenteditor"},n.prototype.clearPreservedCollectionsInViewer=function(){_instanceof(this.viewer,cr)&&this.documentHelper.clearDocumentItems()},n.prototype.getDocumentEditorElement=function(){return this.element},n.prototype.fireContentChange=function(){var n=this;this.contentChangeTimer&&clearTimeout(this.contentChangeTimer);this.contentChangeTimer=setTimeout(function(){var t={canUndo:n.editorHistory.canUndo(),canRedo:n.editorHistory.canRedo(),pageCount:n.pageCount};n.dotNetRef.invokeMethodAsync("ContentChangeInternal",t)},200);this.dotNetRef.invokeMethodAsync("ContentChange")},n.prototype.fireDocumentChange=function(){var t=this,n;this.documentChangeTimer&&clearTimeout(this.documentChangeTimer);n={enableTrackChanges:this.enableTrackChanges};this.documentChangeTimer=setTimeout(function(){t.dotNetRef.invokeMethodAsync("DocumentChangeInternal",n)},200);this.dotNetRef.invokeMethodAsync("DocumentChange",n);this.dotNetRef.invokeMethodAsync("UpdateCommentsCollection",this.fetchComments())},n.prototype.showFormFieldPopup=function(n){this.dotNetRef.invokeMethodAsync("ShowFormFieldPopup",n.type,JSON.stringify(n),!0)},n.prototype.hideFormFieldPopup=function(){this.dotNetRef.invokeMethodAsync("ShowFormFieldPopup","","",!1)},n.prototype.fireSelectionChange=function(){var t=this,n;(!this.documentHelper.isCompositionStart&&sf.base.Browser.isDevice&&this.editorModule&&this.editorModule.predictText(),this.editor&&this.editor.isInsertingTOC)||(n={source:sf.base.isBlazor()?null:this},sf.base.EventHandler.trigger(this.element,"selectionChange",n),this.selectionTimer&&clearTimeout(this.selectionTimer),this.selectionTimer=setTimeout(function(){t.fireSelectionChangeInternal()},200),this.dotNetRef.invokeMethodAsync("SelectionChange"))},n.prototype.fireSelectionChangeInternal=function(){this.dotNetRef.invokeMethodAsync("SelectionChangeInternal",this.getCurrentContext())},n.prototype.isContentProtected=function(){var n=this.documentHelper.isDocumentProtected,t=!1,i=!1,r="NoProtection";return n&&(t=n&&this.documentHelper.restrictFormatting,i=this.editor.restrictEditing,r=this.documentHelper.protectionType),{isDocumentProtected:n,allowFormatting:t,isInProtectecRegion:i,isReadOnly:this.isReadOnly,protectionType:r}},n.prototype.getCurrentContext=function(){var t={},c,u,o,l,f;t.characterFormat=this.fetchCharacterFormat(this.selection.characterFormat);t.paragraphFormat=this.fetchParagraphFormat(this.selection.paragraphFormat);t.sectionFormat=this.fetchSectionFormat(this.selection.sectionFormat);this.selection.contextType.indexOf("Table")>=0&&(t.tableFormat=this.fetchTableFormat(this.selection.tableFormat),t.rowFormat=this.fetchRowFormat(this.selection.rowFormat),t.cellFormat=this.fetchCellFormat(this.selection.cellFormat));this.selection.contextType.indexOf("Image")>=0&&(t.imageFormat=this.fetchImageFormat());var n={},s=this.selection.contextType,i=this.documentHelper.selection,h=!1,e=i.getHyperlinkField();return n.isHideComment=this.documentHelper.owner.isReadOnlyMode||this.documentHelper.owner.enableHeaderAndFooter||!this.documentHelper.owner.enableComment,_instanceof(e,r)&&i.isReferenceField(e)&&(h=!0,"FormFieldsOnly"!==this.documentHelper.protectionType&&this.documentHelper.owner.isReadOnlyMode||(n.canUpdateField=!0)),n.contextType=s,n.isReadOnly=this.documentHelper.owner.isReadOnlyMode,c=this.selection.isEmpty,(n.isEmpty=c,"TableOfContents"===s)?n.isTableOfContents=!0:(u=i.start,o=i.end,"List"===i.contextType&&"Bullet"!==i.getListLevel(u.paragraph).listLevelPattern&&(n.isList=!0),l=u.paragraph.isInsideTable&&(!o.paragraph.isInsideTable||u.paragraph.associatedCell!==o.paragraph.associatedCell||this.documentHelper.selection.isCellSelected(u.paragraph.associatedCell,u,o)),(n.isHyperlinkEnabled=!!l,n.editHyperLink=_instanceof(e,r)&&!i.isImageField()&&!h?!0:!1,n.formFieldType="",i.isFormField())&&(f=this.documentHelper.selection.getCurrentFormField(),_instanceof(f,r)&&(_instanceof(f.formFieldData,vt)?n.formFieldType="Text":_instanceof(f.formFieldData,bt)?n.formFieldType="CheckBox":_instanceof(f.formFieldData,kt)&&(n.formFieldType="DropDown"))),_instanceof(e,r)&&h&&(n.canUpdateField=!0)),this.documentHelper.owner.selection.start.paragraph.isInsideTable&&this.documentHelper.owner.selection.end.paragraph.isInsideTable?(n.isTable=!0,this.editor.canMergeCells()&&(n.canMergeCells=!0),n.isTableSelected=this.documentHelper.selection.isTableSelected()):n.isFont="Image"!==s,this.enableTrackChanges&&this.documentHelper.selection.hasRevisions()&&(n.canAcceptChange=!0),n.isElementBox=this.isSpellCheck&&this.hasElementBox(),t.selectionContext=n,t.protectionInfo=this.isContentProtected(),t},n.prototype.fetchImageFormat=function(){var n={};return n.width=this.selection.imageFormat.width,n.height=this.selection.imageFormat.height,n},n.prototype.fetchCharacterFormat=function(n){var t={};return t.bold=n.bold,t.fontSize=n.fontSize,t.fontFamily=n.fontFamily,t.italic=n.italic,t.baselineAlignment=n.baselineAlignment,t.underline=n.underline,t.fontColor=n.fontColor,t.highlightColor=n.highlightColor,t.strikethrough=n.strikethrough,t.allCaps=n.allCaps,t},n.prototype.fetchParagraphFormat=function(n){var t={};return t.leftIndent=n.leftIndent,t.rightIndent=n.rightIndent,t.firstLineIndent=n.firstLineIndent,t.lineSpacing=n.lineSpacing,t.lineSpacingType=n.lineSpacingType,t.textAlignment=n.textAlignment,t.beforeSpacing=n.beforeSpacing,t.afterSpacing=n.afterSpacing,t.bidi=n.bidi,t.keepWithNext=n.keepWithNext,t.keepLinesTogether=n.keepLinesTogether,t.widowControl=n.widowControl,t.contextualSpacing=n.contextualSpacing,t.styleName=n.styleName,sf.base.isNullOrUndefined(n.listFormat)||(t.listFormat=this.fetchListFormat(n.listFormat)),t},n.prototype.fetchListFormat=function(n){var t={},r=n.getValue("listId"),i;return sf.base.isNullOrUndefined(r)||(t.listId=r),i=n.getValue("listLevelNumber"),sf.base.isNullOrUndefined(i)||(t.listLevelNumber=i),t},n.prototype.fetchTableFormat=function(n){var t={};return t.topMargin=n.topMargin,t.bottomMargin=n.bottomMargin,t.leftMargin=n.leftMargin,t.rightMargin=n.rightMargin,t.leftIndent=n.leftIndent,t.background=n.background,t.tableAlignment=n.tableAlignment,t.cellSpacing=n.cellSpacing,t.bidi=n.bidi,t.preferredWidth=n.preferredWidth,t.preferredWidthType=n.preferredWidthType,t.borders=this.getTableBorder(),t.shading=this.getTableShading(),t},n.prototype.fetchCellFormat=function(n){var t={};return t.topMargin=n.topMargin,t.bottomMargin=n.bottomMargin,t.leftMargin=n.leftMargin,t.rightMargin=n.rightMargin,t.verticalAlignment=n.verticalAlignment,t.background=n.background,t.preferredWidth=n.preferredWidth,t.preferredWidthType=n.preferredWidthType,t.canMerge=this.editor.canMergeCells(),t.borders=this.getCellBorder(),t.shading=this.getCellShading(),t},n.prototype.fetchRowFormat=function(n){var t={};return t.allowBreakAcrossPages=n.allowBreakAcrossPages,t.height=n.height,t.heightType=n.heightType,t.isHeader=n.isHeader,t},n.prototype.fetchList=function(n){var t={};return t.listId=n.listId,t.sourceListId=n.sourceListId,t.abstractListId=n.abstractListId,t.listLength=this.documentHelper.lists.length,t.abstractLength=this.documentHelper.abstractLists.length,JSON.stringify(t)},n.prototype.hasElementBox=function(){var n=!1;return this.errorElementInfo=this.spellChecker.findCurretText(),this.errorElementInfo.element&&(n=!0,this.spellChecker.currentContextInfo=this.errorElementInfo,this.errorElementInfo=this.spellChecker.retriveText()),n},n.prototype.fetchSectionFormat=function(n){var t={};return t.topMargin=n.topMargin,t.bottomMargin=n.bottomMargin,t.leftMargin=n.leftMargin,t.rightMargin=n.rightMargin,t.pageHeight=n.pageHeight,t.pageWidth=n.pageWidth,t.footerDistance=n.footerDistance,t.headerDistance=n.headerDistance,t.differentFirstPage=n.differentFirstPage,t.differentOddAndEvenPages=n.differentOddAndEvenPages,t},n.prototype.fetchStyleValue=function(n){var t={};return t.name=n.name,t.type=n.type,t.paragraphFormat=this.fetchParagraphFormat(n.paragraphFormat),t.characterFormat=this.fetchCharacterFormat(n.characterFormat),sf.base.isNullOrUndefined(n.next)||(t.next=n.next.name),sf.base.isNullOrUndefined(n.basedOn)||(t.basedOn=n.basedOn.name),sf.base.isNullOrUndefined(n.link)||(t.link=n.link.name),JSON.stringify(t)},n.prototype.fetchComments=function(){var n=this.getComments();return!sf.base.isNullOrUndefined(n)&&n.length>0?JSON.stringify(n):""},n.prototype.getComments=function(n){var e=[],r=n||this.documentHelper.comments,u,i,t,f;if(!sf.base.isNullOrUndefined(r)&&r.length>0){for(u=0;u<r.length;u++)i={},t=r[u],(i.date=t.date,i.text=t.text,i.isReply=t.isReply,i.isResolved=t.isResolved,i.author=t.author,i.initial=t.initial,i.commentId=t.commentId,i.userColor=this.documentHelper.getAuthorColor(t.author),t.ownerComment&&t.ownerComment.commentId&&(i.ownerCommentId=t.ownerComment.commentId),n)||(f=this.getComments(t.replyComments),f&&f.length>0&&(i.replyComments=f)),e.push(i);return e}},n.prototype.getCellBorder=function(){if(!sf.base.isNullOrUndefined(this.selection.start.paragraph.associatedCell)){var n=this.selection.start.paragraph.associatedCell.cellFormat.borders;return this.sfdtExportModule.writeBorders(n)}return{}},n.prototype.getTableBorder=function(){if(!sf.base.isNullOrUndefined(this.selection.tableFormat.table)){var n=this.selection.tableFormat.table.tableFormat.borders;return this.sfdtExportModule.writeBorders(n)}return{}},n.prototype.getCellShading=function(){var n={},t;return sf.base.isNullOrUndefined(this.selection.tableFormat.table)||(t=this.selection.start.paragraph.associatedCell.cellFormat.shading,n.backgroundColor=t.backgroundColor,n.foregroundColor=t.foregroundColor,n.textureStyle=t.textureStyle),n},n.prototype.getTableShading=function(){var n={},t;return sf.base.isNullOrUndefined(this.selection.start.paragraph.associatedCell)||(t=this.selection.start.paragraph.associatedCell.cellFormat.shading,n.backgroundColor=t.backgroundColor,n.foregroundColor=t.foregroundColor,n.textureStyle=t.textureStyle),n},n.prototype.applyCellOption=function(n){if(this.documentHelper.owner.editorHistory.initComplexHistory(this.documentHelper.selection,"CellMarginsSelection"),this.documentHelper.owner.editorModule.initHistory("CellOptions"),!sf.base.isNullOrUndefined(this.documentHelper.selection.start.paragraph.associatedCell)){var t=this.documentHelper.selection.start.paragraph.associatedCell.ownerTable;t=t.combineWidget(this.viewer);this.applyCellmarginsValue(this.documentHelper.selection.start.paragraph.associatedCell.ownerRow.combineWidget(this.viewer),this.documentHelper.selection.start,this.documentHelper.selection.end,n);this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection,!1);sf.base.isNullOrUndefined(this.documentHelper.owner.editorHistory.currentHistoryInfo)||this.documentHelper.owner.editorHistory.updateComplexHistory()}},n.prototype.applyCellmarginsValue=function(n,t,i,r){if(this.applyCellMarginsInternal(n,r),i.paragraph.associatedCell.ownerRow!==n){var u=n.nextWidget;sf.base.isNullOrUndefined(u)||this.applyCellmarginsValue(u,t,i,r)}},n.prototype.applyCellMarginsInternal=function(n,t){if(!sf.base.isNullOrUndefined(this.documentHelper.owner.editorHistory.currentBaseHistoryInfo)){var i=n.childWidgets[0].cellFormat;t=this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.addModifiedCellOptions(i,t,n.ownerTable)}sf.base.isNullOrUndefined(t)||this.applyCellMarginsForCells(n,t)},n.prototype.applyCellMarginsForCells=function(n,t){for(var i=n.childWidgets,r=0;r<i.length;r++)this.applySubCellMargins(i[r].cellFormat,t);this.calculateGridValue(i[0].ownerTable)},n.prototype.applySubCellMargins=function(n,t){n.leftMargin=t.leftMargin;n.topMargin=t.topMargin;n.rightMargin=t.rightMargin;n.bottomMargin=t.bottomMargin},n.prototype.calculateGridValue=function(n){n.calculateGrid();n.isGridUpdated=!1;n.buildTableColumns();n.isGridUpdated=!0;this.documentHelper.selection.owner.isLayoutEnabled=!0;this.documentHelper.layout.reLayoutTable(n);this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection);this.documentHelper.owner.editorModule.updateSelectionTextPosition(!0);var t=this.documentHelper.owner.editorHistory;t&&t.currentBaseHistoryInfo&&(t.currentBaseHistoryInfo.modifiedProperties.length>0&&t.currentBaseHistoryInfo.updateSelection(),t.updateHistory());this.documentHelper.owner.editorModule.fireContentChange()},n.prototype.applyTableOption=function(n){if(this.documentHelper.owner.editorHistory.initComplexHistory(this.documentHelper.selection,"TableMarginsSelection"),this.documentHelper.owner.editorModule.initHistory("TableOptions"),!sf.base.isNullOrUndefined(this.documentHelper.selection.start.currentWidget.paragraph.associatedCell)){var i=this.documentHelper.selection.start.currentWidget.paragraph.associatedCell.ownerTable,t=(i=i.combineWidget(this.viewer)).tableFormat;sf.base.isNullOrUndefined(this.documentHelper.owner.editorHistory.currentBaseHistoryInfo)||this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.addModifiedTableOptions(t);t.cellSpacing=n.cellSpacing;t.leftMargin=n.leftMargin;t.topMargin=n.topMargin;t.rightMargin=n.rightMargin;t.bottomMargin=n.bottomMargin;this.calculateGridValue(i);sf.base.isNullOrUndefined(this.documentHelper.owner.editorHistory.currentHistoryInfo)||this.documentHelper.owner.editorHistory.updateComplexHistory()}},n.prototype.applyTableProperties=function(n,t,i){this.documentHelper.owner.editorModule.initComplexHistory("TableProperties");this.documentHelper.owner.editorModule.onTableFormat(n);this.documentHelper.owner.editorModule.onRowFormat(t);this.documentHelper.owner.editorModule.onCellFormat(i);this.documentHelper.owner.editorHistory.updateComplexHistory()},n.prototype.enableRepeatHeader=function(){var n=this.documentHelper.selection,i=n.start,r=n.end,t,u;return n.isForward||(i=n.end,r=n.start),t=i.paragraph.associatedCell,u=r.paragraph.associatedCell,0===t.ownerRow.index&&u.ownerTable.equals(t.ownerTable)},n.prototype.fireZoomFactorChange=function(){this.dotNetRef.invokeMethodAsync("ZoomFactorChange",this.documentHelper.zoomFactor)},n.prototype.fireBeformFieldFill=function(){},n.prototype.fireAfterFormFieldFill=function(){},n.prototype.fireServiceFailure=function(){},n.prototype.fireViewChange=function(){if(this.viewer&&this.documentHelper.pages.length>0&&this.viewer.visiblePages.length>0){var n=this.viewer.visiblePages,t={startPage:n[0].index+1,endPage:n[n.length-1].index+1};this.dotNetRef.invokeMethodAsync("ViewChange",JSON.stringify(t))}},n.prototype.fireCustomContextMenuSelect=function(){},n.prototype.fireCustomContextMenuBeforeOpen=function(){},n.prototype.showParagraphDialog=function(){},n.prototype.showPageSetupDialog=function(){},n.prototype.showFontDialog=function(){},n.prototype.showCellOptionsDialog=function(){},n.prototype.showTableOptionsDialog=function(){},n.prototype.showTableDialog=function(){},n.prototype.showTableOfContentsDialog=function(){},n.prototype.showStyleDialog=function(){},n.prototype.showHyperlinkDialog=function(){},n.prototype.showBookmarkDialog=function(){},n.prototype.showStylesDialog=function(){},n.prototype.showListDialog=function(){},n.prototype.showTablePropertiesDialog=function(){},n.prototype.showBordersAndShadingDialog=function(){},n.prototype.requiredModules=function(){this.parser=new oe(this.documentHelper);this.enablePrint&&sf.base.isNullOrUndefined(this.printModule)&&(this.printModule=new du);(this.enableSfdtExport||this.enableWordExport||this.enableTextExport||this.enableSelection||this.enableEditor)&&sf.base.isNullOrUndefined(this.sfdtExportModule)&&(this.sfdtExportModule=new wu(this.documentHelper));this.enableWordExport&&sf.base.isNullOrUndefined(this.wordExportModule)&&(this.wordExportModule=new ao);this.enableTextExport&&sf.base.isNullOrUndefined(this.textExportModule)&&(this.textExportModule=new vo);(this.enableSelection||this.enableSearch||this.enableEditor)&&(sf.base.isNullOrUndefined(this.selectionModule)&&(this.selectionModule=new pe(this)),this.enableContextMenu);this.enableSearch&&(sf.base.isNullOrUndefined(this.searchModule)&&(this.searchModule=new ge(this)),this.enableOptionsPane&&sf.base.isNullOrUndefined(this.optionsPaneModule)&&(this.optionsPaneModule=new no));sf.base.isNullOrUndefined(this.documentEditorSettings)||(this.textMeasureHelper=this.documentEditorSettings.enableOptimizedTextMeasuring?new bu(this.documentHelper):new ku(this.documentHelper));this.enableEditor&&(sf.base.isNullOrUndefined(this.editorModule)&&(this.editorModule=new so(this.documentHelper)),this.enableImageResizer&&sf.base.isNullOrUndefined(this.imageResizerModule)&&(this.imageResizerModule=new ho(this,this.documentHelper)),this.enableEditorHistory&&sf.base.isNullOrUndefined(this.editorHistoryModule)&&(this.editorHistoryModule=new eo(this)),this.enableHyperlinkDialog,this.enableTableDialog,this.enableBookmarkDialog,this.enableTableOfContentsDialog,this.enablePageSetupDialog,this.enableStyleDialog,this.enableListDialog,this.enableParagraphDialog,this.enableFontDialog,this.enableTablePropertiesDialog,this.enableBordersAndShadingDialog,this.enableTableOptionsDialog,this.enableSpellCheck,this.enableFormField)},n.prototype.open=function(n){sf.base.isNullOrUndefined(this.viewer)||(this.showComments=!1,this.clearPreservedCollectionsInViewer(),this.documentHelper.userCollection.push("Everyone"),this.documentHelper.lists=[],this.documentHelper.abstractLists=[],this.documentHelper.styles=new pr,this.documentHelper.cachedPages=[],this.showRevisions=!1,this.isSpellCheck&&!this.spellChecker.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading=!0,this.documentHelper.triggerSpellCheck=!0),!sf.base.isNullOrUndefined(n)&&this.viewer&&(this.documentHelper.setDefaultDocumentFormat(),this.documentHelper.onDocumentChanged(this.parser.convertJsonToDocument(n)),this.editorModule&&this.editorModule.intializeDefaultStyles()),this.isSpellCheck&&!this.spellChecker.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading=!1,this.documentHelper.triggerSpellCheck=!1))},n.prototype.scrollToPage=function(n){return!(sf.base.isNullOrUndefined(this.viewer)||n<1||n>this.documentHelper.pages.length)&&(this.viewer.scrollToPage(n-1),!0)},n.prototype.enableAllModules=function(){this.enablePrint=this.enableSfdtExport=this.enableWordExport=this.enableTextExport=this.enableSelection=this.enableContextMenu=this.enableSearch=this.enableOptionsPane=this.enableEditor=this.enableImageResizer=this.enableEditorHistory=this.enableHyperlinkDialog=this.enableTableDialog=this.enableBookmarkDialog=this.enableTableOfContentsDialog=this.enablePageSetupDialog=this.enableStyleDialog=this.enableListDialog=this.enableParagraphDialog=this.enableFontDialog=this.enableTablePropertiesDialog=this.enableBordersAndShadingDialog=this.enableTableOptionsDialog=this.enableComment=this.enableFormField=!0;this.requiredModules()},n.prototype.resize=function(n,t){this.element&&(!sf.base.isNullOrUndefined(n)&&n>200&&(this.element.style.width=n+"px"),!sf.base.isNullOrUndefined(t)&&t>200&&(this.element.style.height=t+"px"));this.documentHelper&&this.documentHelper.updateViewerSize()},n.prototype.getFormFieldNames=function(){for(var i=[],t=this.documentHelper.formFields,n=0;n<t.length;n++)""!==t[n].formFieldData.name&&i.push(t[n].formFieldData.name);return i},n.prototype.getFormFieldInfo=function(n){for(var i=this.documentHelper.formFields,t=0;t<i.length;t++)if(i[t].formFieldData.name===n&&""!==i[t].formFieldData.name)return i[t].formFieldData.getFormFieldInfo()},n.prototype.setFormFieldInfo=function(n,t){for(var u,r=this.documentHelper.formFields,i=0;i<r.length;i++)if(r[i].formFieldData.name===n&&""!==r[i].formFieldData.name)return u=r[i],void(this.selection&&(this.selection.selectFieldInternal(u),this.editor&&this.editor.setFormField(u,t)))},n.prototype.resetFormFields=function(n){for(var i=this.documentHelper.formFields,t=0;t<i.length;t++)(sf.base.isNullOrUndefined(n)||n===i[t].formFieldData.name)&&(_instanceof(i[t].formFieldData,vt)?this.editor.updateFormField(i[t],i[t].formFieldData.defaultValue,!0):_instanceof(i[t].formFieldData,bt)?this.editor.toggleCheckBoxFormField(i[t],!0,i[t].formFieldData.defaultValue):_instanceof(i[t].formFieldData,kt)&&this.editor.updateFormField(i[t],0,!0))},n.prototype.importFormData=function(n){for(var t=this.documentHelper.formFields,r=0;r<n.length;r++)for(var u=n[r],f=u.fieldName,i=0;i<t.length;i++)t[i].formFieldData.name===f&&(_instanceof(t[i].formFieldData,bt)?this.editor.toggleCheckBoxFormField(t[i],!0,u.value):(_instanceof(t[i].formFieldData,vt)||_instanceof(t[i].formFieldData,kt))&&this.editor.updateFormField(t[i],u.value))},n.prototype.exportFormData=function(){for(var i,r,f,u=[],t=this.documentHelper.formFields,n=0;n<t.length;n++)""!==t[n].formFieldData.name&&(i={fieldName:"",value:""},(i.fieldName=t[n].formFieldData.name,_instanceof(t[n].formFieldData,bt))?i.value=t[n].formFieldData.checked:_instanceof(t[n].formFieldData,vt)?(r="",f=new RegExp(this.documentHelper.textHelper.getEnSpaceCharacter(),"gi"),""===r.replace(f,"")&&(r=""),i.value=r):_instanceof(t[n].formFieldData,kt)&&(i.value=t[n].formFieldData.selectedIndex),u.push(i));return u},n.prototype.updateFields=function(){for(var t,n=0;n<this.documentHelper.fields.length;n++)t=this.documentHelper.fields[n],0===this.selection.getFieldCode(t).toLowerCase().trim().indexOf("ref ")&&this.selection.updateRefField(t)},n.prototype.focusIn=function(){this.viewer&&this.documentHelper.updateFocus()},n.prototype.fitPage=function(n){sf.base.isNullOrUndefined(n)&&(n="None");this.viewer&&(this.viewer.pageFitType=n)},n.prototype.print=function(n){if(sf.base.isNullOrUndefined(this.viewer))throw new Error("Invalid operation.");if(!this.printModule)throw new Error("Invalid operation. Print is not enabled.");"Continuous"===this.layoutType?(this.documentHelper.isWebPrinting=!0,this.viewer=new rt(this),this.editor.layoutWholeDocument(),this.printModule.print(this.documentHelper,n),this.viewer=new at(this),this.editor.layoutWholeDocument(),this.documentHelper.isWebPrinting=!1):this.printModule.print(this.documentHelper,n)},n.prototype.serialize=function(){if(!(this.enableSfdtExport&&_instanceof(this.sfdtExportModule,wu)))throw new Error("Invalid operation. Sfdt export is not enabled.");return this.sfdtExportModule.serialize()},n.prototype.save=function(n,t){if(n=n||"Untitled",sf.base.isNullOrUndefined(this.documentHelper))throw new Error("Invalid operation.");if("Docx"===t&&this.wordExportModule)this.wordExportModule&&this.wordExportModule.save(this.documentHelper,n);else if("Txt"===t&&this.textExportModule)this.textExportModule.save(this.documentHelper,n);else{if("Sfdt"!==t||!this.enableSfdtExport||!this.sfdtExportModule)throw new Error("Invalid operation. Specified export is not enabled.");var i=this.serialize(),r=new Blob([i],{type:"application/json"});sf.fileutils.Save.save(n+".sfdt",r)}},n.prototype.saveAsBlob=function(n){var t=this;if(sf.base.isNullOrUndefined(this.viewer))throw new Error("Invalid operation");return new Promise(function(i){"Docx"===n&&t.wordExportModule?i(t.wordExportModule.saveAsBlob(t.documentHelper)):"Txt"===n&&t.textExportModule?i(t.textExportModule.saveAsBlob(t.documentHelper)):"Sfdt"===n&&t.enableSfdtExport&&t.sfdtExportModule&&i(t.sfdtExportModule.saveAsBlob(t.documentHelper))})},n.prototype.openBlank=function(){var t=new c,n,i,f,r;if(t.index=0,t.sectionFormat=new dt(t),this.sectionFormat&&this.parser.parseSectionFormat(this.sectionFormat,t.sectionFormat),n=new u,n.index=0,n.paragraphFormat=new ut(n),n.characterFormat=new p(n),t.childWidgets.push(n),n.containerWidget=t,i=[],i.push(t),f=this.parser.parseHeaderFooter({header:{},footer:{},evenHeader:{},evenFooter:{},firstPageHeader:{},firstPageFooter:{}},void 0),this.viewer){(this.clearPreservedCollectionsInViewer(),this.documentHelper.userCollection.push("Everyone"),this.documentHelper.cachedPages=[],this.documentHelper.setDefaultDocumentFormat(),this.documentHelper.headersFooters.push(f),this.editorModule)&&(this.editorModule.intializeDefaultStyles(),r=this.documentHelper.styles.findByName("Normal"),n.paragraphFormat.baseStyle=r,n.paragraphFormat.listFormat.baseStyle=r);this.documentHelper.onDocumentChanged(i)}},n.prototype.getStyleNames=function(n){return this.viewer?this.documentHelper.styles.getStyleNames(n):[]},n.prototype.getStyles=function(n){return this.viewer?this.documentHelper.styles.getStyles(n):[]},n.prototype.getBookmarks=function(){var n=[];return this.viewer&&(n=this.documentHelper.getBookmarks(!0)),n},n.prototype.showDialog=function(n){this.dotNetRef.invokeMethodAsync("ShowDialog",n)},n.prototype.showOptionsPane=function(){},n.prototype.showRestrictEditingPane=function(){},n.prototype.destroy=function(){this.destroyDependentModules();sf.base.isNullOrUndefined(this.documentHelper)||this.documentHelper.destroy();this.viewer=void 0;this.findResultsList=[];this.findResultsList=void 0},n.prototype.destroyDependentModules=function(){this.printModule&&(this.printModule.destroy(),this.printModule=void 0);this.sfdtExportModule&&(this.sfdtExportModule.destroy(),this.sfdtExportModule=void 0);this.optionsPaneModule&&(this.optionsPaneModule=void 0);this.trackChangesPane&&(this.trackChangesPane.destroy(),this.trackChangesPane=void 0);this.searchModule&&(this.searchModule.destroy(),this.searchModule=void 0);this.editorModule&&(this.editorModule.destroy(),this.editorModule=void 0);this.selectionModule&&(this.selectionModule.destroy(),this.selectionModule=void 0);this.editorHistoryModule&&(this.editorHistoryModule.destroy(),this.editorHistoryModule=void 0);this.textExportModule&&(this.textExportModule.destroy(),this.textExportModule=void 0);this.wordExportModule&&(this.wordExportModule.destroy(),this.wordExportModule=void 0);this.spellCheckerModule&&(this.spellCheckerModule.destroy(),this.spellCheckerModule=void 0)},n}(),di=function(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(n){f(n)}}function s(n){try{e(r.throw(n))}catch(n){f(n)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})},gi=function(n,t){function o(e){return function(o){return function(e){if(f)throw new TypeError("Generator is already executing.");for(;r;)try{if(f=1,u&&(i=2&e[0]?u.return:e[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;switch(u=0,i&&(e=[2&e[0],i.value]),e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==e[0]&&2!==e[0])){r=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(6===e[0]&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(n){e=[6,n];u=0}finally{f=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,o])}}var f,u,i,e,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:o(0),"throw":o(1),"return":o(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e};return{sendHandler:null,info:null,isSpellChecking:null,elementRef:null,dotnetRef:null,initialize:function(n,t,i){sf.base.enableBlazorMode();var r=new yo(n,i,t);r.preRender();r.render();this.elementRef=n;this.dotnetRef=i;this.sendHandler=bi.prototype.send;bi.prototype.send=this.docEditRequestHandler.bind(this)},updateOptions:function(n,t){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var i=n.blazor__instance;i.setOptions(t,i.options,!0);i.options=t}},docEditRequestHandler:function(n){return di(this,void 0,void 0,function(){var t,i;return gi(this,function(r){switch(r.label){case 0:return"string"!=typeof n?[3,1]:(""!==JSON.parse(n).LanguageID&&this.sendHandler.call(n),[3,3]);case 1:return n.action="SystemClipboard",[4,this.dotnetRef.invokeMethodAsync("SystemClipboard",n)];case 2:t=r.sent();i={data:JSON.parse(t)};this.elementRef.blazor__instance.editor.pasteRequestHandler.successHandler(i);r.label=3;case 3:return[2]}})})},openblank:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.openBlank()},loadDocument:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.open(t)},insertTable:function(n,t,i){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertTable(t,i)},goToHeader:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.goToHeader()},goToFooter:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.goToFooter()},insertPageNumber:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertPageNumber()},undo:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editorHistory.undo()},redo:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editorHistory.redo()},updateFields:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.updateFields()},canUndo:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.editorHistory.canUndo()),t},canRedo:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.editorHistory.canRedo()),t},getBookMarks:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.getBookmarks()),t},getText:function(n,t){var i=void 0;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(i=n.blazor__instance.selection.getText(t)),i},sfdt:function(n){var t=void 0;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.sfdt),t},insertHyperlinkInternal:function(n,t,i,r,u){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertHyperlinkInternal(t,i,r,u)},insertTableOfContents:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertTableOfContents(t)},insertText:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertText(t)},applyStyle:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.applyStyle(t)},insertRow:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertRow(t)},insertColumn:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertColumn(t)},deleteTable:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.deleteTable()},deleteRow:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.deleteRow()},deleteColumn:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.deleteColumn()},canMergeCells:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.canMergeCells()},insertPageBreak:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertPageBreak()},toggleBold:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.toggleBold()},toggleItalic:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.toggleItalic()},toggleSubscript:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.toggleSubscript()},toggleSuperscript:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.toggleSuperscript()},toggleUnderline:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.toggleUnderline(t)},toggleHighlightColor:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.toggleHighlightColor(t)},toggleStrikethrough:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.toggleStrikethrough(t)},toggleTextAlignment:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.toggleTextAlignment(t)},toggleBaselineAlignment:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.toggleBaselineAlignment(t)},applyBullet:function(n,t,i){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.applyBullet(t,i)},applyNumbering:function(n,t,i){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.applyNumbering(t,i)},paste:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.paste(t)},clearFormatting:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.clearFormatting()},createStyle:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.createStyle(n.blazor__instance.documentHelper.preDefinedStyles.get(t))},closeHeaderFooter:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.closeHeaderFooter()},selectAll:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.selectAll()},selectLine:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.selectLine()},selectCurrentWord:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.selectCurrentWord()},selectParagraph:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.selectParagraph()},selectTable:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.selectTable()},mergeCells:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.mergeCells()},autoFitTable:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.autoFitTable(t)},fitPage:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.fitPage(t)},updateZoomFactor:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.setOptions({zoomFactor:parseInt(t,0)/100},{zoomFactor:n.blazor__instance.options.zoomFactor},!1)},goToPage:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.goToPage(t)},extendToWordStart:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.extendToWordStart()},insertEditingRegion:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertEditingRegion()},moveToLineStart:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.moveToLineStart()},insertSectionBreak:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertSectionBreak()},enforceProtection:function(n,t,i,r){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var u=[t,i],f={data:JSON.stringify(u)};n.blazor__instance.editor.enforceProtectionInternal(f,r)}},stopProtection:function(n,t,i){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var r=[t,i],u={data:JSON.stringify(r)};n.blazor__instance.editor.onUnProtectionSuccess(u)}return n.blazor__instance.documentHelper.isDocumentProtected},getCurrentSaltValue:function(n){return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)?"":n.blazor__instance.documentHelper.saltValue},insertEditRangeElement:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.isHighlightEditRegion=!0,n.blazor__instance.editor.insertEditRangeElement(t))},removeUserRestrictions:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.removeUserRestrictions(t)},setIsHighlightEditRegion:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.isHighlightEditRegion=t)},navigateNextEditRegion:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.navigateToNextEditingRegion()},showAllEditingRegion:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.showAllEditingRegion()},deleteComment:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.deleteCommentInternal(this.getComment(n,t))},getCurrentEditRangeUser:function(n){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)&&n.blazor__instance.documentHelper.selection.checkSelectionIsAtEditRegion()){var t=n.blazor__instance.documentHelper.selection.getEditRangeStartElement();if(t)return t.user}return""},resolveReOpenComment:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t.isResolved?n.blazor__instance.editor.resolveComment(this.getComment(n,t)):n.blazor__instance.editor.reopenComment(this.getComment(n,t)))},updateCommentText:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(this.getComment(n,t).text=t.text)},addEmptyComment:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.selectComment(n.blazor__instance.editor.insertCommentInternal(""))},addReplyComment:function(n,t,i){var u,r;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(r=this.getComment(n,t),n.blazor__instance.editor.replyComment(r,i),u=JSON.stringify(n.blazor__instance.editor.getCommentObj(r.replyComments[r.replyComments.length-1]))),u},selectComment:function(n,t){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var i=this.getComment(n,t);n.blazor__instance.selection.selectComment(i)}},updateCommentPaneHeight:function(n,t){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var i=t.getElementsByClassName("e-tab-header")[0].getBoundingClientRect().height,r=t.getElementsByClassName("e-de-cmt-toolbar")[0].getBoundingClientRect().height;t.getElementsByClassName("e-de-cmt-container")[0].style.height=t.getBoundingClientRect().height-i-r+"px"}},setFocusToElement:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||t.focus()},updateTextBoxHeight:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||setTimeout(function(){t.style.height="auto";var n=t.scrollHeight;t.style.height=n+"px"})},getComment:function(n,t){for(var u,f,r=n.blazor__instance.documentHelper.comments,i=0;i<r.length;i++)if(t.isReply){for(u=0;u<r[i].replyComments.length;u++)if(f=r[i].replyComments[u],f.commentId==t.commentId)return f}else if(r[i].commentId==t.commentId)return r[i]},navigateNextComment:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.navigateNextComment()},navigatePreviousComment:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.navigatePreviousComment()},increaseIndent:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.increaseIndent()},decreaseIndent:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.decreaseIndent()},insertField:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertField(t)},getIsInField:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.isInField),t},insertHyperlink:function(n,t,i){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertHyperlink(t,i)},removeHyperlink:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.removeHyperlink()},insertBookmark:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertBookmark(t)},clearList:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.clearList()},setRedoLimit:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.editorHistory.redoLimit=t)},getRedoLimit:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.editorHistory.redoLimit),t},setIndex:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||setTimeout(function(){var i=document.activeElement;n.blazor__instance.searchModule.searchResults.index=t;i.focus()},10)},getIndex:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.searchModule.searchResults.index),t},findAll:function(n,t,i){return!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)&&(n.blazor__instance.documentHelper.owner.findResultsList=[],n.blazor__instance.searchModule.findAll(t,i),n.blazor__instance.searchModule.textSearchResults.length>0)?(n.blazor__instance.searchModule.addFindResultView(n.blazor__instance.searchModule.textSearchResults),n.blazor__instance.documentHelper.owner.findResultsList):[]},find:function(n,t,i){var r,u;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.documentHelper.owner.findResultsList=[],r=n.blazor__instance.searchModule.textSearch.findAll(t,i),sf.base.isNullOrUndefined(r)||(n.blazor__instance.searchModule.addFindResultView(r),u=n.blazor__instance.documentHelper.owner.findResultsList)),u},navigateNextResult:function(n,t,i){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.searchModule.find(t,i)},navigatePreviousResult:function(n,t,i){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.searchModule.find(t,i)},replace:function(n,t,i){var r,u,e,f,o;sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(r=n.blazor__instance.documentHelper,u=r.owner.searchModule.textSearchResults,""===t||sf.base.isNullOrUndefined(t)||null==r.owner.selection||(e=r.owner.selection.text,(r.owner.selection.isEmpty||(r.owner.selection.isForward?r.owner.selection.selectContent(r.owner.selection.start,!0):r.owner.selection.selectContent(r.owner.selection.end,!0)),sf.base.isNullOrUndefined(u)||sf.base.isNullOrUndefined(u.currentSearchResult))||(f=u.currentSearchResult,(r.owner.searchModule.navigate(f),f.text===e)&&(o=sf.base.isNullOrUndefined(i)?"":i,r.owner.searchModule.replace(o,f,u)))))},replaceAll:function(n,t,i){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.searchModule.replaceAllInternal(t,i)},getsearchresults:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.searchModule.searchResults},clear:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.searchModule.searchResults.clear},setBackground:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.cellFormat.background=t)},getBackground:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.cellFormat.background),t},setBottomMargin:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.cellFormat.bottomMargin=t)},getBottomMargin:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.cellFormat.bottomMargin),t},setLeftMargin:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.cellFormat.leftMargin=t)},getLeftMargin:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.cellFormat.leftMargin),t},setPreferredWidth:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.cellFormat.preferredWidth=t)},getPreferredWidth:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.cellFormat.preferredWidth),t},setRightMargin:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.cellFormat.rightMargin=t)},getRightMargin:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.cellFormat.rightMargin),t},setTopMargin:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.cellFormat.topMargin=t)},getTopMargin:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.cellFormat.topMargin),t},setPreferredWidthType:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.cellFormat.preferredWidthType=t)},getPreferredWidthType:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.cellFormat.preferredWidthType),t},setVerticalAlignment:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.cellFormat.verticalAlignment=t)},getVerticalAlignment:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.cellFormat.verticalAlignment),t},insertImage:function(n,t,i,r){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertImage(t,i,r)},resizeWindow:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||setTimeout(function(){n.blazor__instance.resize()},100)},resize:function(n,t,i){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.imageFormat.resize(t,i)},getImageHeight:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.imageFormat.height},getImageWidth:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.imageFormat.width},setAfterSpacing:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.paragraphFormat.afterSpacing=t)},getAfterSpacing:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.paragraphFormat.afterSpacing),t},setBeforeSpacing:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.paragraphFormat.beforeSpacing=t)},getBeforeSpacing:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.paragraphFormat.beforeSpacing),t},setBidi:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.paragraphFormat.bidi=t)},getBidi:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.paragraphFormat.bidi),t},setContextualSpacing:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.paragraphFormat.contextualSpacing=t)},getContextualSpacing:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.paragraphFormat.contextualSpacing),t},setFirstLineIndent:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.paragraphFormat.firstLineIndent=t)},getFirstLineIndent:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.paragraphFormat.firstLineIndent),t},setLeftIndent:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.paragraphFormat.leftIndent=t)},getLeftIndent:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.paragraphFormat.leftIndent),t},setLineSpacing:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.paragraphFormat.lineSpacing=t)},getLineSpacing:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.paragraphFormat.lineSpacing),t},setListLevelNumber:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.paragraphFormat.listLevelNumber=t)},getListLevelNumber:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.paragraphFormat.listLevelNumber),t},setRightIndent:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.paragraphFormat.rightIndent=t)},getRightIndent:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.paragraphFormat.rightIndent),t},getListText:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.paragraphFormat.listText},setLineSpacingType:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.paragraphFormat.lineSpacingType=t)},getLineSpacingType:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.paragraphFormat.lineSpacingType),t},setTextAlignment:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.paragraphFormat.textAlignment=t)},getTextAlignment:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.paragraphFormat.textAlignment),t},setBaselineAlignment:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.characterFormat.baselineAlignment=t)},getBaselineAlignment:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.characterFormat.baselineAlignment),t},setBold:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.characterFormat.bold=t)},getBold:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.characterFormat.bold),t},setItalic:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.characterFormat.italic=t)},getItalic:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.characterFormat.italic),t},setFontColor:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.characterFormat.fontColor=t)},getFontColor:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.characterFormat.fontColor),t},setFontFamily:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.characterFormat.fontFamily=t)},getFontFamily:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.characterFormat.fontFamily),t},setFontSize:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.characterFormat.fontSize=t)},getFontSize:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.characterFormat.fontSize),t},setHighlightColor:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.characterFormat.highlightColor=t)},getHighlightColor:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.characterFormat.highlightColor),t},setStrikethrough:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.characterFormat.strikethrough=t)},getStrikethrough:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.characterFormat.strikethrough),t},setUnderline:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.characterFormat.underline=t)},getUnderline:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.characterFormat.underline),t},selectRow:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.selectRow()},setAllowBreakAcrossPages:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.rowFormat.allowBreakAcrossPages=t)},getAllowBreakAcrossPages:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.rowFormat.allowBreakAcrossPages),t},setIsHeader:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.rowFormat.isHeader=t)},getIsHeader:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.rowFormat.isHeader),t},setRowHeight:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.rowFormat.height=t)},getRowHeight:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.rowFormat.height),t},setHeightType:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.rowFormat.heightType=t)},getHeightType:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.rowFormat.heightType),t},setSectionBottomMargin:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.sectionFormat.bottomMargin=t)},getSectionBottomMargin:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.sectionFormat.bottomMargin),t},setFooterDistance:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.sectionFormat.footerDistance=t)},getFooterDistance:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.sectionFormat.footerDistance),t},setHeaderDistance:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.sectionFormat.headerDistance=t)},getHeaderDistance:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.sectionFormat.headerDistance),t},setSectionLeftMargin:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.sectionFormat.leftMargin=t)},getSectionLeftMargin:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.sectionFormat.leftMargin),t},setPageHeight:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.sectionFormat.pageHeight=t)},getPageHeight:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.sectionFormat.pageHeight),t},setPageWidth:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.sectionFormat.pageWidth=t)},getPageWidth:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.sectionFormat.pageWidth),t},setSectionRightMargin:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.sectionFormat.rightMargin=t)},getSectionRightMargin:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.sectionFormat.rightMargin),t},setSectionTopMargin:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.sectionFormat.topMargin=t)},getSectionTopMargin:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.sectionFormat.topMargin),t},setDifferentFirstPage:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.sectionFormat.differentFirstPage=t)},getDifferentFirstPage:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.sectionFormat.differentFirstPage),t},setDifferentOddAndEvenPages:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.sectionFormat.differentOddAndEvenPages=t)},getDifferentOddAndEvenPages:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.sectionFormat.differentOddAndEvenPages),t},setTableBackground:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.tableFormat.background=t)},getTableBackground:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.tableFormat.background),t},setTableBottomMargin:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.tableFormat.bottomMargin=t)},getTableBottomMargin:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.tableFormat.bottomMargin),t},setTableCellSpacing:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.tableFormat.cellSpacing=t)},getTableCellSpacing:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.tableFormat.cellSpacing),t},setTableLeftIndent:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.tableFormat.leftIndent=t)},getTableLeftIndent:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.tableFormat.leftIndent),t},setTableLeftMargin:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.tableFormat.leftMargin=t)},getTableLeftMargin:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.tableFormat.leftMargin),t},setTablePreferredWidth:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.tableFormat.preferredWidth=t)},getTablePreferredWidth:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.tableFormat.preferredWidth),t},setTableRightMargin:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.tableFormat.rightMargin=t)},getTableRightMargin:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.tableFormat.rightMargin),t},setTableTopMargin:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.tableFormat.topMargin=t)},getTableTopMargin:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.tableFormat.topMargin),t},setTableBidi:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.tableFormat.bidi=t)},getTableBidi:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.tableFormat.bidi),t},setTablePreferredWidthType:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.tableFormat.preferredWidthType=t)},getTablePreferredWidthType:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.tableFormat.preferredWidthType),t},setTableAlignment:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.tableFormat.tableAlignment=t)},getTableAlignment:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.tableFormat.tableAlignment),t},getListFormat:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.start.paragraph.paragraphFormat.listFormat),t},getList:function(n){var t={};return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.fetchList(n.blazor__instance.documentHelper.lists,n.blazor__instance.documentHelper.abstractLists)),t},getListLength:function(n){var t=0;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||this.documentHelper.owner.documentHelper.lists.length>0&&(t=this.documentHelper.owner.documentHelper.lists[this.documentHelper.owner.documentHelper.lists.length-1].listId+1),t},getAbstractListLength:function(){var n=0;return this.documentHelper.owner.documentHelper.abstractLists.length>0&&(n=this.documentHelper.owner.documentHelper.abstractLists[this.documentHelper.owner.documentHelper.abstractLists.length-1].abstractListId+1),n},getListLevel:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.getListLevel(n.blazor__instance.selection.start.paragraph)),t},getListLevelPattern:function(n,t){var i;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(i=n.blazor__instance.documentHelper.layout.getListLevelPattern(t)),i},setListLevelPattern:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)},applyListProperties:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.paragraphFormat.setList(t)},applyPageSetupProperties:function(n,t){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var i=new dt;sf.base.isNullOrUndefined(t)||(i.topMargin=t.topMargin,i.bottomMargin=t.bottomMargin,i.leftMargin=t.leftMargin,i.rightMargin=t.rightMargin,i.pageHeight=t.pageHeight,i.pageWidth=t.pageWidth,i.footerDistance=t.footerDistance,i.headerDistance=t.headerDistance,i.differentFirstPage=t.differentFirstPage,i.differentOddAndEvenPages=t.differentOddAndEvenPages);n.blazor__instance.editor.onApplySectionFormat(void 0,i)}},applyParagraphFormat:function(n,t){var i=new ut;sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(sf.base.isNullOrUndefined(t)||(i.leftIndent=t.leftIndent,i.rightIndent=t.rightIndent,i.firstLineIndent=t.firstLineIndent,i.lineSpacing=t.lineSpacing,i.lineSpacingType=t.lineSpacingType,i.textAlignment=t.textAlignment,i.beforeSpacing=t.beforeSpacing,i.afterSpacing=t.afterSpacing,i.bidi=t.bidi,i.keepWithNext=t.keepWithNext,i.keepLinesTogether=t.keepLinesTogether,i.widowControl=t.widowControl,i.contextualSpacing=t.contextualSpacing),n.blazor__instance.editor.onParagraphFormat(i))},getStyleName:function(n,t){var i;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(i=n.blazor__instance.getStyleNames(t)),i},getStyles:function(n,t){var i;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(i=n.blazor__instance.getStyles(t)),i},findByName:function(n,t){var i={};return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(i=n.blazor__instance.documentHelper.styles.findByName(t)),i=n.blazor__instance.fetchStyleValue(i)},layoutWholeDocument:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.layoutWholeDocument()},shiftingEnableDisable:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.isShiftingEnabled=t)},updateStyleValues:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.documentHelper.styles.push(t)},setCharStyleName:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.characterFormat.styleName=t)},setParaStyleName:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.paragraphFormat.styleName=t)},getCharStyleName:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.characterFormat.styleName),t},getParaStyleName:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.paragraphFormat.styleName),t},gotoBookmark:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.selectBookmark(t)},deleteBookmark:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editorModule.deleteBookmark(t)},applyBorderAndShading:function(n,t,i,r){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||("Table"===t?(n.blazor__instance.editorModule.applyBordersInternal(n.blazor__instance.selection.tableFormat.table.tableFormat.borders,i),n.blazor__instance.editorModule.applyShading(n.blazor__instance.selection.tableFormat.table.tableFormat.shading,r)):(n.blazor__instance.editorModule.applyBordersInternal(n.blazor__instance.selection.start.paragraph.associatedCell.cellFormat.borders,i),n.blazor__instance.editorModule.applyShading(n.blazor__instance.selection.start.paragraph.associatedCell.cellFormat.shading,r)))},insertFormField:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.insertFormField(t)},insertTextFormField:function(n,t){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var i=new vt;i.type=t.type;i.name=t.name;i.enabled=t.enabled;i.helpText=t.helpText;i.statusText=t.statusText;i.maxLength=t.maxLength;i.defaultValue=t.defaultValue;i.format=t.format;n.blazor__instance.editorModule.editFormField("Text",i)}},insertCheckBoxFormField:function(n,t){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var i=new bt;i.name=t.name;i.enabled=t.enabled;i.helpText=t.helpText;i.sizeType=t.sizeType;i.size=t.size;i.defaultValue=t.defaultValue;n.blazor__instance.editorModule.editFormField("CheckBox",i)}},insertDropDownFormField:function(n,t){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var i=new kt;i.name=t.name;i.enabled=t.enabled;i.helpText=t.helpText;i.statusText=t.statusText;i.dropdownItems=t.dropdownItems.slice();i.selectedIndex=t.selectedIndex;n.blazor__instance.editorModule.editFormField("DropDown",i)}},getCurrentField:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.getCurrentFormField()),JSON.stringify(t.formFieldData)},updateFormFieldValue:function(n,t){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var i=n.blazor__instance.selection.getCurrentFormField();i&&n.blazor__instance.editorModule.updateFormField(i,t)}},onCharacterFormat:function(n,t){var i=new p;sf.base.isNullOrUndefined(t)||(i.bold=t.bold,i.fontSize=t.fontSize,i.fontFamily=t.fontFamily,i.italic=t.italic,i.baselineAlignment=t.baselineAlignment,i.underline=t.underline,i.fontColor=t.fontColor,i.highlightColor=t.highlightColor,i.strikethrough=t.strikethrough,i.allCaps=t.allCaps);n.blazor__instance.editor.initHistory("CharacterFormat");n.blazor__instance.selection.isEmpty?n.blazor__instance.selection.start.offset===n.blazor__instance.selection.getParagraphLength(n.blazor__instance.selection.start.paragraph)&&(n.blazor__instance.editor.applyCharFormatValueInternal(n.blazor__instance.selection,n.blazor__instance.selection.start.paragraph.characterFormat,void 0,i),n.blazor__instance.editor.reLayout(n.blazor__instance.selection)):(n.blazor__instance.editor.setOffsetValue(n.blazor__instance.selection),n.blazor__instance.editor.updateSelectionCharacterFormatting("CharacterFormat",i,!1))},applyCellOption:function(n,t){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var i=new si;sf.base.isNullOrUndefined(t)||(i.topMargin=t.topMargin,i.bottomMargin=t.bottomMargin,i.leftMargin=t.leftMargin,i.rightMargin=t.rightMargin);n.blazor__instance.applyCellOption(i)}},applyTableOption:function(n,t){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var i=new pt;sf.base.isNullOrUndefined(t)||(i.topMargin=t.topMargin,i.bottomMargin=t.bottomMargin,i.leftMargin=t.leftMargin,i.rightMargin=t.rightMargin);n.blazor__instance.applyTableOption(i)}},applyTableProperties:function(n,t,i,r){var u,e,f;sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||((n.blazor__instance.editorModule.initComplexHistory("TableProperties"),t)&&(u=new pt,t.cellSpacing&&(u.cellSpacing=t.cellSpacing),t.leftMargin&&(u.leftMargin=t.leftMargin),t.topMargin&&(u.topMargin=t.topMargin),t.rightMargin&&(u.rightMargin=t.rightMargin),t.bottomMargin&&(u.bottomMargin=t.bottomMargin),t.leftIndent&&(u.leftIndent=t.leftIndent),t.tableAlignment&&(u.tableAlignment=t.tableAlignment),t.preferredWidth&&(u.preferredWidth=t.preferredWidth),t.preferredWidthType&&(u.preferredWidthType=t.preferredWidthType),t.bidi&&(u.bidi=t.bidi),n.blazor__instance.editorModule.onTableFormat(u)),i&&(e=new ti,i.isHeader&&(e.isHeader=i.isHeader),i.allowBreakAcrossPages&&(e.allowBreakAcrossPages=i.allowBreakAcrossPages),i.height&&(e.height=i.height),i.heightType&&(e.heightType=i.heightType),n.blazor__instance.editorModule.onRowFormat(i)),r&&(f=new si,r.leftMargin&&(f.leftMargin=r.leftMargin),r.topMargin&&(f.topMargin=r.topMargin),r.bottomMargin&&(f.bottomMargin=r.bottomMargin),r.rightMargin&&(f.rightMargin=r.rightMargin),n.blazor__instance.editorModule.onCellFormat(f)),n.blazor__instance.editorHistory.updateComplexHistory())},enableRepeatHeader:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.enableRepeatHeader()),t},RowFormatIsInHeader:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.documentHelper.selection.rowFormat.isHeader),t},applyShading:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selection.cellFormat.background=t)},applyBorder:function(n,t,i,r){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.applyBorders(this.getBorder(t,i,r))},getBorder:function(n,t,i){return{type:n,borderColor:i,lineWidth:t,borderStyle:0===t?"Cleared":"Single"}},initTrackChangesPane:function(n){n.blazor__instance.trackChangesPane.initTrackChangePane()},sortByUser:function(n,t){n.blazor__instance.trackChangesPane.onUserSelect(t)},sortByRevision:function(n,t){n.blazor__instance.trackChangesPane.onTypeSelect(t)},acceptOrRejectChanges:function(n,t){n.blazor__instance.trackChangesPane.onMenuSelect(t)},navigatePreviousRevision:function(n){n.blazor__instance.selection.navigatePreviousRevision()},navigateNextChanges:function(n){n.blazor__instance.selection.navigateNextRevision()},getHyperlinkField:function(n){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var i,t=n.blazor__instance.selection.getHyperlinkField(),r="";return sf.base.isNullOrUndefined(t.fieldSeparator)||(r=n.blazor__instance.selection.getHyperlinkDisplayText(t.fieldSeparator.line.paragraph,t.fieldSeparator,t.fieldEnd,!1,void 0).displayText),i=n.blazor__instance.selection.getLinkText(t),JSON.stringify({displayText:r,link:i})}return""},isTableSelected:function(n){return!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)&&n.blazor__instance.selection.isTableSelected()},getPageCount:function(n){return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)?1:n.blazor__instance.pageCount},getContextType:function(n){var t="";return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.contextType),t},copy:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.copy()},cut:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editor.cut()},pasteInternal:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.isReadOnlyMode||n.blazor__instance.editorModule.pasteInternal(void 0)},updateField:function(n){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var t=n.blazor__instance.isReadOnlyMode;n.blazor__instance.selection.isReferenceField()&&(!t||t&&"FormFieldsOnly"===n.blazor__instance.documentHelper.protectionType)?n.blazor__instance.selection.updateRefField():n.blazor__instance.editorModule.updateToc()}},navigateHyperlink:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.navigateHyperlink()},copyHyperlink:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.copyHyperlink()},applyContinueNumbering:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editorModule.applyContinueNumbering()},applyRestartNumbering:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.editorModule.applyRestartNumbering(n.blazor__instance.selection)},handleAcceptReject:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.handleAcceptReject(t)},spellCheck:function(n,t,i){var u,r;sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(u=n.blazor__instance.element.id+t,i.substring(0,u.length)===u?(r=i.substring(i.lastIndexOf("_")+1),"Add To Dictionary"===r||("Ignore All"===r?this.spellChecker.handleIgnoreAllItems():this.spellChecker.manageReplace(r))):n.blazor__instance.fireCustomContextMenuSelect(i))},checkEmpty:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.selection.isEmpty),t},checkReadOnly:function(n){var t;return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance.isReadOnlyMode),t},hasRevision:function(n){return!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)&&n.blazor__instance.selection.hasRevisions()},isContentProtected:function(n){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var t=n.blazor__instance,i=t.documentHelper.isDocumentProtected,r={isDocumentProtected:i,allowFormatting:i&&t.documentHelper.restrictFormatting,isInProtectecRegion:t.editor.restrictEditing,isReadOnly:t.isReadOnly,protectionType:t.documentHelper.protectionType};return JSON.stringify(r)}return""},clearSelectionHighlight:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.documentHelper.clearSelectionHighlight()},onIgnore:function(n){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)&&!sf.base.isNullOrUndefined(this.info.element)){var t=n.blazor__instance;t.spellChecker.manageReplace("Ignore Once",this.info.element);this.removeErrors(n);t.spellChecker.checkForNextError()}},removeErrors:function(n){var t=n.blazor__instance,i;!sf.base.isNullOrUndefined(this.info.text)&&t.spellChecker.errorWordCollection.containsKey(this.info.text)&&(i=t.spellChecker.errorWordCollection.get(this.info.text),i.splice(0,1),0===i.length&&t.spellChecker.errorWordCollection.remove(this.info.text));t.spellChecker.errorWordCollection.length},onIgnoreAll:function(n){var t,i;sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(t=n.blazor__instance,sf.base.isNullOrUndefined(this.info.element)||(i=this.info.element.text,t.spellChecker.handleIgnoreAllItems({element:this.info.element,text:i}),t.spellChecker.checkForNextError()))},addToDictionary:function(n){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)&&sf.base.isNullOrUndefined(this.info.element)){var t=n.blazor__instance;t.spellChecker.handleAddToDictionary({element:this.info.element,text:this.info.element.text});t.spellChecker.errorWordCollection.containsKey(this.info.text)&&t.spellChecker.errorWordCollection.remove(this.info.text)}},onChange:function(n,t){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)&&!sf.base.isNullOrUndefined(t)){this.isSpellChecking=!0;var i=n.blazor__instance;i.spellChecker.manageReplace(t,this.info.element);this.removeErrors(n);i.spellChecker.checkForNextError()}},onChangeAll:function(n,t){var e,h;if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)&&!sf.base.isNullOrUndefined(t)){this.isSpellChecking=!0;for(var f=n.blazor__instance,u=f.spellChecker.errorWordCollection.get(this.info.text),r=0;r<u.length;r++)if(_instanceof(u[r],vi)&&!u[r].ischangeDetected)f.spellChecker.manageReplace(t,u[r]);else if(_instanceof(u[r],i)){var o=f.spellChecker.getMatchedResultsFromElement(u[r]),s=o.textResults,c=u[r].ischangeDetected?u[r].start.offset:u[r].line.getOffset(u[r],0);for(f.searchModule.textSearch.updateMatchedTextLocation(o.matches,s,o.elementInfo,0,u[r],!1,null,c),e=0;e<s.length;e++)h=f.spellChecker.createErrorElementWithInfo(s.innerList[e],u[r]),f.spellChecker.manageReplace(t,h)}f.spellChecker.errorWordCollection.containsKey(this.info.text)&&f.spellChecker.errorWordCollection.remove(this.info.text);f.spellChecker.checkForNextError()}},getErrorString:function(n){var t=[];return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||this.info.text&&t.push(this.info.text),t},getSuggestionsString:function(n){var i=[],t=this.info.text;return this.isSpellChecking&&(this.isSpellChecking=!1),sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||this.info.text&&(t=n.blazor__instance.spellChecker.manageSpecialCharacters(t,void 0,!0),i=n.blazor__instance.spellChecker.errorSuggestions.containsKey(t)?n.blazor__instance.spellChecker.errorSuggestions.get(t):[]),i},hasElementBox:function(n){var i=!1,t=n.blazor__instance;return this.info=t.spellChecker.findCurretText(),this.info.element&&(i=!0,t.spellChecker.currentContextInfo=this.info,this.info=t.spellChecker.retriveText()),i},invokeMethod:function(t,i,r,u){return di(this,void 0,void 0,function(){var f,e,o;return gi(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,5]),f=null,(e=t.blazor__instance)?(null===r||(e=t.blazor__instance,e=this.getChildModule(e,r)),!(f=e[i].apply(e,u))||"object"!==n(f)||_instanceof(f,Promise)||(f=this.cleanStringify(f)),"saveAsBlob"==i&&_instanceof(f,Promise)?[4,this.promiseHandler(f)]:[3,2]):[3,3];case 1:f=s.sent();s.label=2;case 2:return[2,f];case 3:return[3,5];case 4:return o=s.sent(),[2,this.throwError(o,e)];case 5:return[2,{}]}})})},promiseHandler:function(n){return di(this,void 0,void 0,function(){var t;return gi(this,function(i){switch(i.label){case 0:return t=this,_instanceof(n,Promise)?[4,n.then(function(i){return di(this,void 0,void 0,function(){return gi(this,function(r){switch(r.label){case 0:return[4,t.docEditFileReader(i).then(function(t){n=JSON.stringify({data:t.substr(t.indexOf(",")+1)})})];case 1:return r.sent(),[2]}})})})]:[3,2];case 1:i.sent();i.label=2;case 2:return[2,n]}})})},docEditFileReader:function(n){return di(this,void 0,void 0,function(){return gi(this,function(){return[2,new Promise(function(t){var i=new FileReader;i.onload=function(){t(i.result)};i.readAsDataURL(n)})]})})},getMethodCall:function(n,t,i){try{var r=n.blazor__instance;return null==t||"null"==t?r[i]:(r=this.getChildModule(r,t))[i]}catch(n){this.throwError(n,r)}},setMethodCall:function(n,t,i,r){try{var u=n.blazor__instance;(u=this.getChildModule(u,t))[i]=r[0]}catch(n){this.throwError(n,u)}},cleanStringify:function(n){try{return JSON.stringify(n)}catch(n){return console.log(n),""}},getChildModule:function(n,t){try{for(var r=t.split(","),i=0;i<r.length;i++)n=n[r[i]];return n}catch(n){}return n},insertNotes:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||("Footnote"===t?n.blazor__instance.editor.insertFootnote():n.blazor__instance.editor.insertEndnote())},pasteOptions:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.selection.pasteOptions(t)},modifyStyle:function(n,t,i,r,u,f,e){var s=n.blazor__instance.documentHelper,o=i,v,l,a,h,c,y;if(!(t.length>0))throw new Error("Enter valid Style name");l=s.styles.findByName(t);sf.base.isNullOrUndefined(l)?(a="Character"===f?new ur:new fi,h=new p,sf.base.isNullOrUndefined(o.characterFormat)||(h.bold=o.characterFormat.bold,h.fontSize=o.characterFormat.fontSize,h.fontFamily=o.characterFormat.fontFamily,h.italic=o.characterFormat.italic,h.baselineAlignment=o.characterFormat.baselineAlignment,h.underline=o.characterFormat.underline,h.fontColor=o.characterFormat.fontColor,h.highlightColor=o.characterFormat.highlightColor,h.strikethrough=o.characterFormat.strikethrough,h.allCaps=o.characterFormat.allCaps),o.characterFormat=h,c=new ut,sf.base.isNullOrUndefined(o.paragraphFormat)||(c.leftIndent=o.paragraphFormat.leftIndent,c.rightIndent=o.paragraphFormat.rightIndent,c.firstLineIndent=o.paragraphFormat.firstLineIndent,c.lineSpacing=o.paragraphFormat.lineSpacing,c.lineSpacingType=o.paragraphFormat.lineSpacingType,c.textAlignment=o.paragraphFormat.textAlignment,c.beforeSpacing=o.paragraphFormat.beforeSpacing,c.afterSpacing=o.paragraphFormat.afterSpacing,c.bidi=o.paragraphFormat.bidi,c.contextualSpacing=o.paragraphFormat.contextualSpacing),o.paragraphFormat=c,a.copyStyle(o),y=s.styles.findByName(r),"Paragraph"!==f&&"Linked(Paragraph and Character)"!==f||(a.next=t===u?a:s.styles.findByName(u)),a.link="Linked(Paragraph and Character)"===f?this.createLinkStyle(t):void 0,a.type="Character"===f?"Character":"Paragraph",a.name=t,a.basedOn=y,s.styles.push(a),v=t,s.owner.editorModule.applyStyle(v)):(l.type="Character"===f?"Character":"Paragraph",l.basedOn=s.styles.findByName(r),"Paragraph"!==o.type&&-1===o.type.indexOf("Linked(Paragraph and Character)")||(l.next=s.styles.findByName(o.next),n.blazor__instance.parser.parseCharacterFormat(o.characterFormat,l.characterFormat,!1),n.blazor__instance.parser.parseParagraphFormat(o.paragraphFormat,l.paragraphFormat),l.link=-1!==f.indexOf("Linked(Paragraph and Character)")?this.createLinkStyle(s,t,l,e):void 0),s.owner.isShiftingEnabled=!0,s.owner.editorModule.layoutWholeDocument(),s.owner.isShiftingEnabled=!1);s.updateFocus();s.updateFocus()},createLinkStyle:function(n,t,i,r){var u;return(u=r?n.styles.findByName(t+" Char","Character"):new ur).type="Character",u.name=t+" Char",u.characterFormat=i.characterFormat.cloneFormat(),u.basedOn=i.basedOn,r||n.styles.push(u),n.styles.findByName(u.name,"Character")},updateParagraphDialogHeight:function(n,t,i){var r=document.getElementById(t.id),y=r.getElementsByClassName("e-dlg-header-content")[0],p=r.getElementsByClassName("e-dlg-content")[0],w=r.getElementsByClassName("e-footer-content")[0],u=getComputedStyle(p),f=getComputedStyle(r),e=parseInt(u.paddingTop),o=parseInt(u.paddingBottom),b=(isNaN(e)?0:e)+(isNaN(o)?0:o),s=parseInt(f.borderTop),h=parseInt(f.borderBottom),k=(isNaN(s)?0:s)+(isNaN(h)?0:h),d=r.offsetHeight-(y.offsetHeight+w.offsetHeight+b+k);i.style.height=d+"px";var c=parseInt(u.paddingLeft),l=parseInt(u.paddingRight),g=(isNaN(c)?0:c)+(isNaN(l)?0:l),a=parseInt(f.borderLeft),v=parseInt(f.borderRight),nt=(isNaN(a)?0:a)+(isNaN(v)?0:v);return r.offsetWidth-(g+nt)},getDocumentEditorElementHeight:function(n){return n.offsetHeight},getTablePropertiesPaneHeight:function(n){var t=n.getElementsByClassName("e-tab-header")[0];return t?n.offsetHeight-t.offsetHeight+"px":"auto"}}}()},"./modules/sf-documenteditorcontainer.js":function(){window.sfBlazor=window.sfBlazor||{};window.sfBlazor.DocumentEditorContainer=function(){"use strict";var i=function(){function n(n,t,i,r){this.previousContext="";this.showHeaderProperties=!0;this.element=n;sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(n)||(this.element.blazor__instance=this),this.dotNetRef=r,this.element=n,this.options=t,this.editorOptions=i,this.updateOptions(t))}return Object.defineProperty(n.prototype,"documentEditor",{get:function(){return this.documentEditorInternal},enumerable:!0,configurable:!0}),n.prototype.updateOptions=function(n){this.showPropertiesPane=n.showPropertiesPane;this.currentUser=n.currentUser;this.enableComment=n.enableComment;this.enableLocalPaste=n.enableLocalPaste;this.enableSpellCheck=n.enableSpellCheck;this.enableTrackChanges=n.enableTrackChanges;this.height=n.height;this.serviceUrl=n.serviceUrl;this.userColor=n.userColor;this.width=n.width;this.zIndex=n.zIndex;this.requiredModules()},n.prototype.setOptions=function(n){for(var u,t,i=0,r=Object.keys(n);i<r.length;i++)if(u=r[i],t=n[u],!sf.base.isNullOrUndefined(t))switch(u){case"zoomFactor":this.documentEditor.zoomFactor=t;this.documentEditor.onPropertyChanged({zoomFactor:t},null);break;case"layoutType":this.documentEditor.layoutType=t;this.documentEditor.onPropertyChanged({layoutType:t},null);break;case"enableTrackChanges":this.enableTrackChanges=t;this.documentEditor.enableTrackChanges=t;this.documentEditor.showRevisions=t;this.documentEditor.onPropertyChanged({enableTrackChanges:t},null);this.documentEditor.onPropertyChanged({showRevisions:t},null);break;case"restrictEditing":this.restrictEditing=t;this.documentEditor.isReadOnly=t;this.documentEditor.onPropertyChanged({isReadOnly:t},null);break;case"enableLocalPaste":this.enableLocalPaste=t;this.documentEditor.enableLocalPaste=t;this.documentEditor.onPropertyChanged({enableLocalPaste:t},null)}},n.prototype.getModuleName=function(){return"DocumentEditorContainer"},n.prototype.onPropertyChanged=function(n){for(var r,t=0,i=Object.keys(n);t<i.length;t++)switch(i[t]){case"restrictEditing":this.documentEditor.isReadOnly=n.restrictEditing;break;case"showPropertiesPane":this.showHidePropertiesPane(n.showPropertiesPane);break;case"enableTrackChanges":this.documentEditor&&(this.documentEditor.enableTrackChanges=n.enableTrackChanges,this.documentEditor.showRevisions=n.enableTrackChanges,this.documentEditor.resize());break;case"enableLocalPaste":this.documentEditor&&(this.documentEditor.enableLocalPaste=n.enableLocalPaste);break;case"serviceUrl":this.documentEditor&&(this.documentEditor.serviceUrl=n.serviceUrl);break;case"serverActionSettings":this.documentEditor&&this.setserverActionSettings();break;case"zIndex":this.documentEditor&&(this.documentEditor.zIndex=n.zIndex);break;case"enableComment":this.documentEditor&&(this.documentEditor.enableComment=n.enableComment);break;case"enableSpellCheck":this.documentEditor&&(this.documentEditor.enableSpellCheck=n.enableSpellCheck);break;case"documentEditorSettings":this.documentEditor&&this.customizeDocumentEditorSettings();break;case"currentUser":this.documentEditor&&(this.documentEditor.currentUser=n.currentUser);break;case"userColor":this.documentEditor&&(this.documentEditor.userColor=n.userColor);break;case"layoutType":this.documentEditor&&(this.documentEditor.layoutType=n.layoutType);break;case"enableToolbar":this.documentEditor&&this.documentEditor.resize();break;case"height":r="";r=-1!==this.height.indexOf("%")?window.innerHeight*(parseInt(this.height)/100)+"px":sf.base.formatUnit(this.height);this.element.style.height=r;this.documentEditor&&this.documentEditor.resize();break;case"width":this.element.style.width=sf.base.formatUnit(this.width);this.documentEditor&&this.documentEditor.resize()}},n.prototype.preRender=function(){var n="";n=-1!==this.height.indexOf("%")?window.innerHeight*(parseInt(this.height)/100)+"px":sf.base.formatUnit(this.height);this.element.style.height=n;""!==this.width&&(this.element.style.width=sf.base.formatUnit(this.width));this.element.style.minHeight="320px"},n.prototype.render=function(n){this.initializeDocumentEditor(n);this.setserverActionSettings();this.customizeDocumentEditorSettings()},n.prototype.setFormat=function(){},n.prototype.setserverActionSettings=function(){},n.prototype.customizeDocumentEditorSettings=function(){},n.prototype.getPersistData=function(){return"documenteditor-container"},n.prototype.requiredModules=function(){var n=[];return this.enableToolbar&&n.push({member:"toolbar",args:[this]}),n},n.prototype.initializeDocumentEditor=function(n){var t=n;this.documentEditorInternal=n.blazor__instance;sf.base.EventHandler.add(t,"selectionChange",this.onSelectionChange,this);this.documentEditor.enableAllModules();this.documentEditor.enableComment=this.enableComment;this.setFormat();this.documentEditor.resize()},n.prototype.showHidePropertiesPane=function(){this.showPropertiesPane&&this.showPropertiesPaneOnSelection();this.documentEditor.resize()},n.prototype.resize=function(n,t){this.element&&(sf.base.isNullOrUndefined(t)&&this.element&&this.element.parentElement.parentElement&&(t=this.element.parentElement.parentElement.clientHeight),sf.base.isNullOrUndefined(n)&&this.element&&this.element.parentElement.parentElement&&(n=this.element.parentElement.parentElement.clientWidth),!sf.base.isNullOrUndefined(n)&&n>200&&(this.width=n.toString(),this.element.style.width=n+"px"),!sf.base.isNullOrUndefined(t)&&t>200&&(this.height=t.toString(),this.element.style.height=t+"px"),this.documentEditor&&this.documentEditor.resize())},n.prototype.onContentChange=function(){},n.prototype.onDocumentChange=function(){this.enableTrackChanges=this.documentEditor.enableTrackChanges},n.prototype.onSelectionChange=function(){this.showPropertiesPaneOnSelection()},n.prototype.showPropertiesPaneOnSelection=function(){var n=this.documentEditor.selection.contextType,t=n.indexOf("Header")>=0||n.indexOf("Footer")>=0;t||(this.showHeaderProperties=!0);this.showPropertiesPane?t&&this.showHeaderProperties?this.showProperties("headerfooter"):n.indexOf("List")>=0||n.indexOf("Text")>=0&&n.indexOf("Table")<0?this.showProperties("text"):n.indexOf("Image")>=0?this.showProperties("image"):n.indexOf("TableOfContents")>=0?this.showProperties("toc"):n.indexOf("Table")>=0&&this.showProperties("table"):this.showHidePropertiesPane(!1);this.previousContext=this.documentEditor.selection.contextType},n.prototype.showProperties=function(n){this.textProperties.showTextProperties("text"===n);this.tableProperties.showTableProperties("table"===n);this.imageProperties.showImageProperties("image"===n);this.headerFooterProperties.showHeaderFooterPane("headerfooter"===n);this.tocProperties.showTocPane("toc"===n)},n.prototype.destroy=function(){this.propertiesPaneContainer&&this.editorContainer.parentElement&&(this.propertiesPaneContainer.innerHTML="",this.propertiesPaneContainer.parentElement.removeChild(this.propertiesPaneContainer));this.propertiesPaneContainer=void 0;this.editorContainer&&this.editorContainer.parentElement&&(this.editorContainer.innerHTML="",this.editorContainer.parentElement.removeChild(this.editorContainer));this.statusBarElement&&this.statusBarElement.parentElement&&(this.statusBarElement.innerHTML="",this.statusBarElement.parentElement.removeChild(this.statusBarElement));this.containerTarget&&this.containerTarget.parentElement&&(this.containerTarget.innerHTML="",this.containerTarget.parentElement.removeChild(this.containerTarget));this.containerTarget=void 0;this.statusBarElement=void 0;this.editorContainer=void 0},n}(),r=function(n){var t=this;this.showTextProperties=function(n){!n&&"none"===t.element.style.display||n&&"block"===t.element.style.display||(t.element.style.display=n?"block":"none")};this.element=n},u=function(n){var t=this;this.showImageProperties=function(n){!n&&"none"===t.element.style.display||n&&"block"===t.element.style.display||(t.element.style.display=n?"block":"none")};this.element=n},f=function(n){var t=this;this.showTableProperties=function(n){!n&&"none"===t.element.style.display||n&&"block"===t.element.style.display||(t.element.style.display=n?"block":"none")};this.element=n},e=function(n){var t=this;this.showTocPane=function(n){!n&&"none"===t.element.style.display||n&&"block"===t.element.style.display||(t.element.style.display=n?"block":"none")};this.element=n},o=function(){function n(n){this.element=n}return n.prototype.onSelectionChange=function(){},n.prototype.showHeaderFooterPane=function(n){n&&this.onSelectionChange();!n&&"none"===this.element.style.display||n&&"block"===this.element.style.display||(this.element.style.display=n?"block":"none")},n}(),n=function(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(n){f(n)}}function s(n){try{e(r.throw(n))}catch(n){f(n)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})},t=function(n,t){function o(e){return function(o){return function(e){if(f)throw new TypeError("Generator is already executing.");for(;r;)try{if(f=1,u&&(i=2&e[0]?u.return:e[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;switch(u=0,i&&(e=[2&e[0],i.value]),e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==e[0]&&2!==e[0])){r=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(6===e[0]&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(n){e=[6,n];u=0}finally{f=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,o])}}var f,u,i,e,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:o(0),"throw":o(1),"return":o(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e};return{dotnetRef:null,filePicker:null,imagePicker:null,docEditElement:null,initialize:function(n,t,s,h,c,l){var a,v,y;sf.base.enableBlazorMode();a=new i(n,s,h,c);(a.textProperties=new r(l[0]),a.tableProperties=new f(l[1]),a.imageProperties=new u(l[2]),a.headerFooterProperties=new o(l[3]),a.tocProperties=new e(l[4]),a.preRender(t),a.render(t),this.dotnetRef=c,this.docEditElement=t,t.parentElement)&&(v=t.parentElement.getElementsByClassName("e-de-ctnr-file-picker"),y=t.parentElement.getElementsByClassName("e-de-ctnr-image-picker"),v.length>0&&(this.filePicker=v[0],this.filePicker.addEventListener("change",this.fileReader.bind(this))),y.length>0&&(this.imagePicker=y[0],this.imagePicker.addEventListener("change",this.imageReader.bind(this))))},updateOptions:function(n,t){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var i=n.blazor__instance;i.setOptions(t,i.options);i.options=t}},imageReader:function(){return n(this,void 0,void 0,function(){var i,r,n;return t(this,function(){return r=(i=this).imagePicker.files[0],(n=new FileReader).onload=function(){var t=n.result,r=document.createElement("img");r.addEventListener("load",function(){i.docEditElement.blazor__instance.editor.insertImage(t,this.width,this.height)});r.src=t},n.readAsDataURL(r),[2]})})},fileReader:function(){return n(this,void 0,void 0,function(){var u,n,i,f,r;return t(this,function(){return this.dotnetRef.invokeMethodAsync("ShowSpinner"),(n=(u=this).filePicker.files[0])&&(i=n.name,f=i.substr(i.lastIndexOf(".")),(r=new FileReader).onload=function(){var n=r.result;u.dotnetRef.invokeMethodAsync("LoadDocument",n,i)},".sfdt"===f?r.readAsText(n):r.readAsDataURL(n)),[2]})})},openDocument:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||("File"==t?this.filePicker&&(this.filePicker.value="",this.filePicker.click()):"Image"==t&&this.imagePicker&&(this.imagePicker.value="",this.imagePicker.click()))},showProperties:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.showProperties(t)},resize:function(n,t,i){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.resize(t,i)},setShowHeaderProperties:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.showHeaderProperties=!n.blazor__instance.showHeaderProperties)},showPropertiesPaneOnSelection:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.showPropertiesPaneOnSelection()},getPreviousContext:function(n){return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)?"":n.blazor__instance.previousContext},navigateToUrl:function(n){window.open(n)}}}()},"./modules/sf-drop-down-button.js":function(){window.sfBlazor=window.sfBlazor||{};window.sfBlazor.DropDownButton=function(){"use strict";var n="mousedown touchstart",t=function(){function t(n,t,i){this.element=n;this.dotNetRef=i;this.popup=t;this.element.blazor__instance=this;this.addScrollEvents(!0)}return t.prototype.openPopup=function(t){this.popup.style.visibility="hidden";document.body.appendChild(this.popup);t&&sf.splitbuttons.setBlankIconStyle(this.popup);this.popup.classList.remove("e-transparent");var r=sf.popups.getZindexPartial(this.element),i=this.element.parentElement.classList.contains("e-colorpicker-container");i&&this.element.parentElement.blazor__instance.setPaletteWidth(this.popup.querySelector(".e-container"),!1,r);this.setPosition(i);sf.base.EventHandler.remove(document,n,this.mouseDownHandler);this.addEventListener();this.popup.style.zIndex=r+"";this.popup.style.visibility="";i&&this.element.parentElement.blazor__instance.setOffset(this.popup,r);this.popup.firstElementChild&&(this.popup.firstElementChild.firstElementChild&&i?this.popup.firstElementChild.firstElementChild.focus():this.popup.firstElementChild.focus())},t.prototype.setPosition=function(n){var u,r,t=this.element.getBoundingClientRect(),i=this.popup.getBoundingClientRect();n&&sf.base.Browser.isDevice?(u=document.documentElement.clientWidth/2-i.width/2+pageXOffset,r=document.documentElement.clientHeight/2-i.height/2+pageYOffset):(u=t.left+pageXOffset,r=t.bottom+pageYOffset,t.bottom+i.height>document.documentElement.clientHeight&&r-t.height-i.height>document.documentElement.clientTop&&(r=r-t.height-i.height),t.left+i.width>document.documentElement.clientWidth&&t.right-i.width>document.documentElement.clientLeft&&(u=u+t.width-i.width));this.popup.style.left=Math.ceil(u)+"px";this.popup.style.top=Math.ceil(r)+"px"},t.prototype.mouseDownHandler=function(n){var r,u,t,i;this.popup.parentElement?(r=n.target,u=!0,!sf.base.Browser.isDevice&&r.classList.contains("e-hsv-model")&&(t=r.parentElement.getBoundingClientRect(),i=this.element.getBoundingClientRect(),u=n.clientX>=t.left&&n.clientX<=t.right&&n.clientY>=t.top&&n.clientY<=t.bottom||n.clientX>=i.left&&n.clientX<=i.right&&n.clientY>=i.top&&n.clientY<=i.bottom),u&&(sf.base.closest(r,"#"+this.getDropDownButton().id)||sf.base.closest(n.target,"#"+this.popup.id)||sf.base.closest(n.target,".e-colorpicker.e-modal"))||(this.dotNetRef.invokeMethodAsync("ButtonClickAsync",null),this.removeEventListener())):this.removeEventListener()},t.prototype.keydownHandler=function(n){var i=this.getElement(),r=this.element.parentElement.classList.contains("e-colorpicker-container"),u=this.element.parentElement.classList.contains("e-rtl"),t;if(r&&this.element.parentElement.blazor__instance.paletteKeyDown(n,u),n.altKey)38===n.keyCode&&(n.stopPropagation(),n.preventDefault(),this.dotNetRef.invokeMethodAsync("ButtonClickAsync",null),i.focus(),this.removeEventListener());else{if(t=this.popup.firstElementChild,(27===n.keyCode||9===n.keyCode&&!r)&&(n.stopPropagation(),this.dotNetRef.invokeMethodAsync("ButtonClickAsync",null),27===n.keyCode&&n.preventDefault(),i.focus(),this.removeEventListener()),!t||!t.classList.contains("e-dropdown-menu"))return;if(13===n.keyCode)return n.preventDefault(),void(n.target.classList.contains("e-item")&&n.target.classList.contains("e-focused")?(i.focus(),this.removeEventListener()):n.stopPropagation());38!==n.keyCode&&40!==n.keyCode||(n.target.classList.contains("e-dropdown-menu")&&n.stopPropagation(),n.preventDefault(),sf.splitbuttons.upDownKeyHandler(t,n.keyCode))}},t.prototype.getElement=function(){return this.element.classList.contains("e-split-btn-wrapper")?this.element.firstElementChild:this.element},t.prototype.getDropDownButton=function(){return this.element.classList.contains("e-split-btn-wrapper")?this.element.getElementsByClassName("e-dropdown-btn")[0]:this.element},t.prototype.clickHandler=function(n){sf.base.closest(n.target,".e-item")&&(this.removeEventListener(),this.getElement().focus())},t.prototype.scrollHandler=function(n){var t,i;this.popup&&document.getElementById(this.popup.id)?(t=this.element.parentElement.classList.contains("e-colorpicker-container"),this.setPosition(t),t&&this.element.parentElement.blazor__instance.setOffset(this.popup)):(i=this.getDropDownButton(),i&&document.getElementById(i.id)||sf.base.EventHandler.remove(n.target,"scroll",this.scrollHandler))},t.prototype.addEventListener=function(t){if(sf.base.EventHandler.add(document,n,this.mouseDownHandler,this),sf.base.EventHandler.add(this.popup,"click",this.clickHandler,this),sf.base.EventHandler.add(this.popup,"keydown",this.keydownHandler,this),t&&this.popup.firstElementChild){var i=this.popup.querySelector(".e-focused");i?i.focus():this.popup.firstElementChild.focus()}},t.prototype.removeEventListener=function(t){if(sf.base.EventHandler.remove(document,n,this.mouseDownHandler),this.popup.parentElement&&(sf.base.EventHandler.remove(this.popup,"click",this.clickHandler),sf.base.EventHandler.remove(this.popup,"keydown",this.keydownHandler),t)){var i=this.getDropDownButton();i&&document.getElementById(i.id)&&(this.addScrollEvents(!1),this.element.appendChild(this.popup))}},t.prototype.addScrollEvents=function(n){for(var r,t=0,i=sf.popups.getScrollableParent(this.element);t<i.length;t++)r=i[t],n?sf.base.EventHandler.add(r,"scroll",this.scrollHandler,this):sf.base.EventHandler.remove(r,"scroll",this.scrollHandler)},t}();return{openPopup:function(n,i,r,u){sf.base.isNullOrUndefined(n)||(sf.base.isNullOrUndefined(n.blazor__instance)?new t(n,i,r):n.blazor__instance.popup=i,n.blazor__instance.openPopup(u))},addEventListener:function(n){n.blazor__instance.removeEventListener();n.blazor__instance.addEventListener(!0)},removeEventListener:function(n){n.blazor__instance.removeEventListener(!0)}}}()},"./modules/sf-dropdownlist.js":function(){window.sfBlazor=window.sfBlazor||{};window.sfBlazor.DropDownList=function(){"use strict";var n="e-list-group-item",t=function(){function t(n,t,i,r){this.activeIndex=null;this.prevSelectPoints={};this.containerElement=n;this.element=t;this.options=r;this.element.blazor__instance=this;this.dotNetRef=i}return t.prototype.initialize=function(){this.keyConfigure={tab:"tab",enter:"13",escape:"27",end:"35",home:"36",down:"40",up:"38",pageUp:"33",pageDown:"34",open:"alt+40",close:"shift+tab",hide:"alt+38",space:"32"};sf.base.Browser.isDevice||new sf.base.KeyboardEvents(this.containerElement,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"});"SfComboBox"===this.options.moduleName&&sf.base.EventHandler.add(this.element,"keydown",this.onFilterDown,this)},t.prototype.setAutoFillSelection=function(n){this.isAndroidAutoFill(n)||this.autoFillSelection(n)},t.prototype.onFilterDown=function(n){13!==n.keyCode&&40!==n.keyCode&&38!==n.keyCode&&9!==n.keyCode&&(this.prevSelectPoints=this.getSelectionPoints())},t.prototype.getSelectionPoints=function(){var n=this.element;return{start:Math.abs(n.selectionStart),end:Math.abs(n.selectionEnd)}},t.prototype.autoFillSelection=function(n){var i=this.getSelectionPoints(),t=this.element.value.substr(0,i.start),r;t&&t.toLowerCase()===n.substr(0,i.start).toLowerCase()?(r=t+n.substr(t.length,n.length),this.element.value=r,this.element.setSelectionRange(i.start,this.element.value.length)):(this.element.value=n,this.element.setSelectionRange(0,this.element.value.length))},t.prototype.isAndroidAutoFill=function(n){if(sf.base.Browser.isAndroid){var r=this.getSelectionPoints(),t=this.prevSelectPoints.end,u=r.end,i=this.prevSelectPoints.start,f=r.start;return 0!==t&&(t===n.length&&i===n.length||i>f&&t>u||t===u&&i===f)}return!1},t.prototype.removeFillSelection=function(){var n=this.getSelectionPoints();this.element.setSelectionRange(n.end,n.end)},t.prototype.keyActionHandler=function(n){var t={Action:n.action,Key:n.key,Events:n,Type:n.type};this.isDisposed||this.dotNetRef.invokeMethodAsync("KeyActionHandler",t);"tab"!==n.action&&"close"!==n.action&&"space"!==n.action&&"enter"!==n.action&&"open"!==n.action&&("SfDropDownList"===this.options.moduleName||"home"!==n.action&&"end"!==n.action)&&n.preventDefault()},t.prototype.getOffsetValue=function(n){var t=getComputedStyle(n),i=parseInt(t.borderTopWidth,10),r=parseInt(t.borderBottomWidth,10);return this.setPopupPosition(i+r)},t.prototype.setPopupPosition=function(n){var i,e=n,r=this.list.querySelector(".e-item-focus")||this.list.querySelector(".e-active"),o=this.isEmptyList()?this.list:this.liCollections[0],c=this.isEmptyList()?this.list:this.liCollections[this.getItems().length-1],t=o.getBoundingClientRect().height,u=this.list.offsetHeight/2,f=sf.base.isNullOrUndefined(r)?o.offsetTop:r.offsetTop,s,h;return c.offsetTop-u<f&&!sf.base.isNullOrUndefined(this.liCollections)&&this.liCollections.length>0&&!sf.base.isNullOrUndefined(r)?(s=this.list.offsetHeight/t,h=parseInt(getComputedStyle(this.list).paddingBottom,10),i=(s-(this.liCollections.length-this.activeIndex))*t-e+h,this.list.scrollTop=r.offsetTop):f>u?(i=u-t/2,this.list.scrollTop=f-u+t/2):i=f,-(i=i+t+e-(t-this.containerElement.offsetHeight)/2)},t.prototype.getItems=function(){return this.list?this.list.querySelectorAll(".e-list-item"):[]},t.prototype.renderPopup=function(n,t,i,r,u){var p,c,l,f,a,e,w,o,b,k,s,v,d,h,y,g;if(this.options=u,this.popupHolder=t,this.list=t.querySelector(".e-content")||sf.base.select(".e-content"),this.liCollections=this.getItems(),l=0,f=sf.base.formatUnit(this.options.popupHeight),(this.wireListEvents(),n)&&(a=document.getElementById(n.id),a&&sf.base.remove(a)),(document.body.appendChild(n),n.style.visibility="hidden",this.options.allowFiltering&&("SfDropDownList"===this.options.moduleName?(this.filterInput=n.querySelector("input.e-input"),c=this.filterInput.parentElement,new sf.base.KeyboardEvents(this.filterInput,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"})):this.filterInput=this.element),"auto"!==this.options.popupHeight)?(e=0,(sf.base.isNullOrUndefined(c)||(e=c.parentElement.getBoundingClientRect().height,f=(parseInt(f,10)-e).toString()+"px"),n.querySelector(".e-ddl-header"))&&(w=n.querySelector(".e-ddl-header"),o=Math.round(w.getBoundingClientRect().height),f=(parseInt(f,10)-(o+e)).toString()+"px"),n.querySelector(".e-ddl-footer")&&(b=n.querySelector(".e-ddl-footer"),o=Math.round(b.getBoundingClientRect().height),f=(parseInt(f,10)-(o+e)).toString()+"px"),this.list.style.maxHeight=(parseInt(f,10)-2).toString()+"px",n.style.maxHeight=sf.base.formatUnit(this.options.popupHeight)):n.style.height="auto",(this.list&&this.list.querySelector(".e-active")&&this.setScrollPosition(),sf.base.Browser.isDevice&&!this.options.allowFiltering&&("SfDropDownList"===this.options.moduleName||"SfComboBox"===this.options.moduleName))&&(l=this.getOffsetValue(n),k=this.isEmptyList()?this.list:this.liCollections[0],p=-(parseInt(getComputedStyle(k).textIndent,10)-parseInt(getComputedStyle(this.element).paddingLeft,10)+parseInt(getComputedStyle(this.element.parentElement).borderLeftWidth,10))),this.popupCreation(n,l,p),this.checkCollision(n),sf.base.Browser.isDevice&&(this.popupObj.element.classList.add("e-ddl-device"),("SfDropDownList"===this.options.moduleName||"SfComboBox"===this.options.moduleName&&!this.options.allowFiltering)&&(this.popupObj.collision={X:"fit",Y:"fit"}),this.options.allowFiltering&&"SfDropDownList"===this.options.moduleName&&(this.popupObj.element.classList.add("e-ddl-device-filter"),this.popupObj.position={X:0,Y:0},this.popupObj.dataBind(),sf.base.attributes(this.popupObj.element,{style:"left:0px;right:0px;top:0px;bottom:0px;"}),sf.base.addClass([document.body,this.popupObj.element],"e-popup-full-page"),this.setSearchBoxPosition())),n.style.visibility="visible",sf.base.addClass([n],"e-popup-close"),sf.base.Browser.isDevice){if("SfDropDownList"===this.options.moduleName&&!this.options.allowFiltering||"SfComboBox"===this.options.moduleName&&!this.options.allowFiltering)for(s=0,v=this.popupObj.getScrollableParent(this.containerElement);s<v.length;s++)d=v[s],sf.base.EventHandler.add(d,"scroll",this.scrollHandler,this);this.isFilterLayout()&&sf.base.EventHandler.add(this.list,"scroll",this.listScroll,this)}if(null!==i&&null!==i.popup&&r){for(h=0,y=Object.keys(i.popup);h<y.length;h++)switch(y[h]){case"collision":i.popup.collision&&(this.popupObj.collision.X!==i.popup.collision.X.toLowerCase()||this.popupObj.collision.Y!==i.popup.collision.Y.toLowerCase())&&(this.popupObj.collision={X:i.popup.collision.X.toLowerCase(),Y:i.popup.collision.Y.toLowerCase()});break;case"position":this.popupObj.position&&(this.popupObj.position.X!==i.popup.position.X||this.popupObj.position.Y!==i.popup.position.Y)&&(this.popupObj.position={X:i.popup.position.X,Y:i.popup.position.Y});break;case"relateTo":this.popupObj.relateTo!==i.popup.relateTo&&(this.popupObj.relateTo=i.popup.relateTo);break;case"targetType":this.popupObj.targetType!==i.popup.targetType.toLowerCase()&&(this.popupObj.targetType=i.popup.targetType);break;case"offsetX":this.popupObj.offsetX!==i.popup.offsetX&&(this.popupObj.offsetX=i.popup.offsetX);break;case"offsetY":this.popupObj.offsetY!==i.popup.offsetY&&(this.popupObj.offsetY=i.popup.offsetY)}this.popupObj.dataBind();this.popupObj.refreshPosition(this.popupObj.relateTo,!0)}this.options.enableVirtualization&&sf.base.EventHandler.add(this.list,"scroll",this.virtualScroll,this);sf.base.attributes(this.containerElement,{"aria-expanded":"true"});g=this.options.allowFiltering?this.filterInput.parentElement:this.containerElement;sf.base.addClass([g],["e-input-focus"]);this.popupObj.show(new sf.base.Animation({name:"FadeIn",duration:100}),1e3===this.options.zIndex?this.element:null)},t.prototype.wireListEvents=function(){sf.base.EventHandler.add(this.list,"mouseover",this.onMouseOver,this);sf.base.EventHandler.add(this.list,"mouseout",this.onMouseLeave,this)},t.prototype.unWireListEvents=function(){sf.base.EventHandler.remove(this.list,"mouseover",this.onMouseOver);sf.base.EventHandler.remove(this.list,"mouseout",this.onMouseLeave)},t.prototype.onMouseOver=function(n){var t=sf.base.closest(n.target,".e-list-item");this.setHover(t)},t.prototype.onMouseLeave=function(){this.removeHover()},t.prototype.listScroll=function(){this.filterInput.blur()},t.prototype.scrollHandler=function(){this.isDisposed||this.dotNetRef.invokeMethodAsync("Hide")},t.prototype.setFloatingHeader=function(t){var i=this.popupContainer&&this.popupContainer.querySelector(".e-content");i&&i.classList.contains("e-nodata")&&this.fixedHeaderElement?(sf.base.remove(this.fixedHeaderElement),this.fixedHeaderElement=null):this.list&&this.list.querySelector("li")&&(sf.base.isNullOrUndefined(this.fixedHeaderElement)&&(this.fixedHeaderElement=sf.base.createElement("div",{className:"e-fixed-head"}),this.list.querySelector("li").classList.contains(n)||(this.fixedHeaderElement.style.display="none"),sf.base.prepend([this.fixedHeaderElement],this.list),this.setFixedHeader()),this.scrollStop(t))},t.prototype.setFixedHeader=function(){var t,i,r;this.list.parentElement.style.display="block";t=0;this.list&&this.list.parentElement&&(t=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-width"),10));i=this.liCollections[0].offsetWidth-t;this.fixedHeaderElement.style.width=i.toString()+"px";sf.base.setStyleAttribute(this.fixedHeaderElement,{zIndex:10});r=this.list.querySelector("."+n);this.fixedHeaderElement.innerHTML=r.innerHTML},t.prototype.scrollStop=function(t){for(var u,f=t.target,r=this.list.querySelectorAll("li"),e=parseInt(getComputedStyle(r[0],null).getPropertyValue("height"),10),i=Math.round(f.scrollTop/e);i>-1;i--){if(!sf.base.isNullOrUndefined(r[i])&&r[i].classList.contains(n)){u=r[i];this.fixedHeaderElement.innerHTML=u.innerHTML;this.fixedHeaderElement.style.top=t.target.scrollTop+"px";this.fixedHeaderElement.style.display="block";break}this.fixedHeaderElement.style.display="none";this.fixedHeaderElement.style.top="none"}},t.prototype.isFilterLayout=function(){return"SfDropDownList"===this.options.moduleName&&this.options.allowFiltering},t.prototype.setSearchBoxPosition=function(){var n=this.filterInput.parentElement.getBoundingClientRect().height;this.popupObj.element.style.maxHeight="100%";this.popupObj.element.style.width="100%";this.list.style.maxHeight=window.innerHeight-n+"px";this.list.style.height=window.innerHeight-n+"px"},t.prototype.checkCollision=function(n){(!sf.base.Browser.isDevice||sf.base.Browser.isDevice&&"SfDropDownList"!==this.options.moduleName)&&sf.popups.isCollide(n).length>0&&(n.style.marginTop=-parseInt(getComputedStyle(n).marginTop,10)+"px")},t.prototype.destroy=function(){sf.base.EventHandler.remove(document,"mousedown",this.onDocumentClick)},t.prototype.refreshPopup=function(){this.isPopupOpen()&&(this.popupObj.refreshPosition(this.containerElement),this.popupObj.element.querySelector(".e-content").classList.contains("e-nodata")&&this.fixedHeaderElement&&(sf.base.remove(this.fixedHeaderElement),this.fixedHeaderElement=null))},t.prototype.popupCreation=function(t,i,r){var u=this;this.popupContainer=t;this.popupObj=new sf.popups.Popup(this.popupContainer,{width:this.setWidth(),targetType:"relative",relateTo:this.containerElement,collision:{X:"flip",Y:"flip"},offsetY:i,enableRtl:this.options.enableRtl,offsetX:r,position:{X:"left",Y:"bottom"},zIndex:this.options.zIndex,close:function(){var n,t,i;for(sf.base.EventHandler.remove(u.list,"scroll",u.setFloatingHeader),sf.base.removeClass([u.containerElement],"e-icon-anim"),u.fixedHeaderElement=null,u.popupHolder.appendChild(u.popupContainer),u.unWireListEvents(),n=0,t=u.popupObj.getScrollableParent(u.containerElement);n<t.length;n++)i=t[n],sf.base.EventHandler.remove(i,"scroll",u.scrollHandler);sf.base.Browser.isDevice&&u.isFilterLayout()&&(sf.base.removeClass([document.body,u.popupObj.element],"e-popup-full-page"),sf.base.EventHandler.remove(u.list,"scroll",u.listScroll));u.options.enableVirtualization&&sf.base.EventHandler.remove(u.list,"scroll",u.virtualScroll);u.popupObj&&u.popupObj.destroy();!u.isDisposed&&document.body.contains(u.element)&&u.dotNetRef.invokeMethodAsync("ClosePopup").catch(function(){});u.popupObj=null},open:function(){sf.base.EventHandler.add(document,"mousedown",u.onDocumentClick,u);u.options.allowFiltering&&u.filterInput&&u.filterInput.focus();u.list.querySelector("li")&&u.list.querySelector("li").classList.contains(n)&&sf.base.EventHandler.add(u.list,"scroll",u.setFloatingHeader,u)},targetExitViewport:function(){sf.base.Browser.isDevice||u.isDisposed||u.dotNetRef.invokeMethodAsync("Hide")}})},t.prototype.virtualScroll=function(){var n,t;this.popupObj&&this.popupObj.element&&(n=parseInt(getComputedStyle(this.popupObj.element).borderWidth,10),n=0==n?1:n,t=this.popupObj.element.classList.contains("e-popup-open"),this.list.scrollTop+this.list.offsetHeight+n>=this.list.scrollHeight&&t&&!this.isDisposed&&this.dotNetRef.invokeMethodAsync("VirtualScrollHandler"))},t.prototype.isEmptyList=function(){return!sf.base.isNullOrUndefined(this.liCollections)&&0===this.liCollections.length},t.prototype.setWidth=function(){var n=sf.base.formatUnit(this.options.popupWidth),t;return n.indexOf("%")>-1&&(n=(this.containerElement.offsetWidth*parseFloat(n)/100).toString()+"px"),sf.base.Browser.isDevice&&!this.options.allowFiltering&&(t=this.isEmptyList()?this.list:this.liCollections[0],n=parseInt(n,10)+2*(parseInt(getComputedStyle(t).textIndent,10)-parseInt(getComputedStyle(this.element).paddingLeft,10)+parseInt(getComputedStyle(this.element.parentElement).borderLeftWidth,10))+"px"),n},t.prototype.onDocumentClick=function(n){var t=n.target;!sf.base.isNullOrUndefined(this.popupObj)&&sf.base.closest(t,"#"+this.popupObj.element.id)||this.containerElement.contains(n.target)?t===this.element||this.options.allowFiltering&&t===this.filterInput||"SfComboBox"===this.options.moduleName&&!this.options.allowFiltering&&sf.base.Browser.isDevice&&t===this.containerElement.querySelector(".e-ddl-icon")||n.preventDefault():(this.containerElement.classList.contains("e-input-focus")||this.isPopupOpen()&&!this.isDisposed)&&this.dotNetRef.invokeMethodAsync("Hide")},t.prototype.closePopup=function(n,t){(this.options=t,this.isPopupOpen()&&!n.cancel&&this.popupObj)&&this.popupObj.hide(new sf.base.Animation({name:"FadeOut",duration:20,delay:0}))},t.prototype.setScrollPosition=function(n){if(sf.base.isNullOrUndefined(n))this.scrollBottom(!0);else switch(n.action){case"pageDown":case"down":case"end":this.scrollBottom();break;default:this.scrollTop()}},t.prototype.scrollBottom=function(t){var i;if(this.list&&(this.list.querySelector(".e-item-focus")||this.list.querySelector(".e-active"))){var r=this.list.querySelector(".e-item-focus")||this.list.querySelector(".e-active"),f=this.list.offsetHeight,o=this.list.querySelector("li").classList.contains(n),e=r.offsetTop+r.offsetHeight-this.list.scrollTop,u=this.list.scrollTop+e-f;u=t?u+2*parseInt(getComputedStyle(this.list).paddingTop,10):u;i=r.offsetTop+r.offsetHeight-this.list.scrollTop;i=o&&!sf.base.isNullOrUndefined(this.fixedHeaderElement)?i-this.fixedHeaderElement.offsetHeight:i;0===this.activeIndex?this.list.scrollTop=0:(e>f||!(i>0&&this.list.offsetHeight>i))&&(this.list.scrollTop=u)}},t.prototype.scrollTop=function(){var r;if(this.list&&(this.list.querySelector(".e-item-focus")||this.list.querySelector(".e-active"))){var i=this.list.querySelector(".e-item-focus")||this.list.querySelector(".e-active"),t=i.offsetTop-this.list.scrollTop,u=this.list.querySelector("li").classList.contains(n);t=u&&!sf.base.isNullOrUndefined(this.fixedHeaderElement)?t-this.fixedHeaderElement.offsetHeight:t;r=i.offsetTop+i.offsetHeight-this.list.scrollTop;0===this.activeIndex?this.list.scrollTop=0:t<0?this.list.scrollTop=this.list.scrollTop+t:r>0&&this.list.offsetHeight>r||(this.list.scrollTop=i.offsetTop-(u&&!sf.base.isNullOrUndefined(this.fixedHeaderElement)?this.fixedHeaderElement.offsetHeight:0))}},t.prototype.setHover=function(n){n&&!n.classList.contains("e-hover")&&(this.removeHover(),sf.base.addClass([n],"e-hover"))},t.prototype.removeHover=function(){if(this.list){var n=this.list.querySelectorAll(".e-hover");n&&n.length&&sf.base.removeClass(n,"e-hover")}},t.prototype.isPopupOpen=function(){return this.popupObj&&document.body.contains(this.popupObj.element)},t}();return{initialize:function(n,i,r,u){i&&(new t(n,i,r,u),i.blazor__instance&&i.blazor__instance.initialize())},renderPopup:function(n,t,i,r,u,f,e){n&&n.blazor__instance&&t&&i&&n.blazor__instance.renderPopup(t,i,r,u,f,e)},refreshPopup:function(n){n&&n.blazor__instance&&n.blazor__instance.refreshPopup()},closePopup:function(n,t,i){n&&n.blazor__instance&&n.blazor__instance.closePopup(t,i)},updateScrollPosition:function(n,t){n&&n.blazor__instance&&n.blazor__instance.setScrollPosition(t)},getPageCount:function(n){var t=n&&n.querySelector(".e-content"),i;return t?(i=t.classList.contains("e-nodata")?null:getComputedStyle(t.querySelectorAll(".e-list-item")[0],null).getPropertyValue("height"),Math.round(t.getBoundingClientRect().height/parseInt(i,10))):0},setAutoFillSelection:function(n,t){n&&n.blazor__instance&&n.blazor__instance.setAutoFillSelection(t)},removeFillSelection:function(n){n&&n.blazor__instance&&n.blazor__instance.removeFillSelection()},focusIn:function(n){n&&n.focus()},focusOut:function(n){n&&n.blur()},destroy:function(n,t,i,r,u){n&&n.blazor__instance&&(t&&_instanceof(t,HTMLElement)&&i&&(n.blazor__instance.isDisposed=!0,n.blazor__instance.closePopup(r,u)),n.blazor__instance.destroy())}}}()},"./modules/sf-listbox.js":function(){window.sfBlazor=window.sfBlazor||{};window.sfBlazor.ListBox=function(){"use strict";var n="e-list-item",t=function(){function t(n,t,i,r){this.element=n;this.dotnetRef=r;this.allowDragAndDrop=i;this.element.blazor__instance=this;this.scope=t;sf.base.EventHandler.add(this.element,"keydown",this.keyDownHandler,this);i&&this.initializeDraggable()}return t.prototype.initializeDraggable=function(){var t=this,i,r;this.allowDragAndDrop&&(i=sf.base.select(".e-ul",this.element),r=new sf.lists.Sortable(i,{scope:this.scope,itemClass:n,beforeDragStart:this.triggerBeforeDragStart.bind(this),dragStart:this.triggerDragStart.bind(this),beforeDrop:this.dragEnd.bind(this),placeHolder:function(){return sf.base.createElement("span",{className:"e-placeholder"})},helper:function(i){var r=t.element.cloneNode(),e=i.sender.cloneNode(!0),f,u;return r.appendChild(e),f=sf.base.select("."+n,t.element),r.style.width=f.offsetWidth+"px",r.style.height=f.offsetHeight+"px",u=[].slice.call(sf.base.selectAll("."+n+".e-selected",t.element)),u.length&&u.length>1&&u.indexOf(i.sender)>-1&&e.appendChild(sf.base.createElement("span",{className:"e-list-badge",innerHTML:u.length.toString()})),r.style.zIndex=sf.popups.getZindexPartial(t.element).toString(),r}}),this.updateDraggable(r,this.allowDragAndDrop))},t.prototype.triggerBeforeDragStart=function(n){n.cancel=n.target.classList.contains("e-drag-prevent")},t.prototype.triggerDragStart=function(n){n.bindEvents(n.dragElement)},t.prototype.dragEnd=function(n){var r,u,t,f=!1,i=!1,e=!1;t=n.target.parentElement.parentElement;"UL"==n.target.tagName&&n.target.className.indexOf("e-list-parent")>-1&&(t=n.target.parentElement);t.blazor__instance||(t=t.parentElement);n.cancel=!0;t.blazor__instance?(r=t.blazor__instance.scope,u=t.blazor__instance.dotnetRef,i=this.scope===r,this.element===t&&(e=!0,i=!1)):f=!0;this.dotnetRef.invokeMethodAsync("DragEndAsync",f,n.droppedElement.getAttribute("data-value"),e,i,n.previousIndex,n.currentIndex,u)},t.prototype.keyDownHandler=function(t){var f=t.target,u,r,i;if(38===t.keyCode||40===t.keyCode)if(t.preventDefault(),f.classList.contains("e-listbox-container"))u=sf.base.select("."+n,this.element),u&&u.focus();else{if(r=[].slice.call(sf.base.selectAll("."+n,this.element)),i=r.indexOf(f),i<0)return;if((i=38===t.keyCode?i-1:i+1)<0||i>r.length-1)return;r[i].focus()}else 65===t.keyCode&&t.ctrlKey&&t.preventDefault()},t.prototype.updateDraggable=function(t,i){if(t){var r=sf.base.getComponent(t.element,sf.base.Draggable);r.abort=i?"":"."+n}},t.prototype.destroyDraggable=function(){var n=sf.base.getComponent(sf.base.select(".e-ul",this.element),"sortable");sf.base.isNullOrUndefined(n)||(this.updateDraggable(n,this.allowDragAndDrop),n.destroy())},t.prototype.destroy=function(){this.destroyDraggable();sf.base.EventHandler.remove(this.element,"keydown",this.keyDownHandler)},t.prototype.onPropertyChanged=function(n){this.allowDragAndDrop=n;n?this.initializeDraggable():this.destroyDraggable()},t.prototype.getScopedElement=function(n){return document.querySelector("#"+n).blazor__instance.dotnetRef},t}();return{initialize:function(n,i,r,u){sf.base.isNullOrUndefined(n)||new t(n,i,r,u)},destroy:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.destroy()},onPropertyChanged:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.onPropertyChanged(t)},getScopedListBox:function(n,t){return n.blazor__instance.getScopedElement(t)}}}()},"./modules/sf-listview.js":function(){window.sfBlazor=window.sfBlazor||{};window.sfBlazor.ListView=function(){"use strict";var f={None:[],SlideLeft:["SlideRightOut","SlideLeftOut","SlideLeftIn","SlideRightIn"],SlideDown:["SlideTopOut","SlideBottomOut","SlideBottomIn","SlideTopIn"],Zoom:["FadeOut","FadeZoomOut","FadeZoomIn","FadeIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},e={None:[],SlideLeft:["SlideLeftOut","SlideRightOut","SlideRightIn","SlideLeftIn"],SlideDown:["SlideBottomOut","SlideTopOut","SlideTopIn","SlideBottomIn"],Zoom:["FadeZoomOut","FadeOut","FadeIn","FadeZoomIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},n="e-focused",i="e-list-item",t="e-has-child",u="e-list-header",r="e-disabled",o=function(){function o(n,t,i,r,u){this.dataSourceLevel=["defaultData_Key"];this.currentDataSourceKey="defaultData_Key";this.isWindow=!1;this.liDifference=0;this.liHeight=0;this.virtualListDifference=0;this.isCheckAll=!1;this.element=n;this.dotNetRef=t;this.showCheckBox=i.ShowCheckBox;this.showHeader=i.ShowHeader;this.enable=i.Enabled;this.currentUlElement=n.querySelector("ul");this.enableVirtualization=i.EnableVirtualization;this.isWindow=!i.Height;this.enableSelectEvent=r;this.height=i.Height;this.headerTitleInfo=[i.HeaderTitle];this.selectedItems={defaultData_Key:i.SelectedElementIdInfo};this.enableRtl=i.EnableRtl;this.animation=i.Animation;this.isTemplate=i.Template;this.focusId=[];this.element.blazor__instance=this;this.datasource=u}return o.prototype.initialize=function(){if(this.enableVirtualization){if(this.isWindow)this.dotNetRef.invokeMethodAsync("GetComponenetHeight",window.innerHeight);else if(-1!==this.height.indexOf("%")){var n=this.element.parentElement.getBoundingClientRect().height;this.dotNetRef.invokeMethodAsync("GetComponenetHeight",n/100*parseFloat(this.height))}this.updateLiElementHeight()}this.headerElement=this.element.querySelector(".e-headertext");this.animationObject=new sf.base.Animation(this.animateOptions);this.wireEvents()},o.prototype.wireEvents=function(){sf.base.EventHandler.add(this.element,"focus",this.focusHandler,this);sf.base.EventHandler.add(this.element,"mousedown",this.mouseDownHandler,this);sf.base.EventHandler.add(this.element,"keydown",this.keyActionHandler,this);sf.base.EventHandler.add(this.element,"click",this.clickHandler,this);sf.base.EventHandler.add(this.element,"focusout",this.removeFocus,this);this.touchModule=new sf.base.Touch(this.element,{swipe:this.swipeActionHandler.bind(this)});this.enableVirtualization?(sf.base.EventHandler.add(this.element,"scroll",this.scrollHandler,this),this.isWindow&&window.addEventListener("scroll",this.scrollHandler.bind(this))):(sf.base.EventHandler.add(this.element,"mouseover",this.mouseHoverHandler,this),sf.base.EventHandler.add(this.element,"mouseout",this.mouseOutHandler,this))},o.prototype.unWireEvents=function(){sf.base.EventHandler.remove(this.element,"focus",this.focusHandler);sf.base.EventHandler.remove(this.element,"mousedown",this.mouseDownHandler);sf.base.EventHandler.remove(this.element,"keydown",this.keyActionHandler);sf.base.EventHandler.remove(this.element,"click",this.clickHandler);sf.base.EventHandler.remove(this.element,"focusout",this.removeFocus);this.enableVirtualization?(sf.base.EventHandler.remove(this.element,"scroll",this.scrollHandler),this.isWindow&&window.removeEventListener("scroll",this.scrollHandler.bind(this))):(sf.base.EventHandler.remove(this.element,"mouseover",this.mouseHoverHandler),sf.base.EventHandler.remove(this.element,"mouseout",this.mouseOutHandler));this.touchModule.destroy()},o.prototype.swipeActionHandler=function(n){"Right"===n.swipeDirection&&n.velocity>.5&&"touchend"===n.originalEvent.type&&(this.showCheckBox&&this.dataSourceLevel[this.dataSourceLevel.length-1]&&this.uncheckAllItems(),this.back())},o.prototype.showHideItem=function(n,t){var i=this.getLi(n);i&&(i.style.display=t)},o.prototype.enableState=function(n,t){var i=this.getLi(n);i&&(t?i.classList.remove("e-disabled"):i.classList.add("e-disabled"))},o.prototype.getLi=function(n){var t;return this.element&&(t=this.element.querySelector('[data-uid="'+n.id+'"]')),t},o.prototype.scrollHandler=function(t){var i,f=this.isWindow?t.target.documentElement.scrollTop:t.target.scrollTop,r,u;(this.liHeight||this.updateLiElementHeight(),(i=Math.round(f/this.liHeight))-this.liDifference>=this.virtualListDifference||i-this.liDifference<=-1)&&(r=this.currentUlElement.querySelector("."+n),r&&(this.focusedElementId=r.getAttribute("data-uid")),u=this.element.querySelector(".e-list-virtualcontainer"),u&&(u.style.top=(i-1)*this.liHeight<0?"0px":(i-2)*this.liHeight+"px",this.liDifference=i,this.dotNetRef.invokeMethodAsync("VirtualScrolling",i-2)))},o.prototype.preventSelection=function(n){var t=this.mouseEvent.target,r=sf.base.closest(t.parentNode,"."+i);n?this.dataSourceLevel.length>1&&this.dataSourceLevel.pop():this.performSelection(r)},o.prototype.performSelection=function(i){null!==i&&!i.classList.contains(r)&&this.enable&&(this.removeFocus(),this.focusId=[],this.addFocusId(i.getAttribute("data-uid")),this.showCheckBox?this.mouseEvent.target.classList.contains("e-frame")?this.checkUncheckItem(i):i.classList.contains(t)?(this.removeHover(),this.removeFocus(),this.setSelectLI(i,this.mouseEvent)):this.checkUncheckItem(i):(this.currentUlElement.querySelector("."+n)&&this.currentUlElement.querySelector("."+n).classList.remove(n),i.classList.contains(t)?this.setSelectLI(i,this.mouseEvent):i.classList.contains(n)||(i.classList.add(n),this.selectedItems[this.currentDataSourceKey][0]=i.getAttribute("data-uid"))))},o.prototype.updateLiElementHeight=function(){var n=this.element.querySelector(".e-list-virtualcontainer"),t,i;n&&(this.currentUlElement||(this.currentUlElement=this.element.querySelector("ul")),t=n.children[0],t&&(this.liHeight=t.getBoundingClientRect().height,this.liHeight)&&(this.enableVirtualization&&(i=n.getBoundingClientRect().height,n.parentElement.style.height=i+"px"),this.dotNetRef.invokeMethodAsync("UpdateLiElementHeight",this.liHeight)))},o.prototype.updateElementDifference=function(n){this.virtualListDifference=n;this.enableVirtualization&&this.updateLiElementHeight()},o.prototype.selectItem=function(n){var t=this.getLi(n);this.showCheckBox?this.setChecked(t,t.querySelector(".e-checkbox-wrapper")):(sf.base.isNullOrUndefined(t)?this.removeFocus():this.setSelectLI(t,null),this.selectedItems[this.currentDataSourceKey][0]=t.getAttribute("data-uid"))},o.prototype.clickHandler=function(n){var f,e,u,o;this.currentUlElement&&!this.element.classList.contains("e-disabled")&&(f=n.target,e=f.classList,(this.mouseEvent=n,e.contains("e-icon-back")||e.contains("e-headertext"))?this.back():(u=sf.base.closest(f.parentNode,"."+i)?sf.base.closest(f.parentNode,"."+i):sf.base.closest(f,"."+i),(this.enableSelectEvent||this.performSelection(u),null!==u&&!u.classList.contains(r)&&this.enable)&&(u.classList.contains(t)&&(o=u.getAttribute("data-uid"),-1===this.dataSourceLevel.indexOf(o)&&this.dataSourceLevel.push(o)),this.enableSelectEvent&&this.getSelectEventData(u,n))))},o.prototype.checkUncheckItem=function(t){t.classList.add(n);t.querySelector(".e-check")?this.uncheckItem(t):this.setChecked(t,t.querySelector(".e-checkbox-wrapper"));this.dotNetRef.invokeMethodAsync("UpdateData",!sf.base.isNullOrUndefined(t.querySelector(".e-check")),t.getAttribute("data-uid"))},o.prototype.back=function(){var f;if(this.dataSourceLevel.length>1){for(var i=this.element.querySelectorAll("ul"),r=this.element.querySelector("."+u),t=0;t<i.length;t++)this.dataSourceLevel.length>2?i[t].getAttribute("pid")===this.dataSourceLevel[this.dataSourceLevel.length-2]?(this.switchView(this.currentUlElement,i[t],!0),this.currentUlElement=i[t]):i[t].style.display="none":null===i[t].getAttribute("pid")?(this.switchView(this.currentUlElement,i[t],!0),this.currentUlElement=i[t]):i[t].style.display="none";(this.dataSourceLevel.pop(),this.showCheckBox)||this.currentUlElement.querySelectorAll("."+n)[0].setAttribute("aria-selected","false");this.isTemplate||(this.headerTitleInfo.length>1&&this.headerTitleInfo.pop(),this.headerElement&&(this.headerElement.innerText=this.headerTitleInfo[this.headerTitleInfo.length-1]));this.currentDataSourceKey=this.dataSourceLevel[this.dataSourceLevel.length-1];1===this.dataSourceLevel.length&&r&&(r.children[0].style.display="none");f={IsInteracted:!(!event&&!this.isRootFocus),Level:this.dataSourceLevel.length>0?this.dataSourceLevel.length-1:this.dataSourceLevel.length};this.dotNetRef.invokeMethodAsync("TriggerBackEvent",f)}},o.prototype.setHoverLI=function(n){this.element.classList.contains(r)||n.classList.contains(r)||n.classList.add("e-hover")},o.prototype.mouseHoverHandler=function(n){var t=sf.base.closest(n.target.parentNode,"."+i);t&&this.setHoverLI(t)},o.prototype.mouseOutHandler=function(){this.removeHover()},o.prototype.removeHover=function(){var n=this.element.querySelector(".e-hover");n&&n.classList.remove("e-hover")},o.prototype.removeFocus=function(){this.currentUlElement||(this.currentUlElement=this.element.querySelector("ul"));for(var t=0,i=this.currentUlElement.querySelectorAll("."+n);t<i.length;t++)i[t].classList.remove(n);this.isRestrictFocus=void 0},o.prototype.isValidLI=function(n){return n&&n.classList.contains(i)&&!n.classList.contains("e-list-group-item")&&!n.classList.contains(r)},o.prototype.setSelectLI=function(i){if(this.enable&&this.isValidLI(i)&&!i.classList.contains(n)){var r=this.currentUlElement.querySelector("."+n);r&&this.removeFocusId(r.getAttribute("data-uid"));this.removeFocus();this.addAriaAttribute(!0,i);this.removeHover();i.classList.contains(t)&&this.renderSubList(i)}},o.prototype.addAriaAttribute=function(i,r){i?(this.isCheckAll||r.classList.add(n),this.addFocusId(r.getAttribute("data-uid"))):this.showCheckBox||i||!r.classList.contains(n)||(r.classList.remove(n),this.focusId.indexOf(r.getAttribute("data-uid"))>=0&&this.focusId.splice(this.focusId.indexOf(r.getAttribute("data-uid")),1));(this.showCheckBox||r.classList.contains(t))&&r.setAttribute("aria-selected",i.toString())},o.prototype.renderSubList=function(i){var f=i,r=i.getAttribute("data-uid"),e=this.element.querySelector("."+u),o;(i.classList.remove(n),i.classList.add(n),this.showHeader&&e&&(e.children[0].style.display=null),f.classList.contains(t)&&r)&&(this.element.querySelector("[pid='"+r+"']")?this.renderChildList(r,[r]):(o={ElementId:r,Key:this.currentDataSourceKey},this.dotNetRef.invokeMethodAsync("ListChildDataSource",o)),this.isTemplate||(this.headerTitleInfo.push(f.innerText.trim()),this.headerElement&&(this.headerElement.innerText=this.headerTitleInfo[this.headerTitleInfo.length-1])),this.dataSourceLevel.push(r),this.currentDataSourceKey=r)},o.prototype.renderChildList=function(n,t){var i=this.element.querySelectorAll("ul"),r,u,f;for(i[i.length-1].getAttribute("pid")||i[i.length-1].setAttribute("pid",n),r=0;r<i.length;r++)if(i[r].getAttribute("pid")===n){if(this.switchView(this.currentUlElement,i[r],!1),this.currentUlElement=i[r],u=i[r].querySelectorAll(".e-list-item"),u[0].getAttribute("aria-level")!==r.toString())for(f=0;f<u.length;f++)u[f].setAttribute("aria-level",r.toString());t&&(this.selectedItems[n]=t)}},o.prototype.mouseDownHandler=function(){this.isRestrictFocus=null==this.isRestrictFocus||this.isRestrictFocus},o.prototype.focusHandler=function(n){this.isRestrictFocus?this.isRestrictFocus=!1:sf.base.isNullOrUndefined(this.focusId)||0==this.focusId.length?(this.isRootFocus=!0,this.arrowKeyHandler(n),this.isRootFocus=!1):this.updateFocusElement(n)},o.prototype.keyActionHandler=function(n){switch(n.keyCode){case 36:this.homeKeyHandler(n);break;case 35:this.homeKeyHandler(n,!0);break;case 40:this.arrowKeyHandler(n);break;case 38:this.arrowKeyHandler(n,!0);break;case 39:this.arrowKeyHandler(n);break;case 37:this.arrowKeyHandler(n,!0);break;case 13:this.enterKeyHandler(n);break;case 8:this.showCheckBox&&this.currentDataSourceKey&&this.uncheckAllItems();this.back();break;case 32:this.spaceKeyHandler(n)}},o.prototype.addFocusId=function(n){this.focusId.indexOf(n)<0&&this.focusId.push(n)},o.prototype.removeFocusId=function(n){this.focusId.indexOf(n)>=0&&this.focusId.splice(this.focusId.indexOf(n),1)},o.prototype.updateFocusElement=function(t){var u=this.currentUlElement.querySelector("."+n),r,i;for(u&&(u.classList.remove(n),this.focusId.indexOf(u.getAttribute("data-uid"))>=0&&this.focusId.splice(this.focusId.indexOf(u.getAttribute("data-uid")),1)),r=this.currentUlElement.children,i=0;i<r.length;i++)this.focusId.indexOf(r[i].getAttribute("data-uid"))>=0&&(r[i].classList.add(n),this.addFocusId(r[i].getAttribute("data-uid")),this.addAriaAttribute(!0,r[i]),this.element.setAttribute("aria-activedescendant",r[i].id.toString()),this.enableSelectEvent&&this.getSelectEventData(r[i],t))},o.prototype.homeKeyHandler=function(t,i){var f,r,u;t.preventDefault();f=this.currentUlElement.querySelector("."+n);f&&(f.classList.remove(n),this.removeFocusId(f.getAttribute("data-uid")));r=i?this.currentUlElement.children.length-1:0;r=this.currentUlElement.children[r].classList.contains("e-list-group-item")&&this.currentUlElement.children.length>1?r+1:r;u=this.currentUlElement.children[r];this.addAriaAttribute(!0,u);u.classList.add(n);this.addFocusId(u.getAttribute("data-uid"));this.currentUlElement.children[r]?this.element.setAttribute("aria-activedescendant",this.currentUlElement.children[r].id.toString()):this.element.removeAttribute("aria-activedescendant");this.enableSelectEvent&&this.getSelectEventData(u,t)},o.prototype.onArrowKeyDown=function(r,u){var f,e;return!sf.base.isNullOrUndefined(this.currentUlElement.querySelector("."+t))||this.showCheckBox?((e=this.currentUlElement.querySelector("."+n)||this.currentUlElement.querySelector("."+n))&&this.removeFocusId(e.getAttribute("data-uid")),f=this.getSiblingLI(this.currentUlElement.querySelectorAll("."+i),e,u),sf.base.isNullOrUndefined(f)||(e&&(e.classList.remove(n),this.showCheckBox||e.classList.remove(n),this.removeFocusId(e.getAttribute("data-uid"))),f.classList.contains(t)||this.showCheckBox?f.classList.add(n):this.setSelectLI(f,r))):(e=this.currentUlElement.querySelector("."+n),f=this.getSiblingLI(this.currentUlElement.querySelectorAll("."+i),e,u),this.setSelectLI(f,r)),f?this.element.setAttribute("aria-activedescendant",f.id.toString()):this.element.removeAttribute("aria-activedescendant"),f},o.prototype.getSiblingLI=function(n,t,i){var r=Array.prototype.slice.call(n),u=r.indexOf(t);return i?r[u-1]:r[u+1]},o.prototype.arrowKeyHandler=function(n,t){var i,u,e,f;if(this.isRootFocus||n.preventDefault(),this.currentUlElement){i=this.onArrowKeyDown(n,t);i&&this.addFocusId(i.getAttribute("data-uid"));var o=this.element.getBoundingClientRect().top,s=this.element.getBoundingClientRect().height,r=void 0;i&&(u=i.getBoundingClientRect().top,e=i.getBoundingClientRect().height,t?(r=this.isWindow?u:u-o)<0&&(this.isWindow?window.scroll(0,pageYOffset+r):this.element.scrollTop=this.element.scrollTop+r):(f=this.isWindow?window.innerHeight:s,(r=this.isWindow?u+e:u-o+e)>f&&(this.isWindow?window.scroll(0,pageYOffset+(r-f)):this.element.scrollTop=this.element.scrollTop+(r-f))))}},o.prototype.enterKeyHandler=function(i){if(this.currentUlElement){var r=this.currentUlElement.querySelector("."+n);this.currentUlElement.querySelector("."+t)&&r?(r.classList.remove(n),this.showCheckBox&&(this.removeFocus(),this.removeHover()),this.setSelectLI(r,i)):sf.base.isNullOrUndefined(r)||this.spaceKeyHandler(i)}},o.prototype.checkAllItems=function(){this.isCheckAll=!0;this.updateCheckBoxState(!0);this.isCheckAll=!1},o.prototype.uncheckAllItems=function(){this.updateCheckBoxState(!1)},o.prototype.updateCheckBoxState=function(n){var i;if(this.showCheckBox)for(var r=this.currentUlElement.querySelectorAll("li"),u=this.enableVirtualization?this.currentUlElement.querySelector(".e-list-virtualcontainer").childElementCount:this.currentUlElement.childElementCount,t=0;t<u;t++)i=r[t].querySelector(".e-frame"),i&&(n&&!i.classList.contains("e-check")?this.checkItem(r[t]):!n&&i.classList.contains("e-check")&&this.uncheckItem(r[t]))},o.prototype.checkItem=function(n){this.toggleCheckBox(n,!0)},o.prototype.getCheckData=function(n,t,i){var e=n.id,r,u,f;if(i!==n.id||sf.base.isNullOrUndefined(n.id))for(i=i.toLowerCase(),r=0,u=Object.entries(n);r<u.length;r++){var o=u[r],s=""+o[0],h=""+o[1];(s=s.toLowerCase())===i&&(e=h)}f=this.currentUlElement.querySelector("[data-uid='"+e+"']");t?this.checkItem(f):this.uncheckItem(f);this.removeFocus()},o.prototype.spaceKeyHandler=function(t){if(t.preventDefault(),this.enable&&this.showCheckBox&&this.currentUlElement){var i=this.currentUlElement.querySelector("."+n);!sf.base.isNullOrUndefined(i)&&sf.base.isNullOrUndefined(i.querySelector(".e-check"))?this.setChecked(i,i.querySelector(".e-checkbox-wrapper")):this.uncheckItem(i);this.enableSelectEvent&&this.getSelectEventData(i,t)}},o.prototype.setChecked=function(t,i){this.removeFocus();t.classList.add(n);this.addAriaAttribute(!0,t);i&&(i.querySelector(".e-frame").classList.add("e-check"),i.setAttribute("aria-checked","true"));this.selectedItems[this.currentDataSourceKey]&&-1===this.selectedItems[this.currentDataSourceKey].indexOf(t.getAttribute("data-uid"))&&this.selectedItems[this.currentDataSourceKey].push(t.getAttribute("data-uid"))},o.prototype.toggleCheckBox=function(n,t){var r,i;this.showCheckBox&&(r=n,sf.base.isNullOrUndefined(r)||(i=r.querySelector(".e-frame"),this.addAriaAttribute(t,r),sf.base.isNullOrUndefined(i)||(t?i.classList.add("e-check"):i.classList.remove("e-check"),i.parentElement.setAttribute("aria-checked",t?"true":"false"))))},o.prototype.uncheckItem=function(n){n&&(this.selectedItems[this.currentDataSourceKey]&&-1!==this.selectedItems[this.currentDataSourceKey].indexOf(n.getAttribute("data-uid"))&&this.selectedItems[this.currentDataSourceKey].splice(this.selectedItems[this.currentDataSourceKey].indexOf(n.getAttribute("data-uid")),1),this.toggleCheckBox(n,!1))},o.prototype.addCheckClass=function(){this.currentUlElement||(this.currentUlElement=this.element.querySelector("ul"));for(var i=this.enableVirtualization?this.currentUlElement.querySelector(".e-list-virtualcontainer").children:this.currentUlElement.children,r=this.selectedItems[this.currentDataSourceKey],t=0;t<i.length;t++)this.showCheckBox?(this.focusedElementId&&(this.focusedElementId===i[t].getAttribute("data-uid")?i[t].classList.add(n):i[t].classList.remove(n)),r.length>0&&(-1!==r.indexOf(i[t].getAttribute("data-uid"))?this.toggleCheckBox(i[t],!0):this.toggleCheckBox(i[t],!1))):r[0]===i[t].getAttribute("data-uid")?i[t].classList.add(n):i[t].classList.remove(n);for(t=0;t<i.length;t++)this.showCheckBox?(this.focusedElementId&&(this.focusedElementId===i[t].getAttribute("data-uid")?i[t].classList.add(n):i[t].classList.remove(n)),r.length>0&&(-1!==r.indexOf(i[t].getAttribute("data-uid"))?this.toggleCheckBox(i[t],!0):this.toggleCheckBox(i[t],!1))):r&&r[0]===i[t].getAttribute("data-uid")?i[t].classList.add(n):i[t].classList.remove(n)},o.prototype.getSelectedItems=function(){var r=this.currentUlElement.querySelectorAll(".e-check"),n,t;for(this.selectedItems[this.currentDataSourceKey]=[],n=0;n<r.length;n++)t=sf.base.closest(r[n],"."+i),this.selectedItems[this.currentDataSourceKey]&&-1===this.selectedItems[this.currentDataSourceKey].indexOf(t.getAttribute("data-uid"))&&this.selectedItems[this.currentDataSourceKey].push(t.getAttribute("data-uid"));return{ElementId:this.selectedItems[this.currentDataSourceKey],Key:this.currentDataSourceKey}},o.prototype.getSelectEventData=function(n,i){if(n){var r=!!n.querySelector(".e-check"),u={ElementId:n.getAttribute("data-uid"),IsChecked:r,Key:n.classList.contains(t)&&!i.target.classList.contains("e-frame")?this.dataSourceLevel[this.dataSourceLevel.length-2]:this.currentDataSourceKey,IsInteracted:!(!i&&!this.isRootFocus),Level:this.dataSourceLevel.length>0?this.dataSourceLevel.length-1:this.dataSourceLevel.length};this.dotNetRef.invokeMethodAsync("TriggerClickEvent",u)}},o.prototype.switchView=function(n,t,i){var u=this;if(n&&t){var s=n.style.position,h="hidden"!==this.element.style.overflow?this.element.style.overflow:"",r=void 0,o=this.animation.duration;(n.style.position="absolute",n.classList.add("e-view"),this.animation.effect)?r=this.enableRtl?e[this.animation.effect]:f[this.animation.effect]:(r=f.SlideLeft,i=this.enableRtl,o=0);this.element.style.overflow="hidden";this.animationObject.animate(n,{name:i?r[0]:r[1],duration:o,timingFunction:this.animation.easing,end:function(){n.style.display="none";u.element.style.overflow=h;n.style.position=s;n.classList.remove("e-view")}});t.style.display="";this.animationObject.animate(t,{name:i?r[2]:r[3],duration:o,timingFunction:this.animation.easing,end:function(){u.dotNetRef.invokeMethodAsync("TriggerActionComplete",u.datasource)}});this.currentUlElement=t}},o.prototype.setAnimation=function(n){this.animation=n},o.prototype.setSelectedItems=function(n){var i=this.element.querySelector("."+u),t;sf.base.isNullOrUndefined(n)||(this.selectedItems={defaultData_Key:n});this.currentUlElement=n.length>0?this.element.querySelector('[data-uid="'+n+'"]').closest("ul"):this.element.querySelector("ul");t=this.element.querySelector('[data-uid="'+n+'"]').classList.contains("e-has-child");t?(this.dataSourceLevel=["defaultData_Key"],this.currentUlElement.style.removeProperty("display"),this.addCheckClass(),this.currentDataSourceKey="defaultData_Key"):this.selectedItems[this.currentDataSourceKey]=[this.currentDataSourceKey];this.showCheckBox&&this.removeFocus();this.headerElement&&t&&(this.headerTitleInfo=this.headerTitleInfo.splice(0,1),this.headerElement.innerText=this.headerTitleInfo[this.headerTitleInfo.length-1]);1===this.dataSourceLevel.length&&i&&t&&(i.children[0].style.display="none")},o.prototype.updateHeaderTitle=function(n){this.headerTitleInfo[0]=n;this.headerElement&&(this.headerElement.innerText=n)},o.prototype.destroy=function(){this.element.style.display="none";this.unWireEvents()},o}();return{initialize:function(n,t,i,r,u,f){this.isValid(n)&&(new o(n,t,i,r,f),n.blazor__instance.initialize(),n.blazor__instance.updateElementDifference(u))},renderChildList:function(n,t,i){this.isValid(n)&&n.blazor__instance.renderChildList(t,i)},addActiveClass:function(n){this.isValid(n)&&n.blazor__instance.addCheckClass()},showHideItem:function(n,t,i){this.isValid(n)&&n.blazor__instance.showHideItem(t,i)},enableState:function(n,t,i){this.isValid(n)&&n.blazor__instance.enableState(t,i)},back:function(n){this.isValid(n)&&n.blazor__instance.back()},checkAllItems:function(n){this.isValid(n)&&n.blazor__instance.checkAllItems()},uncheckAllItems:function(n){this.isValid(n)&&n.blazor__instance.uncheckAllItems()},getCheckData:function(n,t,i,r){if(this.isValid(n)&&null!=t)for(var u=0;u<t.length;u++)n.blazor__instance.getCheckData(t[u],i,r)},selectItem:function(n,t){if(n&&null!=t)for(var i=0;i<t.length;i++)n.blazor__instance.selectItem(t[i])},preventSelection:function(n,t){n.blazor__instance.preventSelection(t)},updateLiElementHeight:function(n){this.isValid(n)&&n.blazor__instance.updateLiElementHeight()},getCheckedItems:function(n){return this.isValid(n)?n.blazor__instance.getSelectedItems():{}},setAnimation:function(n,t){this.isValid(n)&&n.blazor__instance.setAnimation(t)},setCheckedItems:function(n,t){this.isValid(n)&&n.blazor__instance.setSelectedItems(t)},updateHeaderTitle:function(n,t){this.isValid(n)&&n.blazor__instance.updateHeaderTitle(t)},destroy:function(n){this.isValid(n)&&n.blazor__instance.destroy()},updateElementDifference:function(n,t){this.isValid(n)&&n.blazor__instance.updateElementDifference(t)},isValid:function(n){return!!n}}}()},"./modules/sf-numerictextbox.js":function(){window.sfBlazor=window.sfBlazor||{};window.sfBlazor.NumericTextBox=function(){"use strict";var n=new RegExp("^(-)?(\\d*)$"),t=function(){function t(n,t,i,r){this.wrapperElement=n;this.element=t;this.options=r;this.element.blazor__instance=this;this.dotNetRef=i}return t.prototype.initialize=function(){this.spinButtonEvents();sf.base.EventHandler.add(this.element,"focus",this.focusHandler,this);sf.base.EventHandler.add(this.element,"blur",this.focusOutHandler,this);sf.base.EventHandler.add(this.element,"keypress",this.keyPressHandler,this);sf.base.EventHandler.add(this.element,"keydown",this.keyDownHandler,this);sf.base.EventHandler.add(this.element,"paste",this.pasteHandler,this)},t.prototype.keyPressHandler=function(n){var i;if(!this.options.enabled||this.options.readonly||(i=n.keyCode,0===n.which||n.metaKey||n.ctrlKey||8===i||13===i))return!0;var u=String.fromCharCode(n.which),t=this.element.value,r=this.element;return t=t.substring(0,r.selectionStart)+u+t.substring(r.selectionEnd),!!this.numericRegex().test(t)||(n.preventDefault(),n.stopPropagation(),!1)},t.prototype.pasteHandler=function(n){if(this.options.enabled&&!this.options.readonly){var t=n.clipboardData.getData("text/plain");this.numericRegex().test(t)?this.dotNetRef.invokeMethodAsync("InvokePasteHandler",t):n.preventDefault()}},t.prototype.keyDownHandler=function(n){this.options.readonly||(38===n.keyCode?(n.preventDefault(),this.dotNetRef.invokeMethodAsync("ServerAction","increment",n)):40===n.keyCode&&(n.preventDefault(),this.dotNetRef.invokeMethodAsync("ServerAction","decrement",n)))},t.prototype.numericRegex=function(){var t=this.options.decimalSeparator,i="*";return"."===t&&(t="\\"+t),0===this.options.decimals&&this.options.validateDecimalOnType?n:(this.options.decimals&&this.options.validateDecimalOnType&&(i="{0,"+this.options.decimals+"}"),new RegExp("^(-)?(((\\d+("+t+"\\d"+i+")?)|("+t+"\\d"+i+")))?$"))},t.prototype.mouseWheel=function(n){var i,t;n.preventDefault();t=n;t.wheelDelta?i=t.wheelDelta/120:t.detail&&(i=-t.detail/3);i>0?this.dotNetRef.invokeMethodAsync("ServerAction","increment",n):i<0&&this.dotNetRef.invokeMethodAsync("ServerAction","decrement",n)},t.prototype.focusHandler=function(){this.isFocused=!0;this.options.enabled&&!this.options.readonly&&(sf.base.Browser.isDevice||sf.base.EventHandler.add(this.element,"mousewheel DOMMouseScroll",this.mouseWheel,this))},t.prototype.focusOutHandler=function(n){this.isFocused=!1;n.preventDefault();sf.base.Browser.isDevice||sf.base.EventHandler.remove(this.element,"mousewheel DOMMouseScroll",this.mouseWheel)},t.prototype.mouseDownOnSpinner=function(n){var i=this,t,r;this.options.enabled&&!this.options.readonly&&(this.isFocused&&(this.isPrevFocused=!0,n.preventDefault()),t=n.currentTarget,r=t.classList.contains("e-spin-up")?"increment":"decrement",sf.base.EventHandler.add(t,"mouseleave",this.mouseUpClick,this),this.timeOut=setInterval(function(){i.isCalled=!0;i.dotNetRef.invokeMethodAsync("ServerAction",r,n)},150),sf.base.EventHandler.add(document,"mouseup",this.mouseUpClick,this))},t.prototype.mouseUpOnSpinner=function(n){if(this.options.enabled&&!this.options.readonly){if(this.isPrevFocused&&(this.element.focus(),sf.base.Browser.isDevice||(this.isPrevFocused=!1)),sf.base.Browser.isDevice||n.preventDefault(),!this.getElementData(n))return;var t=n.currentTarget,i=t.classList.contains("e-spin-up")?"increment":"decrement";sf.base.EventHandler.remove(t,"mouseleave",this.mouseUpClick);this.isCalled||this.dotNetRef.invokeMethodAsync("ServerAction",i,n);this.isCalled=!1;sf.base.EventHandler.remove(document,"mouseup",this.mouseUpClick)}},t.prototype.touchMoveOnSpinner=function(n){this.options.enabled&&!this.options.readonly||document.elementFromPoint(n.clientX,n.clientY).classList.contains("e-input-group-icon")||clearInterval(this.timeOut)},t.prototype.getElementData=function(n){return!(n.which&&3===n.which||n.button&&2===n.button||!this.options.enabled||this.options.readonly)&&(clearInterval(this.timeOut),!0)},t.prototype.mouseUpClick=function(n){n.stopPropagation();clearInterval(this.timeOut);this.isCalled=!1;sf.base.EventHandler.remove(this.spinUp,"mouseleave",this.mouseUpClick);sf.base.EventHandler.remove(this.spinDown,"mouseleave",this.mouseUpClick)},t.prototype.selectRange=function(n){var i=this,t;sf.base.Browser.isDevice||"11.0"!==sf.base.Browser.info.version?(t=sf.base.Browser.isDevice&&sf.base.Browser.isIos?600:90,setTimeout(function(){i.element.setSelectionRange(0,n.length)},t)):this.element.setSelectionRange(0,n.length)},t.prototype.isDevice=function(){return sf.base.Browser.isDevice},t.prototype.spinButtonEvents=function(){this.spinDown=this.wrapperElement?this.wrapperElement.querySelector(".e-spin-down"):null;this.spinUp=this.wrapperElement?this.wrapperElement.querySelector(".e-spin-up"):null;this.spinDown&&this.spinUp&&(this.unBindSpinButton(),this.bindSpinButton())},t.prototype.bindSpinButton=function(){sf.base.EventHandler.add(this.spinUp,sf.base.Browser.touchStartEvent,this.mouseDownOnSpinner,this);sf.base.EventHandler.add(this.spinDown,sf.base.Browser.touchStartEvent,this.mouseDownOnSpinner,this);sf.base.EventHandler.add(this.spinUp,sf.base.Browser.touchEndEvent,this.mouseUpOnSpinner,this);sf.base.EventHandler.add(this.spinDown,sf.base.Browser.touchEndEvent,this.mouseUpOnSpinner,this);sf.base.EventHandler.add(this.spinUp,sf.base.Browser.touchMoveEvent,this.touchMoveOnSpinner,this);sf.base.EventHandler.add(this.spinDown,sf.base.Browser.touchMoveEvent,this.touchMoveOnSpinner,this)},t.prototype.unBindSpinButton=function(){sf.base.EventHandler.remove(this.spinUp,sf.base.Browser.touchStartEvent,this.mouseDownOnSpinner);sf.base.EventHandler.remove(this.spinDown,sf.base.Browser.touchStartEvent,this.mouseDownOnSpinner);sf.base.EventHandler.remove(this.spinUp,sf.base.Browser.touchEndEvent,this.mouseUpOnSpinner);sf.base.EventHandler.remove(this.spinDown,sf.base.Browser.touchEndEvent,this.mouseUpOnSpinner);sf.base.EventHandler.remove(this.spinUp,sf.base.Browser.touchMoveEvent,this.touchMoveOnSpinner);sf.base.EventHandler.remove(this.spinDown,sf.base.Browser.touchMoveEvent,this.touchMoveOnSpinner)},t.prototype.destroy=function(){sf.base.EventHandler.remove(this.element,"focus",this.focusHandler);sf.base.EventHandler.remove(this.element,"blur",this.focusOutHandler);sf.base.EventHandler.remove(this.element,"keypress",this.keyPressHandler);sf.base.EventHandler.remove(this.element,"keydown",this.keyDownHandler);sf.base.EventHandler.remove(this.element,"paste",this.pasteHandler)},t}();return{initialize:function(n,i,r,u){i&&new t(n,i,r,u);i&&i.blazor__instance&&i.blazor__instance.initialize()},selectRange:function(n,t){n&&n.blazor__instance&&n.blazor__instance.selectRange(t)},propertyChanges:function(n,t){n&&n.blazor__instance&&(n.blazor__instance.options=t)},focusIn:function(n){n&&n.focus()},focusOut:function(n){n&&n.blur()},spinButtonEvents:function(n){n&&n.blazor__instance&&n.blazor__instance.spinButtonEvents()},destroy:function(n){n&&n.blazor__instance&&n.blazor__instance.destroy()}}}()},"./modules/sf-spinner.js":function(){window.sfBlazor=window.sfBlazor||{};window.sfBlazor.Spinner=function(){"use strict";var n=function(){function n(n){this.element=n;this.element.blazor__instance=this}return n.prototype.initialize=function(n){return window.getComputedStyle(n,":after").getPropertyValue("content").replace(/['"]+/g,"")},n}();return{initialize:function(t){return sf.base.isNullOrUndefined(t)?null:(new n(t),sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.blazor__instance)?null:t.blazor__instance.initialize(t))}}}()},"./modules/sf-tab.js":function(){window.sfBlazor=window.sfBlazor||{};window.sfBlazor.Tab=function(){"use strict";var t="e-tab-header",i="e-tab-wrap",r="e-toolbar-items",n="e-toolbar-item",u=function(){function u(n,t,i){this.show={};this.hide={};this.draggableItems=[{}];this.resizeContext=this.refreshActElePosition.bind(this);this.keyConfigs={tab:"tab",home:"home",end:"end",enter:"enter",space:"space","delete":"delete",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow"};this.element=n;this.element.blazor__instance=this;this.dotNetRef=i;this.options=t}return u.prototype.render=function(){var t=sf.base.closest(this.element,".e-content"),n,i;this.prevIndex=0;this.isPopup=!1;this.initRender=!0;this.isSwipeed=!1;sf.base.isNullOrUndefined(t)||t.parentElement.classList.add("e-nested");n=sf.base.Browser.info.name;i="msie"===n?"e-ie":"edge"===n?"e-edge":"safari"===n?"e-safari":"";sf.base.setStyleAttribute(this.element,{width:sf.base.formatUnit(this.options.width),height:sf.base.formatUnit(this.options.height)});sf.base.attributes(this.element,{"aria-disabled":"false","aria-activedescendant":""});this.setCssClass(this.element,i,!0);this.updatePopAnimationConfig();this.tabId=this.element.id.length>0?"-"+this.element.id:sf.base.getRandomId();this.wireEvents();this.initRender=!1},u.prototype.serverItemsChanged=function(){if(this.enableAnimation=!1,this.setActive(this.options.selectedItem),"Dynamic"!==this.options.loadOn&&!sf.base.isNullOrUndefined(this.cntEle)){var t=[].slice.call(this.cntEle.children),n="e-content"+this.tabId+"_"+this.options.selectedItem;t.forEach(function(t){t.classList.contains("e-active")&&t.id!==n&&t.classList.remove("e-active");t.id===n&&t.classList.add("e-active")});this.prevIndex=this.options.selectedItem;this.triggerAnimation("e-item"+this.tabId+"_"+this.options.selectedItem,!1)}this.enableAnimation=!0},u.prototype.headerReady=function(){var i,u;(this.initRender=!0,this.hdrEle=this.getTabHeader(),this.setOrientation(this.options.headerPlacement,this.hdrEle),this.tbItems=sf.base.select("."+t+" ."+r,this.element),sf.base.isNullOrUndefined(this.tbItems)||sf.base.rippleEffect(this.tbItems,{selector:".e-tab-wrap"}),sf.base.selectAll("."+n,this.element).length>0)&&(this.bdrLine=sf.base.select(".e-indicator.e-ignore",this.element),i=sf.base.select("."+this.scrCntClass,this.tbItems),sf.base.isNullOrUndefined(i)?this.tbItems.insertBefore(this.bdrLine,this.tbItems.firstElementChild):i.insertBefore(this.bdrLine,i.firstElementChild),this.select(this.options.selectedItem));(this.cntEle=sf.base.select(".e-tab > .e-content",this.element),sf.base.isNullOrUndefined(this.cntEle)||(this.touchModule=new sf.base.Touch(this.cntEle,{swipe:this.swipeHandler.bind(this)}),"auto"===this.options.height||this.isVertical()||(this.cntEle.style.height="calc(100% - "+this.hdrEle.offsetHeight+"px)")),"Demand"===this.options.loadOn)&&(u=this.setActiveContent(),this.triggerAnimation(u,!1));this.initRender=!1},u.prototype.setActiveContent=function(){var n="e-item"+this.tabId+"_"+this.options.selectedItem,t=this.getTrgContent(this.cntEle,this.extIndex(n));return sf.base.isNullOrUndefined(t)||t.classList.add("e-active"),n},u.prototype.removeActiveClass=function(){var t=this.getTabHeader(),i;t&&(i=sf.base.selectAll("."+n+".e-active",t),sf.base.removeClass(i,"e-active"))},u.prototype.checkPopupOverflow=function(n){this.tbPop=sf.base.select(".e-toolbar-pop",this.element);var t=sf.base.select(".e-hor-nav",this.element),i=sf.base.select("."+r,this.element),u=i.lastChild;return(!this.isVertical()&&(this.options.enableRtl&&t.offsetLeft+t.offsetWidth>i.offsetLeft||!this.options.enableRtl&&t.offsetLeft<i.offsetWidth)||this.isVertical()&&t.offsetTop<u.offsetTop+u.offsetHeight)&&(n.classList.add("e-toolbar-popup"),this.tbPop.insertBefore(n,sf.base.selectAll(".e-toolbar-popup",this.tbPop)[0])),!0},u.prototype.popupHandler=function(t){var u=t.querySelector(".e-ripple-element"),f,e;return sf.base.isNullOrUndefined(u)||(u.outerHTML="",t.querySelector("."+i).classList.remove("e-ripple")),this.tbItem=sf.base.selectAll("."+r+" ."+n,this.hdrEle),f=this.tbItem[this.tbItem.length-1],0!==this.tbItem.length&&((t.classList.remove("e-toolbar-popup"),t.removeAttribute("style"),this.tbItems.appendChild(t),this.checkPopupOverflow(f))&&(e=this.tbItems.lastChild.previousElementSibling,this.checkPopupOverflow(e)),this.isPopup=!0),sf.base.selectAll("."+n,this.tbItems).length-1},u.prototype.previousContentAnimation=function(n,t){return this.isPopup||n<=t?"SlideLeftIn"===this.options.animation.previous.effect?{name:"SlideLeftOut",duration:this.options.animation.previous.duration,timingFunction:this.options.animation.previous.easing}:null:"SlideRightIn"===this.options.animation.next.effect?{name:"SlideRightOut",duration:this.options.animation.next.duration,timingFunction:this.options.animation.next.easing}:null},u.prototype.triggerPreviousAnimation=function(n,t){var i=this.previousContentAnimation(t,this.options.selectedItem);sf.base.isNullOrUndefined(i)?n.classList.remove("e-active"):(i.begin=function(){sf.base.setStyleAttribute(n,{position:"absolute"});sf.base.addClass([n],["e-progress","e-view"])},i.end=function(){n.style.display="none";sf.base.removeClass([n],["e-active","e-progress","e-view"]);sf.base.setStyleAttribute(n,{display:"",position:""});0===n.childNodes.length&&sf.base.detach(n)},new sf.base.Animation(i).animate(n))},u.prototype.triggerAnimation=function(n,t){var i,r,h=this,c=this.prevIndex,o,l,u,s,f,e;"Dynamic"!==this.options.loadOn?([].slice.call(this.element.querySelector(".e-content").children).forEach(function(n){n.id===h.prevActiveEle&&(i=n)}),o=this.tbItem[c],(r=this.getTrgContent(this.cntEle,this.extIndex(n)),sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(o))&&(l=this.extIndex(o.id),i=this.getTrgContent(this.cntEle,l))):r=this.cntEle.firstElementChild;(sf.base.isNullOrUndefined(r)||(this.prevActiveEle=r.id),this.initRender||!1===t||this.options.animation==={}||sf.base.isNullOrUndefined(this.options.animation))?i&&i!==r&&i.classList.remove("e-active"):(s=sf.base.select(".e-content",this.element),this.prevIndex>this.options.selectedItem&&!this.isPopup?(f=this.options.animation.previous.effect,u={name:"None"===f?"":"SlideLeftIn"!==f?f:"SlideLeftIn",duration:this.options.animation.previous.duration,timingFunction:this.options.animation.previous.easing}):(this.isPopup||this.prevIndex<this.options.selectedItem||this.prevIndex===this.options.selectedItem)&&(e=this.options.animation.next.effect,u={name:"None"===e?"":"SlideRightIn"!==e?e:"SlideRightIn",duration:this.options.animation.next.duration,timingFunction:this.options.animation.next.easing}),u.progress=function(){s.classList.add("e-progress");h.setActiveBorder()},u.end=function(){s.classList.remove("e-progress");r.classList.add("e-active")},this.initRender||sf.base.isNullOrUndefined(i)||this.triggerPreviousAnimation(i,c),this.isPopup=!1,""===u.name?r.classList.add("e-active"):new sf.base.Animation(u).animate(r))},u.prototype.keyPressed=function(i){var r=sf.base.closest(i,"."+t+" ."+n),u=this.getEleIndex(r);!sf.base.isNullOrUndefined(this.popEle)&&i.classList.contains("e-hor-nav")?this.popEle.classList.contains("e-popup-open")?this.popObj.hide(this.hide):this.popObj.show(this.show):i.classList.contains("e-scroll-nav")?i.click():sf.base.isNullOrUndefined(r)||!1!==r.classList.contains("e-active")||(this.select(u),sf.base.isNullOrUndefined(this.popEle)||this.popObj.hide(this.hide))},u.prototype.getTabHeader=function(){var i=[].slice.call(this.element.children).filter(function(n){return n.classList.contains(t)}),n;return i.length>0?i[0]:(n=[].slice.call(this.element.children).filter(function(n){return!n.classList.contains("blazor-template")})[0],n?[].slice.call(n.children).filter(function(n){return n.classList.contains(t)})[0]:void 0)},u.prototype.getEleIndex=function(t){return Array.prototype.indexOf.call(sf.base.selectAll("."+n,this.getTabHeader()),t)},u.prototype.extIndex=function(n){return n.replace("e-item"+this.tabId+"_","")},u.prototype.getTrgContent=function(n,t){return this.element.classList.contains("e-nested")?sf.base.select(".e-nested> .e-content > #e-content"+this.tabId+"_"+t,this.element):this.findEle(n.children,"e-content"+this.tabId+"_"+t)},u.prototype.findEle=function(n,t){for(var r,i=0;i<n.length;i++)if(n[i].id===t){r=n[i];break}return r},u.prototype.isVertical=function(){var n="Left"===this.options.headerPlacement||"Right"===this.options.headerPlacement;return this.scrCntClass=n?"e-vscroll-content":"e-hscroll-content",n},u.prototype.updatePopAnimationConfig=function(){this.show={name:this.isVertical()?"FadeIn":"SlideDown",duration:100};this.hide={name:this.isVertical()?"FadeOut":"SlideUp",duration:100}},u.prototype.focusItem=function(){var n=sf.base.select(" #e-item"+this.tabId+"_"+this.options.selectedItem,this.hdrEle);sf.base.isNullOrUndefined(n)||n.firstElementChild.focus()},u.prototype.serverChangeOrientation=function(n,t,i,r){if(this.setOrientation(n,this.hdrEle),sf.base.removeClass([this.element],["e-vertical-tab","e-vertical-left","e-vertical-right"]),r&&this.changeToolbarOrientation(t,i),this.isVertical()){var u="Left"===this.options.headerPlacement?"e-vertical-left":"e-vertical-right";this.element.classList.contains("e-nested")?sf.base.addClass([this.hdrEle],["e-vertical-tab",u]):sf.base.addClass([this.element],["e-vertical-tab",u])}this.setActiveBorder();this.focusItem()},u.prototype.changeToolbarOrientation=function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options.width=t?"auto":"100%",n.blazor__instance.options.height=t?"100%":"auto",n.blazor__instance.options.isVertical=t,n.blazor__instance.changeOrientation());this.updatePopAnimationConfig()},u.prototype.setOrientation=function(n,t){var i=Array.prototype.indexOf.call(this.element.children,t),r=Array.prototype.indexOf.call(this.element.children,this.element.querySelector(".e-content"));"Bottom"===n&&r>i?this.element.appendChild(t):(sf.base.removeClass([t],["e-horizontal-bottom"]),this.element.insertBefore(t,sf.base.select(".e-content",this.element)))},u.prototype.setCssClass=function(n,t,i){""!==t&&(i?sf.base.addClass([n],t.split(" ")):sf.base.removeClass([n],t.split(" ")))},u.prototype.setActiveBorder=function(){var f=this.getTabHeader(),t=sf.base.select("."+n+".e-active",f),o,i,u,e;null!==t&&(t.classList.contains("e-toolbar-popup")&&this.popupHandler(t),o=sf.base.closest(t,".e-tab"),this.element===o&&(this.tbItems=sf.base.select("."+r,f),i=sf.base.select(".e-indicator",f),u=sf.base.select("."+r+" ."+this.scrCntClass,f),this.isVertical()?(sf.base.setStyleAttribute(i,{left:"",right:""}),0!==(sf.base.isNullOrUndefined(u)?this.tbItems.offsetHeight:u.offsetHeight)?sf.base.setStyleAttribute(i,{top:t.offsetTop+"px",height:t.offsetHeight+"px"}):sf.base.setStyleAttribute(i,{top:0,height:0})):(sf.base.setStyleAttribute(i,{top:"",height:""}),e=sf.base.isNullOrUndefined(u)?this.tbItems.offsetWidth:u.offsetWidth,0!==e?sf.base.setStyleAttribute(i,{left:t.offsetLeft+"px",right:e-(t.offsetLeft+t.offsetWidth)+"px"}):sf.base.setStyleAttribute(i,{left:"auto",right:"auto"})),sf.base.isNullOrUndefined(this.bdrLine)||this.bdrLine.classList.remove("e-hidden")))},u.prototype.setActive=function(t){var i,u,r,e,f;this.tbItem=sf.base.selectAll("."+n,this.getTabHeader());sf.base.isNullOrUndefined(this.hdrEle)&&(this.hdrEle=this.getTabHeader());i=this.hdrEle.querySelector("."+n+'[data-index="'+t+'"]');!i||t<0||isNaN(t)||0===this.tbItem.length||((this.options.selectedItem=t,i.classList.contains("e-active"))?this.setActiveBorder():(u=this.tbItem[this.prevIndex],sf.base.isNullOrUndefined(u)||u.removeAttribute("aria-controls"),sf.base.attributes(i,{"aria-controls":"e-content"+this.tabId+"_"+t}),r=i.id,this.removeActiveClass(),i.classList.add("e-active"),i.setAttribute("aria-selected","true"),e=Number(this.extIndex(r)),(sf.base.isNullOrUndefined(this.prevActiveEle)&&(this.prevActiveEle="e-content"+this.tabId+"_"+e),sf.base.attributes(this.element,{"aria-activedescendant":r}),"Init"===this.options.loadOn)&&(this.cntEle=sf.base.select(".e-tab > .e-content",this.element),f=this.getTrgContent(this.cntEle,this.extIndex(r)),sf.base.isNullOrUndefined(f)||f.classList.add("e-active"),this.triggerAnimation(r,this.enableAnimation)),this.setActiveBorder(),this.refreshItemVisibility(i),this.initRender||i.firstElementChild.focus()))},u.prototype.contentReady=function(){var n=this.setActiveContent();this.triggerAnimation(n,this.enableAnimation)},u.prototype.setRTL=function(n){this.setCssClass(this.element,"e-rtl",n);this.refreshActiveBorder()},u.prototype.refreshActiveBorder=function(){sf.base.isNullOrUndefined(this.bdrLine)||this.bdrLine.classList.add("e-hidden");this.setActiveBorder()},u.prototype.setDragAndDrop=function(n){n?this.bindDraggable():this.draggableItems&&this.draggableItems.forEach(function(n){n&&0!==Object.keys(n).length&&n.destroy()})},u.prototype.showPopup=function(n){var t=sf.base.select(".e-popup.e-toolbar-pop",this.hdrEle),i;t&&t.classList.contains("e-popup-close")&&(i=t&&t.ej2_instances[0],i.position.X="Left"===this.options.headerPlacement?"left":"right",i.dataBind(),i.show(n))},u.prototype.initializeDrag=function(r){var u=this,f;this.options.dragArea=sf.base.isNullOrUndefined(this.options.dragArea)?"#"+this.element.id+" ."+t:this.options.dragArea;f=new sf.base.Draggable(r,{dragArea:this.options.dragArea,dragTarget:"."+n,clone:!0,helper:this.helper.bind(this),dragStart:this.itemDragStart.bind(this),drag:function(r){var e,o=u.getEleIndex(u.dragItem);if(sf.base.isNullOrUndefined(r.target.closest(".e-tab"))||r.target.closest(".e-tab").isEqualNode(u.element)||u.options.dragArea==="."+t){if(r.target.closest(u.options.dragArea)||"Popup"===u.options.overflowMode?(document.body.style.cursor="",u.dragItem.querySelector("."+i).style.visibility="hidden",u.cloneElement.classList.contains("e-hidden")&&sf.base.removeClass([u.cloneElement],"e-hidden")):(document.body.style.cursor="not-allowed",sf.base.addClass([u.cloneElement],"e-hidden"),u.dragItem.classList.contains("e-hidden")&&sf.base.removeClass([u.dragItem],"e-hidden"),u.dragItem.querySelector("."+i).style.visibility="visible"),"Scrollable"===u.options.overflowMode&&!sf.base.isNullOrUndefined(u.element.querySelector(".e-hscroll"))){var h=u.element.querySelector(".e-scroll-right-nav"),s=u.element.querySelector(".e-scroll-left-nav"),c=u.element.querySelector(".e-hscroll-bar");!sf.base.isNullOrUndefined(h)&&Math.abs(h.offsetWidth/2+h.offsetLeft)>u.cloneElement.offsetLeft+u.cloneElement.offsetWidth&&(c.scrollLeft-=10);!sf.base.isNullOrUndefined(s)&&Math.abs(s.offsetLeft+s.offsetWidth-u.cloneElement.offsetLeft)>s.offsetWidth/2&&(c.scrollLeft+=10)}u.cloneElement.style.pointerEvents="none";var a=u.cloneElement.getBoundingClientRect().left,v=u.cloneElement.getBoundingClientRect().top,y=document.elementFromPoint(a,v),f=sf.base.closest(y,"."+n),l=0;"Scrollable"!==u.options.overflowMode||sf.base.isNullOrUndefined(u.element.querySelector(".e-hscroll"))||(l=u.element.querySelector(".e-hscroll-content").offsetWidth);null!=f&&!f.isSameNode(u.dragItem)&&f.closest(".e-tab").isSameNode(u.dragItem.closest(".e-tab"))&&((e=u.getEleIndex(f))<o&&Math.abs(f.offsetLeft+f.offsetWidth-u.cloneElement.offsetLeft)>f.offsetWidth/2&&u.dragAction(f,o,e),e>o&&Math.abs(f.offsetWidth/2)+f.offsetLeft-l<u.cloneElement.offsetLeft+u.cloneElement.offsetWidth&&u.dragAction(f,o,e));u.droppedIndex=u.getEleIndex(u.dragItem)}},dragStop:this.itemDragStop.bind(this)});this.draggableItems.push(f)},u.prototype.helper=function(n){return n.element&&(this.cloneElement=n.element.cloneNode(!0),sf.base.addClass([this.cloneElement],["e-tab-clone-element","e-tab"]),sf.base.removeClass([this.cloneElement.querySelector("."+i)],"e-ripple"),sf.base.isNullOrUndefined(this.cloneElement.querySelector(".e-ripple-element"))||sf.base.remove(this.cloneElement.querySelector(".e-ripple-element")),document.body.appendChild(this.cloneElement)),this.cloneElement},u.prototype.itemDragStart=function(n){var t=this;this.dragItem=n.element;this.dragStartIndex=this.getEleIndex(this.dragItem);this.element.querySelector(".e-toolbar");this.dotNetRef.invokeMethodAsync("OnDragStart",this.dragStartIndex).then(function(r){r?sf.base.detach(t.cloneElement):(t.removeActiveClass(),sf.base.addClass([t.tbItems.querySelector(".e-indicator")],"e-hidden"),t.dragItem.querySelector("."+i).style.visibility="hidden",n.bindEvents(sf.base.getElement(n.dragElement)))})},u.prototype.dragAction=function(n,t,i){var r,u;("MultiRow"===this.options.overflowMode&&n.parentNode.insertBefore(this.dragItem,n.nextElementSibling),t>i)&&(this.dragItem.parentElement.isSameNode(n.parentElement)?this.dragItem.parentNode.insertBefore(this.dragItem,n):"Extended"===this.options.overflowMode?n.isSameNode(n.parentElement.lastChild)?(r=this.dragItem.parentNode,n.parentNode.insertBefore(this.dragItem,n),r.insertBefore(n.parentElement.lastChild,r.childNodes[0])):(this.dragItem.parentNode.insertBefore(n.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),n.parentNode.insertBefore(this.dragItem,n)):(u=n.parentElement.lastChild,n.isSameNode(u)?(r=this.dragItem.parentNode,n.parentNode.insertBefore(this.dragItem,n),r.insertBefore(u,r.childNodes[0])):(this.dragItem.parentNode.insertBefore(n.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),n.parentNode.insertBefore(this.dragItem,n))));t<i&&(this.dragItem.parentElement.isSameNode(n.parentElement)?this.dragItem.parentNode.insertBefore(n,this.dragItem):"Extended"===this.options.overflowMode?(this.dragItem.parentElement.appendChild(n.parentElement.firstElementChild),n.parentNode.insertBefore(this.dragItem,n.nextSibling)):(this.dragItem.parentNode.insertBefore(n.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),n.parentNode.insertBefore(this.dragItem,n)))},u.prototype.itemDragStop=function(n){var t,r,u;sf.base.detach(this.cloneElement);t=this.element.querySelector(".e-toolbar");this.dragItem.querySelector("."+i).style.visibility="visible";sf.base.addClass([t],"e-drag-action");document.body.style.cursor="";r=this.getXYValue(n.event,"X");u=this.getXYValue(n.event,"Y");this.dotNetRef.invokeMethodAsync("Dragged",this.droppedIndex,this.dragStartIndex,r,u)},u.prototype.getXYValue=function(n,t){var r,i=n.changedTouches;return r="X"===t?i?i[0].clientX:n.clientX:i?i[0].clientY:n.clientY,Math.ceil(r)},u.prototype.bindDraggable=function(){var i=this;this.options.allowDragAndDrop&&this.element.querySelectorAll("."+n).forEach(function(n){sf.base.isNullOrUndefined(i.options.dragArea)&&(i.options.dragArea="#"+i.element.id+" ."+t);n.classList.contains("e-draggable")||i.initializeDrag(n)})},u.prototype.wireEvents=function(){this.bindDraggable();window.addEventListener("resize",this.resizeContext);sf.base.EventHandler.add(this.element,"keydown",this.spaceKeyDown,this);sf.base.isNullOrUndefined(this.cntEle)||(this.touchModule=new sf.base.Touch(this.cntEle,{swipe:this.swipeHandler.bind(this)}));this.keyModule=new sf.base.KeyboardEvents(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:this.keyConfigs});this.tabKeyModule=new sf.base.KeyboardEvents(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:{openPopup:"shift+f10",tab:"tab",shiftTab:"shift+tab"},eventName:"keydown"})},u.prototype.unWireEvents=function(){this.keyModule.destroy();this.tabKeyModule.destroy();sf.base.isNullOrUndefined(this.cntEle)||this.touchModule.destroy();window.removeEventListener("resize",this.resizeContext);sf.base.EventHandler.remove(this.element,"keydown",this.spaceKeyDown);sf.base.removeClass([this.element],["e-rtl","e-focused"])},u.prototype.swipeHandler=function(t){var i,r;if(!(t.velocity<3&&sf.base.isNullOrUndefined(t.originalEvent.changedTouches))){if(t.originalEvent&&t.originalEvent.stopPropagation(),this.isSwipeed=!0,"Right"===t.swipeDirection&&0!==this.options.selectedItem){for(i=this.options.selectedItem-1;i>=0;i--)if(!this.tbItem[i].classList.contains("e-hidden")&&!this.tbItem[i].classList.contains("e-disable")){this.select(i);break}}else if("Left"===t.swipeDirection&&this.options.selectedItem!==sf.base.selectAll("."+n,this.element).length-1)for(r=this.options.selectedItem+1;r<this.tbItem.length;r++)if(!this.tbItem[r].classList.contains("e-hidden")&&!this.tbItem[r].classList.contains("e-disable")){this.select(r);break}this.isSwipeed=!1}},u.prototype.spaceKeyDown=function(n){if(32===n.keyCode&&32===n.which||35===n.keyCode&&35===n.which){var i=sf.base.closest(n.target,"."+t);sf.base.isNullOrUndefined(i)||n.preventDefault()}},u.prototype.keyHandler=function(t){var f;if(!this.element.classList.contains("e-disable")){this.element.classList.add("e-focused");var e,u,r=t.target,o=this.getTabHeader(),s=sf.base.select(".e-active",o);switch(this.popEle=sf.base.select(".e-toolbar-pop",o),sf.base.isNullOrUndefined(this.popEle)||(this.popObj=this.popEle.ej2_instances[0]),t.action){case"space":case"enter":if(r.parentElement.classList.contains("e-disable"))return;if("enter"===t.action&&r.classList.contains("e-hor-nav")){this.showPopup(this.show);break}this.keyPressed(r);break;case"tab":case"shiftTab":r.classList.contains(i)&&!1===sf.base.closest(r,"."+n).classList.contains("e-active")&&r.setAttribute("tabindex","-1");this.popObj&&sf.base.isVisible(this.popObj.element)&&this.popObj.hide(this.hide);s.children.item(0).setAttribute("tabindex","0");break;case"moveLeft":case"moveRight":e=sf.base.closest(document.activeElement,"."+n);sf.base.isNullOrUndefined(e)||this.refreshItemVisibility(e);break;case"openPopup":t.preventDefault();!sf.base.isNullOrUndefined(this.popEle)&&this.popEle.classList.contains("e-popup-close")&&this.popObj.show(this.show);break;case"delete":if(u=sf.base.closest(r,"."+n),!0===this.options.showCloseButton&&!sf.base.isNullOrUndefined(u)){if(-1===this.getEleIndex(u))return;f=u.nextSibling;!sf.base.isNullOrUndefined(f)&&f.classList.contains(n)&&f.firstElementChild.focus();this.dotNetRef.invokeMethodAsync("RemoveTab",parseInt(u.getAttribute("data-index"),10))}this.setActiveBorder()}}},u.prototype.refreshActElePosition=function(){var t=sf.base.select("."+n+".e-toolbar-popup.e-active",this.element);sf.base.isNullOrUndefined(t)||this.select(this.getEleIndex(t));this.refreshActiveBorder()},u.prototype.refreshItemVisibility=function(n){var s=sf.base.select("."+this.scrCntClass,this.tbItems),r;if(!this.isVertical()&&!sf.base.isNullOrUndefined(s)){var i=sf.base.select(".e-hscroll-bar",this.tbItems),t=i.scrollLeft,u=t+i.offsetWidth,f=n.offsetLeft,o=n.offsetWidth,e=n.offsetLeft+n.offsetWidth;t<f&&u<e?(r=u-f,i.scrollLeft=t+(o-r)):t>f&&u>e&&(r=e-t,i.scrollLeft=t-(o-r))}},u.prototype.enableTab=function(t,i){var r=sf.base.selectAll("."+n,this.element)[t];sf.base.isNullOrUndefined(r)||(!0===i?(r.classList.remove("e-disable","e-overlay"),r.firstElementChild.setAttribute("tabindex","-1")):(r.classList.add("e-disable","e-overlay"),r.firstElementChild.removeAttribute("tabindex"),r.classList.contains("e-active")&&this.select(t+1)),r.setAttribute("aria-disabled",!0===i?"false":"true"))},u.prototype.hideTab=function(t,i){var e,u,f,r;if(void 0===i&&(i=!0),u=sf.base.selectAll("."+n,this.element)[t],!sf.base.isNullOrUndefined(u)){if(this.bdrLine.classList.add("e-hidden"),i)if(u.classList.add("e-hidden"),0!==(e=sf.base.selectAll("."+n+":not(.e-hidden)",this.tbItems)).length&&u.classList.contains("e-active")){if(0!==t)for(f=t-1;f>=0;f--){if(!this.tbItem[f].classList.contains("e-hidden")){this.select(f);break}if(0===f)for(r=t+1;r<this.tbItem.length;r++)if(!this.tbItem[r].classList.contains("e-hidden")){this.select(r);break}}else for(r=t+1;r<this.tbItem.length;r++)if(!this.tbItem[r].classList.contains("e-hidden")){this.select(r);break}}else 0===e.length&&this.element.classList.add("e-hidden");else this.element.classList.remove("e-hidden"),e=sf.base.selectAll("."+n+":not(.e-hidden)",this.tbItems),u.classList.remove("e-hidden"),0===e.length&&this.select(t);this.setActiveBorder();u.setAttribute("aria-hidden",""+i)}},u.prototype.select=function(t){var u,e=this.getTabHeader(),i,f,o;this.tbItems=sf.base.select("."+r,e);this.tbItem=sf.base.selectAll("."+n,e);this.prevItem=this.tbItem[this.prevIndex];i=this.options.selectedItem;(sf.base.isNullOrUndefined(i)||i<0||this.tbItem.length<=i||isNaN(i))&&(this.options.selectedItem=0);f=this.tbItem[t];(sf.base.isNullOrUndefined(this.prevItem)||this.prevItem.classList.contains("e-disable")||this.prevItem.children.item(0).setAttribute("tabindex","-1"),this.initRender)?this.selectingContent(t):(f&&(u=parseInt(f.getAttribute("data-index"),10)),o={previousItem:null,previousIndex:this.prevIndex,selectedItem:null,selectedIndex:this.options.selectedItem,selectedContent:null,selectingItem:null,selectingIndex:u,selectingContent:null,isSwiped:this.isSwipeed,cancel:!1},this.dotNetRef.invokeMethodAsync("SelectingEvent",o,u))},u.prototype.setPersistence=function(n,t){this.options.enablePersistence&&window.localStorage.setItem(n,t)},u.prototype.selectingContent=function(t){if(this.tbItem=sf.base.selectAll("."+n,this.hdrEle),this.tbItem.length>t&&t>=0&&!isNaN(t)){this.prevIndex=this.options.selectedItem;var i=this.hdrEle.querySelector("."+n+'[data-index="'+t+'"]');i&&i.classList.contains("e-toolbar-popup")&&this.popupHandler(i);this.setActive(t)}else this.setActive(0)},u.prototype.disable=function(n){this.setCssClass(this.element,"e-disable",n);this.element.setAttribute("aria-disabled",""+n)},u.prototype.headerItemsUpdate=function(t){var i=this.getTabHeader();this.tbItems=sf.base.select("."+r,i);this.tbItem=sf.base.selectAll("."+n,i);this.prevItem=this.tbItem[this.prevIndex];sf.base.isNullOrUndefined(this.prevItem)||this.prevItem.classList.contains("e-disable")||this.prevItem.children.item(0).setAttribute("tabindex","-1");this.selectingContent(t)},u.prototype.destroy=function(){var n=this;this.unWireEvents();["aria-disabled","aria-activedescendant","tabindex"].forEach(function(t){n.element.removeAttribute(t)})},u.prototype.getContentElement=function(n){return sf.base.select(".e-content #e-content"+this.tabId+"_"+n,this.element)},u}();return{initialize:function(n,t,i,r,f){if(n){var e=new u(n,t,i);e.render();r&&(e.headerReady(),f||e.dotNetRef.invokeMethodAsync("CreatedEvent",null))}},headerReady:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.headerReady(),t||n.blazor__instance.dotNetRef.invokeMethodAsync("CreatedEvent",null))},contentReady:function(n,t,i){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.classList.remove("e-focused"),n.blazor__instance.isPopup=i,n.blazor__instance.headerItemsUpdate(t),n.blazor__instance.setPersistence("tab"+n.id,t.toString()),"Init"!==n.blazor__instance.options.loadOn&&n.blazor__instance.contentReady())},selectingContent:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.selectingContent(t),n.blazor__instance.setPersistence("tab"+n.id,t.toString()),"Init"!==n.blazor__instance.options.loadOn&&n.blazor__instance.contentReady())},serverItemsChanged:function(n,t,i,r){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options.selectedItem=t,n.blazor__instance.options.animation=i,sf.base.isNullOrUndefined(n.querySelector(".e-toolbar"))||(sf.base.removeClass([n.querySelector(".e-toolbar")],"e-drag-action"),sf.base.removeClass([n.querySelector(".e-indicator")],"e-hidden")),r?sf.base.addClass([n],"e-vertical-icon"):sf.base.removeClass([n],"e-vertical-icon"),n.blazor__instance.serverItemsChanged(),this.options.allowDragAndDrop&&n.blazor__instance.bindDraggable())},enableTab:function(n,t,i){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.enableTab(t,i)},hideTab:function(n,t,i){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.hideTab(t,i)},select:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.select(t)},disable:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.disable(t)},setCssClass:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(""!==n.blazor__instance.options.cssClass&&n.blazor__instance.setCssClass(n,n.blazor__instance.options.cssClass,!1),n.blazor__instance.setCssClass(n,t,!0),n.blazor__instance.options.cssClass=t)},showCloseButton:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options.showCloseButton=t,n.blazor__instance.refreshActElePosition())},headerPlacement:function(n,t,i,r,u,f,e){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options.headerPlacement=t,n.blazor__instance.options.selectedItem=i,sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.blazor__instance)||r.blazor__instance.setCssClass(u),n.blazor__instance.serverChangeOrientation(t,r,f,e))},enableRtl:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options.enableRtl=t,n.blazor__instance.setRTL(t))},overflowMode:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.refreshActElePosition()},allowDragAndDrop:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options.allowDragAndDrop=t,n.blazor__instance.setDragAndDrop(t))},refresh:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.refreshActiveBorder()},destroy:function(n,t,i){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.setPersistence(t,i),n.blazor__instance.destroy())},getTabItem:function(t,i){if(!sf.base.isNullOrUndefined(t)){var r=t.querySelector("."+n+'[data-index="'+i+'"]');if(r)return JSON.stringify(window.sfBlazor.getDomObject("tabitem",r))}return null},getTabContent:function(n,t){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){var i=n.blazor__instance.getContentElement(t);if(i)return JSON.stringify(window.sfBlazor.getDomObject("tabcontent",i))}return null}}}()},"./modules/sf-textbox.js":function(){window.sfBlazor=window.sfBlazor||{};window.sfBlazor.TextBox=function(){"use strict";var n=function(){function n(n,t,i){this.element=n;this.container=i;this.element.blazor_input_instance=this;this.dotNetRef=t;this.isDestroyed=!1}return n.prototype.initialize=function(){var n,t;if(sf.base.EventHandler.add(this.element,"blur",this.blurHandler,this),n=this.container?this.container.querySelectorAll(".e-input-group-icon"):null,n&&n.length>0)for(t=0;t<n.length;t++)sf.base.EventHandler.add(n[t],"mousedown",this.onMouseDownRipple,this),sf.base.EventHandler.add(n[t],"mouseup",this.onMouseUpRipple,this)},n.prototype.onMouseDownRipple=function(n){var t=n?n.currentTarget:null;!t||this.container.classList.contains("e-disabled")||this.container.querySelector("input").readOnly||t.classList.add("e-input-btn-ripple")},n.prototype.onMouseUpRipple=function(n){var t=n?n.currentTarget:null;t&&setTimeout(function(){t.classList.remove("e-input-btn-ripple")},500)},n.prototype.blurHandler=function(){this.isDestroyed?sf.base.EventHandler.remove(this.element,"blur",this.blurHandler):this.dotNetRef.invokeMethodAsync("BlurHandler").catch(function(){})},n.prototype.destroy=function(){sf.base.EventHandler.remove(this.element,"blur",this.blurHandler)},n}();return{initialize:function(t,i,r){t&&new n(t,i,r);t&&t.blazor_input_instance&&t.blazor_input_instance.initialize()},focusIn:function(n){n.focus()},focusOut:function(n){n.blur()},destroyInput:function(n){n&&n.blazor_input_instance&&(n.blazor_input_instance.isDestroyed=!0,n.blazor_input_instance.destroy())}}}()},"./modules/sf-toolbar.js":function(){window.sfBlazor=window.sfBlazor||{};window.sfBlazor.Toolbar=function(){"use strict";var n="e-toolbar-items",r="e-blazor-toolbar-items",t="e-toolbar-item",i="e-toolbar-popup",u=function(){function u(n,t,i){this.resizeContext=this.resize.bind(this);this.keyConfigs={moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow",popupOpen:"enter",popupClose:"escape",tab:"tab",home:"home",end:"end"};this.element=n;sf.base.isNullOrUndefined(n)||(this.element.blazor__instance=this);this.dotNetRef=i;this.options=t}return u.prototype.destroy=function(){this.unwireEvents();this.clearProperty();this.popObj=null;this.tbarAlign=null},u.prototype.wireEvents=function(){sf.base.EventHandler.add(this.element,"click",this.clickHandler,this);window.addEventListener("resize",this.resizeContext);this.options.allowKeyboard&&this.wireKeyboardEvent()},u.prototype.wireKeyboardEvent=function(){this.keyModule=new sf.base.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs});sf.base.EventHandler.add(this.element,"keydown",this.docKeyDown,this);this.element.setAttribute("tabIndex","0")},u.prototype.unwireKeyboardEvent=function(){this.keyModule&&(sf.base.EventHandler.remove(this.element,"keydown",this.docKeyDown),this.keyModule.destroy(),this.keyModule=null)},u.prototype.docKeyDown=function(n){if("INPUT"!==n.target.tagName){var t=!sf.base.isNullOrUndefined(this.popObj)&&sf.base.isVisible(this.popObj.element)&&"Extended"!==this.options.overflowMode;9===n.keyCode&&!0===n.target.classList.contains("e-hor-nav")&&t&&this.popObj.hide({name:"FadeOut",duration:100});(40===n.keyCode||38===n.keyCode||35===n.keyCode||36===n.keyCode)&&n.preventDefault()}},u.prototype.unwireEvents=function(){sf.base.EventHandler.remove(this.element,"click",this.clickHandler);this.destroyScroll();this.unwireKeyboardEvent();window.removeEventListener("resize",this.resizeContext);sf.base.EventHandler.remove(document,"scroll",this.docEvent);sf.base.EventHandler.remove(document,"click",this.docEvent)},u.prototype.clearProperty=function(){this.tbarEle=[];this.tbarAlgEle={lefts:[],centers:[],rights:[]}},u.prototype.docEvent=function(n){var t=sf.base.closest(n.target,".e-popup");this.popObj&&sf.base.isVisible(this.popObj.element)&&!t&&"Popup"===this.options.overflowMode&&this.popObj.hide({name:"FadeOut",duration:100})},u.prototype.destroyScroll=function(){this.scrollModule&&(this.tbarAlign&&sf.base.addClass([this.scrollModule.element],"e-tbar-pos"),this.scrollModule.destroy(),this.scrollModule=null)},u.prototype.destroyMode=function(){this.scrollModule&&(sf.base.removeClass([this.scrollModule.element],"e-rtl"),this.destroyScroll());sf.base.removeClass([this.element],"e-tbar-extended");sf.base.removeClass([this.element],"e-extended-toolbar");var n=this.element.querySelector(".e-toolbar-multirow");n&&sf.base.removeClass([n],"e-toolbar-multirow");this.popObj&&this.popupRefresh(this.popObj.element,!0)},u.prototype.elementFocus=function(n){var t=n.firstElementChild;t?(t.focus(),this.activeEleSwitch(n)):n.focus()},u.prototype.clstElement=function(n,i){return n&&this.popObj&&sf.base.isVisible(this.popObj.element)?this.popObj.element.querySelector("."+t):this.element===i||n?this.element.querySelector("."+t+":not(.e-overlay ):not(.e-separator ):not(.e-hidden )"):sf.base.closest(i,"."+t)},u.prototype.keyHandling=function(i,r,u,f,e){var h,s,c,o=this.popObj,l=this.element,p={name:"FadeOut",duration:100},a,v,w,y;switch(r.action){case"moveRight":if(this.options.isVertical)return;l===u?this.elementFocus(i):f||this.eleFocus(i,"next");break;case"moveLeft":if(this.options.isVertical)return;f||this.eleFocus(i,"previous");break;case"home":case"end":i&&(a=sf.base.closest(i,".e-popup"),a?sf.base.isVisible(this.popObj.element)&&(s=[].slice.call(a.children),h="home"===r.action?s[0]:s[s.length-1]):(s=this.element.querySelectorAll("."+n+" ."+t),h="home"===r.action?s[0]:s[s.length-1]),h&&this.elementFocus(h));break;case"moveUp":case"moveDown":if(c="moveUp"===r.action?"previous":"next",this.options.isVertical)"moveUp"===r.action?this.eleFocus(i,"previous"):this.eleFocus(i,"next");else if(o&&sf.base.closest(u,".e-popup")){if(v=o.element,w=v.firstElementChild,"previous"===c&&w===i||"next"===c&&v.lastElementChild===i)return;this.eleFocus(i,c)}else"moveDown"===r.action&&o&&sf.base.isVisible(o.element)&&this.elementFocus(i);break;case"tab":e||f||(y=i.firstElementChild,l===u&&(this.activeEle?this.activeEle.focus():(this.activeEleRemove(y),y.focus()),this.element.removeAttribute("tabindex")));break;case"popupClose":o&&"Extended"!==this.options.overflowMode&&o.hide(p);break;case"popupOpen":if(!f)return;o&&!sf.base.isVisible(o.element)?(o.element.style.top=l.offsetHeight+"px",o.show({name:"FadeIn",duration:100})):o.hide(p)}},u.prototype.keyActionHandler=function(n){var t=n.target;if("INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&!this.element.classList.contains("e-overlay")){n.preventDefault();var i=t.classList.contains("e-hor-nav"),r=t.classList.contains("e-scroll-nav"),u=this.clstElement(i,t);(u||r)&&this.keyHandling(u,n,t,i,r)}},u.prototype.eleContains=function(n){return n.classList.contains("e-separator")||n.classList.contains("e-overlay")||n.getAttribute("disabled")||n.classList.contains("e-hidden")||!sf.base.isVisible(n)},u.prototype.eleFocus=function(n,i){var f=Object(n)[i+"ElementSibling"],r,u;if(f){if(this.eleContains(f))return void this.eleFocus(f,i);this.elementFocus(f)}else this.tbarAlign&&(r=Object(n.parentElement)[i+"ElementSibling"],(sf.base.isNullOrUndefined(r)||0!==r.children.length||(r=Object(r)[i+"ElementSibling"]),!sf.base.isNullOrUndefined(r)&&r.children.length>0)&&("next"===i?(u=r.querySelector("."+t),this.eleContains(u)?this.eleFocus(u,i):(u.firstElementChild.focus(),this.activeEleSwitch(u))):(u=r.lastElementChild,this.eleContains(u)?this.eleFocus(u,i):this.elementFocus(u))))},u.prototype.clickHandler=function(i){var r,c;if(!this.element.classList.contains("e-drag-action")){var s,h,u=i.target,f=u.classList,o=this.element,l=!sf.base.isNullOrUndefined(sf.base.closest(u,".e-toolbar-pop")),a=f.contains("e-close-icon"),e=sf.base.closest(u,".e-hor-nav");e||(e=u);o.children[0].classList.contains("e-hscroll")||o.children[0].classList.contains("e-vscroll")||!f.contains("e-hor-nav")||(f=u.querySelector(".e-icons").classList);(f.contains("e-popup-up-icon")||f.contains("e-popup-down-icon"))&&this.popupClickHandler(o,e,"e-rtl");r=sf.base.closest(i.target,"."+t);(sf.base.isNullOrUndefined(r)||r.classList.contains("e-overlay"))&&!e.classList.contains("e-hor-nav")||(sf.base.isNullOrUndefined(r)||(s=parseInt(r.getAttribute("data-index"),10),h=r.id),c=sf.base.selectAll("."+n+" ."+t,this.element),this.dotNetRef.invokeMethodAsync("TriggerClickEvent",i,l,a,s,h,c.length-1))}},u.prototype.popupClickHandler=function(n,t,i){var r=this.popObj;sf.base.isVisible(r.element)?(t.classList.remove("e-nav-active"),r.hide({name:"FadeOut",duration:100})):((n.classList.contains(i)||this.options.isVerticalLeft)&&(n.classList.contains(i)&&(r.enableRtl=!0),r.position={X:"left",Y:"top"}),0!==r.offsetX||n.classList.contains(i)||this.options.isVerticalLeft||(r.enableRtl=!1,r.position={X:"right",Y:"top"}),r.dataBind(),r.refreshPosition(),r.element.style.top=this.getElementOffsetY()+"px","Extended"===this.options.overflowMode&&(r.element.style.minHeight="0px"),t.classList.add("e-nav-active"),r.show({name:"FadeIn",duration:100}))},u.prototype.render=function(){this.scrollModule=null;this.popObj=null;this.isExtendedOpen=!1;this.popupPriCount=0;var n=sf.base.formatUnit(this.options.width),t=sf.base.formatUnit(this.options.height);this.element&&("msie"===sf.base.Browser.info.name&&"auto"===this.options.height||sf.base.setStyleAttribute(this.element,{height:t}),sf.base.setStyleAttribute(this.element,{width:n}),this.element.setAttribute("aria-haspopup","false"),this.renderControl(),this.wireEvents())},u.prototype.renderControl=function(){this.tbarAlgEle={lefts:[],centers:[],rights:[]};this.renderItems();this.renderLayout()},u.prototype.renderLayout=function(){this.renderOverflowMode();this.tbarAlign&&this.itemPositioning();this.popObj&&this.popObj.element.childElementCount>1&&this.checkPopupRefresh(this.element,this.popObj.element)&&this.popupRefresh(this.popObj.element,!1);this.separator()},u.prototype.itemsAlign=function(n,i){var f,e,u,o;for(this.tbarEle||(this.tbarEle=[]),u=0;u<n.length;u++)o=this.element.querySelector("."+r),(f="MultiRow"===this.options.overflowMode?i.querySelector("."+t+'[id="'+n[u].id+'"]'):o.querySelector("."+t+'[id="'+n[u].id+'"]'))&&("Show"!==n[u].overflow&&n[u].showAlwaysInPopup&&!f.classList.contains("e-separator")&&this.popupPriCount++,n[u].htmlAttributes&&this.setAttr(n[u].htmlAttributes,f),"Button"===n[u].type&&(sf.base.EventHandler.remove(f,"click",this.itemClick),sf.base.EventHandler.add(f,"click",this.itemClick,this)),-1===this.tbarEle.indexOf(f)&&this.tbarEle.push(f),"MultiRow"!==this.options.overflowMode&&(this.tbarAlign||this.tbarItemAlign(n[u],i,u),(e=i.querySelector(".e-toolbar-"+n[u].align.toLowerCase()))?(n[u].showAlwaysInPopup&&"Show"!==n[u].overflow||this.tbarAlgEle[(n[u].align+"s").toLowerCase()].push(f),e.appendChild(f)):i.appendChild(f)))},u.prototype.serverItemsRefresh=function(){var t=this.element,u=t.querySelector("."+r),i=t.querySelector("."+n);(i&&i.children.length>0||u.children.length>0)&&(!i&&t&&t.classList.contains("e-toolbar")&&t.firstElementChild&&(i=sf.base.createElement("div",{className:n}),t.insertBefore(i,t.firstElementChild)),this.itemsAlign(this.options.items,i),this.renderLayout(),this.refreshOverflow())},u.prototype.resetServerItems=function(){if("MultiRow"!==this.options.overflowMode){var i=this.element.querySelector("."+r),u=[].slice.call(sf.base.selectAll("."+n+" ."+t,this.element));sf.base.append(u,i);this.clearProperty()}},u.prototype.changeOrientation=function(){this.options.isVertical?(this.element.classList.add("e-vertical"),this.element.setAttribute("aria-orientation","vertical"),sf.base.setStyleAttribute(this.element,{height:sf.base.formatUnit(this.options.height),width:sf.base.formatUnit(this.options.width)})):(this.element.classList.remove("e-vertical"),this.element.setAttribute("aria-orientation","horizontal"),"auto"!==this.options.height&&"100%"!==this.options.height||(this.element.style.height=this.options.height));this.destroyMode();this.refreshOverflow()},u.prototype.initScroll=function(t,i){!this.scrollModule&&this.checkOverflow(t,i[0])&&(this.tbarAlign&&this.element.querySelector("."+n+" .e-toolbar-center").removeAttribute("style"),this.scrollModule=this.options.isVertical?new sf.navigations.VScroll({scrollStep:this.options.scrollStep,enableRtl:this.options.enableRtl},i[0]):new sf.navigations.HScroll({scrollStep:this.options.scrollStep,enableRtl:this.options.enableRtl},i[0]),sf.base.removeClass([this.scrollModule.element],"e-tbar-pos"),sf.base.setStyleAttribute(this.element,{overflow:"hidden"}))},u.prototype.itemWidthCal=function(n){var i,u=this,r=0;return[].slice.call(sf.base.selectAll("."+t,n)).forEach(function(n){sf.base.isVisible(n)&&(i=window.getComputedStyle(n),r+=u.options.isVertical?n.offsetHeight:n.offsetWidth,r+=parseFloat(u.options.isVertical?i.marginTop:i.marginRight),r+=parseFloat(u.options.isVertical?i.marginBottom:i.marginLeft))}),r},u.prototype.getScrollCntEle=function(n){var t=this.options.isVertical?".e-vscroll-content":".e-hscroll-content";return n.querySelector(t)},u.prototype.checkOverflow=function(n,t){var r,i;if(sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(t)||!sf.base.isVisible(n))return!1;r=this.options.isVertical?n.offsetHeight:n.offsetWidth;i=this.options.isVertical?t.offsetHeight:t.offsetWidth;(this.tbarAlign||this.scrollModule||r===i)&&(i=this.itemWidthCal(this.scrollModule?this.getScrollCntEle(t):t));var u=n.querySelector(".e-hor-nav"),f=n.querySelector(".e-scroll-nav"),e=0;return u?e=this.options.isVertical?u.offsetHeight:u.offsetWidth:f&&(e=this.options.isVertical?2*f.offsetHeight:2*f.offsetWidth),i>r-e},u.prototype.refreshOverflow=function(){this.resize()},u.prototype.toolbarAlign=function(n){this.tbarAlign&&(sf.base.addClass([n],"e-tbar-pos"),this.itemPositioning())},u.prototype.renderOverflowMode=function(){var t=this.element,i=t.querySelector("."+n),r=this.popupPriCount>0;if(t&&t.children.length>0)switch(this.offsetWid=t.offsetWidth,sf.base.removeClass([this.element],"e-toolpop"),"msie"===sf.base.Browser.info.name&&"auto"===this.options.height&&(t.style.height=""),this.options.overflowMode){case"Scrollable":sf.base.isNullOrUndefined(this.scrollModule)&&this.initScroll(t,[].slice.call(t.getElementsByClassName(n)));break;case"Popup":sf.base.addClass([this.element],"e-toolpop");this.tbarAlign&&this.removePositioning();(this.checkOverflow(t,i)||r)&&this.setOverflowAttributes(t);this.toolbarAlign(i);break;case"MultiRow":sf.base.addClass([i],"e-toolbar-multirow");this.checkOverflow(t,i)&&this.tbarAlign&&(this.removePositioning(),sf.base.addClass([i],"e-multirow-pos"));"hidden"===t.style.overflow&&(t.style.overflow="");"msie"!==sf.base.Browser.info.name&&"auto"===t.style.height||(t.style.height="auto");break;case"Extended":sf.base.addClass([this.element],"e-extended-toolbar");(this.checkOverflow(t,i)||r)&&(this.tbarAlign&&this.removePositioning(),this.setOverflowAttributes(t));this.toolbarAlign(i)}},u.prototype.setOverflowAttributes=function(i){this.createPopupEle(i,[].slice.call(sf.base.selectAll("."+n+" ."+t,i)));this.element.querySelector(".e-hor-nav").setAttribute("tabIndex","0");this.element.querySelector(".e-hor-nav").setAttribute("role","list")},u.prototype.separator=function(){var i=this.element,t=[].slice.call(i.querySelectorAll(".e-separator")),u=i.querySelector(".e-multirow-separator"),f=i.querySelector(".e-extended-separator"),r="MultiRow"===this.options.overflowMode?u:f,n;for(null!==r&&("MultiRow"===this.options.overflowMode?r.classList.remove("e-multirow-separator"):"Extended"===this.options.overflowMode&&r.classList.remove("e-extended-separator")),n=0;n<=t.length-1;n++)t[n].offsetLeft<30&&0!==t[n].offsetLeft&&("MultiRow"===this.options.overflowMode?t[n].classList.add("e-multirow-separator"):"Extended"===this.options.overflowMode&&t[n].classList.add("e-extended-separator"))},u.prototype.createPopupEle=function(n,t){var i=n.querySelector(".e-hor-nav"),r=this.options.isVertical,u,f;i||this.createPopupIcon(n);i=n.querySelector(".e-hor-nav");u=r?i.offsetHeight:i.offsetWidth;f=(r?n.offsetHeight:n.offsetWidth)-u;this.element.classList.remove("e-rtl");sf.base.setStyleAttribute(this.element,{direction:"initial"});this.checkPriority(n,t,f,!0);this.options.enableRtl&&this.element.classList.add("e-rtl");this.element.style.removeProperty("direction");this.createPopup()},u.prototype.pushingPoppedEle=function(r,u,f,e,o){var v=this.element,s=sf.base.selectAll(".e-overflow-show",f),y=0,p=[].slice.call(sf.base.selectAll("."+i,v.querySelector("."+n))),h=0,l,c,a;for(p.forEach(function(n,t){s=sf.base.selectAll(".e-overflow-show",f);n.classList.contains("e-overflow-show")&&s.length>0?r.tbResize&&s.length>t?(f.insertBefore(n,s[t]),++h):(f.insertBefore(n,f.children[s.length]),++h):n.classList.contains("e-overflow-show")||r.tbResize&&n.classList.contains("e-overflow-hide")&&f.children.length>0&&0===s.length?(f.insertBefore(n,f.firstChild),++h):n.classList.contains("e-overflow-hide")?u.push(n):r.tbResize?(f.insertBefore(n,f.childNodes[y+h]),++y):f.appendChild(n);n.classList.contains("e-separator")?sf.base.setStyleAttribute(n,{display:"",height:o+"px"}):sf.base.setStyleAttribute(n,{display:"",height:e+"px"})}),u.forEach(function(n){f.appendChild(n)}),l=sf.base.selectAll("."+t,v.querySelector("."+n)),c=l.length-1;c>=0;c--){if(a=l[c],!a.classList.contains("e-separator")||"Extended"===this.options.overflowMode)break;sf.base.setStyleAttribute(a,{display:"none"})}},u.prototype.createPopup=function(){var e,u,n=this.element,r,f,o,s,h;"Extended"===this.options.overflowMode&&(u=n.querySelector(".e-separator:not(."+i+")"),e="auto"===n.style.height||""===n.style.height?null:u&&u.offsetHeight);f=n.querySelector("."+t+":not(.e-separator):not(."+i+"):not(.e-hidden)");o="auto"===n.style.height||""===n.style.height?null:f&&f.offsetHeight;n.querySelector("#"+n.id+"_popup.e-toolbar-pop")?r=n.querySelector("#"+n.id+"_popup.e-toolbar-pop"):(s=sf.base.createElement("div",{id:n.id+"_popup",className:"e-toolbar-pop e-toolbar-extended"}),h=sf.base.createElement("div",{id:n.id+"_popup",className:"e-toolbar-pop"}),r="Extended"===this.options.overflowMode?s:h);this.pushingPoppedEle(this,[],r,o,e);this.popupInit(n,r)},u.prototype.getElementOffsetY=function(){return"Extended"===this.options.overflowMode&&"border-box"===window.getComputedStyle(this.element).getPropertyValue("box-sizing")?this.element.clientHeight:this.element.offsetHeight},u.prototype.popupInit=function(n,t){var r,u,f,i,e;this.popObj?(r=this.popObj.element,"Extended"===this.options.overflowMode&&(u=window.getComputedStyle(this.element),this.popObj.width=parseFloat(u.width)+2*parseFloat(u.borderRightWidth),this.popObj.offsetX=0,this.popObj.dataBind()),sf.base.setStyleAttribute(r,{maxHeight:"",display:"block"}),sf.base.setStyleAttribute(r,{maxHeight:r.offsetHeight+"px",display:""})):(n.appendChild(t),sf.base.setStyleAttribute(this.element,{overflow:""}),f=window.getComputedStyle(this.element),i=new sf.popups.Popup(null,{relateTo:this.element,offsetY:this.options.isVertical?0:this.getElementOffsetY(),enableRtl:this.options.enableRtl,open:this.popupOpen.bind(this),close:this.popupClose.bind(this),collision:{Y:this.options.enableCollision?"flip":"none"},position:this.options.enableRtl?{X:"left",Y:"top"}:{X:"right",Y:"top"}}),(i.appendTo(t),"Extended"===this.options.overflowMode&&(i.width=parseFloat(f.width)+2*parseFloat(f.borderRightWidth),i.offsetX=0),sf.base.EventHandler.add(document,"scroll",this.docEvent.bind(this)),sf.base.EventHandler.add(document,"click ",this.docEvent.bind(this)),i.element.style.maxHeight=i.element.offsetHeight+"px",this.options.isVertical&&(i.element.style.visibility="hidden"),this.isExtendedOpen)?(e=this.element.querySelector(".e-hor-nav"),e.classList.add("e-nav-active"),sf.base.classList(e.firstElementChild,["e-popup-up-icon"],["e-popup-down-icon"]),this.element.querySelector(".e-toolbar-extended").classList.add("e-popup-open")):i.hide(),this.popObj=i,this.element.setAttribute("aria-haspopup","true"))},u.prototype.tbarPopupHandler=function(n){"Extended"===this.options.overflowMode&&(n?sf.base.addClass([this.element],"e-tbar-extended"):sf.base.removeClass([this.element],"e-tbar-extended"))},u.prototype.popupOpen=function(){var n=this.popObj,e,c,o,i,r,u,l,s;this.options.isVertical||(n.offsetY=this.getElementOffsetY(),n.dataBind());var t=this.popObj.element,f=this.popObj.element.parentElement,h=f.querySelector(".e-hor-nav");if(sf.base.setStyleAttribute(n.element,{height:"auto",maxHeight:""}),n.element.style.maxHeight=n.element.offsetHeight+"px","Extended"===this.options.overflowMode&&(n.element.style.minHeight=""),e=t.offsetTop+t.offsetHeight+sf.popups.calculatePosition(f).top,c=h.firstElementChild,h.classList.add("e-nav-active"),sf.base.classList(c,["e-popup-up-icon"],["e-popup-down-icon"]),this.tbarPopupHandler(!0),o=sf.base.isNullOrUndefined(window.scrollY)?0:window.scrollY,!this.options.isVertical&&window.innerHeight+o<e&&this.element.offsetTop<t.offsetHeight){for(i=t.offsetHeight-(e-window.innerHeight-o+5),n.height=i+"px",r=0;r<=t.childElementCount;r++)if(u=t.children[r],u.offsetTop+u.offsetHeight>i){i=u.offsetTop;break}sf.base.setStyleAttribute(n.element,{maxHeight:i+"px"})}else this.options.isVertical&&(l=this.element.getBoundingClientRect(),sf.base.setStyleAttribute(n.element,{maxHeight:l.top+this.element.offsetHeight+"px",bottom:0,visibility:""}));n&&(s=t.getBoundingClientRect(),s.right>document.documentElement.clientWidth&&s.width>f.getBoundingClientRect().width&&(n.collision={Y:"none"},n.dataBind()),n.refreshPosition())},u.prototype.popupClose=function(){var n=this.element.querySelector(".e-hor-nav"),t=n.firstElementChild;n.classList.remove("e-nav-active");sf.base.classList(t,["e-popup-down-icon"],["e-popup-up-icon"]);this.tbarPopupHandler(!1)},u.prototype.checkPriority=function(n,r,u,f){for(var o,c,p,l,w,b,v,k=this.popupPriCount>0,d=u,y=0,s=0,h=0,a=function(n,t){var i=!1;return t.forEach(function(t){n.classList.contains(t)&&(i=!0)}),i},e=r.length-1;e>=0;e--)o=void 0,c=window.getComputedStyle(r[e]),this.options.isVertical?(o=parseFloat(c.marginTop),o+=parseFloat(c.marginBottom)):(o=parseFloat(c.marginRight),o+=parseFloat(c.marginLeft)),p=r[e]===this.tbarEle[0],p&&(this.tbarEleMrgn=o),v=this.options.isVertical?r[e].offsetHeight:r[e].offsetWidth,l=p?v+o:v,(a(r[e],["e-popup-alone"])&&k&&(r[e].classList.add(i),this.options.isVertical?sf.base.setStyleAttribute(r[e],{display:"none",minHeight:l+"px"}):sf.base.setStyleAttribute(r[e],{display:"none",minWidth:l+"px"}),h++),this.options.isVertical?r[e].offsetTop+r[e].offsetHeight+o>u:r[e].offsetLeft+r[e].offsetWidth+o>u)&&(r[e].classList.contains("e-separator")?"Extended"===this.options.overflowMode?(s===h&&a(w=r[e],["e-separator","e-ignore"])&&(r[e].classList.add(i),h++),s++):"Popup"===this.options.overflowMode&&(y>0&&s===h&&a(w=r[e+s+(y-1)],["e-separator","e-ignore"])&&sf.base.setStyleAttribute(w,{display:"none"}),y++,s=0,h=0):s++,r[e].classList.contains("e-overflow-show")&&f||a(r[e],["e-separator","e-ignore"])?u-=(this.options.isVertical?r[e].offsetHeight:r[e].offsetWidth)+o:(r[e].classList.add(i),this.options.isVertical?sf.base.setStyleAttribute(r[e],{display:"none",minHeight:l+"px"}):sf.base.setStyleAttribute(r[e],{display:"none",minWidth:l+"px"}),h++));f&&(b=sf.base.selectAll("."+t+":not(."+i+")",this.element),this.checkPriority(n,b,d,!1))},u.prototype.createPopupIcon=function(n){var u=n.id.concat("_nav"),i="e-"+n.id.concat("_nav e-hor-nav"),t,r;i="Extended"===this.options.overflowMode?i+" e-expended-nav":i;t=sf.base.createElement("div",{id:u,className:i});"msie"!==sf.base.Browser.info.name&&"edge"!==sf.base.Browser.info.name||t.classList.add("e-ie-align");r=sf.base.createElement("div",{className:"e-popup-down-icon e-icons"});t.appendChild(r);t.setAttribute("tabindex","0");t.setAttribute("role","list");n.appendChild(t)},u.prototype.tbarPriRef=function(n,t,r,u,f,e,o,s){var l=s,p=this.popObj.element,w=sf.base.selectAll("."+i+":not(.e-overflow-show)",p).length,a=function(n,t){return n.classList.contains(t)},h,v,y,c;0===sf.base.selectAll(".e-toolbar-item:not(.e-separator):not(.e-overflow-show)",n).length?(h=n.children[t-(t-r)-1],v=!sf.base.isNullOrUndefined(h)&&a(h,"e-ignore"),!sf.base.isNullOrUndefined(h)&&a(h,"e-separator")&&!sf.base.isVisible(h)||v?(h.style.display="inherit",y=h.offsetWidth+2*parseFloat(window.getComputedStyle(h).marginRight),c=h.previousElementSibling,e+y<o||f?(n.insertBefore(u,n.children[t+l-(t-r)]),sf.base.isNullOrUndefined(c)||(c.style.display="")):c.classList.contains("e-separator")&&(c.style.display="none"),h.style.display=""):n.insertBefore(u,n.children[t+l-(t-r)])):n.insertBefore(u,n.children[t+l-w])},u.prototype.popupRefresh=function(t,i){var h=this,u=this.element,s=this.options.isVertical,r=u.querySelector(".e-hor-nav"),f=u.querySelector("."+n),e,o;sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(f)||(f.removeAttribute("style"),t.style.display="block",e=s?u.offsetHeight-(r.offsetHeight+f.offsetHeight):u.offsetWidth-(r.offsetWidth+f.offsetWidth),o=0,[].slice.call(t.children).forEach(function(n){o+=h.popupEleWidth(n);sf.base.setStyleAttribute(n,{position:""})}),e+(s?r.offsetHeight:r.offsetWidth)>o&&0===this.popupPriCount&&(i=!0),this.popupEleRefresh(e,t,i),t.style.display="",0===t.children.length&&r&&this.popObj&&(sf.base.detach(r),r=null,this.popObj.destroy(),sf.base.detach(this.popObj.element),this.popObj=null,u.setAttribute("aria-haspopup","false")))},u.prototype.ignoreEleFetch=function(n,t){var i=[].slice.call(t.querySelectorAll(".e-ignore")),r=[],u=0;return i.length>0?(i.forEach(function(n){r.push([].slice.call(t.children).indexOf(n))}),r.forEach(function(t){t<=n&&u++}),u):0},u.prototype.checkPopupRefresh=function(t,i){var r,u,f;return i.style.display="block",r=this.popupEleWidth(i.firstElementChild),i.firstElementChild.style.removeProperty("Position"),u=t.offsetWidth-t.querySelector(".e-hor-nav").offsetWidth,f=t.querySelector("."+n).offsetWidth,i.style.removeProperty("display"),u>r+f},u.prototype.popupEleWidth=function(n){var r,t,i;return n.style.position="absolute",r=this.options.isVertical?n.offsetHeight:n.offsetWidth,t=n.querySelector(".e-tbar-btn-text"),(n.classList.contains("e-tbtn-align")||n.classList.contains("e-popup-text"))&&(i=n.children[0],!sf.base.isNullOrUndefined(t)&&n.classList.contains("e-popup-text")?t.style.display="none":!sf.base.isNullOrUndefined(t)&&n.classList.contains("e-toolbar-text")&&(t.style.display="block"),i.style.minWidth="0%",r=parseFloat(this.options.isVertical?n.style.minHeight:n.style.minWidth),i.style.minWidth="",i.style.minHeight="",sf.base.isNullOrUndefined(t)||(t.style.display="")),r},u.prototype.popupEleRefresh=function(t,r,u){for(var c,e,v=this.popupPriCount>0,l=this.tbarEle,o=this.element.querySelector("."+n),s=0,y=function(r){var h,a,y;if(r.classList.contains("e-popup-alone")&&v&&!u)return"continue";if(h=f.popupEleWidth(r),r===f.tbarEle[0]&&(h+=f.tbarEleMrgn),r.style.position="",!(h<t||u))return"break";(sf.base.setStyleAttribute(r,{minWidth:"",height:"",minHeight:""}),r.classList.contains("e-overflow-hide")||r.classList.remove(i),e=f.tbarEle.indexOf(r),f.tbarAlign)&&(a=f.options.items[e].align,e=f.tbarAlgEle[(a+"s").toLowerCase()].indexOf(r),l=f.tbarAlgEle[(a+"s").toLowerCase()],o=f.element.querySelector("."+n+" .e-toolbar-"+a.toLowerCase()));y=0;"Extended"!==f.options.overflowMode&&l.slice(0,e).forEach(function(n){(n.classList.contains("e-overflow-show")||n.classList.contains("e-separator"))&&(n.classList.contains("e-separator")&&(n.style.display="",t-=n.offsetWidth),y++)});s=f.ignoreEleFetch(e,o);r.classList.contains("e-overflow-show")?(f.tbarPriRef(o,e,y,r,u,h,t,s),t-=r.offsetWidth):0===e?(o.insertBefore(r,o.firstChild),t-=r.offsetWidth):(c=sf.base.selectAll(".e-overflow-show",f.popObj.element).length,o.insertBefore(r,o.children[e+s-c]),t-=r.offsetWidth);r.style.height=""},f=this,h=0,a=[].slice.call(r.children);h<a.length;h++)if("break"===y(a[h]))break;this.checkOverflow(this.element,this.element.getElementsByClassName(n)[0])&&!u&&this.renderOverflowMode()},u.prototype.removePositioning=function(){var t=this.element.querySelector("."+n),i;!sf.base.isNullOrUndefined(t)&&t.classList.contains("e-tbar-pos")&&(sf.base.removeClass([t],"e-tbar-pos"),i=[].slice.call(t.childNodes),i[1].removeAttribute("style"),i[2].removeAttribute("style"))},u.prototype.refreshPositioning=function(){var t=this.element.querySelector("."+n);sf.base.addClass([t],"e-tbar-pos");this.itemPositioning()},u.prototype.itemPositioning=function(){var o,f=this.element.querySelector("."+n),t,i,s,e,r,h,u;!sf.base.isNullOrUndefined(f)&&f.classList.contains("e-tbar-pos")&&(i=this.element.querySelector(".e-hor-nav"),this.scrollModule?(s=this.options.isVertical?"e-vscroll-content":"e-hscroll-content",t=[].slice.call(f.querySelector("."+s).children)):t=[].slice.call(f.childNodes),o=this.options.isVertical?t[0].offsetHeight+t[2].offsetHeight:t[0].offsetWidth+t[2].offsetWidth,e=this.options.isVertical?this.element.offsetHeight:this.element.offsetWidth,i&&(e-=this.options.isVertical?i.offsetHeight:i.offsetWidth,r=(this.options.isVertical?i.offsetHeight:i.offsetWidth)+"px",t[2].removeAttribute("style"),this.options.isVertical?this.options.enableRtl?t[2].style.top=r:t[2].style.bottom=r:this.options.enableRtl?t[2].style.left=r:t[2].style.right=r),e<=o||(h=(e-o-(this.options.isVertical?t[1].offsetHeight:t[1].offsetWidth))/2,t[1].removeAttribute("style"),u=(this.options.isVertical?t[0].offsetHeight:t[0].offsetWidth)+h+"px",this.options.isVertical?this.options.enableRtl?t[1].style.marginBottom=u:t[1].style.marginTop=u:this.options.enableRtl?t[1].style.marginRight=u:t[1].style.marginLeft=u))},u.prototype.tbarItemAlign=function(n,t,i){var e=this,r,f,u;n.showAlwaysInPopup&&"Show"!==n.overflow||(r=[],(r.push(sf.base.createElement("div",{className:"e-toolbar-left"})),r.push(sf.base.createElement("div",{className:"e-toolbar-center"})),r.push(sf.base.createElement("div",{className:"e-toolbar-right"})),0===i&&"Left"!==n.align)?(r.forEach(function(n){t.appendChild(n)}),this.tbarAlign=!0,sf.base.addClass([t],"e-tbar-pos")):"Left"!==n.align&&(f=t.childNodes,u=r[0],[].slice.call(f).forEach(function(n){e.tbarAlgEle.lefts.push(n);u.appendChild(n)}),t.appendChild(u),t.appendChild(r[1]),t.appendChild(r[2]),this.tbarAlign=!0,sf.base.addClass([t],"e-tbar-pos")))},u.prototype.renderItems=function(){var t=this.element,r=this.options.items,i;t&&r.length>0&&(i=t.querySelector("."+n),i||(i=sf.base.createElement("div",{className:n})),this.itemsAlign(r,i),sf.base.isNullOrUndefined(t.firstElementChild)?t.appendChild(i):t.insertBefore(i,t.firstElementChild))},u.prototype.setAttr=function(n,t){for(var i,u=Object.keys(n),r=0;r<u.length;r++)"class"===(i=u[r])?sf.base.addClass([t],n[i]):t.setAttribute(i,n[i])},u.prototype.itemClick=function(n){this.activeEleSwitch(n.currentTarget)},u.prototype.activeEleSwitch=function(n){this.activeEleRemove(n.firstElementChild);this.activeEle.focus()},u.prototype.activeEleRemove=function(n){sf.base.isNullOrUndefined(this.activeEle)||this.activeEle.setAttribute("tabindex","-1");this.activeEle=n;sf.base.isNullOrUndefined(this.trgtEle)&&!n.parentElement.classList.contains("e-template")?n.removeAttribute("tabindex"):this.activeEle.setAttribute("tabindex","0")},u.prototype.resize=function(){var t=this.element,i,r,u;this.tbResize=!0;this.tbarAlign&&this.itemPositioning();this.popObj&&"Popup"===this.options.overflowMode&&this.popObj.hide();i=this.checkOverflow(t,t.getElementsByClassName(n)[0]);i||(this.destroyScroll(),r=t.querySelector("."+n),sf.base.isNullOrUndefined(r)||(sf.base.removeClass([r],"e-multirow-pos"),this.tbarAlign&&sf.base.addClass([r],"e-tbar-pos")));i&&this.scrollModule&&this.offsetWid===t.offsetWidth||(((this.offsetWid>t.offsetWidth||i)&&this.renderOverflowMode(),this.popObj)&&("Extended"===this.options.overflowMode&&(u=window.getComputedStyle(this.element),this.popObj.width=parseFloat(u.width)+2*parseFloat(u.borderRightWidth)),this.tbarAlign&&this.removePositioning(),this.popupRefresh(this.popObj.element,!1),this.tbarAlign&&this.refreshPositioning()),this.offsetWid=t.offsetWidth,this.tbResize=!1,this.separator())},u.prototype.extendedOpen=function(){var n=this.element.querySelector(".e-toolbar-extended");"Extended"===this.options.overflowMode&&n&&(this.isExtendedOpen=n.classList.contains("e-popup-open"))},u.prototype.disable=function(n){var t=this.element;n?t.classList.add("e-overlay"):t.classList.remove("e-overlay");t.setAttribute("tabindex",n?"-1":"0");this.activeEle&&this.activeEle.setAttribute("tabindex",n?"-1":"0");this.scrollModule&&this.scrollModule.disable(n);this.popObj&&(sf.base.isVisible(this.popObj.element)&&"Extended"!==this.options.overflowMode&&this.popObj.hide(),t.querySelector("#"+t.id+"_nav").setAttribute("tabindex",n?"-1":"0"))},u.prototype.setCssClass=function(n){this.extendedOpen();this.options.cssClass&&sf.base.removeClass([this.element],this.options.cssClass.split(" "));n&&sf.base.addClass([this.element],n.split(" "));this.options.cssClass=n},u}();return{initialize:function(n,t,i){0===t.scrollStep&&(t.scrollStep=null);new u(n,t,i).render()},hidePopup:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||sf.base.isNullOrUndefined(n.blazor__instance.popObj)||n.blazor__instance.popObj.hide({name:"FadeOut",duration:100})},setCssClass:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.setCssClass(t)},setWidth:function(n,t){if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.blazor__instance)){n.blazor__instance.options.width=t;n.blazor__instance.extendedOpen();var i=n.offsetWidth;sf.base.setStyleAttribute(n,{width:sf.base.formatUnit(t)});n.blazor__instance.renderOverflowMode();n.blazor__instance.popObj&&i<n.offsetWidth&&n.blazor__instance.popupRefresh(n.blazor__instance.popObj.element,!1)}},setHeight:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options.height=t,n.blazor__instance.extendedOpen(),sf.base.setStyleAttribute(n,{height:sf.base.formatUnit(t)}))},setOverflowMode:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options.overflowMode=t,n.blazor__instance.extendedOpen(),n.blazor__instance.destroyMode(),n.blazor__instance.renderOverflowMode(),n.blazor__instance.options.enableRtl&&sf.base.addClass([n],"e-rtl"),n.blazor__instance.refreshOverflow())},setEnableRTL:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options.enableRtl=t,n.blazor__instance.extendedOpen(),t?sf.base.addClass([n],"e-rtl"):sf.base.removeClass([n],"e-rtl"),sf.base.isNullOrUndefined(n.blazor__instance.scrollModule)||(t?sf.base.addClass([n.blazor__instance.scrollModule.element],"e-rtl"):sf.base.removeClass([n.blazor__instance.scrollModule.element],"e-rtl")),sf.base.isNullOrUndefined(n.blazor__instance.popObj)||(t?sf.base.addClass([n.blazor__instance.popObj.element],"e-rtl"):sf.base.removeClass([n.blazor__instance.popObj.element],"e-rtl")),n.blazor__instance.tbarAlign&&n.blazor__instance.itemPositioning())},setScrollStep:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options.scrollStep=t,n.blazor__instance.extendedOpen(),n.blazor__instance.scrollModule&&(n.blazor__instance.scrollModule.scrollStep=t))},setEnableCollision:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options.enableCollision=t,n.blazor__instance.extendedOpen(),n.blazor__instance.popObj&&(n.blazor__instance.popObj.collision={Y:t?"flip":"none"}))},setAllowKeyboard:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options.allowKeyboard=t,n.blazor__instance.extendedOpen(),n.blazor__instance.unwireKeyboardEvent(),t&&n.blazor__instance.wireKeyboardEvent())},serverItemsRerender:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options.items=t,n.blazor__instance.extendedOpen(),n.blazor__instance.destroyMode(),n.blazor__instance.resetServerItems(),n.blazor__instance.serverItemsRefresh())},hideItem:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options.items=t,n.blazor__instance.refreshOverflow())},disable:function(n,t){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.disable(t)},refreshOverflow:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.refreshOverflow()},destroy:function(n){sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||n.blazor__instance.destroy()},refresh:function(n,t){0===t.scrollStep&&(t.scrollStep=null);sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.blazor__instance)||(n.blazor__instance.options=t,n.blazor__instance.destroyMode(),n.blazor__instance.resetServerItems(),n.blazor__instance.serverItemsRefresh())}}}()},"./modules/sortable.js":function(){function n(t){return(n="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(n){return _typeof2(n)}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":_typeof2(n)})(t)}window.sf=window.sf||{};sf.lists=sf.base.extend({},sf.lists,function(t){"use strict";function u(n,t,i,r){var u=[],f;(t||(t=n),i&&i.length?i.forEach(function(t){u.push(n.children[t])}):u=[].slice.call(n.children),sf.base.isNullOrUndefined(r))?u.forEach(function(n){t.appendChild(n)}):(f=t.children[r],u.forEach(function(n){t.insertBefore(n,f)}))}var r,f=(r=function(n,t){return(r=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),i=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},e=function(n){function t(t,i){var r=n.call(this,i,t)||this;return r.getHelper=function(n){var t,i=r.getSortableElement(n.sender.target);return!!r.isValidTarget(i,r)&&(r.helper?t=r.helper({sender:i,element:n.element}):((t=i.cloneNode(!0)).style.width=i.offsetWidth+"px",t.style.height=i.offsetHeight+"px"),sf.base.addClass([t],["e-sortableclone"]),document.body.appendChild(t),t)},r.onDrag=function(n){var e,t,f,o,h;if(r.trigger("drag",{event:n.event,element:r.element,target:n.target}),t=r.getSortableInstance(n.target),f=r.getSortableElement(n.target,t),(r.isValidTarget(f,t)||n.target.className.indexOf("e-list-group-item")>-1)&&(r.curTarget!==f||!sf.base.isNullOrUndefined(t.placeHolder))&&(!t.placeHolderElement||t.placeHolderElement!==n.target)){if(n.target.className.indexOf("e-list-group-item")>-1&&(f=n.target),r.curTarget=f,r.target===f)return;var i=r.getIndex(t.placeHolderElement,t),s=r.getPlaceHolder(f,t),u=void 0;if(s){if(i=sf.base.isNullOrUndefined(i)?r.getIndex(r.target):i,u=r.getIndex(f,t,n.event),o=r.isPlaceHolderPresent(t),o&&i===u)return;o&&sf.base.remove(t.placeHolderElement);t.placeHolderElement=s;n.target.className.indexOf("e-list-group-item")>-1?t.element.insertBefore(t.placeHolderElement,t.element.children[u]):t.element!==r.element&&u===t.element.childElementCount?t.element.appendChild(t.placeHolderElement):t.element.insertBefore(t.placeHolderElement,t.element.children[u]);r.refreshDisabled(i,u,t)}else i=sf.base.isNullOrUndefined(i)?r.getIndex(r.target):r.getIndex(f,t)<i||!i?i:i-1,u=r.getIndex(f,t),h=t.element!==r.element?u:i<u?u+1:u,r.updateItemClass(t),t.element.insertBefore(r.target,t.element.children[h]),r.refreshDisabled(i,u,t),r.curTarget=r.target,r.trigger("drop",{droppedElement:r.target,element:t.element,previousIndex:i,currentIndex:u,target:n.target,helper:document.getElementsByClassName("e-sortableclone")[0],event:n.event,scope:r.scope})}(t=r.getSortableInstance(r.curTarget),sf.base.isNullOrUndefined(f)&&n.target!==t.placeHolderElement)?r.isPlaceHolderPresent(t)&&r.removePlaceHolder(t):[].slice.call(document.getElementsByClassName("e-sortable-placeholder")).forEach(function(n){(e=r.getSortableInstance(n)).element&&e!==t&&r.removePlaceHolder(e)})},r.onDragStart=function(n){var t,i;r.target=r.getSortableElement(n.target);t=!1;r.target.classList.add("e-grabbed");r.curTarget=r.target;n.helper=document.getElementsByClassName("e-sortableclone")[0];i={cancel:!1,element:r.element,target:r.target};r.trigger("beforeDragStart",i,function(i){i.cancel&&(t=i.cancel,r.onDragStop(n))});t||(sf.base.isBlazor?r.trigger("dragStart",{event:n.event,element:r.element,target:r.target,bindEvents:n.bindEvents,dragElement:n.dragElement}):r.trigger("dragStart",{event:n.event,element:r.element,target:r.target}))},r.onDragStop=function(n){var i,u,e,t=r.getSortableInstance(r.curTarget),f,o,s,h;i=r.getIndex(r.target);f=r.isPlaceHolderPresent(t);f&&(o=r.getIndex(t.placeHolderElement,t),s={previousIndex:i,currentIndex:o,target:n.target,droppedElement:r.target,helper:n.helper,cancel:!1,handled:!1},r.trigger("beforeDrop",s,function(u){var o,f;u.cancel||((e=u.handled,r.updateItemClass(t),u.handled)&&(o=r.target.cloneNode(!0),r.target.classList.remove("e-grabbed"),r.target=o),t.element.insertBefore(r.target,t.placeHolderElement),f=r.getIndex(r.target,t),i=r===t&&i-f>1?i-1:i,r.trigger("drop",{event:n.event,element:t.element,previousIndex:i,currentIndex:f,target:n.target,helper:n.helper,droppedElement:r.target,scopeName:r.scope,handled:e}));sf.base.remove(t.placeHolderElement)}));(t=r.getSortableInstance(n.target),u=t.element.childElementCount,i=r.getIndex(r.target),t.element!==n.target&&(f||r.curTarget!==r.target))||(h={previousIndex:i,currentIndex:r.curTarget===r.target?i:u,target:n.target,droppedElement:r.target,helper:n.helper,cancel:!1},r.trigger("beforeDrop",h,function(f){t.element!==n.target||f.cancel||(r.updateItemClass(t),t.element.appendChild(r.target),r.trigger("drop",{event:n.event,element:t.element,previousIndex:i,currentIndex:u,target:n.target,helper:n.helper,droppedElement:r.target,scopeName:r.scope}))}));r.target.classList.remove("e-grabbed");r.target=null;r.curTarget=null;sf.base.remove(n.helper);sf.base.getComponent(r.element,sf.base.Draggable).intDestroy(n.event)},r.bind(),r}var r;return f(t,n),r=t,t.prototype.bind=function(){this.element.id||(this.element.id=sf.base.getUniqueID("sortable"));this.itemClass||(this.itemClass="e-sort-item",this.dataBind());this.initializeDraggable()},t.prototype.initializeDraggable=function(){new sf.base.Draggable(this.element,{helper:this.getHelper,dragStart:this.onDragStart,drag:this.onDrag,dragStop:this.onDragStop,dragTarget:"."+this.itemClass,enableTapHold:!0,tapHoldThreshold:200,queryPositionInfo:this.queryPositionInfo,distance:5})},t.prototype.getPlaceHolder=function(n,t){if(t.placeHolder){var i=t.placeHolder({element:t.element,grabbedElement:this.target,target:n});return i.classList.add("e-sortable-placeholder"),i}return null},t.prototype.isValidTarget=function(n,t){return n&&sf.base.compareElementParent(n,t.element)&&n.classList.contains(t.itemClass)&&!n.classList.contains("e-disabled")},t.prototype.removePlaceHolder=function(n){sf.base.remove(n.placeHolderElement);n.placeHolderElement=null},t.prototype.updateItemClass=function(n){this!==n&&(this.target.classList.remove(this.itemClass),this.target.classList.add(n.itemClass))},t.prototype.getSortableInstance=function(n){if(n=sf.base.closest(n,".e-"+this.getModuleName())){var t=sf.base.getComponent(n,r);return t.scope&&this.scope&&t.scope===this.scope?t:this}return this},t.prototype.refreshDisabled=function(n,t,i){if(i===this)for(var e=void 0,u=n<t,r=void 0,f=u?n:t,o=u?t:n;f<=o;)(e=this.element.children[f]).classList.contains("e-disabled")?(r=this.getIndex(e),this.element.insertBefore(e,this.element.children[u?r+2:r-1]),f=u?r+2:r+1):f++},t.prototype.getIndex=function(n,t,i){var r,u;return void 0===t&&(t=this),[].slice.call(t.element.children).forEach(function(t,f){if((t.classList.contains("e-sortable-placeholder")&&(u=!0),t===n)&&(r=f,!sf.base.isNullOrUndefined(i))){u&&(r-=1);var e=n.getBoundingClientRect(),o=e.bottom-(e.bottom-e.top)/2;r=i.clientY<=o?r:r+1}}),r},t.prototype.getSortableElement=function(n,t){return void 0===t&&(t=this),sf.base.closest(n,"."+t.itemClass)},t.prototype.queryPositionInfo=function(n){return n.left=pageXOffset?parseFloat(n.left)-pageXOffset+"px":n.left,n.top=pageYOffset?parseFloat(n.top)-pageYOffset+"px":n.top,n},t.prototype.isPlaceHolderPresent=function(n){return n.placeHolderElement&&!!sf.base.closest(n.placeHolderElement,"#"+n.element.id)},t.prototype.moveTo=function(n,t,i){u(this.element,n,t,i)},t.prototype.destroy=function(){"e-sort-item"===this.itemClass&&(this.itemClass=null,this.dataBind());sf.base.getComponent(this.element,sf.base.Draggable).destroy();n.prototype.destroy.call(this)},t.prototype.getModuleName=function(){return"sortable"},t.prototype.onPropertyChanged=function(n,t){for(var i=0,r=Object.keys(n);i<r.length;i++)switch(r[i]){case"itemClass":[].slice.call(this.element.children).forEach(function(i){i.classList.contains(t.itemClass)&&i.classList.remove(t.itemClass);n.itemClass&&i.classList.add(n.itemClass)})}},i([sf.base.Property(!1)],t.prototype,"enableAnimation",void 0),i([sf.base.Property(null)],t.prototype,"itemClass",void 0),i([sf.base.Property(null)],t.prototype,"scope",void 0),i([sf.base.Property()],t.prototype,"helper",void 0),i([sf.base.Property()],t.prototype,"placeHolder",void 0),i([sf.base.Event()],t.prototype,"drag",void 0),i([sf.base.Event()],t.prototype,"beforeDragStart",void 0),i([sf.base.Event()],t.prototype,"dragStart",void 0),i([sf.base.Event()],t.prototype,"beforeDrop",void 0),i([sf.base.Event()],t.prototype,"drop",void 0),t=r=i([sf.base.NotifyPropertyChanges],t)}(sf.base.Base);return t.Sortable=e,t.moveTo=u,t}({}))},"./modules/splitbuttonsbase.js":function(){function n(t){return(n="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(n){return _typeof2(n)}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":_typeof2(n)})(t)}window.sf=window.sf||{};window.sf.splitbuttons=window.sf.base.extend({},window.sf.splitbuttons,function(t){"use strict";var r,u=(r=function(n,t){return(r=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),i=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),i([sf.base.Property("")],t.prototype,"iconCss",void 0),i([sf.base.Property("")],t.prototype,"id",void 0),i([sf.base.Property(!1)],t.prototype,"separator",void 0),i([sf.base.Property("")],t.prototype,"text",void 0),i([sf.base.Property("")],t.prototype,"url",void 0),i([sf.base.Property(!1)],t.prototype,"disabled",void 0),t}(sf.base.ChildProperty);return t.getModel=function(n,t){for(var u,i=sf.base.extend({},n),r=0,f=Object.keys(i);r<f.length;r++)u=f[r],t.indexOf(u)<0&&sf.base.deleteObject(i,u);return i},t.upDownKeyHandler=function(n,t){var u=40===t?0:n.childElementCount-1,i=u,f=n.querySelector(".e-selected"),r,e;for(f&&f.classList.remove("e-selected"),r=0,e=n.children.length;r<e;r++)n.children[r].classList.contains("e-focused")&&(i=r,n.children[r].classList.remove("e-focused"),40===t?i++:i--,i===(40===t?n.childElementCount:-1)&&(i=u));-1!==(i=function n(t,i,r,u,f){if(void 0===f&&(f=0),(i.classList.contains("e-separator")||i.classList.contains("e-disabled"))&&(r===(40===u?t.childElementCount-1:0)?r=40===u?0:t.childElementCount-1:40===u?r++:r--),(i=t.children[r]).classList.contains("e-separator")||i.classList.contains("e-disabled")){if(++f===t.childElementCount)return-1;r=n(t,i,r,u,f)}return r}(n,n.children[i],i,t))&&(sf.base.addClass([n.children[i]],"e-focused"),n.children[i].focus())},t.setBlankIconStyle=function(n){var f=[].slice.call(n.getElementsByClassName("e-blank-icon")),t,i,r,e,u;f.length&&(t=n.querySelector(".e-item:not(.e-blank-icon):not(.e-separator)"),t.classList.contains("e-url")&&(t=t.querySelector(".e-menu-url")),r=t.querySelector(".e-menu-icon"),e=n.classList.contains("e-rtl"),i=e?{padding:"paddingRight",margin:"marginLeft"}:{padding:"paddingLeft",margin:"marginRight"},u=parseInt(getComputedStyle(r).fontSize,10)+parseInt(getComputedStyle(r)[i.margin],10)+parseInt(getComputedStyle(t).paddingLeft,10)+"px",f.forEach(function(n){n.classList.contains("e-url")?n.querySelector(".e-menu-url").style[i.padding]=u:n.style[i.padding]=u}))},t.Item=f,t}({}))},"./modules/svgbase.js":function(){function n(t){return(n="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(n){return _typeof2(n)}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":_typeof2(n)})(t)}window.sf=window.sf||{};window.sf.svgbase=function(t){"use strict";function p(n){var t;switch(n){case"Highcontrast":case"HighContrast":t={tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696"};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":t={tooltipFill:"#F4F4F4",tooltipBoldLabel:"#282727",tooltipLightLabel:"#333232",tooltipHeaderLine:"#9A9A9A"};break;case"Bootstrap4":t={tooltipFill:"rgba(0, 0, 0, 0.9)",tooltipBoldLabel:"rgba(255, 255, 255)",tooltipLightLabel:"rgba(255, 255, 255, 0.9)",tooltipHeaderLine:"rgba(255, 255, 255, 0.2)"};break;case"Tailwind":t={tooltipFill:"#111827",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280"};break;case"TailwindDark":t={tooltipFill:"#F9FAFB",tooltipBoldLabel:"#6B7280",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF"};break;case"Bootstrap5":t={tooltipFill:"#212529",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#9CA3AF"};break;case"Bootstrap5Dark":t={tooltipFill:"#E9ECEF",tooltipBoldLabel:"#212529",tooltipLightLabel:"#212529",tooltipHeaderLine:"#ADB5BD"};break;default:t={tooltipFill:"rgba(0, 8, 22, 0.75)",tooltipBoldLabel:"#ffffff",tooltipLightLabel:"#dbdbdb",tooltipHeaderLine:"#ffffff"}}return t}function e(n,t){var e=n||"",i=document.getElementById("chartmeasuretext"),r,u;if(null===i&&(i=sf.base.createElement("text",{id:"chartmeasuretext"}),document.body.appendChild(i)),"string"==typeof n&&(n.indexOf("<")>-1||n.indexOf(">")>-1)){for(r=n.split(" "),u=0;u<r.length;u++)-1===r[u].indexOf("<br/>")&&(r[u]=r[u].replace(/[<>]/g,"&"));n=r.join(" ")}return i.innerHTML=e.indexOf("<br>")>-1||e.indexOf("<br/>")>-1?e:n,i.style.position="fixed",i.style.fontSize=t.size,i.style.fontWeight=t.fontWeight,i.style.fontStyle=t.fontStyle,i.style.fontFamily=t.fontFamily,i.style.visibility="hidden",i.style.top="-100",i.style.left="0",i.style.whiteSpace="nowrap",i.style.lineHeight="normal",new f(i.clientWidth,i.clientHeight)}function b(n,t,i,r,u,f,e,o,s,h,c){var v="",l=i.x,p=i.y,y=i.x+i.width,a=i.y+i.height;return c=c||0,f?(v=(v=v.concat("M "+l+" "+(p+t)+" Q "+l+" "+p+" "+(l+n)+" "+p+"  L "+(y-n)+" "+p+" Q "+y+" "+p+" "+y+" "+(p+t))).concat(" L "+y+" "+(a-t)+" Q "+y+" "+a+" "+(y-n)+" "+a),0!==u&&(v=(v=v.concat(" L "+(r.x+u/2)+" "+a)).concat(" L "+(s+c)+" "+(a+u-c)),v+=" Q "+s+" "+(a+u)+" "+(s-c)+" "+(a+u-c)),v=r.x-u/2>l?v.concat(" L "+(r.x-u/2)+" "+a+" L "+(l+n)+" "+a+" Q "+l+" "+a+" "+l+" "+(a-t)+" z"):0===u?v.concat(" L "+(l+n)+" "+a+" Q "+l+" "+a+" "+l+" "+(a-t)+" z"):v.concat(" L "+l+" "+(a+t)+" z")):e?(v=(v=v.concat("M "+l+" "+(p+t)+" Q "+l+" "+p+" "+(l+n)+" "+p+" L "+(r.x-u/2)+" "+p)).concat(" L "+(s-c)+" "+(r.y+c)),v=(v=(v+=" Q "+s+" "+r.y+" "+(s+c)+" "+(r.y+c)).concat(" L "+(r.x+u/2)+" "+p+" L "+(y-n)+" "+p+" Q "+y+" "+p+" "+y+" "+(p+t))).concat(" L "+y+" "+(a-t)+" Q "+y+" "+a+" "+(y-n)+" "+a+" L "+(l+n)+" "+a+" Q "+l+" "+a+" "+l+" "+(a-t)+" z")):o?(v=(v=(v=v.concat("M "+l+" "+(p+t)+" Q "+l+" "+p+" "+(l+n)+" "+p)).concat(" L "+(y-n)+" "+p+" Q "+y+" "+p+" "+y+" "+(p+t)+" L "+y+" "+(r.y-u/2))).concat(" L "+(y+u-c)+" "+(h-c)),v=(v=(v+=" Q "+(y+u)+" "+h+" "+(y+u-c)+" "+(h+c)).concat(" L "+y+" "+(r.y+u/2)+" L "+y+" "+(a-t)+" Q "+y+" "+a+" "+(y-n)+" "+a)).concat(" L "+(l+n)+" "+a+" Q "+l+" "+a+" "+l+" "+(a-t)+" z")):(v=(v=v.concat("M "+(l+n)+" "+p+" Q "+l+" "+p+" "+l+" "+(p+t)+" L "+l+" "+(r.y-u/2))).concat(" L "+(l-u+c)+" "+(h-c)),v=(v=(v+=" Q "+(l-u)+" "+h+" "+(l-u+c)+" "+(h+c)).concat(" L "+l+" "+(r.y+u/2)+" L "+l+" "+(a-t)+" Q "+l+" "+a+" "+(l+n)+" "+a)).concat(" L "+(y-n)+" "+a+" Q "+y+" "+a+" "+y+" "+(a-t)+" L "+y+" "+(p+t)+" Q "+y+" "+p+" "+(y-n)+" "+p+" z")),v}function u(n){return document.getElementById(n)}function s(n){var t=u(n);t&&sf.base.remove(t)}function g(n,t,i,r,u,f){var s=new c(""),e=nt(n,i,t,u,r),o=s["draw"+e.functionName](e.renderOption);return o.setAttribute("aria-label",f),o}function nt(n,t,i,r,u){var s,a="Path",h=t.width,e=t.height,o=n.x,f=n.y,c=n.x+-h/2,p=n.y+-e/2;switch(i){case"Circle":case"Bubble":a="Ellipse";sf.base.merge(r,{rx:h/2,ry:e/2,cx:o,cy:f});break;case"Cross":s="M "+c+" "+f+" L "+(o+h/2)+" "+f+" M "+o+" "+(f+e/2)+" L "+o+" "+(f+-e/2);sf.base.merge(r,{d:s});break;case"HorizontalLine":s="M "+c+" "+f+" L "+(o+h/2)+" "+f;sf.base.merge(r,{d:s});break;case"VerticalLine":s="M "+o+" "+(f+e/2)+" L "+o+" "+(f+-e/2);sf.base.merge(r,{d:s});break;case"Diamond":s="M "+c+" "+f+" L "+o+" "+(f+-e/2)+" L "+(o+h/2)+" "+f+" L "+o+" "+(f+e/2)+" L "+c+" "+f+" z";sf.base.merge(r,{d:s});break;case"Rectangle":s="M "+c+" "+(f+-e/2)+" L "+(o+h/2)+" "+(f+-e/2)+" L "+(o+h/2)+" "+(f+e/2)+" L "+c+" "+(f+e/2)+" L "+c+" "+(f+-e/2)+" z";sf.base.merge(r,{d:s});break;case"Triangle":s="M "+c+" "+(f+e/2)+" L "+o+" "+(f+-e/2)+" L "+(o+h/2)+" "+(f+e/2)+" L "+c+" "+(f+e/2)+" z";sf.base.merge(r,{d:s});break;case"InvertedTriangle":s="M "+(o+h/2)+" "+(f-e/2)+" L "+o+" "+(f+e/2)+" L "+(o-h/2)+" "+(f-e/2)+" L "+(o+h/2)+" "+(f-e/2)+" z";sf.base.merge(r,{d:s});break;case"Pentagon":for(var v=void 0,y=void 0,l=0;l<=5;l++)v=h/2*Math.cos(Math.PI/180*72*l),y=e/2*Math.sin(Math.PI/180*72*l),s=0===l?"M "+(o+v)+" "+(f+y)+" ":s.concat("L "+(o+v)+" "+(f+y)+" ");s=s.concat("Z");sf.base.merge(r,{d:s});break;case"Image":a="Image";sf.base.merge(r,{href:u,height:e,width:h,x:c,y:p})}return{renderOption:r,functionName:a}}function it(n,t,i,r){var f,o=new c(""),e,u;return f={id:n.id,x:n.x,y:n.y,fill:i,"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight,"text-anchor":n.anchor,transform:n.transform,opacity:t.opacity,"dominant-baseline":n.baseLine},e="string"==typeof n.text?n.text:n.text[0],u=o.createText(f,e),u.style.fontFamily=t.fontFamily,u.style.fontStyle=t.fontStyle,u.style.fontSize=t.size,u.style.fontWeight=t.fontWeight,u.style.color=t.color,r.appendChild(u),u}var c=function(){function n(n){this.svgLink="http://www.w3.org/2000/svg";this.rootId=n}return n.prototype.getOptionValue=function(n,t){return n[t]},n.prototype.createSvg=function(n){return sf.base.isNullOrUndefined(n.id)&&(n.id=this.rootId+"_svg"),this.svgObj=document.getElementById(n.id),sf.base.isNullOrUndefined(document.getElementById(n.id))&&(this.svgObj=document.createElementNS(this.svgLink,"svg")),this.svgObj=this.setElementAttributes(n,this.svgObj),this.setSVGSize(n.width,n.height),this.svgObj},n.prototype.setSVGSize=function(n,t){var i=document.getElementById(this.rootId),r=sf.base.isNullOrUndefined(i)?null:i.getBoundingClientRect();sf.base.isNullOrUndefined(this.width)||this.width<=0?this.svgObj.setAttribute("width",n?n.toString():r.width.toString()):this.svgObj.setAttribute("width",this.width.toString());sf.base.isNullOrUndefined(this.height)||this.height<=0?this.svgObj.setAttribute("height",t?t.toString():"450"):this.svgObj.setAttribute("height",this.height.toString())},n.prototype.drawPath=function(n){var t=document.getElementById(n.id);return null===t&&(t=document.createElementNS(this.svgLink,"path")),t=this.setElementAttributes(n,t)},n.prototype.drawLine=function(n){var t=document.getElementById(n.id);return null===t&&(t=document.createElementNS(this.svgLink,"line")),t=this.setElementAttributes(n,t)},n.prototype.drawRectangle=function(n){var t=document.getElementById(n.id);return null===t&&(t=document.createElementNS(this.svgLink,"rect")),t=this.setElementAttributes(n,t)},n.prototype.drawCircle=function(n){var t=document.getElementById(n.id);return null===t&&(t=document.createElementNS(this.svgLink,"circle")),t=this.setElementAttributes(n,t)},n.prototype.drawPolyline=function(n){var t=document.getElementById(n.id);return null===t&&(t=document.createElementNS(this.svgLink,"polyline")),t=this.setElementAttributes(n,t)},n.prototype.drawEllipse=function(n){var t=document.getElementById(n.id);return null===t&&(t=document.createElementNS(this.svgLink,"ellipse")),t=this.setElementAttributes(n,t)},n.prototype.drawPolygon=function(n){var t=document.getElementById(n.id);return null===t&&(t=document.createElementNS(this.svgLink,"polygon")),t=this.setElementAttributes(n,t)},n.prototype.drawImage=function(n){var t=document.createElementNS(this.svgLink,"image");return t.setAttributeNS(null,"height",n.height.toString()),t.setAttributeNS(null,"width",n.width.toString()),t.setAttributeNS("http://www.w3.org/1999/xlink","href",n.href),t.setAttributeNS(null,"x",n.x.toString()),t.setAttributeNS(null,"y",n.y.toString()),t.setAttributeNS(null,"id",n.id),t.setAttributeNS(null,"visibility",n.visibility),sf.base.isNullOrUndefined(this.getOptionValue(n,"clip-path"))||t.setAttributeNS(null,"clip-path",this.getOptionValue(n,"clip-path")),sf.base.isNullOrUndefined(n.preserveAspectRatio)||t.setAttributeNS(null,"preserveAspectRatio",n.preserveAspectRatio),t},n.prototype.createText=function(n,t){var i=document.createElementNS(this.svgLink,"text");return i=this.setElementAttributes(n,i),sf.base.isNullOrUndefined(t)||(i.textContent=t),i},n.prototype.createTSpan=function(n,t){var i=document.createElementNS(this.svgLink,"tspan");return i=this.setElementAttributes(n,i),sf.base.isNullOrUndefined(t)||(i.textContent=t),i},n.prototype.createTitle=function(n){var t=document.createElementNS(this.svgLink,"title");return t.textContent=n,t},n.prototype.createDefs=function(){return document.createElementNS(this.svgLink,"defs")},n.prototype.createClipPath=function(n){var t=document.createElementNS(this.svgLink,"clipPath");return this.setElementAttributes(n,t)},n.prototype.createForeignObject=function(n){var t=document.createElementNS(this.svgLink,"foreignObject");return this.setElementAttributes(n,t)},n.prototype.createGroup=function(n){var t=document.createElementNS(this.svgLink,"g");return this.setElementAttributes(n,t)},n.prototype.createPattern=function(n,t){var i=document.createElementNS(this.svgLink,t);return this.setElementAttributes(n,i)},n.prototype.createRadialGradient=function(n,t,i){var r,u;return sf.base.isNullOrUndefined(n[0].colorStop)?r=n[0].color.toString():(u={id:this.rootId+"_"+t+"radialGradient",cx:i.cx+"%",cy:i.cy+"%",r:i.r+"%",fx:i.fx+"%",fy:i.fy+"%"},this.drawGradient("radialGradient",u,n),r="url(#"+this.rootId+"_"+t+"radialGradient)"),r},n.prototype.createLinearGradient=function(n,t,i){var r,u;return sf.base.isNullOrUndefined(n[0].colorStop)?r=n[0].color.toString():(u={id:this.rootId+"_"+t+"linearGradient",x1:i.x1+"%",y1:i.y1+"%",x2:i.x2+"%",y2:i.y2+"%"},this.drawGradient("linearGradient",u,n),r="url(#"+this.rootId+"_"+t+"linearGradient)"),r},n.prototype.drawGradient=function(n,t,i){for(var e=this.createDefs(),f=document.createElementNS(this.svgLink,n),u,f=this.setElementAttributes(t,f),r=0;r<i.length;r++)u=document.createElementNS(this.svgLink,"stop"),u.setAttribute("offset",i[r].colorStop),u.setAttribute("stop-color",i[r].color),u.setAttribute("stop-opacity",i[r].opacity?i[r].opacity:"1"),sf.base.isNullOrUndefined(i[r].style)||u.setAttribute("style",i[r].style),f.appendChild(u);return e.appendChild(f),e},n.prototype.drawClipPath=function(n){var t=this.createDefs(),i=this.createClipPath({id:n.id}),r;return n.id=n.id+"_Rect",r=this.drawRectangle(n),i.appendChild(r),t.appendChild(i),t},n.prototype.drawCircularClipPath=function(n){var t=this.createDefs(),i=this.createClipPath({id:n.id}),r;return n.id=n.id+"_Circle",r=this.drawCircle(n),i.appendChild(r),t.appendChild(i),t},n.prototype.setElementAttributes=function(n,t){for(var r=Object.keys(n),i=0;i<r.length;i++)t.setAttribute(r[i],n[r[i]]);return t},n.prototype.createCanvas=function(){return null},n}(),et=function(){function n(n){this.rootId=n}return n.prototype.getOptionValue=function(n,t){return n[t]},n.prototype.createCanvas=function(n){var t=document.createElement("canvas");return t.setAttribute("id",this.rootId+"_canvas"),this.ctx=t.getContext("2d"),this.canvasObj=t,this.setCanvasSize(n.width,n.height),this.canvasObj},n.prototype.setCanvasSize=function(n,t){var i=document.getElementById(this.rootId),r=sf.base.isNullOrUndefined(i)?null:i.getBoundingClientRect();sf.base.isNullOrUndefined(this.width)?this.canvasObj.setAttribute("width",n?n.toString():r.width.toString()):this.canvasObj.setAttribute("width",this.width.toString());sf.base.isNullOrUndefined(this.height)?this.canvasObj.setAttribute("height",t?t.toString():"450"):this.canvasObj.setAttribute("height",this.height.toString())},n.prototype.setAttributes=function(n){var t,i;this.ctx.lineWidth=this.getOptionValue(n,"stroke-width");t=this.getOptionValue(n,"stroke-dasharray");sf.base.isNullOrUndefined(t)||(i=t.split(","),this.ctx.setLineDash([parseInt(i[0],10),parseInt(i[1],10)]));this.ctx.strokeStyle=this.getOptionValue(n,"stroke")},n.prototype.drawLine=function(n){this.ctx.save();this.ctx.beginPath();this.ctx.lineWidth=this.getOptionValue(n,"stroke-width");this.ctx.strokeStyle=n.stroke;this.ctx.moveTo(n.x1,n.y1);this.ctx.lineTo(n.x2,n.y2);this.ctx.stroke();this.ctx.restore()},n.prototype.drawRectangle=function(n,t){var r=this.ctx,i=n.rx;return this.ctx.save(),this.ctx.beginPath(),t&&this.ctx.translate(t[0],t[1]),this.ctx.globalAlpha=this.getOptionValue(n,"opacity"),this.setAttributes(n),this.ctx.rect(n.x,n.y,n.width,n.height),null!==i&&i>=0?this.drawCornerRadius(n):("none"===n.fill&&(n.fill="transparent"),this.ctx.fillStyle=n.fill,this.ctx.fillRect(n.x,n.y,n.width,n.height),this.ctx.stroke()),this.ctx.restore(),this.ctx=r,this.canvasObj},n.prototype.drawCornerRadius=function(n){var t=n.rx,i=n.x,r=n.y,u=n.width,f=n.height;"none"===n.fill&&(n.fill="transparent");this.ctx.fillStyle=n.fill;u<2*t&&(t=u/2);f<2*t&&(t=f/2);this.ctx.beginPath();this.ctx.moveTo(i+u-t,r);this.ctx.arcTo(i+u,r,i+u,r+f,t);this.ctx.arcTo(i+u,r+f,i,r+f,t);this.ctx.arcTo(i,r+f,i,r,t);this.ctx.arcTo(i,r,i+u,r,t);this.ctx.closePath();this.ctx.fill();this.ctx.stroke()},n.prototype.drawPath=function(n,t){var r=n.d.split(" "),h=this.getOptionValue(n,"stroke-width"),c=this.ctx,e=!0,i,u,f,o,s;for(this.ctx.save(),this.ctx.beginPath(),t&&this.ctx.translate(t[0],t[1]),this.ctx.globalAlpha=n.opacity?n.opacity:this.getOptionValue(n,"fill-opacity"),this.setAttributes(n),i=0;i<r.length;i+=3){u=parseFloat(r[i+1]);f=parseFloat(r[i+2]);switch(r[i]){case"M":n.innerR||n.cx||this.ctx.moveTo(u,f);break;case"L":n.innerR||this.ctx.lineTo(u,f);break;case"Q":o=parseFloat(r[i+3]);s=parseFloat(r[i+4]);this.ctx.quadraticCurveTo(u,f,o,s);i+=2;break;case"C":var l=parseFloat(r[i+3]),a=parseFloat(r[i+4]),v=parseFloat(r[i+5]),y=parseFloat(r[i+6]);this.ctx.bezierCurveTo(u,f,l,a,v,y);i+=4;break;case"A":n.innerR?e&&(this.ctx.arc(n.x,n.y,n.radius,n.start,n.end,n.counterClockWise),this.ctx.arc(n.x,n.y,n.innerR,n.end,n.start,!n.counterClockWise),e=!1):n.cx?this.ctx.arc(n.cx,n.cy,n.radius,0,2*Math.PI,n.counterClockWise):(this.ctx.moveTo(n.x,n.y),this.ctx.arc(n.x,n.y,n.radius,n.start,n.end,n.counterClockWise),this.ctx.lineTo(n.x,n.y));i+=5;break;case"z":case"Z":this.ctx.closePath();i-=2}}return"none"!==n.fill&&void 0!==n.fill&&(this.ctx.fillStyle=n.fill,this.ctx.fill()),h>0&&this.ctx.stroke(),this.ctx.restore(),this.ctx=c,this.canvasObj},n.prototype.createText=function(n,t,i,r,u,f){var e=this.getOptionValue(n,"font-weight");sf.base.isNullOrUndefined(e)||"regular"!==e.toLowerCase()||(e="normal");var s=this.getOptionValue(n,"font-size"),h=this.getOptionValue(n,"font-family"),c=this.getOptionValue(n,"font-style").toLowerCase()+" "+e+" "+s+" "+h,o=this.getOptionValue(n,"text-anchor"),l=void 0!==n.opacity?n.opacity:1;return("middle"===o&&(o="center"),this.ctx.save(),this.ctx.fillStyle=n.fill,this.ctx.font=c,this.ctx.textAlign=o,this.ctx.globalAlpha=l,n.baseline&&(this.ctx.textBaseline=n.baseline),f)||(this.ctx.translate(n.x+0+(i||0),n.y+(r||0)),this.ctx.rotate(n.labelRotation*Math.PI/180)),this.ctx.fillText(t,f?n.x:0,f?u:0),this.ctx.restore(),this.canvasObj},n.prototype.drawCircle=function(n,t){var i=this.ctx;return this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.cx,n.cy,n.r,0,2*Math.PI),this.ctx.fillStyle=n.fill,this.ctx.globalAlpha=n.opacity,this.ctx.fill(),t&&this.ctx.translate(t[0],t[1]),this.setAttributes(n),this.ctx.stroke(),this.ctx.restore(),this.ctx=i,this.canvasObj},n.prototype.drawPolyline=function(n){var i,t;for(this.ctx.save(),this.ctx.beginPath(),i=n.points.split(" "),t=0;t<i.length-1;t++){var r=i[t].split(","),u=parseFloat(r[0]),f=parseFloat(r[1]);0===t?this.ctx.moveTo(u,f):this.ctx.lineTo(u,f)}this.ctx.lineWidth=this.getOptionValue(n,"stroke-width");this.ctx.strokeStyle=n.stroke;this.ctx.stroke();this.ctx.restore()},n.prototype.drawEllipse=function(n,t){var r=this.ctx,i=Math.max(n.rx,n.ry),u=n.rx/i,f=n.ry/i;this.ctx.save();this.ctx.beginPath();this.ctx.translate(n.cx,n.cy);t&&this.ctx.translate(t[0],t[1]);this.ctx.save();this.ctx.scale(u,f);this.ctx.arc(0,0,i,0,2*Math.PI,!1);this.ctx.fillStyle=n.fill;this.ctx.fill();this.ctx.restore();this.ctx.lineWidth=this.getOptionValue(n,"stroke-width");this.ctx.strokeStyle=n.stroke;this.ctx.stroke();this.ctx.restore();this.ctx=r},n.prototype.drawImage=function(n){this.ctx.save();var t=new Image;sf.base.isNullOrUndefined(n.href)||(t.src=n.href,this.ctx.drawImage(t,n.x,n.y,n.width,n.height));this.ctx.restore()},n.prototype.createLinearGradient=function(n){var t;return sf.base.isNullOrUndefined(n[0].colorStop)||(t=this.ctx.createLinearGradient(0,0,0,this.canvasObj.height)),this.setGradientValues(n,t)},n.prototype.createRadialGradient=function(n){var t;return sf.base.isNullOrUndefined(n[0].colorStop)||(t=this.ctx.createRadialGradient(0,0,0,0,0,this.canvasObj.height)),this.setGradientValues(n,t)},n.prototype.setGradientValues=function(n,t){var r,i;if(sf.base.isNullOrUndefined(n[0].colorStop))r=n[0].color.toString();else{for(i=0;i<=n.length-1;i++){var u=n[i].color,f=n[i].colorStop.slice(0,-1),e=parseInt(f,10)/100;t.addColorStop(e,u)}r=t.toString()}return r},n.prototype.setElementAttributes=function(n,t){for(var r=Object.keys(n),u=Object.keys(n).map(function(t){return n[t]}),i=0;i<r.length;i++)t.setAttribute(r[i],u[i]);return null},n.prototype.updateCanvasAttributes=function(n){var i,t;this.setElementAttributes(n,this.canvasObj);i=this.ctx;sf.base.isNullOrUndefined(this.dataUrl)||(t=new Image,t.onload=function(){i.drawImage(t,0,0)},t.src=this.dataUrl)},n.prototype.clearRect=function(n){this.ctx.restore();this.ctx.clearRect(n.x,n.y,n.width,n.height)},n.prototype.createGroup=function(){return null},n.prototype.drawClipPath=function(){return null},n.prototype.canvasClip=function(n){this.ctx.save();this.ctx.fillStyle="transparent";this.ctx.rect(n.x,n.y,n.width,n.height);this.ctx.fill();this.ctx.clip()},n.prototype.canvasRestore=function(){this.ctx.restore()},n.prototype.drawPolygon=function(){return null},n.prototype.createDefs=function(){return null},n.prototype.createClipPath=function(){return null},n.prototype.createSvg=function(){return null},n}(),l,w=(l=function(n,t){return(l=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}l(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),f=function(n,t){this.width=n;this.height=t},o=function(n,t,i,r){this.x=n;this.y=t;this.width=i;this.height=r},k=function(n,t){this.isRight=t;this.isBottom=n},a=function(n){this.id=n},d=function(n){function t(t,i,r,u,f,e,o,s){void 0===e&&(e="");var h=n.call(this,t)||this;return h.transform="",h.baseLine="auto",h.labelRotation=0,h.x=i,h.y=r,h.anchor=u,h.text=f,h.transform=e,h.baseLine=o,h.labelRotation=s,h}return w(t,n),t}(a),tt=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,t)||this;return s.opacity=f,s.fill=i,s.stroke=u,s["stroke-width"]=r,s["stroke-dasharray"]=e,s.d=o,s}return w(t,n),t}(a),v,r=function(n,t){this.x=n;this.y=t},h=(v=function(n,t){return(v=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}v(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),i=function(t,i,r,u){var e,o=arguments.length,f=o<3?i:null===u?u=Object.getOwnPropertyDescriptor(i,r):u,s;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(t,i,r,u);else for(s=t.length-1;s>=0;s--)(e=t[s])&&(f=(o<3?e(f):o>3?e(i,r,f):e(i,r))||f);return o>3&&f&&Object.defineProperty(i,r,f),f},rt=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return h(t,n),i([sf.base.Property(null)],t.prototype,"size",void 0),i([sf.base.Property("")],t.prototype,"color",void 0),i([sf.base.Property("Segoe UI")],t.prototype,"fontFamily",void 0),i([sf.base.Property("Normal")],t.prototype,"fontWeight",void 0),i([sf.base.Property("Normal")],t.prototype,"fontStyle",void 0),i([sf.base.Property(1)],t.prototype,"opacity",void 0),t}(sf.base.ChildProperty),ut=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return h(t,n),i([sf.base.Property("")],t.prototype,"color",void 0),i([sf.base.Property(1)],t.prototype,"width",void 0),t}(sf.base.ChildProperty),ft=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return h(t,n),i([sf.base.Property(0)],t.prototype,"x",void 0),i([sf.base.Property(0)],t.prototype,"y",void 0),i([sf.base.Property(0)],t.prototype,"width",void 0),i([sf.base.Property(0)],t.prototype,"height",void 0),t}(sf.base.ChildProperty),y=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return h(t,n),i([sf.base.Property(0)],t.prototype,"x",void 0),i([sf.base.Property(0)],t.prototype,"y",void 0),t}(sf.base.ChildProperty),ot=function(n){function t(t,i){return n.call(this,t,i)||this}return h(t,n),t.prototype.preRender=function(){this.allowServerDataBinding=!1;this.initPrivateVariable();this.isCanvas||this.removeSVG();this.createTooltipElement()},t.prototype.initPrivateVariable=function(){this.renderer=new c(this.element.id);this.themeStyle=p(this.theme);this.formattedText=[];this.padding=5;this.isFirst=!0;this.markerPoint=[]},t.prototype.removeSVG=function(){var n=document.getElementById(this.element.id+"_svg"),t=document.getElementById(this.element.id+"parent_template");this.blazorTemplate&&sf.base.resetBlazorTemplate(this.element.id+"parent_template_blazorTemplate");n&&n.parentNode&&sf.base.remove(n);t&&t.parentNode&&sf.base.remove(t)},t.prototype.render=function(){var i,n,t;(this.fadeOuted=!1,this.template)?(this.updateTemplateFn(),this.createTemplate(this.areaBounds,this.location)):(this.renderText(this.isFirst),i={cancel:!1,name:"tooltipRender",tooltip:this},this.trigger("tooltipRender",i),n=this.renderTooltipElement(this.areaBounds,this.location),this.drawMarker(n.isBottom,n.isRight,this.markerSize));this.trigger("loaded",{tooltip:this});t=document.getElementById("chartmeasuretext");t&&sf.base.remove(t);this.allowServerDataBinding=!0},t.prototype.createTooltipElement=function(){var t,n,i;(this.textElements=[],!this.template||this.shared)&&(t=this.renderer.createSvg({id:this.element.id+"_svg"}),this.element.appendChild(t),n=document.getElementById(this.element.id+"_group"),n||(n=this.renderer.createGroup({id:this.element.id+"_group"})).setAttribute("transform","translate(0,0)"),t.appendChild(n),i=this.renderer.drawPath({id:this.element.id+"_path","stroke-width":this.border.width,fill:this.fill||this.themeStyle.tooltipFill,opacity:"TailwindDark"!==this.theme&&"Tailwind"!==this.theme&&"Bootstrap5"!==this.theme&&"Bootstrap5Dark"!==this.theme||.75!==this.opacity?this.opacity:1,stroke:this.border.color}),n.appendChild(i))},t.prototype.drawMarker=function(n,t,i){var s;if(this.shapes.length<=0)return null;for(var h,e=0,c=this.renderer.createGroup({id:this.element.id+"_trackball_group"}),a=u(this.element.id+"_group"),v=2*this.marginX+i/2+(t?this.arrowPadding:0),o=0,l=this.shapes;o<l.length;o++)s=l[o],"None"!==s&&(h=new tt(this.element.id+"_Trackball_"+e,this.palette[e],1,"#cccccc",1,null),this.markerPoint[e]&&c.appendChild(g(new r(v,this.markerPoint[e]-this.padding+(n?this.arrowPadding:0)),s,new f(i,i),"",h,null)),e++);a.appendChild(c)},t.prototype.renderTooltipElement=function(n,t){var i,tt=u(this.element.id),it=new r(0,0),y=new r(0,0),p=u(this.element.id+"_svg"),w=u(this.element.id+"_group"),l=u(this.element.id+"_path"),s=!1,h=!1,f=!1,d=0,g=0,c,ut,nt,a,v;if(this.tipRadius=1,""!==this.header&&(this.elementSize.height+=this.marginY),this.content.length>1?(i=this.sharedTooltipLocation(n,this.location.x,this.location.y),s=!0):(i=this.tooltipLocation(n,t,it,y),this.inverted?d=(h=i.x<t.x+this.clipBounds.x)?0:this.arrowPadding:(f=!(s=i.y<t.y+this.clipBounds.y),g=s?0:this.arrowPadding)),""!==this.header){var rt=e(this.isWrap?this.wrappedText:this.header,this.textStyle).height+2*this.marginY+(f?this.arrowPadding:0)+(this.isWrap?5:0),ft="M "+(3*this.marginX+(h||s||f?0:this.arrowPadding))+" "+rt+"L "+(i.width+(h||s||f?0:this.arrowPadding)-2*this.marginX)+" "+rt,et=this.renderer.drawPath({id:this.element.id+"_header_path","stroke-width":1,fill:null,opacity:.8,stroke:this.themeStyle.tooltipHeaderLine,d:ft});w.appendChild(et)}return c=this.border.width/2,ut=new o(c+d,c+g,i.width-c,i.height-c),(w.setAttribute("opacity","1"),!this.enableAnimation||this.shared||this.isFirst?this.updateDiv(tt,i.x,i.y):this.animateTooltipDiv(tt,i),p.setAttribute("height",(i.height+this.border.width+(this.inverted?0:this.arrowPadding)+5).toString()),p.setAttribute("width",(i.width+this.border.width+(this.inverted?this.arrowPadding:0)+5).toString()),p.setAttribute("opacity","1"),sf.base.isNullOrUndefined(this.tooltipPlacement)||(s=this.tooltipPlacement.indexOf("Top")>-1,f=this.tooltipPlacement.indexOf("Bottom")>-1,h=this.tooltipPlacement.indexOf("Left")>-1),l.setAttribute("d",b(this.rx,this.ry,ut,it,this.arrowPadding,s,f,h,y.x,y.y,this.tipRadius)),this.enableShadow&&"Bootstrap4"!==this.theme)&&(nt=this.element.id+"_shadow","Tailwind"===this.theme||"TailwindDark"===this.theme||"Bootstrap5"===this.theme||"Bootstrap5Dark"===this.theme?l.setAttribute("box-shadow","0px 1px 2px rgba(0, 0, 0, 0.06), 0px 1px 3px rgba(0, 0, 0, 0.1)"):l.setAttribute("filter",sf.base.Browser.isIE?"":"url(#"+nt+")"),a='<filter id="'+nt+'" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="3"/>',a+='<feOffset dx="3" dy="3" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.5"/>',a+='<\/feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/><\/feMerge><\/filter>',v=this.renderer.createDefs(),v.setAttribute("id",this.element.id+"SVG_tooltip_definition"),w.appendChild(v),v.innerHTML=a),l.setAttribute("stroke",this.border.color),this.changeText(new r(d,g),f,!h&&!s&&!f),new k(f,!h&&!s&&!f)},t.prototype.changeText=function(n,t,i){var r=document.getElementById(this.element.id+"_text");t&&r.setAttribute("transform","translate(0,"+this.arrowPadding+")");i&&r.setAttribute("transform","translate("+this.arrowPadding+" 0)")},t.prototype.findFormattedText=function(){this.formattedText=[];""!==this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()&&(this.formattedText=this.formattedText.concat(this.header));this.formattedText=this.formattedText.concat(this.content)},t.prototype.renderText=function(n){var ct,i,r,t,ut,ft=0,p=0,y=0,o=sf.base.extend({},this.textStyle,null,!0).properties,gt=u(this.element.id+"_group"),w="",lt,rt,kt,v,st,ht,dt;this.findFormattedText();lt="rtl"===document.body.getAttribute("dir")?"end":"start";this.leftSpace=this.areaBounds.x+this.location.x;this.rightSpace=this.areaBounds.x+this.areaBounds.width-this.leftSpace;var h=this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim(),b=this.header.indexOf("<b>")>-1&&this.header.indexOf("<\/b>")>-1,k=e(this.formattedText[0],o).width+2*this.marginX+this.arrowPadding,ni=this.location.x-k<this.location.x,ti=this.areaBounds.x+this.areaBounds.width<this.location.x+k,at=""!==h?this.marginY:0,et=!0,a=!0;this.markerPoint=[];var vt,g=this.shapes.length>0?10:0,nt=this.shapes.length>0?5:0,l="Normal",tt=this.themeStyle.tooltipLightLabel,yt=22/parseFloat("13px")*parseFloat(o.size);n&&!this.isCanvas||(s(this.element.id+"_text"),s(this.element.id+"_header_path"),s(this.element.id+"_trackball_group"),s(this.element.id+"SVG_tooltip_definition"));for(var pt=new d(this.element.id+"_text",2*this.marginX,2*this.marginY+2*this.padding+(2===this.marginY?3:0),lt,""),wt=it(pt,o,null,gt),ii=1===this.formattedText.length&&this.formattedText[0].indexOf(" : <b>")>-1,ot=""!==this.header,bt=ot&&b?16:13,c=0,ri=this.formattedText.length;c<ri;c++)if(r=this.formattedText[c].replace(/<(b|strong)>/g,"<b>").replace(/<\/(b|strong)>/g,"<\/b>").split(/<br.*?>/g),0===c&&!ii&&this.isTextWrap&&(this.leftSpace<k||ni)&&(this.rightSpace<k||ti)&&(vt=Math.round(this.leftSpace>this.rightSpace?this.leftSpace/bt:this.rightSpace/bt),r=(""!==h?h:this.formattedText[c]).match(new RegExp(".{1,"+vt+"}","g")),this.wrappedText=b?"<b>"+r.join("<br>")+"<\/b>":r.join("<br>"),this.isWrap=r.length>1),""!==r[0])for(0===c&&""!==h||this.markerPoint.push((""!==h?this.marginY:0)+pt.y+ft),rt=0,kt=r.length;rt<kt;rt++){for(y=0,a=!0,ft+=yt,v=0,st=(ct=r[rt].replace(/<b>/g,"<br><b>").replace(/<\/b>/g,"<\/b><br>").replace(/:/g,"<br>:<br>").split("<br>")).length;v<st;v++)t=ct[v],/\S/.test(t)||""===t||(t=" "),(!a&&" "===t||""!==t.replace(/<b>/g,"").replace(/<\/b>/g,"").trim())&&(y+=" "!==t?4:0,a&&!et?(ut={x:2*this.marginX+(g+nt),dy:yt+(a?at:0),fill:""},at=null):ut=et&&a?{x:""===h?2*this.marginX+(g+nt):2*this.marginX+(this.isWrap?g+nt:0)}:{},a=!1,i=this.renderer.createTSpan(ut,""),wt.appendChild(i),t.indexOf("<b>")>-1||b&&0===v&&0===c&&(ot||this.isWrap)?(l="bold",tt=this.themeStyle.tooltipBoldLabel,w="font-weight:"+l,o.fontWeight=l,i.setAttribute("fill",this.textStyle.color||tt)):(w="bold"===l?"font-weight:"+l:"",o.fontWeight=l,i.setAttribute("fill",this.textStyle.color||tt)),(t.indexOf("<\/b>")>-1||b&&v===st-1&&0===c&&(ot||this.isWrap))&&(l="Normal",tt=this.themeStyle.tooltipLightLabel),i.textContent=t=this.getTooltipTextContent(t),y+=e(t,o).width,""!==w&&(i.style.fontWeight=w.split("font-weight:")[1],i.style.color=i.getAttribute("fill")),i.style.fontFamily="inherit",i.style.fontStyle="inherit",i.style.fontSize="inherit",et=!1);y-=4;p=Math.max(p,y)}this.elementSize=new f(p+(p>0?2*this.marginX:0),ft);this.elementSize.width+=g+nt;ht=wt.childNodes[0];""!==h&&ht&&!this.isWrap&&(o.fontWeight="bold",dt=(this.elementSize.width+2*this.padding)/2-e(h,o).width/2,ht.setAttribute("x",dt.toString()))},t.prototype.getTooltipTextContent=function(n){var i=n.match(/<[a-zA-Z\/](.|\n)*?>/g),r,t;if(sf.base.isNullOrUndefined(i))return n;for(r=/[\u0590-\u07FF\u200F\u202B\u202E\uFB1D-\uFDFD\uFE70-\uFEFC]/.test(n),t=0;t<i.length;t++)this.isValidHTMLElement(i[t].replace("<","").replace("/","").replace(">","").trim())&&(n=n.replace(i[t],r?"":""));return n},t.prototype.isValidHTMLElement=function(n){return"[object HTMLUnknownElement]"!=document.createElement(n).toString()},t.prototype.createTemplate=function(n,t){var y={cancel:!1,name:"tooltipRender",tooltip:this},h,c,i,e,l,a,s,v,o;if(this.trigger("tooltipRender",y),h=document.getElementById(this.element.id),this.isCanvas&&this.removeSVG(),c=h.firstElementChild,c&&sf.base.remove(c),y.cancel)sf.base.remove(u(this.element.id+"_tooltip"));else{for(i=sf.base.createElement("div",{id:this.element.id+"parent_template"}),e=this.templateFn(this.data,this.controlInstance,i.id,i.id+"_blazorTemplate","");e&&e.length>0;)sf.base.isBlazor()||1===e.length?(i.appendChild(e[0]),e=null):i.appendChild(e[0]);h.appendChild(i);l=this.isCanvas?i:this.element;a=l.getBoundingClientRect();this.padding=0;this.elementSize=new f(a.width,a.height);s=this.shared?this.sharedTooltipLocation(n,this.location.x,this.location.y):this.tooltipLocation(n,t,new r(0,0),new r(0,0));(!this.enableAnimation||this.shared||this.isFirst?this.updateDiv(l,s.x,s.y):this.animateTooltipDiv(this.element,s),this.blazorTemplate)&&(v=function(){var e=u(o.element.id).getBoundingClientRect(),i;o.elementSize=new f(e.width,e.height);i=o.tooltipLocation(n,t,new r(0,0),new r(0,0));o.updateDiv(u(o.element.id),i.x,i.y)},o=this,v.bind(o,n,t),sf.base.updateBlazorTemplate(this.element.id+"parent_template_blazorTemplate",this.blazorTemplate.name,this.blazorTemplate.parent,void 0,v))}},t.prototype.sharedTooltipLocation=function(n,t,i){var f=this.elementSize.width+2*this.marginX,u=this.elementSize.height+2*this.marginY,r=new o(t+2*this.padding,i-u-this.padding,f,u);return r.y<n.y&&(r.y+=r.height+2*this.padding),r.x+r.width>n.x+n.width&&(r.x-=r.width+4*this.padding),r},t.prototype.getCurrentPosition=function(n,t,i,u){var h=this.tooltipPlacement,l=this.clipBounds.x,a=this.clipBounds.y,c=this.offset,e=this.elementSize.width+2*this.marginX,s=this.elementSize.height+2*this.marginY,f=new r(t.x,t.y);return"Top"===h||"Bottom"===h?(f=new r(f.x+l-this.elementSize.width/2-this.padding,f.y+a-this.elementSize.height-2*this.padding-this.arrowPadding-c),i.x=u.x=e/2,"Bottom"===h&&(f.y=t.y+a+c),n.x+n.width<f.x+e?(f.x=n.width>e?n.x+n.width-e+6:n.x,i.x=u.x=n.width>e?n.x+t.x-f.x:t.x):n.x>f.x&&(f.x=n.x,i.x=u.x=t.x)):(f=new r(f.x+l+c,f.y+a-this.elementSize.height/2-this.padding),i.y=u.y=s/2,"Left"===h&&(f.x=t.x+l-c-(e+this.arrowPadding)),n.y+n.height<f.y+s?(f.y=n.height>s?n.y+n.height-s+6:n.y,i.y=u.y=n.height>s?n.y+t.y-f.y:t.y):n.y>f.y&&(f.y=n.y,i.y=u.y=t.y)),new o(f.x,f.y,e,s)},t.prototype.tooltipLocation=function(n,t,i,u){if(!sf.base.isNullOrUndefined(this.tooltipPlacement))return this.getCurrentPosition(n,t,i,u);var f=new r(t.x,t.y),e=this.elementSize.width+2*this.marginX,h=this.elementSize.height+2*this.marginY,l=this.offset,a=this.clipBounds.x,v=this.clipBounds.y,c=n.x,s=n.y;return this.inverted?(f=new r(f.x+a+l,f.y+v-this.elementSize.height/2-this.padding),i.y=u.y=h/2,(f.x+e+this.arrowPadding>c+n.width||this.isNegative)&&(f.x=(t.x>n.width?n.width:t.x)+a-l-(e+this.arrowPadding)),f.x<c&&(f.x=(t.x<0?0:t.x)+a+l),f.y<=s&&(i.y-=s-f.y,u.y-=s-f.y,f.y=s),f.y+h>=s+n.height&&(i.y+=f.y+h-(s+n.height),u.y+=f.y+h-(s+n.height),f.y-=f.y+h-(s+n.height)),i.y+this.arrowPadding/2>h-this.ry&&(i.y=h-this.ry-this.arrowPadding/2,u.y=h,this.tipRadius=0),i.y-this.arrowPadding/2<this.ry&&(i.y=this.ry+this.arrowPadding/2,u.y=0,this.tipRadius=0)):(f=new r(f.x+a-this.elementSize.width/2-this.padding,f.y+v-this.elementSize.height-2*this.padding-this.arrowPadding-l),i.x=u.x=e/2,(f.y<s||this.isNegative)&&(f.y=(t.y<0?0:t.y)+v+l),f.y+h+this.arrowPadding>s+n.height&&(f.y=Math.min(t.y,s+n.height)+v-this.elementSize.height-2*this.padding-this.arrowPadding-l),u.x=e/2,f.x<c&&(i.x-=c-f.x,u.x-=c-f.x,f.x=c),f.x+e>c+n.width&&(i.x+=f.x+e-(c+n.width),u.x+=f.x+e-(c+n.width),f.x-=f.x+e-(c+n.width)),i.x+this.arrowPadding/2>e-this.rx&&(i.x=e-this.rx-this.arrowPadding/2,u.x=e,this.tipRadius=0),i.x-this.arrowPadding/2<this.rx&&(i.x=this.rx+this.arrowPadding/2,u.x=0,this.tipRadius=0)),new o(f.x,f.y,e,h)},t.prototype.animateTooltipDiv=function(n,t){var i,r=this,u=parseFloat(n.style.left),f=parseFloat(n.style.top);new sf.base.Animation({}).animate(n,{duration:this.duration,progress:function(r){i=r.timeStamp/r.duration;n.style.animation=null;n.style.left=u+i*(t.x-u)+"px";n.style.top=f+i*(t.y-f)+"px"},end:function(){r.updateDiv(n,t.x,t.y);r.trigger("animationComplete",{tooltip:r})}})},t.prototype.updateDiv=function(n,t,i){n.style.left=t+"px";n.style.top=i+"px"},t.prototype.updateTemplateFn=function(){if(this.template)try{document.querySelectorAll(this.template).length&&(this.templateFn=sf.base.compile(document.querySelector(this.template).innerHTML.trim()))}catch(n){this.templateFn=sf.base.compile(this.template)}},t.prototype.fadeOut=function(){var i=this,r=this.isCanvas&&!this.template?u(this.element.id+"_svg"):u(this.element.id),n,t;if(r){if(n=r.firstChild,this.isCanvas&&!this.template&&(n=document.getElementById(this.element.id+"_group")?document.getElementById(this.element.id+"_group"):n),!n)return null;t=parseFloat(n.getAttribute("opacity"));t=sf.base.isNullOrUndefined(t)?1:t;new sf.base.Animation({}).animate(n,{duration:200,progress:function(r){i.progressAnimation(n,t,r.timeStamp/r.duration)},end:function(){i.fadeOuted=!0;i.endAnimation(n)}})}},t.prototype.progressAnimation=function(n,t,i){n.style.animation="";n.setAttribute("opacity",(t-i).toString())},t.prototype.endAnimation=function(n){n.setAttribute("opacity","0");this.template&&(n.style.display="none");this.trigger("animationComplete",{tooltip:this})},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.getModuleName=function(){return"tooltip"},t.prototype.destroy=function(){n.prototype.destroy.call(this);this.element.classList.remove("e-tooltip")},t.prototype.onPropertyChanged=function(){this.blazorTemplate&&sf.base.resetBlazorTemplate(this.element.id+"parent_template_blazorTemplate");this.isFirst=!1;this.render()},i([sf.base.Property(!1)],t.prototype,"enable",void 0),i([sf.base.Property(!1)],t.prototype,"shared",void 0),i([sf.base.Property(!0)],t.prototype,"enableShadow",void 0),i([sf.base.Property(null)],t.prototype,"fill",void 0),i([sf.base.Property("")],t.prototype,"header",void 0),i([sf.base.Property(.75)],t.prototype,"opacity",void 0),i([sf.base.Complex({size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},rt)],t.prototype,"textStyle",void 0),i([sf.base.Property(null)],t.prototype,"template",void 0),i([sf.base.Property(!0)],t.prototype,"enableAnimation",void 0),i([sf.base.Property(300)],t.prototype,"duration",void 0),i([sf.base.Property(!1)],t.prototype,"inverted",void 0),i([sf.base.Property(!1)],t.prototype,"isNegative",void 0),i([sf.base.Complex({color:"#cccccc",width:.5},ut)],t.prototype,"border",void 0),i([sf.base.Property([])],t.prototype,"content",void 0),i([sf.base.Property(10)],t.prototype,"markerSize",void 0),i([sf.base.Complex({x:0,y:0},y)],t.prototype,"clipBounds",void 0),i([sf.base.Property([])],t.prototype,"palette",void 0),i([sf.base.Property([])],t.prototype,"shapes",void 0),i([sf.base.Complex({x:0,y:0},y)],t.prototype,"location",void 0),i([sf.base.Property(0)],t.prototype,"offset",void 0),i([sf.base.Property(2)],t.prototype,"rx",void 0),i([sf.base.Property(2)],t.prototype,"ry",void 0),i([sf.base.Property(5)],t.prototype,"marginX",void 0),i([sf.base.Property(5)],t.prototype,"marginY",void 0),i([sf.base.Property(12)],t.prototype,"arrowPadding",void 0),i([sf.base.Property(null)],t.prototype,"data",void 0),i([sf.base.Property("Material")],t.prototype,"theme",void 0),i([sf.base.Complex({x:0,y:0,width:0,height:0},ft)],t.prototype,"areaBounds",void 0),i([sf.base.Property(null)],t.prototype,"availableSize",void 0),i([sf.base.Property()],t.prototype,"blazorTemplate",void 0),i([sf.base.Property(!1)],t.prototype,"isCanvas",void 0),i([sf.base.Property(!1)],t.prototype,"isTextWrap",void 0),i([sf.base.Property(null)],t.prototype,"tooltipPlacement",void 0),i([sf.base.Property(null)],t.prototype,"controlInstance",void 0),i([sf.base.Event()],t.prototype,"tooltipRender",void 0),i([sf.base.Event()],t.prototype,"loaded",void 0),i([sf.base.Event()],t.prototype,"animationComplete",void 0),t=i([sf.base.NotifyPropertyChanges],t)}(sf.base.Component);return t.TextStyle=rt,t.TooltipBorder=ut,t.AreaBounds=ft,t.ToolLocation=y,t.Tooltip=ot,t.getTooltipThemeColor=p,t.measureText=e,t.findDirection=b,t.Size=f,t.Rect=o,t.Side=k,t.CustomizeOption=a,t.TextOption=d,t.getElement=u,t.removeElement=s,t.drawSymbol=g,t.calculateShapes=nt,t.PathOption=tt,t.textElement=it,t.TooltipLocation=r,t.SvgRenderer=c,t.CanvasRenderer=et,t};sf.svgbase=sf.svgbase({})},"./modules/syncfusion-blazor-extended.js":function(n,t,i){"use strict";i("./syncfusion-blazor-extended.js")},"./single-documenteditor-bundle.js":function(n,t,i){"use strict";i.r(t);i("./modules/base.js");i("./syncfusion-blazor.js");i("./modules/syncfusion-blazor-extended.js");i("./modules/popup.js");i("./modules/popupsbase.js");i("./modules/navigationsbase.js");i("./modules/splitbuttonsbase.js");i("./modules/sortable.js");i("./modules/data.js");i("./modules/svgbase.js");i("./modules/fileutils.js");i("./modules/compression.js");i("./modules/chart.js");i("./modules/accumulationchart.js");i("./modules/officechart.js");i("./modules/sf-textbox.js");i("./modules/sf-spinner.js");i("./modules/sf-listview.js");i("./modules/sf-tab.js");i("./modules/sf-colorpicker.js");i("./modules/sf-numerictextbox.js");i("./modules/sf-drop-down-button.js");i("./modules/sf-dialog.js");i("./modules/sf-dropdownlist.js");i("./modules/sf-datepicker.js");i("./modules/sf-toolbar.js");i("./modules/sf-contextmenu.js");i("./modules/sf-listbox.js");i("./modules/sf-documenteditor.js");i("./modules/sf-documenteditorcontainer.js")},"./syncfusion-blazor-extended.js":function(n,t,r){"use strict";function c(n,t){if(!_instanceof(n,t))throw new TypeError("Cannot call a class as a function");}function l(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function a(n,t,i){return t&&l(n.prototype,t),i&&l(n,i),n}function v(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}});t&&y(n,t)}function y(n,t){return(y=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function p(n){var t=et();return function(){var i,r=s(n),u;return t?(u=s(this).constructor,i=Reflect.construct(r,arguments,u)):i=r.apply(this,arguments),ut(this,i)}}function ut(n,t){if(t&&("object"===e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ft(n)}function ft(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function et(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function s(n){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function ot(n){return lt(n)||ct(n)||ht(n)||st()}function st(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function ht(n,t){if(n){if("string"==typeof n)return h(n,t);var i=Object.prototype.toString.call(n).slice(8,-1);return"Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i?Array.from(n):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?h(n,t):void 0}}function ct(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}function lt(n){if(Array.isArray(n))return h(n)}function h(n,t){(null==t||t>n.length)&&(t=n.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=n[i];return r}function w(n,t,i,r,u,f,e){try{var o=n[f](e),s=o.value}catch(n){return void i(n)}o.done?t(s):Promise.resolve(s).then(r,u)}function f(n){return function(){var t=this,i=arguments;return new Promise(function(r,u){function f(n){w(e,r,u,f,o,"next",n)}function o(n){w(e,r,u,f,o,"throw",n)}var e=n.apply(t,i);f(void 0)})}}function e(n){return(e="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(n){return _typeof2(n)}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":_typeof2(n)})(n)}var rt=r("../node_modules/@babel/runtime/regenerator/index.js"),u=r.n(rt),at={modules:{},tempCallBacks:[],dataSourceProperties:["dataSource","dataSource_custom","shapeData"],enableRtl:function(n){sf.base.enableRtl(n)},loadCldr:function(n){sf.base.loadCldr(JSON.parse(n))},setCulture:function(n,t){sf.base.setCulture(n);sf.base.extend(sf.base.blazorCultureFormats,t)},convertOptions:function(n,t){var s={},o,u,e;for(o in n){for(var f=o.trim().split("."),i=s,r=0;r<f.length-1;r++)u=f[r].match(/^(\w+)\[(\d+)\]$/),u?(e=i[u[1]],e||(e=i[u[1]]=[]),i=e[u[2]]=e[u[2]]||{}):i=i[f[r]]=i[f[r]]||{};i[f[r]]=n[o];t&&delete n[o]}return s},convertInitialOptions:function(n){return n=sfBlazor.convertOptions(JSON.parse(n),!0),JSON.stringify(n)},initialize:function(n,t,i,r,u,f,o,s,h,c){var y,a,l,p,v;try{if(null==r)return;if(c&&c.length&&sfBlazor.load(c),"sf.popups.Spinner"==r)return;if(sf.base.enableBlazorMode(),!window.BlazorAdaptor&&sf.data&&"object"===e(sf.data)&&sfBlazor.initBlazorAdaptor(),t=sfBlazor.convertInitialOptions(t),y={dotnetInstance:u,templateRefs:s},(t=JSON.parse(t,sfBlazor.parseRevive.bind(y))).elementID="_ejs"+n,a=sf.base.getValue(r,window),(sfBlazor.bindEvents(t,i,u,r),a)&&(l=new a(t)),l){if(l.isServerRendered=!0,l._dotnetInstance=u,l.templateDotnetInstance=s,l.interopAdaptor=h,l.bindableProps=f=JSON.parse(f),o){p=document.getElementById(n);for(v in o)p.setAttribute(v,o[v])}"sf.pdfviewer.PdfViewer"==r&&null==l.serviceUrl&&(sf.pdfviewer.AjaxHandler.prototype.send=sfBlazor.requestHandler.bind(l));"sf.documenteditor.DocumentEditorContainer"!=r&&"sf.documenteditor.DocumentEditor"!=r||null!=l.serviceUrl&&""!=l.serviceUrl&&null!=l.serviceUrl||(sf.documenteditor.XmlHttpRequestHandler.prototype.send=sfBlazor.docEditRequestHandler.bind(l));l.appendTo("#"+n)}}catch(n){sfBlazor.throwError(n,r)}},load:function(n){sf.base.L10n.load(JSON.parse(n))},renderComplete:function(n){null!=n&&(window[n]&&(_instanceof(window[n.id],n)||_instanceof(window[n.id],HTMLElement))&&delete window[n.id],n.classList.remove("e-blazor-hidden"))},isDataSourceProperty:function(n){return-1!==sfBlazor.dataSourceProperties.indexOf(n)},setModel:function(n,t,i){var u,f,r,e;try{if(u=document.getElementById(n),!u)return;r=u.ej2_instances[0];r.preventUpdate=!0;sfBlazor.updateOldProperties(r,t);e={dotnetInstance:r._dotnetInstance};f=sfBlazor.getCompObject(r,t,e,i);r.setProperties(f);r.dataBind();r.preventUpdate=!1}catch(n){window.sfBlazor.throwError(n,r)}},getCompObject:function(n,t,i,r){var f=sfBlazor.getModelObject(n,t,i,!1),l,s,v,c;if(f){for(l=Object.keys(f),s=0;s<l.length;s++){var u=l[s],a=n[u],o=f[u],y=a&&a.isComplexArray,h=o&&"object"===e(o)&&Object.keys(o)[0];if((_instanceof(a,sf.base.ChildProperty)||y)&&!isNaN(h)){if(c=o[h],!Array.isArray(o)&&c&&c.isNewComponent){var w=u.charAt(0).toUpperCase()+u.substr(1,u.length),b=r.split(".").splice(0,2).join(".")+"."+w,p=sf.base.getValue(b,window);p&&(v=sf.base.createInstance(p,[n,u,c,y]))}v&&(f[u][h]=v,n[u]&&Array.isArray(n[u])&&n[u].filter(function(n,t){h!==t&&(f[u][t]=n)}))}}return f}},getModelObject:function(n,t,i,r){for(var f,o={},s=t.match(/"(.*?)":/g),e=0;e<s.length;e++){var u=s[e].replace(":","").replace(/"/g,""),c=sfBlazor.convertInitialOptions(t),h=r?sf.base.getValue(u,n):sf.base.getValue(u,JSON.parse(c,sfBlazor.parseRevive.bind(i)));void 0!==h&&(u=u.split(/\[(\d+)\]/).join(".").replace(/\.\./g,"."),f=sfBlazor.getNestedObject(n,u,h),sf.base.extend(o,{},f.model,!0),r||(n.deepMerge=n.deepMerge?Array.from(new Set(n.deepMerge.concat(f.deepMerge))):f.deepMerge))}return o},updateOldProperties:function(n,t){var i=sfBlazor.getModelObject(n,t,null,!0);sf.base.extend(n.oldProperties,{},i,!0)},getNestedObject:function(n,t,i,r){var o=r||{},s=[],f,u,h,e;if(-1!==t.indexOf("."))for(f=t.split("."),-1===s.indexOf(f[0])&&s.push(f[0]),u=0;u<f.length;u++)h=u===f.length-1?i:{},e=0===u?o:e[f[u-1]],n=0===u?n:n[f[u-1]],e=sfBlazor.getNestedObject(n,f[u],h,e,f[u+1]).model;else o[t]=i;return{model:o,deepMerge:s}},updateModel:(it=f(u.a.mark(function o(n){var t,i;return u.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,n.isRendered&&!n.preventUpdate&&n._dotnetInstance){r.next=3;break}return r.abrupt("return");case 3:return t=sfBlazor.copyWithoutCircularReferences([n.bulkChanges],n.bulkChanges),i=sfBlazor.getUpdatedValue(n,t),r.next=7,n._dotnetInstance.invokeMethodAsync("UpdateModel",i);case 7:n.preventUpdate=!1;r.next=13;break;case 10:r.prev=10;r.t0=r.catch(0);window.sfBlazor.throwError(r.t0,n);case 13:case"end":return r.stop()}},o,null,[[0,10]])})),function(){return it.apply(this,arguments)}),getUpdatedValue:function(n,t){for(var r,i,u={},s=["query","formatter"],o=Object.keys(t),f=0;f<o.length;f++)r=o[f],i=t[r],-1===s.indexOf(r)&&(sfBlazor.isChildProperty(n,r)?u[r]=sfBlazor.getUpdatedValue(n,i):("object"!==e(i)||null===i||_instanceof(i,Date)||Array.isArray(i)&&_instanceof(i[0],Date)||(i=JSON.stringify(i)),u[r]=i));return u},isChildProperty:function(n,t){return n.properties&&n.properties[t]&&void 0!==n.properties[t].parentObj},updateBlazorProperties:function(n,t){t._dotnetInstance.invokeMethodAsync("UpdateBlazorDiagramObjects",n)},updateBlazorDiagramEvents:(tt=f(u.a.mark(function o(n,t){var i;return u.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t._dotnetInstance.invokeMethodAsync("UpdateBlazorDiagramEvents",n);case 3:(i=r.sent)&&"string"==typeof i&&(i=JSON.parse(i));r.next=10;break;case 7:r.prev=7;r.t0=r.catch(0);window.sfBlazor.throwError(r.t0,this);case 10:return r.abrupt("return",i);case 11:case"end":return r.stop()}},o,this,[[0,7]])})),function(){return tt.apply(this,arguments)}),callDiagramMethod:(nt=f(u.a.mark(function o(n,t){var i;return u.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=document.getElementById(t)&&document.getElementById(t).ej2_instances[0],"updateDiagramObjects"===n.methodName&&(n.obj=JSON.parse(n.obj,sfBlazor.parseRevive)),r.abrupt("return",i.callFromServer(n));case 3:case"end":return r.stop()}},o)})),function(){return nt.apply(this,arguments)}),updateTemplate:function(n,t,i,r,u){var f,h;void 0===r&&(r={});u&&window.sfBlazor.tempCallBacks.push({Id:i,Promise:u});var e=[],s=[],o=[];if(sf.base.isNullOrUndefined(t)||!t.length||sf.base.isNullOrUndefined(t[0].BlazId)){if(!sf.base.isNullOrUndefined(t))for(f=0;f<t.length;f++)o.push(t[f].BlazorTemplateId),e.push(JSON.parse(window.sfBlazor.cleanStringify(t[f]))),delete e[f].BlazorTemplateId}else for(f=0;f<t.length;f++)s.push(t[f].BlazId),o.push(t[f].BlazorTemplateId);h=setInterval(function(){var t=r.templateDotnetInstance?r.templateDotnetInstance[n]||window.sfBlazor.templateDotnetInstance[r.guid||n]:window.sfBlazor.templateDotnetInstance?window.sfBlazor.templateDotnetInstance[r.guid||n]:null;if(!t){if(r.templateDotnetInstance&&!window.sfBlazor.templateDotnetInstance[r.guid||n])return;if(!(r.parentObj&&r.parentObj.templateDotnetInstance&&r.parentObj.templateDotnetInstance[n]))return;t=r.parentObj.templateDotnetInstance[n]}t&&(t.invokeMethodAsync("UpdateTemplate",n,JSON.stringify(e),i,o,s),clearInterval(h))},10)},setTemplateInstance:function(n,t,i){sfBlazor.templateDotnetInstance||(sfBlazor.templateDotnetInstance=[]);sfBlazor.templateDotnetInstance[i||n]=t},setTemplate:function(n){setTimeout(function(){var i,t,e,u,o,f,r;if(null!=n){for(i=document.getElementById(n).getElementsByClassName("blazor-inner-template"),t=0;t<i.length;t++)if(e=i[t].getAttribute("data-templateid"),u=document.getElementById(e),u&&i[t].childNodes)for(o=i[t].childNodes.length,f=0;f<o;f++)u.appendChild(i[t].childNodes[0]);else u&&(u.innerHTML=i[t].innerHTML);if(window.sfBlazor.tempCallBacks.length)for(r=0;r<window.sfBlazor.tempCallBacks.length;r++)window.sfBlazor.tempCallBacks[r].Id==n&&(window.sfBlazor.tempCallBacks[r].Promise(window.sfBlazor.tempCallBacks[r].Id),window.sfBlazor.tempCallBacks.splice(r,1))}},100)},invokeMethod:(g=f(u.a.mark(function o(n,t,i,r,f){var s,h;return u.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(u.prev=0,s=null,r=JSON.parse(r,sfBlazor.parseRevive),h=document.getElementById(n)&&document.getElementById(n).ej2_instances&&document.getElementById(n).ej2_instances[0],"destroy"===t&&h&&(h._dotnetInstance=null),f&&r.push(f),!h){u.next=23;break}if(null!==i){u.next=11;break}s=h[t].apply(h,r);u.next=17;break;case 11:return h=sfBlazor.getDocEditor(h,i),h=window.sfBlazor.getChildModule(h,i),s=h[t].apply(h,r),u.next=16,sfBlazor.promiseHandler(s);case 16:s=u.sent;case 17:if(!s||"object"!==e(s)||_instanceof(s,Promise)||(s=sfBlazor.cleanStringify(s)),!("PdfViewer"==h.getModuleName()&&"saveAsBlob"==t&&_instanceof(s,Promise))){u.next=22;break}return u.next=21,sfBlazor.promiseHandler(s);case 21:s=u.sent;case 22:return u.abrupt("return",s);case 23:u.next=28;break;case 25:return u.prev=25,u.t0=u.catch(0),u.abrupt("return",window.sfBlazor.throwError(u.t0,h));case 28:case"end":return u.stop()}},o,null,[[0,25]])})),function(){return g.apply(this,arguments)}),promiseHandler:(d=f(u.a.mark(function o(n){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!_instanceof(n,Promise)){t.next=3;break}return t.next=3,n.then(function(){var t=f(u.a.mark(function t(i){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!_instanceof(i,Blob)){t.next=5;break}return t.next=3,window.sfBlazor.docEditFileReader(i).then(function(t){n=JSON.stringify({data:t.substr(t.indexOf(",")+1)})});case 3:t.next=6;break;case 5:n=i;case 6:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",n);case 4:case"end":return t.stop()}},o)})),function(){return d.apply(this,arguments)}),getDocEditor:function(n,t){return"DocumentEditorContainer"===n.getModuleName()&&"documentEditor"!==t?n.documentEditor:n},getChildModule:function(n,t){try{for(var r=t.split(","),i=0;i<r.length;i++)n=n[r[i]];return n}catch(t){window.sfBlazor.throwError(t,n)}},getMethodCall:function(n,t,i){try{var r=document.getElementById(n)&&document.getElementById(n).ej2_instances[0];return r=sfBlazor.getDocEditor(r),null==t||"null"==t?r[i]:(r=window.sfBlazor.getChildModule(r,t))[i]}catch(n){window.sfBlazor.throwError(n,r)}},setMethodCall:function(n,t,i,r){try{var u=document.getElementById(n)&&document.getElementById(n).ej2_instances[0];u=sfBlazor.getDocEditor(u);(u=window.sfBlazor.getChildModule(u,t))[i]=r[0]}catch(n){window.sfBlazor.throwError(n,u)}},methodCall:function(n,t,i,r){try{var u=document.getElementById(n)&&document.getElementById(n).ej2_instances[0];(u=window.sfBlazor.getChildModule(u,t))[i].apply(u,[r])}catch(n){window.sfBlazor.throwError(n,u)}},parseRevive:function(n,t){var h=new RegExp(/(\d{4})-(\d{2})-(\d{2})T(\d{2})\:(\d{2})\:(\d{2}).*/),e=new RegExp(/^\[.*?\]$/),c=new RegExp(/^\{.*?\}$/),o,r,u,f,s;if(""===n&&t&&t.dataSource_custom&&(t.dataSource_custom.key=t.dataSource.key,t.dataSource=t.dataSource_custom),t&&"string"==typeof t&&(-1!==t.indexOf("sf.data.Query()")||"formatter"===n))try{return eval(t)}catch(l){return s=sfBlazor.getEvaluatedFunc(t)}else{if(sfBlazor.isDataSourceProperty(n))return null===t?void 0:(t="string"==typeof t?JSON.parse(t):t,!t.adaptor||_instanceof(t,sf.data.DataManager))?t:(o=t.offline,t.offline=!1,t.adaptor=sfBlazor.getAdaptor(t.adaptor),r=new sf.data.DataManager(t),r.offline=o,this.dotnetInstance&&(r.dotnetInstance=this.dotnetInstance,r.key=t.key,_instanceof(r.adaptor,BlazorAdaptor)&&(r.adaptorName=t.adaptorName,r.dataSource.offline=!1)),(this[t.guid]||this.templateRefs&&this.templateRefs[t.guid])&&(r.baseAdaptorInstance=this[t.guid]||this.templateRefs[t.guid],r.adaptorName="CustomAdaptor"),r);if("string"==typeof t&&h.test(t)){if(e.test(t)){for(u=JSON.parse(t),f=[],i=0;i<u.length;i++)f.push(new Date(u[i]));return f}return isNaN(Date.parse(t))?t:new Date(t)}if("string"==typeof t&&(e.test(t)||c.test(t))&&sfBlazor.isJson(t))return JSON.parse(t)}return t},getEvaluatedFunc:function(n){var o=new RegExp(/\(+[^\)]+\)+/g),t=n.split("new sf.data.Query().")[1],y=n.trim().split("new sf.richtexteditor.MarkdownFormatter")[1],s,r,h,d,g,l,a,v,nt,tt;if(t){var p=t.split(o)[0],w=t.match(o)[0],c=new RegExp(/(\([a-z])+[^\)]+\)+/g),b=n.match(c);if(null!==b)var k=b[0],it=k.match(/\{+[^\)]+\}/g)[0],rt=k.split(/\{+[^\)]+\}/g)[0];if(-1!==w.indexOf("sf"))s=(l=rt.match(/[^(]+/g)[0]).split("."),r=(new sf.data.Query)[p](sf[s[1]][s[2]][s[3]](JSON.parse(it)));else if(t.split(".").length>1)if(o=new RegExp(/([^\"]([A-Z]|[a-z])+[\"\]])/g),null!==t.match(o)){c=new RegExp(/([^\"]([A-Z]|[a-z])+[\"\]])|[0-9]/g);for(var f=t.match(c),e=t.split("."),i=[],u=0;u<e.length;u++)h=e[u].match(/([A-z])+/g)[0],i.push(h);r=(new sf.data.Query)[i[0]]()[i[1]](f[0].slice(0,-1))[i[2]](Number(f[1]))}else{for(d=new RegExp(/([^\']+([A-Z]|[a-z])+[\'\)])|[0-9]/g),f=t.match(d),e=t.split("."),i=[],u=0;u<e.length;u++)h=e[u].match(/([A-z])+/g)[0],i.push(h);r=(new sf.data.Query)[i[0]](f[0].slice(0,-1))[i[1]](f[1].slice(0,-1))[i[2]](Number(f[2]))}else l=w.match(/([A-z]+|[0-9]+)+/g),r=(g=new sf.data.Query)[p].apply(g,ot(l))}else y?(a=y.trim(),v=a.substring(1,a.length-1).trim(),v.length>0?(nt=v.replace(/'/g,'"'),tt=JSON.parse(nt),r=new sf.richtexteditor.MarkdownFormatter(tt)):r=new sf.richtexteditor.MarkdownFormatter({})):r=new sf.data.Query;return r},triggerEJEvents:(k=f(u.a.mark(function o(n){var t;return u.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,!n){i.next=8;break}return n.elementID=this.elementID,i.next=5,this.dotnet.invokeMethodAsync("Trigger",this.eventName,window.sfBlazor.cleanStringify(n));case 5:t=i.sent;i.next=11;break;case 8:return i.next=10,this.dotnet.invokeMethodAsync("Trigger",this.eventName,"");case 10:t=i.sent;case 11:i.next=16;break;case 13:i.prev=13;i.t0=i.catch(0);window.sfBlazor.throwError(i.t0,this);case 16:return i.abrupt("return",t);case 17:case"end":return i.stop()}},o,this,[[0,13]])})),function(){return k.apply(this,arguments)}),copyWithoutCircularReferences:function(n,t){try{var r=t&&Array.isArray(t),i=r?[]:{};return(r?t:_instanceof(t,Node)?[t]:sfBlazor.getObjectKeys(t)).forEach(function(){var o=f(u.a.mark(function o(f){var w,s,a,h,v,c,y,l,p;return u.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(w=t.hasOwnProperty("parentObj")&&t.properties?t.properties:t,s=r?f:w[f],r&&("string"==typeof s||"number"==typeof s))i.push(s);else if(_instanceof(s,Node))a=sfBlazor.getDomObject(f,s,t),r?i.push(a):i[f]=a;else if(s&&Array.isArray(s))if(s.length>0)for(h=0;h<s.length;h++)i[f]||(i[f]=[]),"ej2_instances"!==f&&(!s[h]||"object"!==e(s[h])||_instanceof(s[h],Date)?i[f].push(s[h]):i[f].push(window.sfBlazor.copyWithoutCircularReferences(n,s[h])));else i[f]=[];else if(s&&window.sfBlazor.isJson(s)&&new RegExp(/^\[.*?\]$/).test(s))for(v=JSON.parse(s),i[f]||(i[f]=[]),c=0;c<v.length;c++)i[f].push(v[c]);else if(s&&_instanceof(s,Event)){for(l in y={},s)_instanceof(p=s[l],Node)||_instanceof(p,Window)||"path"===l||(y[l]=p);i[f]=y}else s&&"object"===e(s)?_instanceof(s,File)?i[f]=s:n.indexOf(s)<0?(n.push(s),s&&_instanceof(s,Date)?i[f]=s:sfBlazor.isJsonStringfy(s)&&!sfBlazor.doesHaveFileObject(s)?r?i.push(s):i[f]=s:i[f]=sfBlazor.isIgnoreProperty(f.toString())?"###_Circular_###":window.sfBlazor.copyWithoutCircularReferences(n,s),n.pop()):i[f]="###_Circular_###":"function"!=typeof s&&(i[f]=s);case 3:case"end":return u.stop()}},o)}));return function(){return o.apply(this,arguments)}}()),i}catch(n){return console.log(n),{}}},doesHaveFileObject:function(n){for(var i=Object.keys(n),t=0;t<i.length;t++)if(_instanceof(n[i[t]],File))return!0;return!1},isJsonStringfy:function(n){try{return JSON.stringify(n)&&!0}catch(n){return!1}},getObjectKeys:function(n){var t=[],i;if(_instanceof(n,Event))t=Object.keys(n);else for(i in n)t.push(i);return t},isIgnoreProperty:function(n){return["parentObj","controlParent","modelObserver","localObserver","moduleLoader"].indexOf(n)>=0},isJson:function(n){try{return JSON.parse(n)}catch(n){return!1}},cleanStringify:function(n){try{return n&&"object"===e(n)&&(n=window.sfBlazor.copyWithoutCircularReferences([n],n)),JSON.stringify(n)}catch(n){return console.log(n),""}},bindEvents:function(n,t,i,r){var h,e,c,l,s,a;if(t)for(h=0;h<t.length;h+=1)if(e=t[h],c={dotnet:i,eventName:e,elementID:n.elementID,namespace:r},e.indexOf(".")>0){for(var u=e.split("."),o=n,f=0;f<u.length-1;f++)l=new RegExp(/\[.*?\]/),l.test(u[f])?(s=u[f].match(l)[0],a=u[f].replace(s,""),s=s.match(/\[(.*?)\]/)[1],f+=1,o=o[a][s]):o=o[u[f]];o[u[u.length-1]]=window.sfBlazor.triggerEJEvents.bind(c)}else n[e]=window.sfBlazor.triggerEJEvents.bind(c)},tryParseInt:function(n){return/^-?\d+\.?\d*$/.test(n)},throwError:function(n){console.error(n.message+"\n"+n.stack)},getAdaptor:function(n){var t;switch(n){case"ODataAdaptor":t=new sf.data.ODataAdaptor;break;case"ODataV4Adaptor":t=new sf.data.ODataV4Adaptor;break;case"UrlAdaptor":t=new sf.data.UrlAdaptor;break;case"WebApiAdaptor":t=new sf.data.WebApiAdaptor;break;case"JsonAdaptor":t=new sf.data.JsonAdaptor;break;case"RemoteSaveAdaptor":t=new sf.data.RemoteSaveAdaptor;break;case"CustomAdaptor":sfBlazor.initCustomAdaptor();t=new window.CustomAdaptor;break;default:t=new window.BlazorAdaptor}return t},spinnerUtility:function(n,t,i,r){try{sf.popups.Spinner(n,t,i,r)}catch(n){return window.sfBlazor.throwError(n)}},initBlazorAdaptor:function(){var n=sf.data?sf.data.UrlAdaptor:function(){};window.BlazorAdaptor=function(n){function t(){return c(this,t),i.apply(this,arguments)}v(t,n);var i=p(t);return a(t,[{key:"processQuery",value:function(n){var t=sf.data.UrlAdaptor.prototype.processQuery.apply(this,arguments);return t.dotnetInstance=n.dotnetInstance,t.key=n.key,t}},{key:"makeRequest",value:function(n,t,i,r){var u=JSON.parse(n.data),f;u.serverSideGroup=!1;f=this;n.dotnetInstance.invokeMethodAsync("DataProcess",JSON.stringify(u),n.key).then(function(i){null===(i=sf.data.DataUtil.parse.parseJson(i))?i=[]:null===i.result&&(i.result=[]),function(n,i,r){var u={};u.count=n.count?parseInt(n.count.toString(),10):0;u.result=n.result?n.result:n;u.aggregates=n.aggregates;u.virtualSelectRecords=r;t.resolve(u)}(f.processResponse(i,{},r,null,n))}).catch(function(n){!function(n){i.error=n;t.reject(i)}(n)})}},{key:"insert",value:function(n,t,i,r,u){var f={};return f.dm=n,f.data=t,f.tableName=i,f.query=r,f.requestType="insert",f.position=u,f}},{key:"remove",value:function(n,t,i,r,u){var f={};return f.dm=n,f.data=i,f.keyField=t,f.tableName=r,f.query=u,f.requestType="remove",f}},{key:"update",value:function(n,t,i,r,u){var f={};return f.dm=n,f.data=i,f.keyField=t,f.tableName=r,f.query=u,f.requestType="update",f}},{key:"batchRequest",value:function(n,t,i,r){var u={};return u.dm=n,u.changed=t.changedRecords,u.added=t.addedRecords,u.deleted=t.deletedRecords,u.requestType="batchsave",u.keyField=i.key,u.dropIndex=sf.base.isNullOrUndefined(r)?null:r.dragDropDestinationIndex,u.query=r,u}},{key:"doAjaxRequest",value:function(n){var i=new sf.data.Deferred,t=n.dm,r=sf.data.UrlAdaptor.prototype.processQuery.apply(this,[t,n.query,!1]),u=function(t){n.error=t;i.reject(n)},f;return("insert"===n.requestType&&t.dotnetInstance.invokeMethodAsync("Insert",JSON.stringify(n.data),t.key,n.position?n.position:0,r.data).then(function(n){i.resolve(n)}).catch(function(n){u(n)}),"remove"===n.requestType)&&(f="string"==typeof n.data?n.data:JSON.stringify(n.data),_instanceof(n.data,Date)&&(f=n.data.toJSON()),t.dotnetInstance.invokeMethodAsync("Remove",f,n.keyField,t.key,r.data).then(function(){i.resolve()}).catch(function(n){u(n)})),"update"===n.requestType&&t.dotnetInstance.invokeMethodAsync("Update",JSON.stringify(n.data),n.keyField,t.key,r.data).then(function(n){var t=sf.data.DataUtil.parse.parseJson(n);i.resolve(t)}).catch(function(n){u(n)}),"batchsave"===n.requestType&&t.dotnetInstance.invokeMethodAsync("BatchUpdate",JSON.stringify(n.changed),JSON.stringify(n.added),JSON.stringify(n.deleted),n.keyField,t.key,n.dropIndex,r.data).then(function(n){var t=sf.data.DataUtil.parse.parseJson(n);i.resolve(t)}).catch(function(n){u(n)}),i.promise}}]),t}(n)},initCustomAdaptor:function(){window.CustomAdaptor=function(){function n(){return c(this,n),t.apply(this,arguments)}v(n,window.BlazorAdaptor);var t=p(n);return a(n,[{key:"processQuery",value:function(n){var t=sf.data.UrlAdaptor.prototype.processQuery.apply(this,arguments);return t.dotnetInstance=n.dotnetInstance,t.baseAdaptorInstance=n.baseAdaptorInstance,t.key=n.key,t}},{key:"makeRequest",value:function(n,t,i,r){var u=JSON.parse(n.data),f;u.serverSideGroup=!1;f=this;n.baseAdaptorInstance.invokeMethodAsync("BaseRead",JSON.stringify(u),n.key).then(function(i){null===(i=sf.data.DataUtil.parse.parseJson(i)).result&&(i.result=[]),function(n,i,r){var u={};u.count=n.count?parseInt(n.count.toString(),10):0;u.result=n.result?n.result:n;u.aggregates=i;u.virtualSelectRecords=r;t.resolve(u)}(f.processResponse(i,{},r,null,n))}).catch(function(n){!function(n){i.error=n;t.reject(i)}(n)})}},{key:"doAjaxRequest",value:function(n){var i=new sf.data.Deferred,t=n.dm,r=function(t){n.error=t;i.reject(n)};return"insert"===n.requestType&&t.baseAdaptorInstance.invokeMethodAsync("BaseInsert",JSON.stringify(n.data),t.key).then(function(n){n=sf.data.DataUtil.parse.parseJson(n);i.resolve(n)}).catch(function(n){r(n)}),"remove"===n.requestType&&t.baseAdaptorInstance.invokeMethodAsync("BaseRemove",JSON.stringify(n.data),n.keyField,t.key).then(function(n){n=sf.data.DataUtil.parse.parseJson(n);i.resolve(n)}).catch(function(n){r(n)}),"update"===n.requestType&&t.baseAdaptorInstance.invokeMethodAsync("BaseUpdate",JSON.stringify(n.data),n.keyField,t.key).then(function(n){n=sf.data.DataUtil.parse.parseJson(n);i.resolve(n)}).catch(function(n){r(n)}),"batchsave"===n.requestType&&t.baseAdaptorInstance.invokeMethodAsync("BaseBatchUpdate",JSON.stringify(n.changed),JSON.stringify(n.added),JSON.stringify(n.deleted),n.keyField,t.key,n.dropIndex).then(function(n){n=sf.data.DataUtil.parse.parseJson(n);i.resolve(n)}).catch(function(n){r(n)}),i.promise}}]),n}()},requestHandler:function(n){try{var t=document.getElementById(n.elementId);t&&t.ej2_instances[0]&&this.element&&this.element.ej2_instances[0]&&this._dotnetInstance.invokeMethodAsync("GetPDFInfo",n)}catch(n){window.sfBlazor.throwError(n,this)}},ioSuccessHandler:function(n,t,i,r){var o,f,u,e;try{if(o=document.getElementById(n),o){if(f=o.ej2_instances[0],u={data:r},"sf.pdfviewer.PdfViewer"==t)switch(i){case"Load":f.viewerBase.loadRequestHandler.successHandler(u);break;case"RenderPdfPages":f.viewerBase.pageRequestHandler.successHandler(u);break;case"VirtualLoad":f.viewerBase.virtualLoadRequestHandler.successHandler(u);break;case"Download":f.viewerBase.dowonloadRequestHandler.successHandler(u);break;case"PrintImages":f.printModule.printRequestHandler.successHandler(u);break;case"Search":f.textSearchModule.searchRequestHandler.successHandler(u);break;case"Bookmarks":f.bookmarkViewModule.bookmarkRequestHandler.successHandler(u);break;case"RenderThumbnailImages":f.thumbnailViewModule.thumbnailRequestHandler.successHandler(u);break;case"RenderAnnotationComments":f.annotationModule.stickyNotesAnnotationModule.commentsRequestHandler.successHandler(u);break;case"RenderPdfTexts":f.textSearchModule.searchRequestHandler.successHandler(u);break;case"ImportAnnotations":f.viewerBase.importAnnotationRequestHandler.successHandler(u);break;case"ExportAnnotations":f.viewerBase.exportAnnotationRequestHandler.successHandler(u);break;case"ExportFormFields":f.viewerBase.exportFormFieldsRequestHandler.successHandler(u);break;case"ImportFormFields":f.viewerBase.importFormFieldsRequestHandler.successHandler(u)}if("sf.documenteditor.DocumentEditorContainer"==t||"sf.documenteditor.DocumentEditor"==t){e=sfBlazor.getDocEditor(f);switch(i){case"SystemClipboard":u.data=JSON.parse(u.data);e.editor.pasteRequestHandler.successHandler(u);break;case"Import":f.toolbarModule.importHandler.successHandler(u);break;case"EnforceProtection":e.editor.enforceProtectionInternal(u);break;case"UnprotectDocument":e.editor.onUnProtectionSuccess(u)}}}}catch(n){window.sfBlazor.throwError(n,this)}},docEditRequestHandler:(b=f(u.a.mark(function o(n){var i,t,r;return u.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(u.prev=0,!_instanceof(n,FormData)){u.next=10;break}return i=n.get("files"),t="",u.next=6,window.sfBlazor.docEditFileReader(i).then(function(n){t=n});case 6:r={documentData:t.substr(t.indexOf(",")+1),fileName:i.name,action:"Import"};this._dotnetInstance.invokeMethodAsync("GetDocumentInfo",r);u.next=12;break;case 10:n.hasOwnProperty("saltBase64")?n.action=""===n.saltBase64?"EnforceProtection":"UnprotectDocument":n.hasOwnProperty("type")&&n.hasOwnProperty("content")&&(n.action="SystemClipboard");this._dotnetInstance.invokeMethodAsync("GetDocumentInfo",n);case 12:u.next=17;break;case 14:u.prev=14;u.t0=u.catch(0);window.sfBlazor.throwError(u.t0,this);case 17:case"end":return u.stop()}},o,this,[[0,14]])})),function(){return b.apply(this,arguments)}),docEditFileReader:function(n){try{return new Promise(function(t){var i=new FileReader;i.onload=function(){t(i.result)};i.readAsDataURL(n)})}catch(n){window.sfBlazor.throwError(n,this)}}},b,k,d,g,nt,tt,it;sf.base.enableBlazorMode();window.sfBlazor=window.sfBlazor||{};Object.assign(window.sfBlazor,at)},"./syncfusion-blazor.js":function(){var n={getElementByXpath:function(n){return document.evaluate(n,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue},getElement:function(n,t,i){var r=null!=n&&null!=window[n]?window[n][t]:null;return null!=r?r:window.sfBlazor.getElementByXpath(i)},getAttribute:function(n,t,i,r){var u=window.sfBlazor.getElement(n,t,i);if(null!=u)return u.getAttribute(r)},setAttribute:function(n,t,i,r,u){window.sfBlazor.getElement(n,t,i).setAttribute(r,u)},addClass:function(n,t,i,r){sf.base.addClass([window.sfBlazor.getElement(n,t,i)],r)},removeClass:function(n,t,i,r){sf.base.removeClass([window.sfBlazor.getElement(n,t,i)],r)},getClassList:function(n,t,i){return Array.prototype.slice.call(window.sfBlazor.getElement(n,t,i).classList)},enableRipple:function(n){sf.base.enableRipple(n)},isDevice:function(n){return n&&this.enableRtl(n),sf.base.Browser.isDevice},animate:function(n,t){new sf.base.Animation(t).animate(n)},callRipple:function(n,t){sf.base.rippleEffect(n,t)},createXPathFromElement:function(n){for(var f,i,e,r,u=document.getElementsByTagName("*"),t=[];n&&1===n.nodeType;n=n.parentNode)if(n.hasAttribute("id")){for(f=0,i=0;i<u.length&&(u[i].hasAttribute("id")&&u[i].id===n.id&&f++,!(f>1));i++);if(1===f)return t.unshift('id("'+n.getAttribute("id")+'")'),t.join("/");t.unshift(n.localName.toLowerCase()+'[@id="'+n.getAttribute("id")+'"]')}else{for(e=1,r=n.previousSibling;r;r=r.previousSibling)r.localName===n.localName&&e++;t.unshift(n.localName.toLowerCase()+"["+e+"]")}return t.length?"/"+t.join("/"):null},getDomObject:function(n,t,i){var u=n+sf.base.getUniqueID(n),f={id:t.id,"class":t.className,xPath:window.sfBlazor.createXPathFromElement(t),domUUID:u},r=i&&i.elementID;return r&&(window[r]=sf.base.isNullOrUndefined(window[r])?{}:window[r],window[r][u]=t,f.elementID=r),f},focusButton:function(n){n.focus()},setProgress:function(n,t,i,r,u,f){return i=i.querySelector(".e-spinner"),window.requestAnimationFrame(function(){u&&(n.style[f?"height":"width"]=r+"%");t.parentElement.setAttribute("aria-valuenow",r.toString());100===r&&(t.classList.remove("e-cont-animate","e-animate-end"),i.style.width="auto",i.style.height="auto")})},setAnimation:function(n,t,i,r,u,f){t=t.querySelector(".e-spinner");new sf.base.Animation({}).animate(n,{duration:r,name:"Progress"+i,timingFunction:u,begin:function(){f&&(t.style.width=Math.max(t.offsetWidth,n.offsetWidth)+"px",t.style.height=Math.max(t.offsetHeight,n.offsetHeight)+"px",n.classList.add("e-cont-animate"))},end:function(){n.classList.add("e-animate-end")}})},cancelAnimation:function(n){window.cancelAnimationFrame(n)}};sf.base.enableBlazorMode();window.sfBlazor=window.sfBlazor||{};Object.assign(window.sfBlazor,n)}})
